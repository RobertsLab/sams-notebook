---
author: Sam White
toc-title: Contents
toc-depth: 5
toc-location: left
title: Resazurin - C.gigas Second Trial
date: '2024-03-12'
draft: true
engine: knitr
categories: 
  - Crassostrea gigas
  - Pacific oyster
  - 2024
  - resazurin
---
# INTRO

[After running the initial resazuring test on 20240308](../2024-03-08-Resazurin---Preliminary-Respiration-Test-Using-C.gigas/index.qmd) (Notebook), Steven/Ariana [asked that I run another trial](https://github.com/RobertsLab/resources/issues/1842) (GitHub Issue). This second trial was designed to get some baseline respiration from a set of oysters, followed by a heat stress at 35<sup>o</sup>C.

For this initial test, I followed the [resazurin assay](https://github.com/RobertsLab/project-gigas-carryover/blob/27441a713dfe68578758103bb82dd4dca4b4c091/protocols/Resazurin-assay.md) (commit 27441a7) shared by Steven, with the following modifications:

- Non-sterile water/sea water was used.

- No penn/strep/Fungizone used.

## Procedure

### Pre-stress

A total of nine small oysters were weighed, measured (using analog calipers). Two larger oyters were also weighed/measured and placed in their own glass Petri dishes. Fresh resazuring assay media was prepared. Two milliliters was added to 11 wells of the 12-well plate - the final position (`C04`) was left empty. Twenty milliliters was added to each Petri dish. These volumes ensured that the oysters would be submerged when added.

Fluorescence was measured on a Victor<sup>3</sup> plate reader immediatley after adding resazurin assay media to the plate and dishes. The oysters were then distributed/added to the 12-well plate and dishes. Fluorescence was measured again after 0.5 and 1.0hrs. To measure the dishes, 2mL of assay media was transferred to wells `A01` and `A02` of a clean 12-well plate (the smaller of the two oysters in `A01`).

### Heat stress @ 35<sup>o</sup>C.

As before, a fresh batch of resazurin assay media was made and distributed in a 12-well plate and two glass Petri dishes. The plate and the dishes were warmed at 35<sup>o</sup>C in a warm air incubator (Barnstead) for 45mins. The 12-well plate was covered; the Petri dishes were not. Fluorescence was measured on a Victor<sup>3</sup> plate reader immediately before  transferring oysters to the plate and dishes.

Oysters were transferred from the pre-stress plate/dishes to the pre-warmed plate/dishes. Fluorescence was measured again after 0.5 and 1.0hrs. To measure the dishes, 2mL of assay media was transferred to wells `A01` and `A02` of a clean 12-well plate (the smaller of the two oysters in `A01`).

### Plate layout

![Oysters in 12-well plate, a ruler, and oysters in two glass Petri dishes.](20240312-cgig-12_well-dishes-with_ruler.jpg){fig-alt="Oysters in 12-well plate, a ruler, and oysters in two glass Petri dishes."}

# RESULTS

## Output files

All files have been deposited in the [`project-gigas-carryover` repo](https://github.com/RobertsLab/project-gigas-carryover/tree/main/lifestage_carryover/data/resazurin_trial_02). Please visit that link to obtain files, as well as view the [`REAMDE.md` file](https://github.com/RobertsLab/project-gigas-carryover/tree/main/lifestage_carryover/data/resazurin_trial_02/REAMDE.md) for descriptions of each file.

All measurements were compiled in the following file:

- [`20240312-cgig-resazurin-trial-02.csv`](https://github.com/RobertsLab/project-gigas-carryover/blob/04a64e3bd45487b5cd631f5817937d3cd4318e70/lifestage_carryover/data/resazurin_trial_02/20240312-cgig-resazurin-trial-02.csv) (CSV; commit `04a64e3`)

## Analysis

::: callout-note
Data frame links to commit `04a64e3`.
:::

```{r setup, include=FALSE}
library(knitr)
library(dplyr)
knitr::opts_chunk$set(
  echo = TRUE,         # Display code chunks
  eval = FALSE,        # Evaluate code chunks
  warning = FALSE,     # Hide warnings
  message = FALSE,     # Hide messages
  comment = "",        # Prevents appending '##' to beginning of lines in code output
  width = 1000         # adds scroll bar
)
```


### Read in `20240312-cgig-resazurin-trial-02.csv`
```{r read-in-csv, eval=TRUE}
resazurin.df <- read.csv("https://raw.githubusercontent.com/RobertsLab/project-gigas-carryover/04a64e3bd45487b5cd631f5817937d3cd4318e70/lifestage_carryover/data/resazurin_trial_02/20240312-cgig-resazurin-trial-02.csv",
header = TRUE,
sep = ",")

str(resazurin.df)
```

### Plot pre-stress raw flourescence

```{r plot-pre-stress-raw-fluorescence, eval=TRUE}
# Load the ggplot2 library
library(ggplot2)

# Reshape the data frame from wide to long format using tidyr
library(tidyr)

resazurin.df_long <- pivot_longer(resazurin.df, 
                                  cols = starts_with("A590.prestress"), 
                                  names_to = "time_point", 
                                  values_to = "A590_prestress_value")

# Create a new column to specify the color
resazurin.df_long$color <- ifelse(grepl("^neg-control", resazurin.df_long$sample), "neg-control", resazurin.df_long$sample)

# Get unique non-"neg-control" samples
non_neg_control_samples <- setdiff(unique(resazurin.df_long$sample), "neg-control")

# Define color palette
sample_colors <- c("neg-control" = "black", 
                   setNames(rainbow(length(non_neg_control_samples)), 
                            non_neg_control_samples))

# Plot the dot plot with lines
ggplot(resazurin.df_long, aes(x = time_point, y = A590_prestress_value, group = sample, color = color)) +
  geom_point(size = 3) +  # Larger dot size
  geom_line() +  # Connect dots with lines
  scale_color_manual(values = sample_colors) +  # Assigning colors to samples
  labs(x = "Time Point", y = "Raw A590 (RFUs)", title = "Raw A590 Pre-stress Values", color = "Sample") +
  theme_minimal()
```

### Plot pre-stress control-subtracted fluorescence

