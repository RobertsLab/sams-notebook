{
  "hash": "d90a9c820b45a67ea98d3f56aea5ef70",
  "result": {
    "engine": "knitr",
    "markdown": "---\nauthor: Sam White\ntoc-title: Contents\ntoc-depth: 5\ntoc-location: left\ntitle: qPCR Analysis - C.gigas Lifestages Carryover\ndate: '2024-12-20'\ndraft: false\nengine: knitr\ncategories: \n  - \"2024\"\n  - \"Crassostrea gigas\"\n  - \"Pacific oyster\"\n  - \"qPCR\"\n  - \"project-gigas-carryover\"\n  - \"lifestage_carryover\"\n---\n\n\n\n# INTRO\n\nThis notebook performs pair-wise comparisons of qPCR gene expression,\nnormalized to `GAPDH` expression. It calculates delta Cq, delta delta\nCq, and fold changes in expression. Additionally, it generates box plots\n(delta Cq), and bar plots (fold change expression).\n\nI've provided a summary of the various pair-wise comparisons immediately below, but you might want to just [skip to the plots](#plotting), as the summary _and_ the notebook content is _very_ lengthy.\n\n# SUMMARY\n\n## t-tests (Delta Cq)\n\n### Seed vs. Adult\n\nThese genes had p-values <= 0.05:\n\n- VIPERIN\n\n### Seed vs. Juvenile\n\nThese genes had p-values <= 0.05:\n\n- citrate synthase\n\n- HSP90\n\n### Seed vs. Spat\n\nThese genes had p-values <= 0.05:\n\n- VIPERIN\n\n### Adult vs. Juvenile\n\nThe genes had p-values <= 0.05:\n\n- citrate synthase\n\n- VIPERIN\n\n### Adult vs. Spat\n\nNo genes had p-values <= 0.05\n\n### Juvenile vs. Spat\n\nThe genes had p-values <= 0.05:\n\n- citrate synthase\n\n- VIPERIN\n\n### Seed - Conditioning Treated vs. Control\n\nNo genes had p-values <= 0.05\n\n### Adult - Conditioning Treated vs. Control\n\nThe genes had p-values <= 0.05:\n\n- HSP90\n\n### Juvenile - Conditioning Treated vs. Control\n\nNo genes had p-values <= 0.05\n\n### Spat - Conditioning Treated vs. Control\n\nThe genes had p-values <= 0.05:\n\n- citrate synthase\n\n- DNMT1\n\n### Adult - Acute Ambient vs. High\n\nNo genes had p-values <= 0.05\n\n### Juvenile - Acute Ambient vs. High\n\nNo genes had p-values <= 0.05\n\n### Adult - Conditioning Treated: Acute Ambient vs. High\n\nNo genes had p-values <= 0.05\n\n### Adult - Conditioning Control: Acute Ambient vs. High\n\nNo genes had p-values <= 0.05\n\n### Juvenile - Conditioning Treated: Acute Ambient vs. High\n\nThe genes had p-values <= 0.05:\n\n- HSP70\n\n### Juvenile - Conditioning Control: Acute Ambient vs. High\n\nThe genes had p-values <= 0.05:\n\n- VIPERIN\n\n## Gene Expression (delta delta Cq or fold change)\n\n### Adult - Conditioning Treated: Acute High vs. Ambient\n\n- All genes show elevated expression relative to Ambient.\n\n- Fold change is at similar levels across all genes, with DNMT1 and HSP70 being the highest.\n\n### Juvenile - Conditioning Treated: Acute High vs. Ambient\n\n- All genes show elevated expression relative to Ambient.\n\n- HSP70 shows ~4-fold higher fold change in expression compared to most of the other genes.\n\n- DNMT1 exhibits fold change expression ~1/2 that of most of the other genes.\n\n### Adult - Adult vs. Seed\n\n- All genes show elevated expression relative to Seed.\n\n- VIPERIN exhibits fold change in expression >2-fold higher than the other genes.\n\n### Adult - Adult vs. Spat\n\n- All genes show elevated expression relative to Spat.\n\n- All genes have similar fold changes in expression, with ATP synthase and DNMT1 showing the highest levels of fold change in expression.\n\n### Adult - Spat vs. Seed\n\n- All genes show elevated expression relative to Seed.\n\n- Most genes have similar fold changes in expression.\n\n- VIPERIN exhibits fold change in a expression ~2-fold higher than the other genes.\n\n### Conditioning by Target and Lifestage\n\n- All genes show elevated expression relative to Control.\n\n- VIPERIN, citrate synthase, and ATP synthase show an initial increase in fold change expression from seed to spat life stages, declining to juvenile and adult lifestages.\n\n- HSP90 shows level fold changes in expression across seed, spat, and juvenile lifestages, followed by a decrease in the adult stage.\n\n- DNMT1 exhibits a drastic decrease in fold change expression from seed to spat, followed by a substantial increase from spat to adult.\n\n- cGAS and HSP70 exhibit decreases from seed to spat, followed by a sharp increase from spat to juvenile. This is followed by a moderate decrease from juvenile to adult by cGAS and a sharp decrease in HSP70.\n\n::: {.callout-note}\nThe post below is markdown generated from [01.01-qPCR.Rmd](https://github.com/RobertsLab/project-gigas-carryover/blob/main/lifestage_carryover/scripts/01.01-qPCR.Rmd) (commit `71b99c4`).\n\nAriana added everything _after_ [`### 9.2.5 Acute treatment comparison`](#acute-treatment-comparison).\n:::\n\n\n\n# 1 Description\n\nThis notebook performs pair-wise comparisons of qPCR gene expression,\nnormalized to `GAPDH` expression. It calculates delta Cq, delta delta\nCq, and fold changes in expression. Additionally, it generates box plots\n(delta Cq), and bar plots (fold change expression).\n\n# 2 Set variables\n\n## 2.1 Set sample groups\n\nGroups are named in the following fashion:\n\n`<life.stage>.<conditioning.treatment>.<acute.treatment>`\n\nThis allows for parsing downstream.\n\nNOTE: Below is the full set of groups for the *entire experiment*. For\nthe current qPCR analysis, `seed` and `spat` do *not* have acute\ntreatments; just conditioning treatments.\n\n``` r\nseed.control.ambient=c(\"29\", \"40\", \"55\", \"63\", \"69\", \"101\", \"119\", \"122\", \"155\", \"164\", \"187\", \"202\", \"209\", \"214\", \"233\", \"236\", \"275\")\nseed.control.high=c(\"42\", \"59\", \"60\", \"62\", \"86\", \"102\", \"140\", \"176\", \"177\", \"184\", \"192\", \"223\", \"234\", \"243\", \"244\", \"254\", \"264\")\nseed.treated.ambient=c(\"14\", \"48\", \"66\", \"72\", \"89\", \"115\", \"129\", \"138\", \"156\", \"182\", \"191\", \"201\", \"227\", \"239\", \"270\", \"277\", \"280\")\nseed.treated.high=c(\"15\", \"19\", \"24\", \"88\", \"92\", \"105\", \"111\", \"113\", \"120\", \"128\", \"161\", \"200\", \"211\", \"256\", \"257\", \"266\", \"285\")\nspat.control.ambient=c(\"11\", \"30\", \"36\", \"52\", \"77\", \"114\", \"134\", \"142\", \"144\", \"183\", \"193\", \"229\", \"230\", \"231\", \"240\", \"272\", \"287\")\nspat.control.high=c(\"27\", \"74\", \"93\", \"96\", \"97\", \"137\", \"143\", \"153\", \"168\", \"178\", \"189\", \"206\", \"262\", \"274\", \"282\", \"284\", \"289\")\nspat.treated.ambient=c(\"9\", \"13\", \"38\", \"46\", \"47\", \"121\", \"145\", \"151\", \"174\", \"194\", \"197\", \"198\", \"216\", \"235\", \"241\", \"252\", \"291\")\nspat.treated.high=c(\"6\", \"25\", \"50\", \"78\", \"124\", \"126\", \"131\", \"160\", \"163\", \"172\", \"220\", \"226\", \"242\", \"253\", \"296\", \"298\")\njuvenile.control.ambient=c(\"18\", \"57\", \"65\", \"75\", \"79\", \"104\", \"110\", \"123\", \"125\", \"171\", \"175\", \"205\", \"238\", \"273\", \"279\", \"293\", \"317\")\njuvenile.control.high=c(\"12\", \"39\", \"43\", \"49\", \"71\", \"130\", \"141\", \"146\", \"150\", \"170\", \"195\", \"297\", \"301\", \"324\", \"351\", \"355\", \"371\")\njuvenile.treated.ambient=c(\"1\", \"34\", \"64\", \"83\", \"98\", \"147\", \"152\", \"158\", \"162\", \"169\", \"188\", \"271\", \"295\", \"310\", \"357\", \"361\", \"381\")\njuvenile.treated.high=c(\"28\", \"53\", \"61\", \"73\", \"81\", \"106\", \"109\", \"139\", \"149\", \"173\", \"181\", \"213\", \"290\", \"302\", \"311\", \"364\", \"392\")\nadult.control.ambient=c(\"3\", \"5\", \"13*\", \"16\", \"17\", \"80\", \"87\", \"94\", \"148\", \"159\", \"179\", \"180\", \"250\", \"258\", \"268\", \"312\", \"326\", \"330\", \"334\", \"346\", \"360\", \"377\", \"379\", \"386\")\nadult.control.high=c(\"20\", \"23\", \"26\", \"32\", \"33\", \"67\", \"70\", \"90\", \"107\", \"132\", \"135\", \"157\", \"166\", \"186\", \"207\", \"215\", \"248\", \"316\", \"341\", \"344\", \"349\", \"382\", \"394\", \"395\")\nadult.treated.ambient=c(\"7\", \"31\", \"35\", \"37\", \"41\", \"54\", \"84\", \"100\", \"112\", \"116\", \"118\", \"133\", \"154\", \"199\", \"203\", \"204\", \"208\", \"219\", \"294\", \"318\", \"339\", \"353\", \"363\", \"378\")\nadult.treated.high=c(\"21\", \"22\", \"45\", \"82\", \"85\", \"91\", \"95\", \"99\", \"103\", \"108\", \"117\", \"127\", \"165\", \"185\", \"190\", \"196\", \"232\", \"237\", \"245\", \"263\", \"276\", \"306\", \"343\", \"374\")\n```\n\n## 2.2 Assign groups to list\n\n``` r\n# Combine vectors into lists\n# Used for adding treatment info and/or subsetting downstream\n\ngroups_list <- list(juvenile.control.ambient = juvenile.control.ambient,\n                                   juvenile.control.high = juvenile.control.high,\n                                   juvenile.treated.ambient = juvenile.treated.ambient,\n                                   juvenile.treated.high = juvenile.treated.high,\n                                   adult.control.ambient = adult.control.ambient,\n                                   adult.control.high = adult.control.high,\n                                   adult.treated.ambient = adult.treated.ambient,\n                                   adult.treated.high = adult.treated.high,\n                                   seed.control.ambient = seed.control.ambient,\n                                   seed.control.high = seed.control.high,\n                                   seed.treated.ambient = seed.treated.ambient,\n                                   seed.treated.high = seed.treated.high,\n                                   spat.control.ambient = spat.control.ambient,\n                                   spat.control.high = spat.control.high,\n                                   spat.treated.ambient = spat.treated.ambient,\n                                   spat.treated.high = spat.treated.high)\n```\n\n# 3 Functions\n\n## 3.1 Calculate delta Cq\n\nNormalized to designated normalizing gene\n\n``` r\ncalculate_delta_Cq <- function(df) {\n  df <- df %>%\n    group_by(Sample) %>%\n    mutate(delta_Cq = Cq.Mean - Cq.Mean[Target == \"GAPDH\"]) %>%\n    ungroup()\n  \n  return(df)\n}\n```\n\n## 3.2 Create delta Cq boxplots\n\n### 3.2.1 Lifestage comparison\n\n``` r\n# Function to create box plots for each comparison\ncreate_boxplot_delta_Cq <- function(data, comparison, t_test_results) {\n  # Extract life stages from comparison\n  life_stages <- unlist(strsplit(comparison, \"\\\\.\"))\n\n  # Debugging: Print life stages\n  # print(paste(\"Life stages for comparison:\", comparison))\n  # print(life_stages)\n\n  # Filter data for the relevant life stages\n  filtered_data <- data %>%\n    filter(life.stage %in% life_stages)\n\n  # Debugging: Print filtered data\n  # print(\"Filtered data:\")\n  # print(filtered_data)\n\n  # Check if both life stages are included\n  if (!all(life_stages %in% unique(filtered_data$life.stage))) {\n    stop(\"Not all life stages are included in the filtered data\")\n  }\n\n  y_limits <- range(filtered_data$delta_Cq, na.rm = TRUE)\n\n  # Debugging: Print y_limits\n  # print(\"Y limits:\")\n  # print(y_limits)\n\n  # Filter t_test_results for the current comparison\n  t_test_results_filtered <- t_test_results %>%\n    filter(comparison == !!comparison)\n\n  # Debugging: Print filtered t_test_results\n  # print(\"Filtered t_test_results:\")\n  # print(t_test_results_filtered)\n\n  # Filter t_test_results for asterisks\n  t_test_results_with_asterisks <- t_test_results_filtered %>%\n    filter(asterisk != \"\")\n\n  # Debugging: Print t_test_results_with_asterisks\n  # print(\"t_test_results_with_asterisks:\")\n  # print(t_test_results_with_asterisks)\n\n  formatted_title <- paste0(toupper(substring(life_stages[1], 1, 1)), substring(life_stages[1], 2), \n                            \" vs. \", \n                            toupper(substring(life_stages[2], 1, 1)), substring(life_stages[2], 2))\n\n  boxplot <- ggplot(filtered_data, aes(x = Target, y = delta_Cq, fill = life.stage)) +\n    geom_boxplot(position = position_dodge(width = 0.75)) +\n    theme_minimal() +\n    theme(legend.position = \"right\") +\n    scale_fill_manual(values=c(\"darkgray\", \"salmon\", \"lightblue\", \"lightgreen\")) +\n    ylim(y_limits) +\n    labs(x = \"Target\", y = \"Delta Cq\", title = formatted_title) +\n    # Highlighted section: Adds asterisks\n    geom_text(data = t_test_results_with_asterisks, \n              aes(x = Target, y = y_limits[2] - 1, label = asterisk), \n              vjust = -0.5, size = 8, color = \"black\", inherit.aes = FALSE)\n\n  print(boxplot)\n}\n```\n\n### 3.2.2 Conditioning comparisons\n\n1.  Extract Life Stage and Conditioning Treatments:\n\n- The comparison string is split into its components (`life_stage`,\n  `treatment1`, and `treatment2`).\n\n2.  Filter Data:\n\n- The filtered_data data frame is filtered to include only the rows with\n  the relevant life stage and conditioning treatments.\n\n3.  Check for Both Treatments:\n\n- Ensure that both treatments are included in the `filtered_data`.\n\n4.  Filter T-Test Results:\n\n- The `t_test_results_filtered` data frame is filtered for the specific\n  comparison.\n\n- The `t_test_results_with_asterisks` data frame is created to include\n  only the rows with asterisks.\n\n5.  Format the Title:\n\n- The `formatted_title` variable is created by capitalizing the first\n  letter of each component and concatenating them with ” - ” and ” vs. ”\n  in between.\n\n- This should create box plots comparing conditioning treatments within\n  each life stage, with titles formatted as\n  `<life.stage> - Treated vs. Control`.\n\n``` r\n# Function to create box plots for each comparison of conditioning treatments within life stages\ncreate_boxplot_conditioning <- function(data, comparison, t_test_results) {\n  # Extract life stage and conditioning treatments from comparison\n  comparison_parts <- unlist(strsplit(comparison, \"\\\\.\"))\n  life_stage <- comparison_parts[1]\n  treatment1 <- comparison_parts[2]\n  treatment2 <- comparison_parts[3]\n\n  # Debugging: Print life stage and treatments\n  # print(paste(\"Life stage and treatments for comparison:\", comparison))\n  # print(c(life_stage, treatment1, treatment2))\n\n  # Filter data for the relevant life stage and conditioning treatments\n  filtered_data <- data %>%\n    filter(life.stage == life_stage, conditioning.treatment %in% c(treatment1, treatment2))\n\n  # Debugging: Print filtered data\n  # print(\"Filtered data:\")\n  # print(filtered_data)\n\n  # Check if both treatments are included\n  if (!all(c(treatment1, treatment2) %in% unique(filtered_data$conditioning.treatment))) {\n    stop(\"Not all treatments are included in the filtered data\")\n  }\n\n  y_limits <- range(filtered_data$delta_Cq, na.rm = TRUE)\n\n  # Debugging: Print y_limits\n  # print(\"Y limits:\")\n  # print(y_limits)\n\n  # Filter t_test_results for the current comparison\n  t_test_results_filtered <- t_test_results %>%\n    filter(comparison == !!comparison)\n\n  # Debugging: Print filtered t_test_results\n  # print(\"Filtered t_test_results:\")\n  # print(t_test_results_filtered)\n\n  # Filter t_test_results for asterisks\n  t_test_results_with_asterisks <- t_test_results_filtered %>%\n    filter(asterisk != \"\")\n\n  # Debugging: Print t_test_results_with_asterisks\n  # print(\"t_test_results_with_asterisks:\")\n  # print(t_test_results_with_asterisks)\n\n  # Format the title\n  formatted_title <- paste0(toupper(substring(life_stage, 1, 1)), substring(life_stage, 2), \n                            \" - \", \n                            toupper(substring(treatment1, 1, 1)), substring(treatment1, 2), \n                            \" vs. \", \n                            toupper(substring(treatment2, 1, 1)), substring(treatment2, 2))\n\n  boxplot <- ggplot(filtered_data, aes(x = Target, y = delta_Cq, fill = conditioning.treatment)) +\n    geom_boxplot(position = position_dodge(width = 0.75)) +\n    theme_minimal() +\n    theme(legend.position = \"right\") +\n    scale_fill_manual(values=c(\"darkgray\", \"salmon\")) +\n    ylim(y_limits) +\n    labs(x = \"Target\", y = \"Delta Cq\", title = formatted_title) +\n    # Highlighted section: Adds asterisks\n    geom_text(data = t_test_results_with_asterisks, \n              aes(x = Target, y = y_limits[2] - 1, label = asterisk), \n              vjust = -0.5, size = 8, color = \"black\", inherit.aes = FALSE)\n\n  print(boxplot)\n}\n```\n\n### 3.2.3 Acute comparisons\n\n1.  Extract Life Stage and Acute Treatments:\n\n- The comparison string is split into its components (`life_stage`,\n  `treatment1`, and `treatment2`).\n\n2.  Filter Data:\n\n- The `filtered_data` data frame is filtered to include only the rows\n  with the relevant life stage and acute treatments.\n\n3.  Check for Both Treatments:\n\n- Ensure that both treatments are included in the `filtered_data`.\n\n4.  Filter T-Test Results:\n\n- The `t_test_results_filtered` data frame is filtered for the specific\n  comparison.\n\n- The `t_test_results_with_asterisks` data frame is created to include\n  only the rows with asterisks. Format the Title:\n\n5.  The formatted_title variable is created by capitalizing the first\n    letter of each component and concatenating them with ” - ” and ”\n    vs. ” in between.\n\n- This should create box plots comparing acute treatments within each\n  life stage, with titles formatted as\n  `<life.stage> - Ambient vs. High`.\n\n``` r\n# Function to create box plots for each comparison of acute treatments within life stages\ncreate_boxplot_acute <- function(data, comparison, t_test_results) {\n  # Extract life stage and acute treatments from comparison\n  comparison_parts <- unlist(strsplit(comparison, \"\\\\.\"))\n  life_stage <- comparison_parts[1]\n  treatment1 <- comparison_parts[2]\n  treatment2 <- comparison_parts[3]\n\n  # Debugging: Print life stage and treatments\n  # print(paste(\"Life stage and treatments for comparison:\", comparison))\n  # print(c(life_stage, treatment1, treatment2))\n\n  # Filter data for the relevant life stage and acute treatments\n  filtered_data <- data %>%\n    filter(life.stage == life_stage, acute.treatment %in% c(treatment1, treatment2))\n\n  # Debugging: Print filtered data\n  # print(\"Filtered data:\")\n  # print(filtered_data)\n\n  # Check if both treatments are included\n  if (!all(c(treatment1, treatment2) %in% unique(filtered_data$acute.treatment))) {\n    stop(\"Not all treatments are included in the filtered data\")\n  }\n\n  y_limits <- range(filtered_data$delta_Cq, na.rm = TRUE)\n\n  # Debugging: Print y_limits\n  # print(\"Y limits:\")\n  # print(y_limits)\n\n  # Filter t_test_results for the current comparison\n  t_test_results_filtered <- t_test_results %>%\n    filter(comparison == !!comparison)\n\n  # Debugging: Print filtered t_test_results\n  # print(\"Filtered t_test_results:\")\n  # print(t_test_results_filtered)\n\n  # Filter t_test_results for asterisks\n  t_test_results_with_asterisks <- t_test_results_filtered %>%\n    filter(asterisk != \"\")\n\n  # Debugging: Print t_test_results_with_asterisks\n  # print(\"t_test_results_with_asterisks:\")\n  # print(t_test_results_with_asterisks)\n\n  # Format the title\n  formatted_title <- paste0(toupper(substring(life_stage, 1, 1)), substring(life_stage, 2), \n                            \" - \", \n                            toupper(substring(treatment1, 1, 1)), substring(treatment1, 2), \n                            \" vs. \", \n                            toupper(substring(treatment2, 1, 1)), substring(treatment2, 2))\n\n  boxplot <- ggplot(filtered_data, aes(x = Target, y = delta_Cq, fill = acute.treatment)) +\n    geom_boxplot(position = position_dodge(width = 0.75)) +\n    theme_minimal() +\n    theme(legend.position = \"right\") +\n    scale_fill_manual(values=c(\"darkgray\", \"salmon\")) +\n    ylim(y_limits) +\n    labs(x = \"Target\", y = \"Delta Cq\", title = formatted_title) +\n    # Highlighted section: Adds asterisks\n    geom_text(data = t_test_results_with_asterisks, \n              aes(x = Target, y = y_limits[2] - 1, label = asterisk), \n              vjust = -0.5, size = 8, color = \"magenta\", inherit.aes = FALSE)\n\n  print(boxplot)\n}\n```\n\n### 3.2.4 Acute treatements within life stage conditioning\n\n``` r\n# Function to create box plots for each comparison of acute treatments within life stages and conditioning treatments\ncreate_boxplot_acute_conditioning <- function(data, comparison, t_test_results) {\n  # Extract life stage, conditioning treatment, and acute treatments from comparison\n  comparison_parts <- unlist(strsplit(comparison, \"\\\\.\"))\n  life_stage <- comparison_parts[1]\n  conditioning_treatment <- comparison_parts[2]\n  treatment1 <- comparison_parts[3]\n  treatment2 <- comparison_parts[5]\n\n  # Filter data for the relevant life stage, conditioning treatment, and acute treatments\n  filtered_data <- data %>%\n    filter(life.stage == life_stage, conditioning.treatment == conditioning_treatment, acute.treatment %in% c(treatment1, treatment2))\n\n  # Check if both treatments are included\n  if (!all(c(treatment1, treatment2) %in% unique(filtered_data$acute.treatment))) {\n    stop(\"Not all treatments are included in the filtered data\")\n  }\n\n  y_limits <- range(filtered_data$delta_Cq, na.rm = TRUE)\n\n  # Filter t_test_results for the current comparison\n  t_test_results_filtered <- t_test_results %>%\n    filter(comparison == !!comparison)\n\n  # Filter t_test_results for asterisks\n  t_test_results_with_asterisks <- t_test_results_filtered %>%\n    filter(asterisk != \"\")\n\n  # Format the title\n  formatted_title <- paste0(toupper(substring(life_stage, 1, 1)), substring(life_stage, 2), \n                            \" - \", \n                            toupper(substring(conditioning_treatment, 1, 1)), substring(conditioning_treatment, 2), \n                            \" - \", \n                            toupper(substring(treatment1, 1, 1)), substring(treatment1, 2), \n                            \" vs. \", \n                            toupper(substring(treatment2, 1, 1)), substring(treatment2, 2))\n\n  boxplot <- ggplot(filtered_data, aes(x = Target, y = delta_Cq, fill = acute.treatment)) +\n    geom_boxplot(position = position_dodge(width = 0.75)) +\n    theme_minimal() +\n    theme(legend.position = \"right\") +\n    scale_fill_manual(values=c(\"darkgray\", \"salmon\")) +\n    ylim(y_limits) +\n    labs(x = \"Target\", y = \"Delta Cq\", title = formatted_title) +\n    # Adds asterisks\n    geom_text(data = t_test_results_with_asterisks, \n              aes(x = Target, y = y_limits[2] - 1, label = asterisk), \n              vjust = -0.5, size = 8, color = \"black\", inherit.aes = FALSE)\n\n  print(boxplot)\n}\n```\n\n# 4 Read in files\n\n``` r\n# Get a list of all CSV files in the directory with the naming structure \"*Cq-Results.csv\"\ncq_file_list <- list() # Initialize list\ncq_file_list <- list.files(path = cqs_directory, pattern = \"Cq-Results\\\\.csv$\", full.names = TRUE)\n\n# Initialize an empty list to store the data frames\ndata_frames_list <- list()\n\n# Loop through each file and read it into a data frame, then add it to the list\nfor (file in cq_file_list) {\n  data <- read.csv(file, header = TRUE)\n  data$Sample <- as.character(data$Sample)  # Convert Sample column to character type\n  data_frames_list[[file]] <- data\n}\n\n# Combine all data frames into a single data frame\ncombined_df <- bind_rows(data_frames_list, .id = \"data_frame_id\")\n\nstr(combined_df)\n```\n\n    'data.frame':   2816 obs. of  17 variables:\n     $ data_frame_id         : chr  \"../data/qPCR/Cq/sam_2024-03-25_06-10-54_Connect-Quantification-Cq-Results.csv\" \"../data/qPCR/Cq/sam_2024-03-25_06-10-54_Connect-Quantification-Cq-Results.csv\" \"../data/qPCR/Cq/sam_2024-03-25_06-10-54_Connect-Quantification-Cq-Results.csv\" \"../data/qPCR/Cq/sam_2024-03-25_06-10-54_Connect-Quantification-Cq-Results.csv\" ...\n     $ X                     : logi  NA NA NA NA NA NA ...\n     $ Well                  : chr  \"A01\" \"A02\" \"A03\" \"A04\" ...\n     $ Fluor                 : chr  \"SYBR\" \"SYBR\" \"SYBR\" \"SYBR\" ...\n     $ Target                : chr  \"ATPsynthase\" \"ATPsynthase\" \"ATPsynthase\" \"ATPsynthase\" ...\n     $ Content               : chr  \"Unkn-01\" \"Unkn-01\" \"Unkn-02\" \"Unkn-02\" ...\n     $ Sample                : chr  \"206\" \"206\" \"220\" \"220\" ...\n     $ Biological.Set.Name   : logi  NA NA NA NA NA NA ...\n     $ Cq                    : num  26.7 26.7 25.8 25.9 25.1 ...\n     $ Cq.Mean               : num  26.7 26.7 25.9 25.9 25.1 ...\n     $ Cq.Std..Dev           : num  0.0455 0.0455 0.0239 0.0239 0.0813 ...\n     $ Starting.Quantity..SQ.: num  NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ Log.Starting.Quantity : num  NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ SQ.Mean               : num  NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ SQ.Std..Dev           : num  NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ Set.Point             : int  60 60 60 60 60 60 60 60 60 60 ...\n     $ Well.Note             : logi  NA NA NA NA NA NA ...\n\n# 5 Clean data\n\n## 5.1 Replace target names\n\n``` r\n# Remove rows with Sample name \"NTC\"\ncombined_df <- combined_df[combined_df$Sample != \"NTC\", ]\n\n\n# Replace values in the Target column\ncombined_df$Target <- gsub(\"Cg_GAPDH_205_F-355_R \\\\(SR IDs: 1172/3\\\\)\", \"GAPDH\", combined_df$Target)\n\ncombined_df$Target <- gsub(\"Cg_ATPsynthase_F/R \\\\(SR IDs: 1385/6\\\\)\", \"ATPsynthase\", combined_df$Target)\n\ncombined_df$Target <- gsub(\"Cg_cGAS \\\\(SR IDs: 1826/7\\\\)\", \"cGAS\", combined_df$Target)\n\ncombined_df$Target <- gsub(\"Cg_citrate_synthase \\\\(SR IDs: 1383/4\\\\)\", \"citrate synthase\", combined_df$Target)\n\ncombined_df$Target <- gsub(\"Cg_DNMT1_F \\\\(SR IDs: 1510/1\\\\)\", \"DNMT1\", combined_df$Target)\n\ncombined_df$Target <- gsub(\"Cg_HSP70_F/R \\\\(SR IDs: 598/9\\\\)\", \"HSP70\", combined_df$Target)\n\ncombined_df$Target <- gsub(\"Cg_Hsp90_F/R \\\\(SR IDs: 1532/3\\\\)\", \"HSP90\", combined_df$Target)\n\ncombined_df$Target <- gsub(\"Cg_VIPERIN_F/R \\\\(SR IDs: 1828/9\\\\)\", \"viperin\", combined_df$Target)\n\nstr(combined_df)\n```\n\n    'data.frame':   2801 obs. of  17 variables:\n     $ data_frame_id         : chr  \"../data/qPCR/Cq/sam_2024-03-25_06-10-54_Connect-Quantification-Cq-Results.csv\" \"../data/qPCR/Cq/sam_2024-03-25_06-10-54_Connect-Quantification-Cq-Results.csv\" \"../data/qPCR/Cq/sam_2024-03-25_06-10-54_Connect-Quantification-Cq-Results.csv\" \"../data/qPCR/Cq/sam_2024-03-25_06-10-54_Connect-Quantification-Cq-Results.csv\" ...\n     $ X                     : logi  NA NA NA NA NA NA ...\n     $ Well                  : chr  \"A01\" \"A02\" \"A03\" \"A04\" ...\n     $ Fluor                 : chr  \"SYBR\" \"SYBR\" \"SYBR\" \"SYBR\" ...\n     $ Target                : chr  \"ATPsynthase\" \"ATPsynthase\" \"ATPsynthase\" \"ATPsynthase\" ...\n     $ Content               : chr  \"Unkn-01\" \"Unkn-01\" \"Unkn-02\" \"Unkn-02\" ...\n     $ Sample                : chr  \"206\" \"206\" \"220\" \"220\" ...\n     $ Biological.Set.Name   : logi  NA NA NA NA NA NA ...\n     $ Cq                    : num  26.7 26.7 25.8 25.9 25.1 ...\n     $ Cq.Mean               : num  26.7 26.7 25.9 25.9 25.1 ...\n     $ Cq.Std..Dev           : num  0.0455 0.0455 0.0239 0.0239 0.0813 ...\n     $ Starting.Quantity..SQ.: num  NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ Log.Starting.Quantity : num  NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ SQ.Mean               : num  NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ SQ.Std..Dev           : num  NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ Set.Point             : int  60 60 60 60 60 60 60 60 60 60 ...\n     $ Well.Note             : logi  NA NA NA NA NA NA ...\n\n``` r\nlevels(as.factor(combined_df$Target))\n```\n\n    [1] \"ATPsynthase\"      \"cGAS\"             \"citrate synthase\" \"DNMT1\"           \n    [5] \"GAPDH\"            \"HSP70\"            \"HSP90\"            \"viperin\"         \n\n## 5.2 Identify Samples with Cq.Std..Dev \\> 0.5\n\n``` r\n# Filter out rows where Cq.Std..Dev is NA\ncombined_df <- combined_df[!is.na(combined_df$Cq.Std..Dev), ]\n\n# Filter rows where Cq.Std..Dev is greater than 0.5\nhigh_cq_std_dev <- combined_df[combined_df$Cq.Std..Dev > 0.5, ]\n\n# Print the filtered rows with specified columns, without row names\nprint(high_cq_std_dev[, c(\"Target\", \"Sample\", \"Cq\", \"Cq.Std..Dev\")], row.names = FALSE)\n```\n\n               Target Sample       Cq Cq.Std..Dev\n                HSP70    244 33.10339   4.0838809\n                HSP70    244 27.32791   4.0838809\n                HSP90    223 24.85319   0.7548714\n                HSP90    223 25.92074   0.7548714\n              viperin    223 30.30089   0.6058663\n              viperin    223 31.15772   0.6058663\n              viperin    243 32.57817   0.5527617\n              viperin    243 33.35989   0.5527617\n                DNMT1    296 31.21374   0.6417578\n                DNMT1    296 30.30616   0.6417578\n                DNMT1    298 35.68716   0.5406704\n                DNMT1    298 34.92253   0.5406704\n                DNMT1    223 32.24089   0.6214201\n                DNMT1    223 33.11971   0.6214201\n                DNMT1    243 36.63921   0.5125743\n                DNMT1    243 35.91432   0.5125743\n                DNMT1    285 33.63443   0.7036122\n                DNMT1    285 34.62949   0.7036122\n                GAPDH    316 23.94926   8.5684728\n                GAPDH    316 24.14183   8.5684728\n                GAPDH    316 38.88564   8.5684728\n                GAPDH    213 26.98012   2.2910353\n                GAPDH    213 23.00009   2.2910353\n                GAPDH    213 26.95634   2.2910353\n                GAPDH    263 22.42154   0.8731474\n                GAPDH    263 23.77008   0.8731474\n                GAPDH    263 24.05667   0.8731474\n     citrate synthase    230 24.44066   4.4783429\n     citrate synthase    230 24.40421   4.4783429\n     citrate synthase    230 32.17909   4.4783429\n              viperin    227 30.47773   3.5152533\n              viperin    227 30.37738   3.5152533\n              viperin    227 36.51553   3.5152533\n              viperin    245 26.05748   5.1635899\n              viperin    245 34.98192   5.1635899\n              viperin    245 26.01928   5.1635899\n              viperin    341 26.48675   2.9838590\n              viperin    341 31.67235   2.9838590\n              viperin    341 26.52174   2.9838590\n              viperin    344 29.98184   2.3712440\n              viperin    344 25.90358   2.3712440\n              viperin    344 25.84648   2.3712440\n              viperin    355 28.79712   0.5821437\n              viperin    355 29.57428   0.5821437\n              viperin    355 28.43490   0.5821437\n              viperin     18 30.22286   2.5813451\n              viperin     18 31.97799   2.5813451\n              viperin     18 35.30515   2.5813451\n              viperin     25 36.49472   0.6540634\n              viperin     25 35.62766   0.6540634\n              viperin     25 35.21293   0.6540634\n              viperin     62 32.44608   0.6249794\n              viperin     62 31.31507   0.6249794\n              viperin     62 31.41970   0.6249794\n              viperin     75 33.47202   1.6346910\n              viperin     75 32.63655   1.6346910\n              viperin     75 30.31693   1.6346910\n                 cGAS     14 38.23519   0.7502227\n                 cGAS     14 38.02258   0.7502227\n                 cGAS     14 39.41520   0.7502227\n                 cGAS     29 37.25712   1.2060821\n                 cGAS     29 39.31941   1.2060821\n                 cGAS     29 37.20469   1.2060821\n                 cGAS     40 36.28250   0.5469250\n                 cGAS     40 36.05499   0.5469250\n                 cGAS     40 35.24216   0.5469250\n          ATPsynthase     15 22.46831   1.6297928\n          ATPsynthase     15 25.31150   1.6297928\n          ATPsynthase     15 22.50938   1.6297928\n          ATPsynthase     18 24.52172   0.7966632\n          ATPsynthase     18 25.64075   0.7966632\n          ATPsynthase     18 24.09896   0.7966632\n                HSP70     12 27.55137   3.6393890\n                HSP70     12 33.62834   3.6393890\n                HSP70     12 27.12023   3.6393890\n                HSP70     29 35.56445   1.1431868\n                HSP70     29 37.62398   1.1431868\n                HSP70     29 35.73434   1.1431868\n                HSP70     53 27.67834   0.6164802\n                HSP70     53 26.50222   0.6164802\n                HSP70     53 26.76980   0.6164802\n                HSP90     14 36.83671   1.7075603\n                HSP90     14 39.25156   1.7075603\n                HSP90     18 25.15642   0.9422544\n                HSP90     18 24.41329   0.9422544\n                HSP90     18 23.28508   0.9422544\n                HSP90     29 38.90450   1.0457320\n                HSP90     29 37.42561   1.0457320\n                GAPDH     24 25.78634   0.6778352\n                GAPDH     24 24.82774   0.6778352\n                GAPDH     29 37.22294   1.3777016\n                GAPDH     29 39.17130   1.3777016\n\n## 5.3 Remove bad technical reps\n\n``` r\n# Group by Sample and Target, then filter out the outlier replicate\ncombined.fitered_df<- combined_df %>%\n  group_by(Sample, Target) %>%\n  filter(abs(Cq - mean(Cq, na.rm = TRUE)) <= Cq.Std..Dev)\n\n# Print the filtered data frame\nstr(combined.fitered_df)\n```\n\n    gropd_df [1,905 × 17] (S3: grouped_df/tbl_df/tbl/data.frame)\n     $ data_frame_id         : chr [1:1905] \"../data/qPCR/Cq/sam_2024-03-25_06-10-54_Connect-Quantification-Cq-Results.csv\" \"../data/qPCR/Cq/sam_2024-03-25_06-10-54_Connect-Quantification-Cq-Results.csv\" \"../data/qPCR/Cq/sam_2024-03-25_06-10-54_Connect-Quantification-Cq-Results.csv\" \"../data/qPCR/Cq/sam_2024-03-25_06-10-54_Connect-Quantification-Cq-Results.csv\" ...\n     $ X                     : logi [1:1905] NA NA NA NA NA NA ...\n     $ Well                  : chr [1:1905] \"A01\" \"A02\" \"A03\" \"A04\" ...\n     $ Fluor                 : chr [1:1905] \"SYBR\" \"SYBR\" \"SYBR\" \"SYBR\" ...\n     $ Target                : chr [1:1905] \"ATPsynthase\" \"ATPsynthase\" \"ATPsynthase\" \"ATPsynthase\" ...\n     $ Content               : chr [1:1905] \"Unkn-01\" \"Unkn-01\" \"Unkn-02\" \"Unkn-02\" ...\n     $ Sample                : chr [1:1905] \"206\" \"206\" \"220\" \"220\" ...\n     $ Biological.Set.Name   : logi [1:1905] NA NA NA NA NA NA ...\n     $ Cq                    : num [1:1905] 26.7 26.7 25.8 25.9 25.1 ...\n     $ Cq.Mean               : num [1:1905] 26.7 26.7 25.9 25.9 25.1 ...\n     $ Cq.Std..Dev           : num [1:1905] 0.0455 0.0455 0.0239 0.0239 0.0813 ...\n     $ Starting.Quantity..SQ.: num [1:1905] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ Log.Starting.Quantity : num [1:1905] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ SQ.Mean               : num [1:1905] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ SQ.Std..Dev           : num [1:1905] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ Set.Point             : int [1:1905] 60 60 60 60 60 60 60 60 60 60 ...\n     $ Well.Note             : logi [1:1905] NA NA NA NA NA NA ...\n     - attr(*, \"groups\")= tibble [956 × 3] (S3: tbl_df/tbl/data.frame)\n      ..$ Sample: chr [1:956] \"12\" \"12\" \"12\" \"12\" ...\n      ..$ Target: chr [1:956] \"ATPsynthase\" \"DNMT1\" \"GAPDH\" \"HSP70\" ...\n      ..$ .rows : list<int> [1:956] \n      .. ..$ : int [1:2] 1616 1617\n      .. ..$ : int [1:2] 1712 1713\n      .. ..$ : int [1:2] 1857 1858\n      .. ..$ : int [1:2] 1758 1759\n      .. ..$ : int [1:2] 1807 1808\n      .. ..$ : int [1:2] 1566 1567\n      .. ..$ : int [1:2] 1664 1665\n      .. ..$ : int [1:2] 1521 1522\n      .. ..$ : int 1618\n      .. ..$ : int 1859\n      .. ..$ : int 1760\n      .. ..$ : int [1:2] 1809 1810\n      .. ..$ : int [1:2] 1568 1569\n      .. ..$ : int 1666\n      .. ..$ : int [1:2] 1619 1620\n      .. ..$ : int [1:2] 1714 1715\n      .. ..$ : int [1:2] 1860 1861\n      .. ..$ : int [1:2] 1761 1762\n      .. ..$ : int [1:2] 1811 1812\n      .. ..$ : int [1:2] 1570 1571\n      .. ..$ : int [1:2] 1667 1668\n      .. ..$ : int [1:2] 1523 1524\n      .. ..$ : int [1:2] 1621 1622\n      .. ..$ : int [1:2] 1716 1717\n      .. ..$ : int [1:2] 1862 1863\n      .. ..$ : int [1:2] 1763 1764\n      .. ..$ : int [1:2] 1813 1814\n      .. ..$ : int [1:2] 1572 1573\n      .. ..$ : int [1:2] 1669 1670\n      .. ..$ : int [1:2] 1525 1526\n      .. ..$ : int [1:2] 1623 1624\n      .. ..$ : int [1:2] 1718 1719\n      .. ..$ : int [1:2] 1864 1865\n      .. ..$ : int [1:2] 1765 1766\n      .. ..$ : int [1:2] 1815 1816\n      .. ..$ : int [1:2] 1574 1575\n      .. ..$ : int [1:2] 1671 1672\n      .. ..$ : int [1:2] 1527 1528\n      .. ..$ : int [1:2] 21 22\n      .. ..$ : int [1:2] 245 246\n      .. ..$ : int [1:2] 85 86\n      .. ..$ : int [1:2] 53 54\n      .. ..$ : int [1:2] 117 118\n      .. ..$ : int [1:2] 149 150\n      .. ..$ : int [1:2] 213 214\n      .. ..$ : int [1:2] 181 182\n      .. ..$ : int [1:2] 321 322\n      .. ..$ : int [1:2] 889 890\n      .. ..$ : int [1:2] 637 638\n      .. ..$ : int [1:2] 1047 1048\n      .. ..$ : int [1:2] 1205 1206\n      .. ..$ : int [1:2] 479 480\n      .. ..$ : int [1:2] 731 732\n      .. ..$ : int [1:2] 1363 1364\n      .. ..$ : int [1:2] 323 324\n      .. ..$ : int [1:2] 891 892\n      .. ..$ : int [1:2] 639 640\n      .. ..$ : int [1:2] 1049 1050\n      .. ..$ : int [1:2] 1207 1208\n      .. ..$ : int [1:2] 481 482\n      .. ..$ : int [1:2] 733 734\n      .. ..$ : int [1:2] 1365 1366\n      .. ..$ : int [1:2] 325 326\n      .. ..$ : int [1:2] 893 894\n      .. ..$ : int [1:2] 641 642\n      .. ..$ : int [1:2] 1051 1052\n      .. ..$ : int [1:2] 1209 1210\n      .. ..$ : int [1:2] 483 484\n      .. ..$ : int [1:2] 735 736\n      .. ..$ : int [1:2] 1367 1368\n      .. ..$ : int [1:2] 327 328\n      .. ..$ : int [1:2] 895 896\n      .. ..$ : int [1:2] 643 644\n      .. ..$ : int [1:2] 1053 1054\n      .. ..$ : int [1:2] 1211 1212\n      .. ..$ : int [1:2] 485 486\n      .. ..$ : int [1:2] 737 738\n      .. ..$ : int [1:2] 1369 1370\n      .. ..$ : int [1:2] 329 330\n      .. ..$ : int [1:2] 897 898\n      .. ..$ : int [1:2] 645 646\n      .. ..$ : int [1:2] 1055 1056\n      .. ..$ : int [1:2] 1213 1214\n      .. ..$ : int [1:2] 487 488\n      .. ..$ : int [1:2] 739 740\n      .. ..$ : int [1:2] 1371 1372\n      .. ..$ : int [1:2] 1 2\n      .. ..$ : int [1:2] 225 226\n      .. ..$ : int [1:2] 65 66\n      .. ..$ : int [1:2] 33 34\n      .. ..$ : int [1:2] 97 98\n      .. ..$ : int [1:2] 129 130\n      .. ..$ : int [1:2] 193 194\n      .. ..$ : int [1:2] 161 162\n      .. ..$ : int [1:2] 331 332\n      .. ..$ : int [1:2] 899 900\n      .. ..$ : int [1:2] 647 648\n      .. ..$ : int [1:2] 1057 1058\n      .. ..$ : int [1:2] 1215 1216\n      .. .. [list output truncated]\n      .. ..@ ptype: int(0) \n      ..- attr(*, \".drop\")= logi TRUE\n\n# 6 Group samples by target\n\n``` r\n# Group by Sample and Target, then summarize to get unique rows for each sample\ngrouped_df <- combined.fitered_df%>%\n  group_by(Sample, Target) %>%\n  summarize(Cq.Mean = mean(Cq, na.rm = TRUE)) %>%\n  ungroup()\n\nstr(grouped_df)\n```\n\n    tibble [956 × 3] (S3: tbl_df/tbl/data.frame)\n     $ Sample : chr [1:956] \"12\" \"12\" \"12\" \"12\" ...\n     $ Target : chr [1:956] \"ATPsynthase\" \"DNMT1\" \"GAPDH\" \"HSP70\" ...\n     $ Cq.Mean: num [1:956] 27.6 32.5 26 27.3 26.8 ...\n\n# 7 Add life stage and treatment cols\n\n``` r\n# Initialize new columns\ngrouped_df <- grouped_df %>%\n  mutate(life.stage = NA_character_,\n         conditioning.treatment = NA_character_,\n         acute.treatment = NA_character_)\n\n# Loop through each vector\nfor (vec_name in names(groups_list)) {\n  vec <- groups_list[[vec_name]]\n  stage <- strsplit(vec_name, \"\\\\.\")[[1]][1]\n  conditioning_treatment <- strsplit(vec_name, \"\\\\.\")[[1]][2]\n  acute_treatment <- strsplit(vec_name, \"\\\\.\")[[1]][3]\n  \n  # Loop through each row in grouped_df\n  for (i in 1:nrow(grouped_df)) {\n    sample <- grouped_df$Sample[i]\n    \n    # Check if sample is in the vector\n    if (sample %in% vec) {\n      # Update life.stage and treatment columns\n      grouped_df$life.stage[i] <- stage\n      grouped_df$conditioning.treatment[i] <- conditioning_treatment\n      grouped_df$acute.treatment[i] <-acute_treatment\n    }\n  }\n}\n\nstr(grouped_df)\n```\n\n    tibble [956 × 6] (S3: tbl_df/tbl/data.frame)\n     $ Sample                : chr [1:956] \"12\" \"12\" \"12\" \"12\" ...\n     $ Target                : chr [1:956] \"ATPsynthase\" \"DNMT1\" \"GAPDH\" \"HSP70\" ...\n     $ Cq.Mean               : num [1:956] 27.6 32.5 26 27.3 26.8 ...\n     $ life.stage            : chr [1:956] \"juvenile\" \"juvenile\" \"juvenile\" \"juvenile\" ...\n     $ conditioning.treatment: chr [1:956] \"control\" \"control\" \"control\" \"control\" ...\n     $ acute.treatment       : chr [1:956] \"high\" \"high\" \"high\" \"high\" ...\n\n# 8 Delta Cq to Normalizing Gene\n\n``` r\n# Calculate delta Cq by subtracting GAPDH Cq.Mean from each corresponding Sample Cq.Mean\ndelta_Cq_df <- calculate_delta_Cq(grouped_df)\n\n# Filters out normalizing gene, since no need to compare normalizing gene to itself.\ndelta_Cq_df <- delta_Cq_df %>%\n  filter(!is.na(life.stage), !is.na(Target), Target != \"GAPDH\")\n\nstr(delta_Cq_df)\n```\n\n    tibble [836 × 7] (S3: tbl_df/tbl/data.frame)\n     $ Sample                : chr [1:836] \"12\" \"12\" \"12\" \"12\" ...\n     $ Target                : chr [1:836] \"ATPsynthase\" \"DNMT1\" \"HSP70\" \"HSP90\" ...\n     $ Cq.Mean               : num [1:836] 27.6 32.5 27.3 26.8 30.7 ...\n     $ life.stage            : chr [1:836] \"juvenile\" \"juvenile\" \"juvenile\" \"juvenile\" ...\n     $ conditioning.treatment: chr [1:836] \"control\" \"control\" \"control\" \"control\" ...\n     $ acute.treatment       : chr [1:836] \"high\" \"high\" \"high\" \"high\" ...\n     $ delta_Cq              : num [1:836] 1.567 6.499 1.306 0.756 4.692 ...\n\n## 8.1 t-tests\n\n### 8.1.1 Life Stages\n\nThis code does the following:\n\n1.  Extracts the unique life.stage levels from the data frame.\n2.  Generates all possible pairs of life.stage levels using the combn\n    function.\n3.  Iterates over each pair and performs the t-test for each Target.\n    Adds an asterisk column and an asterisk if the p-value is \\<= 0.05.\n    Useful for downstream parsing.\n4.  Stores the results in a list and combines them into a single data\n    frame.\n5.  Adds a comparison column to indicate which life.stage levels were\n    compared.\n\n``` r\n# Extract unique life.stage levels\nunique_life_stages <- unique(delta_Cq_df$life.stage)\n\n# Generate all possible pairs of life.stage levels\nlife_stage_pairs <- combn(unique_life_stages, 2, simplify = FALSE)\n\n# Initialize a list to store results\nlife_stage_t_test_results_list <- list()\n\nfor (pair in life_stage_pairs) {\n  stage1 <- pair[1]\n  stage2 <- pair[2]\n  \n  # Perform t-test for each Target comparing the two life.stage levels\n  t_test_results <- delta_Cq_df %>%\n    filter(life.stage %in% c(stage1, stage2)) %>%\n    group_by(Target) %>%\n    summarise(\n      t_test_result = list(t.test(delta_Cq ~ life.stage))\n    ) %>%\n    ungroup() %>%\n    mutate(\n      estimate_diff = sapply(t_test_result, function(x) x$estimate[1] - x$estimate[2]),\n      p_value = sapply(t_test_result, function(x) x$p.value),\n      asterisk = ifelse(p_value <= 0.05, \"*\", \"\"), # Adds asterisk column and asterisk for p-value.\n      comparison = paste(stage1, \"vs\", stage2, sep = \".\")\n    ) %>%\n    select(!t_test_result)\n  \n  life_stage_t_test_results_list[[paste(stage1, stage2, sep = \".\")]] <- t_test_results\n}\n\n# Combine results into a single data frame\nlife_stage_t_test_results_df <- bind_rows(life_stage_t_test_results_list, .id = \"comparison\")\n\n# View the results\nprint(life_stage_t_test_results_df)\n```\n\n    # A tibble: 42 × 5\n       Target           estimate_diff  p_value asterisk comparison    \n       <chr>                    <dbl>    <dbl> <chr>    <chr>         \n     1 ATPsynthase            0.292   0.0995   \"\"       juvenile.seed \n     2 DNMT1                 -0.0616  0.846    \"\"       juvenile.seed \n     3 HSP70                  0.976   0.0324   \"*\"      juvenile.seed \n     4 HSP90                  0.802   0.000644 \"*\"      juvenile.seed \n     5 cGAS                  -0.0369  0.924    \"\"       juvenile.seed \n     6 citrate synthase       0.158   0.502    \"\"       juvenile.seed \n     7 viperin                0.00222 0.996    \"\"       juvenile.seed \n     8 ATPsynthase           -0.252   0.124    \"\"       juvenile.adult\n     9 DNMT1                 -0.152   0.562    \"\"       juvenile.adult\n    10 HSP70                 -0.0139  0.976    \"\"       juvenile.adult\n    # ℹ 32 more rows\n\n### 8.1.2 Conditioning treatments\n\nThis code does the following:\n\n1.  Extracts the unique life.stage levels from the data frame.\n2.  For each life.stage, extracts the unique conditioning.treatment\n    levels.\n3.  Generates all possible pairs of conditioning.treatment levels within\n    each life.stage.\n4.  Iterates over each pair and performs the t-test for each Target.\n    Adds an asterisk column and an asterisk if the p-value is \\<= 0.05.\n    Useful for downstream parsing.\n5.  Stores the results in a list and combines them into a single data\n    frame.\n6.  Adds a comparison column to indicate which life.stage and\n    conditioning.treatment levels were compared.\n\n``` r\n# Extract unique life.stage levels\nunique_life_stages <- unique(delta_Cq_df$life.stage)\n\n# Initialize a list to store results\nconditioning_treatment_t_test_results_list <- list()\n\nfor (stage in unique_life_stages) {\n  # Extract unique conditioning.treatment levels within the current life.stage\n  unique_treatments <- unique(delta_Cq_df %>% filter(life.stage == stage) %>% pull(conditioning.treatment))\n  \n  # Generate all possible pairs of conditioning.treatment levels\n  treatment_pairs <- combn(unique_treatments, 2, simplify = FALSE)\n  \n  for (pair in treatment_pairs) {\n    treatment1 <- pair[1]\n    treatment2 <- pair[2]\n    \n    # Perform t-test for each Target comparing the two conditioning.treatment levels within the current life.stage\n    t_test_results <- delta_Cq_df %>%\n      filter(life.stage == stage, conditioning.treatment %in% c(treatment1, treatment2)) %>%\n      group_by(Target) %>%\n      summarise(\n        t_test_result = list(t.test(delta_Cq ~ conditioning.treatment))\n      ) %>%\n      ungroup() %>%\n      mutate(\n        estimate_diff = sapply(t_test_result, function(x) x$estimate[1] - x$estimate[2]),\n        p_value = sapply(t_test_result, function(x) x$p.value),\n        asterisk = ifelse(p_value <= 0.05, \"*\", \"\"), # Adds asterisk column and asterisk for p-value.\n        comparison = paste(stage, treatment1, \"vs\", treatment2, sep = \".\")\n      ) %>%\n      select(!t_test_result)\n    \n    conditioning_treatment_t_test_results_list[[paste(stage, treatment1, treatment2, sep = \".\")]] <- t_test_results\n  }\n}\n\n# Combine results into a single data frame\nconditioning_treatment_t_test_results_df <- bind_rows(conditioning_treatment_t_test_results_list, .id = \"comparison\")\n\n# View the results\nprint(conditioning_treatment_t_test_results_df)\n```\n\n    # A tibble: 28 × 5\n       Target           estimate_diff p_value asterisk comparison              \n       <chr>                    <dbl>   <dbl> <chr>    <chr>                   \n     1 ATPsynthase             0.427    0.103 \"\"       juvenile.control.treated\n     2 DNMT1                   0.578    0.178 \"\"       juvenile.control.treated\n     3 HSP70                  -0.587    0.351 \"\"       juvenile.control.treated\n     4 HSP90                   0.0666   0.842 \"\"       juvenile.control.treated\n     5 cGAS                    0.249    0.336 \"\"       juvenile.control.treated\n     6 citrate synthase        0.384    0.209 \"\"       juvenile.control.treated\n     7 viperin                 1.02     0.109 \"\"       juvenile.control.treated\n     8 ATPsynthase             0.110    0.592 \"\"       seed.treated.control    \n     9 DNMT1                   0.213    0.646 \"\"       seed.treated.control    \n    10 HSP70                  -0.509    0.432 \"\"       seed.treated.control    \n    # ℹ 18 more rows\n\n### 8.1.3 Acute treatments\n\nThis code does the following:\n\n1.  Extracts the unique life.stage levels from the data frame.\n2.  For each life.stage, extracts the unique acute.treatment levels.\n3.  Generates all possible pairs of acute.treatment levels within each\n    life.stage.\n4.  Iterates over each pair and performs the t-test for each Target.\n    Adds an asterisk column and an asterisk if the p-value is \\<= 0.05.\n    Useful for downstream parsing.\n5.  Stores the results in a list and combines them into a single data\n    frame.\n6.  Adds a comparison column to indicate which life.stage and\n    acute.treatment levels were compared.\n\nExcludes `seed` and `spat`, as these were only held at `ambient` for the\nacute treatment.\n\n``` r\n# Extract unique life.stage levels, excluding 'seed' and 'spat'\nunique_life_stages <- unique(delta_Cq_df$life.stage)\nunique_life_stages <- setdiff(unique_life_stages, c(\"seed\", \"spat\"))\n\n# Initialize a list to store results\nacute_treatment_t_test_results_list <- list()\n\nfor (stage in unique_life_stages) {\n  # Extract unique acute.treatment levels within the current life.stage\n  unique_treatments <- unique(delta_Cq_df %>% filter(life.stage == stage) %>% pull(acute.treatment))\n  \n  # Check if there are at least 2 unique treatments\n  if (length(unique_treatments) >= 2) {\n    # Generate all possible pairs of acute.treatment levels\n    treatment_pairs <- combn(unique_treatments, 2, simplify = FALSE)\n    \n    for (pair in treatment_pairs) {\n      treatment1 <- pair[1]\n      treatment2 <- pair[2]\n      \n      # Perform t-test for each Target comparing the two acute.treatment levels within the current life.stage\n      t_test_results <- delta_Cq_df %>%\n        filter(life.stage == stage, acute.treatment %in% c(treatment1, treatment2)) %>%\n        group_by(Target) %>%\n        summarise(\n          t_test_result = list(t.test(delta_Cq ~ acute.treatment))\n        ) %>%\n        ungroup() %>%\n        mutate(\n          estimate_diff = sapply(t_test_result, function(x) x$estimate[1] - x$estimate[2]),\n          p_value = sapply(t_test_result, function(x) x$p.value),\n          asterisk = ifelse(p_value <= 0.05, \"*\", \"\"), # Adds asterisk column and asterisk for p-value.\n          comparison = paste(stage, treatment1, \"vs\", treatment2, sep = \".\")\n        ) %>%\n        select(!t_test_result)\n      \n      acute_treatment_t_test_results_list[[paste(stage, treatment1, treatment2, sep = \".\")]] <- t_test_results\n    }\n  }\n}\n\n# Combine results into a single data frame\nacute_treatment_t_test_results_df <- bind_rows(acute_treatment_t_test_results_list, .id = \"comparison\")\n\n# View the results\nprint(acute_treatment_t_test_results_df)\n```\n\n    # A tibble: 14 × 5\n       Target           estimate_diff p_value asterisk comparison           \n       <chr>                    <dbl>   <dbl> <chr>    <chr>                \n     1 ATPsynthase             0.174   0.602  \"\"       juvenile.high.ambient\n     2 DNMT1                  -0.552   0.250  \"\"       juvenile.high.ambient\n     3 HSP70                   0.886   0.170  \"\"       juvenile.high.ambient\n     4 HSP90                   0.790   0.0261 \"*\"      juvenile.high.ambient\n     5 cGAS                   -0.191   0.448  \"\"       juvenile.high.ambient\n     6 citrate synthase       -0.115   0.716  \"\"       juvenile.high.ambient\n     7 viperin                 0.319   0.690  \"\"       juvenile.high.ambient\n     8 ATPsynthase             0.0605  0.687  \"\"       adult.ambient.high   \n     9 DNMT1                   0.314   0.275  \"\"       adult.ambient.high   \n    10 HSP70                   0.276   0.696  \"\"       adult.ambient.high   \n    11 HSP90                   0.499   0.149  \"\"       adult.ambient.high   \n    12 cGAS                    0.329   0.200  \"\"       adult.ambient.high   \n    13 citrate synthase        0.0668  0.622  \"\"       adult.ambient.high   \n    14 viperin                 0.323   0.251  \"\"       adult.ambient.high   \n\n### 8.1.4 Acute within life stage and conditioning\n\n``` r\n# Extract unique life.stage levels, excluding 'seed' and 'spat'\nunique_life_stages <- unique(delta_Cq_df$life.stage)\n#unique_life_stages <- setdiff(unique_life_stages, c(\"seed\", \"spat\"))\n\n# Extract unique conditioning.treatment levels\nunique_conditioning_treatments <- unique(delta_Cq_df$conditioning.treatment)\n\n# Initialize a list to store results\nacute_treatment_within_life.stages_conditioning_t_test_results_list <- list()\n\nfor (stage in unique_life_stages) {\n  for (conditioning in unique_conditioning_treatments) {\n    # Extract unique acute.treatment levels within the current life.stage and conditioning.treatment\n    unique_treatments <- unique(delta_Cq_df %>% filter(life.stage == stage, conditioning.treatment == conditioning) %>% pull(acute.treatment))\n    \n    # Check if there are at least 2 unique treatments\n    if (length(unique_treatments) >= 2) {\n      # Generate all possible pairs of acute.treatment levels\n      treatment_pairs <- combn(unique_treatments, 2, simplify = FALSE)\n      \n      for (pair in treatment_pairs) {\n        treatment1 <- pair[1]\n        treatment2 <- pair[2]\n        \n        # Perform t-test for each Target comparing the two acute.treatment levels within the current life.stage and conditioning.treatment\n        t_test_results <- delta_Cq_df %>%\n          filter(life.stage == stage, conditioning.treatment == conditioning, acute.treatment %in% c(treatment1, treatment2)) %>%\n          group_by(Target) %>%\n          summarise(\n            t_test_result = list(t.test(delta_Cq ~ acute.treatment))\n          ) %>%\n          ungroup() %>%\n          mutate(\n            estimate_diff = sapply(t_test_result, function(x) x$estimate[1] - x$estimate[2]),\n            p_value = sapply(t_test_result, function(x) x$p.value),\n            asterisk = ifelse(p_value <= 0.05, \"*\", \"\"), # Adds asterisk column and asterisk for p-value.\n            comparison = paste(stage, conditioning, treatment1, \"vs\", treatment2, sep = \".\")\n          ) %>%\n          select(!t_test_result)\n        \n        acute_treatment_within_life.stages_conditioning_t_test_results_list[[paste(stage, conditioning, treatment1, treatment2, sep = \".\")]] <- t_test_results\n      }\n    }\n  }\n}\n\n# Combine results into a single data frame\nacute_treatment_within_life.stages_conditioning_t_test_results_df <- bind_rows(acute_treatment_within_life.stages_conditioning_t_test_results_list, .id = \"comparison_id\")\n\n# View the results\nprint(acute_treatment_within_life.stages_conditioning_t_test_results_df)\n```\n\n    # A tibble: 56 × 6\n       comparison_id                Target estimate_diff p_value asterisk comparison\n       <chr>                        <chr>          <dbl>   <dbl> <chr>    <chr>     \n     1 juvenile.control.high.ambie… ATPsy…        0.369   0.500  \"\"       juvenile.…\n     2 juvenile.control.high.ambie… DNMT1        -0.170   0.811  \"\"       juvenile.…\n     3 juvenile.control.high.ambie… HSP70         0.187   0.837  \"\"       juvenile.…\n     4 juvenile.control.high.ambie… HSP90         0.995   0.0661 \"\"       juvenile.…\n     5 juvenile.control.high.ambie… cGAS         -0.144   0.632  \"\"       juvenile.…\n     6 juvenile.control.high.ambie… citra…        0.0872  0.844  \"\"       juvenile.…\n     7 juvenile.control.high.ambie… viper…        0.680   0.590  \"\"       juvenile.…\n     8 juvenile.treated.high.ambie… ATPsy…       -0.143   0.421  \"\"       juvenile.…\n     9 juvenile.treated.high.ambie… DNMT1        -1.15    0.0274 \"*\"      juvenile.…\n    10 juvenile.treated.high.ambie… HSP70         1.92    0.0306 \"*\"      juvenile.…\n    # ℹ 46 more rows\n\n## 8.2 Plotting\n\n### 8.2.1 Delta Cq boxplots\n\n#### 8.2.1.1 Lifestage comparisons\n\n``` r\n# Create box plots for each comparison\nunique_comparisons <- unique(life_stage_t_test_results_df$comparison)\n\nfor (comparison in unique_comparisons) {\n  create_boxplot_delta_Cq(delta_Cq_df, comparison, life_stage_t_test_results_df)\n}\n```\n\n![](01.01-qPCR_files/figure-gfm/delta-Cq-boxplots-lifestage-1.png)<!-- -->![](01.01-qPCR_files/figure-gfm/delta-Cq-boxplots-lifestage-2.png)<!-- -->![](01.01-qPCR_files/figure-gfm/delta-Cq-boxplots-lifestage-3.png)<!-- -->![](01.01-qPCR_files/figure-gfm/delta-Cq-boxplots-lifestage-4.png)<!-- -->![](01.01-qPCR_files/figure-gfm/delta-Cq-boxplots-lifestage-5.png)<!-- -->![](01.01-qPCR_files/figure-gfm/delta-Cq-boxplots-lifestage-6.png)<!-- -->\n\n### 8.2.2 Conditioning comparisons\n\n``` r\n# Create box plots for each comparison\nunique_comparisons <- unique(conditioning_treatment_t_test_results_df$comparison)\n\nfor (comparison in unique_comparisons) {\n  create_boxplot_conditioning(delta_Cq_df, comparison, conditioning_treatment_t_test_results_df)\n}\n```\n\n![](01.01-qPCR_files/figure-gfm/delta-Cq-boxplots-conditioning-1.png)<!-- -->![](01.01-qPCR_files/figure-gfm/delta-Cq-boxplots-conditioning-2.png)<!-- -->![](01.01-qPCR_files/figure-gfm/delta-Cq-boxplots-conditioning-3.png)<!-- -->![](01.01-qPCR_files/figure-gfm/delta-Cq-boxplots-conditioning-4.png)<!-- -->\n\n### 8.2.3 Acute treatment comparisons\n\n``` r\n# Create box plots for each comparison\nunique_comparisons <- unique(acute_treatment_t_test_results_df$comparison)\n\nfor (comparison in unique_comparisons) {\n  create_boxplot_acute(delta_Cq_df, comparison, acute_treatment_t_test_results_df)\n}\n```\n\n![](01.01-qPCR_files/figure-gfm/delta-Cq-boxplots-acute-treatment-1.png)<!-- -->![](01.01-qPCR_files/figure-gfm/delta-Cq-boxplots-acute-treatment-2.png)<!-- -->\n\n### 8.2.4 Acute within life stage conditioning\n\n``` r\n# Loop through each comparison in the t-test results and create box plots\nfor (comparison in unique(acute_treatment_within_life.stages_conditioning_t_test_results_df$comparison)) {\n  create_boxplot_acute_conditioning(delta_Cq_df, comparison, acute_treatment_within_life.stages_conditioning_t_test_results_df)\n}\n```\n\n![](01.01-qPCR_files/figure-gfm/boxplots-acute-treatments-within-life-stages-conditioning-1.png)<!-- -->![](01.01-qPCR_files/figure-gfm/boxplots-acute-treatments-within-life-stages-conditioning-2.png)<!-- -->![](01.01-qPCR_files/figure-gfm/boxplots-acute-treatments-within-life-stages-conditioning-3.png)<!-- -->![](01.01-qPCR_files/figure-gfm/boxplots-acute-treatments-within-life-stages-conditioning-4.png)<!-- -->![](01.01-qPCR_files/figure-gfm/boxplots-acute-treatments-within-life-stages-conditioning-5.png)<!-- -->![](01.01-qPCR_files/figure-gfm/boxplots-acute-treatments-within-life-stages-conditioning-6.png)<!-- -->![](01.01-qPCR_files/figure-gfm/boxplots-acute-treatments-within-life-stages-conditioning-7.png)<!-- -->![](01.01-qPCR_files/figure-gfm/boxplots-acute-treatments-within-life-stages-conditioning-8.png)<!-- -->\n\n# 9 Delta delta Cq\n\n## 9.1 Calculations\n\n### 9.1.1 Conditioning\n\n``` r\n# Calculate delta_delta_Cq\ndelta_delta_conditioning_fold_change <- delta_Cq_df %>%\n  group_by(life.stage, Target) %>%\n  summarize(\n    treated_delta_Cq = mean(delta_Cq[conditioning.treatment == \"treated\"], na.rm = TRUE),\n    control_delta_Cq = mean(delta_Cq[conditioning.treatment == \"control\"], na.rm = TRUE)\n  ) %>%\n  mutate(delta_delta_Cq = treated_delta_Cq - control_delta_Cq) %>%\n  select(life.stage, Target, delta_delta_Cq)\n\nstr(delta_delta_conditioning_fold_change)\n```\n\n    gropd_df [28 × 3] (S3: grouped_df/tbl_df/tbl/data.frame)\n     $ life.stage    : chr [1:28] \"adult\" \"adult\" \"adult\" \"adult\" ...\n     $ Target        : chr [1:28] \"ATPsynthase\" \"DNMT1\" \"HSP70\" \"HSP90\" ...\n     $ delta_delta_Cq: num [1:28] -0.0779 -0.3116 0.941 0.7639 0.1955 ...\n     - attr(*, \"groups\")= tibble [4 × 2] (S3: tbl_df/tbl/data.frame)\n      ..$ life.stage: chr [1:4] \"adult\" \"juvenile\" \"seed\" \"spat\"\n      ..$ .rows     : list<int> [1:4] \n      .. ..$ : int [1:7] 1 2 3 4 5 6 7\n      .. ..$ : int [1:7] 8 9 10 11 12 13 14\n      .. ..$ : int [1:7] 15 16 17 18 19 20 21\n      .. ..$ : int [1:7] 22 23 24 25 26 27 28\n      .. ..@ ptype: int(0) \n      ..- attr(*, \".drop\")= logi TRUE\n\n### 9.1.2 Acute treatment\n\n``` r\n# Calculate delta_delta_Cq for acute treatment\ndelta_delta_Cq_acute_df <- delta_Cq_df %>%\n  group_by(life.stage, Target, acute.treatment) %>%\n  summarize(\n    treated_delta_Cq = mean(delta_Cq[conditioning.treatment == \"treated\"], na.rm = TRUE),\n    control_delta_Cq = mean(delta_Cq[conditioning.treatment == \"control\"], na.rm = TRUE)\n  ) %>%\n  mutate(delta_delta_Cq = treated_delta_Cq - control_delta_Cq) %>%\n  select(life.stage, Target, acute.treatment, delta_delta_Cq)\n\nstr(delta_delta_Cq_acute_df)\n```\n\n    gropd_df [56 × 4] (S3: grouped_df/tbl_df/tbl/data.frame)\n     $ life.stage     : chr [1:56] \"adult\" \"adult\" \"adult\" \"adult\" ...\n     $ Target         : chr [1:56] \"ATPsynthase\" \"ATPsynthase\" \"DNMT1\" \"DNMT1\" ...\n     $ acute.treatment: chr [1:56] \"ambient\" \"high\" \"ambient\" \"high\" ...\n     $ delta_delta_Cq : num [1:56] -0.112 -0.0438 -0.2467 -0.3765 0.9455 ...\n     - attr(*, \"groups\")= tibble [28 × 3] (S3: tbl_df/tbl/data.frame)\n      ..$ life.stage: chr [1:28] \"adult\" \"adult\" \"adult\" \"adult\" ...\n      ..$ Target    : chr [1:28] \"ATPsynthase\" \"DNMT1\" \"HSP70\" \"HSP90\" ...\n      ..$ .rows     : list<int> [1:28] \n      .. ..$ : int [1:2] 1 2\n      .. ..$ : int [1:2] 3 4\n      .. ..$ : int [1:2] 5 6\n      .. ..$ : int [1:2] 7 8\n      .. ..$ : int [1:2] 9 10\n      .. ..$ : int [1:2] 11 12\n      .. ..$ : int [1:2] 13 14\n      .. ..$ : int [1:2] 15 16\n      .. ..$ : int [1:2] 17 18\n      .. ..$ : int [1:2] 19 20\n      .. ..$ : int [1:2] 21 22\n      .. ..$ : int [1:2] 23 24\n      .. ..$ : int [1:2] 25 26\n      .. ..$ : int [1:2] 27 28\n      .. ..$ : int [1:2] 29 30\n      .. ..$ : int [1:2] 31 32\n      .. ..$ : int [1:2] 33 34\n      .. ..$ : int [1:2] 35 36\n      .. ..$ : int [1:2] 37 38\n      .. ..$ : int [1:2] 39 40\n      .. ..$ : int [1:2] 41 42\n      .. ..$ : int [1:2] 43 44\n      .. ..$ : int [1:2] 45 46\n      .. ..$ : int [1:2] 47 48\n      .. ..$ : int [1:2] 49 50\n      .. ..$ : int [1:2] 51 52\n      .. ..$ : int [1:2] 53 54\n      .. ..$ : int [1:2] 55 56\n      .. ..@ ptype: int(0) \n      ..- attr(*, \".drop\")= logi TRUE\n\n### 9.1.3 Life stage\n\n``` r\n# Calculate delta_delta_Cq for life stage comparisons\ndelta_delta_Cq_life_stage_df <- delta_Cq_df %>%\n  group_by(Target, life.stage) %>%\n  summarize(mean_delta_Cq = mean(delta_Cq, na.rm = TRUE)) %>%\n  ungroup() %>%\n  pivot_wider(names_from = life.stage, values_from = mean_delta_Cq) %>%\n  mutate(\n    delta_delta_Cq_adult_vs_seed = adult - seed,\n    delta_delta_Cq_spat_vs_seed = spat - seed,\n    delta_delta_Cq_adult_vs_spat = adult - spat\n  ) %>%\n  pivot_longer(cols = starts_with(\"delta_delta_Cq_\"), names_to = \"comparison\", values_to = \"delta_delta_Cq\") %>%\n  filter(!is.na(delta_delta_Cq))\n\n# Display the structure of the resulting data frame\nstr(delta_delta_Cq_life_stage_df)\n```\n\n    tibble [21 × 7] (S3: tbl_df/tbl/data.frame)\n     $ Target        : chr [1:21] \"ATPsynthase\" \"ATPsynthase\" \"ATPsynthase\" \"DNMT1\" ...\n     $ adult         : num [1:21] 0.48 0.48 0.48 6.17 6.17 ...\n     $ juvenile      : num [1:21] 0.732 0.732 0.732 6.32 6.32 ...\n     $ seed          : num [1:21] 0.44 0.44 0.44 6.38 6.38 ...\n     $ spat          : num [1:21] 0.324 0.324 0.324 6.488 6.488 ...\n     $ comparison    : chr [1:21] \"delta_delta_Cq_adult_vs_seed\" \"delta_delta_Cq_spat_vs_seed\" \"delta_delta_Cq_adult_vs_spat\" \"delta_delta_Cq_adult_vs_seed\" ...\n     $ delta_delta_Cq: num [1:21] 0.0405 -0.1157 0.1561 -0.2139 0.1065 ...\n\n### 9.1.4 Calculate delta delta acute treatments within lifestage and conditioning\n\n``` r\n# Calculate delta_delta_Cq for acute treatment comparisons within each life stage and conditioning treatment\ndelta_delta_Cq_acute_within_life_stage_conditioning_df <- delta_Cq_df %>%\n  group_by(life.stage, conditioning.treatment, Target, acute.treatment) %>%\n  summarize(mean_delta_Cq = mean(delta_Cq, na.rm = TRUE)) %>%\n  ungroup() %>%\n  pivot_wider(names_from = acute.treatment, values_from = mean_delta_Cq) %>%\n  mutate(delta_delta_Cq_high_vs_ambient = high - ambient) %>%\n  pivot_longer(cols = starts_with(\"delta_delta_Cq_\"), names_to = \"comparison\", values_to = \"delta_delta_Cq\") %>%\n  filter(!is.na(delta_delta_Cq))\n\n# Display the structure of the resulting data frame\nstr(delta_delta_Cq_acute_within_life_stage_conditioning_df)\n```\n\n    tibble [56 × 7] (S3: tbl_df/tbl/data.frame)\n     $ life.stage            : chr [1:56] \"adult\" \"adult\" \"adult\" \"adult\" ...\n     $ conditioning.treatment: chr [1:56] \"control\" \"control\" \"control\" \"control\" ...\n     $ Target                : chr [1:56] \"ATPsynthase\" \"DNMT1\" \"HSP70\" \"HSP90\" ...\n     $ ambient               : num [1:56] 0.566 6.448 3.944 1.259 5.207 ...\n     $ high                  : num [1:56] 0.472 6.199 3.673 0.29 4.609 ...\n     $ comparison            : chr [1:56] \"delta_delta_Cq_high_vs_ambient\" \"delta_delta_Cq_high_vs_ambient\" \"delta_delta_Cq_high_vs_ambient\" \"delta_delta_Cq_high_vs_ambient\" ...\n     $ delta_delta_Cq        : num [1:56] -0.0946 -0.2492 -0.2715 -0.969 -0.5983 ...\n\n### 9.1.5 Calculate the fold change life stage comparison\n\n``` r\n# Calculate fold change and output to a new data frame\nfold_change_life_stage_df <- delta_delta_Cq_life_stage_df %>%\n  mutate(fold_change = 2^(-delta_delta_Cq))\n\n# Display the structure of the resulting data frame\nstr(fold_change_life_stage_df)\n```\n\n    tibble [21 × 8] (S3: tbl_df/tbl/data.frame)\n     $ Target        : chr [1:21] \"ATPsynthase\" \"ATPsynthase\" \"ATPsynthase\" \"DNMT1\" ...\n     $ adult         : num [1:21] 0.48 0.48 0.48 6.17 6.17 ...\n     $ juvenile      : num [1:21] 0.732 0.732 0.732 6.32 6.32 ...\n     $ seed          : num [1:21] 0.44 0.44 0.44 6.38 6.38 ...\n     $ spat          : num [1:21] 0.324 0.324 0.324 6.488 6.488 ...\n     $ comparison    : chr [1:21] \"delta_delta_Cq_adult_vs_seed\" \"delta_delta_Cq_spat_vs_seed\" \"delta_delta_Cq_adult_vs_spat\" \"delta_delta_Cq_adult_vs_seed\" ...\n     $ delta_delta_Cq: num [1:21] 0.0405 -0.1157 0.1561 -0.2139 0.1065 ...\n     $ fold_change   : num [1:21] 0.972 1.083 0.897 1.16 0.929 ...\n\n### 9.1.6 Calculate the fold change conditioning comparison\n\n``` r\ndelta_delta_conditioning_fold_change <- delta_delta_conditioning_fold_change %>%\n  mutate(fold_change = 2^(-delta_delta_Cq)) %>% \n  distinct(Target, fold_change)\n\nstr(delta_delta_conditioning_fold_change)\n```\n\n    gropd_df [28 × 3] (S3: grouped_df/tbl_df/tbl/data.frame)\n     $ life.stage : chr [1:28] \"adult\" \"adult\" \"adult\" \"adult\" ...\n     $ Target     : chr [1:28] \"ATPsynthase\" \"DNMT1\" \"HSP70\" \"HSP90\" ...\n     $ fold_change: num [1:28] 1.055 1.241 0.521 0.589 0.873 ...\n     - attr(*, \"groups\")= tibble [4 × 2] (S3: tbl_df/tbl/data.frame)\n      ..$ life.stage: chr [1:4] \"adult\" \"juvenile\" \"seed\" \"spat\"\n      ..$ .rows     : list<int> [1:4] \n      .. ..$ : int [1:7] 1 2 3 4 5 6 7\n      .. ..$ : int [1:7] 8 9 10 11 12 13 14\n      .. ..$ : int [1:7] 15 16 17 18 19 20 21\n      .. ..$ : int [1:7] 22 23 24 25 26 27 28\n      .. ..@ ptype: int(0) \n      ..- attr(*, \".drop\")= logi TRUE\n\n### 9.1.7 Calculate the fold change acute comparison\n\n``` r\n# Calculate fold change for acute treatment\ndelta_delta_acute_fold_change <- delta_delta_Cq_acute_df %>%\n  mutate(fold_change = 2^(-delta_delta_Cq)) %>%\n  distinct(life.stage, Target, acute.treatment, fold_change)\n\n# Display the structure of the resulting data frame\nstr(delta_delta_acute_fold_change)\n```\n\n    gropd_df [56 × 4] (S3: grouped_df/tbl_df/tbl/data.frame)\n     $ life.stage     : chr [1:56] \"adult\" \"adult\" \"adult\" \"adult\" ...\n     $ Target         : chr [1:56] \"ATPsynthase\" \"ATPsynthase\" \"DNMT1\" \"DNMT1\" ...\n     $ acute.treatment: chr [1:56] \"ambient\" \"high\" \"ambient\" \"high\" ...\n     $ fold_change    : num [1:56] 1.081 1.031 1.186 1.298 0.519 ...\n     - attr(*, \"groups\")= tibble [28 × 3] (S3: tbl_df/tbl/data.frame)\n      ..$ life.stage: chr [1:28] \"adult\" \"adult\" \"adult\" \"adult\" ...\n      ..$ Target    : chr [1:28] \"ATPsynthase\" \"DNMT1\" \"HSP70\" \"HSP90\" ...\n      ..$ .rows     : list<int> [1:28] \n      .. ..$ : int [1:2] 1 2\n      .. ..$ : int [1:2] 3 4\n      .. ..$ : int [1:2] 5 6\n      .. ..$ : int [1:2] 7 8\n      .. ..$ : int [1:2] 9 10\n      .. ..$ : int [1:2] 11 12\n      .. ..$ : int [1:2] 13 14\n      .. ..$ : int [1:2] 15 16\n      .. ..$ : int [1:2] 17 18\n      .. ..$ : int [1:2] 19 20\n      .. ..$ : int [1:2] 21 22\n      .. ..$ : int [1:2] 23 24\n      .. ..$ : int [1:2] 25 26\n      .. ..$ : int [1:2] 27 28\n      .. ..$ : int [1:2] 29 30\n      .. ..$ : int [1:2] 31 32\n      .. ..$ : int [1:2] 33 34\n      .. ..$ : int [1:2] 35 36\n      .. ..$ : int [1:2] 37 38\n      .. ..$ : int [1:2] 39 40\n      .. ..$ : int [1:2] 41 42\n      .. ..$ : int [1:2] 43 44\n      .. ..$ : int [1:2] 45 46\n      .. ..$ : int [1:2] 47 48\n      .. ..$ : int [1:2] 49 50\n      .. ..$ : int [1:2] 51 52\n      .. ..$ : int [1:2] 53 54\n      .. ..$ : int [1:2] 55 56\n      .. ..@ ptype: int(0) \n      ..- attr(*, \".drop\")= logi TRUE\n\n### 9.1.8 Calculate fold change acute treatments within lifestage and conditioning\n\n``` r\n# Calculate fold change for acute treatment comparisons within each life stage and conditioning treatment\nfold_change_acute_within_life_stage_conditioning_df <- delta_delta_Cq_acute_within_life_stage_conditioning_df %>%\n  mutate(fold_change = 2^(-delta_delta_Cq))\n\n# Display the structure of the resulting data frame\nstr(fold_change_acute_within_life_stage_conditioning_df)\n```\n\n    tibble [56 × 8] (S3: tbl_df/tbl/data.frame)\n     $ life.stage            : chr [1:56] \"adult\" \"adult\" \"adult\" \"adult\" ...\n     $ conditioning.treatment: chr [1:56] \"control\" \"control\" \"control\" \"control\" ...\n     $ Target                : chr [1:56] \"ATPsynthase\" \"DNMT1\" \"HSP70\" \"HSP90\" ...\n     $ ambient               : num [1:56] 0.566 6.448 3.944 1.259 5.207 ...\n     $ high                  : num [1:56] 0.472 6.199 3.673 0.29 4.609 ...\n     $ comparison            : chr [1:56] \"delta_delta_Cq_high_vs_ambient\" \"delta_delta_Cq_high_vs_ambient\" \"delta_delta_Cq_high_vs_ambient\" \"delta_delta_Cq_high_vs_ambient\" ...\n     $ delta_delta_Cq        : num [1:56] -0.0946 -0.2492 -0.2715 -0.969 -0.5983 ...\n     $ fold_change           : num [1:56] 1.07 1.19 1.21 1.96 1.51 ...\n\n## 9.2 Plotting fold changes\n\n### 9.2.1 Acute comparisons within lifestage and conditioning\n\n``` r\nlibrary(ggplot2)\n\n# Generate bar plots for each group of comparison within each life stage and conditioning treatment\nplot_list <- fold_change_acute_within_life_stage_conditioning_df %>%\n  split(list(.$life.stage, .$conditioning.treatment, .$comparison)) %>%\n  lapply(function(df) {\n    life_stage <- unique(df$life.stage)\n    conditioning_treatment <- unique(df$conditioning.treatment)\n    comparison_title <- gsub(\"delta_delta_Cq_\", \"\", unique(df$comparison))\n    comparison_title <- gsub(\"_vs_\", \" vs. \", comparison_title)\n    ggplot(df, aes(x = Target, y = fold_change)) +\n      geom_bar(stat = \"identity\") +\n      labs(title = paste(\"Gene Expression -\", life_stage, \"-\", conditioning_treatment, \"-\", comparison_title), \n           x = \"Target\", y = \"Fold Change\") +\n      theme_minimal() +\n      theme(axis.text.x = element_text(angle = 45, hjust = 1))\n  })\n\n# Display the plots\nfor (plot in plot_list) {\n  print(plot)\n}\n```\n\n![](01.01-qPCR_files/figure-gfm/bar-plots-fold-change-acute-within-lifestage-conditioning-1.png)<!-- -->![](01.01-qPCR_files/figure-gfm/bar-plots-fold-change-acute-within-lifestage-conditioning-2.png)<!-- -->![](01.01-qPCR_files/figure-gfm/bar-plots-fold-change-acute-within-lifestage-conditioning-3.png)<!-- -->![](01.01-qPCR_files/figure-gfm/bar-plots-fold-change-acute-within-lifestage-conditioning-4.png)<!-- -->![](01.01-qPCR_files/figure-gfm/bar-plots-fold-change-acute-within-lifestage-conditioning-5.png)<!-- -->![](01.01-qPCR_files/figure-gfm/bar-plots-fold-change-acute-within-lifestage-conditioning-6.png)<!-- -->![](01.01-qPCR_files/figure-gfm/bar-plots-fold-change-acute-within-lifestage-conditioning-7.png)<!-- -->![](01.01-qPCR_files/figure-gfm/bar-plots-fold-change-acute-within-lifestage-conditioning-8.png)<!-- -->\n\n### 9.2.2 Life stage comparisons\n\n``` r\n# Generate bar plots for each group of comparison\nplot_list <- fold_change_life_stage_df %>%\n  split(.$comparison) %>%\n  lapply(function(df) {\n    comparison_title <- gsub(\"delta_delta_Cq_\", \"\", unique(df$comparison))\n    comparison_title <- gsub(\"_vs_\", \" vs. \", comparison_title)\n    ggplot(df, aes(x = Target, y = fold_change)) +\n      geom_bar(stat = \"identity\") +\n      labs(title = paste(\"Gene Expression -\", comparison_title), x = \"Target\", y = \"Fold Change\") +\n      theme_minimal() +\n      theme(axis.text.x = element_text(angle = 45, hjust = 1))\n  })\n\n# Display the plots\nfor (plot in plot_list) {\n  print(plot)\n}\n```\n\n![](01.01-qPCR_files/figure-gfm/bar-plots-fold-change-lifestages-1.png)<!-- -->![](01.01-qPCR_files/figure-gfm/bar-plots-fold-change-lifestages-2.png)<!-- -->![](01.01-qPCR_files/figure-gfm/bar-plots-fold-change-lifestages-3.png)<!-- -->\n\n### 9.2.3 Conditioning comparisons\n\n![](01.01-qPCR_files/figure-gfm/barplot-fold-change-conditioning-1.png)<!-- -->\n\n### 9.2.4 Line plot conditioning comparisons across lifestages\n\n![](01.01-qPCR_files/figure-gfm/lineplot-fold-change-conditioning-1.png)<!-- -->\n\n### 9.2.5 Acute treatment comparison\n\n![](01.01-qPCR_files/figure-gfm/barplot-fold-change-acute-1.png)<!-- -->\n\n# 10 Running linear models\n\n## 10.1 ANOVA models\n\n``` r\nhist(delta_Cq_df$delta_Cq)\n```\n\n![](01.01-qPCR_files/figure-gfm/unnamed-chunk-1-1.png)<!-- -->\n\nRun an anova model to test for effects of lifestage, conditioning, and\nacute treatment on delta Cq values for each target.\n\n### 10.1.1 ATP synthase\n\nATP synthase is an enzyme complex that functions to synthesize adenosine\ntriphosphate (ATP) from adenosine diphosphate (ADP) and inorganic\nphosphate (Pi), essentially generating the cell’s primary energy\ncurrency by harnessing the energy from a proton gradient across a\nmembrane.\n\n``` r\nlibrary(car)\nlibrary(emmeans)\n\nmodel<-delta_Cq_df%>%\n  filter(Target==\"ATPsynthase\")%>%\n  \n  aov(delta_Cq ~ life.stage * conditioning.treatment * acute.treatment, data=.)\n\nsummary(model)\n```\n\n                                                       Df Sum Sq Mean Sq F value\n    life.stage                                          3   2.66  0.8874   2.360\n    conditioning.treatment                              1   1.33  1.3317   3.542\n    acute.treatment                                     1   0.61  0.6073   1.615\n    life.stage:conditioning.treatment                   3   0.60  0.2012   0.535\n    life.stage:acute.treatment                          3   0.37  0.1221   0.325\n    conditioning.treatment:acute.treatment              1   0.11  0.1095   0.291\n    life.stage:conditioning.treatment:acute.treatment   3   0.48  0.1591   0.423\n    Residuals                                         104  39.10  0.3760        \n                                                      Pr(>F)  \n    life.stage                                        0.0757 .\n    conditioning.treatment                            0.0626 .\n    acute.treatment                                   0.2066  \n    life.stage:conditioning.treatment                 0.6592  \n    life.stage:acute.treatment                        0.8074  \n    conditioning.treatment:acute.treatment            0.5906  \n    life.stage:conditioning.treatment:acute.treatment 0.7367  \n    Residuals                                                 \n    ---\n    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n``` r\nqqPlot(model$residuals)\n```\n\n![](01.01-qPCR_files/figure-gfm/unnamed-chunk-2-1.png)<!-- -->\n\n    [1] 117   4\n\n``` r\nleveneTest(model$residuals ~ life.stage*conditioning.treatment*acute.treatment, data=delta_Cq_df%>%filter(Target==\"ATPsynthase\"))\n```\n\n    Levene's Test for Homogeneity of Variance (center = median)\n           Df F value Pr(>F)\n    group  15  1.2733 0.2324\n          104               \n\nNo significant effects.\n\n### 10.1.2 DNMT1\n\nThe DNMT1 gene provides instructions for making an enzyme called DNA\nmethyltransferase 1. This enzyme is involved in DNA methylation, which\nis the addition of methyl groups, consisting of one carbon atom and\nthree hydrogen atoms, to DNA molecules.\n\n``` r\nmodel<-delta_Cq_df%>%\n  filter(Target==\"DNMT1\")%>%\n  \n  aov(delta_Cq ~ life.stage * conditioning.treatment * acute.treatment, data=.)\n\nsummary(model)\n```\n\n                                                       Df Sum Sq Mean Sq F value\n    life.stage                                          3   1.47   0.490   0.347\n    conditioning.treatment                              1   0.25   0.252   0.178\n    acute.treatment                                     1   2.88   2.885   2.041\n    life.stage:conditioning.treatment                   3  10.35   3.451   2.442\n    life.stage:acute.treatment                          3   4.53   1.511   1.069\n    conditioning.treatment:acute.treatment              1   0.01   0.011   0.008\n    life.stage:conditioning.treatment:acute.treatment   3   9.86   3.288   2.326\n    Residuals                                         102 144.16   1.413        \n                                                      Pr(>F)  \n    life.stage                                        0.7915  \n    conditioning.treatment                            0.6736  \n    acute.treatment                                   0.1561  \n    life.stage:conditioning.treatment                 0.0685 .\n    life.stage:acute.treatment                        0.3657  \n    conditioning.treatment:acute.treatment            0.9288  \n    life.stage:conditioning.treatment:acute.treatment 0.0791 .\n    Residuals                                                 \n    ---\n    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n``` r\nqqPlot(model$residuals)\n```\n\n![](01.01-qPCR_files/figure-gfm/unnamed-chunk-3-1.png)<!-- -->\n\n    [1] 115  10\n\n``` r\nleveneTest(model$residuals ~ life.stage*conditioning.treatment*acute.treatment, data=delta_Cq_df%>%filter(Target==\"DNMT1\"))\n```\n\n    Levene's Test for Homogeneity of Variance (center = median)\n           Df F value Pr(>F)\n    group  15  1.0926 0.3727\n          102               \n\nNo significant effects.\n\n### 10.1.3 HSP70\n\nHeat Shock Protein 70 (Hsp70) is a molecular chaperone that plays\ncrucial roles in maintaining cellular protein homeostasis and protecting\ncells from stress.\n\n``` r\nmodel<-delta_Cq_df%>%\n  filter(Target==\"HSP70\")%>%\n  \n  aov(delta_Cq ~ life.stage * conditioning.treatment * acute.treatment, data=.)\n\nsummary(model)\n```\n\n                                                       Df Sum Sq Mean Sq F value\n    life.stage                                          3   23.4   7.814   2.464\n    conditioning.treatment                              1    3.7   3.729   1.176\n    acute.treatment                                     1    2.1   2.136   0.674\n    life.stage:conditioning.treatment                   3   14.2   4.735   1.493\n    life.stage:acute.treatment                          3   14.9   4.966   1.566\n    conditioning.treatment:acute.treatment              1   19.0  18.966   5.980\n    life.stage:conditioning.treatment:acute.treatment   3   17.2   5.749   1.813\n    Residuals                                         104  329.8   3.172        \n                                                      Pr(>F)  \n    life.stage                                        0.0666 .\n    conditioning.treatment                            0.2807  \n    acute.treatment                                   0.4137  \n    life.stage:conditioning.treatment                 0.2208  \n    life.stage:acute.treatment                        0.2022  \n    conditioning.treatment:acute.treatment            0.0161 *\n    life.stage:conditioning.treatment:acute.treatment 0.1494  \n    Residuals                                                 \n    ---\n    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n``` r\nqqPlot(model$residuals)\n```\n\n![](01.01-qPCR_files/figure-gfm/unnamed-chunk-4-1.png)<!-- -->\n\n    [1] 103  64\n\n``` r\nleveneTest(model$residuals ~ life.stage*conditioning.treatment*acute.treatment, data=delta_Cq_df%>%filter(Target==\"HSP70\"))\n```\n\n    Levene's Test for Homogeneity of Variance (center = median)\n           Df F value Pr(>F)\n    group  15  0.5223 0.9231\n          104               \n\n``` r\nemm<-emmeans(model, ~ conditioning.treatment:acute.treatment | life.stage)\npairs(emm)\n```\n\n    life.stage = adult:\n     contrast                          estimate    SE  df t.ratio p.value\n     control ambient - treated ambient  -0.9455 0.890 104  -1.062  0.7134\n     control ambient - control high      0.2715 0.890 104   0.305  0.9901\n     control ambient - treated high     -0.6649 0.890 104  -0.747  0.8779\n     treated ambient - control high      1.2170 0.890 104   1.367  0.5230\n     treated ambient - treated high      0.2806 0.890 104   0.315  0.9891\n     control high - treated high        -0.9364 0.890 104  -1.052  0.7195\n\n    life.stage = juvenile:\n     contrast                          estimate    SE  df t.ratio p.value\n     control ambient - treated ambient  -1.6377 0.939 104  -1.745  0.3061\n     control ambient - control high      0.1868 0.800 104   0.233  0.9955\n     control ambient - treated high      0.2839 0.840 104   0.338  0.9866\n     treated ambient - control high      1.8245 0.904 104   2.019  0.1878\n     treated ambient - treated high      1.9216 0.939 104   2.047  0.1776\n     control high - treated high         0.0971 0.800 104   0.121  0.9994\n\n    life.stage = seed:\n     contrast                          estimate    SE  df t.ratio p.value\n     control ambient - treated ambient  -0.9181 0.818 104  -1.122  0.6769\n     control ambient - control high     -1.4793 0.920 104  -1.608  0.3784\n     control ambient - treated high     -1.2825 0.920 104  -1.395  0.5056\n     treated ambient - control high     -0.5612 0.939 104  -0.598  0.9325\n     treated ambient - treated high     -0.3644 0.939 104  -0.388  0.9800\n     control high - treated high         0.1967 1.030 104   0.191  0.9975\n\n    life.stage = spat:\n     contrast                          estimate    SE  df t.ratio p.value\n     control ambient - treated ambient  -1.2358 1.080 104  -1.146  0.6620\n     control ambient - control high     -1.8735 1.150 104  -1.630  0.3666\n     control ambient - treated high      1.4741 0.991 104   1.488  0.4485\n     treated ambient - control high     -0.6376 1.190 104  -0.534  0.9506\n     treated ambient - treated high      2.7099 1.040 104   2.599  0.0516\n     control high - treated high         3.3475 1.120 104   2.999  0.0176\n\n    P value adjustment: tukey method for comparing a family of 4 estimates \n\nSignificant effect of conditioning x acute treatment.\n\n### 10.1.4 HSP90\n\nHeat shock protein 90 (Hsp90) is a molecular chaperone that helps\nproteins fold, mature, and remain active. Hsp90 also helps regulate\nsignaling networks and is involved in many cellular processes.\n\n``` r\nmodel<-delta_Cq_df%>%\n  filter(Target==\"HSP90\")%>%\n  \n  aov(delta_Cq ~ life.stage * conditioning.treatment * acute.treatment, data=.)\n\nsummary(model)\n```\n\n                                                       Df Sum Sq Mean Sq F value\n    life.stage                                          3  27.25   9.083  13.042\n    conditioning.treatment                              1   0.66   0.662   0.950\n    acute.treatment                                     1  17.57  17.570  25.230\n    life.stage:conditioning.treatment                   3   5.61   1.870   2.686\n    life.stage:acute.treatment                          3   3.89   1.298   1.864\n    conditioning.treatment:acute.treatment              1   1.09   1.088   1.562\n    life.stage:conditioning.treatment:acute.treatment   3   3.52   1.173   1.684\n    Residuals                                         104  72.43   0.696        \n                                                        Pr(>F)    \n    life.stage                                        2.70e-07 ***\n    conditioning.treatment                              0.3319    \n    acute.treatment                                   2.12e-06 ***\n    life.stage:conditioning.treatment                   0.0504 .  \n    life.stage:acute.treatment                          0.1402    \n    conditioning.treatment:acute.treatment              0.2142    \n    life.stage:conditioning.treatment:acute.treatment   0.1749    \n    Residuals                                                     \n    ---\n    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n``` r\nqqPlot(model$residuals)\n```\n\n![](01.01-qPCR_files/figure-gfm/unnamed-chunk-5-1.png)<!-- -->\n\n    [1]   4 103\n\n``` r\nleveneTest(model$residuals ~ life.stage*conditioning.treatment*acute.treatment, data=delta_Cq_df%>%filter(Target==\"HSP90\"))\n```\n\n    Levene's Test for Homogeneity of Variance (center = median)\n           Df F value Pr(>F)\n    group  15  1.1241 0.3447\n          104               \n\n``` r\nemm<-emmeans(model, ~ conditioning.treatment:acute.treatment | life.stage)\npairs(emm)\n```\n\n    life.stage = adult:\n     contrast                          estimate    SE  df t.ratio p.value\n     control ambient - treated ambient  -0.2939 0.417 104  -0.704  0.8951\n     control ambient - control high      0.9690 0.417 104   2.322  0.0995\n     control ambient - treated high     -0.2648 0.417 104  -0.635  0.9206\n     treated ambient - control high      1.2630 0.417 104   3.027  0.0162\n     treated ambient - treated high      0.0292 0.417 104   0.070  0.9999\n     control high - treated high        -1.2338 0.417 104  -2.957  0.0198\n\n    life.stage = juvenile:\n     contrast                          estimate    SE  df t.ratio p.value\n     control ambient - treated ambient   0.3117 0.440 104   0.709  0.8935\n     control ambient - control high      0.9955 0.375 104   2.654  0.0448\n     control ambient - treated high      0.8158 0.393 104   2.074  0.1686\n     treated ambient - control high      0.6838 0.424 104   1.614  0.3750\n     treated ambient - treated high      0.5041 0.440 104   1.146  0.6619\n     control high - treated high        -0.1797 0.375 104  -0.479  0.9636\n\n    life.stage = seed:\n     contrast                          estimate    SE  df t.ratio p.value\n     control ambient - treated ambient  -0.0352 0.383 104  -0.092  0.9997\n     control ambient - control high      0.7954 0.431 104   1.846  0.2581\n     control ambient - treated high      0.0628 0.431 104   0.146  0.9989\n     treated ambient - control high      0.8307 0.440 104   1.889  0.2392\n     treated ambient - treated high      0.0981 0.440 104   0.223  0.9961\n     control high - treated high        -0.7326 0.482 104  -1.520  0.4290\n\n    life.stage = spat:\n     contrast                          estimate    SE  df t.ratio p.value\n     control ambient - treated ambient  -0.1549 0.505 104  -0.306  0.9900\n     control ambient - control high      0.8926 0.539 104   1.657  0.3516\n     control ambient - treated high      1.7849 0.464 104   3.845  0.0012\n     treated ambient - control high      1.0475 0.560 104   1.871  0.2468\n     treated ambient - treated high      1.9398 0.489 104   3.970  0.0008\n     control high - treated high         0.8923 0.523 104   1.706  0.3258\n\n    P value adjustment: tukey method for comparing a family of 4 estimates \n\nSignificant effect of lifestage x acute treatment, lifestage x\nconditioning treatment, acute treatment, and lifestage.\n\n### 10.1.5 cGAS\n\nThe cGAS gene is involved in several processes, including cellular\nresponse to exogenous dsRNA, positive regulation of intracellular signal\ntransduction, and regulation of defense response.\n\n``` r\nmodel<-delta_Cq_df%>%\n  filter(Target==\"cGAS\")%>%\n  \n  aov(delta_Cq ~ life.stage * conditioning.treatment * acute.treatment, data=.)\n\nsummary(model)\n```\n\n                                                       Df Sum Sq Mean Sq F value\n    life.stage                                          3   5.64   1.881   1.302\n    conditioning.treatment                              1   0.55   0.545   0.377\n    acute.treatment                                     1   2.43   2.429   1.681\n    life.stage:conditioning.treatment                   3   1.32   0.440   0.305\n    life.stage:acute.treatment                          3  12.86   4.286   2.965\n    conditioning.treatment:acute.treatment              1   0.31   0.311   0.215\n    life.stage:conditioning.treatment:acute.treatment   3   4.65   1.550   1.073\n    Residuals                                         104 150.32   1.445        \n                                                      Pr(>F)  \n    life.stage                                        0.2779  \n    conditioning.treatment                            0.5404  \n    acute.treatment                                   0.1977  \n    life.stage:conditioning.treatment                 0.8220  \n    life.stage:acute.treatment                        0.0355 *\n    conditioning.treatment:acute.treatment            0.6436  \n    life.stage:conditioning.treatment:acute.treatment 0.3641  \n    Residuals                                                 \n    ---\n    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n``` r\nqqPlot(model$residuals)\n```\n\n![](01.01-qPCR_files/figure-gfm/unnamed-chunk-6-1.png)<!-- -->\n\n    [1]  2 64\n\n``` r\nleveneTest(model$residuals ~ life.stage*conditioning.treatment*acute.treatment, data=delta_Cq_df%>%filter(Target==\"cGAS\"))\n```\n\n    Levene's Test for Homogeneity of Variance (center = median)\n           Df F value  Pr(>F)  \n    group  15  1.5918 0.08854 .\n          104                  \n    ---\n    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n``` r\nemm<-emmeans(model, ~ conditioning.treatment:acute.treatment | life.stage)\npairs(emm)\n```\n\n    life.stage = adult:\n     contrast                          estimate    SE  df t.ratio p.value\n     control ambient - treated ambient   0.0739 0.601 104   0.123  0.9993\n     control ambient - control high      0.5983 0.601 104   0.995  0.7524\n     control ambient - treated high      0.1334 0.601 104   0.222  0.9961\n     treated ambient - control high      0.5244 0.601 104   0.872  0.8191\n     treated ambient - treated high      0.0595 0.601 104   0.099  0.9996\n     control high - treated high        -0.4649 0.601 104  -0.773  0.8663\n\n    life.stage = juvenile:\n     contrast                          estimate    SE  df t.ratio p.value\n     control ambient - treated ambient   0.3421 0.634 104   0.540  0.9490\n     control ambient - control high     -0.1441 0.540 104  -0.267  0.9933\n     control ambient - treated high      0.0553 0.567 104   0.098  0.9997\n     treated ambient - control high     -0.4862 0.610 104  -0.797  0.8557\n     treated ambient - treated high     -0.2869 0.634 104  -0.453  0.9690\n     control high - treated high         0.1994 0.540 104   0.369  0.9828\n\n    life.stage = seed:\n     contrast                          estimate    SE  df t.ratio p.value\n     control ambient - treated ambient   0.1936 0.552 104   0.350  0.9852\n     control ambient - control high     -1.5259 0.621 104  -2.458  0.0728\n     control ambient - treated high     -1.0451 0.621 104  -1.683  0.3376\n     treated ambient - control high     -1.7195 0.634 104  -2.714  0.0384\n     treated ambient - treated high     -1.2387 0.634 104  -1.955  0.2120\n     control high - treated high         0.4808 0.694 104   0.693  0.8997\n\n    life.stage = spat:\n     contrast                          estimate    SE  df t.ratio p.value\n     control ambient - treated ambient  -0.6338 0.728 104  -0.871  0.8200\n     control ambient - control high     -0.8533 0.776 104  -1.100  0.6906\n     control ambient - treated high      0.2963 0.669 104   0.443  0.9708\n     treated ambient - control high     -0.2195 0.806 104  -0.272  0.9929\n     treated ambient - treated high      0.9301 0.704 104   1.321  0.5516\n     control high - treated high         1.1496 0.754 104   1.526  0.4260\n\n    P value adjustment: tukey method for comparing a family of 4 estimates \n\nSignificant effect of lifestage x acute treatment and lifestage.\n\n### 10.1.6 Citrate synthase\n\nCitrate synthase is important for energy production in the TCA cycle and\nis linked to the electron transport chain. It is also used as an enzyme\nmarker for intact mitochondria.\n\n``` r\nmodel<-delta_Cq_df%>%\n  filter(Target==\"citrate synthase\")%>%\n  \n  aov(delta_Cq ~ life.stage * conditioning.treatment * acute.treatment, data=.)\n\nsummary(model)\n```\n\n                                                       Df Sum Sq Mean Sq F value\n    life.stage                                          3  10.15   3.383   6.975\n    conditioning.treatment                              1   1.31   1.305   2.692\n    acute.treatment                                     1   6.78   6.777  13.975\n    life.stage:conditioning.treatment                   3   0.47   0.158   0.325\n    life.stage:acute.treatment                          3   7.74   2.580   5.320\n    conditioning.treatment:acute.treatment              1   1.10   1.104   2.276\n    life.stage:conditioning.treatment:acute.treatment   3   0.13   0.045   0.092\n    Residuals                                         104  50.43   0.485        \n                                                        Pr(>F)    \n    life.stage                                        0.000254 ***\n    conditioning.treatment                            0.103872    \n    acute.treatment                                   0.000303 ***\n    life.stage:conditioning.treatment                 0.807157    \n    life.stage:acute.treatment                        0.001888 ** \n    conditioning.treatment:acute.treatment            0.134455    \n    life.stage:conditioning.treatment:acute.treatment 0.964379    \n    Residuals                                                     \n    ---\n    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n``` r\nqqPlot(model$residuals)\n```\n\n![](01.01-qPCR_files/figure-gfm/unnamed-chunk-7-1.png)<!-- -->\n\n    [1] 117  15\n\n``` r\nleveneTest(model$residuals ~ life.stage*conditioning.treatment*acute.treatment, data=delta_Cq_df%>%filter(Target==\"citrate synthase\"))\n```\n\n    Levene's Test for Homogeneity of Variance (center = median)\n           Df F value  Pr(>F)  \n    group  15  2.0302 0.01964 *\n          104                  \n    ---\n    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n``` r\nemm<-emmeans(model, ~ conditioning.treatment:acute.treatment | life.stage)\npairs(emm)\n```\n\n    life.stage = adult:\n     contrast                          estimate    SE  df t.ratio p.value\n     control ambient - treated ambient  0.31754 0.348 104   0.912  0.7985\n     control ambient - control high     0.30936 0.348 104   0.888  0.8108\n     control ambient - treated high     0.14178 0.348 104   0.407  0.9771\n     treated ambient - control high    -0.00818 0.348 104  -0.023  1.0000\n     treated ambient - treated high    -0.17576 0.348 104  -0.505  0.9578\n     control high - treated high       -0.16758 0.348 104  -0.481  0.9631\n\n    life.stage = juvenile:\n     contrast                          estimate    SE  df t.ratio p.value\n     control ambient - treated ambient  0.69618 0.367 104   1.897  0.2357\n     control ambient - control high     0.08720 0.313 104   0.279  0.9924\n     control ambient - treated high     0.25576 0.328 104   0.779  0.8638\n     treated ambient - control high    -0.60898 0.353 104  -1.723  0.3170\n     treated ambient - treated high    -0.44042 0.367 104  -1.200  0.6282\n     control high - treated high        0.16856 0.313 104   0.539  0.9494\n\n    life.stage = seed:\n     contrast                          estimate    SE  df t.ratio p.value\n     control ambient - treated ambient  0.36475 0.320 104   1.140  0.6657\n     control ambient - control high    -0.97515 0.360 104  -2.712  0.0386\n     control ambient - treated high    -0.88377 0.360 104  -2.458  0.0728\n     treated ambient - control high    -1.33990 0.367 104  -3.651  0.0023\n     treated ambient - treated high    -1.24852 0.367 104  -3.402  0.0052\n     control high - treated high        0.09138 0.402 104   0.227  0.9958\n\n    life.stage = spat:\n     contrast                          estimate    SE  df t.ratio p.value\n     control ambient - treated ambient  0.37761 0.422 104   0.895  0.8072\n     control ambient - control high    -0.89118 0.450 104  -1.983  0.2012\n     control ambient - treated high    -0.70657 0.387 104  -1.824  0.2681\n     treated ambient - control high    -1.26879 0.467 104  -2.716  0.0382\n     treated ambient - treated high    -1.08418 0.408 104  -2.659  0.0443\n     control high - treated high        0.18460 0.436 104   0.423  0.9744\n\n    P value adjustment: tukey method for comparing a family of 4 estimates \n\nSignificant effect of acute treatment and lifestage x acute treatment.\n\n### 10.1.7 Viperin\n\nViperin limits replication of DNA and RNA viruses.\n\n``` r\nmodel<-delta_Cq_df%>%\n  filter(Target==\"viperin\")%>%\n  \n  aov(delta_Cq ~ life.stage * conditioning.treatment * acute.treatment, data=.)\n\nsummary(model)\n```\n\n                                                       Df Sum Sq Mean Sq F value\n    life.stage                                          3  91.90  30.635  15.749\n    conditioning.treatment                              1   2.08   2.080   1.069\n    acute.treatment                                     1   0.76   0.760   0.391\n    life.stage:conditioning.treatment                   3   9.03   3.011   1.548\n    life.stage:acute.treatment                          3   8.58   2.861   1.471\n    conditioning.treatment:acute.treatment              1   2.01   2.010   1.033\n    life.stage:conditioning.treatment:acute.treatment   3   0.94   0.313   0.161\n    Residuals                                         102 198.41   1.945        \n                                                        Pr(>F)    \n    life.stage                                        1.73e-08 ***\n    conditioning.treatment                               0.304    \n    acute.treatment                                      0.533    \n    life.stage:conditioning.treatment                    0.207    \n    life.stage:acute.treatment                           0.227    \n    conditioning.treatment:acute.treatment               0.312    \n    life.stage:conditioning.treatment:acute.treatment    0.922    \n    Residuals                                                     \n    ---\n    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n``` r\nqqPlot(model$residuals)\n```\n\n![](01.01-qPCR_files/figure-gfm/unnamed-chunk-8-1.png)<!-- -->\n\n    [1] 115   3\n\n``` r\nleveneTest(model$residuals ~ life.stage*conditioning.treatment*acute.treatment, data=delta_Cq_df%>%filter(Target==\"viperin\"))\n```\n\n    Levene's Test for Homogeneity of Variance (center = median)\n           Df F value Pr(>F)\n    group  15  1.4856 0.1245\n          102               \n\n``` r\nemm<-emmeans(model, ~ conditioning.treatment:acute.treatment | life.stage)\npairs(emm)\n```\n\n    life.stage = adult:\n     contrast                          estimate    SE  df t.ratio p.value\n     control ambient - treated ambient   0.1683 0.697 102   0.241  0.9950\n     control ambient - control high      0.5763 0.697 102   0.826  0.8418\n     control ambient - treated high      0.2376 0.697 102   0.341  0.9863\n     treated ambient - control high      0.4081 0.697 102   0.585  0.9363\n     treated ambient - treated high      0.0693 0.697 102   0.099  0.9996\n     control high - treated high        -0.3388 0.697 102  -0.486  0.9621\n\n    life.stage = juvenile:\n     contrast                          estimate    SE  df t.ratio p.value\n     control ambient - treated ambient   1.5727 0.735 102   2.140  0.1477\n     control ambient - control high      0.6795 0.627 102   1.084  0.7001\n     control ambient - treated high      1.2753 0.657 102   1.940  0.2181\n     treated ambient - control high     -0.8932 0.708 102  -1.262  0.5892\n     treated ambient - treated high     -0.2974 0.735 102  -0.405  0.9775\n     control high - treated high         0.5958 0.627 102   0.950  0.7777\n\n    life.stage = seed:\n     contrast                          estimate    SE  df t.ratio p.value\n     control ambient - treated ambient  -0.1371 0.678 102  -0.202  0.9971\n     control ambient - control high     -0.5242 0.735 102  -0.713  0.8917\n     control ambient - treated high     -1.1583 0.735 102  -1.576  0.3970\n     treated ambient - control high     -0.3872 0.753 102  -0.514  0.9556\n     treated ambient - treated high     -1.0212 0.753 102  -1.356  0.5298\n     control high - treated high        -0.6341 0.805 102  -0.787  0.8600\n\n    life.stage = spat:\n     contrast                          estimate    SE  df t.ratio p.value\n     control ambient - treated ambient   0.5456 0.845 102   0.646  0.9167\n     control ambient - control high     -0.9091 0.900 102  -1.010  0.7440\n     control ambient - treated high     -0.2650 0.776 102  -0.341  0.9862\n     treated ambient - control high     -1.4547 0.936 102  -1.555  0.4090\n     treated ambient - treated high     -0.8105 0.817 102  -0.993  0.7540\n     control high - treated high         0.6442 0.874 102   0.737  0.8820\n\n    P value adjustment: tukey method for comparing a family of 4 estimates \n\nSignificant effect of acute treatment and lifestage x acute treatment.\n\nAll tests pass normality and homogeneity of variance. ANOVA tests are\nappropriate.\n\n## 10.2 Plotting\n\nDisplay plot of acute x conditioning treatment faceted for each\nlifestage for each target.\n\nShow sample size for each group.\n\n``` r\ndelta_Cq_df%>%\n  group_by(life.stage, acute.treatment, conditioning.treatment)%>%\n  summarise(n=length(unique(Sample)))\n```\n\n    # A tibble: 16 × 4\n    # Groups:   life.stage, acute.treatment [8]\n       life.stage acute.treatment conditioning.treatment     n\n       <chr>      <chr>           <chr>                  <int>\n     1 adult      ambient         control                    8\n     2 adult      ambient         treated                    8\n     3 adult      high            control                    8\n     4 adult      high            treated                    8\n     5 juvenile   ambient         control                    9\n     6 juvenile   ambient         treated                    6\n     7 juvenile   high            control                   11\n     8 juvenile   high            treated                    9\n     9 seed       ambient         control                   10\n    10 seed       ambient         treated                    9\n    11 seed       high            control                    6\n    12 seed       high            treated                    6\n    13 spat       ambient         control                    6\n    14 spat       ambient         treated                    5\n    15 spat       high            control                    4\n    16 spat       high            treated                    7\n\nNote that sample sizes for spat, seed, or juveniles that are \\<6 are due\nto lack of RNA isolated from the samples.\n\nAdults were all sampled from one family (Pink). Previous flow cytometry\nwas unclear as to diploid or triploid classification. We have extracted\nDNA that we can use to verify ploidy.\n\n### 10.2.1 ATP synthase: No effects\n\n``` r\nplot1<-delta_Cq_df%>%\n  filter(Target==\"ATPsynthase\")%>%\n  \n  group_by(Target, life.stage, acute.treatment, conditioning.treatment)%>%\n  summarise(mean=mean(delta_Cq, na.rm=TRUE), se=sd(delta_Cq, na.rm=TRUE)/sqrt(length(delta_Cq)))%>%\n  \n  ggplot(aes(x=acute.treatment, y=mean, colour=conditioning.treatment))+\n  facet_grid(~life.stage)+\n  scale_colour_manual(values=c(\"darkgray\", \"orange\"))+\n  geom_point()+\n  geom_line(aes(group=conditioning.treatment))+\n  geom_errorbar(aes(ymin=mean-se, ymax=mean+se), width=0.1)+\n  ggtitle(\"ATP synthase (no sign. effects)\")+\n  ylab(\"Delta Cq\")+\n  ylim(-0.5,1.5)+\n  geom_hline(yintercept=0, linetype=\"dashed\")+\n  theme_classic();plot1\n```\n\n![](01.01-qPCR_files/figure-gfm/unnamed-chunk-10-1.png)<!-- -->\n\n### 10.2.2 DNMT1: No effects\n\n``` r\nplot2<-delta_Cq_df%>%\n  filter(Target==\"DNMT1\")%>%\n  \n  group_by(Target, life.stage, acute.treatment, conditioning.treatment)%>%\n  summarise(mean=mean(delta_Cq, na.rm=TRUE), se=sd(delta_Cq, na.rm=TRUE)/sqrt(length(delta_Cq)))%>%\n  \n  ggplot(aes(x=acute.treatment, y=mean, colour=conditioning.treatment))+\n  facet_grid(~life.stage)+\n  geom_point()+\n  scale_colour_manual(values=c(\"darkgray\", \"orange\"))+\n  geom_line(aes(group=conditioning.treatment))+\n  geom_errorbar(aes(ymin=mean-se, ymax=mean+se), width=0.1)+\n  ggtitle(\"DMNT1 (no sign. effects)\")+\n  ylab(\"Delta Cq\")+\n  geom_hline(yintercept=0, linetype=\"dashed\")+\n  ylim(0,9)+\n  theme_classic();plot2\n```\n\n![](01.01-qPCR_files/figure-gfm/unnamed-chunk-11-1.png)<!-- -->\n\n### 10.2.3 HSP70: Significant effect of conditioning x acute treatment.\n\n``` r\nplot3<-delta_Cq_df%>%\n  filter(Target==\"HSP70\")%>%\n  \n  group_by(Target, life.stage, acute.treatment, conditioning.treatment)%>%\n  summarise(mean=mean(delta_Cq, na.rm=TRUE), se=sd(delta_Cq, na.rm=TRUE)/sqrt(length(delta_Cq)))%>%\n  \n  ggplot(aes(x=acute.treatment, y=mean, colour=conditioning.treatment))+\n  facet_grid(~life.stage)+\n  scale_colour_manual(values=c(\"darkgray\", \"orange\"))+\n  geom_point()+\n  geom_line(aes(group=conditioning.treatment))+\n  geom_errorbar(aes(ymin=mean-se, ymax=mean+se), width=0.1)+\n  ggtitle(\"HSP70  (sign. conditioning x acute treatment)\")+\n  ylab(\"Delta Cq\")+\n  ylim(0,8)+\n  geom_hline(yintercept=0, linetype=\"dashed\")+\n  theme_classic();plot3\n```\n\n![](01.01-qPCR_files/figure-gfm/unnamed-chunk-12-1.png)<!-- -->\n\n``` r\nplot3a<-delta_Cq_df%>%\n  filter(Target==\"HSP70\")%>%\n  \n  group_by(Target, acute.treatment, conditioning.treatment)%>%\n  summarise(mean=mean(delta_Cq, na.rm=TRUE), se=sd(delta_Cq, na.rm=TRUE)/sqrt(length(delta_Cq)))%>%\n  \n  ggplot(aes(x=acute.treatment, y=mean, colour=conditioning.treatment))+\n  geom_point()+\n  scale_colour_manual(values=c(\"darkgray\", \"orange\"))+\n  geom_line(aes(group=conditioning.treatment))+\n  geom_errorbar(aes(ymin=mean-se, ymax=mean+se), width=0.1)+\n  ggtitle(\"HSP70  (sign. conditioning x acute treatment)\")+\n  ylab(\"Delta Cq\")+\n  geom_hline(yintercept=0, linetype=\"dashed\")+\n  ylim(0,8)+\n  theme_classic();plot3a\n```\n\n![](01.01-qPCR_files/figure-gfm/unnamed-chunk-12-2.png)<!-- -->\n\n### 10.2.4 HSP90: Significant effect of lifestage x acute treatment, lifestage x conditioning treatment, acute treatment, and lifestage.\n\n``` r\nplot4<-delta_Cq_df%>%\n  filter(Target==\"HSP90\")%>%\n  \n  group_by(Target, life.stage, acute.treatment, conditioning.treatment)%>%\n  summarise(mean=mean(delta_Cq, na.rm=TRUE), se=sd(delta_Cq, na.rm=TRUE)/sqrt(length(delta_Cq)))%>%\n  \n  ggplot(aes(x=acute.treatment, y=mean, colour=conditioning.treatment))+\n  facet_grid(~life.stage)+\n  scale_colour_manual(values=c(\"darkgray\", \"orange\"))+\n  geom_point()+\n  geom_line(aes(group=conditioning.treatment))+\n  geom_errorbar(aes(ymin=mean-se, ymax=mean+se), width=0.1)+\n  ggtitle(\"HSP90  (sign. lifestage x acute & lifestage x conditioning treatment)\")+\n  ylab(\"Delta Cq\")+\n  ylim(-2,2.5)+\n  geom_hline(yintercept=0, linetype=\"dashed\")+\n  theme_classic();plot4\n```\n\n![](01.01-qPCR_files/figure-gfm/unnamed-chunk-13-1.png)<!-- -->\n\n### 10.2.5 cGAS: Significant effect of lifestage x acute treatment and lifestage.\n\n``` r\nplot5<-delta_Cq_df%>%\n  filter(Target==\"cGAS\")%>%\n  \n  group_by(Target, life.stage, acute.treatment, conditioning.treatment)%>%\n  summarise(mean=mean(delta_Cq, na.rm=TRUE), se=sd(delta_Cq, na.rm=TRUE)/sqrt(length(delta_Cq)))%>%\n  \n  ggplot(aes(x=acute.treatment, y=mean, colour=conditioning.treatment))+\n  facet_grid(~life.stage)+\n  scale_colour_manual(values=c(\"darkgray\", \"orange\"))+\n  geom_point()+\n  geom_line(aes(group=conditioning.treatment))+\n  geom_errorbar(aes(ymin=mean-se, ymax=mean+se), width=0.1)+\n  ggtitle(\"cGAS  (sign. lifestage x acute treatment)\")+\n  ylab(\"Delta Cq\")+\n  ylim(2,8)+\n  geom_hline(yintercept=0, linetype=\"dashed\")+\n  theme_classic();plot5\n```\n\n![](01.01-qPCR_files/figure-gfm/unnamed-chunk-14-1.png)<!-- -->\n\n### 10.2.6 Citrate synthase: Significant effect of acute treatment and lifestage x acute treatment.\n\n``` r\nplot6<-delta_Cq_df%>%\n  filter(Target==\"citrate synthase\")%>%\n  \n  group_by(Target, life.stage, acute.treatment, conditioning.treatment)%>%\n  summarise(mean=mean(delta_Cq, na.rm=TRUE), se=sd(delta_Cq, na.rm=TRUE)/sqrt(length(delta_Cq)))%>%\n  \n  ggplot(aes(x=acute.treatment, y=mean, colour=conditioning.treatment))+\n  facet_grid(~life.stage)+\n  scale_colour_manual(values=c(\"darkgray\", \"orange\"))+\n  geom_point()+\n  geom_line(aes(group=conditioning.treatment))+\n  geom_errorbar(aes(ymin=mean-se, ymax=mean+se), width=0.1)+\n  ggtitle(\"cGAS  (sign. lifestage x acute treatment)\")+\n  ylab(\"Delta Cq\")+\n  ylim(-2,3)+\n  geom_hline(yintercept=0, linetype=\"dashed\")+\n  theme_classic();plot6\n```\n\n![](01.01-qPCR_files/figure-gfm/unnamed-chunk-15-1.png)<!-- -->\n\n### 10.2.7 Viperin: Significant effect of lifestage and lifestage x acute treatment.\n\n``` r\nplot7<-delta_Cq_df%>%\n  filter(Target==\"viperin\")%>%\n  \n  group_by(Target, life.stage, acute.treatment, conditioning.treatment)%>%\n  summarise(mean=mean(delta_Cq, na.rm=TRUE), se=sd(delta_Cq, na.rm=TRUE)/sqrt(length(delta_Cq)))%>%\n  \n  ggplot(aes(x=acute.treatment, y=mean, colour=conditioning.treatment))+\n  facet_grid(~life.stage)+\n  scale_colour_manual(values=c(\"darkgray\", \"orange\"))+\n  geom_point()+\n  geom_line(aes(group=conditioning.treatment))+\n  geom_errorbar(aes(ymin=mean-se, ymax=mean+se), width=0.1)+\n  ggtitle(\"Viperin  (sign. lifestage x acute treatment)\")+\n  ylab(\"Delta Cq\")+\n  ylim(0,6)+\n  geom_hline(yintercept=0, linetype=\"dashed\")+\n  theme_classic();plot7\n```\n\n![](01.01-qPCR_files/figure-gfm/unnamed-chunk-16-1.png)<!-- -->\n\nPlot spat HSP 70 and HSP 90\n\n``` r\nplot8<-delta_Cq_df%>%\n  dplyr::filter(Target==\"HSP90\")%>%\n  dplyr::filter(life.stage==\"spat\")%>%\n  \n  ggplot(aes(x=acute.treatment, y=delta_Cq, colour=conditioning.treatment))+\n  facet_wrap(~Target, scales=\"free\")+\n  scale_colour_manual(values=c(\"darkgray\", \"orange\"), name=\"Priming\")+\n  geom_boxplot(outliers=FALSE)+\n  geom_point(position=position_jitterdodge(0.1))+\n  ggtitle(\"HSP90\")+\n  geom_text(x=2, y=1, label=\"*\", size=12, color=\"black\")+\n  ylab(\"Expression\")+\n  xlab(\"Temperature\")+\n  ylim(-2,3)+\n  theme_classic()+\n  theme(legend.position=\"none\");plot8\n```\n\n![](01.01-qPCR_files/figure-gfm/unnamed-chunk-17-1.png)<!-- -->\n\n``` r\nplot8a<-delta_Cq_df%>%\n  dplyr::filter(Target==\"HSP70\")%>%\n  dplyr::filter(life.stage==\"spat\")%>%\n  \n  ggplot(aes(x=acute.treatment, y=delta_Cq, colour=conditioning.treatment))+\n  facet_wrap(~Target, scales=\"free\")+\n  scale_colour_manual(values=c(\"darkgray\", \"orange\"), name=\"Priming\")+\n  geom_boxplot(outliers=FALSE)+\n  geom_point(position=position_jitterdodge(0.1))+\n  ggtitle(\"HSP70\")+\n  geom_text(x=2, y=9, label=\"*\", size=12, color=\"black\")+\n  ylab(\"Expression\")+\n  xlab(\"Temperature\")+\n  ylim(-2,10)+\n  theme_classic();plot8a\n```\n\n![](01.01-qPCR_files/figure-gfm/unnamed-chunk-17-2.png)<!-- -->\n\n``` r\nlibrary(cowplot)\nplots<-plot_grid(plot8, plot8a, nrow=1, rel_widths=c(0.8,1))\n\nggsave(plots, filename=\"../output/qPCR/spat-heat-shock.png\", width=8, height=4)\n```\n\n## 10.3 Conclusions\n\n### 10.3.1 Effects of conditioning on acute stress response\n\n- HSP70 and 90 genes are affected by conditioning.\n- HSP90 has significantly higher expression in treated adults than\n  control adults at elevated temperature. No other lifestages have\n  significant differences in expression between conditioning treatments\n  at high temperature.  \n- HSP70 has significantly lower expression in treated spat than control\n  spat at elevated temperature. No other lifestages have significant\n  differences between conditioning treatments at high temperature.\n\n### 10.3.2 Effects of acute stress and lifestage\n\n- Across lifestages (except for juveniles) HSP90 decreases in expression\n  under elevated temperature.\n- Expression of cGAS increases most dramatically in seed under elevated\n  temperature.\n- ATP synthase and DMNT1 are not affected by elevated temperature.\n- Citrate synthase increases in expression in seed and spat under\n  elevated temperature, but does not change in adult or juvenile stages.\n- Effects of acute treatment and life stage are just barely not\n  significant for ATPsynthase and DMNT1. It is particularly interesting\n  to see the trend for higher DMNT1 expression in spat at ambient\n  temperature. There is also a trend for lower expression of ATPsynthase\n  in seed at high temperature, but not technically significant.\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}