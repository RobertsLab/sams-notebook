{
  "hash": "7ef794791b733127dd210c809c911199",
  "result": {
    "engine": "knitr",
    "markdown": "---\nauthor: Sam White\ntoc-title: Contents\ntoc-depth: 5\ntoc-location: left\ntitle: Primer Design - Lake Trout C1q Gene Sequencing Primers Using Primer3\ndate: '2024-09-16'\ndraft: false\nengine: knitr\ncategories: \n  - \"2024\"\n  - \"C1q\"\n  - \"lake trout\"\n  - \"Salvelinus namaycush\"\n  - \"Primer3\"\n  - \"primer design\"\n  - \"EMBOSS\"\n  - \"pyfaidx\"\n---\n\n\n\n\n- <a href=\"#1-create-bash-variables-file\"\n  id=\"toc-1-create-bash-variables-file\">1 CREATE BASH VARIABLES FILE</a>\n- <a href=\"#2-download-ncbi-genome-files\"\n  id=\"toc-2-download-ncbi-genome-files\">2 DOWNLOAD NCBI GENOME FILES</a>\n  - <a href=\"#21-download-the-actual-files\"\n    id=\"toc-21-download-the-actual-files\">2.1 Download the actual files</a>\n  - <a href=\"#22-check-md5-checkums\" id=\"toc-22-check-md5-checkums\">2.2\n    Check MD5 Checkums</a>\n  - <a href=\"#23-decompress-ncbi-files\"\n    id=\"toc-23-decompress-ncbi-files\">2.3 Decompress NCBI files</a>\n- <a href=\"#3-extract-c1q-gene-sequence\"\n  id=\"toc-3-extract-c1q-gene-sequence\">3 EXTRACT C1Q GENE SEQUENCE</a>\n  - <a href=\"#31-peek-at-gff\" id=\"toc-31-peek-at-gff\">3.1 Peek at GFF</a>\n  - <a href=\"#32-format-region-and-extract-c1q-sequence-as-fasta\"\n    id=\"toc-32-format-region-and-extract-c1q-sequence-as-fasta\">3.2 Format\n    region and extract C1q sequence as FastA.</a>\n- <a href=\"#4-extract-c1q-with-53-buffer-regions\"\n  id=\"toc-4-extract-c1q-with-53-buffer-regions\">4 EXTRACT C1Q WITH 5’/3’\n  BUFFER REGIONS</a>\n- <a href=\"#5-primer-design-using-primer3\"\n  id=\"toc-5-primer-design-using-primer3\">5 PRIMER DESIGN USING PRIMER3</a>\n  - <a href=\"#51-design-primers\" id=\"toc-51-design-primers\">5.1 Design\n    primers</a>\n  - <a href=\"#52-amplicon-length\" id=\"toc-52-amplicon-length\">5.2 Amplicon\n    length</a>\n- <a href=\"#6-split-genome\" id=\"toc-6-split-genome\">6 SPLIT GENOME</a>\n  - <a\n    href=\"#61-split-mulit-fasta-file-in-to-individual-fasta-files-with-pyfaidx\"\n    id=\"toc-61-split-mulit-fasta-file-in-to-individual-fasta-files-with-pyfaidx\">6.1\n    Split mulit-FastA file in to individual FastA files with PyFaidx</a>\n- <a href=\"#7-primer-search-with-emboss-primersearch\"\n  id=\"toc-7-primer-search-with-emboss-primersearch\">7 PRIMER SEARCH WITH\n  EMBOSS PRIMERSEARCH</a>\n  - <a href=\"#71-create-emboss-primersearch-primers-file\"\n    id=\"toc-71-create-emboss-primersearch-primers-file\">7.1 Create EMBOSS\n    PrimerSearch Primers File</a>\n  - <a href=\"#72-run-emboss-primersearch\"\n    id=\"toc-72-run-emboss-primersearch\">7.2 Run EMBOSS PrimerSearch</a>\n  - <a href=\"#73-check-primer-matches\" id=\"toc-73-check-primer-matches\">7.3\n    Check primer matches</a>\n- <a href=\"#8-summary\" id=\"toc-8-summary\">8 SUMMARY</a>\n- <a href=\"#9-citations\" id=\"toc-9-citations\">9 CITATIONS</a>\n\nThis notebook describes using\n[Primer3](https://github.com/primer3-org/primer3) ([Untergasser et al.\n2012](#ref-untergasser2012); [Koressaar and Remm\n2007](#ref-koressaar2007)) to reproducibly design primers for sequencing\nof the [lake trout\n(*S.namaycush*)](https://en.wikipedia.org/wiki/Lake_trout) (Wikipedia)\nC1q gene\n([`LOC120027825`](https://github.com/RobertsLab/resources/issues/1941#issuecomment-2246548960)\n(GitHub Issue)). Additionally, this is primarily to confirm that we can\nsuccessfully amplify the C1q gene, since the [bisulfite PCR was\nunsuccessful](https://robertslab.github.io/sams-notebook/posts/2024/2024-09-11-Bisulfite-PCR---Second-Primer-Annealing-Gradient-Test-with-Lake-Trout-Bisulfite-treated-DNA/)\n(Notebook).\n\nThis process also utilizes [pyfaidx](https://github.com/mdshw5/pyfaidx)\n([Shirley et al. 2015](#ref-shirley2015)).\n\n[EMBOSS\nPrimerSearch](https://emboss.sourceforge.net/apps/cvs/emboss/apps/primersearch.html)\n([Rice, Longden, and Bleasby 2000](#ref-rice2000)) will be utilized to\nassess primer specificity across the genome.\n\nThe notebook entry was rendered directly from the R Markdown file,\n[`20240916-snam-c1q-primer-design.Rmd`](https://github.com/RobertsLab/code/blob/ea893a0e9607662b85278bb620f042994efbf374/r_projects/sam/20240916-snam-c1q-primer-design/code/20240916-snam-c1q-primer-design.Rmd)\n(GitHub - commit ea893a0e9607662b85278bb620f042994efbf374).\n\n# 1 CREATE BASH VARIABLES FILE\n\nThis allows usage of Bash variables across R Markdown chunks.\n\n``` bash\n{\necho \"#### Assign Variables ####\"\necho \"\"\n\necho \"# DATA DIRECTORIES\"\necho 'export data_dir=\"../data/S_namaycush/genomes\"'\necho 'export output_top=\"../output\"'\necho 'export genome_fasta_splits_dir=\"${data_dir}/fasta_splits\"'\necho \"\"\n\necho \"# SEQUENCE\"\necho 'export sequence_ID=\"LOC120027825\"'\necho \"\"\n\necho \"# SEQUENCE REGIONS\"\necho 'export left_buffer=\"500\"'\necho 'export right_buffer=\"500\"'\necho \"\"\n\necho \"# INPUT FILES\"\necho 'export genome_fasta=\"GCF_016432855.1_SaNama_1.0_genomic.fna\"'\necho 'export genome_gff=\"GCF_016432855.1_SaNama_1.0_genomic.gff\"'\necho 'export ncbi_gff_gz=\"GCF_016432855.1_SaNama_1.0_genomic.gff.gz\"'\necho 'export ncbi_fasta_gz=\"GCF_016432855.1_SaNama_1.0_genomic.fna.gz\"'\necho 'export ncbi_md5sums=\"md5checksums.txt\"'\necho 'export ncbi_url=\"https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/016/432/855/GCF_016432855.1_SaNama_1.0/\"'\necho \"\"\n\necho \"# OUTPUT FILES\"\necho 'export c1q_fasta=\"${sequence_ID}.fasta\"'\necho 'export c1q_buffer_fasta=\"${sequence_ID}-${left_buffer}bp.left-${right_buffer}bp.right.fasta\"'\necho 'export c1q_faidx_region_file=\"${sequence_ID}\"-region.txt'\necho 'export c1q_buffer_faidx_region_file=\"${sequence_ID}-${left_buffer}bp.left-${right_buffer}bp.right-region.txt\"'\necho \"\"\n\necho \"# SET CPUS\"\necho 'export threads=40'\necho \"\"\n\necho \"# PROGRAMS\"\necho 'export pyfaidx=/home/shared/pyfaidx-0.8.1.1'\necho 'export primer3_dir=\"/home/shared/primer3-2.6.1/src\"'\necho 'export primer3=\"${primer3_dir}/primer3_core\"'\necho 'export primer3_config=\"${primer3_dir}/primer3_config\"'\necho 'export primersearch=\"/home/shared/EMBOSS-6.6.0/emboss/primersearch\"'\n\n\n\n} > .bashvars\n\ncat .bashvars\n```\n\n    #### Assign Variables ####\n\n    # DATA DIRECTORIES\n    export data_dir=\"../data/S_namaycush/genomes\"\n    export output_top=\"../output\"\n    export genome_fasta_splits_dir=\"${data_dir}/fasta_splits\"\n\n    # SEQUENCE\n    export sequence_ID=\"LOC120027825\"\n\n    # SEQUENCE REGIONS\n    export left_buffer=\"500\"\n    export right_buffer=\"500\"\n\n    # INPUT FILES\n    export genome_fasta=\"GCF_016432855.1_SaNama_1.0_genomic.fna\"\n    export genome_gff=\"GCF_016432855.1_SaNama_1.0_genomic.gff\"\n    export ncbi_gff_gz=\"GCF_016432855.1_SaNama_1.0_genomic.gff.gz\"\n    export ncbi_fasta_gz=\"GCF_016432855.1_SaNama_1.0_genomic.fna.gz\"\n    export ncbi_md5sums=\"md5checksums.txt\"\n    export ncbi_url=\"https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/016/432/855/GCF_016432855.1_SaNama_1.0/\"\n\n    # OUTPUT FILES\n    export c1q_fasta=\"${sequence_ID}.fasta\"\n    export c1q_buffer_fasta=\"${sequence_ID}-${left_buffer}bp.left-${right_buffer}bp.right.fasta\"\n    export c1q_faidx_region_file=\"${sequence_ID}\"-region.txt\n    export c1q_buffer_faidx_region_file=\"${sequence_ID}-${left_buffer}bp.left-${right_buffer}bp.right-region.txt\"\n\n    # SET CPUS\n    export threads=40\n\n    # PROGRAMS\n    export pyfaidx=/home/shared/pyfaidx-0.8.1.1\n    export primer3_dir=\"/home/shared/primer3-2.6.1/src\"\n    export primer3=\"${primer3_dir}/primer3_core\"\n    export primer3_config=\"${primer3_dir}/primer3_config\"\n    export primersearch=\"/home/shared/EMBOSS-6.6.0/emboss/primersearch\"\n\n# 2 DOWNLOAD NCBI GENOME FILES\n\n## 2.1 Download the actual files\n\n``` bash\n# Load bash variables into memory\nsource .bashvars\n\nfor file in ${ncbi_gff_gz} ${ncbi_fasta_gz} ${ncbi_md5sums}\ndo\n  wget \\\n  --no-check-certificate \\\n  --continue \\\n  --quiet \\\n  --directory-prefix=${data_dir} \\\n  ${ncbi_url}${file}\ndone\n\nls -lh \"${data_dir}\"\n```\n\n    total 3.3G\n    drwxr-xr-x 2 sam sam 164K Sep 16 16:44 fasta_splits\n    -rw-r--r-- 1 sam sam 2.3G Jan 13  2021 GCF_016432855.1_SaNama_1.0_genomic.fna\n    -rw-r--r-- 1 sam sam 154K Sep 16 13:22 GCF_016432855.1_SaNama_1.0_genomic.fna.fai\n    -rw-r--r-- 1 sam sam 642M Jan 13  2021 GCF_016432855.1_SaNama_1.0_genomic.fna.gz\n    -rw-r--r-- 1 sam sam 373M Sep 28  2022 GCF_016432855.1_SaNama_1.0_genomic.gff\n    -rw-r--r-- 1 sam sam  18M Sep 28  2022 GCF_016432855.1_SaNama_1.0_genomic.gff.gz\n    -rw-r--r-- 1 sam sam  33K Sep 16 01:22 md5checksums.txt\n\n## 2.2 Check MD5 Checkums\n\n``` bash\n# Load bash variables into memory\nsource .bashvars\n\ncd \"${data_dir}\"\n\nfor file in *.gz\ndo\n  grep \"${file}\" ${ncbi_md5sums} | md5sum -c -\ndone\n```\n\n    ./GCF_016432855.1_SaNama_1.0_genomic.fna.gz: OK\n    ./GCF_016432855.1_SaNama_1.0_genomic.gff.gz: OK\n\n## 2.3 Decompress NCBI files\n\n``` bash\n# Load bash variables into memory\nsource .bashvars\n\ncd \"${data_dir}\"\n\nfor file in *.gz\ndo\n  gunzip \"${file}\"\ndone\n\nls -lh\n```\n\n    gzip: GCF_016432855.1_SaNama_1.0_genomic.fna already exists;    not overwritten\n    gzip: GCF_016432855.1_SaNama_1.0_genomic.gff already exists;    not overwritten\n    total 3.3G\n    drwxr-xr-x 2 sam sam 164K Sep 16 16:44 fasta_splits\n    -rw-r--r-- 1 sam sam 2.3G Jan 13  2021 GCF_016432855.1_SaNama_1.0_genomic.fna\n    -rw-r--r-- 1 sam sam 154K Sep 16 13:22 GCF_016432855.1_SaNama_1.0_genomic.fna.fai\n    -rw-r--r-- 1 sam sam 642M Jan 13  2021 GCF_016432855.1_SaNama_1.0_genomic.fna.gz\n    -rw-r--r-- 1 sam sam 373M Sep 28  2022 GCF_016432855.1_SaNama_1.0_genomic.gff\n    -rw-r--r-- 1 sam sam  18M Sep 28  2022 GCF_016432855.1_SaNama_1.0_genomic.gff.gz\n    -rw-r--r-- 1 sam sam  33K Sep 16 01:22 md5checksums.txt\n\n# 3 EXTRACT C1Q GENE SEQUENCE\n\n## 3.1 Peek at GFF\n\n``` bash\n# Load bash variables into memory\nsource .bashvars\n\nawk '$3==\"gene\"' \"${data_dir}/${genome_gff}\" | grep \"${sequence_ID}\" | column -t\n```\n\n    NC_052339.1  Gnomon  gene  19244556  19248013  .  -  .  ID=gene-LOC120027825;Dbxref=GeneID:120027825;Name=LOC120027825;gbkey=Gene;gene=LOC120027825;gene_biotype=protein_coding\n\n## 3.2 Format region and extract C1q sequence as FastA.\n\n``` bash\n# Load bash variables into memory\nsource .bashvars\n\n# Format region for use with pyfaidx\nregion=$(awk '$3==\"gene\"' \"${data_dir}/${genome_gff}\" | grep \"${sequence_ID}\" | awk '{print $1\":\"$4\"-\"$5}')\n\necho \"${region}\"\necho \"\"\n\n# Extract region\n${pyfaidx} \"${data_dir}/${genome_fasta}\" \"${region}\" | tee \"${output_top}/${c1q_fasta}\"\n```\n\n    NC_052339.1:19244556-19248013\n\n    >NC_052339.1:19244556-19248013\n    TGGGATGTGTAATGGTCATATTTATTACCATACCTCTCCACTTCTTCCTCTTTCCctttacaatttttattttttttaaa\n    taataaagtGATGATTTATTTATTGGTTAAAGAGGAAAATCCTCACATCACAGAATGGTGCTGTCCTCACACTGGGAAGA\n    GCAGGAAGCCACTGAAGGTGTTGTGGTTATCATGGCTATCATGGAGACCCTGGTCTTCAGGGAGACGAAGGTAGACCACA\n    TCCTCCTTCTCCAGCTCTAGTGTCAACGCATTAGATATGTACTGCCAACCCCCAACTGTATTTCTTTCTACATTATATAG\n    AACTCTTTGATTATTGTGAAACATCATGATGCCCATGAGTTGTGGGTGGCGGGATGACATGGCCGTGAATCTGAAGAAGT\n    AGACTCCTTTCACTGATGCTGTGAAGATGCCTGCATCAGAGGAGAAATAGAGTGATATCAGCACTGTCTGTCTCATGTTG\n    CTGTAGCTGGAATGTTTTtaacaaataaactcagcaaaaaaagaaatgtcccttttcaggaccctgtctttcaaagataa\n    ttcgtaaaaatccaaataacttcacagatcttcattttaaagggtttaaacactgtttcccatgcttcttcaatgaacca\n    taaacaattaatgaacatgcacctgtggaacggtcgttaagacactaacagcttacagacggtaggcagttAGGCcaaag\n    ttatgaaaacttaggacactaaagaggcctttctactgacactgaaaaacaccaaaagaaagatgtccagggtccctgct\n    catctgcaggaacgtgccttagacatgctgcaaggaggcatgaggactacagatgtggccagggcaataaattgcaatgt\n    ccgtactgtgagacacctaacacagcgctacagggagacaggacggacagctgatcgtcctcgcagtgacagaccacgtg\n    taacaacacctgcacaggatcggtacatccgaacatcacacctgcgggacaggtaccggatggcaacaacaactgcccga\n    gttacaccaggaacgcacaatccctccatcagtgctcagactgtctgcaataggctaagagaggttggactgagggcttg\n    taggcctgttgtcaGGCAGGTCATCACCGGCAActacgtcgcctatgggcacaaacccaccgtcactggaccagacagcc\n    gcggttttgtctcaccaggggtgatggtcggaattgcgtttatcgttgaaggaatgagcgttacactgaggcctgtactc\n    tggagcgggatcgatttggaggtggagggtccgtcatggtctggggcggtgtatcacagcatcatcggactgagcttgtt\n    gtctttgcaggaaatctcaacgctgtgcgttacagggaagacatcctcctccctcatatggtacccttcctgcaggctca\n    tcctgacatgaccctccagcatgacaatgccaccagccatactgctcatgttgtgcgtgatttcctgcaagacaggaatg\n    tcagtgttctgccatggccagcgaagagcccagatctcaatcccattgagcacgtctgggaccttttggatcggagggtg\n    agagctagggccattcgccacagaaatgtctgggaacttgcaggtgccttggtggaagagtggggtaacatctcacagca\n    agaactggcaaatctggtgcagtccatgaggaggagatgcactgcagtacttaatgcagctggtggccacaccagatact\n    gactgttacttttgattttgaccccacctttgttcagggacacattattccatttctgttagtcacatgtctgtggaact\n    tgttcagtttatgtctcagttgttgaatattgttatgttcatacaaatatttacacatgttaagttgactgaaaataaac\n    gcagttgacagtgagaggacgtttcttttaaCAGTGAGAGGAGTTTAGTATAATTAAGTCAGGGACTAGGTAACACAAAT\n    TACCACCAAACACAATAAGTATCAAACTAAACATTGTTATAACTAAAATAAAATCAGGGTGACAGATTAAGTAACATAAA\n    ATATGTCATTAAAAAAAATGACCGTAgacatacagtactagtcaaaagtttggacatacttagaggtgtgggtttttctt\n    tatttttactattttctacattgtagcataatagtgaagacataaactatgaaataacaaatatggaatcatgtagtaac\n    caaaatagtatttaaaaaatctaaatatatttcagatttttcaaagtagccaccctttgcctcgatgacagctttgcact\n    ctcttggcattctctcttcacctggaatgcttttccaagagtgtgcaaaactgtcatcaaggcaaagggtgactacttta\n    aagaatgtcaaatataaaatatattttgatttgttttatactttttgggttactacatgattccatatgtgttatttaat\n    agttttgaagtcttcactattattctacaatgtagaaaatagtaaaataaagaatccctggaataagtaggtgtgtccaa\n    acttttgactggtactgtacgtgttTGGTATCATATAGCTAGTAGTTACAAAAGTAAACTCATTTAAAAGCTTGAAACGT\n    AGAATTTGTCCCTCAGAATTATGTCCACTCTGAAAATCTAGTGTCTTATCATGATTTTCAAAGTAAAATATAAAACAAGT\n    TAGTGAAGTAAAATTATATACAGAGATTACTGAGAAACATGCAGCAAAATCATCCCAGAAGAATTACATTAAATTGCATT\n    CATAAAAAATTATGATGAGATGACTGACTCAATATTTGGCATTGTTGGATGAATGTTATGCAACATTCAAATGGATTTCC\n    CTCTTGTTAGTTAGTACCTGTAATTGGGTTGTAGGCCTTGCCGATGTTGGTGATGACTCTACTGAAGATCAGTGTAGTAG\n    CAGTACTGAATGGACCTACGTTTCCAGAGTCAGTCAAACCAGCAGAGAAGGCCACAGTTGGTCTGCCTGTGAAAAGAAGT\n    TGATTATTTAAAAGGACAATCTGAGATTGAAATAACAACAAGGCAAATGCTTACTTATCCACCTGTATCAATccaattta\n    caaatgcctgatATTTCTGACATGACCTGCTTTCTCTTTCTCCAGCTCTTCCACCTTGCTCTTCTGGAGCTGCAGTTCAG\n    TCTTGGTGACGCTCAGCTCCTGTCTCTGTTCCACCATCATGTCTCTCAGCTCCTCCAGCTTAGACCAGATGTCAGGGGTC\n    TTGTGGGCCGTCTCTGTAGCTTCAGCCCATGCCCCAAACAGAGAAAACAGCAGCAGAGCTACAGCACCTCTCATTCTGAA\n    ACGACACATCTTCTGAAATGATCTAGTCTTTGAGGCTAGAAATTTACAGGATTAAAGTAGGAGCTATATCTGTGTGAAAT\n    ATATTGTGTCTCTGTGGA\n\n# 4 EXTRACT C1Q WITH 5’/3’ BUFFER REGIONS\n\nSince we want to sequence the entirety of the C1q gene, we need to add\nsome buffer sequence outside of the 5’/3’ ends of the gene. I’ve\narbitrarily established large buffer regions:\n\n- Left buffer: 500bp\n- Right buffer: 500bp\n\n``` bash\n# Load bash variables into memory\nsource .bashvars\n\n# Format region for use with pyfaidx\n# Use awk to add/subtract desired buffer regions\nregion=$(awk '$3==\"gene\"' \"${data_dir}/${genome_gff}\" \\\n| grep \"${sequence_ID}\" \\\n| awk -v left_buffer=\"$left_buffer\" -v right_buffer=\"$right_buffer\" '{print $1\":\"$4 - left_buffer\"-\"$5 + right_buffer}')\n\necho \"Region formatting: ${region}\"\necho \"\"\n\n# Extract region\n${pyfaidx} \"${data_dir}/${genome_fasta}\" \"${region}\" | tee \"${output_top}/${c1q_buffer_fasta}\"\n```\n\n    Region formatting: NC_052339.1:19244056-19248513\n\n    >NC_052339.1:19244056-19248513\n    catgttctgttataatctccacccggcacagccaaaagaggactggccacccctcatagcctggttcctctctaggtttc\n    ttcctaggttttggcctttctagggagtttttcctagccaccgtgcttctacacctgcattgcttgctgtttggggtttt\n    aggctgggtttctgtacagcactttgagatatcagctgatgtaagaagggctatataaatacatttgatttgatttgata\n    aggtcACTAGTTACTTATTAAATATGGATATGTCTGAACGACTAACCCTGAGACACATCAGAAAGCTGAGTTCACGTCAT\n    AATATTGTGATTATAATCACAATCCCTTCTTACACCACTATAAATGTGTCTCTGTCCTTATCTGAGTCTCTGAATGTAGC\n    CTATGTGTGACCTGAATGTATCTGTTACCTTAATGTAATGTAGCCTACATGTGTTACTTGAAAAATAACCCTAAATTGGT\n    TCTTATTCCCAACACAGCTCTGGGATGTGTAATGGTCATATTTATTACCATACCTCTCCACTTCTTCCTCTTTCCcttta\n    caatttttattttttttaaataataaagtGATGATTTATTTATTGGTTAAAGAGGAAAATCCTCACATCACAGAATGGTG\n    CTGTCCTCACACTGGGAAGAGCAGGAAGCCACTGAAGGTGTTGTGGTTATCATGGCTATCATGGAGACCCTGGTCTTCAG\n    GGAGACGAAGGTAGACCACATCCTCCTTCTCCAGCTCTAGTGTCAACGCATTAGATATGTACTGCCAACCCCCAACTGTA\n    TTTCTTTCTACATTATATAGAACTCTTTGATTATTGTGAAACATCATGATGCCCATGAGTTGTGGGTGGCGGGATGACAT\n    GGCCGTGAATCTGAAGAAGTAGACTCCTTTCACTGATGCTGTGAAGATGCCTGCATCAGAGGAGAAATAGAGTGATATCA\n    GCACTGTCTGTCTCATGTTGCTGTAGCTGGAATGTTTTtaacaaataaactcagcaaaaaaagaaatgtcccttttcagg\n    accctgtctttcaaagataattcgtaaaaatccaaataacttcacagatcttcattttaaagggtttaaacactgtttcc\n    catgcttcttcaatgaaccataaacaattaatgaacatgcacctgtggaacggtcgttaagacactaacagcttacagac\n    ggtaggcagttAGGCcaaagttatgaaaacttaggacactaaagaggcctttctactgacactgaaaaacaccaaaagaa\n    agatgtccagggtccctgctcatctgcaggaacgtgccttagacatgctgcaaggaggcatgaggactacagatgtggcc\n    agggcaataaattgcaatgtccgtactgtgagacacctaacacagcgctacagggagacaggacggacagctgatcgtcc\n    tcgcagtgacagaccacgtgtaacaacacctgcacaggatcggtacatccgaacatcacacctgcgggacaggtaccgga\n    tggcaacaacaactgcccgagttacaccaggaacgcacaatccctccatcagtgctcagactgtctgcaataggctaaga\n    gaggttggactgagggcttgtaggcctgttgtcaGGCAGGTCATCACCGGCAActacgtcgcctatgggcacaaacccac\n    cgtcactggaccagacagccgcggttttgtctcaccaggggtgatggtcggaattgcgtttatcgttgaaggaatgagcg\n    ttacactgaggcctgtactctggagcgggatcgatttggaggtggagggtccgtcatggtctggggcggtgtatcacagc\n    atcatcggactgagcttgttgtctttgcaggaaatctcaacgctgtgcgttacagggaagacatcctcctccctcatatg\n    gtacccttcctgcaggctcatcctgacatgaccctccagcatgacaatgccaccagccatactgctcatgttgtgcgtga\n    tttcctgcaagacaggaatgtcagtgttctgccatggccagcgaagagcccagatctcaatcccattgagcacgtctggg\n    accttttggatcggagggtgagagctagggccattcgccacagaaatgtctgggaacttgcaggtgccttggtggaagag\n    tggggtaacatctcacagcaagaactggcaaatctggtgcagtccatgaggaggagatgcactgcagtacttaatgcagc\n    tggtggccacaccagatactgactgttacttttgattttgaccccacctttgttcagggacacattattccatttctgtt\n    agtcacatgtctgtggaacttgttcagtttatgtctcagttgttgaatattgttatgttcatacaaatatttacacatgt\n    taagttgactgaaaataaacgcagttgacagtgagaggacgtttcttttaaCAGTGAGAGGAGTTTAGTATAATTAAGTC\n    AGGGACTAGGTAACACAAATTACCACCAAACACAATAAGTATCAAACTAAACATTGTTATAACTAAAATAAAATCAGGGT\n    GACAGATTAAGTAACATAAAATATGTCATTAAAAAAAATGACCGTAgacatacagtactagtcaaaagtttggacatact\n    tagaggtgtgggtttttctttatttttactattttctacattgtagcataatagtgaagacataaactatgaaataacaa\n    atatggaatcatgtagtaaccaaaatagtatttaaaaaatctaaatatatttcagatttttcaaagtagccaccctttgc\n    ctcgatgacagctttgcactctcttggcattctctcttcacctggaatgcttttccaagagtgtgcaaaactgtcatcaa\n    ggcaaagggtgactactttaaagaatgtcaaatataaaatatattttgatttgttttatactttttgggttactacatga\n    ttccatatgtgttatttaatagttttgaagtcttcactattattctacaatgtagaaaatagtaaaataaagaatccctg\n    gaataagtaggtgtgtccaaacttttgactggtactgtacgtgttTGGTATCATATAGCTAGTAGTTACAAAAGTAAACT\n    CATTTAAAAGCTTGAAACGTAGAATTTGTCCCTCAGAATTATGTCCACTCTGAAAATCTAGTGTCTTATCATGATTTTCA\n    AAGTAAAATATAAAACAAGTTAGTGAAGTAAAATTATATACAGAGATTACTGAGAAACATGCAGCAAAATCATCCCAGAA\n    GAATTACATTAAATTGCATTCATAAAAAATTATGATGAGATGACTGACTCAATATTTGGCATTGTTGGATGAATGTTATG\n    CAACATTCAAATGGATTTCCCTCTTGTTAGTTAGTACCTGTAATTGGGTTGTAGGCCTTGCCGATGTTGGTGATGACTCT\n    ACTGAAGATCAGTGTAGTAGCAGTACTGAATGGACCTACGTTTCCAGAGTCAGTCAAACCAGCAGAGAAGGCCACAGTTG\n    GTCTGCCTGTGAAAAGAAGTTGATTATTTAAAAGGACAATCTGAGATTGAAATAACAACAAGGCAAATGCTTACTTATCC\n    ACCTGTATCAATccaatttacaaatgcctgatATTTCTGACATGACCTGCTTTCTCTTTCTCCAGCTCTTCCACCTTGCT\n    CTTCTGGAGCTGCAGTTCAGTCTTGGTGACGCTCAGCTCCTGTCTCTGTTCCACCATCATGTCTCTCAGCTCCTCCAGCT\n    TAGACCAGATGTCAGGGGTCTTGTGGGCCGTCTCTGTAGCTTCAGCCCATGCCCCAAACAGAGAAAACAGCAGCAGAGCT\n    ACAGCACCTCTCATTCTGAAACGACACATCTTCTGAAATGATCTAGTCTTTGAGGCTAGAAATTTACAGGATTAAAGTAG\n    GAGCTATATCTGTGTGAAATATATTGTGTCTCTGTGGAAAAAAGAGGGTTCTTAAATATCAGGGAGTATTATTTGATTAG\n    GATTACTGGTAGGATTCTTTATTTGTTTTTACTGGCAATGAGGTGAAGGTTTCTTGCGTCATTCACCAGTTGTTGTTACT\n    GTATTTCGTCATACTTAATTTTGATAGTCCCCTAGATAGGGAgtgggcgtacacatcacagacaaactaaaatggtccac\n    acagacagtgtggtaaagaaggaaggccaaaaagatcatcaaggacaacaaccacccgagccactgcctgttcacactgc\n    tatcatccagaaggtgaggtcagtacaggtacatcaagctgggaccgagagattgagaaacagcttctatctcaaggcca\n    tcagactgctaaacagcaatcattaACTGAGAGAGTCTGCTGCCCACATTGAGAACCAATCAcaggacactttaataaat\n    ggatcactagtcactttaaacaatgccactttaaataatggcactttaataatgctta\n\n# 5 PRIMER DESIGN USING [PRIMER3](https://github.com/primer3-org/primer3)\n\n## 5.1 Design primers\n\nQuick explanation: [Primer3](https://github.com/primer3-org/primer3)\nrequires a specially formatted input file. The file must be formatted\nsimilarly to this:\n\n    SEQUENCE_ID=${seq_id}\n    SEQUENCE_TEMPLATE=${sequence}\n    PRIMER_TASK=generic\n    PRIMER_PICK_LEFT_PRIMER=3\n    PRIMER_PICK_RIGHT_PRIMER=3\n    PRIMER_OPT_SIZE=18\n    PRIMER_MIN_SIZE=15\n    PRIMER_MAX_SIZE=21\n    PRIMER_MAX_NS_ACCEPTED=1\n    PRIMER_PRODUCT_SIZE_RANGE=75-150\n    P3_FILE_FLAG=1\n    PRIMER_EXPLAIN_FLAG=1\n    =\n\nValues after the `=` on each line can be changed to whatever values the\nuser decides. The \\${sequence} must be a nucletoide sequence on a single\nline, with no line breaks.\n\nThe code in the chunk below uses a heredoc to write this information to\na file. Use of a heredoc allows the variables specified in the Primer3\nconfig to expand to their actual values. Everything *between* the\nfollowing two lines gets printed (via cat) as shown and then redirected\nto the indicated file (`primer3-params.txt`):\n\n``` bash\ncat << EOF > ${output_top}/primer3-params.txt\nEOF\n```\n\n[Primer3](https://github.com/primer3-org/primer3) is run with the\n`--format_output` to make a nice, human-readable output format.\n\nI’ve also set [Primer3](https://github.com/primer3-org/primer3) to look\nfor sequencing primers and have defined the `SEQUENCE_TARGET`.\n\n``` bash\n# Load bash variables into memory\nsource .bashvars\n\n# Get sequence only, by skipping the first record\n# Remove newlines so sequence is on a single line\nc1q_sequence=$(awk 'NR > 1' \"${output_top}/${c1q_fasta}\" | tr -d '\\n')\n\n# Determine length of C1q\nc1q_length=${#c1q_sequence}\n\n# Get sequence only, by skipping the first record\n# Remove newlines so sequence is on a single line\nc1q_buffer_sequence=$(awk 'NR > 1' \"${output_top}/${c1q_buffer_fasta}\" | tr -d '\\n')\n\n# Determine length of C1q with the 5'/3' buffer sequences included\nc1q_buffer_length=${#c1q_buffer_sequence}\n\n# Calculate combined length of 5'buffer region and C1q length\nc1q_buffer_and_seq_length=$((left_buffer + c1q_length))\n\n\n# Use heredoc to create Primer3 parameters file\ncat << EOF > ${output_top}/primer3-params.txt\nSEQUENCE_ID=${sequence_ID}\nSEQUENCE_TEMPLATE=${c1q_buffer_sequence}\nPRIMER_TASK=pick_sequencing_primers\nSEQUENCE_TARGET=${left_buffer},${c1q_length}\nPRIMER_MIN_TM=50\nPRIMER_OPT_TM=60\nPRIMER_PICK_LEFT_PRIMER=1\nPRIMER_PICK_RIGHT_PRIMER=1\nPRIMER_OPT_SIZE=20\nPRIMER_MIN_SIZE=18\nPRIMER_MAX_SIZE=25\nPRIMER_MAX_NS_ACCEPTED=0\nP3_FILE_FLAG=1\nPRIMER_EXPLAIN_FLAG=1\nPRIMER_THERMODYNAMIC_PARAMETERS_PATH=${primer3_config}\nPRIMER_NUM_RETURN=10\nPRIMER_PAIR_EXPLAIN=considered 0, ok 0\n=\nEOF\n\n\n# Run Primer3\n${primer3} \\\n--format_output \\\n--output=\"${output_top}/primer3-primers.txt\" \\\n\"${output_top}/primer3-params.txt\"\n\n# Run Primer3 with default output for parsable results\n${primer3} \\\n--output=\"${output_top}/primer3-primers-default-format.txt\" \\\n\"${output_top}/primer3-params.txt\"\n\n\n# Pull out any primers falling outside of target\ntail -n 30 \"${output_top}/primer3-primers.txt\" \\\n| head -n -12 \\\n| awk -v left_buffer=\"$left_buffer\" -v target=\"$c1q_buffer_and_seq_length\" '$3 <= left_buffer || $3 >= target {print $0}'\n\n\n### Write the left and right primer start positions to files for later use in R chunk(s).\n# Pull out left primer start position\nleft_primer_start=$(tail -n 30 \"${output_top}/primer3-primers.txt\" \\\n| head -n -12 \\\n| awk -v left_buffer=\"$left_buffer\" -v target=\"$c1q_buffer_and_seq_length\" '$3 <= left_buffer || $3 >= target {print $0}' \\\n| grep \"PRIMER\" \\\n| awk 'NR == 1 {print $3}')\n\n# Pull out right primer start position\nright_primer_start=$(tail -n 30 \"${output_top}/primer3-primers.txt\" \\\n| head -n -12 \\\n| awk -v left_buffer=\"$left_buffer\" -v target=\"$c1q_buffer_and_seq_length\" '$3 <= left_buffer || $3 >= target {print $0}' \\\n| grep \"PRIMER\" \\\n| awk 'NR == 2 {print $3}')\n\necho \"${left_primer_start}\" > \"${output_top}/left-primer-start.txt\"\necho \"${right_primer_start}\" > \"${output_top}/right-primer-start.txt\"\n\necho \"\"\necho \"\"\necho \"----------------------------------------------------------------------------------\"\necho \"\"\necho \"Primer results file:\"\necho \"\"\necho \"\"\n# Print the full output file\ncat \"${output_top}/primer3-primers.txt\"\n\necho \"\"\necho \"\"\necho \"----------------------------------------------------------------------------------\"\necho \"\"\necho \"Primer default (i.e. computer-friendly) results file:\"\necho \"\"\necho \"\"\n\n# Print the full output file\ncat \"${output_top}/primer3-primers-default-format.txt\"\n```\n\n     1 LEFT_PRIMER        277   20   58.01   50.00    0.00   0.00    0.00 ACGACTAACCCTGAGACACA\n\n                         start  len      tm     gc%  any_th  3'_th hairpin seq\n     8 RIGHT_PRIMER      4188   21   59.22   47.62    3.32   0.00    0.00 tggccttccttctttaccaca\n\n\n    ----------------------------------------------------------------------------------\n\n    Primer results file:\n\n\n    PRIMER PICKING RESULTS FOR LOC120027825\n\n    No mispriming library specified\n    Using 0-based sequence positions\n    SEQUENCE SIZE: 4458\n    INCLUDED REGION SIZE: 4458\n\n    TARGETS (start, len)*: 500,3458\n        0 catgttctgttataatctccacccggcacagccaaaagaggactggccacccctcatagc\n                                                                      \n\n       60 ctggttcctctctaggtttcttcctaggttttggcctttctagggagtttttcctagcca\n                                                                      \n\n      120 ccgtgcttctacacctgcattgcttgctgtttggggttttaggctgggtttctgtacagc\n                                                                      \n\n      180 actttgagatatcagctgatgtaagaagggctatataaatacatttgatttgatttgata\n                                                                      \n\n      240 aggtcACTAGTTACTTATTAAATATGGATATGTCTGAACGACTAACCCTGAGACACATCA\n                                               >>>>>>>>>>>>>>>>>>>>   \n\n      300 GAAAGCTGAGTTCACGTCATAATATTGTGATTATAATCACAATCCCTTCTTACACCACTA\n                                                                      \n\n      360 TAAATGTGTCTCTGTCCTTATCTGAGTCTCTGAATGTAGCCTATGTGTGACCTGAATGTA\n                                                                      \n\n      420 TCTGTTACCTTAATGTAATGTAGCCTACATGTGTTACTTGAAAAATAACCCTAAATTGGT\n                                                                      \n\n      480 TCTTATTCCCAACACAGCTCTGGGATGTGTAATGGTCATATTTATTACCATACCTCTCCA\n                              ****************************************\n\n      540 CTTCTTCCTCTTTCCctttacaatttttattttttttaaataataaagtGATGATTTATT\n          ************************************************************\n\n      600 TATTGGTTAAAGAGGAAAATCCTCACATCACAGAATGGTGCTGTCCTCACACTGGGAAGA\n          **********************************<<<<<<<<<<<<<<<<<<<<******\n\n      660 GCAGGAAGCCACTGAAGGTGTTGTGGTTATCATGGCTATCATGGAGACCCTGGTCTTCAG\n          ************************************************************\n\n      720 GGAGACGAAGGTAGACCACATCCTCCTTCTCCAGCTCTAGTGTCAACGCATTAGATATGT\n          ************************************************************\n\n      780 ACTGCCAACCCCCAACTGTATTTCTTTCTACATTATATAGAACTCTTTGATTATTGTGAA\n          *>>>>>>>>>>>>>>>>>>>>***************************************\n\n      840 ACATCATGATGCCCATGAGTTGTGGGTGGCGGGATGACATGGCCGTGAATCTGAAGAAGT\n          ************************************************************\n\n      900 AGACTCCTTTCACTGATGCTGTGAAGATGCCTGCATCAGAGGAGAAATAGAGTGATATCA\n          ************************************************************\n\n      960 GCACTGTCTGTCTCATGTTGCTGTAGCTGGAATGTTTTtaacaaataaactcagcaaaaa\n          ************************************************************\n\n     1020 aagaaatgtcccttttcaggaccctgtctttcaaagataattcgtaaaaatccaaataac\n          ************************************************************\n\n     1080 ttcacagatcttcattttaaagggtttaaacactgtttcccatgcttcttcaatgaacca\n          ************************************************************\n\n     1140 taaacaattaatgaacatgcacctgtggaacggtcgttaagacactaacagcttacagac\n          *******************<<<<<<<<<<<<<<<<<<<<*********************\n\n     1200 ggtaggcagttAGGCcaaagttatgaaaacttaggacactaaagaggcctttctactgac\n          ************************************************************\n\n     1260 actgaaaaacaccaaaagaaagatgtccagggtccctgctcatctgcaggaacgtgcctt\n          *******************************************>>>>>>>>>>>>>>>>>\n\n     1320 agacatgctgcaaggaggcatgaggactacagatgtggccagggcaataaattgcaatgt\n          >>>*********************************************************\n\n     1380 ccgtactgtgagacacctaacacagcgctacagggagacaggacggacagctgatcgtcc\n          ************************************************************\n\n     1440 tcgcagtgacagaccacgtgtaacaacacctgcacaggatcggtacatccgaacatcaca\n          ************************************************************\n\n     1500 cctgcgggacaggtaccggatggcaacaacaactgcccgagttacaccaggaacgcacaa\n          ************************************************************\n\n     1560 tccctccatcagtgctcagactgtctgcaataggctaagagaggttggactgagggcttg\n          ************************************************************\n\n     1620 taggcctgttgtcaGGCAGGTCATCACCGGCAActacgtcgcctatgggcacaaacccac\n          ****************<<<<<<<<<<<<<<<<<<<<************************\n\n     1680 cgtcactggaccagacagccgcggttttgtctcaccaggggtgatggtcggaattgcgtt\n          ************************************************************\n\n     1740 tatcgttgaaggaatgagcgttacactgaggcctgtactctggagcgggatcgatttgga\n          **************************************>>>>>>>>>>>>>>>>>>>>**\n\n     1800 ggtggagggtccgtcatggtctggggcggtgtatcacagcatcatcggactgagcttgtt\n          ************************************************************\n\n     1860 gtctttgcaggaaatctcaacgctgtgcgttacagggaagacatcctcctccctcatatg\n          ************************************************************\n\n     1920 gtacccttcctgcaggctcatcctgacatgaccctccagcatgacaatgccaccagccat\n          ************************************************************\n\n     1980 actgctcatgttgtgcgtgatttcctgcaagacaggaatgtcagtgttctgccatggcca\n          ************************************************************\n\n     2040 gcgaagagcccagatctcaatcccattgagcacgtctgggaccttttggatcggagggtg\n          ************************************************************\n\n     2100 agagctagggccattcgccacagaaatgtctgggaacttgcaggtgccttggtggaagag\n          ************************************************************\n\n     2160 tggggtaacatctcacagcaagaactggcaaatctggtgcagtccatgaggaggagatgc\n          **********<<<<<<<<<<<<<<<<<<<<******************************\n\n     2220 actgcagtacttaatgcagctggtggccacaccagatactgactgttacttttgattttg\n          ************************************************************\n\n     2280 accccacctttgttcagggacacattattccatttctgttagtcacatgtctgtggaact\n          **>>>>>>>>>>>>>>>>>>>>**************************************\n\n     2340 tgttcagtttatgtctcagttgttgaatattgttatgttcatacaaatatttacacatgt\n          ************************************************************\n\n     2400 taagttgactgaaaataaacgcagttgacagtgagaggacgtttcttttaaCAGTGAGAG\n          ************************************************************\n\n     2460 GAGTTTAGTATAATTAAGTCAGGGACTAGGTAACACAAATTACCACCAAACACAATAAGT\n          ************************************************************\n\n     2520 ATCAAACTAAACATTGTTATAACTAAAATAAAATCAGGGTGACAGATTAAGTAACATAAA\n          ************************************************************\n\n     2580 ATATGTCATTAAAAAAAATGACCGTAgacatacagtactagtcaaaagtttggacatact\n          *********************************************************<<<\n\n     2640 tagaggtgtgggtttttctttatttttactattttctacattgtagcataatagtgaaga\n          <<<<<<<<<<<<<<<<<<<*****************************************\n\n     2700 cataaactatgaaataacaaatatggaatcatgtagtaaccaaaatagtatttaaaaaat\n          ************************************************************\n\n     2760 ctaaatatatttcagatttttcaaagtagccaccctttgcctcgatgacagctttgcact\n          *******************************>>>>>>>>>>>>>>>>>>>>*********\n\n     2820 ctcttggcattctctcttcacctggaatgcttttccaagagtgtgcaaaactgtcatcaa\n          ************************************************************\n\n     2880 ggcaaagggtgactactttaaagaatgtcaaatataaaatatattttgatttgttttata\n          ************************************************************\n\n     2940 ctttttgggttactacatgattccatatgtgttatttaatagttttgaagtcttcactat\n          ************************************************************\n\n     3000 tattctacaatgtagaaaatagtaaaataaagaatccctggaataagtaggtgtgtccaa\n          ************************************************************\n\n     3060 acttttgactggtactgtacgtgttTGGTATCATATAGCTAGTAGTTACAAAAGTAAACT\n          ************************************************************\n\n     3120 CATTTAAAAGCTTGAAACGTAGAATTTGTCCCTCAGAATTATGTCCACTCTGAAAATCTA\n          **************************<<<<<<<<<<<<<<<<<<<<<<<***********\n\n     3180 GTGTCTTATCATGATTTTCAAAGTAAAATATAAAACAAGTTAGTGAAGTAAAATTATATA\n          ************************************************************\n\n     3240 CAGAGATTACTGAGAAACATGCAGCAAAATCATCCCAGAAGAATTACATTAAATTGCATT\n          ********************>>>>>>>>>>>>>>>>>>>>>>>>>***************\n\n     3300 CATAAAAAATTATGATGAGATGACTGACTCAATATTTGGCATTGTTGGATGAATGTTATG\n          ************************************************************\n\n     3360 CAACATTCAAATGGATTTCCCTCTTGTTAGTTAGTACCTGTAATTGGGTTGTAGGCCTTG\n          ************************************************************\n\n     3420 CCGATGTTGGTGATGACTCTACTGAAGATCAGTGTAGTAGCAGTACTGAATGGACCTACG\n          ************************************************************\n\n     3480 TTTCCAGAGTCAGTCAAACCAGCAGAGAAGGCCACAGTTGGTCTGCCTGTGAAAAGAAGT\n          ************************************************************\n\n     3540 TGATTATTTAAAAGGACAATCTGAGATTGAAATAACAACAAGGCAAATGCTTACTTATCC\n          ************************************************************\n\n     3600 ACCTGTATCAATccaatttacaaatgcctgatATTTCTGACATGACCTGCTTTCTCTTTC\n          ************************************************************\n\n     3660 TCCAGCTCTTCCACCTTGCTCTTCTGGAGCTGCAGTTCAGTCTTGGTGACGCTCAGCTCC\n          **<<<<<<<<<<<<<<<<<<<<**************************************\n\n     3720 TGTCTCTGTTCCACCATCATGTCTCTCAGCTCCTCCAGCTTAGACCAGATGTCAGGGGTC\n          ***********************************************>>>>>>>>>>>>>\n\n     3780 TTGTGGGCCGTCTCTGTAGCTTCAGCCCATGCCCCAAACAGAGAAAACAGCAGCAGAGCT\n          >>>>>>>*****************************************************\n\n     3840 ACAGCACCTCTCATTCTGAAACGACACATCTTCTGAAATGATCTAGTCTTTGAGGCTAGA\n          ************************************************************\n\n     3900 AATTTACAGGATTAAAGTAGGAGCTATATCTGTGTGAAATATATTGTGTCTCTGTGGAAA\n          **********************************************************  \n\n     3960 AAAGAGGGTTCTTAAATATCAGGGAGTATTATTTGATTAGGATTACTGGTAGGATTCTTT\n                                                                      \n\n     4020 ATTTGTTTTTACTGGCAATGAGGTGAAGGTTTCTTGCGTCATTCACCAGTTGTTGTTACT\n                                                                      \n\n     4080 GTATTTCGTCATACTTAATTTTGATAGTCCCCTAGATAGGGAgtgggcgtacacatcaca\n                                                                      \n\n     4140 gacaaactaaaatggtccacacagacagtgtggtaaagaaggaaggccaaaaagatcatc\n                                      <<<<<<<<<<<<<<<<<<<<<           \n\n     4200 aaggacaacaaccacccgagccactgcctgttcacactgctatcatccagaaggtgaggt\n                                                                      \n\n     4260 cagtacaggtacatcaagctgggaccgagagattgagaaacagcttctatctcaaggcca\n                                                                      \n\n     4320 tcagactgctaaacagcaatcattaACTGAGAGAGTCTGCTGCCCACATTGAGAACCAAT\n                                                                      \n\n     4380 CAcaggacactttaataaatggatcactagtcactttaaacaatgccactttaaataatg\n                                                                      \n\n     4440 gcactttaataatgctta\n                            \n\n    KEYS (in order of precedence):\n    ****** target\n    >>>>>> left primer\n    <<<<<< right primer\n    ^^^^^^ left primer / right primer overlap\n\n                        start  len      tm     gc%  any_th  3'_th hairpin seq\n     1 LEFT_PRIMER        277   20   58.01   50.00    0.00   0.00    0.00 ACGACTAACCCTGAGACACA\n     2 LEFT_PRIMER        781   20   59.96   55.00    0.00   0.00    0.00 CTGCCAACCCCCAACTGTAT\n     3 LEFT_PRIMER       1303   20   60.04   55.00   14.25   0.00   43.28 ctgcaggaacgtgccttaga\n     4 LEFT_PRIMER       1778   20   59.90   55.00    0.00   0.00   39.00 tctggagcgggatcgatttg\n     5 LEFT_PRIMER       2282   20   59.82   55.00    0.00   0.00   42.25 cccacctttgttcagggaca\n     6 LEFT_PRIMER       2791   20   60.04   55.00    0.00   0.00    0.00 accctttgcctcgatgacag\n     7 LEFT_PRIMER       3260   25   60.63   40.00    0.00   0.00    0.00 GCAGCAAAATCATCCCAGAAGAATT\n     8 LEFT_PRIMER       3767   20   60.04   60.00    0.00   0.00    0.00 GATGTCAGGGGTCTTGTGGG\n\n                         start  len      tm     gc%  any_th  3'_th hairpin seq\n     1 RIGHT_PRIMER       653   20   59.96   55.00    0.00   0.00   35.43 CAGTGTGAGGACAGCACCAT\n     2 RIGHT_PRIMER      1178   20   59.97   55.00   11.27   0.00   41.51 taacgaccgttccacaggtg\n     3 RIGHT_PRIMER      1655   20   59.75   55.00    1.90   0.00   40.58 tagTTGCCGGTGATGACCTG\n     4 RIGHT_PRIMER      2189   20   59.53   50.00    0.00   0.00   34.84 tgccagttcttgctgtgaga\n     5 RIGHT_PRIMER      2658   22   57.21   40.91    0.00   0.00    0.00 agaaaaacccacacctctaagt\n     6 RIGHT_PRIMER      3168   23   58.90   43.48    0.00   0.00    0.00 AGTGGACATAATTCTGAGGGACA\n     7 RIGHT_PRIMER      3681   20   59.68   55.00    0.00   0.00   35.36 AGAGCAAGGTGGAAGAGCTG\n     8 RIGHT_PRIMER      4188   21   59.22   47.62    3.32   0.00    0.00 tggccttccttctttaccaca\n\n    Statistics\n             con   too    in    in   not          no    tm    tm   high  high  high        high      \n             sid  many   tar  excl    ok   bad    GC   too   too any_th 3'_th hair-  poly   end      \n            ered    Ns   get   reg   reg   GC% clamp   low  high  compl compl   pin     X  stab    ok\n    Left    2518     0     0     0     0   162     0   221   612      0     0   176    10     0     8\n    Right   2560     0     0     0     0   108     0   205   530      0     0   221     0     0     8\n    Pair Stats:\n    considered 0, ok 0\n    libprimer3 release 2.6.1\n\n\n\n\n    ----------------------------------------------------------------------------------\n\n    Primer default (i.e. computer-friendly) results file:\n\n\n    SEQUENCE_ID=LOC120027825\n    SEQUENCE_TEMPLATE=catgttctgttataatctccacccggcacagccaaaagaggactggccacccctcatagcctggttcctctctaggtttcttcctaggttttggcctttctagggagtttttcctagccaccgtgcttctacacctgcattgcttgctgtttggggttttaggctgggtttctgtacagcactttgagatatcagctgatgtaagaagggctatataaatacatttgatttgatttgataaggtcACTAGTTACTTATTAAATATGGATATGTCTGAACGACTAACCCTGAGACACATCAGAAAGCTGAGTTCACGTCATAATATTGTGATTATAATCACAATCCCTTCTTACACCACTATAAATGTGTCTCTGTCCTTATCTGAGTCTCTGAATGTAGCCTATGTGTGACCTGAATGTATCTGTTACCTTAATGTAATGTAGCCTACATGTGTTACTTGAAAAATAACCCTAAATTGGTTCTTATTCCCAACACAGCTCTGGGATGTGTAATGGTCATATTTATTACCATACCTCTCCACTTCTTCCTCTTTCCctttacaatttttattttttttaaataataaagtGATGATTTATTTATTGGTTAAAGAGGAAAATCCTCACATCACAGAATGGTGCTGTCCTCACACTGGGAAGAGCAGGAAGCCACTGAAGGTGTTGTGGTTATCATGGCTATCATGGAGACCCTGGTCTTCAGGGAGACGAAGGTAGACCACATCCTCCTTCTCCAGCTCTAGTGTCAACGCATTAGATATGTACTGCCAACCCCCAACTGTATTTCTTTCTACATTATATAGAACTCTTTGATTATTGTGAAACATCATGATGCCCATGAGTTGTGGGTGGCGGGATGACATGGCCGTGAATCTGAAGAAGTAGACTCCTTTCACTGATGCTGTGAAGATGCCTGCATCAGAGGAGAAATAGAGTGATATCAGCACTGTCTGTCTCATGTTGCTGTAGCTGGAATGTTTTtaacaaataaactcagcaaaaaaagaaatgtcccttttcaggaccctgtctttcaaagataattcgtaaaaatccaaataacttcacagatcttcattttaaagggtttaaacactgtttcccatgcttcttcaatgaaccataaacaattaatgaacatgcacctgtggaacggtcgttaagacactaacagcttacagacggtaggcagttAGGCcaaagttatgaaaacttaggacactaaagaggcctttctactgacactgaaaaacaccaaaagaaagatgtccagggtccctgctcatctgcaggaacgtgccttagacatgctgcaaggaggcatgaggactacagatgtggccagggcaataaattgcaatgtccgtactgtgagacacctaacacagcgctacagggagacaggacggacagctgatcgtcctcgcagtgacagaccacgtgtaacaacacctgcacaggatcggtacatccgaacatcacacctgcgggacaggtaccggatggcaacaacaactgcccgagttacaccaggaacgcacaatccctccatcagtgctcagactgtctgcaataggctaagagaggttggactgagggcttgtaggcctgttgtcaGGCAGGTCATCACCGGCAActacgtcgcctatgggcacaaacccaccgtcactggaccagacagccgcggttttgtctcaccaggggtgatggtcggaattgcgtttatcgttgaaggaatgagcgttacactgaggcctgtactctggagcgggatcgatttggaggtggagggtccgtcatggtctggggcggtgtatcacagcatcatcggactgagcttgttgtctttgcaggaaatctcaacgctgtgcgttacagggaagacatcctcctccctcatatggtacccttcctgcaggctcatcctgacatgaccctccagcatgacaatgccaccagccatactgctcatgttgtgcgtgatttcctgcaagacaggaatgtcagtgttctgccatggccagcgaagagcccagatctcaatcccattgagcacgtctgggaccttttggatcggagggtgagagctagggccattcgccacagaaatgtctgggaacttgcaggtgccttggtggaagagtggggtaacatctcacagcaagaactggcaaatctggtgcagtccatgaggaggagatgcactgcagtacttaatgcagctggtggccacaccagatactgactgttacttttgattttgaccccacctttgttcagggacacattattccatttctgttagtcacatgtctgtggaacttgttcagtttatgtctcagttgttgaatattgttatgttcatacaaatatttacacatgttaagttgactgaaaataaacgcagttgacagtgagaggacgtttcttttaaCAGTGAGAGGAGTTTAGTATAATTAAGTCAGGGACTAGGTAACACAAATTACCACCAAACACAATAAGTATCAAACTAAACATTGTTATAACTAAAATAAAATCAGGGTGACAGATTAAGTAACATAAAATATGTCATTAAAAAAAATGACCGTAgacatacagtactagtcaaaagtttggacatacttagaggtgtgggtttttctttatttttactattttctacattgtagcataatagtgaagacataaactatgaaataacaaatatggaatcatgtagtaaccaaaatagtatttaaaaaatctaaatatatttcagatttttcaaagtagccaccctttgcctcgatgacagctttgcactctcttggcattctctcttcacctggaatgcttttccaagagtgtgcaaaactgtcatcaaggcaaagggtgactactttaaagaatgtcaaatataaaatatattttgatttgttttatactttttgggttactacatgattccatatgtgttatttaatagttttgaagtcttcactattattctacaatgtagaaaatagtaaaataaagaatccctggaataagtaggtgtgtccaaacttttgactggtactgtacgtgttTGGTATCATATAGCTAGTAGTTACAAAAGTAAACTCATTTAAAAGCTTGAAACGTAGAATTTGTCCCTCAGAATTATGTCCACTCTGAAAATCTAGTGTCTTATCATGATTTTCAAAGTAAAATATAAAACAAGTTAGTGAAGTAAAATTATATACAGAGATTACTGAGAAACATGCAGCAAAATCATCCCAGAAGAATTACATTAAATTGCATTCATAAAAAATTATGATGAGATGACTGACTCAATATTTGGCATTGTTGGATGAATGTTATGCAACATTCAAATGGATTTCCCTCTTGTTAGTTAGTACCTGTAATTGGGTTGTAGGCCTTGCCGATGTTGGTGATGACTCTACTGAAGATCAGTGTAGTAGCAGTACTGAATGGACCTACGTTTCCAGAGTCAGTCAAACCAGCAGAGAAGGCCACAGTTGGTCTGCCTGTGAAAAGAAGTTGATTATTTAAAAGGACAATCTGAGATTGAAATAACAACAAGGCAAATGCTTACTTATCCACCTGTATCAATccaatttacaaatgcctgatATTTCTGACATGACCTGCTTTCTCTTTCTCCAGCTCTTCCACCTTGCTCTTCTGGAGCTGCAGTTCAGTCTTGGTGACGCTCAGCTCCTGTCTCTGTTCCACCATCATGTCTCTCAGCTCCTCCAGCTTAGACCAGATGTCAGGGGTCTTGTGGGCCGTCTCTGTAGCTTCAGCCCATGCCCCAAACAGAGAAAACAGCAGCAGAGCTACAGCACCTCTCATTCTGAAACGACACATCTTCTGAAATGATCTAGTCTTTGAGGCTAGAAATTTACAGGATTAAAGTAGGAGCTATATCTGTGTGAAATATATTGTGTCTCTGTGGAAAAAAGAGGGTTCTTAAATATCAGGGAGTATTATTTGATTAGGATTACTGGTAGGATTCTTTATTTGTTTTTACTGGCAATGAGGTGAAGGTTTCTTGCGTCATTCACCAGTTGTTGTTACTGTATTTCGTCATACTTAATTTTGATAGTCCCCTAGATAGGGAgtgggcgtacacatcacagacaaactaaaatggtccacacagacagtgtggtaaagaaggaaggccaaaaagatcatcaaggacaacaaccacccgagccactgcctgttcacactgctatcatccagaaggtgaggtcagtacaggtacatcaagctgggaccgagagattgagaaacagcttctatctcaaggccatcagactgctaaacagcaatcattaACTGAGAGAGTCTGCTGCCCACATTGAGAACCAATCAcaggacactttaataaatggatcactagtcactttaaacaatgccactttaaataatggcactttaataatgctta\n    PRIMER_TASK=pick_sequencing_primers\n    SEQUENCE_TARGET=500,3458\n    PRIMER_MIN_TM=50\n    PRIMER_OPT_TM=60\n    PRIMER_PICK_LEFT_PRIMER=1\n    PRIMER_PICK_RIGHT_PRIMER=1\n    PRIMER_OPT_SIZE=20\n    PRIMER_MIN_SIZE=18\n    PRIMER_MAX_SIZE=25\n    PRIMER_MAX_NS_ACCEPTED=0\n    P3_FILE_FLAG=1\n    PRIMER_EXPLAIN_FLAG=1\n    PRIMER_THERMODYNAMIC_PARAMETERS_PATH=/home/shared/primer3-2.6.1/src/primer3_config\n    PRIMER_NUM_RETURN=10\n    PRIMER_PAIR_EXPLAIN=considered 0, ok 0\n    PRIMER_LEFT_EXPLAIN=sequencing locations 8, considered 2518, GC content failed 162, low tm 221, high tm 612, high hairpin stability 176, long poly-x seq 10, ok 8\n    PRIMER_RIGHT_EXPLAIN=sequencing locations 8, considered 2560, GC content failed 108, low tm 205, high tm 530, high hairpin stability 221, ok 8\n    PRIMER_PAIR_EXPLAIN=considered 0, ok 0\n    PRIMER_LEFT_NUM_RETURNED=8\n    PRIMER_RIGHT_NUM_RETURNED=8\n    PRIMER_INTERNAL_NUM_RETURNED=0\n    PRIMER_PAIR_NUM_RETURNED=0\n    PRIMER_LEFT_0_PENALTY=1.991121\n    PRIMER_RIGHT_0_PENALTY=0.035881\n    PRIMER_LEFT_0_SEQUENCE=ACGACTAACCCTGAGACACA\n    PRIMER_RIGHT_0_SEQUENCE=CAGTGTGAGGACAGCACCAT\n    PRIMER_LEFT_0=277,20\n    PRIMER_RIGHT_0=653,20\n    PRIMER_LEFT_0_TM=58.009\n    PRIMER_RIGHT_0_TM=59.964\n    PRIMER_LEFT_0_GC_PERCENT=50.000\n    PRIMER_RIGHT_0_GC_PERCENT=55.000\n    PRIMER_LEFT_0_SELF_ANY_TH=0.00\n    PRIMER_RIGHT_0_SELF_ANY_TH=0.00\n    PRIMER_LEFT_0_SELF_END_TH=0.00\n    PRIMER_RIGHT_0_SELF_END_TH=0.00\n    PRIMER_LEFT_0_HAIRPIN_TH=0.00\n    PRIMER_RIGHT_0_HAIRPIN_TH=35.43\n    PRIMER_LEFT_0_END_STABILITY=3.7200\n    PRIMER_RIGHT_0_END_STABILITY=3.5500\n    PRIMER_LEFT_1_PENALTY=0.039618\n    PRIMER_RIGHT_1_PENALTY=0.032403\n    PRIMER_LEFT_1_SEQUENCE=CTGCCAACCCCCAACTGTAT\n    PRIMER_RIGHT_1_SEQUENCE=taacgaccgttccacaggtg\n    PRIMER_LEFT_1=781,20\n    PRIMER_RIGHT_1=1178,20\n    PRIMER_LEFT_1_TM=59.960\n    PRIMER_RIGHT_1_TM=59.968\n    PRIMER_LEFT_1_GC_PERCENT=55.000\n    PRIMER_RIGHT_1_GC_PERCENT=55.000\n    PRIMER_LEFT_1_SELF_ANY_TH=0.00\n    PRIMER_RIGHT_1_SELF_ANY_TH=11.27\n    PRIMER_LEFT_1_SELF_END_TH=0.00\n    PRIMER_RIGHT_1_SELF_END_TH=0.00\n    PRIMER_LEFT_1_HAIRPIN_TH=0.00\n    PRIMER_RIGHT_1_HAIRPIN_TH=41.51\n    PRIMER_LEFT_1_END_STABILITY=2.2900\n    PRIMER_RIGHT_1_END_STABILITY=4.0000\n    PRIMER_LEFT_2_PENALTY=0.037326\n    PRIMER_RIGHT_2_PENALTY=0.249120\n    PRIMER_LEFT_2_SEQUENCE=ctgcaggaacgtgccttaga\n    PRIMER_RIGHT_2_SEQUENCE=tagTTGCCGGTGATGACCTG\n    PRIMER_LEFT_2=1303,20\n    PRIMER_RIGHT_2=1655,20\n    PRIMER_LEFT_2_TM=60.037\n    PRIMER_RIGHT_2_TM=59.751\n    PRIMER_LEFT_2_GC_PERCENT=55.000\n    PRIMER_RIGHT_2_GC_PERCENT=55.000\n    PRIMER_LEFT_2_SELF_ANY_TH=14.25\n    PRIMER_RIGHT_2_SELF_ANY_TH=1.90\n    PRIMER_LEFT_2_SELF_END_TH=0.00\n    PRIMER_RIGHT_2_SELF_END_TH=0.00\n    PRIMER_LEFT_2_HAIRPIN_TH=43.28\n    PRIMER_RIGHT_2_HAIRPIN_TH=40.58\n    PRIMER_LEFT_2_END_STABILITY=2.1000\n    PRIMER_RIGHT_2_END_STABILITY=4.0000\n    PRIMER_LEFT_3_PENALTY=0.104855\n    PRIMER_RIGHT_3_PENALTY=0.469494\n    PRIMER_LEFT_3_SEQUENCE=tctggagcgggatcgatttg\n    PRIMER_RIGHT_3_SEQUENCE=tgccagttcttgctgtgaga\n    PRIMER_LEFT_3=1778,20\n    PRIMER_RIGHT_3=2189,20\n    PRIMER_LEFT_3_TM=59.895\n    PRIMER_RIGHT_3_TM=59.531\n    PRIMER_LEFT_3_GC_PERCENT=55.000\n    PRIMER_RIGHT_3_GC_PERCENT=50.000\n    PRIMER_LEFT_3_SELF_ANY_TH=0.00\n    PRIMER_RIGHT_3_SELF_ANY_TH=0.00\n    PRIMER_LEFT_3_SELF_END_TH=0.00\n    PRIMER_RIGHT_3_SELF_END_TH=0.00\n    PRIMER_LEFT_3_HAIRPIN_TH=39.00\n    PRIMER_RIGHT_3_HAIRPIN_TH=34.84\n    PRIMER_LEFT_3_END_STABILITY=2.3200\n    PRIMER_RIGHT_3_END_STABILITY=3.2700\n    PRIMER_LEFT_4_PENALTY=0.184933\n    PRIMER_RIGHT_4_PENALTY=4.790718\n    PRIMER_LEFT_4_SEQUENCE=cccacctttgttcagggaca\n    PRIMER_RIGHT_4_SEQUENCE=agaaaaacccacacctctaagt\n    PRIMER_LEFT_4=2282,20\n    PRIMER_RIGHT_4=2658,22\n    PRIMER_LEFT_4_TM=59.815\n    PRIMER_RIGHT_4_TM=57.209\n    PRIMER_LEFT_4_GC_PERCENT=55.000\n    PRIMER_RIGHT_4_GC_PERCENT=40.909\n    PRIMER_LEFT_4_SELF_ANY_TH=0.00\n    PRIMER_RIGHT_4_SELF_ANY_TH=0.00\n    PRIMER_LEFT_4_SELF_END_TH=0.00\n    PRIMER_RIGHT_4_SELF_END_TH=0.00\n    PRIMER_LEFT_4_HAIRPIN_TH=42.25\n    PRIMER_RIGHT_4_HAIRPIN_TH=0.00\n    PRIMER_LEFT_4_END_STABILITY=4.0200\n    PRIMER_RIGHT_4_END_STABILITY=2.2400\n    PRIMER_LEFT_5_PENALTY=0.036010\n    PRIMER_RIGHT_5_PENALTY=4.104086\n    PRIMER_LEFT_5_SEQUENCE=accctttgcctcgatgacag\n    PRIMER_RIGHT_5_SEQUENCE=AGTGGACATAATTCTGAGGGACA\n    PRIMER_LEFT_5=2791,20\n    PRIMER_RIGHT_5=3168,23\n    PRIMER_LEFT_5_TM=60.036\n    PRIMER_RIGHT_5_TM=58.896\n    PRIMER_LEFT_5_GC_PERCENT=55.000\n    PRIMER_RIGHT_5_GC_PERCENT=43.478\n    PRIMER_LEFT_5_SELF_ANY_TH=0.00\n    PRIMER_RIGHT_5_SELF_ANY_TH=0.00\n    PRIMER_LEFT_5_SELF_END_TH=0.00\n    PRIMER_RIGHT_5_SELF_END_TH=0.00\n    PRIMER_LEFT_5_HAIRPIN_TH=0.00\n    PRIMER_RIGHT_5_HAIRPIN_TH=0.00\n    PRIMER_LEFT_5_END_STABILITY=3.5100\n    PRIMER_RIGHT_5_END_STABILITY=4.0200\n    PRIMER_LEFT_6_PENALTY=5.626116\n    PRIMER_RIGHT_6_PENALTY=0.324285\n    PRIMER_LEFT_6_SEQUENCE=GCAGCAAAATCATCCCAGAAGAATT\n    PRIMER_RIGHT_6_SEQUENCE=AGAGCAAGGTGGAAGAGCTG\n    PRIMER_LEFT_6=3260,25\n    PRIMER_RIGHT_6=3681,20\n    PRIMER_LEFT_6_TM=60.626\n    PRIMER_RIGHT_6_TM=59.676\n    PRIMER_LEFT_6_GC_PERCENT=40.000\n    PRIMER_RIGHT_6_GC_PERCENT=55.000\n    PRIMER_LEFT_6_SELF_ANY_TH=0.00\n    PRIMER_RIGHT_6_SELF_ANY_TH=0.00\n    PRIMER_LEFT_6_SELF_END_TH=0.00\n    PRIMER_RIGHT_6_SELF_END_TH=0.00\n    PRIMER_LEFT_6_HAIRPIN_TH=0.00\n    PRIMER_RIGHT_6_HAIRPIN_TH=35.36\n    PRIMER_LEFT_6_END_STABILITY=2.1700\n    PRIMER_RIGHT_6_END_STABILITY=4.2400\n    PRIMER_LEFT_7_PENALTY=0.035056\n    PRIMER_RIGHT_7_PENALTY=1.777878\n    PRIMER_LEFT_7_SEQUENCE=GATGTCAGGGGTCTTGTGGG\n    PRIMER_RIGHT_7_SEQUENCE=tggccttccttctttaccaca\n    PRIMER_LEFT_7=3767,20\n    PRIMER_RIGHT_7=4188,21\n    PRIMER_LEFT_7_TM=60.035\n    PRIMER_RIGHT_7_TM=59.222\n    PRIMER_LEFT_7_GC_PERCENT=60.000\n    PRIMER_RIGHT_7_GC_PERCENT=47.619\n    PRIMER_LEFT_7_SELF_ANY_TH=0.00\n    PRIMER_RIGHT_7_SELF_ANY_TH=3.32\n    PRIMER_LEFT_7_SELF_END_TH=0.00\n    PRIMER_RIGHT_7_SELF_END_TH=0.00\n    PRIMER_LEFT_7_HAIRPIN_TH=0.00\n    PRIMER_RIGHT_7_HAIRPIN_TH=0.00\n    PRIMER_LEFT_7_END_STABILITY=4.6100\n    PRIMER_RIGHT_7_END_STABILITY=4.1700\n    =\n\nLooks like we have one primer pair where both are outside of the C1q\ngene sequence.\n\n## 5.2 Amplicon length\n\nThe primer pair will produced an amplicon length of 3911bp.\n\nNext, we need to test them against the entire genome to assess\nspecificity.\n\n# 6 SPLIT GENOME\n\nFor some reason, I feel like the EMBOSS PrimerSearch tool will *not*\nwork on mulit-FastA files (or, it makes the results more difficult to\ndecipher?), but I’m just going off of memory and repeating a process\nI’ve done previously.\n\nThis will split the genome multi-FastA file into separate FastA files.\n\n## 6.1 Split mulit-FastA file in to individual FastA files with PyFaidx\n\n``` bash\n# Load bash variables into memory\nsource .bashvars\n\n# Make directory if it doesn't exist\nmkdir --parents ${genome_fasta_splits_dir}\n\ncd ${genome_fasta_splits_dir}\n\n# Count sequences in FastA\necho \"-------------------------------------------------------------------\"\necho \"NUMBER OF SEQUENCES IN ORIGINAL FASTA\"\ngrep -c \"^>\" ../${genome_fasta}\necho \"-------------------------------------------------------------------\"\necho \"\"\necho \"\"\n\n\n\n# Split FastA\n${pyfaidx} \\\n--split-files \\\n../${genome_fasta}\n\n# Count number of individual FastA files\necho \"-------------------------------------------------------------------\"\necho \"NUMBER OF INDIVIDUAL FASTA FILES\"\nls -1 | wc -l\necho \"-------------------------------------------------------------------\"\n```\n\n    -------------------------------------------------------------------\n    NUMBER OF SEQUENCES IN ORIGINAL FASTA\n    4121\n    -------------------------------------------------------------------\n\n\n    -------------------------------------------------------------------\n    NUMBER OF INDIVIDUAL FASTA FILES\n    4122\n    -------------------------------------------------------------------\n\n# 7 PRIMER SEARCH WITH [EMBOSS PRIMERSEARCH](https://emboss.sourceforge.net/apps/cvs/emboss/apps/primersearch.html)\n\nThis will run [EMBOSS\nPrimerSearch](https://emboss.sourceforge.net/apps/cvs/emboss/apps/primersearch.html)\nagainst the genome to assess primer specificity.\n\n## 7.1 Create EMBOSS PrimerSearch Primers File\n\nCreate a tab-delimited file to use with EMBOSS PrimerSearch.\n\n``` bash\n# Load bash variables into memory\nsource .bashvars\n\n# Get primer info from Primer3 default format output\nseq_id=$(grep \"SEQUENCE_ID=\" \"${output_top}/primer3-primers-default-format.txt\" | sed 's/SEQUENCE_ID=//')\n\nleft_primer=$(grep \"PRIMER_LEFT_0_SEQUENCE=\" \"${output_top}/primer3-primers-default-format.txt\" | sed 's/PRIMER_LEFT_0_SEQUENCE=//' | tr '[:lower:]' '[:upper:]')\n\nright_primer=$(grep \"PRIMER_RIGHT_7_SEQUENCE=\" \"${output_top}/primer3-primers-default-format.txt\" | sed 's/PRIMER_RIGHT_7_SEQUENCE=//' | tr '[:lower:]' '[:upper:]')\n\n# Create EMBOSS primer file\nprintf \"%s\\t%s\\t%s\\t\\n\" \"${seq_id}\" \"${left_primer}\" \"${right_primer}\" | tee \"${output_top}/emboss-primers.txt\"\n```\n\n    LOC120027825    ACGACTAACCCTGAGACACA    TGGCCTTCCTTCTTTACCACA   \n\n## 7.2 Run EMBOSS PrimerSearch\n\nThis will run EMBOSS PrimerSearch and allow for a 10% mismatch in primer\nannealing sites (`${primersearch} -auto ${fasta} ${primers} 10`).\n\nAfterwards, the resulting output files (`*.primersearch`) will be\nsearched for the term `Amplimer`, indicating a PCR product would be\nproduced. If no amplimer is identified in a `*.primersearch` file, then\nthat file is deleted. This should leave just the results in which primer\nmatches were identified.\n\n``` bash\n# Load bash variables into memory\nsource .bashvars\n\ncd ${genome_fasta_splits_dir}\n\nprimers=\"../../../../output/emboss-primers.txt\"\n\n\ntime \\\nfor fasta in *.fna\n  do\n  # Remove path from FastA filename\n  fasta_no_path=$(echo ${fasta##*/})\n  \n  # Remove file extension from FastA filename\n  fasta_no_ext=$(echo ${fasta_no_path%%.*})\n  \n  # Convert filename to lowercase\n  # Will be used for output from EMBOSS PrimerSearch\n  fasta_no_ext_lower=$(echo ${fasta_no_ext} | tr '[:upper:]' '[:lower:]')\n  \n  ###### Run EMBOSS PrimerSearch on all FastA files ########\n  # Allows for a 10% mismatch\n  ${primersearch} -auto ${fasta} ${primers} 10\n  ##### END EMBOSS ##########\n  \n  # Find EMBOSS PrimerSearch output files with primer matches\n  # Remove those without a match\n  if ! grep --quiet \"Amplimer\" \"${fasta_no_ext_lower}.primersearch\"\n    then rm ${fasta_no_ext_lower}.primersearch\n  fi\ndone\n```\n\n    real    5m28.518s\n    user    4m14.155s\n    sys 1m45.833s\n\n## 7.3 Check primer matches\n\nThis will print the contents of any remaining `*.primersearch` output\nfiles (i.e. sequences with primer matches)\n\n``` bash\n# Load bash variables into memory\nsource .bashvars\n\ncd ${genome_fasta_splits_dir}\n\n# Check contents of files with matches\nfor file in *.primersearch\n  do\n  echo \"FILE: ${file}\"\n  echo \"\"\n  cat ${file}\n  echo \"----------------------------------\"\n  echo \"\"\ndone\n```\n\n    FILE: nc_052339.primersearch\n\n\n    Primer name LOC120027825\n    Amplimer 1\n        Sequence: NC_052339.1  \n        \n        ACGACTAACCCTGAGACACA hits forward strand at 19244333 with 0 mismatches\n        TGGCCTTCCTTCTTTACCACA hits reverse strand at [18091675] with 0 mismatches\n        Amplimer length: 3912 bp\n    ----------------------------------\n\n# 8 SUMMARY\n\nEMBOSS PrimerSearch has identified only a single location in the genome\nwhere the forward and reverse primers match, as well as in the expected\nlocation on chromosome `NC_052339`. This means our primers are specific\nto our desired target in the genome.\n\n# 9 CITATIONS\n\n<div id=\"refs\" class=\"references csl-bib-body hanging-indent\">\n\n<div id=\"ref-koressaar2007\" class=\"csl-entry\">\n\nKoressaar, Triinu, and Maido Remm. 2007. “Enhancements and Modifications\nof Primer Design Program Primer3.” *Bioinformatics* 23 (10): 1289–91.\n<https://doi.org/10.1093/bioinformatics/btm091>.\n\n</div>\n\n<div id=\"ref-rice2000\" class=\"csl-entry\">\n\nRice, Peter, Ian Longden, and Alan Bleasby. 2000. “EMBOSS: The European\nMolecular Biology Open Software Suite.” *Trends in Genetics* 16 (6):\n276–77. <https://doi.org/10.1016/s0168-9525(00)02024-2>.\n\n</div>\n\n<div id=\"ref-shirley2015\" class=\"csl-entry\">\n\nShirley, Matthew D, Zhaorong Ma, Brent S Pedersen, and Sarah J Wheelan.\n2015. “Efficient \"Pythonic\" Access to FASTA Files Using Pyfaidx.”\n<http://dx.doi.org/10.7287/peerj.preprints.970v1>.\n\n</div>\n\n<div id=\"ref-untergasser2012\" class=\"csl-entry\">\n\nUntergasser, Andreas, Ioana Cutcutache, Triinu Koressaar, Jian Ye, Brant\nC. Faircloth, Maido Remm, and Steven G. Rozen. 2012. “Primer3new\nCapabilities and Interfaces.” *Nucleic Acids Research* 40 (15): e115–15.\n<https://doi.org/10.1093/nar/gks596>.\n\n</div>\n\n</div>\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}