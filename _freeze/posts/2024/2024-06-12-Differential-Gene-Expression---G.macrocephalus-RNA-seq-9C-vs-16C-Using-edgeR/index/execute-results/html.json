{
  "hash": "53195e9dc32047214bce64f192d4467d",
  "result": {
    "engine": "knitr",
    "markdown": "---\nauthor: Sam White\ntoc-title: Contents\ntoc-depth: 5\ntoc-location: left\ntitle: Differential Gene Expression - G.macrocephalus RNA-seq 9C vs 16C Using edgeR\ndate: '2024-06-11'\ndraft: false\nengine: knitr\ncategories: \n  - \"edgeR\"\n  - \"Pacific cod\"\n  - \"RNA-seq\"\n  - \"differential gene expression\"\n  - \"2024\"\n  - \"Gadus macrocephalus\"\n---\n\n\n\n\n- <a href=\"#1-create-output-directory\"\n  id=\"toc-1-create-output-directory\">1 CREATE OUTPUT DIRECTORY</a>\n- <a href=\"#2-edger-grouping-vector\" id=\"toc-2-edger-grouping-vector\">2\n  edgeR GROUPING VECTOR</a>\n  - <a href=\"#21-check-sample-info\" id=\"toc-21-check-sample-info\">2.1 Check\n    sample info</a>\n  - <a href=\"#22-create-edger-grouping-vector\"\n    id=\"toc-22-create-edger-grouping-vector\">2.2 Create edgeR grouping\n    vector</a>\n- <a href=\"#3-degs\" id=\"toc-3-degs\">3 DEGs</a>\n  - <a href=\"#31-load-count-matrix\" id=\"toc-31-load-count-matrix\">3.1 Load\n    count matrix</a>\n    - <a href=\"#311-reformat-header\" id=\"toc-311-reformat-header\">3.1.1\n      Reformat header</a>\n    - <a href=\"#312-convert-to-matrix\" id=\"toc-312-convert-to-matrix\">3.1.2\n      Convert to matrix</a>\n    - <a href=\"#313-load-matrix-into-edger\"\n      id=\"toc-313-load-matrix-into-edger\">3.1.3 Load matrix into edgeR</a>\n    - <a href=\"#314-filter-low-counts\" id=\"toc-314-filter-low-counts\">3.1.4\n      Filter low counts</a>\n    - <a href=\"#315-normalization\" id=\"toc-315-normalization\">3.1.5\n      Normalization</a>\n    - <a href=\"#316-model-fitting-and-estimating-dispersions\"\n      id=\"toc-316-model-fitting-and-estimating-dispersions\">3.1.6 Model\n      fitting and estimating dispersions</a>\n    - <a href=\"#317-exact-test-gene-expression\"\n      id=\"toc-317-exact-test-gene-expression\">3.1.7 Exact test (Gene\n      expression)</a>\n    - <a href=\"#318-differential-gene-expression-summary\"\n      id=\"toc-318-differential-gene-expression-summary\">3.1.8 Differential\n      gene expression summary</a>\n    - <a href=\"#319-peek-at-degs\" id=\"toc-319-peek-at-degs\">3.1.9 Peek at\n      DEGs</a>\n    - <a href=\"#3110-convert-gene-id-rownames-to-column\"\n      id=\"toc-3110-convert-gene-id-rownames-to-column\">3.1.10 Convert gene ID\n      rownames to column</a>\n    - <a href=\"#3111-write-degs-to-file\"\n      id=\"toc-3111-write-degs-to-file\">3.1.11 Write DEGs to file</a>\n    - <a href=\"#3112-volcano-plot\" id=\"toc-3112-volcano-plot\">3.1.12 Volcano\n      plot</a>\n- <a href=\"#4-citations\" id=\"toc-4-citations\">4 CITATIONS</a>\n\nDifferential gene expression of 9<sup>o</sup>C vs 16<sup>o</sup>C liver\nRNA-seq using\n[edgeR](https://bioconductor.org/packages/release/bioc/vignettes/edgeR/inst/doc/edgeRUsersGuide.pdf)\n([Chen et al. 2024](#ref-chen2024); [McCarthy, Chen, and Smyth\n2012](#ref-mccarthy2012); [Chen, Lun, and Smyth 2016](#ref-chen2016);\n[Robinson, McCarthy, and Smyth 2009](#ref-robinson2009))\n\n::: {.callout-note}\nCopied from [13.0.0-RNAseq-edgeR.md](https://github.com/RobertsLab/project-cod-temperature/blob/d5f8a5c4a89613928ef57431e9454464ca0a6826/code/13.0.0-RNAseq-edgeR.md), commit `f5fa415`.\n:::\n\n# 1 CREATE OUTPUT DIRECTORY\n\n``` bash\n# Make output directory, if it doesn't exist\nmkdir --parents ../output/13.0.0-RNAseq-edgeR\n```\n\n# 2 edgeR GROUPING VECTOR\n\n## 2.1 Check sample info\n\nOnly looking at 9<sup>o</sup>C and 16<sup>o</sup>C\n\n``` bash\necho \"Header for ../data/DESeq2_Sample_Information.csv:\"\necho \"\"\n\nhead -n 1 ../data/DESeq2_Sample_Information.csv\n\necho \"\"\necho \"---------------------------------------------\"\necho \"\"\nawk -F\",\" 'NR==1 {header=$2 \" \" $4; print header; next} $4 == 16 || $4 == 9 {print $2, $4}' ../data/DESeq2_Sample_Information.csv \\\n| sort -k1,1 -n \\\n| column -t\n```\n\n    Header for ../data/DESeq2_Sample_Information.csv:\n\n    sample_name,sample_number,tank,temp_treatment,tissue_type\n\n    ---------------------------------------------\n\n    sample_number  temp_treatment\n    1              16\n    2              16\n    3              16\n    4              16\n    5              16\n    10             16\n    11             16\n    12             16\n    13             16\n    18             16\n    19             16\n    19             16\n    19             16\n    20             16\n    20             16\n    20             16\n    21             16\n    28             16\n    29             16\n    30             16\n    31             16\n    36             16\n    78             9\n    79             9\n    80             9\n    83             9\n    88             9\n    90             9\n    91             9\n    92             9\n    94             9\n    97             9\n    98             9\n    99             9\n    100            9\n    107            9\n    108            9\n    109            9\n    110            9\n    116            9\n\n## 2.2 Create edgeR grouping vector\n\nSince all sample IDs `<=` to `36` are part of the 16<sup>o</sup>C\ntreatment, we can use this to create vector which matches sample\nordering in `../output/10.1-hisat-deseq2/gene_count_matrix.csv`\n\n``` r\n# Read the first line of the CSV file\nheader <- readLines(\"../output/10.1-hisat-deseq2/gene_count_matrix.csv\", n = 1)\n\n# Split the header to extract the values\nvalues <- as.numeric(unlist(strsplit(header, \",\"))[-1]) # Remove the first element which is \"gene_id\"\n\n# Apply the conditional logic to generate the temperatures vector\ntemperatures <- ifelse(values <= 36, \"16C\", \"9C\")\n\n# Print the resulting vector\nprint(temperatures)\n```\n\n     [1] \"16C\" \"16C\" \"9C\"  \"9C\"  \"9C\"  \"9C\"  \"16C\" \"9C\"  \"9C\"  \"16C\" \"16C\" \"16C\"\n    [13] \"16C\" \"16C\" \"16C\" \"16C\" \"16C\" \"16C\" \"16C\" \"16C\" \"16C\" \"16C\" \"16C\" \"16C\"\n    [25] \"9C\"  \"9C\"  \"9C\"  \"9C\"  \"9C\"  \"9C\"  \"9C\"  \"9C\"  \"9C\"  \"9C\"  \"9C\"  \"9C\" \n\n# 3 DEGs\n\n## 3.1 Load count matrix\n\n### 3.1.1 Reformat header\n\n``` r\n# Read the entire CSV file\ncsv_file <- readLines(\"../output/10.1-hisat-deseq2/gene_count_matrix.csv\")\n\n# Extract the header line\nheader <- csv_file[1]\n\n# Split the header to extract the values\nheader_values <- unlist(strsplit(header, \",\"))\n\n# Prepend 'sample_' to each value (excluding 'gene_id')\nheader_values[-1] <- paste0(\"sample_\", header_values[-1])\n\n# Combine the modified header back into a single string\nmodified_header <- paste(header_values, collapse = \",\")\n\n# Replace the old header with the new modified header in the CSV content\ncsv_file[1] <- modified_header\n\n# Convert the modified CSV content to a data frame\ncsv_content <- read.csv(textConnection(csv_file), row.names = 1)\n\nstr(csv_content)\n```\n\n    'data.frame':   30575 obs. of  36 variables:\n     $ sample_1  : int  360 694 0 10 0 0 0 402 3696 335 ...\n     $ sample_10 : int  464 325 10 22 9 40 3 550 2492 171 ...\n     $ sample_100: int  391 276 13 15 0 40 0 293 2615 149 ...\n     $ sample_107: int  346 77 11 19 0 29 0 182 2184 99 ...\n     $ sample_108: int  691 409 49 74 18 8 41 1082 2702 241 ...\n     $ sample_109: int  408 196 42 28 0 0 7 213 2579 149 ...\n     $ sample_11 : int  436 281 14 63 0 38 4 234 3631 286 ...\n     $ sample_110: int  509 284 36 35 0 0 0 149 3158 139 ...\n     $ sample_116: int  366 327 0 30 0 16 3 444 2121 100 ...\n     $ sample_12 : int  373 310 14 31 27 15 0 360 2673 168 ...\n     $ sample_13 : int  432 393 9 25 0 0 0 531 2893 267 ...\n     $ sample_18 : int  385 386 0 42 0 0 0 242 2210 205 ...\n     $ sample_19 : int  330 106 0 17 0 0 27 269 2324 139 ...\n     $ sample_2  : int  288 290 14 14 0 0 0 194 2384 201 ...\n     $ sample_20 : int  307 252 3 21 0 22 0 359 2561 123 ...\n     $ sample_21 : int  346 326 21 60 0 22 0 383 2654 215 ...\n     $ sample_28 : int  293 345 26 61 0 69 0 395 2887 157 ...\n     $ sample_29 : int  347 254 9 14 0 22 4 392 2250 101 ...\n     $ sample_3  : int  452 363 39 29 4 0 0 408 3143 222 ...\n     $ sample_30 : int  452 353 20 37 35 15 10 489 2830 183 ...\n     $ sample_31 : int  984 922 10 68 0 0 0 310 1297 270 ...\n     $ sample_36 : int  230 160 0 37 0 34 23 352 1981 93 ...\n     $ sample_4  : int  469 588 0 0 0 55 0 168 2971 290 ...\n     $ sample_5  : int  400 285 10 30 4 51 0 403 2651 225 ...\n     $ sample_78 : int  472 178 48 10 0 0 0 462 2669 195 ...\n     $ sample_79 : int  311 119 41 13 0 30 0 287 2671 182 ...\n     $ sample_80 : int  368 197 60 56 0 19 4 310 1790 123 ...\n     $ sample_83 : int  312 134 39 32 0 31 4 113 2173 162 ...\n     $ sample_88 : int  551 128 49 45 8 0 0 457 2603 179 ...\n     $ sample_90 : int  631 103 54 55 32 0 0 321 3260 177 ...\n     $ sample_91 : int  605 315 20 27 0 42 4 396 2186 130 ...\n     $ sample_92 : int  366 204 27 38 0 34 0 234 2451 134 ...\n     $ sample_94 : int  339 301 7 60 14 0 0 455 2464 153 ...\n     $ sample_97 : int  517 56 22 25 0 0 22 279 2768 189 ...\n     $ sample_98 : int  577 49 63 18 0 26 101 229 1935 282 ...\n     $ sample_99 : int  235 260 12 50 0 56 0 208 1991 138 ...\n\n### 3.1.2 Convert to matrix\n\n``` r\n# Convert the data frame to a matrix\ngene_count_matrix <- as.matrix(csv_content)\n\n# Print the matrix\nprint(head(gene_count_matrix))\n```\n\n                                       sample_1 sample_10 sample_100 sample_107\n    gene-LOC132462341|LOC132462341          360       464        391        346\n    gene-abce1|abce1                        694       325        276         77\n    gene-si:dkey-6i22.5|si:dkey-6i22.5        0        10         13         11\n    gene-ube2v1|ube2v1                       10        22         15         19\n    gene-cldn15la|cldn15la                    0         9          0          0\n    gene-muc15|muc15                          0        40         40         29\n                                       sample_108 sample_109 sample_11 sample_110\n    gene-LOC132462341|LOC132462341            691        408       436        509\n    gene-abce1|abce1                          409        196       281        284\n    gene-si:dkey-6i22.5|si:dkey-6i22.5         49         42        14         36\n    gene-ube2v1|ube2v1                         74         28        63         35\n    gene-cldn15la|cldn15la                     18          0         0          0\n    gene-muc15|muc15                            8          0        38          0\n                                       sample_116 sample_12 sample_13 sample_18\n    gene-LOC132462341|LOC132462341            366       373       432       385\n    gene-abce1|abce1                          327       310       393       386\n    gene-si:dkey-6i22.5|si:dkey-6i22.5          0        14         9         0\n    gene-ube2v1|ube2v1                         30        31        25        42\n    gene-cldn15la|cldn15la                      0        27         0         0\n    gene-muc15|muc15                           16        15         0         0\n                                       sample_19 sample_2 sample_20 sample_21\n    gene-LOC132462341|LOC132462341           330      288       307       346\n    gene-abce1|abce1                         106      290       252       326\n    gene-si:dkey-6i22.5|si:dkey-6i22.5         0       14         3        21\n    gene-ube2v1|ube2v1                        17       14        21        60\n    gene-cldn15la|cldn15la                     0        0         0         0\n    gene-muc15|muc15                           0        0        22        22\n                                       sample_28 sample_29 sample_3 sample_30\n    gene-LOC132462341|LOC132462341           293       347      452       452\n    gene-abce1|abce1                         345       254      363       353\n    gene-si:dkey-6i22.5|si:dkey-6i22.5        26         9       39        20\n    gene-ube2v1|ube2v1                        61        14       29        37\n    gene-cldn15la|cldn15la                     0         0        4        35\n    gene-muc15|muc15                          69        22        0        15\n                                       sample_31 sample_36 sample_4 sample_5\n    gene-LOC132462341|LOC132462341           984       230      469      400\n    gene-abce1|abce1                         922       160      588      285\n    gene-si:dkey-6i22.5|si:dkey-6i22.5        10         0        0       10\n    gene-ube2v1|ube2v1                        68        37        0       30\n    gene-cldn15la|cldn15la                     0         0        0        4\n    gene-muc15|muc15                           0        34       55       51\n                                       sample_78 sample_79 sample_80 sample_83\n    gene-LOC132462341|LOC132462341           472       311       368       312\n    gene-abce1|abce1                         178       119       197       134\n    gene-si:dkey-6i22.5|si:dkey-6i22.5        48        41        60        39\n    gene-ube2v1|ube2v1                        10        13        56        32\n    gene-cldn15la|cldn15la                     0         0         0         0\n    gene-muc15|muc15                           0        30        19        31\n                                       sample_88 sample_90 sample_91 sample_92\n    gene-LOC132462341|LOC132462341           551       631       605       366\n    gene-abce1|abce1                         128       103       315       204\n    gene-si:dkey-6i22.5|si:dkey-6i22.5        49        54        20        27\n    gene-ube2v1|ube2v1                        45        55        27        38\n    gene-cldn15la|cldn15la                     8        32         0         0\n    gene-muc15|muc15                           0         0        42        34\n                                       sample_94 sample_97 sample_98 sample_99\n    gene-LOC132462341|LOC132462341           339       517       577       235\n    gene-abce1|abce1                         301        56        49       260\n    gene-si:dkey-6i22.5|si:dkey-6i22.5         7        22        63        12\n    gene-ube2v1|ube2v1                        60        25        18        50\n    gene-cldn15la|cldn15la                    14         0         0         0\n    gene-muc15|muc15                           0         0        26        56\n\n### 3.1.3 Load matrix into edgeR\n\n``` r\ndge <- DGEList(counts = gene_count_matrix, group = factor(temperatures))\n\ndge\n```\n\n    An object of class \"DGEList\"\n    $counts\n                                       sample_1 sample_10 sample_100 sample_107\n    gene-LOC132462341|LOC132462341          360       464        391        346\n    gene-abce1|abce1                        694       325        276         77\n    gene-si:dkey-6i22.5|si:dkey-6i22.5        0        10         13         11\n    gene-ube2v1|ube2v1                       10        22         15         19\n    gene-cldn15la|cldn15la                    0         9          0          0\n                                       sample_108 sample_109 sample_11 sample_110\n    gene-LOC132462341|LOC132462341            691        408       436        509\n    gene-abce1|abce1                          409        196       281        284\n    gene-si:dkey-6i22.5|si:dkey-6i22.5         49         42        14         36\n    gene-ube2v1|ube2v1                         74         28        63         35\n    gene-cldn15la|cldn15la                     18          0         0          0\n                                       sample_116 sample_12 sample_13 sample_18\n    gene-LOC132462341|LOC132462341            366       373       432       385\n    gene-abce1|abce1                          327       310       393       386\n    gene-si:dkey-6i22.5|si:dkey-6i22.5          0        14         9         0\n    gene-ube2v1|ube2v1                         30        31        25        42\n    gene-cldn15la|cldn15la                      0        27         0         0\n                                       sample_19 sample_2 sample_20 sample_21\n    gene-LOC132462341|LOC132462341           330      288       307       346\n    gene-abce1|abce1                         106      290       252       326\n    gene-si:dkey-6i22.5|si:dkey-6i22.5         0       14         3        21\n    gene-ube2v1|ube2v1                        17       14        21        60\n    gene-cldn15la|cldn15la                     0        0         0         0\n                                       sample_28 sample_29 sample_3 sample_30\n    gene-LOC132462341|LOC132462341           293       347      452       452\n    gene-abce1|abce1                         345       254      363       353\n    gene-si:dkey-6i22.5|si:dkey-6i22.5        26         9       39        20\n    gene-ube2v1|ube2v1                        61        14       29        37\n    gene-cldn15la|cldn15la                     0         0        4        35\n                                       sample_31 sample_36 sample_4 sample_5\n    gene-LOC132462341|LOC132462341           984       230      469      400\n    gene-abce1|abce1                         922       160      588      285\n    gene-si:dkey-6i22.5|si:dkey-6i22.5        10         0        0       10\n    gene-ube2v1|ube2v1                        68        37        0       30\n    gene-cldn15la|cldn15la                     0         0        0        4\n                                       sample_78 sample_79 sample_80 sample_83\n    gene-LOC132462341|LOC132462341           472       311       368       312\n    gene-abce1|abce1                         178       119       197       134\n    gene-si:dkey-6i22.5|si:dkey-6i22.5        48        41        60        39\n    gene-ube2v1|ube2v1                        10        13        56        32\n    gene-cldn15la|cldn15la                     0         0         0         0\n                                       sample_88 sample_90 sample_91 sample_92\n    gene-LOC132462341|LOC132462341           551       631       605       366\n    gene-abce1|abce1                         128       103       315       204\n    gene-si:dkey-6i22.5|si:dkey-6i22.5        49        54        20        27\n    gene-ube2v1|ube2v1                        45        55        27        38\n    gene-cldn15la|cldn15la                     8        32         0         0\n                                       sample_94 sample_97 sample_98 sample_99\n    gene-LOC132462341|LOC132462341           339       517       577       235\n    gene-abce1|abce1                         301        56        49       260\n    gene-si:dkey-6i22.5|si:dkey-6i22.5         7        22        63        12\n    gene-ube2v1|ube2v1                        60        25        18        50\n    gene-cldn15la|cldn15la                    14         0         0         0\n    30570 more rows ...\n\n    $samples\n               group lib.size norm.factors\n    sample_1     16C 49994893            1\n    sample_10    16C 43506227            1\n    sample_100    9C 44600544            1\n    sample_107    9C 41991971            1\n    sample_108    9C 47412580            1\n    31 more rows ...\n\n### 3.1.4 Filter low counts\n\nFilters for genes with at \\>= `10` reads across at least 3 samples.\n\n``` r\nkeep <- filterByExpr(dge)\n\ndge <- dge[keep, , keep.lib.sizes=FALSE]\n\ndge\n```\n\n    An object of class \"DGEList\"\n    $counts\n                                       sample_1 sample_10 sample_100 sample_107\n    gene-LOC132462341|LOC132462341          360       464        391        346\n    gene-abce1|abce1                        694       325        276         77\n    gene-si:dkey-6i22.5|si:dkey-6i22.5        0        10         13         11\n    gene-ube2v1|ube2v1                       10        22         15         19\n    gene-muc15|muc15                          0        40         40         29\n                                       sample_108 sample_109 sample_11 sample_110\n    gene-LOC132462341|LOC132462341            691        408       436        509\n    gene-abce1|abce1                          409        196       281        284\n    gene-si:dkey-6i22.5|si:dkey-6i22.5         49         42        14         36\n    gene-ube2v1|ube2v1                         74         28        63         35\n    gene-muc15|muc15                            8          0        38          0\n                                       sample_116 sample_12 sample_13 sample_18\n    gene-LOC132462341|LOC132462341            366       373       432       385\n    gene-abce1|abce1                          327       310       393       386\n    gene-si:dkey-6i22.5|si:dkey-6i22.5          0        14         9         0\n    gene-ube2v1|ube2v1                         30        31        25        42\n    gene-muc15|muc15                           16        15         0         0\n                                       sample_19 sample_2 sample_20 sample_21\n    gene-LOC132462341|LOC132462341           330      288       307       346\n    gene-abce1|abce1                         106      290       252       326\n    gene-si:dkey-6i22.5|si:dkey-6i22.5         0       14         3        21\n    gene-ube2v1|ube2v1                        17       14        21        60\n    gene-muc15|muc15                           0        0        22        22\n                                       sample_28 sample_29 sample_3 sample_30\n    gene-LOC132462341|LOC132462341           293       347      452       452\n    gene-abce1|abce1                         345       254      363       353\n    gene-si:dkey-6i22.5|si:dkey-6i22.5        26         9       39        20\n    gene-ube2v1|ube2v1                        61        14       29        37\n    gene-muc15|muc15                          69        22        0        15\n                                       sample_31 sample_36 sample_4 sample_5\n    gene-LOC132462341|LOC132462341           984       230      469      400\n    gene-abce1|abce1                         922       160      588      285\n    gene-si:dkey-6i22.5|si:dkey-6i22.5        10         0        0       10\n    gene-ube2v1|ube2v1                        68        37        0       30\n    gene-muc15|muc15                           0        34       55       51\n                                       sample_78 sample_79 sample_80 sample_83\n    gene-LOC132462341|LOC132462341           472       311       368       312\n    gene-abce1|abce1                         178       119       197       134\n    gene-si:dkey-6i22.5|si:dkey-6i22.5        48        41        60        39\n    gene-ube2v1|ube2v1                        10        13        56        32\n    gene-muc15|muc15                           0        30        19        31\n                                       sample_88 sample_90 sample_91 sample_92\n    gene-LOC132462341|LOC132462341           551       631       605       366\n    gene-abce1|abce1                         128       103       315       204\n    gene-si:dkey-6i22.5|si:dkey-6i22.5        49        54        20        27\n    gene-ube2v1|ube2v1                        45        55        27        38\n    gene-muc15|muc15                           0         0        42        34\n                                       sample_94 sample_97 sample_98 sample_99\n    gene-LOC132462341|LOC132462341           339       517       577       235\n    gene-abce1|abce1                         301        56        49       260\n    gene-si:dkey-6i22.5|si:dkey-6i22.5         7        22        63        12\n    gene-ube2v1|ube2v1                        60        25        18        50\n    gene-muc15|muc15                           0         0        26        56\n    16688 more rows ...\n\n    $samples\n               group lib.size norm.factors\n    sample_1     16C 49973355            1\n    sample_10    16C 43459343            1\n    sample_100    9C 44577844            1\n    sample_107    9C 41972179            1\n    sample_108    9C 47313070            1\n    31 more rows ...\n\n### 3.1.5 Normalization\n\n``` r\ndge <- calcNormFactors(object = dge)\n\ndge\n```\n\n    An object of class \"DGEList\"\n    $counts\n                                       sample_1 sample_10 sample_100 sample_107\n    gene-LOC132462341|LOC132462341          360       464        391        346\n    gene-abce1|abce1                        694       325        276         77\n    gene-si:dkey-6i22.5|si:dkey-6i22.5        0        10         13         11\n    gene-ube2v1|ube2v1                       10        22         15         19\n    gene-muc15|muc15                          0        40         40         29\n                                       sample_108 sample_109 sample_11 sample_110\n    gene-LOC132462341|LOC132462341            691        408       436        509\n    gene-abce1|abce1                          409        196       281        284\n    gene-si:dkey-6i22.5|si:dkey-6i22.5         49         42        14         36\n    gene-ube2v1|ube2v1                         74         28        63         35\n    gene-muc15|muc15                            8          0        38          0\n                                       sample_116 sample_12 sample_13 sample_18\n    gene-LOC132462341|LOC132462341            366       373       432       385\n    gene-abce1|abce1                          327       310       393       386\n    gene-si:dkey-6i22.5|si:dkey-6i22.5          0        14         9         0\n    gene-ube2v1|ube2v1                         30        31        25        42\n    gene-muc15|muc15                           16        15         0         0\n                                       sample_19 sample_2 sample_20 sample_21\n    gene-LOC132462341|LOC132462341           330      288       307       346\n    gene-abce1|abce1                         106      290       252       326\n    gene-si:dkey-6i22.5|si:dkey-6i22.5         0       14         3        21\n    gene-ube2v1|ube2v1                        17       14        21        60\n    gene-muc15|muc15                           0        0        22        22\n                                       sample_28 sample_29 sample_3 sample_30\n    gene-LOC132462341|LOC132462341           293       347      452       452\n    gene-abce1|abce1                         345       254      363       353\n    gene-si:dkey-6i22.5|si:dkey-6i22.5        26         9       39        20\n    gene-ube2v1|ube2v1                        61        14       29        37\n    gene-muc15|muc15                          69        22        0        15\n                                       sample_31 sample_36 sample_4 sample_5\n    gene-LOC132462341|LOC132462341           984       230      469      400\n    gene-abce1|abce1                         922       160      588      285\n    gene-si:dkey-6i22.5|si:dkey-6i22.5        10         0        0       10\n    gene-ube2v1|ube2v1                        68        37        0       30\n    gene-muc15|muc15                           0        34       55       51\n                                       sample_78 sample_79 sample_80 sample_83\n    gene-LOC132462341|LOC132462341           472       311       368       312\n    gene-abce1|abce1                         178       119       197       134\n    gene-si:dkey-6i22.5|si:dkey-6i22.5        48        41        60        39\n    gene-ube2v1|ube2v1                        10        13        56        32\n    gene-muc15|muc15                           0        30        19        31\n                                       sample_88 sample_90 sample_91 sample_92\n    gene-LOC132462341|LOC132462341           551       631       605       366\n    gene-abce1|abce1                         128       103       315       204\n    gene-si:dkey-6i22.5|si:dkey-6i22.5        49        54        20        27\n    gene-ube2v1|ube2v1                        45        55        27        38\n    gene-muc15|muc15                           0         0        42        34\n                                       sample_94 sample_97 sample_98 sample_99\n    gene-LOC132462341|LOC132462341           339       517       577       235\n    gene-abce1|abce1                         301        56        49       260\n    gene-si:dkey-6i22.5|si:dkey-6i22.5         7        22        63        12\n    gene-ube2v1|ube2v1                        60        25        18        50\n    gene-muc15|muc15                           0         0        26        56\n    16688 more rows ...\n\n    $samples\n               group lib.size norm.factors\n    sample_1     16C 49973355    1.0828322\n    sample_10    16C 43459343    1.3481915\n    sample_100    9C 44577844    0.9792758\n    sample_107    9C 41972179    0.7062689\n    sample_108    9C 47313070    1.5247621\n    31 more rows ...\n\n### 3.1.6 Model fitting and estimating dispersions\n\n``` r\ndge <- estimateDisp(dge)\n\ndge\n```\n\n    An object of class \"DGEList\"\n    $counts\n                                       sample_1 sample_10 sample_100 sample_107\n    gene-LOC132462341|LOC132462341          360       464        391        346\n    gene-abce1|abce1                        694       325        276         77\n    gene-si:dkey-6i22.5|si:dkey-6i22.5        0        10         13         11\n    gene-ube2v1|ube2v1                       10        22         15         19\n    gene-muc15|muc15                          0        40         40         29\n                                       sample_108 sample_109 sample_11 sample_110\n    gene-LOC132462341|LOC132462341            691        408       436        509\n    gene-abce1|abce1                          409        196       281        284\n    gene-si:dkey-6i22.5|si:dkey-6i22.5         49         42        14         36\n    gene-ube2v1|ube2v1                         74         28        63         35\n    gene-muc15|muc15                            8          0        38          0\n                                       sample_116 sample_12 sample_13 sample_18\n    gene-LOC132462341|LOC132462341            366       373       432       385\n    gene-abce1|abce1                          327       310       393       386\n    gene-si:dkey-6i22.5|si:dkey-6i22.5          0        14         9         0\n    gene-ube2v1|ube2v1                         30        31        25        42\n    gene-muc15|muc15                           16        15         0         0\n                                       sample_19 sample_2 sample_20 sample_21\n    gene-LOC132462341|LOC132462341           330      288       307       346\n    gene-abce1|abce1                         106      290       252       326\n    gene-si:dkey-6i22.5|si:dkey-6i22.5         0       14         3        21\n    gene-ube2v1|ube2v1                        17       14        21        60\n    gene-muc15|muc15                           0        0        22        22\n                                       sample_28 sample_29 sample_3 sample_30\n    gene-LOC132462341|LOC132462341           293       347      452       452\n    gene-abce1|abce1                         345       254      363       353\n    gene-si:dkey-6i22.5|si:dkey-6i22.5        26         9       39        20\n    gene-ube2v1|ube2v1                        61        14       29        37\n    gene-muc15|muc15                          69        22        0        15\n                                       sample_31 sample_36 sample_4 sample_5\n    gene-LOC132462341|LOC132462341           984       230      469      400\n    gene-abce1|abce1                         922       160      588      285\n    gene-si:dkey-6i22.5|si:dkey-6i22.5        10         0        0       10\n    gene-ube2v1|ube2v1                        68        37        0       30\n    gene-muc15|muc15                           0        34       55       51\n                                       sample_78 sample_79 sample_80 sample_83\n    gene-LOC132462341|LOC132462341           472       311       368       312\n    gene-abce1|abce1                         178       119       197       134\n    gene-si:dkey-6i22.5|si:dkey-6i22.5        48        41        60        39\n    gene-ube2v1|ube2v1                        10        13        56        32\n    gene-muc15|muc15                           0        30        19        31\n                                       sample_88 sample_90 sample_91 sample_92\n    gene-LOC132462341|LOC132462341           551       631       605       366\n    gene-abce1|abce1                         128       103       315       204\n    gene-si:dkey-6i22.5|si:dkey-6i22.5        49        54        20        27\n    gene-ube2v1|ube2v1                        45        55        27        38\n    gene-muc15|muc15                           0         0        42        34\n                                       sample_94 sample_97 sample_98 sample_99\n    gene-LOC132462341|LOC132462341           339       517       577       235\n    gene-abce1|abce1                         301        56        49       260\n    gene-si:dkey-6i22.5|si:dkey-6i22.5         7        22        63        12\n    gene-ube2v1|ube2v1                        60        25        18        50\n    gene-muc15|muc15                           0         0        26        56\n    16688 more rows ...\n\n    $samples\n               group lib.size norm.factors\n    sample_1     16C 49973355    1.0828322\n    sample_10    16C 43459343    1.3481915\n    sample_100    9C 44577844    0.9792758\n    sample_107    9C 41972179    0.7062689\n    sample_108    9C 47313070    1.5247621\n    31 more rows ...\n\n    $common.dispersion\n    [1] 0.3258355\n\n    $trended.dispersion\n    [1] 0.1792662 0.2158552 0.8880326 0.7699354 0.9217978\n    16688 more elements ...\n\n    $tagwise.dispersion\n    [1] 0.1017614 0.1666824 0.9805648 0.3988847 2.8340881\n    16688 more elements ...\n\n    $AveLogCPM\n    [1]  3.3189831  2.6344211 -0.7839951 -0.2807668 -0.9718511\n    16688 more elements ...\n\n    $trend.method\n    [1] \"locfit\"\n\n    $prior.df\n    [1] 4.732584\n\n    $prior.n\n    [1] 0.1391936\n\n    $span\n    [1] 0.2910468\n\n### 3.1.7 Exact test (Gene expression)\n\n``` r\nexact_test_genes <- exactTest(dge)\n\nexact_test_genes\n```\n\n    An object of class \"DGEExact\"\n    $table\n                                            logFC     logCPM       PValue\n    gene-LOC132462341|LOC132462341      0.3690768  3.3189831 0.0174459833\n    gene-abce1|abce1                   -0.7406649  2.6344211 0.0002052135\n    gene-si:dkey-6i22.5|si:dkey-6i22.5  1.8787265 -0.7839951 0.0001945058\n    gene-ube2v1|ube2v1                  0.2838600 -0.2807668 0.3721151448\n    gene-muc15|muc15                    0.0123765 -0.9718511 0.9923746564\n    16688 more rows ...\n\n    $comparison\n    [1] \"16C\" \"9C\" \n\n    $genes\n    NULL\n\n### 3.1.8 Differential gene expression summary\n\n``` r\nsummary(decideTests(object = exact_test_genes, p.value = 0.05))\n```\n\n           9C-16C\n    Down     2071\n    NotSig  11980\n    Up       2642\n\n### 3.1.9 Peek at DEGs\n\nSelects all genes (`n = \"Inf\"`) with adjusted p-value `< 0.05`, sorts by\nfalse discovery rate (`adjust.method = \"fdr\"`).\n\nConverts object to a data frame (the `$table` part).\n\n``` r\ntop_degs_table <-  topTags(object = exact_test_genes, n = \"Inf\", adjust.method = \"fdr\", p.value = 0.05)$table\n\nstr(top_degs_table)\n```\n\n    'data.frame':   16693 obs. of  4 variables:\n     $ logFC : num  1.9 -2.59 -1.45 -3.13 1.87 ...\n     $ logCPM: num  6.59 4.06 4.93 3.18 5.57 ...\n     $ PValue: num  1.26e-64 5.31e-37 2.15e-30 1.48e-26 4.65e-25 ...\n     $ FDR   : num  2.10e-60 4.43e-33 1.19e-26 6.18e-23 1.43e-21 ...\n\n### 3.1.10 Convert gene ID rownames to column\n\n``` r\n# Step 1: Extract row names and create a new column 'gene_ids'\ntop_degs_table$gene_ids <- rownames(top_degs_table)\n\n# Step 2: Reorder columns to make 'gene_ids' the first column\ntop_degs_table <- top_degs_table[, c(\"gene_ids\", names(top_degs_table)[-length(names(top_degs_table))])]\n\n# Step 3: Check the result\nhead(top_degs_table)\n```\n\n                                                         gene_ids     logFC\n    gene-LOC132469840|LOC132469840 gene-LOC132469840|LOC132469840  1.897837\n    gene-serpinh1b|serpinh1b             gene-serpinh1b|serpinh1b -2.589704\n    gene-znf706|znf706                         gene-znf706|znf706 -1.450400\n    gene-hacd4|hacd4                             gene-hacd4|hacd4 -3.133038\n    gene-LOC132448390|LOC132448390 gene-LOC132448390|LOC132448390  1.874161\n    gene-zgc:103586|zgc:103586         gene-zgc:103586|zgc:103586  1.584728\n                                     logCPM       PValue          FDR\n    gene-LOC132469840|LOC132469840 6.594858 1.259480e-64 2.102450e-60\n    gene-serpinh1b|serpinh1b       4.063945 5.307949e-37 4.430280e-33\n    gene-znf706|znf706             4.929053 2.146565e-30 1.194420e-26\n    gene-hacd4|hacd4               3.179135 1.480134e-26 6.176968e-23\n    gene-LOC132448390|LOC132448390 5.570204 4.647165e-25 1.434822e-21\n    gene-zgc:103586|zgc:103586     5.356047 5.157212e-25 1.434822e-21\n\n### 3.1.11 Write DEGs to file\n\n``` r\n# Write dataframe to CSV\nwrite.csv(\n  top_degs_table, \n  file = \"../output/13.0.0-RNAseq-edgeR/DEGs_9C-vs-16C-p-0.05.csv\", \n  quote = FALSE, \n  row.names = FALSE)\n```\n\n### 3.1.12 Volcano plot\n\n``` r\nghibli_colors <- ghibli_palette(\"PonyoMedium\", type = \"discrete\")\n\nghibli_subset <- c(ghibli_colors[3], ghibli_colors[6], ghibli_colors[4])\n\n# Create new column and fill with `NA`\ntop_degs_table$topDE <- \"NA\"\n\n# Set value of \"Up\" for genes with FC > 1 and FDR < 0.05\ntop_degs_table$topDE[top_degs_table$logFC > 1 & top_degs_table$FDR < 0.05] <- \"Up\"\n\n# Set value of \"Down\" for genes with FC < -1 and FDR < 0.05\ntop_degs_table$topDE[top_degs_table$logFC < -1 & top_degs_table$FDR < 0.05] <- \"Down\"\n\nggplot(data=top_degs_table, aes(x=logFC, y=-log10(FDR), color = topDE)) + \n  geom_point() +\n  theme_minimal() +\n  scale_colour_discrete(type = ghibli_subset, breaks = c(\"Up\", \"Down\"))\n```\n\n![Volcano plost of differentialy expressed genes. More highly expressed in 9C are red, while those more highly expressed in 16C are blue. Both groups are > 1 fold log change and < -1 log fold change, respectively. Mustard yellow dots represent differentially expressed genes between -1 and 1 fold log change.](13.0.0-RNAseq-edgeR_files/figure-gfm/plot-volcano-degs-1.png)<!-- -->\n\n# 4 CITATIONS\n\n<div id=\"refs\" class=\"references csl-bib-body hanging-indent\">\n\n<div id=\"ref-chen2024\" class=\"csl-entry\">\n\nChen, Yunshun, Lizhong Chen, Aaron T. L. Lun, Pedro L. Baldoni, and\nGordon K. Smyth. 2024. “edgeR 4.0: Powerful Differential Analysis of\nSequencing Data with Expanded Functionality and Improved Support for\nSmall Counts and Larger Datasets.”\n<http://dx.doi.org/10.1101/2024.01.21.576131>.\n\n</div>\n\n<div id=\"ref-chen2016\" class=\"csl-entry\">\n\nChen, Yunshun, Aaron T. L. Lun, and Gordon K. Smyth. 2016. “From Reads\nto Genes to Pathways: Differential Expression Analysis of RNA-Seq\nExperiments Using Rsubread and the edgeR Quasi-Likelihood Pipeline.”\n*F1000Research* 5 (August): 1438.\n<https://doi.org/10.12688/f1000research.8987.2>.\n\n</div>\n\n<div id=\"ref-mccarthy2012\" class=\"csl-entry\">\n\nMcCarthy, Davis J., Yunshun Chen, and Gordon K. Smyth. 2012.\n“Differential Expression Analysis of Multifactor RNA-Seq Experiments\nwith Respect to Biological Variation.” *Nucleic Acids Research* 40 (10):\n4288–97. <https://doi.org/10.1093/nar/gks042>.\n\n</div>\n\n<div id=\"ref-robinson2009\" class=\"csl-entry\">\n\nRobinson, Mark D., Davis J. McCarthy, and Gordon K. Smyth. 2009. “edgeR:\nA Bioconductor Package for Differential Expression Analysis of Digital\nGene Expression Data.” *Bioinformatics* 26 (1): 139–40.\n<https://doi.org/10.1093/bioinformatics/btp616>.\n\n</div>\n\n</div>\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}