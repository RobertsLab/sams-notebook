<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sam White">
<meta name="dcterms.date" content="2024-12-06">

<title>Trimming and Merging - R.philippinarum sRNA-seq Data Using fastp FastQC and MultiQC – Sam’s Notebook</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../..//images/favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark-d166b450ba5a8e9f7a0ab969bf6592c1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-d24cc6793ea89e8aa59926ce2f45f698.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": true,
  "collapse-after": 2,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 100,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-7483T61T11"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-7483T61T11', { 'anonymize_ip': true});
</script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Sam’s Notebook</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-hdd-network" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-hdd-network" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-hdd-network">    
        <li>
    <a class="dropdown-item" href="http://raven.fish.washington.edu:8787" target="_blank">
 <span class="dropdown-text">Rstudio Server - Raven</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://gannet.fish.washington.edu/Atumefaciens/" target="_blank">
 <span class="dropdown-text">My Gannet Directory</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-journal-code" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-journal-code" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-journal-code">    
        <li>
    <a class="dropdown-item" href="https://sr320.github.io" target="_blank">
 <span class="dropdown-text">Steven’s Notebook</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://shedurkin.github.io/Roberts-LabNotebook/" target="_blank">
 <span class="dropdown-text">Kathleen’s Notebook</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://meganewing.github.io/mewing-notebook/" target="_blank">
 <span class="dropdown-text">Megan’s Notebook</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-github" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-github">    
        <li>
    <a class="dropdown-item" href="https://github.com/RobertsLab/sams-notebook" target="_blank">
 <span class="dropdown-text">Notebook repo</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/RobertsLab" target="_blank">
 <span class="dropdown-text">Lab Organization (GitHub)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/RobertsLab/lab-website" target="_blank">
 <span class="dropdown-text">Edit Roberts Lab website</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://calendar.google.com/calendar/embed?src=mrc305@gmail.com&amp;ctz=America/Vancouver" target="_blank"> <i class="bi bi-calendar-week" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-right">
      <h1 class="title">Trimming and Merging - R.philippinarum sRNA-seq Data Using fastp FastQC and MultiQC</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">2024</div>
                <div class="quarto-category">Ruditapes philippinarum</div>
                <div class="quarto-category">Manila clam</div>
                <div class="quarto-category">project-clam-oa</div>
                <div class="quarto-category">sRNA-seq</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta column-page-right">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Sam White </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 6, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#intro" id="toc-intro" class="nav-link active" data-scroll-target="#intro">INTRO</a></li>
  <li><a href="#description" id="toc-description" class="nav-link" data-scroll-target="#description">1 Description</a>
  <ul>
  <li><a href="#inputs" id="toc-inputs" class="nav-link" data-scroll-target="#inputs">1.1 Inputs:</a></li>
  <li><a href="#outputs" id="toc-outputs" class="nav-link" data-scroll-target="#outputs">1.2 Outputs:</a></li>
  </ul></li>
  <li><a href="#create-a-bash-variables-file" id="toc-create-a-bash-variables-file" class="nav-link" data-scroll-target="#create-a-bash-variables-file">2 Create a Bash variables file</a></li>
  <li><a href="#create-adapters-fasta-for-use-with-fastp-trimming" id="toc-create-adapters-fasta-for-use-with-fastp-trimming" class="nav-link" data-scroll-target="#create-adapters-fasta-for-use-with-fastp-trimming">3 Create adapters FastA for use with <code>fastp</code> trimming</a></li>
  <li><a href="#trimming-and-merging-with-fastp" id="toc-trimming-and-merging-with-fastp" class="nav-link" data-scroll-target="#trimming-and-merging-with-fastp">4 Trimming and merging with fastp</a></li>
  <li><a href="#fastqcmultiqc-on-trimmed-reads" id="toc-fastqcmultiqc-on-trimmed-reads" class="nav-link" data-scroll-target="#fastqcmultiqc-on-trimmed-reads">5 FastQC/MultiQC on trimmed reads</a></li>
  <li><a href="#list-output-files" id="toc-list-output-files" class="nav-link" data-scroll-target="#list-output-files">6 List output files</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-right" id="quarto-document-content">





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>This notebook is part of <a href="https://github.com/RobertsLab/project-clam-oa/tree/main">project-clam-oa</a> (GitHub repo).</p>
<p>I previously performed concatenation of reads, and <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/"><code>FastQC</code></a> and <a href="https://multiqc.info/"><code>MultiQC</code></a> QC assessments of the sRNA-seq data received <a href="../../../posts/2024/2024-12-05-FastQ-Concatentation-and-QC---R.philippinarum-sRNA-seq-Data-Using-FastQC-and-MultiQC/index.html">previously, on 20241205</a> (Notebook entry).</p>
<p>Here, I needed to trim reads, as well as merge them. Since these are sRNA-seq data (meaning, the actual sequence length is short), having paired-end reads is of little value, However, we’ve previously decided we might as well as keep as much information as possible, instead of just simply discarding the R2 reads. So, we used <a href="https://github.com/OpenGene/fastp"><code>fastp</code></a> to trim and merge the reads.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This notebook is copied from knitted markdown from <a href="https://github.com/RobertsLab/project-clam-oa/blob/90e8bcd7d514966bdcd0ceb93c925fc44772cdb0/code/01.00-trimming-fastp-fastqc.Rmd"><code>01.00-trimming-fastp-fastqc.Rmd</code></a> (commit <code>90e8bcd</code>).</p>
</div>
</div>
</section>
<section id="description" class="level1">
<h1>1 Description</h1>
<p>This notebook will trim and merge R1 and R2 reads. The max length of 31bp is based on the <code>fastp</code> insert peak size from previous trimming tests based on the the adapter and polyG trimming results, and previous evaluation of mean read lengths via <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/"><code>FastQC</code></a> and <a href="https://multiqc.info/"><code>MultiQC</code></a>.</p>
<section id="inputs" class="level2">
<h2 class="anchored" data-anchor-id="inputs">1.1 Inputs:</h2>
<ul>
<li>sRNAseq paired-end FastQs (e.g.&nbsp;<code>*.fastq.gz</code>)</li>
</ul>
</section>
<section id="outputs" class="level2">
<h2 class="anchored" data-anchor-id="outputs">1.2 Outputs:</h2>
<ul>
<li><p><code>*.fastqc.html</code>: FastQC results, in HTML format.</p></li>
<li><p><code>*fastp-adapters-polyG-31bp-merged.fq.gz</code>: Trimmed and merged reads with final length of 31bp.</p></li>
<li><p><code>multiqc_report.html</code>: A summary report of the alignment results generated by <a href="https://github.com/MultiQC/MultiQC">MultiQC</a>, in HTML format.</p></li>
</ul>
<p>Libraries were prepared and sequenced by Azenta:</p>
<ul>
<li><p>Library prep: <a href="https://www.neb.com/en-us/-/media/nebus/files/manuals/manuale7300_e7330_e7560_e7580.pdf?rev=d0964a2e637843b1afcb9f7d666d07b2&amp;hash=7AC0B0EB012708EFAB0E4DBEEAF1446A">NEB nebnext-small-rna-library-prep-set-for-illumina kit</a> (PDF)</p></li>
<li><p>Sequencing: Illumina HiSeq 4000, 150bp PE</p></li>
</ul>
<p>Due to large file sizes of FastQs, they cannot be added to GitHub. Full output from this notebook are available here:</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/gitrepos/project-clam-oa/output/01.00-trimming-fastp-fastqc" class="uri">https://gannet.fish.washington.edu/gitrepos/project-clam-oa/output/01.00-trimming-fastp-fastqc</a></li>
</ul>
</section>
</section>
<section id="create-a-bash-variables-file" class="level1">
<h1>2 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"# Data directories"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">'export repo_dir=/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa'</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">'export output_dir_top=${repo_dir}/output/01.00-trimming-fastp-fastqc'</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">'export raw_reads_dir="${repo_dir}/output/00.00-fastqc-concatenation-raw_reads"'</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">'export trimmed_fastqs_dir="${output_dir_top}"'</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"# Paths to programs"</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">'export programs_dir="/home/shared"'</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">'export fastp="${programs_dir}/fastp-v0.24.0/fastp"'</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">'export fastqc="${programs_dir}/FastQC-0.12.1/fastqc"'</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">'export multiqc="/home/sam/programs/mambaforge/bin/multiqc"'</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"# Set FastQ filename patterns"</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"export fastq_pattern='*.fastq.gz'"</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"export R1_fastq_pattern='*_R1_*.fastq.gz'"</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"export R2_fastq_pattern='*_R2_*.fastq.gz'"</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"export trimmed_fastq_pattern='*fastp-trim*.fq.gz'"</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"# Input/output files"</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">'export fastq_checksums=input_fastq_checksums.md5'</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">'export NEB_adapters_fasta=NEB-adapters.fasta'</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"## NEB nebnext-small-rna-library-prep-set-for-illumina adapters"</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">'export first_adapter="AGATCGGAAGAGCACACGTCTGAACTCCAGTCAC"'</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">'export second_adapter="GATCGTCGGACTGTAGAACTCTGAACGTGTAGATCTCGGTGGTCGCCGTATCATT"'</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"# Set maximum read length for fastp merging"</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">'export max_read_length="31"'</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"# Set number of CPUs to use"</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">'export threads=40'</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"## Inititalize arrays"</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">'export fastq_array_R1=()'</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">'export fastq_array_R2=()'</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">'export trimmed_fastqs_array=()'</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">'export R1_names_array=()'</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">'export R2_names_array=()'</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"# Print formatting"</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span> <span class="op">&gt;</span> .bashvars</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> .bashvars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export repo_dir=/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa
export output_dir_top=${repo_dir}/output/01.00-trimming-fastp-fastqc
export raw_reads_dir="${repo_dir}/output/00.00-fastqc-concatenation-raw_reads"
export trimmed_fastqs_dir="${output_dir_top}"

# Paths to programs
export programs_dir="/home/shared"
export fastp="${programs_dir}/fastp-v0.24.0/fastp"
export fastqc="${programs_dir}/FastQC-0.12.1/fastqc"
export multiqc="/home/sam/programs/mambaforge/bin/multiqc"

# Set FastQ filename patterns
export fastq_pattern='*.fastq.gz'
export R1_fastq_pattern='*_R1_*.fastq.gz'
export R2_fastq_pattern='*_R2_*.fastq.gz'
export trimmed_fastq_pattern='*fastp-trim*.fq.gz'

# Input/output files
export fastq_checksums=input_fastq_checksums.md5
export NEB_adapters_fasta=NEB-adapters.fasta

## NEB nebnext-small-rna-library-prep-set-for-illumina adapters
export first_adapter="AGATCGGAAGAGCACACGTCTGAACTCCAGTCAC"
export second_adapter="GATCGTCGGACTGTAGAACTCTGAACGTGTAGATCTCGGTGGTCGCCGTATCATT"

# Set maximum read length for fastp merging
export max_read_length="31"

# Set number of CPUs to use
export threads=40

## Inititalize arrays
export fastq_array_R1=()
export fastq_array_R2=()
export trimmed_fastqs_array=()
export R1_names_array=()
export R2_names_array=()

# Print formatting
export line="--------------------------------------------------------"</code></pre>
</section>
<section id="create-adapters-fasta-for-use-with-fastp-trimming" class="level1">
<h1>3 Create adapters FastA for use with <a href="https://github.com/OpenGene/fastp"><code>fastp</code></a> trimming</h1>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load bash variables into memory</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> .bashvars</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create output directory, if it doesn't exist</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">--parents</span> <span class="st">"</span><span class="va">${output_dir_top}</span><span class="st">"</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Creating adapters FastA."</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="va">adapter_count</span><span class="op">=</span>0</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for adapters file first</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Then create adapters file if doesn't exist</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">-f</span> <span class="st">"</span><span class="va">${output_dir_top}</span><span class="st">/</span><span class="va">${NEB_adapters_fasta}</span><span class="st">"</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">"</span><span class="va">${output_dir_top}</span><span class="st">/</span><span class="va">${NEB_adapters_fasta}</span><span class="st"> already exists. Nothing to do."</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> adapter <span class="kw">in</span> <span class="st">"</span><span class="va">${first_adapter}</span><span class="st">"</span> <span class="st">"</span><span class="va">${second_adapter}</span><span class="st">"</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">do</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="va">adapter_count</span><span class="op">=</span><span class="va">$((adapter_count</span> <span class="op">+</span> <span class="dv">1</span><span class="va">))</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">printf</span> <span class="st">"&gt;%s\n%s\n"</span> <span class="st">"adapter_</span><span class="va">${adapter_count}</span><span class="st">"</span> <span class="st">"</span><span class="va">${adapter}</span><span class="st">"</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">done</span> <span class="op">&gt;&gt;</span> <span class="st">"</span><span class="va">${output_dir_top}</span><span class="st">/</span><span class="va">${NEB_adapters_fasta}</span><span class="st">"</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Adapters FastA:"</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> <span class="st">"</span><span class="va">${output_dir_top}</span><span class="st">/</span><span class="va">${NEB_adapters_fasta}</span><span class="st">"</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>Creating adapters FastA.


Adapters FastA:

&gt;adapter_1
AGATCGGAAGAGCACACGTCTGAACTCCAGTCAC
&gt;adapter_2
GATCGTCGGACTGTAGAACTCTGAACGTGTAGATCTCGGTGGTCGCCGTATCATT</code></pre>
</section>
<section id="trimming-and-merging-with-fastp" class="level1">
<h1>4 Trimming and merging with fastp</h1>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load bash variables into memory</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> .bashvars</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create output directory, if it doesn't exist.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">--parents</span> <span class="st">"</span><span class="va">${trimmed_fastqs_dir}</span><span class="st">"</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Change to directory with raw reads</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> <span class="st">"</span><span class="va">${raw_reads_dir}</span><span class="st">"</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create arrays of FastQ R1 files and sample names</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Do NOT quote R1_fastq_pattern variable</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> fastq <span class="kw">in</span> <span class="va">${R1_fastq_pattern}</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="va">fastq_array_R1</span><span class="op">+=</span><span class="va">(</span><span class="st">"</span><span class="va">${fastq}</span><span class="st">"</span><span class="va">)</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use parameter substitution to remove all text up to and including last "." from</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># right side of string.</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="va">R1_names_array</span><span class="op">+=</span><span class="va">(</span><span class="st">"</span><span class="va">${fastq</span><span class="op">%%</span>.<span class="pp">*</span><span class="va">}</span><span class="st">"</span><span class="va">)</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create array of FastQ R2 files</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Do NOT quote R2_fastq_pattern variable</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> fastq <span class="kw">in</span> <span class="va">${R2_fastq_pattern}</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>  <span class="va">fastq_array_R2</span><span class="op">+=</span><span class="va">(</span><span class="st">"</span><span class="va">${fastq}</span><span class="st">"</span><span class="va">)</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use parameter substitution to remove all text up to and including last "." from</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># right side of string.</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>  <span class="va">R2_names_array</span><span class="op">+=</span><span class="va">(</span><span class="st">"</span><span class="va">${fastq</span><span class="op">%%</span>.<span class="pp">*</span><span class="va">}</span><span class="st">"</span><span class="va">)</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="co">############ RUN FASTP ############</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Uses parameter substitution (e.g. ${R1_sample_name%%_*})to rm the _R[12]</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Uses NEB adapter file</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Run fastp on files</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Beginning fastp trimming."</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a><span class="bu">time</span> <span class="dt">\</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>for index in <span class="st">"</span><span class="va">${</span><span class="op">!</span><span class="va">fastq_array_R1</span><span class="op">[@]</span><span class="va">}</span><span class="st">"</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get sample name</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>  <span class="va">R1_sample_name</span><span class="op">=</span><span class="st">"</span><span class="va">${R1_names_array</span><span class="op">[</span>index<span class="op">]%%</span>_<span class="pp">*</span><span class="va">}</span><span class="st">"</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>  <span class="va">R2_sample_name</span><span class="op">=</span><span class="st">"</span><span class="va">${R2_names_array</span><span class="op">[</span>index<span class="op">]%%</span>_<span class="pp">*</span><span class="va">}</span><span class="st">"</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save merged sample name</span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>  <span class="va">merged_sample_name</span><span class="op">=</span><span class="st">"</span><span class="va">${R1_sample_name}</span><span class="st">-fastp-adapters-polyG-</span><span class="va">${max_read_length}</span><span class="st">bp-merged"</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Begin fastp trimming</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>  <span class="va">${fastp}</span> <span class="dt">\</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">--in1</span> <span class="va">${fastq_array_R1</span><span class="op">[</span>index<span class="op">]</span><span class="va">}</span> <span class="dt">\</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">--in2</span> <span class="va">${fastq_array_R2</span><span class="op">[</span>index<span class="op">]</span><span class="va">}</span> <span class="dt">\</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">--adapter_fasta</span> <span class="va">${output_dir_top}</span>/<span class="va">${NEB_adapters_fasta}</span> <span class="dt">\</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">--trim_poly_g</span> <span class="dt">\</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">--overlap_len_require</span> 17 <span class="dt">\</span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">--length_limit</span> <span class="va">${max_read_length}</span> <span class="dt">\</span></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>  <span class="at">--merge</span> <span class="dt">\</span></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">--merged_out</span> <span class="va">${trimmed_fastqs_dir}</span>/<span class="va">${merged_sample_name}</span>.fq.gz <span class="dt">\</span></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">--thread</span> <span class="va">${threads}</span> <span class="dt">\</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">--html</span> <span class="st">"</span><span class="va">${trimmed_fastqs_dir}</span><span class="st">/</span><span class="va">${merged_sample_name}</span><span class="st">.html"</span> <span class="dt">\</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">--json</span> <span class="st">"</span><span class="va">${trimmed_fastqs_dir}</span><span class="st">/</span><span class="va">${merged_sample_name}</span><span class="st">.json"</span> <span class="dt">\</span></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">--report_title</span> <span class="st">"</span><span class="va">${trimmed_fastqs_dir}</span><span class="st">/</span><span class="va">${merged_sample_name}</span><span class="st">"</span> <span class="dt">\</span></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span><span class="op">&gt;</span> <span class="va">${trimmed_fastqs_dir}</span>/<span class="va">${merged_sample_name}</span>.stderr</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Move to trimmed directory</span></span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This is done so checksums file doesn't include excess path</span></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>  <span class="bu">cd</span> <span class="va">${trimmed_fastqs_dir}</span></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate md5 checksums for newly trimmed files</span></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">md5sum</span> <span class="st">"</span><span class="va">${merged_sample_name}</span><span class="st">.fq.gz"</span> <span class="kw">|</span> <span class="fu">tee</span> <span class="at">--append</span> <span class="st">"</span><span class="va">${merged_sample_name}</span><span class="st">.fq.gz.md5"</span></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Change back to to raw reads directory</span></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>  <span class="bu">cd</span> <span class="st">"</span><span class="va">${raw_reads_dir}</span><span class="st">"</span></span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"fastp trimming complete."</span></span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a><span class="co">############ </span><span class="re">END</span><span class="co"> fastp ############</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>Beginning fastp trimming.

51f055f1810a19deb2ca09ea5bb9df0b  196-fastp-adapters-polyG-31bp-merged.fq.gz
a0673f4ad1fda1fe3f375aa2c76d5fa3  199-fastp-adapters-polyG-31bp-merged.fq.gz
b989841536ec95b3aeb10ef20f848ea7  211-fastp-adapters-polyG-31bp-merged.fq.gz
c33d44ac03a2095e55c3167b35fde0da  24-fastp-adapters-polyG-31bp-merged.fq.gz
02ddae1e57b7b9e7e63d74b4e1f725b8  260-fastp-adapters-polyG-31bp-merged.fq.gz
7c54b3c782c4ed0f15625243dfacc10a  26-fastp-adapters-polyG-31bp-merged.fq.gz
ca7286f6967abf299a9557f204eee659  30-fastp-adapters-polyG-31bp-merged.fq.gz
96c1e31ce89b5caa8a59b54c2745ae1e  310-fastp-adapters-polyG-31bp-merged.fq.gz
6d5a35136a20d9da975cf8740493a711  33-fastp-adapters-polyG-31bp-merged.fq.gz
b9c94cba5c2d2df557a833ab3a868763  341-fastp-adapters-polyG-31bp-merged.fq.gz
7530a8c684b78aa86dee725a71601f8e  34-fastp-adapters-polyG-31bp-merged.fq.gz
7c898a66f9119084ca290f0d85a34f12  35-fastp-adapters-polyG-31bp-merged.fq.gz
d80f6b589e5228731de750dd6ec5dac9  363-fastp-adapters-polyG-31bp-merged.fq.gz
f77f9aa54e2c6662abe24c3a063b6006  367-fastp-adapters-polyG-31bp-merged.fq.gz
a2281f8237ae8cb385a2c22bd185fe57  376-fastp-adapters-polyG-31bp-merged.fq.gz
03b221d3f58f3efb6a6c9a7dcfd37233  460-fastp-adapters-polyG-31bp-merged.fq.gz
c266d11555b76213d739626d40715dde  485-fastp-adapters-polyG-31bp-merged.fq.gz
3fdd30605d7a94c36b9191b34e06fbd3  501-fastp-adapters-polyG-31bp-merged.fq.gz
6929563775fded5a7a9023e3b87d76cd  71-fastp-adapters-polyG-31bp-merged.fq.gz
048d7334f58f5ce149aeadc5745fc28a  88-fastp-adapters-polyG-31bp-merged.fq.gz

real    11m50.402s
user    140m1.165s
sys 3m20.369s

fastp trimming complete.</code></pre>
</section>
<section id="fastqcmultiqc-on-trimmed-reads" class="level1">
<h1>5 FastQC/MultiQC on trimmed reads</h1>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load bash variables into memory</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> .bashvars</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create output directory, if it doesn't exist.</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">--parents</span> <span class="st">"</span><span class="va">${trimmed_fastqs_dir}</span><span class="st">"</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">############ RUN FASTQC ############</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">### </span><span class="al">NOTE</span><span class="co">: Do NOT quote raw_fastqc_list</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create array of trimmed FastQs</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="va">trimmed_fastqs_array</span><span class="op">=</span><span class="va">(${trimmed_fastqs_dir}</span>/<span class="pp">*</span>merged.fq.gz<span class="va">)</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Pass array contents to new variable as space-delimited list</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="va">trimmed_fastqc_list</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="st">"</span><span class="va">${trimmed_fastqs_array</span><span class="op">[*]</span><span class="va">}</span><span class="st">"</span><span class="va">)</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Beginning FastQC on raw reads..."</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Run FastQC</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="va">${fastqc}</span> <span class="dt">\</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>--threads <span class="va">${threads}</span> <span class="dt">\</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>--outdir <span class="va">${trimmed_fastqs_dir}</span> <span class="dt">\</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>--quiet <span class="dt">\</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="va">${trimmed_fastqc_list}</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"FastQC on trimmed reads complete!"</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="co">############ </span><span class="re">END</span><span class="co"> FASTQC ############</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="co">############ RUN MULTIQC ############</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Beginning MultiQC on raw FastQC..."</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="va">${multiqc}</span> <span class="va">${trimmed_fastqs_dir}</span> <span class="at">-o</span> <span class="va">${trimmed_fastqs_dir}</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"MultiQC on trimmed FastQs complete."</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a><span class="co">############ </span><span class="re">END</span><span class="co"> MULTIQC ############</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Removing FastQC zip files."</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="va">${trimmed_fastqs_dir}</span>/<span class="pp">*</span>.zip</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"FastQC zip files removed."</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>Beginning FastQC on raw reads...

application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
FastQC on trimmed reads complete!

Beginning MultiQC on raw FastQC...


  /// MultiQC 🔍 | v1.14

|           multiqc | MultiQC Version v1.25.2 now available!
|           multiqc | Search path : /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/01.00-trimming-fastp-fastqc
|         searching | ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 141/141  
|            fastqc | Found 20 reports
|           multiqc | Compressing plot data
|           multiqc | Report      : ../output/01.00-trimming-fastp-fastqc/multiqc_report.html
|           multiqc | Data        : ../output/01.00-trimming-fastp-fastqc/multiqc_data
|           multiqc | MultiQC complete

MultiQC on trimmed FastQs complete.

Removing FastQC zip files.

FastQC zip files removed.</code></pre>
</section>
<section id="list-output-files" class="level1">
<h1>6 List output files</h1>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load bash variables into memory</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> .bashvars</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View directory contents</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-lh</span> <span class="va">${trimmed_fastqs_dir}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>total 6.8G
-rw-r--r-- 1 sam sam 564K Dec  5 18:48 196-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 336M Dec  5 18:36 196-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   77 Dec  5 18:36 196-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:36 196-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:36 196-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.3K Dec  5 18:36 196-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 569K Dec  5 18:48 199-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 283M Dec  5 18:37 199-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   77 Dec  5 18:37 199-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:37 199-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:37 199-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.3K Dec  5 18:37 199-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 567K Dec  5 18:48 211-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 298M Dec  5 18:37 211-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   77 Dec  5 18:37 211-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 349K Dec  5 18:37 211-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  91K Dec  5 18:37 211-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.3K Dec  5 18:37 211-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 566K Dec  5 18:48 24-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 320M Dec  5 18:38 24-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   76 Dec  5 18:38 24-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:38 24-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:38 24-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.2K Dec  5 18:38 24-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 569K Dec  5 18:48 260-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 327M Dec  5 18:38 260-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   77 Dec  5 18:38 260-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:38 260-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:38 260-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.3K Dec  5 18:38 260-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 568K Dec  5 18:48 26-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 306M Dec  5 18:39 26-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   76 Dec  5 18:39 26-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 349K Dec  5 18:39 26-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  91K Dec  5 18:39 26-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.2K Dec  5 18:39 26-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 570K Dec  5 18:48 30-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 331M Dec  5 18:39 30-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   76 Dec  5 18:39 30-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:39 30-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:39 30-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.2K Dec  5 18:39 30-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 571K Dec  5 18:48 310-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 326M Dec  5 18:40 310-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   77 Dec  5 18:40 310-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:40 310-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:40 310-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.3K Dec  5 18:40 310-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 566K Dec  5 18:49 33-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 341M Dec  5 18:41 33-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   76 Dec  5 18:41 33-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 351K Dec  5 18:40 33-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:40 33-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.2K Dec  5 18:41 33-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 564K Dec  5 18:48 341-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 325M Dec  5 18:41 341-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   77 Dec  5 18:41 341-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:41 341-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:41 341-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.3K Dec  5 18:41 341-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 564K Dec  5 18:49 34-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 394M Dec  5 18:42 34-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   76 Dec  5 18:42 34-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:42 34-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:42 34-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.2K Dec  5 18:42 34-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 570K Dec  5 18:48 35-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 298M Dec  5 18:42 35-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   76 Dec  5 18:42 35-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 349K Dec  5 18:42 35-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  91K Dec  5 18:42 35-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.2K Dec  5 18:42 35-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 572K Dec  5 18:49 363-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 354M Dec  5 18:43 363-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   77 Dec  5 18:43 363-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:43 363-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:43 363-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.3K Dec  5 18:43 363-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 564K Dec  5 18:49 367-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 323M Dec  5 18:43 367-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   77 Dec  5 18:43 367-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 349K Dec  5 18:43 367-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  91K Dec  5 18:43 367-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.3K Dec  5 18:43 367-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 566K Dec  5 18:49 376-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 603M Dec  5 18:44 376-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   77 Dec  5 18:44 376-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 351K Dec  5 18:44 376-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  93K Dec  5 18:44 376-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.3K Dec  5 18:44 376-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 565K Dec  5 18:48 460-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 305M Dec  5 18:45 460-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   77 Dec  5 18:45 460-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:45 460-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:45 460-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.3K Dec  5 18:45 460-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 566K Dec  5 18:49 485-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 320M Dec  5 18:46 485-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   77 Dec  5 18:46 485-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:46 485-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:46 485-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.3K Dec  5 18:46 485-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 563K Dec  5 18:49 501-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 353M Dec  5 18:46 501-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   77 Dec  5 18:46 501-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:46 501-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:46 501-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.3K Dec  5 18:46 501-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 568K Dec  5 18:49 71-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 380M Dec  5 18:47 71-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   76 Dec  5 18:47 71-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:47 71-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:47 71-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.2K Dec  5 18:47 71-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 563K Dec  5 18:49 88-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 374M Dec  5 18:47 88-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   76 Dec  5 18:47 88-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:47 88-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:47 88-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.2K Dec  5 18:47 88-fastp-adapters-polyG-31bp-merged.stderr
drwxr-xr-x 2 sam sam 4.0K Dec  5 18:49 multiqc_data
-rw-r--r-- 1 sam sam 1.3M Dec  5 18:49 multiqc_report.html
-rw-r--r-- 1 sam sam  113 Dec  5 18:36 NEB-adapters.fasta</code></pre>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/robertslab\.github\.io\/sams-notebook");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>