<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Sam&#39;s Notebook</title>
<link>https://robertslab.github.io/sams-notebook/</link>
<atom:link href="https://robertslab.github.io/sams-notebook/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.5.57</generator>
<lastBuildDate>Thu, 20 Feb 2025 08:00:00 GMT</lastBuildDate>
<item>
  <title>DNA Isolation and Quantification - S.namaycush Liver</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2025/2025-02-20-DNA-Isolation-and-Quantification---S.namaycush-Liver/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>Per this <a href="https://github.com/RobertsLab/resources/issues/2079">GitHub Issue</a>, Steven asked that I select <a href="https://en.wikipedia.org/wiki/Lake_trout"><em>Salvelinus namaycush</em></a> liver samples from Lean and Siscowet ecotypes for DNA isolation. As part of this project, DNA is being subjected to long read sequencing. A subset of the samples previously sent did not perform well, so need to be replaced.</p>
</section>
<section id="materials-methods" class="level1">
<h1>MATERIALS &amp; METHODS</h1>
<section id="dna-isolations" class="level2">
<h2 class="anchored" data-anchor-id="dna-isolations">DNA Isolations</h2>
<p>DNA was isolated from five Lean and five Siscowet ecotypes using the Quick-DNA Microprep Kit (ZymoResearch; Cat: D3024), according to the manufacturer’s protocol, with the inclusion of beta-mercaptoethanol in the DNA Lysis Buffer.</p>
<p>Briefly, the liver tissue had been stored @ -20<sup>o</sup>C in RNAlater. Samples were thawed and the entirety of the sample was transferred to a 1.5mL snap cap tubed. Samples were homogenized using disposable plastic pestles (Fisher Scientific; Cat; K749520-0090). Insolbule debris was pelleted and supernatant was transferred to spin columns. Samples were processed per the manufacturer’s protocol.</p>
<p>DNA was eluted with 50uL of Elution Buffer.</p>
<p>DNA was stored @ -20<sup>o</sup>C in my “Lake Trout Liver gDNA” box in FTR 209.</p>
</section>
<section id="dna-quantification" class="level2">
<h2 class="anchored" data-anchor-id="dna-quantification">DNA Quantification</h2>
<p>DNA was quantified using the Qubit 1x dsDNA HS Assay (Invitrogen; Q33231) on the Roberts Lab Qubit 3.0 fluorometer. 1uL of each sample was used.</p>
</section>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<p>Qubit data (Google Sheet):</p>
<ul>
<li><a href="https://docs.google.com/spreadsheets/d/1QTeE37cF-0oe1bgWQrgKs_ebgQi1LCFjtOq5WeUCS4I/edit?usp=sharing">20250220-snam-qubit-DNA.hs-liver</a></li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Sample</th>
<th>Ecoytpe</th>
<th>Concentration(ng/uL)</th>
<th>Volume(uL)</th>
<th>Total(ng)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>FA091</td>
<td>Lean</td>
<td>146</td>
<td>40</td>
<td>5840</td>
</tr>
<tr class="even">
<td>FA092</td>
<td>Lean</td>
<td>540</td>
<td>40</td>
<td>21600</td>
</tr>
<tr class="odd">
<td>FA093</td>
<td>Lean</td>
<td>36.8</td>
<td>25</td>
<td>920</td>
</tr>
<tr class="even">
<td>FA094</td>
<td>Lean</td>
<td>214</td>
<td>40</td>
<td>8560</td>
</tr>
<tr class="odd">
<td>FA095</td>
<td>Lean</td>
<td>253</td>
<td>40</td>
<td>10120</td>
</tr>
<tr class="even">
<td>FA096</td>
<td>Sisco</td>
<td>38.8</td>
<td>40</td>
<td>1552</td>
</tr>
<tr class="odd">
<td>FA097</td>
<td>Sisco</td>
<td>258</td>
<td>40</td>
<td>10320</td>
</tr>
<tr class="even">
<td>FA098</td>
<td>Sisco</td>
<td>22.5</td>
<td>40</td>
<td>900</td>
</tr>
<tr class="odd">
<td>FA099</td>
<td>Sisco</td>
<td>238</td>
<td>40</td>
<td>9520</td>
</tr>
<tr class="even">
<td>FA100</td>
<td>Sisco</td>
<td>205</td>
<td>40</td>
<td>8200</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sample FA093 experienced clogging in the column, resulting in low yield.</p>
</div>
</div>


</section>

 ]]></description>
  <category>2025</category>
  <category>lake trout</category>
  <category>Salvelinus namaycush</category>
  <category>DNA isolation</category>
  <category>Qubit</category>
  <category>DNA quantification</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2025/2025-02-20-DNA-Isolation-and-Quantification---S.namaycush-Liver/</guid>
  <pubDate>Thu, 20 Feb 2025 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Trimming - P.evermanni WGBS Trimming and QC with fastp FastQC and MultiQC for E5 timeseries_molecular Project</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2025/2025-02-12-Trimming---P.evermanni-WGBS-Trimming-and-QC-with-fastp-FastQC-and-MultiQC-for-E5-timeseries_molecular-Project/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>I <a href="../../../posts/2025/2025-02-10-FastQC-MultiQC---P.evermanni-Raw-WGBS-Renaming-and-FastQC-MultiQC-E5-timeseries_molecular-Project/index.html">previously ran FastQC and MultiQC quality checks (20250210)</a> (Notebook) on the <em>P.evermanni</em> raw whole genome bisulfite sequencing (WGBS) data <a href="../../../posts/2024/2024-12-30-Data-Received---Coral-E5-WGBS-Time-Series-from-Azenta-Project-30-1067895835/index.html">received 20241230</a> (Notebook), as part of <a href="https://github.com/urol-e5/timeseries_molecular">urol-e5/timeseries_molecular</a> (GitHub repo).</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>These are <em>directional</em> libraries - important info for downstream analysis.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The contents below are from markdown knitted from <a href="https://github.com/urol-e5/timeseries_molecular/blob/66c07f6344a6a3fc0c56946269d80420fc54c60b/E-Peve/code/01.00-E-Peve-WGBS-trimming-fastp-FastQC-MultiQC.Rmd"><code>01.00-E-Peve-WGBS-trimming-fastp-FastQC-MultiQC.Rmd</code></a> (commit <code>66c07f6</code>).</p>
</div>
</div>
</section>
<section id="background" class="level1">
<h1>1 Background</h1>
<p>This notebook will download raw WGBS FastQs, concatenate them (there were multiple lanes run), and then trim them using <a href="https://github.com/OpenGene/fastp">fastp</a> (Chen 2023). Samples which generate an error during trimming will attempt to be repaired using <a href="https://jgi.doe.gov/data-and-tools/software-tools/bbtools/">BBTools <code>repairl.sh</code></a> (BBMap – Bushnell B. – sourceforge.net/projects/bbmap/). Trimming results will be analyzed with FastQC and summarized by <a href="https://github.com/MultiQC/MultiQC">MultiQC</a> (Ewels et al.&nbsp;2016).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you need to download the raw sequencing reads, please see <a href="https://github.com/urol-e5/timeseries_molecular/blob/e05febcc9105afaf086c573368e15b7228d2cbaf/E-Peve/code/00.20-E-Peve-WGBS-reads-FastQC-MultiQC.Rmd">00.20-E-Peve-WGBS-reads-FastQC-MultiQC.Rmd</a></p>
</div>
</div>
<section id="inputs" class="level2">
<h2 class="anchored" data-anchor-id="inputs">1.1 Inputs</h2>
<p>Raw FastQ files with the following pattern:</p>
<ul>
<li><code>*.fastq.gz</code></li>
</ul>
</section>
<section id="outputs" class="level2">
<h2 class="anchored" data-anchor-id="outputs">1.2 Outputs</h2>
<p>The expected outputs will be:</p>
<ul>
<li><p><code>multiqc_report.html</code>: A summary report of the alignment results generated by <a href="https://github.com/MultiQC/MultiQC">MultiQC</a>, in HTML format.</p></li>
<li><p><code>*fastp-trim*.fq.gz</code>: Trimmed FastQ files.</p>
<ul>
<li><p>Due to the large file sizes of FastQs, these cannot be hosted in the <a href="https://github.com/urol-e5/timeseries_molecular">urol-e5/timeseries_molecular GitHub repo</a>. As such these files are available for download here:</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/E-Peve/output/01.00-E-Peve-WGBS-trimming-fastp-FastQC-MultiQC/" class="uri">https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/E-Peve/output/01.00-E-Peve-WGBS-trimming-fastp-FastQC-MultiQC/</a></li>
</ul></li>
</ul></li>
</ul>
</section>
</section>
<section id="create-a-bash-variables-file" class="level1">
<h1>2 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export repo_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export output_dir_top=${repo_dir}/E-Peve/output/01.00-E-Peve-WGBS-trimming-fastp-FastQC-MultiQC'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_dir="${repo_dir}/E-Peve/data/wgbs-raw-fastqs"'</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export trimmed_fastqs_dir="${output_dir_top}"'</span></span>
<span id="cb1-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Paths to programs"</span></span>
<span id="cb1-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export programs_dir="/home/shared"'</span></span>
<span id="cb1-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export bbmap_repair="${programs_dir}/bbmap-39.12/repair.sh"'</span></span>
<span id="cb1-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export bismark_dir="${programs_dir}/Bismark-0.24.0"'</span></span>
<span id="cb1-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export bowtie2_dir="${programs_dir}/bowtie2-2.4.4-linux-x86_64"'</span></span>
<span id="cb1-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastp="${programs_dir}/fastp-v0.24.0/fastp"'</span></span>
<span id="cb1-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastqc="${programs_dir}/FastQC-0.12.1/fastqc"'</span></span>
<span id="cb1-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export multiqc="/home/sam/programs/mambaforge/bin/multiqc"'</span></span>
<span id="cb1-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export samtools_dir="${programs_dir}/samtools-1.12"'</span></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-22"></span>
<span id="cb1-23"></span>
<span id="cb1-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set FastQ filename patterns"</span></span>
<span id="cb1-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export fastq_pattern='*.fastq.gz'"</span></span>
<span id="cb1-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R1_fastq_pattern='*_R1_*.fastq.gz'"</span></span>
<span id="cb1-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R2_fastq_pattern='*_R2_*.fastq.gz'"</span></span>
<span id="cb1-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export trimmed_fastq_pattern='*fastp-trim*.fq.gz'"</span></span>
<span id="cb1-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-30"></span>
<span id="cb1-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set number of CPUs to use"</span></span>
<span id="cb1-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=40'</span></span>
<span id="cb1-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-34"></span>
<span id="cb1-35"></span>
<span id="cb1-36"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"## Inititalize arrays"</span></span>
<span id="cb1-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R1=()'</span></span>
<span id="cb1-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R2=()'</span></span>
<span id="cb1-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export trimmed_fastqs_array=()'</span></span>
<span id="cb1-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R1_names_array=()'</span></span>
<span id="cb1-41"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R2_names_array=()'</span></span>
<span id="cb1-42"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-43"></span>
<span id="cb1-44"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Print formatting"</span></span>
<span id="cb1-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-46"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-47"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-48"></span>
<span id="cb1-49"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export repo_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular
export output_dir_top=${repo_dir}/E-Peve/output/01.00-E-Peve-WGBS-trimming-fastp-FastQC-MultiQC
export raw_reads_dir="${repo_dir}/E-Peve/data/wgbs-raw-fastqs"
export trimmed_fastqs_dir="${output_dir_top}"

# Paths to programs
export programs_dir="/home/shared"
export bbmap_repair="${programs_dir}/bbmap-39.12/repair.sh"
export bismark_dir="${programs_dir}/Bismark-0.24.0"
export bowtie2_dir="${programs_dir}/bowtie2-2.4.4-linux-x86_64"
export fastp="${programs_dir}/fastp-v0.24.0/fastp"
export fastqc="${programs_dir}/FastQC-0.12.1/fastqc"
export multiqc="/home/sam/programs/mambaforge/bin/multiqc"
export samtools_dir="${programs_dir}/samtools-1.12"

# Set FastQ filename patterns
export fastq_pattern='*.fastq.gz'
export R1_fastq_pattern='*_R1_*.fastq.gz'
export R2_fastq_pattern='*_R2_*.fastq.gz'
export trimmed_fastq_pattern='*fastp-trim*.fq.gz'

# Set number of CPUs to use
export threads=40

## Inititalize arrays
export fastq_array_R1=()
export fastq_array_R2=()
export trimmed_fastqs_array=()
export R1_names_array=()
export R2_names_array=()

# Print formatting
export line="--------------------------------------------------------"</code></pre>
</section>
<section id="trimming-and-error-repair" class="level1">
<h1>3 Trimming and Error Repair</h1>
<p>Trimming will remove any Illumina sequencing adapters, as well as polyG and polyX (primarily polyA) sequences. Trimming will also remove the first 15bp from the 5’ end of each read - this is based on FastQC/MultiQC assessment of raw reads.</p>
<p>Samples generating an error during trimming will attempt to be repaired with BBTools’ <code>repair.sh</code> script.</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directory, if it doesn't exist</span></span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span></span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-8"></span>
<span id="cb3-9"></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create arrays of fastq R1 files and sample names</span></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Do NOT quote R1_fastq_pattern variable</span></span>
<span id="cb3-12"></span>
<span id="cb3-13"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_fastq_pattern}</span></span>
<span id="cb3-14"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb3-15">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-16"></span>
<span id="cb3-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use parameter substitution to remove all text up to and including last "." from</span></span>
<span id="cb3-18">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># right side of string.</span></span>
<span id="cb3-19">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R1_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>.<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-20"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb3-21"></span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of fastq R2 files</span></span>
<span id="cb3-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Do NOT quote R2_fastq_pattern variable</span></span>
<span id="cb3-24"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_fastq_pattern}</span></span>
<span id="cb3-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb3-26">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-27"></span>
<span id="cb3-28">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use parameter substitution to remove all text up to and including last "." from</span></span>
<span id="cb3-29">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># right side of string.</span></span>
<span id="cb3-30">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R2_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(${fastq</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>.<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">})</span></span>
<span id="cb3-31"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb3-32"></span>
<span id="cb3-33"></span>
<span id="cb3-34"></span>
<span id="cb3-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run fastp on files</span></span>
<span id="cb3-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adds JSON report output for downstream usage by MultiQC</span></span>
<span id="cb3-37"></span>
<span id="cb3-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning fastp trimming."</span></span>
<span id="cb3-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-------------------------------------------------"</span></span>
<span id="cb3-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-41"></span>
<span id="cb3-42"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> index <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-43"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb3-44">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R1_sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-45">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R2_sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-46">  </span>
<span id="cb3-47">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">stderr_PE_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print $1}'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-48">  </span>
<span id="cb3-49">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastp}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-50">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--in1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-51">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--in2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-52">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--detect_adapter_for_pe</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-53">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_poly_g</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-54">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_poly_x</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-55">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--thread</span> 16 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-56">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_front1</span> 15 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-57">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_front2</span> 15 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-58">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--html</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.report.html <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-59">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--json</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.report.json <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-60">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--out1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-61">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--out2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-62">  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_PE_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.stderr</span>
<span id="cb3-63">  </span>
<span id="cb3-64">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check for errors in fastp stderr</span></span>
<span id="cb3-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--before-context</span> 5 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERROR"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_PE_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.stderr</span>
<span id="cb3-66">  </span>
<span id="cb3-67">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check for fastp errors and then repair</span></span>
<span id="cb3-68">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--quiet</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERROR"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_PE_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.stderr<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb3-69">      </span>
<span id="cb3-70">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz</span>
<span id="cb3-71">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz</span>
<span id="cb3-72">    </span>
<span id="cb3-73">    </span>
<span id="cb3-74">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bbmap_repair}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-75">    in1=<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-76">    in2=<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-77">    out1=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.REPAIRED.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-78">    out2=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.REPAIRED.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-79">    outs=/dev/null <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-80">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.REPAIRED.stderr</span>
<span id="cb3-81">    </span>
<span id="cb3-82">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastp}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--in1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.REPAIRED.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--in2</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.REPAIRED.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--detect_adapter_for_pe</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_poly_g</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_poly_x</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-88">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--thread</span> 16 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-89">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_front1</span> 10 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-90">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_front2</span> 10 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--html</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.REPAIRED.report.html <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--json</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.REPAIRED.report.json <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-93">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--out1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.REPAIRED.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--out2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.REPAIRED.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-95">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_PE_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.REPAIRED.stderr</span>
<span id="cb3-96"> </span>
<span id="cb3-97">    </span>
<span id="cb3-98">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--quiet</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERROR"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_PE_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.REPAIRED.stderr<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb3-99">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"These </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_PE_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> samples are broken."</span></span>
<span id="cb3-100">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Just give up.  :("</span></span>
<span id="cb3-101">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-102">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb3-103">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb3-104"></span>
<span id="cb3-105">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Finished trimming:"</span></span>
<span id="cb3-106">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-107">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-108">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-109">  </span>
<span id="cb3-110">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate md5 checksums for newly trimmed files</span></span>
<span id="cb3-111">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-112">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz.md5</span>
<span id="cb3-113">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz.md5</span>
<span id="cb3-114">  </span>
<span id="cb3-115">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-116"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<pre><code>Beginning fastp trimming.
-------------------------------------------------

Finished trimming:
POR-216-TP1_R1_001.fastq.gz
POR-216-TP1_R2_001.fastq.gz

Finished trimming:
POR-216-TP2_R1_001.fastq.gz
POR-216-TP2_R2_001.fastq.gz

Finished trimming:
POR-216-TP3_R1_001.fastq.gz
POR-216-TP3_R2_001.fastq.gz

Finished trimming:
POR-216-TP4_R1_001.fastq.gz
POR-216-TP4_R2_001.fastq.gz

Finished trimming:
POR-236-TP1_R1_001.fastq.gz
POR-236-TP1_R2_001.fastq.gz

Finished trimming:
POR-236-TP2_R1_001.fastq.gz
POR-236-TP2_R2_001.fastq.gz

Finished trimming:
POR-245-TP1_R1_001.fastq.gz
POR-245-TP1_R2_001.fastq.gz

Finished trimming:
POR-245-TP2_R1_001.fastq.gz
POR-245-TP2_R2_001.fastq.gz

Finished trimming:
POR-245-TP3_R1_001.fastq.gz
POR-245-TP3_R2_001.fastq.gz

Finished trimming:
POR-245-TP4_R1_001.fastq.gz
POR-245-TP4_R2_001.fastq.gz

Finished trimming:
POR-260-TP1_R1_001.fastq.gz
POR-260-TP1_R2_001.fastq.gz

Finished trimming:
POR-260-TP2_R1_001.fastq.gz
POR-260-TP2_R2_001.fastq.gz

Finished trimming:
POR-260-TP3_R1_001.fastq.gz
POR-260-TP3_R2_001.fastq.gz

Finished trimming:
POR-260-TP4_R1_001.fastq.gz
POR-260-TP4_R2_001.fastq.gz

Finished trimming:
POR-262-TP1_R1_001.fastq.gz
POR-262-TP1_R2_001.fastq.gz

Finished trimming:
POR-262-TP2_R1_001.fastq.gz
POR-262-TP2_R2_001.fastq.gz

Finished trimming:
POR-262-TP4_R1_001.fastq.gz
POR-262-TP4_R2_001.fastq.gz

Finished trimming:
POR-69-TP1_R1_001.fastq.gz
POR-69-TP1_R2_001.fastq.gz

Finished trimming:
POR-69-TP2_R1_001.fastq.gz
POR-69-TP2_R2_001.fastq.gz

Finished trimming:
POR-69-TP3_R1_001.fastq.gz
POR-69-TP3_R2_001.fastq.gz

Finished trimming:
POR-69-TP4_R1_001.fastq.gz
POR-69-TP4_R2_001.fastq.gz

Finished trimming:
POR-72-TP1_R1_001.fastq.gz
POR-72-TP1_R2_001.fastq.gz

Finished trimming:
POR-72-TP2_R1_001.fastq.gz
POR-72-TP2_R2_001.fastq.gz

Finished trimming:
POR-72-TP3_R1_001.fastq.gz
POR-72-TP3_R2_001.fastq.gz

Finished trimming:
POR-72-TP4_R1_001.fastq.gz
POR-72-TP4_R2_001.fastq.gz

Finished trimming:
POR-73-TP1_R1_001.fastq.gz
POR-73-TP1_R2_001.fastq.gz

Finished trimming:
POR-73-TP2_R1_001.fastq.gz
POR-73-TP2_R2_001.fastq.gz

Finished trimming:
POR-73-TP3_R1_001.fastq.gz
POR-73-TP3_R2_001.fastq.gz

Finished trimming:
POR-74-TP1_R1_001.fastq.gz
POR-74-TP1_R2_001.fastq.gz

Finished trimming:
POR-74-TP2_R1_001.fastq.gz
POR-74-TP2_R2_001.fastq.gz

Finished trimming:
POR-74-TP3_R1_001.fastq.gz
POR-74-TP3_R2_001.fastq.gz

Finished trimming:
POR-74-TP4_R1_001.fastq.gz
POR-74-TP4_R2_001.fastq.gz

Finished trimming:
POR-83-TP1_R1_001.fastq.gz
POR-83-TP1_R2_001.fastq.gz

Finished trimming:
POR-83-TP2_R1_001.fastq.gz
POR-83-TP2_R2_001.fastq.gz

Finished trimming:
POR-83-TP3_R1_001.fastq.gz
POR-83-TP3_R2_001.fastq.gz

Finished trimming:
POR-83-TP4_R1_001.fastq.gz
POR-83-TP4_R2_001.fastq.gz</code></pre>
</section>
<section id="fastqc" class="level1">
<h1>4 FastQC</h1>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-5"></span>
<span id="cb5-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN FASTQC ############</span></span>
<span id="cb5-7"></span>
<span id="cb5-8"></span>
<span id="cb5-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of trimmed FastQs</span></span>
<span id="cb5-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trimmed_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(${trimmed_fastq_pattern})</span></span>
<span id="cb5-11"></span>
<span id="cb5-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pass array contents to new variable as space-delimited list</span></span>
<span id="cb5-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trimmed_fastqc_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[*]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-14"></span>
<span id="cb5-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning FastQC on trimmed reads..."</span></span>
<span id="cb5-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-17"></span>
<span id="cb5-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run FastQC</span></span>
<span id="cb5-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Do NOT quote raw_fastqc_list</span></span>
<span id="cb5-20"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastqc}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-21">--threads <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-22">--outdir <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-23">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-24"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqc_list}</span></span>
<span id="cb5-25"></span>
<span id="cb5-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC on trimmed reads complete!"</span></span>
<span id="cb5-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-28"></span>
<span id="cb5-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> FASTQC ############</span></span></code></pre></div>
<pre><code>Beginning FastQC on trimmed reads...

application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
FastQC on trimmed reads complete!</code></pre>
</section>
<section id="multiqc" class="level1">
<h1>5 MultiQC</h1>
<p>Uses <code>--cl-config "sp: { fastp: { fn: '*report.json' } }"</code> to update the MultiQC search pattern for the fastp module.</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb7-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb7-3"></span>
<span id="cb7-4"></span>
<span id="cb7-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${multiqc}</span> . <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-8">--cl-config <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sp: { fastp: { fn: '*report.json' } }"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-9">--interactive</span></code></pre></div>
<pre><code>  /// MultiQC 🔍 | v1.14

|           multiqc | MultiQC Version v1.27 now available!
|           multiqc | Search path : /home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/output/01.00-E-Peve-WGBS-trimming-fastp-FastQC-MultiQC
|         searching | ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 396/396  
|             fastp | Found 36 reports
|            fastqc | Found 72 reports
|           multiqc | Compressing plot data
|           multiqc | Report      : multiqc_report.html
|           multiqc | Data        : multiqc_data
|           multiqc | MultiQC complete</code></pre>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<p>Overall, trimming looks good. However, it’s disappointing to see residual polyA contamination, despite specifying <code>--trim_poly_x</code> in the <a href="https://github.com/OpenGene/fastp"><code>fastp</code></a> arguments. The polyA contamination is likely RNA carried over from the DNA isolation prep. It shouldn’t cause any issues, as RNA shouldn’t end up aligning to the bisulfite-converted genome downstream.</p>
<p>MultiQC report:</p>
<ul>
<li><a href="https://github.com/urol-e5/timeseries_molecular/blob/66c07f6344a6a3fc0c56946269d80420fc54c60b/E-Peve/output/01.00-E-Peve-WGBS-trimming-fastp-FastQC-MultiQC/multiqc_report.html">01.00-E-Peve-WGBS-trimming-fastp-FastQC-MultiQC/multiqc_report.html</a> (GitHub repo)</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2025/2025-02-12-Trimming---P.evermanni-WGBS-Trimming-and-QC-with-fastp-FastQC-and-MultiQC-for-E5-timeseries_molecular-Project/20250212-peve-multiqc-plot-sequence-content.png" class="img-fluid figure-img" alt="Screenshot of trimmed MultiQC per base sequence content plot showing low C content - indicative of directional WGBS libraries"></p>
<figcaption>MultiQC screencap showing post trimming Sequence Content.</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2025/2025-02-12-Trimming---P.evermanni-WGBS-Trimming-and-QC-with-fastp-FastQC-and-MultiQC-for-E5-timeseries_molecular-Project/20250212-peve-multiqc-plot-adapter-content.png" class="img-fluid figure-img"></p>
<figcaption>MultiQC screencap showing post trimming Adapter Content with residula polyA contamination.</figcaption>
</figure>
</div>
</section>
<section id="references" class="level1">
<h1>6 REFERENCES</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-chen2023" class="csl-entry">
Chen, Shifu. 2023. “Ultrafast One-Pass FASTQ Data Preprocessing, Quality Control, and Deduplication Using Fastp.” <em>iMeta</em> 2 (2). <a href="https://doi.org/10.1002/imt2.107" class="uri">https://doi.org/10.1002/imt2.107</a>.
</div>
<div id="ref-ewels2016" class="csl-entry">
Ewels, Philip, Måns Magnusson, Sverker Lundin, and Max Käller. 2016. “MultiQC: Summarize Analysis Results for Multiple Tools and Samples in a Single Report.” <em>Bioinformatics</em> 32 (19): 3047–48. <a href="https://doi.org/10.1093/bioinformatics/btw354" class="uri">https://doi.org/10.1093/bioinformatics/btw354</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2025</category>
  <category>Porites evermanni</category>
  <category>E5</category>
  <category>WGBS</category>
  <category>bisulfite sequencing</category>
  <category>FastQC</category>
  <category>MultiQC</category>
  <category>fastp</category>
  <category>trimming</category>
  <category>timeseries_molecular</category>
  <category>coral</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2025/2025-02-12-Trimming---P.evermanni-WGBS-Trimming-and-QC-with-fastp-FastQC-and-MultiQC-for-E5-timeseries_molecular-Project/</guid>
  <pubDate>Wed, 12 Feb 2025 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Trimming - P.tuahiniensis WGBS Trimming and QC with fastp FastQC and MultiQC for E5 timeseries_molecular Project</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2025/2025-02-12-Trimming---P.tuahiniensis-WGBS-Trimming-and-QC-with-fastp-FastQC-and-MultiQC-for-E5-timeseries_molecular-Project/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>I <a href="../../../posts/2025/2025-02-10-FastQC-MultiQC---P.tuahiniensis-Raw-WGBS-Renaming-and-FastQC-MultiQC-timeseries_molecular-Project/index.html">previously ran FastQC and MultiQC quality checks (20250210)</a> (Notebook) on the <em>P.evermanni</em> raw whole genome bisulfite sequencing (WGBS) data <a href="../../../posts/2024/2024-12-30-Data-Received---Coral-E5-WGBS-Time-Series-from-Azenta-Project-30-1067895835/index.html">received 20241230</a> (Notebook), as part of <a href="https://github.com/urol-e5/timeseries_molecular">urol-e5/timeseries_molecular</a> (GitHub repo).</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>These are <em>directional</em> libraries - important info for downstream analysis.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The contents below are from markdown knitted from <a href="https://github.com/urol-e5/timeseries_molecular/blob/960d871c2d54d5c3fbdf3665a7fb4bafe68f88c7/F-Ptua/code/01.00-F-Ptua-WGBS-trimming-fastp-FastQC-MultiQC.Rmd"><code>01.00-F-Ptua-WGBS-trimming-fastp-FastQC-MultiQC.Rmd</code></a> (commit <code>960d871</code>).</p>
</div>
</div>
</section>
<section id="background" class="level1">
<h1>1 Background</h1>
<p>This notebook will trim raw WGBS FastQs using <a href="https://github.com/OpenGene/fastp">fastp</a> (Chen 2023). Samples which generate an error during trimming will attempt to be repaired using <a href="https://jgi.doe.gov/data-and-tools/software-tools/bbtools/">BBTools <code>repairl.sh</code></a> (BBMap – Bushnell B. – sourceforge.net/projects/bbmap/). Trimming results will be analyzed with FastQC and summarized by <a href="https://github.com/MultiQC/MultiQC">MultiQC</a> (Ewels et al.&nbsp;2016).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you need to download the raw sequencing reads, please see <a href="https://github.com/urol-e5/timeseries_molecular/blob/e05febcc9105afaf086c573368e15b7228d2cbaf/F-Ptua/code/00.20-F-Ptua-WGBS-reads-FastQC-MultiQC.Rmd">00.20-F-Ptua-WGBS-reads-FastQC-MultiQC.Rmd</a></p>
</div>
</div>
<section id="inputs" class="level2">
<h2 class="anchored" data-anchor-id="inputs">1.1 Inputs</h2>
<p>Raw FastQ files with the following pattern:</p>
<ul>
<li><code>*.fastq.gz</code></li>
</ul>
</section>
<section id="outputs" class="level2">
<h2 class="anchored" data-anchor-id="outputs">1.2 Outputs</h2>
<p>The expected outputs will be:</p>
<ul>
<li><p><code>multiqc_report.html</code>: A summary report of the alignment results generated by <a href="https://github.com/MultiQC/MultiQC">MultiQC</a>, in HTML format.</p></li>
<li><p><code>*fastp-trim*.fq.gz</code>: Trimmed FastQ files.</p>
<ul>
<li><p>Due to the large file sizes of FastQs, these cannot be hosted in the <a href="https://github.com/urol-e5/timeseries_molecular">urol-e5/timeseries_molecular GitHub repo</a>. As such these files are available for download here:</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/F-Ptua/output/01.00-F-Ptua-WGBS-trimming-fastp-FastQC-MultiQC/" class="uri">https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/F-Ptua/output/01.00-F-Ptua-WGBS-trimming-fastp-FastQC-MultiQC/</a></li>
</ul></li>
</ul></li>
</ul>
</section>
</section>
<section id="create-a-bash-variables-file" class="level1">
<h1>2 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export repo_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export output_dir_top=${repo_dir}/F-Ptua/output/01.00-F-Ptua-WGBS-trimming-fastp-FastQC-MultiQC'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_dir="${repo_dir}/F-Ptua/data/wgbs-raw-fastqs"'</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export trimmed_fastqs_dir="${output_dir_top}"'</span></span>
<span id="cb1-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Paths to programs"</span></span>
<span id="cb1-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export programs_dir="/home/shared"'</span></span>
<span id="cb1-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export bbmap_repair="${programs_dir}/bbmap-39.12/repair.sh"'</span></span>
<span id="cb1-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export bismark_dir="${programs_dir}/Bismark-0.24.0"'</span></span>
<span id="cb1-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export bowtie2_dir="${programs_dir}/bowtie2-2.4.4-linux-x86_64"'</span></span>
<span id="cb1-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastp="${programs_dir}/fastp-v0.24.0/fastp"'</span></span>
<span id="cb1-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastqc="${programs_dir}/FastQC-0.12.1/fastqc"'</span></span>
<span id="cb1-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export multiqc="/home/sam/programs/mambaforge/bin/multiqc"'</span></span>
<span id="cb1-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export samtools_dir="${programs_dir}/samtools-1.12"'</span></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-22"></span>
<span id="cb1-23"></span>
<span id="cb1-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set FastQ filename patterns"</span></span>
<span id="cb1-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export fastq_pattern='*.fastq.gz'"</span></span>
<span id="cb1-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R1_fastq_pattern='*_R1_*.fastq.gz'"</span></span>
<span id="cb1-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R2_fastq_pattern='*_R2_*.fastq.gz'"</span></span>
<span id="cb1-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export trimmed_fastq_pattern='*fastp-trim*.fq.gz'"</span></span>
<span id="cb1-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-30"></span>
<span id="cb1-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set number of CPUs to use"</span></span>
<span id="cb1-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=40'</span></span>
<span id="cb1-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-34"></span>
<span id="cb1-35"></span>
<span id="cb1-36"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"## Inititalize arrays"</span></span>
<span id="cb1-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R1=()'</span></span>
<span id="cb1-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R2=()'</span></span>
<span id="cb1-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export trimmed_fastqs_array=()'</span></span>
<span id="cb1-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R1_names_array=()'</span></span>
<span id="cb1-41"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R2_names_array=()'</span></span>
<span id="cb1-42"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-43"></span>
<span id="cb1-44"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Print formatting"</span></span>
<span id="cb1-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-46"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-47"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-48"></span>
<span id="cb1-49"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export repo_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular
export output_dir_top=${repo_dir}/F-Ptua/output/01.00-F-Ptua-WGBS-trimming-fastp-FastQC-MultiQC
export raw_reads_dir="${repo_dir}/F-Ptua/data/wgbs-raw-fastqs"
export trimmed_fastqs_dir="${output_dir_top}"

# Paths to programs
export programs_dir="/home/shared"
export bbmap_repair="${programs_dir}/bbmap-39.12/repair.sh"
export bismark_dir="${programs_dir}/Bismark-0.24.0"
export bowtie2_dir="${programs_dir}/bowtie2-2.4.4-linux-x86_64"
export fastp="${programs_dir}/fastp-v0.24.0/fastp"
export fastqc="${programs_dir}/FastQC-0.12.1/fastqc"
export multiqc="/home/sam/programs/mambaforge/bin/multiqc"
export samtools_dir="${programs_dir}/samtools-1.12"

# Set FastQ filename patterns
export fastq_pattern='*.fastq.gz'
export R1_fastq_pattern='*_R1_*.fastq.gz'
export R2_fastq_pattern='*_R2_*.fastq.gz'
export trimmed_fastq_pattern='*fastp-trim*.fq.gz'

# Set number of CPUs to use
export threads=40

## Inititalize arrays
export fastq_array_R1=()
export fastq_array_R2=()
export trimmed_fastqs_array=()
export R1_names_array=()
export R2_names_array=()

# Print formatting
export line="--------------------------------------------------------"</code></pre>
</section>
<section id="trimming-and-error-repair" class="level1">
<h1>3 Trimming and Error Repair</h1>
<p>Trimming will remove any Illumina sequencing adapters, as well as polyG and polyX (primarily polyA) sequences. Trimming will also remove the first 15bp from the 5’ end of each read - this is based on FastQC/MultiQC assessment of raw reads.</p>
<p>Samples generating an error during trimming will attempt to be repaired with BBTools’ <code>repair.sh</code> script.</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directory, if it doesn't exist</span></span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span></span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-8"></span>
<span id="cb3-9"></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create arrays of fastq R1 files and sample names</span></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Do NOT quote R1_fastq_pattern variable</span></span>
<span id="cb3-12"></span>
<span id="cb3-13"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_fastq_pattern}</span></span>
<span id="cb3-14"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb3-15">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-16"></span>
<span id="cb3-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use parameter substitution to remove all text up to and including last "." from</span></span>
<span id="cb3-18">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># right side of string.</span></span>
<span id="cb3-19">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R1_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>.<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-20"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb3-21"></span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of fastq R2 files</span></span>
<span id="cb3-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Do NOT quote R2_fastq_pattern variable</span></span>
<span id="cb3-24"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_fastq_pattern}</span></span>
<span id="cb3-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb3-26">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-27"></span>
<span id="cb3-28">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use parameter substitution to remove all text up to and including last "." from</span></span>
<span id="cb3-29">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># right side of string.</span></span>
<span id="cb3-30">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R2_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(${fastq</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>.<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">})</span></span>
<span id="cb3-31"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb3-32"></span>
<span id="cb3-33"></span>
<span id="cb3-34"></span>
<span id="cb3-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run fastp on files</span></span>
<span id="cb3-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adds JSON report output for downstream usage by MultiQC</span></span>
<span id="cb3-37"></span>
<span id="cb3-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning fastp trimming."</span></span>
<span id="cb3-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-------------------------------------------------"</span></span>
<span id="cb3-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-41"></span>
<span id="cb3-42"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> index <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-43"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb3-44">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R1_sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-45">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R2_sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-46">  </span>
<span id="cb3-47">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">stderr_PE_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print $1}'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-48">  </span>
<span id="cb3-49">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastp}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-50">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--in1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-51">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--in2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-52">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--detect_adapter_for_pe</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-53">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_poly_g</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-54">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_poly_x</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-55">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--thread</span> 16 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-56">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_front1</span> 15 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-57">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_front2</span> 15 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-58">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--html</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.report.html <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-59">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--json</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.report.json <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-60">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--out1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-61">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--out2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-62">  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_PE_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.stderr</span>
<span id="cb3-63">  </span>
<span id="cb3-64">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check for errors in fastp stderr</span></span>
<span id="cb3-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--before-context</span> 5 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERROR"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_PE_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.stderr</span>
<span id="cb3-66">  </span>
<span id="cb3-67">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check for fastp errors and then repair</span></span>
<span id="cb3-68">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--quiet</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERROR"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_PE_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.stderr<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb3-69">      </span>
<span id="cb3-70">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz</span>
<span id="cb3-71">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz</span>
<span id="cb3-72">    </span>
<span id="cb3-73">    </span>
<span id="cb3-74">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bbmap_repair}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-75">    in1=<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-76">    in2=<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-77">    out1=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.REPAIRED.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-78">    out2=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.REPAIRED.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-79">    outs=/dev/null <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-80">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.REPAIRED.stderr</span>
<span id="cb3-81">    </span>
<span id="cb3-82">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastp}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--in1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.REPAIRED.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--in2</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.REPAIRED.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--detect_adapter_for_pe</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_poly_g</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_poly_x</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-88">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--thread</span> 16 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-89">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_front1</span> 10 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-90">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_front2</span> 10 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--html</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.REPAIRED.report.html <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--json</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.REPAIRED.report.json <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-93">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--out1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.REPAIRED.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--out2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.REPAIRED.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-95">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_PE_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.REPAIRED.stderr</span>
<span id="cb3-96"> </span>
<span id="cb3-97">    </span>
<span id="cb3-98">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--quiet</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERROR"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_PE_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.REPAIRED.stderr<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb3-99">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"These </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_PE_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> samples are broken."</span></span>
<span id="cb3-100">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Just give up.  :("</span></span>
<span id="cb3-101">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-102">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb3-103">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb3-104"></span>
<span id="cb3-105">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Finished trimming:"</span></span>
<span id="cb3-106">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-107">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-108">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-109">  </span>
<span id="cb3-110">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate md5 checksums for newly trimmed files</span></span>
<span id="cb3-111">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-112">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz.md5</span>
<span id="cb3-113">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz.md5</span>
<span id="cb3-114">  </span>
<span id="cb3-115">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-116"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<pre><code>Beginning fastp trimming.
-------------------------------------------------

Finished trimming:
POC-201-TP1_R1_001.fastq.gz
POC-201-TP1_R2_001.fastq.gz

Finished trimming:
POC-201-TP2_R1_001.fastq.gz
POC-201-TP2_R2_001.fastq.gz

Finished trimming:
POC-219-TP1_R1_001.fastq.gz
POC-219-TP1_R2_001.fastq.gz

Finished trimming:
POC-219-TP2_R1_001.fastq.gz
POC-219-TP2_R2_001.fastq.gz

Finished trimming:
POC-219-TP3_R1_001.fastq.gz
POC-219-TP3_R2_001.fastq.gz

Finished trimming:
POC-219-TP4_R1_001.fastq.gz
POC-219-TP4_R2_001.fastq.gz

Finished trimming:
POC-222-TP1_R1_001.fastq.gz
POC-222-TP1_R2_001.fastq.gz

Finished trimming:
POC-222-TP3_R1_001.fastq.gz
POC-222-TP3_R2_001.fastq.gz

Finished trimming:
POC-222-TP4_R1_001.fastq.gz
POC-222-TP4_R2_001.fastq.gz

Finished trimming:
POC-255-TP1_R1_001.fastq.gz
POC-255-TP1_R2_001.fastq.gz

Finished trimming:
POC-255-TP2_R1_001.fastq.gz
POC-255-TP2_R2_001.fastq.gz

Finished trimming:
POC-255-TP3_R1_001.fastq.gz
POC-255-TP3_R2_001.fastq.gz

Finished trimming:
POC-259-TP1_R1_001.fastq.gz
POC-259-TP1_R2_001.fastq.gz

Finished trimming:
POC-259-TP2_R1_001.fastq.gz
POC-259-TP2_R2_001.fastq.gz

Finished trimming:
POC-40-TP1_R1_001.fastq.gz
POC-40-TP1_R2_001.fastq.gz

Finished trimming:
POC-40-TP2_R1_001.fastq.gz
POC-40-TP2_R2_001.fastq.gz

Finished trimming:
POC-40-TP3_R1_001.fastq.gz
POC-40-TP3_R2_001.fastq.gz

Finished trimming:
POC-40-TP4_R1_001.fastq.gz
POC-40-TP4_R2_001.fastq.gz

Finished trimming:
POC-42-TP2_R1_001.fastq.gz
POC-42-TP2_R2_001.fastq.gz

Finished trimming:
POC-42-TP4_R1_001.fastq.gz
POC-42-TP4_R2_001.fastq.gz

Finished trimming:
POC-52-TP1_R1_001.fastq.gz
POC-52-TP1_R2_001.fastq.gz

Finished trimming:
POC-52-TP2_R1_001.fastq.gz
POC-52-TP2_R2_001.fastq.gz

Finished trimming:
POC-52-TP3_R1_001.fastq.gz
POC-52-TP3_R2_001.fastq.gz

Finished trimming:
POC-52-TP4_R1_001.fastq.gz
POC-52-TP4_R2_001.fastq.gz

Finished trimming:
POC-53-TP1_R1_001.fastq.gz
POC-53-TP1_R2_001.fastq.gz

Finished trimming:
POC-53-TP2_R1_001.fastq.gz
POC-53-TP2_R2_001.fastq.gz

Finished trimming:
POC-53-TP3_R1_001.fastq.gz
POC-53-TP3_R2_001.fastq.gz

Finished trimming:
POC-53-TP4_R1_001.fastq.gz
POC-53-TP4_R2_001.fastq.gz

Finished trimming:
POC-57-TP1_R1_001.fastq.gz
POC-57-TP1_R2_001.fastq.gz

Finished trimming:
POC-57-TP2_R1_001.fastq.gz
POC-57-TP2_R2_001.fastq.gz

Finished trimming:
POC-57-TP3_R1_001.fastq.gz
POC-57-TP3_R2_001.fastq.gz

Finished trimming:
POC-57-TP4_R1_001.fastq.gz
POC-57-TP4_R2_001.fastq.gz</code></pre>
</section>
<section id="fastqc" class="level1">
<h1>4 FastQC</h1>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-5"></span>
<span id="cb5-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN FASTQC ############</span></span>
<span id="cb5-7"></span>
<span id="cb5-8"></span>
<span id="cb5-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of trimmed FastQs</span></span>
<span id="cb5-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trimmed_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(${trimmed_fastq_pattern})</span></span>
<span id="cb5-11"></span>
<span id="cb5-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pass array contents to new variable as space-delimited list</span></span>
<span id="cb5-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trimmed_fastqc_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[*]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-14"></span>
<span id="cb5-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning FastQC on trimmed reads..."</span></span>
<span id="cb5-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-17"></span>
<span id="cb5-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run FastQC</span></span>
<span id="cb5-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Do NOT quote raw_fastqc_list</span></span>
<span id="cb5-20"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastqc}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-21">--threads <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-22">--outdir <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-23">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-24"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqc_list}</span></span>
<span id="cb5-25"></span>
<span id="cb5-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC on trimmed reads complete!"</span></span>
<span id="cb5-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-28"></span>
<span id="cb5-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> FASTQC ############</span></span></code></pre></div>
<pre><code>Beginning FastQC on trimmed reads...

application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
FastQC on trimmed reads complete!</code></pre>
</section>
<section id="multiqc" class="level1">
<h1>5 MultiQC</h1>
<p>Uses <code>--cl-config "sp: { fastp: { fn: '*report.json' } }"</code> to update the MultiQC search pattern for the fastp module.</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb7-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb7-3"></span>
<span id="cb7-4"></span>
<span id="cb7-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${multiqc}</span> . <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-8">--cl-config <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sp: { fastp: { fn: '*report.json' } }"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-9">--interactive</span>
<span id="cb7-10"></span>
<span id="cb7-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove zip files</span></span>
<span id="cb7-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_fastqc.zip</span></code></pre></div>
<pre><code>  /// MultiQC 🔍 | v1.14

|           multiqc | MultiQC Version v1.27 now available!
|           multiqc | Search path : /home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/F-Ptua/output/01.00-F-Ptua-WGBS-trimming-fastp-FastQC-MultiQC
|         searching | ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 352/352  
|             fastp | Found 32 reports
|            fastqc | Found 64 reports
|           multiqc | Compressing plot data
|           multiqc | Report      : multiqc_report.html
|           multiqc | Data        : multiqc_data
|           multiqc | MultiQC complete</code></pre>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<p>Overall, trimming looks okay. Surprisingly, the 5’ ends still exhibit some variation in the sequnce contant. Additionally,, it’s disappointing to see residual polyA contamination, despite specifying <code>--trim_poly_x</code> in the <a href="https://github.com/OpenGene/fastp"><code>fastp</code></a> arguments. The polyA contamination is likely RNA carried over from the DNA isolation prep. It shouldn’t cause any issues, as RNA shouldn’t end up aligning to the bisulfite-converted genome downstream.</p>
<p>MultiQC report:</p>
<ul>
<li><a href="https://github.com/urol-e5/timeseries_molecular/blob/960d871c2d54d5c3fbdf3665a7fb4bafe68f88c7/F-Ptua/output/01.00-F-Ptua-WGBS-trimming-fastp-FastQC-MultiQC/multiqc_report.html">01.00-F-Ptua-WGBS-trimming-fastp-FastQC-MultiQC/multiqc_report.html</a> (GitHub repo)</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2025/2025-02-12-Trimming---P.tuahiniensis-WGBS-Trimming-and-QC-with-fastp-FastQC-and-MultiQC-for-E5-timeseries_molecular-Project/20250212-ptua-multiqc-plot-sequence-content.png" class="img-fluid figure-img" alt="Screenshot of trimmed MultiQC per base sequence content plot showing low C content - indicative of directional WGBS libraries"></p>
<figcaption>MultiQC screencap showing post trimming Sequence Content.</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2025/2025-02-12-Trimming---P.tuahiniensis-WGBS-Trimming-and-QC-with-fastp-FastQC-and-MultiQC-for-E5-timeseries_molecular-Project/20250212-ptua-multiqc-plot-adapter-content.png" class="img-fluid figure-img"></p>
<figcaption>MultiQC screencap showing post trimming Adapter Content with residula polyA contamination.</figcaption>
</figure>
</div>
</section>
<section id="references" class="level1">
<h1>6 REFERENCES</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-chen2023" class="csl-entry">
Chen, Shifu. 2023. “Ultrafast One-Pass FASTQ Data Preprocessing, Quality Control, and Deduplication Using Fastp.” <em>iMeta</em> 2 (2). <a href="https://doi.org/10.1002/imt2.107" class="uri">https://doi.org/10.1002/imt2.107</a>.
</div>
<div id="ref-ewels2016" class="csl-entry">
Ewels, Philip, Måns Magnusson, Sverker Lundin, and Max Käller. 2016. “MultiQC: Summarize Analysis Results for Multiple Tools and Samples in a Single Report.” <em>Bioinformatics</em> 32 (19): 3047–48. <a href="https://doi.org/10.1093/bioinformatics/btw354" class="uri">https://doi.org/10.1093/bioinformatics/btw354</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2025</category>
  <category>Porites tuahiniensis</category>
  <category>E5</category>
  <category>WGBS</category>
  <category>bisulfite sequencing</category>
  <category>FastQC</category>
  <category>MultiQC</category>
  <category>fastp</category>
  <category>trimming</category>
  <category>timeseries_molecular</category>
  <category>coral</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2025/2025-02-12-Trimming---P.tuahiniensis-WGBS-Trimming-and-QC-with-fastp-FastQC-and-MultiQC-for-E5-timeseries_molecular-Project/</guid>
  <pubDate>Wed, 12 Feb 2025 08:00:00 GMT</pubDate>
</item>
<item>
  <title>FastQC MultiQC - P.tuahiniensis Raw WGBS Renaming and FastQC MultiQC timeseries_molecular Project</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2025/2025-02-10-FastQC-MultiQC---P.tuahiniensis-Raw-WGBS-Renaming-and-FastQC-MultiQC-timeseries_molecular-Project/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>Ran FastQC and MultiQC quality checks on the <em>P.evermanni</em> raw whole genome bisulfite sequencing (WGBS) data <a href="../../../posts/2024/2024-12-30-Data-Received---Coral-E5-WGBS-Time-Series-from-Azenta-Project-30-1067895835/index.html">received 20241230</a>, as part of <a href="https://github.com/urol-e5/timeseries_molecular">urol-e5/timeseries_molecular</a> (GitHub repo).</p>
<p>Additionally, the FastQ files have been renamed to follow the format <code>&lt;colony_id&gt;-&lt;timepoint&gt;</code>. This ensures consistency and easier identification of samples throughout the analysis process.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The contents below are from markdown knitted from <a href="https://github.com/urol-e5/timeseries_molecular/blob/e05febcc9105afaf086c573368e15b7228d2cbaf/F-Ptua/code/00.20-F-Ptua-WGBS-reads-FastQC-MultiQC.Rmd"><code>00.20-F-Ptua-WGBS-reads-FastQC-MultiQC.Rmd</code></a> (commit <code>e05febc</code>).</p>
</div>
</div>
</section>
<section id="background" class="level1">
<h1>Background</h1>
<p>This Rmd file will download raw WGBS FastQs for <em>P.tuahiniensis</em> and evaluate them using <a href="https://github.com/s-andrews/FastQC">FastQC</a> and <a href="https://multiqc.info/">MultiQC</a>(Ewels et al.&nbsp;2016).</p>
</section>
<section id="create-a-bash-variables-file" class="level1">
<h1>1 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export timeseries_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export output_dir_top=${timeseries_dir}/F-Ptua/output/00.20-F-Ptua-WGBS-reads-FastQC-MultiQC'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_dir=${timeseries_dir}/F-Ptua/data/wgbs-raw-fastqs'</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_url="https://owl.fish.washington.edu/nightingales/E5-coral-time-series/30-1067895835/"'</span></span>
<span id="cb1-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Input files"</span></span>
<span id="cb1-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export metadata_file="${timeseries_dir}/M-multi-species/data/e5_DNA_Azenta_metadata.csv"'</span></span>
<span id="cb1-14"></span>
<span id="cb1-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Paths to programs"</span></span>
<span id="cb1-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastqc=/home/shared/FastQC-0.12.1/fastqc'</span></span>
<span id="cb1-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export multiqc=/home/sam/programs/mambaforge/bin/multiqc'</span></span>
<span id="cb1-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set FastQ filename patterns"</span></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export fastq_pattern='*.fastq.gz'"</span></span>
<span id="cb1-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R1_fastq_pattern='*_R1_*.fastq.gz'"</span></span>
<span id="cb1-23"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R2_fastq_pattern='*_R2_*.fastq.gz'"</span></span>
<span id="cb1-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-25"></span>
<span id="cb1-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set number of CPUs to use"</span></span>
<span id="cb1-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=40'</span></span>
<span id="cb1-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-29"></span>
<span id="cb1-30"></span>
<span id="cb1-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"## Inititalize arrays"</span></span>
<span id="cb1-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R1=()'</span></span>
<span id="cb1-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R2=()'</span></span>
<span id="cb1-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_fastqs_array=()'</span></span>
<span id="cb1-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R1_names_array=()'</span></span>
<span id="cb1-36"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R2_names_array=()'</span></span>
<span id="cb1-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-38"></span>
<span id="cb1-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Programs associative array"</span></span>
<span id="cb1-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"declare -A programs_array"</span></span>
<span id="cb1-41"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"programs_array=("</span></span>
<span id="cb1-42"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[fastqc]="${fastqc}" \'</span></span>
<span id="cb1-43"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[multiqc]="${multiqc}" \'</span></span>
<span id="cb1-44"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span></span>
<span id="cb1-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-46"></span>
<span id="cb1-47"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Print formatting"</span></span>
<span id="cb1-48"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-49"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-50"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-51"></span>
<span id="cb1-52"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export timeseries_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular
export output_dir_top=${timeseries_dir}/F-Ptua/output/00.20-F-Ptua-WGBS-reads-FastQC-MultiQC
export raw_reads_dir=${timeseries_dir}/F-Ptua/data/wgbs-raw-fastqs
export raw_reads_url="https://owl.fish.washington.edu/nightingales/E5-coral-time-series/30-1067895835/"

# Input files
export metadata_file="${timeseries_dir}/M-multi-species/data/e5_DNA_Azenta_metadata.csv"
# Paths to programs
export fastqc=/home/shared/FastQC-0.12.1/fastqc
export multiqc=/home/sam/programs/mambaforge/bin/multiqc

# Set FastQ filename patterns
export fastq_pattern='*.fastq.gz'
export R1_fastq_pattern='*_R1_*.fastq.gz'
export R2_fastq_pattern='*_R2_*.fastq.gz'

# Set number of CPUs to use
export threads=40

## Inititalize arrays
export fastq_array_R1=()
export fastq_array_R2=()
export raw_fastqs_array=()
export R1_names_array=()
export R2_names_array=()

# Programs associative array
declare -A programs_array
programs_array=(
[fastqc]="${fastqc}" \
[multiqc]="${multiqc}" \
)

# Print formatting
export line="--------------------------------------------------------"</code></pre>
</section>
<section id="download-p.tuahiniensis-wgbs-fastqs" class="level1">
<h1>2 Download <em>P.tuahiniensis</em> WGBS FastQs</h1>
<section id="inspect-metadata-file" class="level2">
<h2 class="anchored" data-anchor-id="inspect-metadata-file">2.1 Inspect metadata file</h2>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${metadata_file}</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span></span>
<span id="cb3-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">column</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span></span></code></pre></div>
<pre><code>Sample Name*  Plate         Well number  Azenta sample name  Colony ID  Timepoint  Sample Type*  Species/Strain*  Sample Buffer*    Total Amount (ng)*    Volume (µL)  Conc (ng/µL)  Purification Method*  Biosafety Level (BSL)            Method Used for Fluorescence  Method Used for Spectrophotometry  Method Used for Electrophoresis  
1             41            1            G4                  1G4        ACR-225    TP1           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  2064         80            25.8                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"
2             291-20220211  2            A3                  2A3        ACR-225    TP2           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  5064         80            63.3                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"
3             527           1            H5                  1H5        ACR-225    TP3           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  4232         80            52.9                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"
4             911           1            C6                  1C6        ACR-225    TP4           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  4488         80            56.1                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"
5             55            1            B2                  1B2        ACR-229    TP1           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  2432         80            30.4                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"
6             295           1            E3                  1E3        ACR-229    TP2           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  2760         80            34.5                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"
7             531           1            H3                  1H3        ACR-229    TP3           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  5752         80            71.9                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"
8             931           1            F7                  1F7        ACR-229    TP4           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  6008         80            75.1                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"
9             49            1            A1                  1A1        ACR-237    TP1           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  1456         80            18.2                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"</code></pre>
</section>
<section id="download-raw-wgbs-reads" class="level2">
<h2 class="anchored" data-anchor-id="download-raw-wgbs-reads">2.2 Download raw WGBS reads</h2>
<p>Reads are downloaded from <a href="https://owl.fish.washington.edu/nightingales/E5-coral-time-series/30-1067895835/" class="uri">https://owl.fish.washington.edu/nightingales/E5-coral-time-series/30-1067895835/</a></p>
<p>Since sequencing included multiple species, the code will also parse only those that are <em>P.tuahiniensis</em>.</p>
<p>The <code>--cut-dirs 3</code> command cuts the preceding directory structure (i.e.&nbsp;<code>nightingales/E5-coral-time-series/30-1067895835/</code>) so that we just end up with the reads.</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directory if it doesn't exist</span></span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span></span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create list of only P.tuahiniensis sample names</span></span>
<span id="cb5-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$9 == "Pocillopora tuahiniensis" { print $5 }'</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${timeseries_dir}</span>/M-multi-species/data/e5_DNA_Azenta_metadata.csv <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-9"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-10"></span>
<span id="cb5-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample list:"</span></span>
<span id="cb5-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_list}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-20"></span>
<span id="cb5-21"></span>
<span id="cb5-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use printf to format each item for use in wget</span></span>
<span id="cb5-23"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">formatted_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%s_*,"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_list})</span></span>
<span id="cb5-24"></span>
<span id="cb5-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove the trailing comma</span></span>
<span id="cb5-26"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">formatted_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${formatted_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-27"></span>
<span id="cb5-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output the final wget command</span></span>
<span id="cb5-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-30"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Formatted wget accept list:"</span></span>
<span id="cb5-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wget --accept=</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$formatted_list</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-36"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-38"></span>
<span id="cb5-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run wget to retrieve FastQs and MD5 files</span></span>
<span id="cb5-40"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-41">--directory-prefix <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-42">--recursive <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-43">--no-check-certificate <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-44">--continue <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-45">--cut-dirs 3 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-46">--no-host-directories <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-47">--no-parent <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-48">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-49">--accept=<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$formatted_list</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_url}</span></span>
<span id="cb5-50"></span>
<span id="cb5-51"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<pre><code>--------------------------------------------------------

Sample list:

1A11
1A2
1A4
1B12
1B7
1C1
1C10
1C11
1C12
1C3
1C4
1C5
1C7
1D4
1D5
1E1
1E10
1E12
1E2
1F11
1F12
1F2
1F4
1F8
1G1
1G12
1G3
1G7
1G8
1H1
1H10
1H4
1H7
2A1
2B2
2D3
2E3
2F1
2H1

--------------------------------------------------------


--------------------------------------------------------

Formatted wget accept list:

wget --accept="1A11_*,1A2_*,1A4_*,1B12_*,1B7_*,1C1_*,1C10_*,1C11_*,1C12_*,1C3_*,1C4_*,1C5_*,1C7_*,1D4_*,1D5_*,1E1_*,1E10_*,1E12_*,1E2_*,1F11_*,1F12_*,1F2_*,1F4_*,1F8_*,1G1_*,1G12_*,1G3_*,1G7_*,1G8_*,1H1_*,1H10_*,1H4_*,1H7_*,2A1_*,2B2_*,2D3_*,2E3_*,2F1_*,2H1_*"

--------------------------------------------------------

total 165G
-rw-r--r-- 1 sam sam 3.0G Dec 30 08:44 1A2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 08:44 1A2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.1G Dec 30 08:48 1A2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 08:48 1A2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.0G Dec 30 08:57 1A4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 08:57 1A4_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.9G Dec 30 08:59 1A4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 08:59 1A4_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.7G Dec 30 09:42 1B12_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 09:42 1B12_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.7G Dec 30 09:45 1B12_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 09:45 1B12_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 10:21 1B7_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 10:21 1B7_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 10:23 1B7_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 10:23 1B7_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.8G Dec 30 10:34 1C10_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 10:34 1C10_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.8G Dec 30 10:37 1C10_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 10:37 1C10_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.8G Dec 30 10:40 1C11_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 10:40 1C11_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.8G Dec 30 10:44 1C11_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 10:44 1C11_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.3G Dec 30 10:46 1C12_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 10:46 1C12_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.2G Dec 30 10:48 1C12_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 10:48 1C12_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.3G Dec 30 10:51 1C1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 10:51 1C1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.3G Dec 30 10:54 1C1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 10:54 1C1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 11:01 1C3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 11:01 1C3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 11:04 1C3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 11:04 1C3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.0G Dec 30 11:06 1C4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 11:06 1C4_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.0G Dec 30 11:08 1C4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 11:08 1C4_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.2G Dec 30 11:10 1C5_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 11:10 1C5_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.2G Dec 30 11:13 1C5_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 11:13 1C5_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.8G Dec 30 11:20 1C7_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 11:20 1C7_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.8G Dec 30 11:23 1C7_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 11:23 1C7_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.1G Dec 30 12:07 1D4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 12:07 1D4_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.1G Dec 30 12:10 1D4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 12:10 1D4_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.2G Dec 30 12:12 1D5_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 12:12 1D5_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.2G Dec 30 12:14 1D5_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 12:14 1D5_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.9G Dec 30 12:41 1F11_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 12:41 1F11_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.9G Dec 30 12:44 1F11_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 12:44 1F11_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.4G Dec 30 12:46 1F12_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 12:46 1F12_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.4G Dec 30 12:48 1F12_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 12:48 1F12_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 12:56 1F2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 12:56 1F2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 12:58 1F2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 12:58 1F2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.5G Dec 30 13:04 1F4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 13:04 1F4_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 13:07 1F4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 13:07 1F4_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.5G Dec 30 13:23 1F8_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 13:23 1F8_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.5G Dec 30 13:26 1F8_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 13:26 1F8_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.2G Dec 30 13:41 1G12_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 13:41 1G12_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.2G Dec 30 13:44 1G12_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 13:44 1G12_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.8G Dec 30 13:46 1G1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 13:46 1G1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.7G Dec 30 13:49 1G1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 13:49 1G1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.7G Dec 30 13:57 1G3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 13:57 1G3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.7G Dec 30 13:59 1G3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 13:59 1G3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.9G Dec 30 14:14 1G7_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 14:14 1G7_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.8G Dec 30 14:17 1G7_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 14:17 1G7_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.7G Dec 30 14:20 1G8_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 14:20 1G8_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.7G Dec 30 14:22 1G8_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 14:22 1G8_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.3G Dec 30 14:30 1H10_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 14:30 1H10_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.3G Dec 30 14:33 1H10_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 14:33 1H10_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.5G Dec 30 14:46 1H1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 14:46 1H1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.5G Dec 30 14:48 1H1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 14:48 1H1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 15:01 1H4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 15:01 1H4_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 15:04 1H4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 15:04 1H4_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.3G Dec 30 15:19 1H7_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 15:19 1H7_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.2G Dec 30 15:22 1H7_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 15:22 1H7_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.4G Dec 30 15:36 2A1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 15:36 2A1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.4G Dec 30 15:38 2A1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 15:38 2A1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.9G Dec 30 15:54 2B2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 15:54 2B2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.9G Dec 30 15:57 2B2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 15:57 2B2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.8G Dec 30 16:32 2D3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 16:32 2D3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.8G Dec 30 16:34 2D3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 16:34 2D3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 16:37 2F1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 16:37 2F1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.7G Dec 30 16:40 2F1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 16:40 2F1_R2_001.fastq.gz.md5</code></pre>
</section>
<section id="verify-raw-read-checksums" class="level2">
<h2 class="anchored" data-anchor-id="verify-raw-read-checksums">2.3 Verify raw read checksums</h2>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb7-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-5"></span>
<span id="cb7-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.md5</span>
<span id="cb7-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb7-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--check</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-9"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<pre><code>./1A2_R1_001.fastq.gz: OK
./1A2_R2_001.fastq.gz: OK
./1A4_R1_001.fastq.gz: OK
./1A4_R2_001.fastq.gz: OK
./1B12_R1_001.fastq.gz: OK
./1B12_R2_001.fastq.gz: OK
./1B7_R1_001.fastq.gz: OK
./1B7_R2_001.fastq.gz: OK
./1C10_R1_001.fastq.gz: OK
./1C10_R2_001.fastq.gz: OK
./1C11_R1_001.fastq.gz: OK
./1C11_R2_001.fastq.gz: OK
./1C12_R1_001.fastq.gz: OK
./1C12_R2_001.fastq.gz: OK
./1C1_R1_001.fastq.gz: OK
./1C1_R2_001.fastq.gz: OK
./1C3_R1_001.fastq.gz: OK
./1C3_R2_001.fastq.gz: OK
./1C4_R1_001.fastq.gz: OK
./1C4_R2_001.fastq.gz: OK
./1C5_R1_001.fastq.gz: OK
./1C5_R2_001.fastq.gz: OK
./1C7_R1_001.fastq.gz: OK
./1C7_R2_001.fastq.gz: OK
./1D4_R1_001.fastq.gz: OK
./1D4_R2_001.fastq.gz: OK
./1D5_R1_001.fastq.gz: OK
./1D5_R2_001.fastq.gz: OK
./1F11_R1_001.fastq.gz: OK
./1F11_R2_001.fastq.gz: OK
./1F12_R1_001.fastq.gz: OK
./1F12_R2_001.fastq.gz: OK
./1F2_R1_001.fastq.gz: OK
./1F2_R2_001.fastq.gz: OK
./1F4_R1_001.fastq.gz: OK
./1F4_R2_001.fastq.gz: OK
./1F8_R1_001.fastq.gz: OK
./1F8_R2_001.fastq.gz: OK
./1G12_R1_001.fastq.gz: OK
./1G12_R2_001.fastq.gz: OK
./1G1_R1_001.fastq.gz: OK
./1G1_R2_001.fastq.gz: OK
./1G3_R1_001.fastq.gz: OK
./1G3_R2_001.fastq.gz: OK
./1G7_R1_001.fastq.gz: OK
./1G7_R2_001.fastq.gz: OK
./1G8_R1_001.fastq.gz: OK
./1G8_R2_001.fastq.gz: OK
./1H10_R1_001.fastq.gz: OK
./1H10_R2_001.fastq.gz: OK
./1H1_R1_001.fastq.gz: OK
./1H1_R2_001.fastq.gz: OK
./1H4_R1_001.fastq.gz: OK
./1H4_R2_001.fastq.gz: OK
./1H7_R1_001.fastq.gz: OK
./1H7_R2_001.fastq.gz: OK
./2A1_R1_001.fastq.gz: OK
./2A1_R2_001.fastq.gz: OK
./2B2_R1_001.fastq.gz: OK
./2B2_R2_001.fastq.gz: OK
./2D3_R1_001.fastq.gz: OK
./2D3_R2_001.fastq.gz: OK
./2F1_R1_001.fastq.gz: OK
./2F1_R2_001.fastq.gz: OK</code></pre>
</section>
</section>
<section id="rename-fastqs-for-project-consistency" class="level1">
<h1>3 Rename FastQs for Project Consistency</h1>
<p>New naming format will be <code>&lt;colony_id&gt;-&lt;timepoint&gt;</code>.</p>
<p>Use of a temp file, instead of working directory from the metadata file can avoid potential issues with character/text formatting from the input CSV.</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb9-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb9-3"></span>
<span id="cb9-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-5"></span>
<span id="cb9-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create an associative array to store the mapping</span></span>
<span id="cb9-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">declare</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_to_colony_timepoint</span></span>
<span id="cb9-8"></span>
<span id="cb9-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a temporary file to store the mapping</span></span>
<span id="cb9-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">temp_mapping_file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mktemp</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb9-11"></span>
<span id="cb9-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the metadata file and populate the temporary file using awk</span></span>
<span id="cb9-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Maps Azenta sample name to colony_id and timepoint.</span></span>
<span id="cb9-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'NR &gt; 1 { print $5, $6 "-" $7 }'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$metadata_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$temp_mapping_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-15"></span>
<span id="cb9-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the temporary file and populate the associative array</span></span>
<span id="cb9-17"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">read</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Number</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">colony_timepoint</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb9-18">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_to_colony_timepoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$Number</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$colony_timepoint</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-19"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$temp_mapping_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-20"></span>
<span id="cb9-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove the temporary file</span></span>
<span id="cb9-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$temp_mapping_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-23"></span>
<span id="cb9-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print the associative array for debugging</span></span>
<span id="cb9-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number to colony_id-Timepoint mapping:"</span></span>
<span id="cb9-26"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> key <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_to_colony_timepoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb9-27">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb9-28">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$key</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> -&gt; </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${number_to_colony_timepoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$key</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-29">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb9-30"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb9-31"></span>
<span id="cb9-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Iterate over the FastQ files in the current directory</span></span>
<span id="cb9-33"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fastq_file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.fastq.gz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb9-34">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract the sample number from the filename</span></span>
<span id="cb9-35">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_number</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fastq_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-E</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s/^([0-9]+--)?([A-Za-z0-9]+).*/\2/'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb9-36">    </span>
<span id="cb9-37">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the sample number exists in the associative array</span></span>
<span id="cb9-38">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-n</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${number_to_colony_timepoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_number</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb9-39">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">new_sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${number_to_colony_timepoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_number</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-40">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">new_filename</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fastq_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-E</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"s/^([0-9]+--)?</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_number</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$new_sample_name</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb9-41">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fastq_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$new_filename</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb9-42">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mv</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fastq_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$new_filename</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-43">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Renamed </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fastq_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> to </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$new_filename</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-44">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb9-45">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No renaming needed for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fastq_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-46">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb9-47">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb9-48">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample number '</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_number</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">' not found in metadata."</span></span>
<span id="cb9-49">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Debugging: Print all keys in the associative array with quotes</span></span>
<span id="cb9-50">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Available keys in the associative array:"</span></span>
<span id="cb9-51">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> key <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_to_colony_timepoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb9-52">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$key</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'"</span></span>
<span id="cb9-53">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb9-54">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb9-55"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<pre><code>Number to colony_id-Timepoint mapping:

1B3 -&gt; SR_1-440-NA


1B2 -&gt; ACR-229-TP1


1B1 -&gt; ACR-150-TP3


1B7 -&gt; POC-40-TP3


1B6 -&gt; POR-245-TP2


1B5 -&gt; ACR-244-TP2


1B4 -&gt; ACR-244-TP4


1B9 -&gt; POR-236-TP2


1B8 -&gt; POR-69-TP1


1D5 -&gt; POC-57-TP1


1D4 -&gt; POC-52-TP3


1C1 -&gt; POC-222-TP3


1C2 -&gt; POR-83-TP4


1D7 -&gt; ACR-186-TP4


1D6 -&gt; POR-245-TP4


1C3 -&gt; POC-53-TP3


1D1 -&gt; POR-216-TP2


1B12 -&gt; POC-219-TP4


1C4 -&gt; POC-201-TP2


1C5 -&gt; POC-52-TP4


1B10 -&gt; ACR-150-TP1


1D3 -&gt; ACR-237-TP4


1C6 -&gt; ACR-225-TP4


1B11 -&gt; POR-69-TP4


1D2 -&gt; POR-260-TP1


1C7 -&gt; POC-53-TP1


1C8 -&gt; ACR-145-TP2


1C9 -&gt; ACR-237-TP3


2C3 -&gt; POR-73-TP1


1D9 -&gt; ACR-139-TP3


2C2 -&gt; ACR-145-TP3


1D8 -&gt; ACR-139-TP4


2C1 -&gt; POR-216-TP1


1E2 -&gt; POC-42-TP3


1E3 -&gt; ACR-229-TP2


1E1 -&gt; POC-259-TP4


1E6 -&gt; POR-83-TP1


1E7 -&gt; ACR-237-TP2


1E4 -&gt; POR-74-TP2


1E5 -&gt; POR-245-TP3


1E11 -&gt; POR-260-TP4


1E10 -&gt; POC-259-TP3


1E8 -&gt; POR-262-TP3


1E9 -&gt; POR-73-TP4


1E12 -&gt; POC-222-TP2


2B1 -&gt; SR_3-440B-NA


2B2 -&gt; POC-40-TP2


2B3 -&gt; POR-262-TP4


2E1 -&gt; POR-74-TP1


2E3 -&gt; POC-255-TP4


2E2 -&gt; ACR-186-TP3


1H1 -&gt; POC-57-TP4


1H3 -&gt; ACR-229-TP3


1H2 -&gt; ACR-173-TP3


2D2 -&gt; ACR-173-TP2


1H5 -&gt; ACR-225-TP3


2D3 -&gt; POC-52-TP1


1H4 -&gt; POC-201-TP1


1H7 -&gt; POC-219-TP1


1F9 -&gt; ACR-265-TP2


1F8 -&gt; POC-53-TP4


2D1 -&gt; ACR-150-TP4


1H6 -&gt; ACR-150-TP2


1H9 -&gt; ACR-173-TP1


1F7 -&gt; ACR-229-TP4


1H8 -&gt; POR-74-TP4


1F6 -&gt; POR-260-TP2


1F5 -&gt; ACR-145-TP4


1F4 -&gt; POC-255-TP1


1F3 -&gt; POR-83-TP3


1D10 -&gt; POR-69-TP2


1D11 -&gt; SR_2-84-NA


1F2 -&gt; POC-57-TP3


1D12 -&gt; POR-73-TP3


1F1 -&gt; ACR-244-TP1


2G3 -&gt; POR-74-TP3


2G2 -&gt; ACR-265-TP1


2G1 -&gt; POR-245-TP1


1G8 -&gt; POC-222-TP1


1G9 -&gt; POR-260-TP3


1G12 -&gt; POC-40-TP1


1G11 -&gt; POR-216-TP3


1G10 -&gt; POR-72-TP3


1G4 -&gt; ACR-225-TP1


1G5 -&gt; ACR-173-TP4


1G6 -&gt; POR-236-TP1


1G7 -&gt; POC-222-TP4


1G1 -&gt; POC-57-TP2


1G2 -&gt; POR-216-TP4


1G3 -&gt; POC-259-TP1


2F1 -&gt; POC-255-TP3


2F2 -&gt; POR-83-TP2


2F3 -&gt; POR-72-TP4


2A1 -&gt; POC-40-TP4


1A11 -&gt; POC-201-TP3


1A10 -&gt; ACR-139-TP1


2A3 -&gt; ACR-225-TP2


2A2 -&gt; POR-72-TP2


1A12 -&gt; ACR-186-TP2


2H2 -&gt; POR-262-TP2


2H3 -&gt; ACR-244-TP3


2H1 -&gt; POC-42-TP1


1H10 -&gt; POC-219-TP2


1A6 -&gt; ACR-265-TP3


1A7 -&gt; POR-262-TP1


1C12 -&gt; POC-52-TP2


1H11 -&gt; ACR-265-TP4


1H12 -&gt; POR-73-TP2


1C11 -&gt; POC-42-TP4


1A4 -&gt; POC-259-TP2


1C10 -&gt; POC-53-TP2


1A5 -&gt; ACR-139-TP2


1A2 -&gt; POC-219-TP3


1A3 -&gt; ACR-145-TP1


1A1 -&gt; ACR-237-TP1


1F12 -&gt; POC-255-TP2


1F10 -&gt; POR-72-TP1


1F11 -&gt; POC-42-TP2


1A8 -&gt; ACR-186-TP1


1A9 -&gt; POR-69-TP3

Renamed 1A2_R1_001.fastq.gz to POC-219-TP3_R1_001.fastq.gz
Renamed 1A2_R2_001.fastq.gz to POC-219-TP3_R2_001.fastq.gz
Renamed 1A4_R1_001.fastq.gz to POC-259-TP2_R1_001.fastq.gz
Renamed 1A4_R2_001.fastq.gz to POC-259-TP2_R2_001.fastq.gz
Renamed 1B12_R1_001.fastq.gz to POC-219-TP4_R1_001.fastq.gz
Renamed 1B12_R2_001.fastq.gz to POC-219-TP4_R2_001.fastq.gz
Renamed 1B7_R1_001.fastq.gz to POC-40-TP3_R1_001.fastq.gz
Renamed 1B7_R2_001.fastq.gz to POC-40-TP3_R2_001.fastq.gz
Renamed 1C10_R1_001.fastq.gz to POC-53-TP2_R1_001.fastq.gz
Renamed 1C10_R2_001.fastq.gz to POC-53-TP2_R2_001.fastq.gz
Renamed 1C11_R1_001.fastq.gz to POC-42-TP4_R1_001.fastq.gz
Renamed 1C11_R2_001.fastq.gz to POC-42-TP4_R2_001.fastq.gz
Renamed 1C12_R1_001.fastq.gz to POC-52-TP2_R1_001.fastq.gz
Renamed 1C12_R2_001.fastq.gz to POC-52-TP2_R2_001.fastq.gz
Renamed 1C1_R1_001.fastq.gz to POC-222-TP3_R1_001.fastq.gz
Renamed 1C1_R2_001.fastq.gz to POC-222-TP3_R2_001.fastq.gz
Renamed 1C3_R1_001.fastq.gz to POC-53-TP3_R1_001.fastq.gz
Renamed 1C3_R2_001.fastq.gz to POC-53-TP3_R2_001.fastq.gz
Renamed 1C4_R1_001.fastq.gz to POC-201-TP2_R1_001.fastq.gz
Renamed 1C4_R2_001.fastq.gz to POC-201-TP2_R2_001.fastq.gz
Renamed 1C5_R1_001.fastq.gz to POC-52-TP4_R1_001.fastq.gz
Renamed 1C5_R2_001.fastq.gz to POC-52-TP4_R2_001.fastq.gz
Renamed 1C7_R1_001.fastq.gz to POC-53-TP1_R1_001.fastq.gz
Renamed 1C7_R2_001.fastq.gz to POC-53-TP1_R2_001.fastq.gz
Renamed 1D4_R1_001.fastq.gz to POC-52-TP3_R1_001.fastq.gz
Renamed 1D4_R2_001.fastq.gz to POC-52-TP3_R2_001.fastq.gz
Renamed 1D5_R1_001.fastq.gz to POC-57-TP1_R1_001.fastq.gz
Renamed 1D5_R2_001.fastq.gz to POC-57-TP1_R2_001.fastq.gz
Renamed 1F11_R1_001.fastq.gz to POC-42-TP2_R1_001.fastq.gz
Renamed 1F11_R2_001.fastq.gz to POC-42-TP2_R2_001.fastq.gz
Renamed 1F12_R1_001.fastq.gz to POC-255-TP2_R1_001.fastq.gz
Renamed 1F12_R2_001.fastq.gz to POC-255-TP2_R2_001.fastq.gz
Renamed 1F2_R1_001.fastq.gz to POC-57-TP3_R1_001.fastq.gz
Renamed 1F2_R2_001.fastq.gz to POC-57-TP3_R2_001.fastq.gz
Renamed 1F4_R1_001.fastq.gz to POC-255-TP1_R1_001.fastq.gz
Renamed 1F4_R2_001.fastq.gz to POC-255-TP1_R2_001.fastq.gz
Renamed 1F8_R1_001.fastq.gz to POC-53-TP4_R1_001.fastq.gz
Renamed 1F8_R2_001.fastq.gz to POC-53-TP4_R2_001.fastq.gz
Renamed 1G12_R1_001.fastq.gz to POC-40-TP1_R1_001.fastq.gz
Renamed 1G12_R2_001.fastq.gz to POC-40-TP1_R2_001.fastq.gz
Renamed 1G1_R1_001.fastq.gz to POC-57-TP2_R1_001.fastq.gz
Renamed 1G1_R2_001.fastq.gz to POC-57-TP2_R2_001.fastq.gz
Renamed 1G3_R1_001.fastq.gz to POC-259-TP1_R1_001.fastq.gz
Renamed 1G3_R2_001.fastq.gz to POC-259-TP1_R2_001.fastq.gz
Renamed 1G7_R1_001.fastq.gz to POC-222-TP4_R1_001.fastq.gz
Renamed 1G7_R2_001.fastq.gz to POC-222-TP4_R2_001.fastq.gz
Renamed 1G8_R1_001.fastq.gz to POC-222-TP1_R1_001.fastq.gz
Renamed 1G8_R2_001.fastq.gz to POC-222-TP1_R2_001.fastq.gz
Renamed 1H10_R1_001.fastq.gz to POC-219-TP2_R1_001.fastq.gz
Renamed 1H10_R2_001.fastq.gz to POC-219-TP2_R2_001.fastq.gz
Renamed 1H1_R1_001.fastq.gz to POC-57-TP4_R1_001.fastq.gz
Renamed 1H1_R2_001.fastq.gz to POC-57-TP4_R2_001.fastq.gz
Renamed 1H4_R1_001.fastq.gz to POC-201-TP1_R1_001.fastq.gz
Renamed 1H4_R2_001.fastq.gz to POC-201-TP1_R2_001.fastq.gz
Renamed 1H7_R1_001.fastq.gz to POC-219-TP1_R1_001.fastq.gz
Renamed 1H7_R2_001.fastq.gz to POC-219-TP1_R2_001.fastq.gz
Renamed 2A1_R1_001.fastq.gz to POC-40-TP4_R1_001.fastq.gz
Renamed 2A1_R2_001.fastq.gz to POC-40-TP4_R2_001.fastq.gz
Renamed 2B2_R1_001.fastq.gz to POC-40-TP2_R1_001.fastq.gz
Renamed 2B2_R2_001.fastq.gz to POC-40-TP2_R2_001.fastq.gz
Renamed 2D3_R1_001.fastq.gz to POC-52-TP1_R1_001.fastq.gz
Renamed 2D3_R2_001.fastq.gz to POC-52-TP1_R2_001.fastq.gz
Renamed 2F1_R1_001.fastq.gz to POC-255-TP3_R1_001.fastq.gz
Renamed 2F1_R2_001.fastq.gz to POC-255-TP3_R2_001.fastq.gz</code></pre>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb11-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb11-3"></span>
<span id="cb11-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb11-5"></span>
<span id="cb11-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create an associative array to store the mapping</span></span>
<span id="cb11-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">declare</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_to_colony_timepoint</span></span>
<span id="cb11-8"></span>
<span id="cb11-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a temporary file to store the mapping</span></span>
<span id="cb11-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">temp_mapping_file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mktemp</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb11-11"></span>
<span id="cb11-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the metadata file and populate the temporary file using awk</span></span>
<span id="cb11-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Maps Azenta sample name to colony_id and timepoint.</span></span>
<span id="cb11-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'NR &gt; 1 { print $5, $6 "-" $7 }'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$metadata_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$temp_mapping_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb11-15"></span>
<span id="cb11-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the temporary file and populate the associative array</span></span>
<span id="cb11-17"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">read</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Number</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">colony_timepoint</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb11-18">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_to_colony_timepoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$Number</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$colony_timepoint</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb11-19"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$temp_mapping_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb11-20"></span>
<span id="cb11-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove the temporary file</span></span>
<span id="cb11-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$temp_mapping_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb11-23"></span>
<span id="cb11-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print the associative array for debugging</span></span>
<span id="cb11-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number to colony_id-Timepoint mapping:"</span></span>
<span id="cb11-26"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> key <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_to_colony_timepoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb11-27">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb11-28">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$key</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> -&gt; </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${number_to_colony_timepoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$key</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb11-29">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb11-30"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb11-31"></span>
<span id="cb11-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Iterate over the FastQ files in the current directory</span></span>
<span id="cb11-33"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fastq_file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.fastq.gz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb11-34">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract the sample number from the filename</span></span>
<span id="cb11-35">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_number</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fastq_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-E</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s/^([0-9]+--)?([A-Za-z0-9]+).*/\2/'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb11-36">    </span>
<span id="cb11-37">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the sample number exists in the associative array</span></span>
<span id="cb11-38">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-n</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${number_to_colony_timepoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_number</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb11-39">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">new_sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${number_to_colony_timepoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_number</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb11-40">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">new_filename</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fastq_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-E</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"s/^([0-9]+--)?</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_number</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$new_sample_name</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb11-41">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fastq_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$new_filename</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb11-42">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mv</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fastq_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$new_filename</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb11-43">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Renamed </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fastq_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> to </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$new_filename</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb11-44">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb11-45">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No renaming needed for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fastq_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb11-46">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb11-47">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb11-48">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample number '</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_number</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">' not found in metadata."</span></span>
<span id="cb11-49">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Debugging: Print all keys in the associative array with quotes</span></span>
<span id="cb11-50">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Available keys in the associative array:"</span></span>
<span id="cb11-51">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> key <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_to_colony_timepoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb11-52">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$key</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'"</span></span>
<span id="cb11-53">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb11-54">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb11-55"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<pre><code>Number to colony_id-Timepoint mapping:

1B3 -&gt; SR_1-440-NA


1B2 -&gt; ACR-229-TP1


1B1 -&gt; ACR-150-TP3


1B7 -&gt; POC-40-TP3


1B6 -&gt; POR-245-TP2


1B5 -&gt; ACR-244-TP2


1B4 -&gt; ACR-244-TP4


1B9 -&gt; POR-236-TP2


1B8 -&gt; POR-69-TP1


1D5 -&gt; POC-57-TP1


1D4 -&gt; POC-52-TP3


1C1 -&gt; POC-222-TP3


1C2 -&gt; POR-83-TP4


1D7 -&gt; ACR-186-TP4


1D6 -&gt; POR-245-TP4


1C3 -&gt; POC-53-TP3


1D1 -&gt; POR-216-TP2


1B12 -&gt; POC-219-TP4


1C4 -&gt; POC-201-TP2


1C5 -&gt; POC-52-TP4


1B10 -&gt; ACR-150-TP1


1D3 -&gt; ACR-237-TP4


1C6 -&gt; ACR-225-TP4


1B11 -&gt; POR-69-TP4


1D2 -&gt; POR-260-TP1


1C7 -&gt; POC-53-TP1


1C8 -&gt; ACR-145-TP2


1C9 -&gt; ACR-237-TP3


2C3 -&gt; POR-73-TP1


1D9 -&gt; ACR-139-TP3


2C2 -&gt; ACR-145-TP3


1D8 -&gt; ACR-139-TP4


2C1 -&gt; POR-216-TP1


1E2 -&gt; POC-42-TP3


1E3 -&gt; ACR-229-TP2


1E1 -&gt; POC-259-TP4


1E6 -&gt; POR-83-TP1


1E7 -&gt; ACR-237-TP2


1E4 -&gt; POR-74-TP2


1E5 -&gt; POR-245-TP3


1E11 -&gt; POR-260-TP4


1E10 -&gt; POC-259-TP3


1E8 -&gt; POR-262-TP3


1E9 -&gt; POR-73-TP4


1E12 -&gt; POC-222-TP2


2B1 -&gt; SR_3-440B-NA


2B2 -&gt; POC-40-TP2


2B3 -&gt; POR-262-TP4


2E1 -&gt; POR-74-TP1


2E3 -&gt; POC-255-TP4


2E2 -&gt; ACR-186-TP3


1H1 -&gt; POC-57-TP4


1H3 -&gt; ACR-229-TP3


1H2 -&gt; ACR-173-TP3


2D2 -&gt; ACR-173-TP2


1H5 -&gt; ACR-225-TP3


2D3 -&gt; POC-52-TP1


1H4 -&gt; POC-201-TP1


1H7 -&gt; POC-219-TP1


1F9 -&gt; ACR-265-TP2


1F8 -&gt; POC-53-TP4


2D1 -&gt; ACR-150-TP4


1H6 -&gt; ACR-150-TP2


1H9 -&gt; ACR-173-TP1


1F7 -&gt; ACR-229-TP4


1H8 -&gt; POR-74-TP4


1F6 -&gt; POR-260-TP2


1F5 -&gt; ACR-145-TP4


1F4 -&gt; POC-255-TP1


1F3 -&gt; POR-83-TP3


1D10 -&gt; POR-69-TP2


1D11 -&gt; SR_2-84-NA


1F2 -&gt; POC-57-TP3


1D12 -&gt; POR-73-TP3


1F1 -&gt; ACR-244-TP1


2G3 -&gt; POR-74-TP3


2G2 -&gt; ACR-265-TP1


2G1 -&gt; POR-245-TP1


1G8 -&gt; POC-222-TP1


1G9 -&gt; POR-260-TP3


1G12 -&gt; POC-40-TP1


1G11 -&gt; POR-216-TP3


1G10 -&gt; POR-72-TP3


1G4 -&gt; ACR-225-TP1


1G5 -&gt; ACR-173-TP4


1G6 -&gt; POR-236-TP1


1G7 -&gt; POC-222-TP4


1G1 -&gt; POC-57-TP2


1G2 -&gt; POR-216-TP4


1G3 -&gt; POC-259-TP1


2F1 -&gt; POC-255-TP3


2F2 -&gt; POR-83-TP2


2F3 -&gt; POR-72-TP4


2A1 -&gt; POC-40-TP4


1A11 -&gt; POC-201-TP3


1A10 -&gt; ACR-139-TP1


2A3 -&gt; ACR-225-TP2


2A2 -&gt; POR-72-TP2


1A12 -&gt; ACR-186-TP2


2H2 -&gt; POR-262-TP2


2H3 -&gt; ACR-244-TP3


2H1 -&gt; POC-42-TP1


1H10 -&gt; POC-219-TP2


1A6 -&gt; ACR-265-TP3


1A7 -&gt; POR-262-TP1


1C12 -&gt; POC-52-TP2


1H11 -&gt; ACR-265-TP4


1H12 -&gt; POR-73-TP2


1C11 -&gt; POC-42-TP4


1A4 -&gt; POC-259-TP2


1C10 -&gt; POC-53-TP2


1A5 -&gt; ACR-139-TP2


1A2 -&gt; POC-219-TP3


1A3 -&gt; ACR-145-TP1


1A1 -&gt; ACR-237-TP1


1F12 -&gt; POC-255-TP2


1F10 -&gt; POR-72-TP1


1F11 -&gt; POC-42-TP2


1A8 -&gt; ACR-186-TP1


1A9 -&gt; POR-69-TP3

Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'
Sample number 'POC' not found in metadata.
Available keys in the associative array:
'1B3'
'1B2'
'1B1'
'1B7'
'1B6'
'1B5'
'1B4'
'1B9'
'1B8'
'1D5'
'1D4'
'1C1'
'1C2'
'1D7'
'1D6'
'1C3'
'1D1'
'1B12'
'1C4'
'1C5'
'1B10'
'1D3'
'1C6'
'1B11'
'1D2'
'1C7'
'1C8'
'1C9'
'2C3'
'1D9'
'2C2'
'1D8'
'2C1'
'1E2'
'1E3'
'1E1'
'1E6'
'1E7'
'1E4'
'1E5'
'1E11'
'1E10'
'1E8'
'1E9'
'1E12'
'2B1'
'2B2'
'2B3'
'2E1'
'2E3'
'2E2'
'1H1'
'1H3'
'1H2'
'2D2'
'1H5'
'2D3'
'1H4'
'1H7'
'1F9'
'1F8'
'2D1'
'1H6'
'1H9'
'1F7'
'1H8'
'1F6'
'1F5'
'1F4'
'1F3'
'1D10'
'1D11'
'1F2'
'1D12'
'1F1'
'2G3'
'2G2'
'2G1'
'1G8'
'1G9'
'1G12'
'1G11'
'1G10'
'1G4'
'1G5'
'1G6'
'1G7'
'1G1'
'1G2'
'1G3'
'2F1'
'2F2'
'2F3'
'2A1'
'1A11'
'1A10'
'2A3'
'2A2'
'1A12'
'2H2'
'2H3'
'2H1'
'1H10'
'1A6'
'1A7'
'1C12'
'1H11'
'1H12'
'1C11'
'1A4'
'1C10'
'1A5'
'1A2'
'1A3'
'1A1'
'1F12'
'1F10'
'1F11'
'1A8'
'1A9'</code></pre>
</section>
<section id="fastqcmultiqc-on-raw-reads" class="level1">
<h1>4 FastQC/MultiQC on raw reads</h1>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb13-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb13-3"></span>
<span id="cb13-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN FASTQC ############</span></span>
<span id="cb13-5"></span>
<span id="cb13-6"></span>
<span id="cb13-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of trimmed FastQs</span></span>
<span id="cb13-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">raw_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(${raw_reads_dir}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_pattern})</span></span>
<span id="cb13-9"></span>
<span id="cb13-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pass array contents to new variable as space-delimited list</span></span>
<span id="cb13-11"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">raw_fastqc_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[*]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb13-12"></span>
<span id="cb13-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning FastQC on raw reads..."</span></span>
<span id="cb13-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb13-15"></span>
<span id="cb13-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run FastQC</span></span>
<span id="cb13-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Do NOT quote raw_fastqc_list</span></span>
<span id="cb13-18"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>fastqc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-19">--threads <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-20">--outdir <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-21">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-22"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_list}</span></span>
<span id="cb13-23"></span>
<span id="cb13-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC on raw reads complete!"</span></span>
<span id="cb13-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb13-26"></span>
<span id="cb13-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> FASTQC ############</span></span>
<span id="cb13-28"></span>
<span id="cb13-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN MULTIQC ############</span></span>
<span id="cb13-30"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning MultiQC on raw FastQC..."</span></span>
<span id="cb13-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb13-32"></span>
<span id="cb13-33"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>multiqc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-34"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-35">--interactive <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-36">-o <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span></span>
<span id="cb13-37"></span>
<span id="cb13-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb13-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MultiQC on raw FastQs complete."</span></span>
<span id="cb13-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb13-41"></span>
<span id="cb13-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> MULTIQC ############</span></span>
<span id="cb13-43"></span>
<span id="cb13-44"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Removing FastQC zip files."</span></span>
<span id="cb13-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb13-46"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.zip</span>
<span id="cb13-47"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC zip files removed."</span></span>
<span id="cb13-48"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb13-49"></span>
<span id="cb13-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># View directory contents</span></span>
<span id="cb13-51"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span></span></code></pre></div>
<pre><code>Beginning FastQC on raw reads...

application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
FastQC on raw reads complete!

Beginning MultiQC on raw FastQC...


  /// MultiQC 🔍 | v1.14

|           multiqc | MultiQC Version v1.27 now available!
|           multiqc | Search path : /home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/F-Ptua/data/wgbs-raw-fastqs
|         searching | ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 256/256  
|            fastqc | Found 64 reports
|           multiqc | Compressing plot data
|           multiqc | Report      : ../data/wgbs-raw-fastqs/multiqc_report.html
|           multiqc | Data        : ../data/wgbs-raw-fastqs/multiqc_data
|           multiqc | MultiQC complete

MultiQC on raw FastQs complete.

Removing FastQC zip files.

FastQC zip files removed.

total 165G
-rw-r--r-- 1 sam sam   56 Dec 30 08:44 1A2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 08:48 1A2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 08:57 1A4_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 08:59 1A4_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 09:42 1B12_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 09:45 1B12_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 10:21 1B7_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 10:23 1B7_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 10:34 1C10_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 10:37 1C10_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 10:40 1C11_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 10:44 1C11_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 10:46 1C12_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 10:48 1C12_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 10:51 1C1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 10:54 1C1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 11:01 1C3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 11:04 1C3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 11:06 1C4_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 11:08 1C4_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 11:10 1C5_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 11:13 1C5_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 11:20 1C7_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 11:23 1C7_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 12:07 1D4_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 12:10 1D4_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 12:12 1D5_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 12:14 1D5_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 12:41 1F11_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 12:44 1F11_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 12:46 1F12_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 12:48 1F12_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 12:56 1F2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 12:58 1F2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 13:04 1F4_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 13:07 1F4_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 13:23 1F8_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 13:26 1F8_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 13:41 1G12_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 13:44 1G12_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 13:46 1G1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 13:49 1G1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 13:57 1G3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 13:59 1G3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 14:14 1G7_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 14:17 1G7_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 14:20 1G8_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 14:22 1G8_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 14:30 1H10_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 14:33 1H10_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 14:46 1H1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 14:48 1H1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 15:01 1H4_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 15:04 1H4_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 15:19 1H7_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 15:22 1H7_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 15:36 2A1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 15:38 2A1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 15:54 2B2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 15:57 2B2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 16:32 2D3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 16:34 2D3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 16:37 2F1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 16:40 2F1_R2_001.fastq.gz.md5
drwxr-xr-x 2 sam sam 4.0K Feb 11 12:58 multiqc_data
-rw-r--r-- 1 sam sam 2.0M Feb 11 12:58 multiqc_report.html
-rw-r--r-- 1 sam sam 586K Feb 11 12:42 POC-201-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 15:01 POC-201-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 605K Feb 11 12:42 POC-201-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 15:04 POC-201-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 588K Feb 11 12:37 POC-201-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.0G Dec 30 11:06 POC-201-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 606K Feb 11 12:37 POC-201-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.0G Dec 30 11:08 POC-201-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 587K Feb 11 12:39 POC-219-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.3G Dec 30 15:19 POC-219-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 608K Feb 11 12:39 POC-219-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.2G Dec 30 15:22 POC-219-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 588K Feb 11 12:46 POC-219-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 3.3G Dec 30 14:30 POC-219-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 609K Feb 11 12:46 POC-219-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 3.3G Dec 30 14:33 POC-219-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 594K Feb 11 12:45 POC-219-TP3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 3.0G Dec 30 08:44 POC-219-TP3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 617K Feb 11 12:45 POC-219-TP3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 3.1G Dec 30 08:48 POC-219-TP3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 587K Feb 11 12:42 POC-219-TP4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.7G Dec 30 09:42 POC-219-TP4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 609K Feb 11 12:42 POC-219-TP4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.7G Dec 30 09:45 POC-219-TP4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 583K Feb 11 12:43 POC-222-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.7G Dec 30 14:20 POC-222-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 608K Feb 11 12:43 POC-222-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.7G Dec 30 14:22 POC-222-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 588K Feb 11 12:45 POC-222-TP3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 3.3G Dec 30 10:51 POC-222-TP3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 606K Feb 11 12:46 POC-222-TP3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 3.3G Dec 30 10:54 POC-222-TP3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 589K Feb 11 12:44 POC-222-TP4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.9G Dec 30 14:14 POC-222-TP4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 610K Feb 11 12:44 POC-222-TP4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.8G Dec 30 14:17 POC-222-TP4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 585K Feb 11 12:41 POC-255-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.5G Dec 30 13:04 POC-255-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 608K Feb 11 12:41 POC-255-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 13:07 POC-255-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 590K Feb 11 12:40 POC-255-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.4G Dec 30 12:46 POC-255-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 610K Feb 11 12:41 POC-255-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.4G Dec 30 12:48 POC-255-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 598K Feb 11 12:43 POC-255-TP3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 16:37 POC-255-TP3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 603K Feb 11 12:44 POC-255-TP3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.7G Dec 30 16:40 POC-255-TP3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 586K Feb 11 12:43 POC-259-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.7G Dec 30 13:57 POC-259-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 602K Feb 11 12:43 POC-259-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.7G Dec 30 13:59 POC-259-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 583K Feb 11 12:44 POC-259-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 3.0G Dec 30 08:57 POC-259-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 605K Feb 11 12:44 POC-259-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.9G Dec 30 08:59 POC-259-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 586K Feb 11 12:39 POC-40-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.2G Dec 30 13:41 POC-40-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 606K Feb 11 12:39 POC-40-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.2G Dec 30 13:44 POC-40-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 580K Feb 11 12:44 POC-40-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.9G Dec 30 15:54 POC-40-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 585K Feb 11 12:45 POC-40-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.9G Dec 30 15:57 POC-40-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 584K Feb 11 12:42 POC-40-TP3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 10:21 POC-40-TP3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 606K Feb 11 12:42 POC-40-TP3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 10:23 POC-40-TP3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 577K Feb 11 12:42 POC-40-TP4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.4G Dec 30 15:36 POC-40-TP4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 589K Feb 11 12:42 POC-40-TP4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.4G Dec 30 15:38 POC-40-TP4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 587K Feb 11 12:44 POC-42-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.9G Dec 30 12:41 POC-42-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 606K Feb 11 12:43 POC-42-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.9G Dec 30 12:44 POC-42-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 583K Feb 11 12:44 POC-42-TP4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.8G Dec 30 10:40 POC-42-TP4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 605K Feb 11 12:44 POC-42-TP4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.8G Dec 30 10:44 POC-42-TP4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 582K Feb 11 12:50 POC-52-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 1.8G Dec 30 16:32 POC-52-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 593K Feb 11 12:52 POC-52-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 1.8G Dec 30 16:34 POC-52-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 580K Feb 11 12:51 POC-52-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.3G Dec 30 10:46 POC-52-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 607K Feb 11 12:52 POC-52-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.2G Dec 30 10:48 POC-52-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 585K Feb 11 12:57 POC-52-TP3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 3.1G Dec 30 12:07 POC-52-TP3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 607K Feb 11 12:57 POC-52-TP3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 3.1G Dec 30 12:10 POC-52-TP3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 589K Feb 11 12:54 POC-52-TP4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.2G Dec 30 11:10 POC-52-TP4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 611K Feb 11 12:54 POC-52-TP4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.2G Dec 30 11:13 POC-52-TP4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 586K Feb 11 12:57 POC-53-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.8G Dec 30 11:20 POC-53-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 610K Feb 11 12:57 POC-53-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.8G Dec 30 11:23 POC-53-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 587K Feb 11 12:56 POC-53-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.8G Dec 30 10:34 POC-53-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 606K Feb 11 12:56 POC-53-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.8G Dec 30 10:37 POC-53-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 586K Feb 11 12:57 POC-53-TP3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 11:01 POC-53-TP3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 607K Feb 11 12:57 POC-53-TP3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 11:04 POC-53-TP3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 588K Feb 11 12:56 POC-53-TP4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.5G Dec 30 13:23 POC-53-TP4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 610K Feb 11 12:56 POC-53-TP4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.5G Dec 30 13:26 POC-53-TP4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 587K Feb 11 12:55 POC-57-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.2G Dec 30 12:12 POC-57-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 611K Feb 11 12:55 POC-57-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.2G Dec 30 12:14 POC-57-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 587K Feb 11 12:57 POC-57-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.8G Dec 30 13:46 POC-57-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 607K Feb 11 12:57 POC-57-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.7G Dec 30 13:49 POC-57-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 588K Feb 11 12:57 POC-57-TP3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 12:56 POC-57-TP3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 609K Feb 11 12:57 POC-57-TP3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 12:58 POC-57-TP3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 588K Feb 11 12:57 POC-57-TP4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.5G Dec 30 14:46 POC-57-TP4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 612K Feb 11 12:58 POC-57-TP4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.5G Dec 30 14:48 POC-57-TP4_R2_001.fastq.gz</code></pre>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<p>MultiQC report (HTML):</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/F-Ptua/data/wgbs-raw-fastqs/multiqc_report.html">F-Ptua/data/wgbs-raw-fastqs/multiqc_report.html</a></li>
</ul>
<p>Overall, sequencing looks pretty good. The “Per Base Sequence Content” analysis by <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/"><code>FastQC</code></a> suggests these libraries are considered <em>directional</em>, plus confirmation by Azenta that libraries were constructed using <a href="https://www.neb.com/en-us/products/e7120-nebnext-enzymatic-methyl-seq-kit">NEBNext® Enzymatic Methyl-seq Kit</a> which generates directional libraries.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2025/2025-02-10-FastQC-MultiQC---P.tuahiniensis-Raw-WGBS-Renaming-and-FastQC-MultiQC-timeseries_molecular-Project/20250210-ptua-multiqc-plot-sequence-content.png" class="img-fluid figure-img" alt="Screenshot of MultiQC per base sequence content plot showing low C content - indicative of directional WGBS libraries"></p>
<figcaption>Screenshot of MultiQC per base sequence content plot showing low C content - indicative of directional WGBS libraries</figcaption>
</figure>
</div>
</section>
<section id="references" class="level1">
<h1>REFERENCES</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ewels2016" class="csl-entry">
Ewels, Philip, Måns Magnusson, Sverker Lundin, and Max Käller. 2016. “MultiQC: Summarize Analysis Results for Multiple Tools and Samples in a Single Report.” <em>Bioinformatics</em> 32 (19): 3047–48. <a href="https://doi.org/10.1093/bioinformatics/btw354" class="uri">https://doi.org/10.1093/bioinformatics/btw354</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2025</category>
  <category>Pocillopora tuahiniensis</category>
  <category>E5</category>
  <category>WGBS</category>
  <category>bisulfite sequencing</category>
  <category>FastQC</category>
  <category>MultiQC</category>
  <category>timeseries_molecular</category>
  <category>coral</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2025/2025-02-10-FastQC-MultiQC---P.tuahiniensis-Raw-WGBS-Renaming-and-FastQC-MultiQC-timeseries_molecular-Project/</guid>
  <pubDate>Mon, 10 Feb 2025 08:00:00 GMT</pubDate>
</item>
<item>
  <title>FastQC MultiQC - P.evermanni Raw WGBS Renaming and FastQC MultiQC E5 timeseries_molecular Project</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2025/2025-02-10-FastQC-MultiQC---P.evermanni-Raw-WGBS-Renaming-and-FastQC-MultiQC-E5-timeseries_molecular-Project/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>Ran FastQC and MultiQC quality checks on the <em>P.evermanni</em> raw whole genome bisulfite sequencing (WGBS) data <a href="../../../posts/2024/2024-12-30-Data-Received---Coral-E5-WGBS-Time-Series-from-Azenta-Project-30-1067895835/index.html">received 20241230</a>, as part of <a href="https://github.com/urol-e5/timeseries_molecular">urol-e5/timeseries_molecular</a> (GitHub repo).</p>
<p>Additionally, the FastQ files have been renamed to follow the format <code>&lt;colony_id&gt;-&lt;timepoint&gt;</code>. This ensures consistency and easier identification of samples throughout the analysis process.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The contents below are from markdown knitted from <a href="https://github.com/urol-e5/timeseries_molecular/blob/e05febcc9105afaf086c573368e15b7228d2cbaf/E-Peve/code/00.20-E-Peve-WGBS-reads-FastQC-MultiQC.Rmd"><code>00.20-E-Peve-WGBS-reads-FastQC-MultiQC.Rmd</code></a> (commit <code>e05febc</code>).</p>
</div>
</div>
</section>
<section id="background" class="level1">
<h1>Background</h1>
<p>This Rmd file will download raw WGBS FastQs for <em>P.evermanni</em> and evaluate them using <a href="https://github.com/s-andrews/FastQC">FastQC</a> and <a href="https://multiqc.info/">MultiQC</a>(Ewels et al.&nbsp;2016).</p>
</section>
<section id="create-a-bash-variables-file" class="level1">
<h1>1 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export timeseries_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export output_dir_top=${timeseries_dir}/E-Peve/output/00.20-E-Peve-WGBS-reads-FastQC-MultiQC'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_dir=${timeseries_dir}/E-Peve/data/wgbs-raw-fastqs'</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_url="https://owl.fish.washington.edu/nightingales/E5-coral-time-series/30-1067895835/"'</span></span>
<span id="cb1-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Input files"</span></span>
<span id="cb1-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export metadata_file="${timeseries_dir}/M-multi-species/data/e5_DNA_Azenta_metadata.csv"'</span></span>
<span id="cb1-14"></span>
<span id="cb1-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Paths to programs"</span></span>
<span id="cb1-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastqc=/home/shared/FastQC-0.12.1/fastqc'</span></span>
<span id="cb1-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export multiqc=/home/sam/programs/mambaforge/bin/multiqc'</span></span>
<span id="cb1-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set FastQ filename patterns"</span></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export fastq_pattern='*.fastq.gz'"</span></span>
<span id="cb1-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R1_fastq_pattern='*_R1_*.fastq.gz'"</span></span>
<span id="cb1-23"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R2_fastq_pattern='*_R2_*.fastq.gz'"</span></span>
<span id="cb1-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-25"></span>
<span id="cb1-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set number of CPUs to use"</span></span>
<span id="cb1-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=40'</span></span>
<span id="cb1-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-29"></span>
<span id="cb1-30"></span>
<span id="cb1-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"## Inititalize arrays"</span></span>
<span id="cb1-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R1=()'</span></span>
<span id="cb1-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R2=()'</span></span>
<span id="cb1-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_fastqs_array=()'</span></span>
<span id="cb1-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R1_names_array=()'</span></span>
<span id="cb1-36"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R2_names_array=()'</span></span>
<span id="cb1-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-38"></span>
<span id="cb1-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Programs associative array"</span></span>
<span id="cb1-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"declare -A programs_array"</span></span>
<span id="cb1-41"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"programs_array=("</span></span>
<span id="cb1-42"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[fastqc]="${fastqc}" \'</span></span>
<span id="cb1-43"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[multiqc]="${multiqc}" \'</span></span>
<span id="cb1-44"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span></span>
<span id="cb1-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-46"></span>
<span id="cb1-47"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Print formatting"</span></span>
<span id="cb1-48"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-49"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-50"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-51"></span>
<span id="cb1-52"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export timeseries_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular
export output_dir_top=${timeseries_dir}/E-Peve/output/00.20-E-Peve-WGBS-reads-FastQC-MultiQC
export raw_reads_dir=${timeseries_dir}/E-Peve/data/wgbs-raw-fastqs
export raw_reads_url="https://owl.fish.washington.edu/nightingales/E5-coral-time-series/30-1067895835/"

# Input files
export metadata_file="${timeseries_dir}/M-multi-species/data/e5_DNA_Azenta_metadata.csv"
# Paths to programs
export fastqc=/home/shared/FastQC-0.12.1/fastqc
export multiqc=/home/sam/programs/mambaforge/bin/multiqc

# Set FastQ filename patterns
export fastq_pattern='*.fastq.gz'
export R1_fastq_pattern='*_R1_*.fastq.gz'
export R2_fastq_pattern='*_R2_*.fastq.gz'

# Set number of CPUs to use
export threads=40

## Inititalize arrays
export fastq_array_R1=()
export fastq_array_R2=()
export raw_fastqs_array=()
export R1_names_array=()
export R2_names_array=()

# Programs associative array
declare -A programs_array
programs_array=(
[fastqc]="${fastqc}" \
[multiqc]="${multiqc}" \
)

# Print formatting
export line="--------------------------------------------------------"</code></pre>
</section>
<section id="download-p.evermanni-wgbs-fastqs" class="level1">
<h1>2 Download <em>P.evermanni</em> WGBS FastQs</h1>
<section id="inspect-metadata-file" class="level2">
<h2 class="anchored" data-anchor-id="inspect-metadata-file">2.1 Inspect metadata file</h2>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${metadata_file}</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span></span>
<span id="cb3-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">column</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span></span></code></pre></div>
<pre><code>Sample Name*  Plate         Well number  Azenta sample name  Colony ID  Timepoint  Sample Type*  Species/Strain*  Sample Buffer*    Total Amount (ng)*    Volume (µL)  Conc (ng/µL)  Purification Method*  Biosafety Level (BSL)            Method Used for Fluorescence  Method Used for Spectrophotometry  Method Used for Electrophoresis  
1             41            1            G4                  1G4        ACR-225    TP1           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  2064         80            25.8                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"
2             291-20220211  2            A3                  2A3        ACR-225    TP2           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  5064         80            63.3                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"
3             527           1            H5                  1H5        ACR-225    TP3           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  4232         80            52.9                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"
4             911           1            C6                  1C6        ACR-225    TP4           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  4488         80            56.1                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"
5             55            1            B2                  1B2        ACR-229    TP1           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  2432         80            30.4                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"
6             295           1            E3                  1E3        ACR-229    TP2           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  2760         80            34.5                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"
7             531           1            H3                  1H3        ACR-229    TP3           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  5752         80            71.9                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"
8             931           1            F7                  1F7        ACR-229    TP4           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  6008         80            75.1                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"
9             49            1            A1                  1A1        ACR-237    TP1           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  1456         80            18.2                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"</code></pre>
</section>
<section id="download-raw-wgbs-reads" class="level2">
<h2 class="anchored" data-anchor-id="download-raw-wgbs-reads">2.2 Download raw WGBS reads</h2>
<p>Reads are downloaded from <a href="https://owl.fish.washington.edu/nightingales/E5-coral-time-series/30-1067895835/" class="uri">https://owl.fish.washington.edu/nightingales/E5-coral-time-series/30-1067895835/</a></p>
<p>Since sequencing included multiple species, the code will also parse only those that are <em>P.evermanni</em>.</p>
<p>Some filenames are preceeded by <code>&lt;sample_number&gt;--</code> for some reason. This formatting is limited to only samples in <code>E</code> wells, so the code below uses that aspect to retrieve those samples as well.</p>
<p>The <code>--cut-dirs 3</code> command cuts the preceding directory structure (i.e.&nbsp;<code>nightingales/E5-coral-time-series/30-1067895835/</code>) so that we just end up with the reads.</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directory if it doesn't exist</span></span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span></span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create list of only P.evermanni sample names</span></span>
<span id="cb5-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Some samples names are preceded by the Sample Number for some reason,</span></span>
<span id="cb5-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># so this handles that formatting.</span></span>
<span id="cb5-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$11 == "Porites evermanni" { if ($9 ~ /E/) { print $8 "--" $9 } else { print $9 } }'</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${timeseries_dir}</span>/M-multi-species/data/30-1067895835-WGBS-sample-submission-form.csv <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-11"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-12"></span>
<span id="cb5-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample list:"</span></span>
<span id="cb5-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_list}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-22"></span>
<span id="cb5-23"></span>
<span id="cb5-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use printf to format each item for use in wget</span></span>
<span id="cb5-25"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">formatted_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%s_*,"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_list})</span></span>
<span id="cb5-26"></span>
<span id="cb5-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove the trailing comma</span></span>
<span id="cb5-28"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">formatted_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${formatted_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-29"></span>
<span id="cb5-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output the final wget command</span></span>
<span id="cb5-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Formatted wget accept list:"</span></span>
<span id="cb5-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-36"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wget --accept=</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$formatted_list</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-40"></span>
<span id="cb5-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run wget to retrieve FastQs and MD5 files</span></span>
<span id="cb5-42"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-43">--directory-prefix <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-44">--recursive <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-45">--no-check-certificate <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-46">--continue <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-47">--cut-dirs 3 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-48">--no-host-directories <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-49">--no-parent <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-50">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-51">--accept=<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$formatted_list</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_url}</span></span>
<span id="cb5-52"></span>
<span id="cb5-53"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<pre><code>--------------------------------------------------------

Sample list:

109--1E9
110--2E1
111--1E4
114--1E6
1A7
1A9
1B11
1B6
1B8
1B9
1C2
1D1
1D10
1D12
1D2
1D6
1F10
1F3
1F6
1G10
1G11
1G2
1G6
1G9
1H12
1H8
2A2
2B3
2C1
2C3
2F2
2F3
2G1
2G3
2H2
88--1E5
93--1E11
96--1E8

--------------------------------------------------------


--------------------------------------------------------

Formatted wget accept list:

wget --accept="109--1E9_*,110--2E1_*,111--1E4_*,114--1E6_*,1A7_*,1A9_*,1B11_*,1B6_*,1B8_*,1B9_*,1C2_*,1D1_*,1D10_*,1D12_*,1D2_*,1D6_*,1F10_*,1F3_*,1F6_*,1G10_*,1G11_*,1G2_*,1G6_*,1G9_*,1H12_*,1H8_*,2A2_*,2B3_*,2C1_*,2C3_*,2F2_*,2F3_*,2G1_*,2G3_*,2H2_*,88--1E5_*,93--1E11_*,96--1E8_*"

--------------------------------------------------------

total 172G
-rw-r--r-- 1 sam sam 2.0G Dec 30 08:07 110--2E1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Dec 30 08:07 110--2E1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.0G Dec 30 08:09 110--2E1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Dec 30 08:09 110--2E1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.0G Dec 30 08:12 111--1E4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Dec 30 08:12 111--1E4_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.9G Dec 30 08:15 111--1E4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Dec 30 08:15 111--1E4_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.1G Dec 30 08:17 114--1E6_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Dec 30 08:17 114--1E6_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.0G Dec 30 08:19 114--1E6_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Dec 30 08:19 114--1E6_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.7G Dec 30 09:12 1A7_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 09:12 1A7_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 09:15 1A7_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 09:15 1A7_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.0G Dec 30 09:24 1A9_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 09:24 1A9_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.9G Dec 30 09:28 1A9_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 09:28 1A9_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.4G Dec 30 09:38 1B11_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 09:38 1B11_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.4G Dec 30 09:40 1B11_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 09:40 1B11_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.3G Dec 30 10:15 1B6_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 10:15 1B6_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.3G Dec 30 10:18 1B6_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 10:18 1B6_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.9G Dec 30 10:25 1B8_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 10:25 1B8_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.9G Dec 30 10:27 1B8_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 10:27 1B8_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.5G Dec 30 10:29 1B9_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 10:29 1B9_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.5G Dec 30 10:32 1B9_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 10:32 1B9_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.4G Dec 30 10:57 1C2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 10:57 1C2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.4G Dec 30 10:59 1C2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 10:59 1C2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.1G Dec 30 11:36 1D10_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 11:36 1D10_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.1G Dec 30 11:38 1D10_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 11:38 1D10_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.4G Dec 30 11:46 1D12_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 11:46 1D12_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.4G Dec 30 11:48 1D12_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 11:48 1D12_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.0G Dec 30 11:51 1D1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 11:51 1D1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.9G Dec 30 11:54 1D1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 11:54 1D1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.4G Dec 30 11:56 1D2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 11:56 1D2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.4G Dec 30 11:58 1D2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 11:58 1D2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.5G Dec 30 12:16 1D6_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 12:16 1D6_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.5G Dec 30 12:19 1D6_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 12:19 1D6_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.4G Dec 30 12:36 1F10_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 12:36 1F10_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.4G Dec 30 12:38 1F10_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 12:38 1F10_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.0G Dec 30 13:00 1F3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 13:00 1F3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.0G Dec 30 13:02 1F3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 13:02 1F3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.1G Dec 30 13:15 1F6_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 13:15 1F6_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.1G Dec 30 13:17 1F6_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 13:17 1F6_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.3G Dec 30 13:32 1G10_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 13:32 1G10_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.2G Dec 30 13:34 1G10_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 13:34 1G10_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.9G Dec 30 13:37 1G11_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 13:37 1G11_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.9G Dec 30 13:39 1G11_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 13:39 1G11_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.8G Dec 30 13:51 1G2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 13:51 1G2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.8G Dec 30 13:54 1G2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 13:54 1G2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.7G Dec 30 14:10 1G6_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 14:10 1G6_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.7G Dec 30 14:12 1G6_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 14:12 1G6_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.2G Dec 30 14:24 1G9_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 14:24 1G9_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.2G Dec 30 14:26 1G9_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 14:26 1G9_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.9G Dec 30 14:40 1H12_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 14:40 1H12_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.0G Dec 30 14:43 1H12_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 14:43 1H12_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.4G Dec 30 15:24 1H8_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 15:24 1H8_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.4G Dec 30 15:27 1H8_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 15:27 1H8_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.2G Dec 30 15:41 2A2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 15:41 2A2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.2G Dec 30 15:43 2A2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 15:43 2A2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.8G Dec 30 15:59 2B3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 15:59 2B3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.9G Dec 30 16:03 2B3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 16:03 2B3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.1G Dec 30 16:05 2C1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 16:05 2C1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.1G Dec 30 16:08 2C1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 16:08 2C1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 16:17 2C3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 16:17 2C3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 16:20 2C3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 16:20 2C3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.5G Dec 30 16:43 2F2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 16:43 2F2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 16:46 2F2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 16:46 2F2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.4G Dec 30 16:49 2F3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 16:49 2F3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.4G Dec 30 16:51 2F3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 16:51 2F3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 16:54 2G1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 16:54 2G1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 16:57 2G1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 16:57 2G1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.9G Dec 30 17:05 2G3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 17:05 2G3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.9G Dec 30 17:07 2G3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 17:07 2G3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.8G Dec 30 17:17 2H2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 17:17 2H2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.8G Dec 30 17:20 2H2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 17:20 2H2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.8G Dec 30 18:09 88--1E5_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Dec 30 18:09 88--1E5_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.7G Dec 30 18:13 88--1E5_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Dec 30 18:13 88--1E5_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 18:16 93--1E11_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Dec 30 18:16 93--1E11_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.5G Dec 30 18:18 93--1E11_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Dec 30 18:18 93--1E11_R2_001.fastq.gz.md5</code></pre>
</section>
<section id="verify-raw-read-checksums" class="level2">
<h2 class="anchored" data-anchor-id="verify-raw-read-checksums">2.3 Verify raw read checksums</h2>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb7-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-5"></span>
<span id="cb7-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.md5</span>
<span id="cb7-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb7-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--check</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-9"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<pre><code>./110--2E1_R1_001.fastq.gz: OK
./110--2E1_R2_001.fastq.gz: OK
./111--1E4_R1_001.fastq.gz: OK
./111--1E4_R2_001.fastq.gz: OK
./114--1E6_R1_001.fastq.gz: OK
./114--1E6_R2_001.fastq.gz: OK
./1A7_R1_001.fastq.gz: OK
./1A7_R2_001.fastq.gz: OK
./1A9_R1_001.fastq.gz: OK
./1A9_R2_001.fastq.gz: OK
./1B11_R1_001.fastq.gz: OK
./1B11_R2_001.fastq.gz: OK
./1B6_R1_001.fastq.gz: OK
./1B6_R2_001.fastq.gz: OK
./1B8_R1_001.fastq.gz: OK
./1B8_R2_001.fastq.gz: OK
./1B9_R1_001.fastq.gz: OK
./1B9_R2_001.fastq.gz: OK
./1C2_R1_001.fastq.gz: OK
./1C2_R2_001.fastq.gz: OK
./1D10_R1_001.fastq.gz: OK
./1D10_R2_001.fastq.gz: OK
./1D12_R1_001.fastq.gz: OK
./1D12_R2_001.fastq.gz: OK
./1D1_R1_001.fastq.gz: OK
./1D1_R2_001.fastq.gz: OK
./1D2_R1_001.fastq.gz: OK
./1D2_R2_001.fastq.gz: OK
./1D6_R1_001.fastq.gz: OK
./1D6_R2_001.fastq.gz: OK
./1F10_R1_001.fastq.gz: OK
./1F10_R2_001.fastq.gz: OK
./1F3_R1_001.fastq.gz: OK
./1F3_R2_001.fastq.gz: OK
./1F6_R1_001.fastq.gz: OK
./1F6_R2_001.fastq.gz: OK
./1G10_R1_001.fastq.gz: OK
./1G10_R2_001.fastq.gz: OK
./1G11_R1_001.fastq.gz: OK
./1G11_R2_001.fastq.gz: OK
./1G2_R1_001.fastq.gz: OK
./1G2_R2_001.fastq.gz: OK
./1G6_R1_001.fastq.gz: OK
./1G6_R2_001.fastq.gz: OK
./1G9_R1_001.fastq.gz: OK
./1G9_R2_001.fastq.gz: OK
./1H12_R1_001.fastq.gz: OK
./1H12_R2_001.fastq.gz: OK
./1H8_R1_001.fastq.gz: OK
./1H8_R2_001.fastq.gz: OK
./2A2_R1_001.fastq.gz: OK
./2A2_R2_001.fastq.gz: OK
./2B3_R1_001.fastq.gz: OK
./2B3_R2_001.fastq.gz: OK
./2C1_R1_001.fastq.gz: OK
./2C1_R2_001.fastq.gz: OK
./2C3_R1_001.fastq.gz: OK
./2C3_R2_001.fastq.gz: OK
./2F2_R1_001.fastq.gz: OK
./2F2_R2_001.fastq.gz: OK
./2F3_R1_001.fastq.gz: OK
./2F3_R2_001.fastq.gz: OK
./2G1_R1_001.fastq.gz: OK
./2G1_R2_001.fastq.gz: OK
./2G3_R1_001.fastq.gz: OK
./2G3_R2_001.fastq.gz: OK
./2H2_R1_001.fastq.gz: OK
./2H2_R2_001.fastq.gz: OK
./88--1E5_R1_001.fastq.gz: OK
./88--1E5_R2_001.fastq.gz: OK
./93--1E11_R1_001.fastq.gz: OK
./93--1E11_R2_001.fastq.gz: OK</code></pre>
</section>
</section>
<section id="rename-fastqs-for-project-consistency" class="level1">
<h1>3 Rename FastQs for Project Consistency</h1>
<p>New naming format will be <code>&lt;colony_id&gt;-&lt;timepoint&gt;</code>.</p>
<p>Use of a temp file, instead of working directory from the metadata file can avoid potential issues with character/text formatting from the input CSV.</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb9-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb9-3"></span>
<span id="cb9-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-5"></span>
<span id="cb9-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create an associative array to store the mapping</span></span>
<span id="cb9-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">declare</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_to_colony_timepoint</span></span>
<span id="cb9-8"></span>
<span id="cb9-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a temporary file to store the mapping</span></span>
<span id="cb9-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">temp_mapping_file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mktemp</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb9-11"></span>
<span id="cb9-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the metadata file and populate the temporary file using awk</span></span>
<span id="cb9-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Maps Azenta sample name to colony_id and timepoint.</span></span>
<span id="cb9-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'NR &gt; 1 { print $5, $6 "-" $7 }'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$metadata_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$temp_mapping_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-15"></span>
<span id="cb9-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the temporary file and populate the associative array</span></span>
<span id="cb9-17"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">read</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Number</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">colony_timepoint</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb9-18">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_to_colony_timepoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$Number</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$colony_timepoint</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-19"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$temp_mapping_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-20"></span>
<span id="cb9-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove the temporary file</span></span>
<span id="cb9-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$temp_mapping_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-23"></span>
<span id="cb9-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print the associative array for debugging</span></span>
<span id="cb9-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number to colony_id-Timepoint mapping:"</span></span>
<span id="cb9-26"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> key <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_to_colony_timepoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb9-27">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb9-28">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$key</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> -&gt; </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${number_to_colony_timepoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$key</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-29">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb9-30"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb9-31"></span>
<span id="cb9-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Iterate over the FastQ files in the current directory</span></span>
<span id="cb9-33"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fastq_file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.fastq.gz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb9-34">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract the sample number from the filename</span></span>
<span id="cb9-35">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_number</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fastq_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-E</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s/^([0-9]+--)?([A-Za-z0-9]+).*/\2/'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb9-36">    </span>
<span id="cb9-37">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the sample number exists in the associative array</span></span>
<span id="cb9-38">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-n</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${number_to_colony_timepoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_number</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb9-39">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">new_sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${number_to_colony_timepoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_number</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-40">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">new_filename</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fastq_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-E</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"s/^([0-9]+--)?</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_number</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$new_sample_name</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb9-41">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fastq_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$new_filename</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb9-42">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mv</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fastq_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$new_filename</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-43">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Renamed </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fastq_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> to </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$new_filename</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-44">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb9-45">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No renaming needed for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fastq_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-46">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb9-47">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb9-48">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample number '</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_number</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">' not found in metadata."</span></span>
<span id="cb9-49">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Debugging: Print all keys in the associative array with quotes</span></span>
<span id="cb9-50">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Available keys in the associative array:"</span></span>
<span id="cb9-51">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> key <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_to_colony_timepoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb9-52">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$key</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'"</span></span>
<span id="cb9-53">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb9-54">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb9-55"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<pre><code>Number to colony_id-Timepoint mapping:

1B3 -&gt; SR_1-440-NA


1B2 -&gt; ACR-229-TP1


1B1 -&gt; ACR-150-TP3


1B7 -&gt; POC-40-TP3


1B6 -&gt; POR-245-TP2


1B5 -&gt; ACR-244-TP2


1B4 -&gt; ACR-244-TP4


1B9 -&gt; POR-236-TP2


1B8 -&gt; POR-69-TP1


1D5 -&gt; POC-57-TP1


1D4 -&gt; POC-52-TP3


1C1 -&gt; POC-222-TP3


1C2 -&gt; POR-83-TP4


1D7 -&gt; ACR-186-TP4


1D6 -&gt; POR-245-TP4


1C3 -&gt; POC-53-TP3


1D1 -&gt; POR-216-TP2


1B12 -&gt; POC-219-TP4


1C4 -&gt; POC-201-TP2


1C5 -&gt; POC-52-TP4


1B10 -&gt; ACR-150-TP1


1D3 -&gt; ACR-237-TP4


1C6 -&gt; ACR-225-TP4


1B11 -&gt; POR-69-TP4


1D2 -&gt; POR-260-TP1


1C7 -&gt; POC-53-TP1


1C8 -&gt; ACR-145-TP2


1C9 -&gt; ACR-237-TP3


2C3 -&gt; POR-73-TP1


1D9 -&gt; ACR-139-TP3


2C2 -&gt; ACR-145-TP3


1D8 -&gt; ACR-139-TP4


2C1 -&gt; POR-216-TP1


1E2 -&gt; POC-42-TP3


1E3 -&gt; ACR-229-TP2


1E1 -&gt; POC-259-TP4


1E6 -&gt; POR-83-TP1


1E7 -&gt; ACR-237-TP2


1E4 -&gt; POR-74-TP2


1E5 -&gt; POR-245-TP3


1E11 -&gt; POR-260-TP4


1E10 -&gt; POC-259-TP3


1E8 -&gt; POR-262-TP3


1E9 -&gt; POR-73-TP4


1E12 -&gt; POC-222-TP2


2B1 -&gt; SR_3-440B-NA


2B2 -&gt; POC-40-TP2


2B3 -&gt; POR-262-TP4


2E1 -&gt; POR-74-TP1


2E3 -&gt; POC-255-TP4


2E2 -&gt; ACR-186-TP3


1H1 -&gt; POC-57-TP4


1H3 -&gt; ACR-229-TP3


1H2 -&gt; ACR-173-TP3


2D2 -&gt; ACR-173-TP2


1H5 -&gt; ACR-225-TP3


2D3 -&gt; POC-52-TP1


1H4 -&gt; POC-201-TP1


1H7 -&gt; POC-219-TP1


1F9 -&gt; ACR-265-TP2


1F8 -&gt; POC-53-TP4


2D1 -&gt; ACR-150-TP4


1H6 -&gt; ACR-150-TP2


1H9 -&gt; ACR-173-TP1


1F7 -&gt; ACR-229-TP4


1H8 -&gt; POR-74-TP4


1F6 -&gt; POR-260-TP2


1F5 -&gt; ACR-145-TP4


1F4 -&gt; POC-255-TP1


1F3 -&gt; POR-83-TP3


1D10 -&gt; POR-69-TP2


1D11 -&gt; SR_2-84-NA


1F2 -&gt; POC-57-TP3


1D12 -&gt; POR-73-TP3


1F1 -&gt; ACR-244-TP1


2G3 -&gt; POR-74-TP3


2G2 -&gt; ACR-265-TP1


2G1 -&gt; POR-245-TP1


1G8 -&gt; POC-222-TP1


1G9 -&gt; POR-260-TP3


1G12 -&gt; POC-40-TP1


1G11 -&gt; POR-216-TP3


1G10 -&gt; POR-72-TP3


1G4 -&gt; ACR-225-TP1


1G5 -&gt; ACR-173-TP4


1G6 -&gt; POR-236-TP1


1G7 -&gt; POC-222-TP4


1G1 -&gt; POC-57-TP2


1G2 -&gt; POR-216-TP4


1G3 -&gt; POC-259-TP1


2F1 -&gt; POC-255-TP3


2F2 -&gt; POR-83-TP2


2F3 -&gt; POR-72-TP4


2A1 -&gt; POC-40-TP4


1A11 -&gt; POC-201-TP3


1A10 -&gt; ACR-139-TP1


2A3 -&gt; ACR-225-TP2


2A2 -&gt; POR-72-TP2


1A12 -&gt; ACR-186-TP2


2H2 -&gt; POR-262-TP2


2H3 -&gt; ACR-244-TP3


2H1 -&gt; POC-42-TP1


1H10 -&gt; POC-219-TP2


1A6 -&gt; ACR-265-TP3


1A7 -&gt; POR-262-TP1


1C12 -&gt; POC-52-TP2


1H11 -&gt; ACR-265-TP4


1H12 -&gt; POR-73-TP2


1C11 -&gt; POC-42-TP4


1A4 -&gt; POC-259-TP2


1C10 -&gt; POC-53-TP2


1A5 -&gt; ACR-139-TP2


1A2 -&gt; POC-219-TP3


1A3 -&gt; ACR-145-TP1


1A1 -&gt; ACR-237-TP1


1F12 -&gt; POC-255-TP2


1F10 -&gt; POR-72-TP1


1F11 -&gt; POC-42-TP2


1A8 -&gt; ACR-186-TP1


1A9 -&gt; POR-69-TP3

Renamed 110--2E1_R1_001.fastq.gz to POR-74-TP1_R1_001.fastq.gz
Renamed 110--2E1_R2_001.fastq.gz to POR-74-TP1_R2_001.fastq.gz
Renamed 111--1E4_R1_001.fastq.gz to POR-74-TP2_R1_001.fastq.gz
Renamed 111--1E4_R2_001.fastq.gz to POR-74-TP2_R2_001.fastq.gz
Renamed 114--1E6_R1_001.fastq.gz to POR-83-TP1_R1_001.fastq.gz
Renamed 114--1E6_R2_001.fastq.gz to POR-83-TP1_R2_001.fastq.gz
Renamed 1A7_R1_001.fastq.gz to POR-262-TP1_R1_001.fastq.gz
Renamed 1A7_R2_001.fastq.gz to POR-262-TP1_R2_001.fastq.gz
Renamed 1A9_R1_001.fastq.gz to POR-69-TP3_R1_001.fastq.gz
Renamed 1A9_R2_001.fastq.gz to POR-69-TP3_R2_001.fastq.gz
Renamed 1B11_R1_001.fastq.gz to POR-69-TP4_R1_001.fastq.gz
Renamed 1B11_R2_001.fastq.gz to POR-69-TP4_R2_001.fastq.gz
Renamed 1B6_R1_001.fastq.gz to POR-245-TP2_R1_001.fastq.gz
Renamed 1B6_R2_001.fastq.gz to POR-245-TP2_R2_001.fastq.gz
Renamed 1B8_R1_001.fastq.gz to POR-69-TP1_R1_001.fastq.gz
Renamed 1B8_R2_001.fastq.gz to POR-69-TP1_R2_001.fastq.gz
Renamed 1B9_R1_001.fastq.gz to POR-236-TP2_R1_001.fastq.gz
Renamed 1B9_R2_001.fastq.gz to POR-236-TP2_R2_001.fastq.gz
Renamed 1C2_R1_001.fastq.gz to POR-83-TP4_R1_001.fastq.gz
Renamed 1C2_R2_001.fastq.gz to POR-83-TP4_R2_001.fastq.gz
Renamed 1D10_R1_001.fastq.gz to POR-69-TP2_R1_001.fastq.gz
Renamed 1D10_R2_001.fastq.gz to POR-69-TP2_R2_001.fastq.gz
Renamed 1D12_R1_001.fastq.gz to POR-73-TP3_R1_001.fastq.gz
Renamed 1D12_R2_001.fastq.gz to POR-73-TP3_R2_001.fastq.gz
Renamed 1D1_R1_001.fastq.gz to POR-216-TP2_R1_001.fastq.gz
Renamed 1D1_R2_001.fastq.gz to POR-216-TP2_R2_001.fastq.gz
Renamed 1D2_R1_001.fastq.gz to POR-260-TP1_R1_001.fastq.gz
Renamed 1D2_R2_001.fastq.gz to POR-260-TP1_R2_001.fastq.gz
Renamed 1D6_R1_001.fastq.gz to POR-245-TP4_R1_001.fastq.gz
Renamed 1D6_R2_001.fastq.gz to POR-245-TP4_R2_001.fastq.gz
Renamed 1F10_R1_001.fastq.gz to POR-72-TP1_R1_001.fastq.gz
Renamed 1F10_R2_001.fastq.gz to POR-72-TP1_R2_001.fastq.gz
Renamed 1F3_R1_001.fastq.gz to POR-83-TP3_R1_001.fastq.gz
Renamed 1F3_R2_001.fastq.gz to POR-83-TP3_R2_001.fastq.gz
Renamed 1F6_R1_001.fastq.gz to POR-260-TP2_R1_001.fastq.gz
Renamed 1F6_R2_001.fastq.gz to POR-260-TP2_R2_001.fastq.gz
Renamed 1G10_R1_001.fastq.gz to POR-72-TP3_R1_001.fastq.gz
Renamed 1G10_R2_001.fastq.gz to POR-72-TP3_R2_001.fastq.gz
Renamed 1G11_R1_001.fastq.gz to POR-216-TP3_R1_001.fastq.gz
Renamed 1G11_R2_001.fastq.gz to POR-216-TP3_R2_001.fastq.gz
Renamed 1G2_R1_001.fastq.gz to POR-216-TP4_R1_001.fastq.gz
Renamed 1G2_R2_001.fastq.gz to POR-216-TP4_R2_001.fastq.gz
Renamed 1G6_R1_001.fastq.gz to POR-236-TP1_R1_001.fastq.gz
Renamed 1G6_R2_001.fastq.gz to POR-236-TP1_R2_001.fastq.gz
Renamed 1G9_R1_001.fastq.gz to POR-260-TP3_R1_001.fastq.gz
Renamed 1G9_R2_001.fastq.gz to POR-260-TP3_R2_001.fastq.gz
Renamed 1H12_R1_001.fastq.gz to POR-73-TP2_R1_001.fastq.gz
Renamed 1H12_R2_001.fastq.gz to POR-73-TP2_R2_001.fastq.gz
Renamed 1H8_R1_001.fastq.gz to POR-74-TP4_R1_001.fastq.gz
Renamed 1H8_R2_001.fastq.gz to POR-74-TP4_R2_001.fastq.gz
Renamed 2A2_R1_001.fastq.gz to POR-72-TP2_R1_001.fastq.gz
Renamed 2A2_R2_001.fastq.gz to POR-72-TP2_R2_001.fastq.gz
Renamed 2B3_R1_001.fastq.gz to POR-262-TP4_R1_001.fastq.gz
Renamed 2B3_R2_001.fastq.gz to POR-262-TP4_R2_001.fastq.gz
Renamed 2C1_R1_001.fastq.gz to POR-216-TP1_R1_001.fastq.gz
Renamed 2C1_R2_001.fastq.gz to POR-216-TP1_R2_001.fastq.gz
Renamed 2C3_R1_001.fastq.gz to POR-73-TP1_R1_001.fastq.gz
Renamed 2C3_R2_001.fastq.gz to POR-73-TP1_R2_001.fastq.gz
Renamed 2F2_R1_001.fastq.gz to POR-83-TP2_R1_001.fastq.gz
Renamed 2F2_R2_001.fastq.gz to POR-83-TP2_R2_001.fastq.gz
Renamed 2F3_R1_001.fastq.gz to POR-72-TP4_R1_001.fastq.gz
Renamed 2F3_R2_001.fastq.gz to POR-72-TP4_R2_001.fastq.gz
Renamed 2G1_R1_001.fastq.gz to POR-245-TP1_R1_001.fastq.gz
Renamed 2G1_R2_001.fastq.gz to POR-245-TP1_R2_001.fastq.gz
Renamed 2G3_R1_001.fastq.gz to POR-74-TP3_R1_001.fastq.gz
Renamed 2G3_R2_001.fastq.gz to POR-74-TP3_R2_001.fastq.gz
Renamed 2H2_R1_001.fastq.gz to POR-262-TP2_R1_001.fastq.gz
Renamed 2H2_R2_001.fastq.gz to POR-262-TP2_R2_001.fastq.gz
Renamed 88--1E5_R1_001.fastq.gz to POR-245-TP3_R1_001.fastq.gz
Renamed 88--1E5_R2_001.fastq.gz to POR-245-TP3_R2_001.fastq.gz
Renamed 93--1E11_R1_001.fastq.gz to POR-260-TP4_R1_001.fastq.gz
Renamed 93--1E11_R2_001.fastq.gz to POR-260-TP4_R2_001.fastq.gz</code></pre>
</section>
<section id="fastqcmultiqc-on-raw-reads" class="level1">
<h1>4 FastQC/MultiQC on raw reads</h1>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb11-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb11-3"></span>
<span id="cb11-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN FASTQC ############</span></span>
<span id="cb11-5"></span>
<span id="cb11-6"></span>
<span id="cb11-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of trimmed FastQs</span></span>
<span id="cb11-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">raw_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(${raw_reads_dir}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_pattern})</span></span>
<span id="cb11-9"></span>
<span id="cb11-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pass array contents to new variable as space-delimited list</span></span>
<span id="cb11-11"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">raw_fastqc_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[*]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb11-12"></span>
<span id="cb11-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning FastQC on raw reads..."</span></span>
<span id="cb11-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb11-15"></span>
<span id="cb11-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run FastQC</span></span>
<span id="cb11-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Do NOT quote raw_fastqc_list</span></span>
<span id="cb11-18"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>fastqc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-19">--threads <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-20">--outdir <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-21">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-22"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_list}</span></span>
<span id="cb11-23"></span>
<span id="cb11-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC on raw reads complete!"</span></span>
<span id="cb11-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb11-26"></span>
<span id="cb11-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> FASTQC ############</span></span>
<span id="cb11-28"></span>
<span id="cb11-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN MULTIQC ############</span></span>
<span id="cb11-30"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning MultiQC on raw FastQC..."</span></span>
<span id="cb11-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb11-32"></span>
<span id="cb11-33"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>multiqc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-34"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-35">--interactive <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-36">-o <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span></span>
<span id="cb11-37"></span>
<span id="cb11-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb11-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MultiQC on raw FastQs complete."</span></span>
<span id="cb11-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb11-41"></span>
<span id="cb11-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> MULTIQC ############</span></span>
<span id="cb11-43"></span>
<span id="cb11-44"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Removing FastQC zip files."</span></span>
<span id="cb11-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb11-46"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.zip</span>
<span id="cb11-47"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC zip files removed."</span></span>
<span id="cb11-48"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb11-49"></span>
<span id="cb11-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># View directory contents</span></span>
<span id="cb11-51"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span></span></code></pre></div>
<pre><code>Beginning FastQC on raw reads...

application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
FastQC on raw reads complete!

Beginning MultiQC on raw FastQC...


  /// MultiQC 🔍 | v1.14

|           multiqc | MultiQC Version v1.27 now available!
|           multiqc | Search path : /home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/wgbs-raw-fastqs
|         searching | ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 288/288  
|            fastqc | Found 72 reports
|           multiqc | Compressing plot data
|           multiqc | Report      : ../data/wgbs-raw-fastqs/multiqc_report.html
|           multiqc | Data        : ../data/wgbs-raw-fastqs/multiqc_data
|           multiqc | MultiQC complete

MultiQC on raw FastQs complete.

Removing FastQC zip files.

FastQC zip files removed.

total 172G
-rw-r--r-- 1 sam sam   61 Dec 30 08:07 110--2E1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   61 Dec 30 08:09 110--2E1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   61 Dec 30 08:12 111--1E4_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   61 Dec 30 08:15 111--1E4_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   61 Dec 30 08:17 114--1E6_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   61 Dec 30 08:19 114--1E6_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 09:12 1A7_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 09:15 1A7_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 09:24 1A9_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 09:28 1A9_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 09:38 1B11_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 09:40 1B11_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 10:15 1B6_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 10:18 1B6_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 10:25 1B8_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 10:27 1B8_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 10:29 1B9_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 10:32 1B9_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 10:57 1C2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 10:59 1C2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 11:36 1D10_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 11:38 1D10_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 11:46 1D12_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 11:48 1D12_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 11:51 1D1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 11:54 1D1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 11:56 1D2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 11:58 1D2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 12:16 1D6_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 12:19 1D6_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 12:36 1F10_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 12:38 1F10_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 13:00 1F3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 13:02 1F3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 13:15 1F6_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 13:17 1F6_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 13:32 1G10_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 13:34 1G10_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 13:37 1G11_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 13:39 1G11_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 13:51 1G2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 13:54 1G2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 14:10 1G6_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 14:12 1G6_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 14:24 1G9_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 14:26 1G9_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 14:40 1H12_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 14:43 1H12_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 15:24 1H8_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 15:27 1H8_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 15:41 2A2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 15:43 2A2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 15:59 2B3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 16:03 2B3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 16:05 2C1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 16:08 2C1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 16:17 2C3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 16:20 2C3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 16:43 2F2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 16:46 2F2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 16:49 2F3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 16:51 2F3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 16:54 2G1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 16:57 2G1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 17:05 2G3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 17:07 2G3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 17:17 2H2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 17:20 2H2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   60 Dec 30 18:09 88--1E5_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   60 Dec 30 18:13 88--1E5_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   61 Dec 30 18:16 93--1E11_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   61 Dec 30 18:18 93--1E11_R2_001.fastq.gz.md5
drwxr-xr-x 2 sam sam 4.0K Feb 11 09:35 multiqc_data
-rw-r--r-- 1 sam sam 2.1M Feb 11 09:35 multiqc_report.html
-rw-r--r-- 1 sam sam 587K Feb 11 09:25 POR-216-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.1G Dec 30 16:05 POR-216-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 593K Feb 11 09:23 POR-216-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.1G Dec 30 16:08 POR-216-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 590K Feb 11 09:28 POR-216-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 3.0G Dec 30 11:51 POR-216-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 609K Feb 11 09:28 POR-216-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.9G Dec 30 11:54 POR-216-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 587K Feb 11 09:28 POR-216-TP3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.9G Dec 30 13:37 POR-216-TP3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 605K Feb 11 09:28 POR-216-TP3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.9G Dec 30 13:39 POR-216-TP3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 586K Feb 11 09:25 POR-216-TP4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.8G Dec 30 13:51 POR-216-TP4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 604K Feb 11 09:28 POR-216-TP4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.8G Dec 30 13:54 POR-216-TP4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 588K Feb 11 09:23 POR-236-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 1.7G Dec 30 14:10 POR-236-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 609K Feb 11 09:22 POR-236-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 1.7G Dec 30 14:12 POR-236-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 587K Feb 11 09:26 POR-236-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.5G Dec 30 10:29 POR-236-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 606K Feb 11 09:27 POR-236-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.5G Dec 30 10:32 POR-236-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 585K Feb 11 09:27 POR-245-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 16:54 POR-245-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 592K Feb 11 09:24 POR-245-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 16:57 POR-245-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 588K Feb 11 09:24 POR-245-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.3G Dec 30 10:15 POR-245-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 608K Feb 11 09:25 POR-245-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.3G Dec 30 10:18 POR-245-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 584K Feb 11 09:28 POR-245-TP3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.8G Dec 30 18:09 POR-245-TP3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 601K Feb 11 09:25 POR-245-TP3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.7G Dec 30 18:13 POR-245-TP3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 585K Feb 11 09:25 POR-245-TP4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.5G Dec 30 12:16 POR-245-TP4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 602K Feb 11 09:27 POR-245-TP4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.5G Dec 30 12:19 POR-245-TP4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 582K Feb 11 09:24 POR-260-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.4G Dec 30 11:56 POR-260-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 599K Feb 11 09:25 POR-260-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.4G Dec 30 11:58 POR-260-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 589K Feb 11 09:23 POR-260-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.1G Dec 30 13:15 POR-260-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 609K Feb 11 09:25 POR-260-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.1G Dec 30 13:17 POR-260-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 588K Feb 11 09:25 POR-260-TP3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.2G Dec 30 14:24 POR-260-TP3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 607K Feb 11 09:25 POR-260-TP3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.2G Dec 30 14:26 POR-260-TP3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 587K Feb 11 09:26 POR-260-TP4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 18:16 POR-260-TP4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 604K Feb 11 09:25 POR-260-TP4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.5G Dec 30 18:18 POR-260-TP4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 584K Feb 11 09:27 POR-262-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.7G Dec 30 09:12 POR-262-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 601K Feb 11 09:27 POR-262-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 09:15 POR-262-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 580K Feb 11 09:28 POR-262-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.8G Dec 30 17:17 POR-262-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 589K Feb 11 09:28 POR-262-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.8G Dec 30 17:20 POR-262-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 578K Feb 11 09:29 POR-262-TP4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.8G Dec 30 15:59 POR-262-TP4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 588K Feb 11 09:29 POR-262-TP4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.9G Dec 30 16:03 POR-262-TP4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 590K Feb 11 09:24 POR-69-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 1.9G Dec 30 10:25 POR-69-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 607K Feb 11 09:24 POR-69-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 1.9G Dec 30 10:27 POR-69-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 590K Feb 11 09:24 POR-69-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.1G Dec 30 11:36 POR-69-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 608K Feb 11 09:25 POR-69-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.1G Dec 30 11:38 POR-69-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 588K Feb 11 09:29 POR-69-TP3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 3.0G Dec 30 09:24 POR-69-TP3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 606K Feb 11 09:28 POR-69-TP3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.9G Dec 30 09:28 POR-69-TP3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 592K Feb 11 09:31 POR-69-TP4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.4G Dec 30 09:38 POR-69-TP4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 608K Feb 11 09:31 POR-69-TP4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.4G Dec 30 09:40 POR-69-TP4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 585K Feb 11 09:32 POR-72-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.4G Dec 30 12:36 POR-72-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 603K Feb 11 09:32 POR-72-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.4G Dec 30 12:38 POR-72-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 584K Feb 11 09:31 POR-72-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.2G Dec 30 15:41 POR-72-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 594K Feb 11 09:32 POR-72-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.2G Dec 30 15:43 POR-72-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 588K Feb 11 09:33 POR-72-TP3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.3G Dec 30 13:32 POR-72-TP3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 603K Feb 11 09:32 POR-72-TP3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.2G Dec 30 13:34 POR-72-TP3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 583K Feb 11 09:33 POR-72-TP4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.4G Dec 30 16:49 POR-72-TP4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 593K Feb 11 09:33 POR-72-TP4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.4G Dec 30 16:51 POR-72-TP4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 582K Feb 11 09:34 POR-73-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 16:17 POR-73-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 591K Feb 11 09:34 POR-73-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 16:20 POR-73-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 578K Feb 11 09:34 POR-73-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.9G Dec 30 14:40 POR-73-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 590K Feb 11 09:34 POR-73-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 3.0G Dec 30 14:43 POR-73-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 585K Feb 11 09:33 POR-73-TP3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.4G Dec 30 11:46 POR-73-TP3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 605K Feb 11 09:33 POR-73-TP3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.4G Dec 30 11:48 POR-73-TP3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 583K Feb 11 09:33 POR-74-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.0G Dec 30 08:07 POR-74-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 590K Feb 11 09:32 POR-74-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.0G Dec 30 08:09 POR-74-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 585K Feb 11 09:34 POR-74-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 3.0G Dec 30 08:12 POR-74-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 603K Feb 11 09:34 POR-74-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.9G Dec 30 08:15 POR-74-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 582K Feb 11 09:32 POR-74-TP3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 1.9G Dec 30 17:05 POR-74-TP3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 591K Feb 11 09:33 POR-74-TP3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 1.9G Dec 30 17:07 POR-74-TP3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 587K Feb 11 09:33 POR-74-TP4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.4G Dec 30 15:24 POR-74-TP4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 603K Feb 11 09:34 POR-74-TP4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.4G Dec 30 15:27 POR-74-TP4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 584K Feb 11 09:33 POR-83-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.1G Dec 30 08:17 POR-83-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 603K Feb 11 09:34 POR-83-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.0G Dec 30 08:19 POR-83-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 586K Feb 11 09:34 POR-83-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.5G Dec 30 16:43 POR-83-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 595K Feb 11 09:35 POR-83-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 16:46 POR-83-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 588K Feb 11 09:33 POR-83-TP3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.0G Dec 30 13:00 POR-83-TP3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 605K Feb 11 09:34 POR-83-TP3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.0G Dec 30 13:02 POR-83-TP3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 586K Feb 11 09:34 POR-83-TP4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.4G Dec 30 10:57 POR-83-TP4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 603K Feb 11 09:34 POR-83-TP4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.4G Dec 30 10:59 POR-83-TP4_R2_001.fastq.gz</code></pre>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<p>MultiQC report (HTML):</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/wgbs-raw-fastqs/multiqc_report.html">E-Peve/data/wgbs-raw-fastqs/multiqc_report.html</a></li>
</ul>
<p>Overall, sequencing looks pretty good. The “Per Base Sequence Content” analysis by <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/"><code>FastQC</code></a> suggests these libraries are considered <em>directional</em>, plus confirmation by Azenta that libraries were constructed using <a href="https://www.neb.com/en-us/products/e7120-nebnext-enzymatic-methyl-seq-kit">NEBNext® Enzymatic Methyl-seq Kit</a> which generates directional libraries.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2025/2025-02-10-FastQC-MultiQC---P.evermanni-Raw-WGBS-Renaming-and-FastQC-MultiQC-E5-timeseries_molecular-Project/20250210-peve-multiqc-plot-sequence-content.png" class="img-fluid figure-img" alt="Screenshot of MultiQC per base sequence content plot showing low C content - indicative of directional WGBS libraries"></p>
<figcaption>Screenshot of MultiQC per base sequence content plot showing low C content - indicative of directional WGBS libraries</figcaption>
</figure>
</div>
</section>
<section id="references" class="level1">
<h1>REFERENCES</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ewels2016" class="csl-entry">
Ewels, Philip, Måns Magnusson, Sverker Lundin, and Max Käller. 2016. “MultiQC: Summarize Analysis Results for Multiple Tools and Samples in a Single Report.” <em>Bioinformatics</em> 32 (19): 3047–48. <a href="https://doi.org/10.1093/bioinformatics/btw354" class="uri">https://doi.org/10.1093/bioinformatics/btw354</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2025</category>
  <category>Porites evermanni</category>
  <category>E5</category>
  <category>WGBS</category>
  <category>bisulfite sequencing</category>
  <category>FastQC</category>
  <category>MultiQC</category>
  <category>timeseries_molecular</category>
  <category>coral</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2025/2025-02-10-FastQC-MultiQC---P.evermanni-Raw-WGBS-Renaming-and-FastQC-MultiQC-E5-timeseries_molecular-Project/</guid>
  <pubDate>Mon, 10 Feb 2025 08:00:00 GMT</pubDate>
</item>
<item>
  <title>FastQC MultiQC - P.evermanni WGBS E5 Deep Dive Expression</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2025/2025-02-06-FastQC-MultiQC---P.evermanni-WGBS-E5-Deep-Dive-Expression/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>Ran FastQC and MultiQC quality checks on the <em>P.evermanni</em> raw whole genome bisulfite sequencing (WGBS) data <a href="../../../posts/2025/2025-02-03-Data-Received---E5-Coral-WGBS-from-Genohub-Project-2216545-Using-Rclone-on-Owl/index.html">received 20250203</a>, as part of <a href="https://github.com/urol-e5/deep-dive-expression">urol-e5/deep-dive-expression</a>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The contents below are from markdown knitted from <a href="https://github.com/urol-e5/deep-dive-expression/blob/29e99e1565ce81e22cc8f3371d67778b31b7acb2/E-Peve/code/00.00-E-Peve-WGBS-reads-FastQC-MultiQC.Rmd"><code>00.00-E-Peve-WGBS-reads-FastQC-MultiQC</code></a> (commit <code>29e99e1</code>).</p>
</div>
</div>
</section>
<section id="background" class="level1">
<h1>1 Background</h1>
<p>This Rmd file will download raw WGBS-seq FastQs for <em>P.evermanni</em> and evaluate them using <a href="https://github.com/s-andrews/FastQC">FastQC</a> and <a href="https://multiqc.info/">MultiQC</a> (Ewels et al.&nbsp;2016).</p>
</section>
<section id="create-a-bash-variables-file" class="level1">
<h1>2 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export deep_dive_expression_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/deep-dive-expression'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export output_dir_top=${deep_dive_expression_dir}/E-Peve/output/00.00-E-Peve-WGBS-reads-FastQC-MultiQC'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_fastqc_dir=${output_dir_top}/raw-fastqc'</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_dir=${deep_dive_expression_dir}/E-Peve/data/raw-fastqs'</span></span>
<span id="cb1-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_url="https://owl.fish.washington.edu/nightingales/E5-coral-deep-dive-expression/genohub2216545/"'</span></span>
<span id="cb1-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Paths to programs"</span></span>
<span id="cb1-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastqc=/home/shared/FastQC-0.12.1/fastqc'</span></span>
<span id="cb1-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export multiqc=/home/sam/programs/mambaforge/bin/multiqc'</span></span>
<span id="cb1-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-17"></span>
<span id="cb1-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set FastQ filename patterns"</span></span>
<span id="cb1-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export fastq_pattern='*.fastq.gz'"</span></span>
<span id="cb1-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R1_fastq_pattern='*_R1_*.fastq.gz'"</span></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R2_fastq_pattern='*_R2_*.fastq.gz'"</span></span>
<span id="cb1-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-23"></span>
<span id="cb1-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set number of CPUs to use"</span></span>
<span id="cb1-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=40'</span></span>
<span id="cb1-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-27"></span>
<span id="cb1-28"></span>
<span id="cb1-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"## Inititalize arrays"</span></span>
<span id="cb1-30"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R1=()'</span></span>
<span id="cb1-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R2=()'</span></span>
<span id="cb1-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_fastqs_array=()'</span></span>
<span id="cb1-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R1_names_array=()'</span></span>
<span id="cb1-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R2_names_array=()'</span></span>
<span id="cb1-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-36"></span>
<span id="cb1-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Programs associative array"</span></span>
<span id="cb1-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"declare -A programs_array"</span></span>
<span id="cb1-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"programs_array=("</span></span>
<span id="cb1-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[fastqc]="${fastqc}" \'</span></span>
<span id="cb1-41"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[multiqc]="${multiqc}" \'</span></span>
<span id="cb1-42"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span></span>
<span id="cb1-43"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-44"></span>
<span id="cb1-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Print formatting"</span></span>
<span id="cb1-46"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-47"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-48"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-49"></span>
<span id="cb1-50"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export deep_dive_expression_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/deep-dive-expression
export output_dir_top=${deep_dive_expression_dir}/E-Peve/output/00.00-E-Peve-WGBS-reads-FastQC-MultiQC
export raw_fastqc_dir=${output_dir_top}/raw-fastqc
export raw_reads_dir=${deep_dive_expression_dir}/E-Peve/data/raw-fastqs
export raw_reads_url="https://owl.fish.washington.edu/nightingales/E5-coral-deep-dive-expression/genohub2216545/"

# Paths to programs
export fastqc=/home/shared/FastQC-0.12.1/fastqc
export multiqc=/home/sam/programs/mambaforge/bin/multiqc

# Set FastQ filename patterns
export fastq_pattern='*.fastq.gz'
export R1_fastq_pattern='*_R1_*.fastq.gz'
export R2_fastq_pattern='*_R2_*.fastq.gz'

# Set number of CPUs to use
export threads=40

## Inititalize arrays
export fastq_array_R1=()
export fastq_array_R2=()
export raw_fastqs_array=()
export R1_names_array=()
export R2_names_array=()

# Programs associative array
declare -A programs_array
programs_array=(
[fastqc]="${fastqc}" \
[multiqc]="${multiqc}" \
)

# Print formatting
export line="--------------------------------------------------------"</code></pre>
</section>
<section id="download-p.evermanni-rna-seq-fastqs" class="level1">
<h1>3 Download <em>P.evermanni</em> RNA-seq FastQs</h1>
<p>Reads are downloaded from <a href="https://owl.fish.washington.edu/nightingales/E5-coral-deep-dive-expression/genohub2216545/" class="uri">https://owl.fish.washington.edu/nightingales/E5-coral-deep-dive-expression/genohub2216545/</a></p>
<p>Since sequencing included multiple species, the code will also parse only those that are <em>P.evermanni</em>.</p>
<p>The <code>--cut-dirs 3</code> command cuts the preceding directory structure (i.e.&nbsp;<code>nightingales/E5-coral-deep-dive-expression/genohub2216545/</code>) so that we just end up with the reads.</p>
<section id="inspect-metadata-file" class="level2">
<h2 class="anchored" data-anchor-id="inspect-metadata-file">3.1 Inspect metadata file</h2>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${deep_dive_expression_dir}</span>/M-multi-species/data/e5_deep_dive_WGBS_metadata.csv <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span></span>
<span id="cb3-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">column</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span></span></code></pre></div>
<pre><code>Number  Species                   Timepoint  Collection Date  Site   colony_id  Extraction Date  Extraction notebook post                                                                                                      DNA (ng/uL)  Volume eluted  Total DNA (ng)  Primer  Date Prepped  Library concentration (ng/uL)  bp peak  Library volume (uL)  Prep notebook post                                                                                                             Notes
403     Pocillopora tuahiniensis  TP2        20200305         Site1  POC-48     20211129         https://github.com/Kterpis/Putnam_Lab_Notebook/blob/master/_posts/2021-11-29-20211129-RNA-DNA-extractions-from-E5-project.md  29.1         90             2619            25      20240613      8.67                           253      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  Labeled as POC-55 in KXT extraction post 
413     Acropora pulchra          TP2        20200305         Site1  ACR-178    20210902         https://github.com/Kterpis/Putnam_Lab_Notebook/blob/master/_posts/2021-09-02-20210902-RNA-DNA-extractions-from-E5-project.md  19.9         90             1791            26      20240613      9.64                           269      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  
417     Pocillopora tuahiniensis  TP2        20200305         Site1  POC-57     20211020         https://kterpis.github.io/Putnam_Lab_Notebook/20211020-RNA-DNA-extractions-from-E5-project/                                   51.4         90             4626            27      20240613      9.3                            256      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  Labeled as POC-238 in KXT extraction post 
423     Acropora pulchra          TP2        20200305         Site1  ACR-150    20210903         https://github.com/Kterpis/Putnam_Lab_Notebook/blob/master/_posts/2021-09-03-20210903-RNA-DNA-extractions-from-E5-project.md  17.7         90             1593            29      20240613      8.61                           267      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  Labeled as POR-75 in KXT extraction post 
427     Acropora pulchra          TP2        20200305         Site1  ACR-145    20211012         https://kterpis.github.io/Putnam_Lab_Notebook/20211012-RNA-DNA-extractions-from-E5-project/                                   19.6         90             1764            30      20240613      8.82                           271      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  
439     Acropora pulchra          TP2        20200305         Site1  ACR-173    20211102         https://kterpis.github.io/Putnam_Lab_Notebook/20211102-RNA-DNA-extractions-from-E5-project/                                   19.9         90             1791            31      20240613      11.9                           264      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  
467     Acropora pulchra          TP2        20200305         Site1  ACR-140    20210921         https://github.com/Kterpis/Putnam_Lab_Notebook/blob/master/_posts/2021-09-21-20210921-RNA-DNA-extractions-from-E5-project.md  21.9         90             1971            32      20240613      16                             270      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  DNA 1 and 2 Qubit readings are 27.6 and 27.4 but average is reported as 4.79 on github and on master sample sheet; JA re-qubited on 20240229 and got 21.9 ul/ng
471     Porites evermanni         TP2        20200305         Site1  POR-76     20211015         https://kterpis.github.io/Putnam_Lab_Notebook/20211015-RNA-DNA-extractions-from-E5-project/                                   2.7          90             243             33      20240613      5.25                           245      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  
491     Porites evermanni         TP2        20200305         Site1  POR-73     20211101         https://kterpis.github.io/Putnam_Lab_Notebook/20211101-RNA-DNA-extractions-from-E5-project/                                   2.11         90             189.9           36      20240613      4.65                           315      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  </code></pre>
</section>
<section id="download-raw-reads" class="level2">
<h2 class="anchored" data-anchor-id="download-raw-reads">3.2 Download raw reads</h2>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directory if it doesn't exist</span></span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span></span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create list of only P.evermanni sample names</span></span>
<span id="cb5-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$6 ~ /^POR/ {print $1}'</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${deep_dive_expression_dir}</span>/M-multi-species/data/e5_deep_dive_WGBS_metadata.csv<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-9"></span>
<span id="cb5-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample list:"</span></span>
<span id="cb5-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_list}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-19"></span>
<span id="cb5-20"></span>
<span id="cb5-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use printf to format each item for use in wget</span></span>
<span id="cb5-22"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">formatted_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*%s_*,"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_list})</span></span>
<span id="cb5-23"></span>
<span id="cb5-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove the trailing comma</span></span>
<span id="cb5-25"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">formatted_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${formatted_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb5-26"></span>
<span id="cb5-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output the final wget command</span></span>
<span id="cb5-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-30"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Formatted wget accept list:"</span></span>
<span id="cb5-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wget --accept=</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$formatted_list</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-36"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-37"></span>
<span id="cb5-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run wget to retrieve FastQs and MD5 files</span></span>
<span id="cb5-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Note: the --no-clobber command will skip re-downloading any files that are already present in the output directory</span></span>
<span id="cb5-40"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-41">--directory-prefix <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-42">--recursive <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-43">--no-check-certificate <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-44">--continue <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-45">--cut-dirs 3 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-46">--no-host-directories <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-47">--no-parent <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-48">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-49">--no-clobber <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-50">--accept=<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${formatted_list}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_url}</span></span>
<span id="cb5-51"></span>
<span id="cb5-52"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</section>
<section id="verify-raw-read-checksums" class="level2">
<h2 class="anchored" data-anchor-id="verify-raw-read-checksums">3.3 Verify raw read checksums</h2>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb6-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb6-5"></span>
<span id="cb6-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Checksums file contains other files, so this just looks for the RNAseq files.</span></span>
<span id="cb6-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.md5</span>
<span id="cb6-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb6-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--check</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb6-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<pre><code>421_S8_R1_001.fastq.gz: OK
421_S8_R2_001.fastq.gz: OK
471_S6_R1_001.fastq.gz: OK
471_S6_R2_001.fastq.gz: OK
487_S9_R1_001.fastq.gz: OK
487_S9_R2_001.fastq.gz: OK
489_S10_R1_001.fastq.gz: OK
489_S10_R2_001.fastq.gz: OK
491_S7_R1_001.fastq.gz: OK
491_S7_R2_001.fastq.gz: OK</code></pre>
</section>
</section>
<section id="fastqcmultiqc-on-raw-reads" class="level1">
<h1>4 FastQC/MultiQC on raw reads</h1>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb8-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb8-3"></span>
<span id="cb8-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directory if it doesn't exist</span></span>
<span id="cb8-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb8-6"></span>
<span id="cb8-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN FASTQC ############</span></span>
<span id="cb8-8"></span>
<span id="cb8-9"></span>
<span id="cb8-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of trimmed FastQs</span></span>
<span id="cb8-11"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">raw_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(${raw_reads_dir}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_pattern})</span></span>
<span id="cb8-12"></span>
<span id="cb8-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pass array contents to new variable as space-delimited list</span></span>
<span id="cb8-14"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">raw_fastqc_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[*]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb8-15"></span>
<span id="cb8-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning FastQC on raw reads..."</span></span>
<span id="cb8-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb8-18"></span>
<span id="cb8-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run FastQC</span></span>
<span id="cb8-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Do NOT quote raw_fastqc_list</span></span>
<span id="cb8-21"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>fastqc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-22">--threads <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-23">--outdir <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-24">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-25"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_list}</span></span>
<span id="cb8-26"></span>
<span id="cb8-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC on raw reads complete!"</span></span>
<span id="cb8-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb8-29"></span>
<span id="cb8-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> FASTQC ############</span></span>
<span id="cb8-31"></span>
<span id="cb8-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN MULTIQC ############</span></span>
<span id="cb8-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning MultiQC on raw FastQC..."</span></span>
<span id="cb8-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb8-35"></span>
<span id="cb8-36"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>multiqc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span></span>
<span id="cb8-37"></span>
<span id="cb8-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb8-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MultiQC on raw FastQs complete."</span></span>
<span id="cb8-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb8-41"></span>
<span id="cb8-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> MULTIQC ############</span></span>
<span id="cb8-43"></span>
<span id="cb8-44"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Removing FastQC zip files."</span></span>
<span id="cb8-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb8-46"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.zip</span>
<span id="cb8-47"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC zip files removed."</span></span>
<span id="cb8-48"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span></code></pre></div>
<pre><code>Beginning FastQC on raw reads...

application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
FastQC on raw reads complete!

Beginning MultiQC on raw FastQC...


  /// MultiQC 🔍 | v1.14

|           multiqc | MultiQC Version v1.27 now available!
|           multiqc | Search path : /home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/deep-dive-expression/E-Peve/output/00.00-E-Peve-WGBS-reads-FastQC-MultiQC/raw-fastqc
|         searching | ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 20/20  
|            fastqc | Found 10 reports
|           multiqc | Compressing plot data
|           multiqc | Report      : ../output/00.00-E-Peve-WGBS-reads-FastQC-MultiQC/raw-fastqc/multiqc_report.html
|           multiqc | Data        : ../output/00.00-E-Peve-WGBS-reads-FastQC-MultiQC/raw-fastqc/multiqc_data
|           multiqc | MultiQC complete

MultiQC on raw FastQs complete.

Removing FastQC zip files.

FastQC zip files removed.</code></pre>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb10-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb10-3"></span>
<span id="cb10-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># View directory contents</span></span>
<span id="cb10-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span></span></code></pre></div>
<pre><code>total 7.1M
-rw-r--r-- 1 sam sam 615K Feb  6 13:33 421_S8_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 603K Feb  6 13:34 421_S8_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 603K Feb  6 13:24 471_S6_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 598K Feb  6 13:25 471_S6_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 590K Feb  6 13:30 487_S9_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 586K Feb  6 13:31 487_S9_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 591K Feb  6 13:34 489_S10_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 592K Feb  6 13:34 489_S10_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 571K Feb  6 13:17 491_S7_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 579K Feb  6 13:17 491_S7_R2_001_fastqc.html
drwxr-xr-x 2 sam sam 4.0K Feb  6 13:35 multiqc_data
-rw-r--r-- 1 sam sam 1.3M Feb  6 13:35 multiqc_report.html</code></pre>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<p><a href="https://multiqc.info/"><code>MultiQC</code></a> HTML file is here:</p>
<ul>
<li><a href="https://github.com/urol-e5/deep-dive-expression/blob/29e99e1565ce81e22cc8f3371d67778b31b7acb2/E-Peve/output/00.00-E-Peve-WGBS-reads-FastQC-MultiQC/raw-fastqc/multiqc_report.html"><code>multiqc_report.html</code></a> (commit: <code>29e99e1</code>)</li>
</ul>
<p>Overall, looks like the first 10bp need to be trimmed, as well as adapters and polyG sequence. Curiously, there is a second peak in the GC conent analysis. This second peak is <em>not</em> present in <a href="../../../posts/2025/2025-02-06-FastQC-MultiQC---A.pulchra-WGBS-E5-Deep-Dive-Expression/index.html">the <em>A.pulchra</em> data</a> (Notebook), but is also present in <a href="../../../posts/2025/2025-02-06-FastQC-MultiQC---P.tuahiniensis-WGBS-E5-Deep-Dive-Expression/index.html">the _P.tuahiniensis data</a> (Notebook). Multiple GC content peaks suggest that there might be carryover from endosymbionts?</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2025/2025-02-06-FastQC-MultiQC---P.evermanni-WGBS-E5-Deep-Dive-Expression/20250206-peve-multiqc-plot-GC-content.png" class="img-fluid figure-img"></p>
<figcaption>P.evermanni WGBS MultiQC GC content plot showing multiple peaks</figcaption>
</figure>
</div>
</section>
<section id="references" class="level1">
<h1>REFERENCES</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ewels2016" class="csl-entry">
Ewels, Philip, Måns Magnusson, Sverker Lundin, and Max Käller. 2016. “MultiQC: Summarize Analysis Results for Multiple Tools and Samples in a Single Report.” <em>Bioinformatics</em> 32 (19): 3047–48. <a href="https://doi.org/10.1093/bioinformatics/btw354" class="uri">https://doi.org/10.1093/bioinformatics/btw354</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2025</category>
  <category>Porites evermanni</category>
  <category>E5</category>
  <category>deep-dive-expression</category>
  <category>FastQC</category>
  <category>MultiQC</category>
  <category>WGBS</category>
  <category>BS-seq</category>
  <category>bisulfite sequencing</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2025/2025-02-06-FastQC-MultiQC---P.evermanni-WGBS-E5-Deep-Dive-Expression/</guid>
  <pubDate>Thu, 06 Feb 2025 08:00:00 GMT</pubDate>
  <media:content url="https://robertslab.github.io/sams-notebook/posts/2025/2025-02-06-FastQC-MultiQC---P.evermanni-WGBS-E5-Deep-Dive-Expression/20250206-peve-multiqc-plot-sequence-content.png" medium="image" type="image/png" height="67" width="144"/>
</item>
<item>
  <title>FastQC MultiQC - P.tuahiniensis WGBS E5 Deep Dive Expression</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2025/2025-02-06-FastQC-MultiQC---P.tuahiniensis-WGBS-E5-Deep-Dive-Expression/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>Ran FastQC and MultiQC quality checks on the _P.tuahiniensis raw whole genome bisulfite sequencing (WGBS) data <a href="../../../posts/2025/2025-02-03-Data-Received---E5-Coral-WGBS-from-Genohub-Project-2216545-Using-Rclone-on-Owl/index.html">received 20250203</a>, as part of <a href="https://github.com/urol-e5/deep-dive-expression">urol-e5/deep-dive-expression</a>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The contents below are from markdown knitted from <a href="https://github.com/urol-e5/deep-dive-expression/blob/b471c0590ce7388ff91374520664275ff4ab1288/F-Ptuh/code/00.00-F-Ptuh-WGBS-reads-FastQC-MultiQC.Rmd"><code>00.00-F-Ptuh-WGBS-reads-FastQC-MultiQC</code></a> (commit <code>b471c05</code>).</p>
</div>
</div>
</section>
<section id="background" class="level1">
<h1>1 Background</h1>
<p>This Rmd file will download raw WGBS-seq FastQs for <em>P.tuahiniensis</em> and evaluate them using <a href="https://github.com/s-andrews/FastQC">FastQC</a> and <a href="https://multiqc.info/">MultiQC</a> (Ewels et al.&nbsp;2016).</p>
</section>
<section id="create-a-bash-variables-file" class="level1">
<h1>2 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export deep_dive_expression_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/deep-dive-expression'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export output_dir_top=${deep_dive_expression_dir}/F-Ptuh/output/00.00-F-Ptuh-WGBS-reads-FastQC-MultiQC'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_fastqc_dir=${output_dir_top}/raw-fastqc'</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_dir=${deep_dive_expression_dir}/F-Ptuh/data/raw-fastqs'</span></span>
<span id="cb1-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_url="https://owl.fish.washington.edu/nightingales/E5-coral-deep-dive-expression/genohub2216545/"'</span></span>
<span id="cb1-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Paths to programs"</span></span>
<span id="cb1-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastqc=/home/shared/FastQC-0.12.1/fastqc'</span></span>
<span id="cb1-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export multiqc=/home/sam/programs/mambaforge/bin/multiqc'</span></span>
<span id="cb1-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-17"></span>
<span id="cb1-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set FastQ filename patterns"</span></span>
<span id="cb1-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export fastq_pattern='*.fastq.gz'"</span></span>
<span id="cb1-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R1_fastq_pattern='*_R1_*.fastq.gz'"</span></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R2_fastq_pattern='*_R2_*.fastq.gz'"</span></span>
<span id="cb1-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-23"></span>
<span id="cb1-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set number of CPUs to use"</span></span>
<span id="cb1-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=40'</span></span>
<span id="cb1-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-27"></span>
<span id="cb1-28"></span>
<span id="cb1-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"## Inititalize arrays"</span></span>
<span id="cb1-30"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R1=()'</span></span>
<span id="cb1-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R2=()'</span></span>
<span id="cb1-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_fastqs_array=()'</span></span>
<span id="cb1-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R1_names_array=()'</span></span>
<span id="cb1-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R2_names_array=()'</span></span>
<span id="cb1-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-36"></span>
<span id="cb1-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Programs associative array"</span></span>
<span id="cb1-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"declare -A programs_array"</span></span>
<span id="cb1-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"programs_array=("</span></span>
<span id="cb1-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[fastqc]="${fastqc}" \'</span></span>
<span id="cb1-41"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[multiqc]="${multiqc}" \'</span></span>
<span id="cb1-42"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span></span>
<span id="cb1-43"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-44"></span>
<span id="cb1-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Print formatting"</span></span>
<span id="cb1-46"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-47"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-48"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-49"></span>
<span id="cb1-50"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export deep_dive_expression_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/deep-dive-expression
export output_dir_top=${deep_dive_expression_dir}/F-Ptuh/output/00.00-F-Ptuh-WGBS-reads-FastQC-MultiQC
export raw_fastqc_dir=${output_dir_top}/raw-fastqc
export raw_reads_dir=${deep_dive_expression_dir}/F-Ptuh/data/raw-fastqs
export raw_reads_url="https://owl.fish.washington.edu/nightingales/E5-coral-deep-dive-expression/genohub2216545/"

# Paths to programs
export fastqc=/home/shared/FastQC-0.12.1/fastqc
export multiqc=/home/sam/programs/mambaforge/bin/multiqc

# Set FastQ filename patterns
export fastq_pattern='*.fastq.gz'
export R1_fastq_pattern='*_R1_*.fastq.gz'
export R2_fastq_pattern='*_R2_*.fastq.gz'

# Set number of CPUs to use
export threads=40

## Inititalize arrays
export fastq_array_R1=()
export fastq_array_R2=()
export raw_fastqs_array=()
export R1_names_array=()
export R2_names_array=()

# Programs associative array
declare -A programs_array
programs_array=(
[fastqc]="${fastqc}" \
[multiqc]="${multiqc}" \
)

# Print formatting
export line="--------------------------------------------------------"</code></pre>
</section>
<section id="download-p.tuahiniensis-rna-seq-fastqs" class="level1">
<h1>3 Download <em>P.tuahiniensis</em> RNA-seq FastQs</h1>
<p>Reads are downloaded from <a href="https://owl.fish.washington.edu/nightingales/E5-coral-deep-dive-expression/genohub2216545/" class="uri">https://owl.fish.washington.edu/nightingales/E5-coral-deep-dive-expression/genohub2216545/</a></p>
<p>Since sequencing included multiple species, the code will also parse only those that are <em>P.tuahiniensis</em>.</p>
<p>The <code>--cut-dirs 3</code> command cuts the preceding directory structure (i.e.&nbsp;<code>nightingales/E5-coral-deep-dive-expression/genohub2216545/</code>) so that we just end up with the reads.</p>
<section id="inspect-metadata-file" class="level2">
<h2 class="anchored" data-anchor-id="inspect-metadata-file">3.1 Inspect metadata file</h2>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${deep_dive_expression_dir}</span>/M-multi-species/data/e5_deep_dive_WGBS_metadata.csv <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span></span>
<span id="cb3-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">column</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span></span></code></pre></div>
<pre><code>Number  Species                   Timepoint  Collection Date  Site   colony_id  Extraction Date  Extraction notebook post                                                                                                      DNA (ng/uL)  Volume eluted  Total DNA (ng)  Primer  Date Prepped  Library concentration (ng/uL)  bp peak  Library volume (uL)  Prep notebook post                                                                                                             Notes
403     Pocillopora tuahiniensis  TP2        20200305         Site1  POC-48     20211129         https://github.com/Kterpis/Putnam_Lab_Notebook/blob/master/_posts/2021-11-29-20211129-RNA-DNA-extractions-from-E5-project.md  29.1         90             2619            25      20240613      8.67                           253      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  Labeled as POC-55 in KXT extraction post 
413     Acropora pulchra          TP2        20200305         Site1  ACR-178    20210902         https://github.com/Kterpis/Putnam_Lab_Notebook/blob/master/_posts/2021-09-02-20210902-RNA-DNA-extractions-from-E5-project.md  19.9         90             1791            26      20240613      9.64                           269      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  
417     Pocillopora tuahiniensis  TP2        20200305         Site1  POC-57     20211020         https://kterpis.github.io/Putnam_Lab_Notebook/20211020-RNA-DNA-extractions-from-E5-project/                                   51.4         90             4626            27      20240613      9.3                            256      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  Labeled as POC-238 in KXT extraction post 
423     Acropora pulchra          TP2        20200305         Site1  ACR-150    20210903         https://github.com/Kterpis/Putnam_Lab_Notebook/blob/master/_posts/2021-09-03-20210903-RNA-DNA-extractions-from-E5-project.md  17.7         90             1593            29      20240613      8.61                           267      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  Labeled as POR-75 in KXT extraction post 
427     Acropora pulchra          TP2        20200305         Site1  ACR-145    20211012         https://kterpis.github.io/Putnam_Lab_Notebook/20211012-RNA-DNA-extractions-from-E5-project/                                   19.6         90             1764            30      20240613      8.82                           271      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  
439     Acropora pulchra          TP2        20200305         Site1  ACR-173    20211102         https://kterpis.github.io/Putnam_Lab_Notebook/20211102-RNA-DNA-extractions-from-E5-project/                                   19.9         90             1791            31      20240613      11.9                           264      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  
467     Acropora pulchra          TP2        20200305         Site1  ACR-140    20210921         https://github.com/Kterpis/Putnam_Lab_Notebook/blob/master/_posts/2021-09-21-20210921-RNA-DNA-extractions-from-E5-project.md  21.9         90             1971            32      20240613      16                             270      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  DNA 1 and 2 Qubit readings are 27.6 and 27.4 but average is reported as 4.79 on github and on master sample sheet; JA re-qubited on 20240229 and got 21.9 ul/ng
471     Porites evermanni         TP2        20200305         Site1  POR-76     20211015         https://kterpis.github.io/Putnam_Lab_Notebook/20211015-RNA-DNA-extractions-from-E5-project/                                   2.7          90             243             33      20240613      5.25                           245      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  
491     Porites evermanni         TP2        20200305         Site1  POR-73     20211101         https://kterpis.github.io/Putnam_Lab_Notebook/20211101-RNA-DNA-extractions-from-E5-project/                                   2.11         90             189.9           36      20240613      4.65                           315      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  </code></pre>
</section>
<section id="download-raw-reads" class="level2">
<h2 class="anchored" data-anchor-id="download-raw-reads">3.2 Download raw reads</h2>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directory if it doesn't exist</span></span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span></span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create list of only P.tuahiniensis sample names</span></span>
<span id="cb5-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$6 ~ /^POC/ {print $1}'</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${deep_dive_expression_dir}</span>/M-multi-species/data/e5_deep_dive_WGBS_metadata.csv<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-9"></span>
<span id="cb5-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample list:"</span></span>
<span id="cb5-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_list}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-19"></span>
<span id="cb5-20"></span>
<span id="cb5-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use printf to format each item for use in wget</span></span>
<span id="cb5-22"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">formatted_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*%s_*,"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_list})</span></span>
<span id="cb5-23"></span>
<span id="cb5-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove the trailing comma</span></span>
<span id="cb5-25"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">formatted_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${formatted_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb5-26"></span>
<span id="cb5-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output the final wget command</span></span>
<span id="cb5-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-30"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Formatted wget accept list:"</span></span>
<span id="cb5-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wget --accept=</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$formatted_list</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-36"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-37"></span>
<span id="cb5-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run wget to retrieve FastQs and MD5 files</span></span>
<span id="cb5-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Note: the --no-clobber command will skip re-downloading any files that are already present in the output directory</span></span>
<span id="cb5-40"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-41">--directory-prefix <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-42">--recursive <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-43">--no-check-certificate <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-44">--continue <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-45">--cut-dirs 3 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-46">--no-host-directories <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-47">--no-parent <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-48">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-49">--no-clobber <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-50">--accept=<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${formatted_list}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_url}</span></span>
<span id="cb5-51"></span>
<span id="cb5-52"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</section>
<section id="verify-raw-read-checksums" class="level2">
<h2 class="anchored" data-anchor-id="verify-raw-read-checksums">3.3 Verify raw read checksums</h2>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb6-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb6-5"></span>
<span id="cb6-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Checksums file contains other files, so this just looks for the RNAseq files.</span></span>
<span id="cb6-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.md5</span>
<span id="cb6-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb6-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--check</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb6-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<pre><code>385_S13_R1_001.fastq.gz: OK
385_S13_R2_001.fastq.gz: OK
393_S14_R1_001.fastq.gz: OK
393_S14_R2_001.fastq.gz: OK
401_S15_R1_001.fastq.gz: OK
401_S15_R2_001.fastq.gz: OK
403_S11_R1_001.fastq.gz: OK
403_S11_R2_001.fastq.gz: OK
417_S12_R1_001.fastq.gz: OK
417_S12_R2_001.fastq.gz: OK</code></pre>
</section>
</section>
<section id="fastqcmultiqc-on-raw-reads" class="level1">
<h1>4 FastQC/MultiQC on raw reads</h1>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb8-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb8-3"></span>
<span id="cb8-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directory if it doesn't exist</span></span>
<span id="cb8-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb8-6"></span>
<span id="cb8-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN FASTQC ############</span></span>
<span id="cb8-8"></span>
<span id="cb8-9"></span>
<span id="cb8-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of trimmed FastQs</span></span>
<span id="cb8-11"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">raw_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(${raw_reads_dir}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_pattern})</span></span>
<span id="cb8-12"></span>
<span id="cb8-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pass array contents to new variable as space-delimited list</span></span>
<span id="cb8-14"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">raw_fastqc_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[*]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb8-15"></span>
<span id="cb8-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning FastQC on raw reads..."</span></span>
<span id="cb8-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb8-18"></span>
<span id="cb8-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run FastQC</span></span>
<span id="cb8-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Do NOT quote raw_fastqc_list</span></span>
<span id="cb8-21"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>fastqc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-22">--threads <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-23">--outdir <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-24">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-25"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_list}</span></span>
<span id="cb8-26"></span>
<span id="cb8-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC on raw reads complete!"</span></span>
<span id="cb8-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb8-29"></span>
<span id="cb8-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> FASTQC ############</span></span>
<span id="cb8-31"></span>
<span id="cb8-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN MULTIQC ############</span></span>
<span id="cb8-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning MultiQC on raw FastQC..."</span></span>
<span id="cb8-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb8-35"></span>
<span id="cb8-36"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>multiqc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span></span>
<span id="cb8-37"></span>
<span id="cb8-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb8-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MultiQC on raw FastQs complete."</span></span>
<span id="cb8-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb8-41"></span>
<span id="cb8-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> MULTIQC ############</span></span>
<span id="cb8-43"></span>
<span id="cb8-44"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Removing FastQC zip files."</span></span>
<span id="cb8-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb8-46"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.zip</span>
<span id="cb8-47"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC zip files removed."</span></span>
<span id="cb8-48"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span></code></pre></div>
<pre><code>Beginning FastQC on raw reads...

application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
FastQC on raw reads complete!

Beginning MultiQC on raw FastQC...


  /// MultiQC 🔍 | v1.14

|           multiqc | MultiQC Version v1.27 now available!
|           multiqc | Search path : /home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/deep-dive-expression/F-Ptuh/output/00.00-F-Ptuh-WGBS-reads-FastQC-MultiQC/raw-fastqc
|         searching | ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 20/20  
|            fastqc | Found 10 reports
|           multiqc | Compressing plot data
|           multiqc | Report      : ../output/00.00-F-Ptuh-WGBS-reads-FastQC-MultiQC/raw-fastqc/multiqc_report.html
|           multiqc | Data        : ../output/00.00-F-Ptuh-WGBS-reads-FastQC-MultiQC/raw-fastqc/multiqc_data
|           multiqc | MultiQC complete

MultiQC on raw FastQs complete.

Removing FastQC zip files.

FastQC zip files removed.</code></pre>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb10-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb10-3"></span>
<span id="cb10-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># View directory contents</span></span>
<span id="cb10-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span></span></code></pre></div>
<pre><code>total 7.1M
-rw-r--r-- 1 sam sam 601K Feb  6 14:37 385_S13_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 601K Feb  6 14:37 385_S13_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 613K Feb  6 14:38 393_S14_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 600K Feb  6 14:39 393_S14_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 600K Feb  6 14:36 401_S15_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 594K Feb  6 14:36 401_S15_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 583K Feb  6 14:39 403_S11_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 591K Feb  6 14:40 403_S11_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 578K Feb  6 14:45 417_S12_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 582K Feb  6 14:46 417_S12_R2_001_fastqc.html
drwxr-xr-x 2 sam sam 4.0K Feb  6 14:46 multiqc_data
-rw-r--r-- 1 sam sam 1.3M Feb  6 14:46 multiqc_report.html</code></pre>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<p><a href="https://multiqc.info/"><code>MultiQC</code></a> HTML file is here:</p>
<ul>
<li><a href="https://github.com/urol-e5/deep-dive-expression/blob/b471c0590ce7388ff91374520664275ff4ab1288/F-Ptuh/output/00.00-F-Ptuh-WGBS-reads-FastQC-MultiQC/raw-fastqc/multiqc_report.html"><code>multiqc_report.html</code></a> (commit: <code>b471c05</code>)</li>
</ul>
<p>Overall, looks like the first 10bp need to be trimmed, as well as adapters and polyG sequence. Curiously, there is a second peak in the GC conent analysis. This second peak is <em>not</em> present in <a href="../../../posts/2025/2025-02-06-FastQC-MultiQC---A.pulchra-WGBS-E5-Deep-Dive-Expression/index.html">the <em>A.pulchra</em> data</a> (Notebook), but is also present in <a href="../../../posts/2025/2025-02-06-FastQC-MultiQC---P.evermanni-WGBS-E5-Deep-Dive-Expression/index.html">the <em>P.evermanni</em> data</a> (Notebook). Multiple GC content peaks suggest that there might be carryover from endosymbionts?</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2025/2025-02-06-FastQC-MultiQC---P.tuahiniensis-WGBS-E5-Deep-Dive-Expression/20250206-ptua-multiqc-plot-GC-content.png" class="img-fluid figure-img"></p>
<figcaption>P.tuahiniensis WGBS MultiQC GC content plot showing multiple peaks</figcaption>
</figure>
</div>
</section>
<section id="references" class="level1">
<h1>REFERENCES</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ewels2016" class="csl-entry">
Ewels, Philip, Måns Magnusson, Sverker Lundin, and Max Käller. 2016. “MultiQC: Summarize Analysis Results for Multiple Tools and Samples in a Single Report.” <em>Bioinformatics</em> 32 (19): 3047–48. <a href="https://doi.org/10.1093/bioinformatics/btw354" class="uri">https://doi.org/10.1093/bioinformatics/btw354</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2025</category>
  <category>Pocillopora tuahiniensis</category>
  <category>E5</category>
  <category>deep-dive-expression</category>
  <category>FastQC</category>
  <category>MultiQC</category>
  <category>WGBS</category>
  <category>BS-seq</category>
  <category>bisulfite sequencing</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2025/2025-02-06-FastQC-MultiQC---P.tuahiniensis-WGBS-E5-Deep-Dive-Expression/</guid>
  <pubDate>Thu, 06 Feb 2025 08:00:00 GMT</pubDate>
  <media:content url="https://robertslab.github.io/sams-notebook/posts/2025/2025-02-06-FastQC-MultiQC---P.tuahiniensis-WGBS-E5-Deep-Dive-Expression/20250206-ptua-multiqc-plot-sequence-content.png" medium="image" type="image/png" height="70" width="144"/>
</item>
<item>
  <title>FastQC MultiQC - A.pulchra WGBS E5 Deep Dive Expression</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2025/2025-02-06-FastQC-MultiQC---A.pulchra-WGBS-E5-Deep-Dive-Expression/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>Ran FastQC and MultiQC quality checks on the <em>A.pulchra</em> raw whole genome bisulfite sequencing (WGBS) data <a href="../../../posts/2025/2025-02-03-Data-Received---E5-Coral-WGBS-from-Genohub-Project-2216545-Using-Rclone-on-Owl/index.html">received 20250203</a>, as part of <a href="https://github.com/urol-e5/deep-dive-expression">urol-e5/deep-dive-expression</a>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The contents below are from markdown knitted from <a href="https://github.com/urol-e5/deep-dive-expression/blob/06f8620587e96ecce970b79bd9e501bbd2a6812e/D-Apul/code/00.00-D-Apul-WGBS-reads-FastQC-MultiQC.Rmd"><code>00.00-D-Apul-WGBS-reads-FastQC-MultiQC</code></a> (commit <code>06f8620</code>).</p>
</div>
</div>
</section>
<section id="background" class="level1">
<h1>1 Background</h1>
<p>This Rmd file will download raw WGBS-seq FastQs for <em>A.pulchra</em> and evaluate them using <a href="https://github.com/s-andrews/FastQC">FastQC</a> and <a href="https://multiqc.info/">MultiQC</a> (Ewels et al.&nbsp;2016).</p>
</section>
<section id="create-a-bash-variables-file" class="level1">
<h1>2 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export deep_dive_expression_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/deep-dive-expression'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export output_dir_top=${deep_dive_expression_dir}/D-Apul/output/00.00-D-Apul-WGBS-reads-FastQC-MultiQC'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_fastqc_dir=${output_dir_top}/raw-fastqc'</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_dir=${deep_dive_expression_dir}/D-Apul/data/raw-fastqs'</span></span>
<span id="cb1-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_url="https://owl.fish.washington.edu/nightingales/E5-coral-deep-dive-expression/genohub2216545/"'</span></span>
<span id="cb1-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Paths to programs"</span></span>
<span id="cb1-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastqc=/home/shared/FastQC-0.12.1/fastqc'</span></span>
<span id="cb1-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export multiqc=/home/sam/programs/mambaforge/bin/multiqc'</span></span>
<span id="cb1-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-17"></span>
<span id="cb1-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set FastQ filename patterns"</span></span>
<span id="cb1-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export fastq_pattern='*.fastq.gz'"</span></span>
<span id="cb1-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R1_fastq_pattern='*_R1_*.fastq.gz'"</span></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R2_fastq_pattern='*_R2_*.fastq.gz'"</span></span>
<span id="cb1-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-23"></span>
<span id="cb1-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set number of CPUs to use"</span></span>
<span id="cb1-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=40'</span></span>
<span id="cb1-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-27"></span>
<span id="cb1-28"></span>
<span id="cb1-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"## Inititalize arrays"</span></span>
<span id="cb1-30"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R1=()'</span></span>
<span id="cb1-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R2=()'</span></span>
<span id="cb1-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_fastqs_array=()'</span></span>
<span id="cb1-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R1_names_array=()'</span></span>
<span id="cb1-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R2_names_array=()'</span></span>
<span id="cb1-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-36"></span>
<span id="cb1-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Programs associative array"</span></span>
<span id="cb1-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"declare -A programs_array"</span></span>
<span id="cb1-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"programs_array=("</span></span>
<span id="cb1-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[fastqc]="${fastqc}" \'</span></span>
<span id="cb1-41"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[multiqc]="${multiqc}" \'</span></span>
<span id="cb1-42"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span></span>
<span id="cb1-43"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-44"></span>
<span id="cb1-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Print formatting"</span></span>
<span id="cb1-46"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-47"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-48"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-49"></span>
<span id="cb1-50"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export deep_dive_expression_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/deep-dive-expression
export output_dir_top=${deep_dive_expression_dir}/D-Apul/output/00.00-D-Apul-WGBS-reads-FastQC-MultiQC
export raw_fastqc_dir=${output_dir_top}/raw-fastqc
export raw_reads_dir=${deep_dive_expression_dir}/D-Apul/data/raw-fastqs
export raw_reads_url="https://owl.fish.washington.edu/nightingales/E5-coral-deep-dive-expression/genohub2216545/"

# Paths to programs
export fastqc=/home/shared/FastQC-0.12.1/fastqc
export multiqc=/home/sam/programs/mambaforge/bin/multiqc

# Set FastQ filename patterns
export fastq_pattern='*.fastq.gz'
export R1_fastq_pattern='*_R1_*.fastq.gz'
export R2_fastq_pattern='*_R2_*.fastq.gz'

# Set number of CPUs to use
export threads=40

## Inititalize arrays
export fastq_array_R1=()
export fastq_array_R2=()
export raw_fastqs_array=()
export R1_names_array=()
export R2_names_array=()

# Programs associative array
declare -A programs_array
programs_array=(
[fastqc]="${fastqc}" \
[multiqc]="${multiqc}" \
)

# Print formatting
export line="--------------------------------------------------------"</code></pre>
</section>
<section id="download-a.pulchra-rna-seq-fastqs" class="level1">
<h1>3 Download <em>A.pulchra</em> RNA-seq FastQs</h1>
<p>Reads are downloaded from <a href="https://owl.fish.washington.edu/nightingales/E5-coral-deep-dive-expression/genohub2216545/" class="uri">https://owl.fish.washington.edu/nightingales/E5-coral-deep-dive-expression/genohub2216545/</a></p>
<p>Since sequencing included multiple species, the code will also parse only those that are <em>A.pulchra</em>.</p>
<p>The <code>--cut-dirs 3</code> command cuts the preceding directory structure (i.e.&nbsp;<code>nightingales/E5-coral-deep-dive-expression/genohub2216545/</code>) so that we just end up with the reads.</p>
<section id="inspect-metadata-file" class="level2">
<h2 class="anchored" data-anchor-id="inspect-metadata-file">3.1 Inspect metadata file</h2>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${deep_dive_expression_dir}</span>/M-multi-species/data/e5_deep_dive_WGBS_metadata.csv <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span></span>
<span id="cb3-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">column</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span></span></code></pre></div>
<pre><code>Number  Species                   Timepoint  Collection Date  Site   colony_id  Extraction Date  Extraction notebook post                                                                                                      DNA (ng/uL)  Volume eluted  Total DNA (ng)  Primer  Date Prepped  Library concentration (ng/uL)  bp peak  Library volume (uL)  Prep notebook post                                                                                                             Notes
403     Pocillopora tuahiniensis  TP2        20200305         Site1  POC-48     20211129         https://github.com/Kterpis/Putnam_Lab_Notebook/blob/master/_posts/2021-11-29-20211129-RNA-DNA-extractions-from-E5-project.md  29.1         90             2619            25      20240613      8.67                           253      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  Labeled as POC-55 in KXT extraction post 
413     Acropora pulchra          TP2        20200305         Site1  ACR-178    20210902         https://github.com/Kterpis/Putnam_Lab_Notebook/blob/master/_posts/2021-09-02-20210902-RNA-DNA-extractions-from-E5-project.md  19.9         90             1791            26      20240613      9.64                           269      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  
417     Pocillopora tuahiniensis  TP2        20200305         Site1  POC-57     20211020         https://kterpis.github.io/Putnam_Lab_Notebook/20211020-RNA-DNA-extractions-from-E5-project/                                   51.4         90             4626            27      20240613      9.3                            256      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  Labeled as POC-238 in KXT extraction post 
423     Acropora pulchra          TP2        20200305         Site1  ACR-150    20210903         https://github.com/Kterpis/Putnam_Lab_Notebook/blob/master/_posts/2021-09-03-20210903-RNA-DNA-extractions-from-E5-project.md  17.7         90             1593            29      20240613      8.61                           267      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  Labeled as POR-75 in KXT extraction post 
427     Acropora pulchra          TP2        20200305         Site1  ACR-145    20211012         https://kterpis.github.io/Putnam_Lab_Notebook/20211012-RNA-DNA-extractions-from-E5-project/                                   19.6         90             1764            30      20240613      8.82                           271      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  
439     Acropora pulchra          TP2        20200305         Site1  ACR-173    20211102         https://kterpis.github.io/Putnam_Lab_Notebook/20211102-RNA-DNA-extractions-from-E5-project/                                   19.9         90             1791            31      20240613      11.9                           264      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  
467     Acropora pulchra          TP2        20200305         Site1  ACR-140    20210921         https://github.com/Kterpis/Putnam_Lab_Notebook/blob/master/_posts/2021-09-21-20210921-RNA-DNA-extractions-from-E5-project.md  21.9         90             1971            32      20240613      16                             270      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  DNA 1 and 2 Qubit readings are 27.6 and 27.4 but average is reported as 4.79 on github and on master sample sheet; JA re-qubited on 20240229 and got 21.9 ul/ng
471     Porites evermanni         TP2        20200305         Site1  POR-76     20211015         https://kterpis.github.io/Putnam_Lab_Notebook/20211015-RNA-DNA-extractions-from-E5-project/                                   2.7          90             243             33      20240613      5.25                           245      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  
491     Porites evermanni         TP2        20200305         Site1  POR-73     20211101         https://kterpis.github.io/Putnam_Lab_Notebook/20211101-RNA-DNA-extractions-from-E5-project/                                   2.11         90             189.9           36      20240613      4.65                           315      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  </code></pre>
</section>
<section id="download-raw-reads" class="level2">
<h2 class="anchored" data-anchor-id="download-raw-reads">3.2 Download raw reads</h2>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directory if it doesn't exist</span></span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span></span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create list of only A.pulchra sample names</span></span>
<span id="cb5-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$6 ~ /^ACR/ {print $1}'</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${deep_dive_expression_dir}</span>/M-multi-species/data/e5_deep_dive_WGBS_metadata.csv<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-9"></span>
<span id="cb5-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample list:"</span></span>
<span id="cb5-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_list}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-19"></span>
<span id="cb5-20"></span>
<span id="cb5-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use printf to format each item for use in wget</span></span>
<span id="cb5-22"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">formatted_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*%s_*,"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_list})</span></span>
<span id="cb5-23"></span>
<span id="cb5-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove the trailing comma</span></span>
<span id="cb5-25"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">formatted_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${formatted_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb5-26"></span>
<span id="cb5-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output the final wget command</span></span>
<span id="cb5-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-30"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Formatted wget accept list:"</span></span>
<span id="cb5-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wget --accept=</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$formatted_list</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-36"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-37"></span>
<span id="cb5-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run wget to retrieve FastQs and MD5 files</span></span>
<span id="cb5-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Note: the --no-clobber command will skip re-downloading any files that are already present in the output directory</span></span>
<span id="cb5-40"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-41">--directory-prefix <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-42">--recursive <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-43">--no-check-certificate <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-44">--continue <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-45">--cut-dirs 3 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-46">--no-host-directories <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-47">--no-parent <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-48">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-49">--no-clobber <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-50">--accept=<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${formatted_list}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_url}</span></span>
<span id="cb5-51"></span>
<span id="cb5-52"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</section>
<section id="verify-raw-read-checksums" class="level2">
<h2 class="anchored" data-anchor-id="verify-raw-read-checksums">3.3 Verify raw read checksums</h2>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb6-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb6-5"></span>
<span id="cb6-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Checksums file contains other files, so this just looks for the RNAseq files.</span></span>
<span id="cb6-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.md5</span>
<span id="cb6-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb6-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--check</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb6-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<pre><code>413_S1_R1_001.fastq.gz: OK
413_S1_R2_001.fastq.gz: OK
423_S2_R1_001.fastq.gz: OK
423_S2_R2_001.fastq.gz: OK
427_S3_R1_001.fastq.gz: OK
427_S3_R2_001.fastq.gz: OK
439_S4_R1_001.fastq.gz: OK
439_S4_R2_001.fastq.gz: OK
467_S5_R1_001.fastq.gz: OK
467_S5_R2_001.fastq.gz: OK</code></pre>
</section>
</section>
<section id="fastqcmultiqc-on-raw-reads" class="level1">
<h1>4 FastQC/MultiQC on raw reads</h1>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb8-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb8-3"></span>
<span id="cb8-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directory if it doesn't exist</span></span>
<span id="cb8-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb8-6"></span>
<span id="cb8-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN FASTQC ############</span></span>
<span id="cb8-8"></span>
<span id="cb8-9"></span>
<span id="cb8-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of trimmed FastQs</span></span>
<span id="cb8-11"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">raw_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(${raw_reads_dir}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_pattern})</span></span>
<span id="cb8-12"></span>
<span id="cb8-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pass array contents to new variable as space-delimited list</span></span>
<span id="cb8-14"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">raw_fastqc_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[*]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb8-15"></span>
<span id="cb8-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning FastQC on raw reads..."</span></span>
<span id="cb8-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb8-18"></span>
<span id="cb8-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run FastQC</span></span>
<span id="cb8-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Do NOT quote raw_fastqc_list</span></span>
<span id="cb8-21"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>fastqc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-22">--threads <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-23">--outdir <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-24">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-25"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_list}</span></span>
<span id="cb8-26"></span>
<span id="cb8-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC on raw reads complete!"</span></span>
<span id="cb8-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb8-29"></span>
<span id="cb8-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> FASTQC ############</span></span>
<span id="cb8-31"></span>
<span id="cb8-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN MULTIQC ############</span></span>
<span id="cb8-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning MultiQC on raw FastQC..."</span></span>
<span id="cb8-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb8-35"></span>
<span id="cb8-36"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>multiqc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span></span>
<span id="cb8-37"></span>
<span id="cb8-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb8-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MultiQC on raw FastQs complete."</span></span>
<span id="cb8-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb8-41"></span>
<span id="cb8-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> MULTIQC ############</span></span>
<span id="cb8-43"></span>
<span id="cb8-44"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Removing FastQC zip files."</span></span>
<span id="cb8-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb8-46"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.zip</span>
<span id="cb8-47"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC zip files removed."</span></span>
<span id="cb8-48"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span></code></pre></div>
<pre><code>Beginning FastQC on raw reads...

application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
FastQC on raw reads complete!

Beginning MultiQC on raw FastQC...


  /// MultiQC 🔍 | v1.14

|           multiqc | MultiQC Version v1.27 now available!
|           multiqc | Search path : /home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/deep-dive-expression/D-Apul/output/00.00-D-Apul-WGBS-reads-FastQC-MultiQC/raw-fastqc
|         searching | ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 20/20  
|            fastqc | Found 10 reports
|           multiqc | Compressing plot data
|           multiqc | Report      : ../output/00.00-D-Apul-WGBS-reads-FastQC-MultiQC/raw-fastqc/multiqc_report.html
|           multiqc | Data        : ../output/00.00-D-Apul-WGBS-reads-FastQC-MultiQC/raw-fastqc/multiqc_data
|           multiqc | MultiQC complete

MultiQC on raw FastQs complete.

Removing FastQC zip files.

FastQC zip files removed.</code></pre>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb10-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb10-3"></span>
<span id="cb10-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># View directory contents</span></span>
<span id="cb10-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span></span></code></pre></div>
<pre><code>total 6.9M
-rw-r--r-- 1 sam sam 579K Feb  6 11:25 413_S1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 586K Feb  6 11:25 413_S1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 580K Feb  6 11:30 423_S2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 582K Feb  6 11:31 423_S2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 578K Feb  6 11:31 427_S3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 581K Feb  6 11:32 427_S3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 577K Feb  6 11:28 439_S4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 581K Feb  6 11:29 439_S4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 576K Feb  6 11:32 467_S5_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 579K Feb  6 11:33 467_S5_R2_001_fastqc.html
drwxr-xr-x 2 sam sam 4.0K Feb  6 11:33 multiqc_data
-rw-r--r-- 1 sam sam 1.3M Feb  6 11:33 multiqc_report.html</code></pre>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<p><a href="https://multiqc.info/"><code>MultiQC</code></a> HTML file is here:</p>
<ul>
<li><a href="https://github.com/urol-e5/deep-dive-expression/blob/06f8620587e96ecce970b79bd9e501bbd2a6812e/D-Apul/output/00.00-D-Apul-WGBS-reads-FastQC-MultiQC/raw-fastqc/multiqc_report.html"><code>multiqc_report.html</code></a> (commit: <code>06f8620</code>)</li>
</ul>
<p>Overall, looks like the first 10bp need to be trimmed, as well as adapters and polyG sequence.</p>
</section>
<section id="references" class="level1">
<h1>REFERENCES</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ewels2016" class="csl-entry">
Ewels, Philip, Måns Magnusson, Sverker Lundin, and Max Käller. 2016. “MultiQC: Summarize Analysis Results for Multiple Tools and Samples in a Single Report.” <em>Bioinformatics</em> 32 (19): 3047–48. <a href="https://doi.org/10.1093/bioinformatics/btw354" class="uri">https://doi.org/10.1093/bioinformatics/btw354</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2025</category>
  <category>Acropora pulchra</category>
  <category>E5</category>
  <category>deep-dive-expression</category>
  <category>FastQC</category>
  <category>MultiQC</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2025/2025-02-06-FastQC-MultiQC---A.pulchra-WGBS-E5-Deep-Dive-Expression/</guid>
  <pubDate>Thu, 06 Feb 2025 08:00:00 GMT</pubDate>
  <media:content url="https://robertslab.github.io/sams-notebook/posts/2025/2025-02-06-FastQC-MultiQC---A.pulchra-WGBS-E5-Deep-Dive-Expression/20250206-apul-multiqc-plot-01.png" medium="image" type="image/png" height="67" width="144"/>
</item>
<item>
  <title>Data Received - E5 Coral WGBS from Genohub Project 2216545 Using Rclone on Owl</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2025/2025-02-03-Data-Received---E5-Coral-WGBS-from-Genohub-Project-2216545-Using-Rclone-on-Owl/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>Whole genome bisulfite sequencing (WGBS) data was received from Genohub for Project 2216545, as part of <a href="https://github.com/urol-e5/deep-dive-expression">urol-e5/deep-dive-expression</a>. Genohub provided Amazon AWS S3 credentials for downloading. Installation of the AWS command line interface (CLI) was a bit too involved to try to figure out on Owl (our Synology server), which might be BSD Linux? Instead, I installed and configured <a href="https://rclone.org/">rclone</a> on Owl.</p>
</section>
<section id="methods" class="level1">
<h1>METHODS</h1>
<section id="configuring-rclone" class="level2">
<h2 class="anchored" data-anchor-id="configuring-rclone">Configuring Rclone</h2>
<p>Installation was a breeze. SSH’d into and then used the following command provided on the <a href="https://rclone.org/downloads/">rclone Downloads page</a>:</p>
<p><code>sudo -v ; curl https://rclone.org/install.sh | sudo bash</code></p>
<p>I performed the initial configuration step using the credentials supplied by Genohub.</p>
<ul>
<li><code>rclone config</code></li>
</ul>
<p>Then, I ran the list command to view the contents of the S3 bucket on AWS:</p>
<p><code>rclone ls remote:</code></p>
<p>However, this did <em>not</em> work!</p>
<pre><code>2025/02/03 12:57:43 NOTICE: Failed to ls: operation error S3: ListBuckets, https response error StatusCode: 403, RequestID: SH6FBZZSFZVEFBMG, HostID: &lt;redacted&gt;, api error AccessDenied: User: arn:aws:iam::&lt;redacted&gt;:user/remote is not authorized to perform: s3:ListAllMyBuckets because no identity-based policy allows the s3:ListAllMyBuckets action</code></pre>
<p>After some sleuthing in the Genohub documentation for using the AWS CLI, I realized I needed to specify the S3 bucket. In order to specify an S3 bucket with rclone, you need to <a href="https://rclone.org/alias/">create an rclone alias</a> - you cannot configure S3 to access a bucket directory.</p>
<p>So, I set up an alias with rclone:</p>
<ol type="1">
<li><p>Run <code>rclone config</code></p></li>
<li><p>Specify <code>n) New remote</code></p></li>
<li><p><code>name&gt; genohub</code></p></li>
<li><p>Specify <code>alias</code> as storage type:</p>
<pre><code>Type of storage to configure.
Choose a number from below, or type in your own value

&gt;alias</code></pre></li>
<li><p><code>remote&gt; remote:genohub_bucket</code></p></li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>You need to replace <code>&lt;genohub_bucket&gt;</code> with the actual bucket ID provided by Genohub.</p>
</div>
</div>
<ol start="6" type="1">
<li>Save the configuration at the prompt.</li>
</ol>
<p>Then, you can actually access your data using the alias <code>genohub</code>:</p>
<p><code>rclone ls genohub:</code></p>
</section>
</section>
<section id="data" class="level1">
<h1>DATA</h1>
<p>All files were downloaded to <code>owl:/volume1/web/nightingales/E5-coral-deep-dive-expression/genohub2216545</code> and MD5 checksums verified:</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>An astute reader might notice that the screenshot below shows a different directory than that listed above. At the time of downloading, I wasn’t sure which project this belonged to. I have since updated and moved the data to the correct directory.</p>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2025/2025-02-03-Data-Received---E5-Coral-WGBS-from-Genohub-Project-2216545-Using-Rclone-on-Owl/20250203-e5-wgbs-genohub-md5-verification-01.png" class="img-fluid figure-img"></p>
<figcaption>Screenshot of MD5 checksum verifications.</figcaption>
</figure>
</div>


</section>

 ]]></description>
  <category>2025</category>
  <category>E5</category>
  <category>coral</category>
  <category>WGBS</category>
  <category>BS-seq</category>
  <category>bisulfite sequencing</category>
  <category>Genohub</category>
  <category>2216545</category>
  <category>Data Received</category>
  <category>rclone</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2025/2025-02-03-Data-Received---E5-Coral-WGBS-from-Genohub-Project-2216545-Using-Rclone-on-Owl/</guid>
  <pubDate>Mon, 03 Feb 2025 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Differential Expression - R.philippinarum miRNAs Using DEseq2</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2025/2025-01-31-Differential-Expression---R.philippinarum-miRNAs-Using-DEseq2/</link>
  <description><![CDATA[ 





<p>This analysis was done as part of <a href="https://github.com/RobertsLab/project-clam-oa"><code>project-clam-oa</code></a> (GitHub repo).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The contents below are from markdown knitted from <a href="https://github.com/RobertsLab/project-clam-oa/blob/3eb5caaa2d7906f182450877a4df6bad61e5e14e/code/03.00-sRNAseq-gene-expression-DESeq2.Rmd"><code>03.00-D-sRNAseq-gene-expression-DESeq2.Rmd</code></a> (commit <code>3eb5caa</code>).</p>
</div>
</div>
<section id="background" class="level1">
<h1>1 Background</h1>
<p>This will run <a href="https://bioconductor.org/packages/release/bioc/vignettes/DESeq2/inst/doc/DESeq2.html">DEseq2</a> (Love, Huber, and Anders 2014) to determine if any of the miRNAs identified by ShortStack in <a href="https://github.com/RobertsLab/project-clam-oa/blob/2616d45a5a0bbef23081c5824bfe5bad6b89d227/code/02.00-ShortStack-31bp-fastp-merged.md">02.00-ShortStack-31bp-fastp-merged.md</a> analysis are differentially expressed between control/treatment.</p>
<p>This was initially run with a log2 fold change threshold set to 1 (which is equivalent to a 2-fold change in expression), but that returned 0 differentially expressed miRNAs. As such, this was run again with the log2 fold change threshold set to 0.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>ShortStack identified 37 miRNAs.</p>
</div>
</div>
<p>This notebook will also run <a href="https://bioconductor.org/packages/release/bioc/vignettes/DESeq2/inst/doc/DESeq2.html">DEseq2</a> (Love, Huber, and Anders 2014) on <em>all</em> sRNAs to identify any differential expression.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>This includes the 37 miRNAs identified by ShortStack.</p>
</div>
</div>
<section id="inputs" class="level2">
<h2 class="anchored" data-anchor-id="inputs">1.1 Inputs</h2>
<ul>
<li><p><a href="https://github.com/RobertsLab/project-clam-oa/blob/d380ed9a88c874db5434c9ec74f6ab1de042bad5/output/02.00-ShortStack-31bp-fastp-merged/ShortStack_out/Counts.txt"><code>Counts.txt</code></a>: ShortStack counts matrix. Includes all clusters, including those that were <em>not</em> categorized as miRNAs.</p></li>
<li><p><a href="https://github.com/RobertsLab/project-clam-oa/blob/d380ed9a88c874db5434c9ec74f6ab1de042bad5/output/03.00-sRNAseq-gene-expression-DESeq2/DESeq2-coldata.tab"><code>DESeq2-coldata.tab</code></a>: Two column table with sample ID and treatment. This file is also an output from this notebook.</p></li>
<li><p><a href="https://github.com/RobertsLab/project-clam-oa/blob/d380ed9a88c874db5434c9ec74f6ab1de042bad5/data/ManilaOA2023_shortRNASeq_Meta.csv">ManilaOA2023_shortRNASeq_Meta.csv</a>: Metadata file for this sRNA-seq data.</p></li>
</ul>
</section>
<section id="outputs" class="level2">
<h2 class="anchored" data-anchor-id="outputs">1.2 Outputs</h2>
<ul>
<li><p><a href="https://github.com/RobertsLab/project-clam-oa/blob/3a9131cc5af82e756990d735b1ad56aecc32008c/output/03.00-sRNAseq-gene-expression-DESeq2/DE-miRNAs.fdr-0.05.lfc-0.tab"><code>DE-miRNAs.fdr-0.05.lfc-0.tab</code></a>: Tab-delimited list of differentially expressed miRNA “clusters” from the ShortStack <code>Results.txt</code> file.</p></li>
<li><p><a href="https://github.com/RobertsLab/project-clam-oa/blob/3a9131cc5af82e756990d735b1ad56aecc32008c/output/03.00-sRNAseq-gene-expression-DESeq2/DE-sRNAs.fdr-0.05.lfc-0.tab"><code>DE-sRNAs.fdr-0.05.lfc-0.tab</code></a>: Tab-delimited list of differentially expressed sRNA “clusters” from the ShortStack <code>Results.txt</code> file. Since this is any sRNA, results may also include miRNAs identified by ShortStack.</p></li>
<li><p><a href="https://github.com/RobertsLab/project-clam-oa/blob/3a9131cc5af82e756990d735b1ad56aecc32008c/output/03.00-sRNAseq-gene-expression-DESeq2/DESeq2-coldata.tab"><code>DESeq2-coldata.tab</code></a>: Two column table with sample ID and treatment. Needed as input to DEseq2.</p></li>
<li><p><a href="https://github.com/RobertsLab/project-clam-oa/blob/3a9131cc5af82e756990d735b1ad56aecc32008c/output/03.00-sRNAseq-gene-expression-DESeq2/deseq2.miRNAs.fdr-0.05.lfc-0.table.csv"><code>deseq2.miRNAs.fdr-0.05.lfc-0.table.csv</code></a>: DEseq2 miRNA output table of results with adjusted p-value &lt;= 0.05 and a log<sub>2</sub> fold change value = 0.</p></li>
<li><p><a href="https://github.com/RobertsLab/project-clam-oa/blob/3a9131cc5af82e756990d735b1ad56aecc32008c/output/03.00-sRNAseq-gene-expression-DESeq2/deseq2.miRNAs.table.csv"><code>deseq2.miRNAs.table.csv</code></a>: Unfiltered DEseq2 miRNA output table containing all results with mean expression, fold change in expression, and adjusted p-values for all input samples.</p></li>
<li><p><a href="https://github.com/RobertsLab/project-clam-oa/blob/3a9131cc5af82e756990d735b1ad56aecc32008c/output/03.00-sRNAseq-gene-expression-DESeq2/deseq2.sRNAs.fdr-0.05.lfc-0.table.csv"><code>deseq2.sRNAs.fdr-0.05.lfc-0.table.csv</code></a>: DEseq2 sRNA output table of results with adjusted p-value &lt;= 0.05 and a log<sub>2</sub> fold change value = 0.</p></li>
<li><p><a href="https://github.com/RobertsLab/project-clam-oa/blob/3a9131cc5af82e756990d735b1ad56aecc32008c/output/03.00-sRNAseq-gene-expression-DESeq2/deseq2.sRNAs.table.csv"><code>deseq2.sRNAs.table.csv</code></a>: Unfiltered DEseq2 sRNA output table containing all results with mean expression, fold change in expression, and adjusted p-values for all input samples.</p></li>
</ul>
</section>
</section>
<section id="set-r-variables" class="level1">
<h1>2 Set R variables</h1>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the output directory path</span></span>
<span id="cb1-2">output_dir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/03.00-sRNAseq-gene-expression-DESeq2/"</span></span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set desired false discovery rate threshold (i.e. adjusted p-value, padj)</span></span>
<span id="cb1-5">fdr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span></span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set log2 fold change threshold (a value of '1' is equal to a fold change of '2')</span></span>
<span id="cb1-8">log2fc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span></code></pre></div>
</section>
<section id="load-count-data" class="level1">
<h1>3 Load count data</h1>
<p>Load in the sRNA count matrix generated using ShortStack 4.1.1. Keep in mind this data includes counts of all sRNAs, not just miRNAs.</p>
<p>Counts generated in <code>02.00-ShortStack-31bp-fastp-merged</code>.</p>
<section id="select-only-mirnas-idd-by-shortstack" class="level2">
<h2 class="anchored" data-anchor-id="select-only-mirnas-idd-by-shortstack">3.1 Select only miRNAs IDd by ShortStack</h2>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read in sRNA counts data</span></span>
<span id="cb2-2">miRNA_seq_counts_shortstack <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_delim</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/02.00-ShortStack-31bp-fastp-merged/ShortStack_out/Counts.txt"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delim=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb2-3"></span>
<span id="cb2-4">miRNA_seq_counts_shortstack <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> miRNA_seq_counts_shortstack <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(MIRNA <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Y"</span>)</span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(miRNA_seq_counts_shortstack)</span></code></pre></div>
<pre><code>spc_tbl_ [37 × 23] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ Coords                                        : chr [1:37] "NW_026852415.1:231396-231495" "NW_026852524.1:285406-285505" "NW_026852815.1:56435-56532" "NW_026853363.1:213466-213568" ...
 $ Name                                          : chr [1:37] "Cluster_1785" "Cluster_2042" "Cluster_2646" "Cluster_3720" ...
 $ MIRNA                                         : chr [1:37] "Y" "Y" "Y" "Y" ...
 $ 196-fastp-adapters-polyG-31bp-merged_condensed: num [1:37] 693 108457 1808 37 9 ...
 $ 199-fastp-adapters-polyG-31bp-merged_condensed: num [1:37] 503 137906 1592 24 4 ...
 $ 211-fastp-adapters-polyG-31bp-merged_condensed: num [1:37] 663 154248 2026 23 2 ...
 $ 24-fastp-adapters-polyG-31bp-merged_condensed : num [1:37] 557 136805 1276 34 8 ...
 $ 260-fastp-adapters-polyG-31bp-merged_condensed: num [1:37] 1419 120261 1468 178 8 ...
 $ 26-fastp-adapters-polyG-31bp-merged_condensed : num [1:37] 559 124995 1580 29 0 ...
 $ 30-fastp-adapters-polyG-31bp-merged_condensed : num [1:37] 780 157279 2265 19 4 ...
 $ 310-fastp-adapters-polyG-31bp-merged_condensed: num [1:37] 569 154690 1765 15 2 ...
 $ 33-fastp-adapters-polyG-31bp-merged_condensed : num [1:37] 442 116913 1420 13 9 ...
 $ 341-fastp-adapters-polyG-31bp-merged_condensed: num [1:37] 728 121161 1344 7 2 ...
 $ 34-fastp-adapters-polyG-31bp-merged_condensed : num [1:37] 665 143730 1736 14 5 ...
 $ 35-fastp-adapters-polyG-31bp-merged_condensed : num [1:37] 607 128534 1683 26 1 ...
 $ 363-fastp-adapters-polyG-31bp-merged_condensed: num [1:37] 538 95266 1408 15 6 ...
 $ 367-fastp-adapters-polyG-31bp-merged_condensed: num [1:37] 520 119389 1315 7 1 ...
 $ 376-fastp-adapters-polyG-31bp-merged_condensed: num [1:37] 1029 217736 2833 14 2 ...
 $ 460-fastp-adapters-polyG-31bp-merged_condensed: num [1:37] 571 139439 1466 9 6 ...
 $ 485-fastp-adapters-polyG-31bp-merged_condensed: num [1:37] 579 154776 1747 11 4 ...
 $ 501-fastp-adapters-polyG-31bp-merged_condensed: num [1:37] 1182 167181 2135 174 3 ...
 $ 71-fastp-adapters-polyG-31bp-merged_condensed : num [1:37] 392 1097 11123 1248 5 ...
 $ 88-fastp-adapters-polyG-31bp-merged_condensed : num [1:37] 552 136133 1808 9 1 ...
 - attr(*, "spec")=
  .. cols(
  ..   Coords = col_character(),
  ..   Name = col_character(),
  ..   MIRNA = col_character(),
  ..   `196-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `199-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `211-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `24-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `260-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `26-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `30-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `310-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `33-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `341-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `34-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `35-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `363-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `367-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `376-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `460-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `485-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `501-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `71-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `88-fastp-adapters-polyG-31bp-merged_condensed` = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</section>
<section id="all-srna-seq-counts" class="level2">
<h2 class="anchored" data-anchor-id="all-srna-seq-counts">3.2 All sRNA-seq counts</h2>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read in sRNA counts data</span></span>
<span id="cb4-2">srna_seq_counts_all <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_delim</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/02.00-ShortStack-31bp-fastp-merged/ShortStack_out/Counts.txt"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delim=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(srna_seq_counts_all)</span></code></pre></div>
<pre><code>spc_tbl_ [33,666 × 23] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ Coords                                        : chr [1:33666] "NW_026851514.1:11444-11873" "NW_026851514.1:12401-12830" "NW_026851515.1:76365-77030" "NW_026851515.1:77089-77506" ...
 $ Name                                          : chr [1:33666] "Cluster_1" "Cluster_2" "Cluster_3" "Cluster_4" ...
 $ MIRNA                                         : chr [1:33666] "N" "N" "N" "N" ...
 $ 196-fastp-adapters-polyG-31bp-merged_condensed: num [1:33666] 39 33 179 34 279 68 28 233 40 0 ...
 $ 199-fastp-adapters-polyG-31bp-merged_condensed: num [1:33666] 14 24 7 0 12 2 0 11 1 1 ...
 $ 211-fastp-adapters-polyG-31bp-merged_condensed: num [1:33666] 214 40 979 31 401 35 106 492 56 0 ...
 $ 24-fastp-adapters-polyG-31bp-merged_condensed : num [1:33666] 102 35 311 10 111 16 43 74 15 0 ...
 $ 260-fastp-adapters-polyG-31bp-merged_condensed: num [1:33666] 39 21 132 1 123 21 5 124 23 2 ...
 $ 26-fastp-adapters-polyG-31bp-merged_condensed : num [1:33666] 0 0 808 87 388 20 8 827 215 0 ...
 $ 30-fastp-adapters-polyG-31bp-merged_condensed : num [1:33666] 12 7 448 21 165 26 39 117 38 3 ...
 $ 310-fastp-adapters-polyG-31bp-merged_condensed: num [1:33666] 43 13 857 25 153 0 5 165 3 2 ...
 $ 33-fastp-adapters-polyG-31bp-merged_condensed : num [1:33666] 1 1 320 26 225 24 35 177 97 3 ...
 $ 341-fastp-adapters-polyG-31bp-merged_condensed: num [1:33666] 220 41 671 7 110 19 4 92 32 0 ...
 $ 34-fastp-adapters-polyG-31bp-merged_condensed : num [1:33666] 34 32 1413 28 795 ...
 $ 35-fastp-adapters-polyG-31bp-merged_condensed : num [1:33666] 103 40 497 24 126 57 37 116 29 3 ...
 $ 363-fastp-adapters-polyG-31bp-merged_condensed: num [1:33666] 60 16 833 117 441 89 45 827 200 0 ...
 $ 367-fastp-adapters-polyG-31bp-merged_condensed: num [1:33666] 40 132 426 6 127 23 19 122 127 0 ...
 $ 376-fastp-adapters-polyG-31bp-merged_condensed: num [1:33666] 0 16 2409 187 978 ...
 $ 460-fastp-adapters-polyG-31bp-merged_condensed: num [1:33666] 3 0 331 17 149 40 41 260 28 2 ...
 $ 485-fastp-adapters-polyG-31bp-merged_condensed: num [1:33666] 5 42 5 0 42 4 4 106 2 0 ...
 $ 501-fastp-adapters-polyG-31bp-merged_condensed: num [1:33666] 4 1 363 6 76 ...
 $ 71-fastp-adapters-polyG-31bp-merged_condensed : num [1:33666] 0 0 31 123 671 37 2 691 135 0 ...
 $ 88-fastp-adapters-polyG-31bp-merged_condensed : num [1:33666] 1 41 633 48 354 45 52 200 77 0 ...
 - attr(*, "spec")=
  .. cols(
  ..   Coords = col_character(),
  ..   Name = col_character(),
  ..   MIRNA = col_character(),
  ..   `196-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `199-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `211-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `24-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `260-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `26-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `30-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `310-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `33-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `341-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `34-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `35-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `363-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `367-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `376-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `460-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `485-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `501-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `71-fastp-adapters-polyG-31bp-merged_condensed` = col_double(),
  ..   `88-fastp-adapters-polyG-31bp-merged_condensed` = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</section>
</section>
<section id="create-deseq2-column-data" class="level1">
<h1>4 Create DESeq2 Column Data</h1>
<section id="read-in-metadata-csv" class="level2">
<h2 class="anchored" data-anchor-id="read-in-metadata-csv">4.1 Read in metadata CSV</h2>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load metadata</span></span>
<span id="cb6-2">metadata <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/ManilaOA2023_shortRNASeq_Meta.csv"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(metadata)</span></code></pre></div>
<pre><code>'data.frame':   20 obs. of  6 variables:
 $ ID_simple  : int  196 199 211 310 341 363 367 376 460 485 ...
 $ treatment  : chr  "control" "control" "control" "control" ...
 $ Sex        : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ MeanEggArea: int  NA 3687 3519 3795 3837 3749 NA 3834 3759 NA ...
 $ Species    : chr  "Manila clam" "Manila clam" "Manila clam" "Manila clam" ...
 $ LifeStage  : chr  "Adult" "Adult" "Adult" "Adult" ...</code></pre>
</section>
<section id="extract-sample-names" class="level2">
<h2 class="anchored" data-anchor-id="extract-sample-names">4.2 Extract sample names</h2>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">sample_names <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(miRNA_seq_counts_shortstack) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_subset</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">d+-"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_extract</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">d+"</span>)</span>
<span id="cb8-4"></span>
<span id="cb8-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(sample_names)</span></code></pre></div>
<pre><code> chr [1:20] "196" "199" "211" "24" "260" "26" "30" "310" "33" "341" "34" ...</code></pre>
</section>
<section id="select-sample-name-and-treatment" class="level2">
<h2 class="anchored" data-anchor-id="select-sample-name-and-treatment">4.3 Select sample name and treatment</h2>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">sample_treatment_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> metadata <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(ID_simple, treatment)</span>
<span id="cb10-3"></span>
<span id="cb10-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set sample names as rownames</span></span>
<span id="cb10-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(sample_treatment_df) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> sample_treatment_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ID_simple</span>
<span id="cb10-6"></span>
<span id="cb10-7">sample_treatment_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ID_simple <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb10-8"></span>
<span id="cb10-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(sample_treatment_df)</span></code></pre></div>
<pre><code>'data.frame':   20 obs. of  1 variable:
 $ treatment: chr  "control" "control" "control" "control" ...</code></pre>
</section>
<section id="write-deseq-coldata-to-file" class="level2">
<h2 class="anchored" data-anchor-id="write-deseq-coldata-to-file">4.4 Write DEseq coldata to file</h2>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.table</span>(</span>
<span id="cb12-2">  sample_treatment_df,</span>
<span id="cb12-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/03.00-sRNAseq-gene-expression-DESeq2/DESeq2-coldata.tab"</span>,</span>
<span id="cb12-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,</span>
<span id="cb12-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quote =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb12-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb12-7">)</span></code></pre></div>
</section>
</section>
<section id="shortstack-mirnas" class="level1">
<h1>5 SHORTSTACK miRNAS</h1>
<section id="count-data-munging" class="level2">
<h2 class="anchored" data-anchor-id="count-data-munging">5.1 Count data munging</h2>
<section id="fix-col-names-and-convert-to-matrix" class="level3">
<h3 class="anchored" data-anchor-id="fix-col-names-and-convert-to-matrix">5.1.1 Fix col names and convert to matrix</h3>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">coldata <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> sample_treatment_df</span>
<span id="cb13-2"></span>
<span id="cb13-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove excess portions of sample column names to just "sample###"</span></span>
<span id="cb13-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(miRNA_seq_counts_shortstack) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-fastp-adapters-polyG-31bp-merged_condensed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(miRNA_seq_counts_shortstack))</span>
<span id="cb13-5"></span>
<span id="cb13-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Keep just the counts and cluster names as matrix</span></span>
<span id="cb13-7">miRNA_seq_counts_matrix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>(miRNA_seq_counts_shortstack <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Coords, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>MIRNA) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">column_to_rownames</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Name"</span>))</span>
<span id="cb13-8"></span>
<span id="cb13-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(miRNA_seq_counts_matrix)</span></code></pre></div>
<pre><code> num [1:37, 1:20] 693 108457 1808 37 9 ...
 - attr(*, "dimnames")=List of 2
  ..$ : chr [1:37] "Cluster_1785" "Cluster_2042" "Cluster_2646" "Cluster_3720" ...
  ..$ : chr [1:20] "196" "199" "211" "24" ...</code></pre>
</section>
<section id="take-only-samples-present-in-coldata" class="level3">
<h3 class="anchored" data-anchor-id="take-only-samples-present-in-coldata">5.1.2 Take only samples present in coldata</h3>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">miRNA_common_cols <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">intersect</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(miRNA_seq_counts_matrix),</span>
<span id="cb15-2">                         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(sample_treatment_df))</span>
<span id="cb15-3"></span>
<span id="cb15-4">miRNA_seq_counts_matrix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> miRNA_seq_counts_matrix[, miRNA_common_cols]</span>
<span id="cb15-5"></span>
<span id="cb15-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(miRNA_seq_counts_matrix)</span></code></pre></div>
<pre><code> num [1:37, 1:20] 693 108457 1808 37 9 ...
 - attr(*, "dimnames")=List of 2
  ..$ : chr [1:37] "Cluster_1785" "Cluster_2042" "Cluster_2646" "Cluster_3720" ...
  ..$ : chr [1:20] "196" "199" "211" "24" ...</code></pre>
</section>
<section id="reorder-matrix-cols-to-match-coldata" class="level3">
<h3 class="anchored" data-anchor-id="reorder-matrix-cols-to-match-coldata">5.1.3 Reorder matrix cols to match coldata</h3>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">miRNA_ord <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">match</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(sample_treatment_df), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(miRNA_seq_counts_matrix))</span>
<span id="cb17-2"></span>
<span id="cb17-3">miRNA_seq_counts_matrix_sorted <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> miRNA_seq_counts_matrix[, miRNA_ord]</span>
<span id="cb17-4"></span>
<span id="cb17-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(miRNA_seq_counts_matrix_sorted)</span></code></pre></div>
<pre><code> num [1:37, 1:20] 693 108457 1808 37 9 ...
 - attr(*, "dimnames")=List of 2
  ..$ : chr [1:37] "Cluster_1785" "Cluster_2042" "Cluster_2646" "Cluster_3720" ...
  ..$ : chr [1:20] "196" "199" "211" "310" ...</code></pre>
</section>
<section id="verify-rownames-match" class="level3">
<h3 class="anchored" data-anchor-id="verify-rownames-match">5.1.4 Verify rownames match</h3>
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(coldata) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(miRNA_seq_counts_matrix_sorted))</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
</section>
</section>
<section id="create-deseq2-data-set" class="level2">
<h2 class="anchored" data-anchor-id="create-deseq2-data-set">5.2 Create DESeq2 data set</h2>
<section id="initialize-deseq2-data-set" class="level3">
<h3 class="anchored" data-anchor-id="initialize-deseq2-data-set">5.2.1 Initialize DEseq2 data set</h3>
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">miRNA_dds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DESeqDataSetFromMatrix</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">countData =</span> miRNA_seq_counts_matrix_sorted,</span>
<span id="cb21-2">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colData =</span> coldata,</span>
<span id="cb21-3">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">design =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> treatment)</span>
<span id="cb21-4">miRNA_dds</span></code></pre></div>
<pre><code>class: DESeqDataSet 
dim: 37 20 
metadata(1): version
assays(1): counts
rownames(37): Cluster_1785 Cluster_2042 ... Cluster_32918 Cluster_32919
rowData names(0):
colnames(20): 196 199 ... 71 260
colData names(1): treatment</code></pre>
</section>
<section id="add-cluster-column-as-gene-feature" class="level3">
<h3 class="anchored" data-anchor-id="add-cluster-column-as-gene-feature">5.2.2 Add cluster column as “gene” feature</h3>
<div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1">miRNA_featureData <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(miRNA_seq_counts_matrix_sorted))</span>
<span id="cb23-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcols</span>(miRNA_dds) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DataFrame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcols</span>(miRNA_dds), miRNA_featureData)</span>
<span id="cb23-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcols</span>(miRNA_dds)</span></code></pre></div>
<pre><code>DataFrame with 37 rows and 1 column
                       gene
                &lt;character&gt;
Cluster_1785   Cluster_1785
Cluster_2042   Cluster_2042
Cluster_2646   Cluster_2646
Cluster_3720   Cluster_3720
Cluster_4396   Cluster_4396
...                     ...
Cluster_29018 Cluster_29018
Cluster_31844 Cluster_31844
Cluster_32917 Cluster_32917
Cluster_32918 Cluster_32918
Cluster_32919 Cluster_32919</code></pre>
</section>
<section id="set-factor-levels" class="level3">
<h3 class="anchored" data-anchor-id="set-factor-levels">5.2.3 Set factor levels</h3>
<div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1">miRNA_dds<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>treatment <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(miRNA_dds<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>treatment, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"control"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"treatment"</span>))</span></code></pre></div>
</section>
</section>
<section id="deseq-analysis" class="level2">
<h2 class="anchored" data-anchor-id="deseq-analysis">5.3 DESeq analysis</h2>
<section id="deseq" class="level3">
<h3 class="anchored" data-anchor-id="deseq">5.3.1 DEseq</h3>
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1">miRNA_dds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DESeq</span>(miRNA_dds)</span></code></pre></div>
</section>
<section id="deseq-results" class="level3">
<h3 class="anchored" data-anchor-id="deseq-results">5.3.2 DEseq Results</h3>
<div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1">miRNA_res <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">results</span>(miRNA_dds, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> fdr, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lfcThreshold =</span> log2fc)</span>
<span id="cb27-2"></span>
<span id="cb27-3">miRNA_res</span></code></pre></div>
<pre><code>log2 fold change (MLE): treatment treatment vs control 
Wald test p-value: treatment treatment vs control 
DataFrame with 37 rows and 6 columns
                 baseMean log2FoldChange     lfcSE       stat      pvalue
                &lt;numeric&gt;      &lt;numeric&gt; &lt;numeric&gt;  &lt;numeric&gt;   &lt;numeric&gt;
Cluster_1785  6.63895e+02      0.0149611 0.2810643  0.0532301 0.957548604
Cluster_2042  1.35312e+05     -0.1901409 0.4840889 -0.3927810 0.694481249
Cluster_2646  1.76900e+03      0.0185890 0.0902545  0.2059620 0.836820596
Cluster_3720  4.26842e+01      2.0921221 0.5504186  3.8009659 0.000144133
Cluster_4396  4.09498e+00      0.0360325 0.5609930  0.0642299 0.948787181
...                   ...            ...       ...        ...         ...
Cluster_29018   1661.6392      2.4245029  0.683762   3.545830 0.000391378
Cluster_31844   1372.1080     -0.0477386  0.146375  -0.326140 0.744318793
Cluster_32917     14.7573      0.2194667  0.377211   0.581814 0.560691835
Cluster_32918   1259.4586      0.5004769  0.370048   1.352466 0.176226232
Cluster_32919      4.5894      0.2954022  0.619287   0.477004 0.633359369
                    padj
               &lt;numeric&gt;
Cluster_1785  0.98414718
Cluster_2042  0.94314745
Cluster_2646  0.96982079
Cluster_3720  0.00482699
Cluster_4396  0.98414718
...                  ...
Cluster_29018 0.00482699
Cluster_31844 0.94964812
Cluster_32917 0.94314745
Cluster_32918 0.57114000
Cluster_32919 0.94314745</code></pre>
<div class="sourceCode" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(miRNA_res)</span></code></pre></div>
<pre><code>out of 37 with nonzero total read count
adjusted p-value &lt; 0.05
LFC &gt; 0 (up)       : 3, 8.1%
LFC &lt; 0 (down)     : 1, 2.7%
outliers [1]       : 0, 0%
low counts [2]     : 0, 0%
(mean count &lt; 4)
[1] see 'cooksCutoff' argument of ?results
[2] see 'independentFiltering' argument of ?results</code></pre>
<div class="sourceCode" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">table</span>(miRNA_res<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>padj <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> fdr)</span></code></pre></div>
<pre><code>FALSE  TRUE 
   33     4 </code></pre>
</section>
<section id="write-dds-results-tables-to-csvs" class="level3">
<h3 class="anchored" data-anchor-id="write-dds-results-tables-to-csvs">5.3.3 Write DDS results tables to CSVs</h3>
<div class="sourceCode" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.csv</span>(miRNA_res, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(output_dir, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"deseq2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".miRNAs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".table.csv"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quote =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb33-2"></span>
<span id="cb33-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Subset based on adjusted p-value</span></span>
<span id="cb33-4">miRNA_resSig <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">subset</span>(miRNA_res, padj <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> fdr)</span>
<span id="cb33-5"></span>
<span id="cb33-6">miRNA_resSig</span></code></pre></div>
<pre><code>log2 fold change (MLE): treatment treatment vs control 
Wald test p-value: treatment treatment vs control 
DataFrame with 4 rows and 6 columns
                baseMean log2FoldChange     lfcSE      stat      pvalue
               &lt;numeric&gt;      &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;   &lt;numeric&gt;
Cluster_3720    42.68419        2.09212  0.550419   3.80097 0.000144133
Cluster_15325   27.20988        4.27878  1.188934   3.59883 0.000319647
Cluster_17619    7.68082       -2.71853  0.785237  -3.46205 0.000536073
Cluster_29018 1661.63918        2.42450  0.683762   3.54583 0.000391378
                    padj
               &lt;numeric&gt;
Cluster_3720  0.00482699
Cluster_15325 0.00482699
Cluster_17619 0.00495868
Cluster_29018 0.00482699</code></pre>
<div class="sourceCode" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.csv</span>(miRNA_resSig, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(output_dir, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"deseq2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".miRNAs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".fdr-"</span>, fdr, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".lfc-"</span>, log2fc, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".table.csv"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quote =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
</section>
<section id="identify-differentially-expressed-mirnas" class="level3">
<h3 class="anchored" data-anchor-id="identify-differentially-expressed-mirnas">5.3.4 Identify Differentially Expressed miRNAs</h3>
<div class="sourceCode" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb36-1"></span>
<span id="cb36-2"></span>
<span id="cb36-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract the first column values (excluding the header)</span></span>
<span id="cb36-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clusters</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">','</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-f1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/03.00-sRNAseq-gene-expression-DESeq2/deseq2.miRNAs.fdr-0.05.lfc-0.table.csv"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tail</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> +2<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb36-5"></span>
<span id="cb36-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop through each cluster and search in the Results.txt file</span></span>
<span id="cb36-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> cluster <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$clusters</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> </span>
<span id="cb36-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb36-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$cluster</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/02.00-ShortStack-31bp-fastp-merged/ShortStack_out/Results.txt"</span></span>
<span id="cb36-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb36-11"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> ../output/03.00-sRNAseq-gene-expression-DESeq2/DE-miRNAs.fdr-0.05.lfc-0.tab</span>
<span id="cb36-12"></span>
<span id="cb36-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb36-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--------------------------------------------------------------"</span></span>
<span id="cb36-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb36-16"></span>
<span id="cb36-17"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> cluster <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$clusters</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> </span>
<span id="cb36-18"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb36-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$cluster</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/02.00-ShortStack-31bp-fastp-merged/ShortStack_out/Results.txt"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb36-20">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print $21}'</span></span>
<span id="cb36-21"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<pre><code>NW_026853363.1:213466-213568    Cluster_3720    NW_026853363.1  213466  213568  103 1906    84  1.0 +   AGAUAUGUUUGAUAUAUUUGGU  864 9   11  129 1048    458 251 22  Y   cte-miR-190;mle-miR-190-5p
NW_026858897.1:43133-43248  Cluster_15325   NW_026858897.1  43133   43248   116 1294    54  0.98    +   UGUUCUACGAGCUGUAGCUGU   685 4   34  796 431 29  0   21  Y   NA
NW_026859924.1:190953-191067    Cluster_17619   NW_026859924.1  190953  191067  115 852 54  0.012   -   UGUUCUACGAGCUGUAACUGUC  509 4   70  175 593 10  0   22  Y   NA
NW_026865271.1:194028-194125    Cluster_29018   NW_026865271.1  194028  194125  98  66793   264 1.0 +   UCACAACCUGCUUGAAUGAGGAC 31912   323 43  462 5039    38213   22713   23  Y   mle-miR-67-3p

--------------------------------------------------------------

cte-miR-190;mle-miR-190-5p
NA
NA
mle-miR-67-3p</code></pre>
</section>
</section>
<section id="variance-stabilizing-transformations-vst" class="level2">
<h2 class="anchored" data-anchor-id="variance-stabilizing-transformations-vst">5.4 Variance stabilizing transformations (VST)</h2>
<ul>
<li>Here we transform counts using a variance stabilizing transformation (VST), since we have many samples.</li>
</ul>
<div class="sourceCode" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1">miRNA_vsd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">varianceStabilizingTransformation</span>(miRNA_dds, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">blind=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
</section>
<section id="plotting" class="level2">
<h2 class="anchored" data-anchor-id="plotting">5.5 Plotting</h2>
<section id="sample-distances" class="level3">
<h3 class="anchored" data-anchor-id="sample-distances">5.5.1 Sample distances</h3>
<div class="sourceCode" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1">miRNA_sampleDists <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dist</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">t</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">assay</span>(miRNA_vsd)))</span>
<span id="cb39-2"></span>
<span id="cb39-3">miRNA_sampleDistMatrix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>( miRNA_sampleDists )</span>
<span id="cb39-4"></span>
<span id="cb39-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(miRNA_sampleDistMatrix) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>( miRNA_vsd<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>colony.id, miRNA_vsd<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>time.point, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" - "</span> )</span>
<span id="cb39-6"></span>
<span id="cb39-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(miRNA_sampleDistMatrix) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb39-8"></span>
<span id="cb39-9">colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colorRampPalette</span>( <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rev</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">brewer.pal</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Blues"</span>)) )(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>)</span>
<span id="cb39-10"></span>
<span id="cb39-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pheatmap</span>(miRNA_sampleDistMatrix,</span>
<span id="cb39-12">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clustering_distance_rows =</span> miRNA_sampleDists,</span>
<span id="cb39-13">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clustering_distance_cols =</span> miRNA_sampleDists,</span>
<span id="cb39-14">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> colors)</span></code></pre></div>
<p><img src="https://robertslab.github.io/sams-notebook/posts/2025/2025-01-31-Differential-Expression---R.philippinarum-miRNAs-Using-DEseq2/03.00-sRNAseq-gene-expression-DESeq2_files/figure-gfm/miRNA-plot-sample-distances-1.png" class="img-fluid"><!-- --></p>
</section>
<section id="pca" class="level3">
<h3 class="anchored" data-anchor-id="pca">5.5.2 PCA</h3>
<p>Visualize sample clustering via PCA (after transformation)</p>
<div class="sourceCode" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># PCA with points color coded by time point </span></span>
<span id="cb40-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plotPCA</span>(miRNA_vsd, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intgroup =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"treatment"</span>))</span></code></pre></div>
<p><img src="https://robertslab.github.io/sams-notebook/posts/2025/2025-01-31-Differential-Expression---R.philippinarum-miRNAs-Using-DEseq2/03.00-sRNAseq-gene-expression-DESeq2_files/figure-gfm/miRNA-pca-1.png" class="img-fluid"><!-- --></p>
</section>
<section id="heatmap-of-37-shortstack-mirnas" class="level3">
<h3 class="anchored" data-anchor-id="heatmap-of-37-shortstack-mirnas">5.5.3 Heatmap of 37 ShortStack miRNAs</h3>
<div class="sourceCode" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1">miRNA_counts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">order</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowMeans</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">counts</span>(miRNA_dds,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normalized=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)),</span>
<span id="cb41-2">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decreasing=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">37</span>]</span>
<span id="cb41-3"></span>
<span id="cb41-4">annotation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colData</span>(miRNA_dds) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(treatment)</span>
<span id="cb41-5"></span>
<span id="cb41-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pheatmap</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">assay</span>(miRNA_vsd)[miRNA_counts,], </span>
<span id="cb41-7">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cluster_rows=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, </span>
<span id="cb41-8">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show_rownames=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb41-9">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cluster_cols=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb41-10">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">annotation_col =</span> annotation)</span></code></pre></div>
<p><img src="https://robertslab.github.io/sams-notebook/posts/2025/2025-01-31-Differential-Expression---R.philippinarum-miRNAs-Using-DEseq2/03.00-sRNAseq-gene-expression-DESeq2_files/figure-gfm/miRNA-heatmap-1.png" class="img-fluid"><!-- --></p>
</section>
</section>
</section>
<section id="all-srna" class="level1">
<h1>6 ALL sRNA</h1>
<section id="count-data-munging-1" class="level2">
<h2 class="anchored" data-anchor-id="count-data-munging-1">6.1 Count data munging</h2>
<section id="fix-col-names-and-convert-to-matrix-1" class="level3">
<h3 class="anchored" data-anchor-id="fix-col-names-and-convert-to-matrix-1">6.1.1 Fix col names and convert to matrix</h3>
<div class="sourceCode" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1">coldata <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> sample_treatment_df</span>
<span id="cb42-2"></span>
<span id="cb42-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove excess portions of sample column names to just "sample###"</span></span>
<span id="cb42-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(srna_seq_counts_all) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-fastp-adapters-polyG-31bp-merged_condensed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(srna_seq_counts_all))</span>
<span id="cb42-5"></span>
<span id="cb42-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Keep just the counts and cluster names as matrix</span></span>
<span id="cb42-7">srna_seq_counts_matrix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>(srna_seq_counts_all <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Coords, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>MIRNA) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">column_to_rownames</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Name"</span>))</span>
<span id="cb42-8"></span>
<span id="cb42-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(srna_seq_counts_matrix)</span></code></pre></div>
<pre><code> num [1:33666, 1:20] 39 33 179 34 279 68 28 233 40 0 ...
 - attr(*, "dimnames")=List of 2
  ..$ : chr [1:33666] "Cluster_1" "Cluster_2" "Cluster_3" "Cluster_4" ...
  ..$ : chr [1:20] "196" "199" "211" "24" ...</code></pre>
</section>
<section id="take-only-samples-present-in-coldata-1" class="level3">
<h3 class="anchored" data-anchor-id="take-only-samples-present-in-coldata-1">6.1.2 Take only samples present in coldata</h3>
<div class="sourceCode" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1">sRNA_common_cols <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">intersect</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(srna_seq_counts_matrix),</span>
<span id="cb44-2">                         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(sample_treatment_df))</span>
<span id="cb44-3"></span>
<span id="cb44-4">srna_seq_counts_matrix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> srna_seq_counts_matrix[, sRNA_common_cols]</span>
<span id="cb44-5"></span>
<span id="cb44-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(srna_seq_counts_matrix)</span></code></pre></div>
<pre><code> num [1:33666, 1:20] 39 33 179 34 279 68 28 233 40 0 ...
 - attr(*, "dimnames")=List of 2
  ..$ : chr [1:33666] "Cluster_1" "Cluster_2" "Cluster_3" "Cluster_4" ...
  ..$ : chr [1:20] "196" "199" "211" "24" ...</code></pre>
</section>
<section id="reorder-matrix-cols-to-match-coldata-1" class="level3">
<h3 class="anchored" data-anchor-id="reorder-matrix-cols-to-match-coldata-1">6.1.3 Reorder matrix cols to match coldata</h3>
<div class="sourceCode" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1">sRNA_ord <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">match</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(sample_treatment_df), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(srna_seq_counts_matrix))</span>
<span id="cb46-2"></span>
<span id="cb46-3">srna_seq_counts_matrix_sorted <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> srna_seq_counts_matrix[, sRNA_ord]</span>
<span id="cb46-4"></span>
<span id="cb46-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(srna_seq_counts_matrix_sorted)</span></code></pre></div>
<pre><code> num [1:33666, 1:20] 39 33 179 34 279 68 28 233 40 0 ...
 - attr(*, "dimnames")=List of 2
  ..$ : chr [1:33666] "Cluster_1" "Cluster_2" "Cluster_3" "Cluster_4" ...
  ..$ : chr [1:20] "196" "199" "211" "310" ...</code></pre>
</section>
<section id="verify-rownames-match-1" class="level3">
<h3 class="anchored" data-anchor-id="verify-rownames-match-1">6.1.4 Verify rownames match</h3>
<div class="sourceCode" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(coldata) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(srna_seq_counts_matrix_sorted))</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
</section>
</section>
<section id="create-deseq2-data-set-1" class="level2">
<h2 class="anchored" data-anchor-id="create-deseq2-data-set-1">6.2 Create DESeq2 data set</h2>
<section id="initialize-deseq2-data-set-1" class="level3">
<h3 class="anchored" data-anchor-id="initialize-deseq2-data-set-1">6.2.1 Initialize DEseq2 data set</h3>
<div class="sourceCode" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1">sRNA_dds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DESeqDataSetFromMatrix</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">countData =</span> srna_seq_counts_matrix_sorted,</span>
<span id="cb50-2">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colData =</span> coldata,</span>
<span id="cb50-3">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">design =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> treatment)</span>
<span id="cb50-4">sRNA_dds</span></code></pre></div>
<pre><code>class: DESeqDataSet 
dim: 33666 20 
metadata(1): version
assays(1): counts
rownames(33666): Cluster_1 Cluster_2 ... Cluster_33665 Cluster_33666
rowData names(0):
colnames(20): 196 199 ... 71 260
colData names(1): treatment</code></pre>
</section>
<section id="add-cluster-column-as-gene-feature-1" class="level3">
<h3 class="anchored" data-anchor-id="add-cluster-column-as-gene-feature-1">6.2.2 Add cluster column as “gene” feature</h3>
<div class="sourceCode" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1">sRNA_featureData <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(srna_seq_counts_matrix_sorted))</span>
<span id="cb52-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcols</span>(sRNA_dds) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DataFrame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcols</span>(sRNA_dds), sRNA_featureData)</span>
<span id="cb52-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcols</span>(sRNA_dds)</span></code></pre></div>
<pre><code>DataFrame with 33666 rows and 1 column
                       gene
                &lt;character&gt;
Cluster_1         Cluster_1
Cluster_2         Cluster_2
Cluster_3         Cluster_3
Cluster_4         Cluster_4
Cluster_5         Cluster_5
...                     ...
Cluster_33662 Cluster_33662
Cluster_33663 Cluster_33663
Cluster_33664 Cluster_33664
Cluster_33665 Cluster_33665
Cluster_33666 Cluster_33666</code></pre>
</section>
<section id="set-factor-levels-1" class="level3">
<h3 class="anchored" data-anchor-id="set-factor-levels-1">6.2.3 Set factor levels</h3>
<div class="sourceCode" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1">sRNA_dds<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>treatment <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(sRNA_dds<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>treatment, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"control"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"treatment"</span>))</span></code></pre></div>
</section>
</section>
<section id="deseq-analysis-1" class="level2">
<h2 class="anchored" data-anchor-id="deseq-analysis-1">6.3 DESeq analysis</h2>
<section id="deseq-1" class="level3">
<h3 class="anchored" data-anchor-id="deseq-1">6.3.1 DEseq</h3>
<div class="sourceCode" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1">sRNA_dds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DESeq</span>(sRNA_dds)</span></code></pre></div>
</section>
<section id="deseq-results-1" class="level3">
<h3 class="anchored" data-anchor-id="deseq-results-1">6.3.2 DEseq Results</h3>
<div class="sourceCode" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1">sRNA_res <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">results</span>(sRNA_dds, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> fdr, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lfcThreshold =</span> log2fc)</span>
<span id="cb56-2"></span>
<span id="cb56-3">sRNA_res</span></code></pre></div>
<pre><code>log2 fold change (MLE): treatment treatment vs control 
Wald test p-value: treatment treatment vs control 
DataFrame with 33666 rows and 6 columns
               baseMean log2FoldChange     lfcSE      stat    pvalue      padj
              &lt;numeric&gt;      &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;
Cluster_1       45.5523      -1.029009  1.046267 -0.983505  0.325359  0.766886
Cluster_2       25.3913      -0.974521  0.887134 -1.098505  0.271984  0.722394
Cluster_3      500.2432      -0.223463  0.681362 -0.327966  0.742938  0.949341
Cluster_4       37.4950       0.372492  0.875715  0.425357  0.670576  0.929611
Cluster_5      262.8973       0.528197  0.582344  0.907018  0.364397  0.791723
...                 ...            ...       ...       ...       ...       ...
Cluster_33662   73.5380     -1.0047441  0.551679 -1.821247 0.0685693  0.422218
Cluster_33663  102.4384     -0.8580087  0.593642 -1.445329 0.1483654  0.582914
Cluster_33664  165.7171     -0.5549368  0.511572 -1.084768 0.2780242  0.728123
Cluster_33665   57.5813     -0.0529832  0.505219 -0.104872 0.9164777  0.984630
Cluster_33666 2721.9794     -0.7353095  0.548616 -1.340298 0.1801484  0.629508</code></pre>
<div class="sourceCode" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(sRNA_res)</span></code></pre></div>
<pre><code>out of 33654 with nonzero total read count
adjusted p-value &lt; 0.05
LFC &gt; 0 (up)       : 335, 1%
LFC &lt; 0 (down)     : 373, 1.1%
outliers [1]       : 0, 0%
low counts [2]     : 665, 2%
(mean count &lt; 2)
[1] see 'cooksCutoff' argument of ?results
[2] see 'independentFiltering' argument of ?results</code></pre>
<div class="sourceCode" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">table</span>(sRNA_res<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>padj <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> fdr)</span></code></pre></div>
<pre><code>FALSE  TRUE 
32293   708 </code></pre>
</section>
<section id="write-dds-results-tables-to-csvs-1" class="level3">
<h3 class="anchored" data-anchor-id="write-dds-results-tables-to-csvs-1">6.3.3 Write DDS results tables to CSVs</h3>
<div class="sourceCode" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.csv</span>(sRNA_res, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(output_dir, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"deseq2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".sRNAs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".table.csv"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quote =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb62-2"></span>
<span id="cb62-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Subset based on adjusted p-value</span></span>
<span id="cb62-4">sRNA_resSig <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">subset</span>(sRNA_res, padj <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> fdr)</span>
<span id="cb62-5"></span>
<span id="cb62-6">sRNA_resSig</span></code></pre></div>
<pre><code>log2 fold change (MLE): treatment treatment vs control 
Wald test p-value: treatment treatment vs control 
DataFrame with 708 rows and 6 columns
                baseMean log2FoldChange     lfcSE      stat      pvalue
               &lt;numeric&gt;      &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;   &lt;numeric&gt;
Cluster_62      282.1243       -2.31979  0.705223  -3.28945 1.00384e-03
Cluster_90       55.2729        3.23430  0.952673   3.39498 6.86343e-04
Cluster_137      48.2576       -3.45184  0.869587  -3.96951 7.20196e-05
Cluster_139      47.1693       -3.56747  0.880422  -4.05200 5.07822e-05
Cluster_140     585.7301       -4.30156  0.957128  -4.49424 6.98204e-06
...                  ...            ...       ...       ...         ...
Cluster_33492   83.31701        3.46496  0.799002   4.33661 1.44695e-05
Cluster_33496    9.73899       -4.88615  1.469261  -3.32559 8.82330e-04
Cluster_33503  633.79425       -6.14324  0.916828  -6.70053 2.07658e-11
Cluster_33524    6.02438        6.14925  1.874132   3.28112 1.03396e-03
Cluster_33579 1000.14999       -3.54729  0.648113  -5.47326 4.41842e-08
                     padj
                &lt;numeric&gt;
Cluster_62     0.04807906
Cluster_90     0.03822268
Cluster_137    0.01014849
Cluster_139    0.00833762
Cluster_140    0.00225896
...                   ...
Cluster_33492 3.68202e-03
Cluster_33496 4.44546e-02
Cluster_33503 1.71323e-07
Cluster_33524 4.86066e-02
Cluster_33579 5.08059e-05</code></pre>
<div class="sourceCode" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.csv</span>(sRNA_resSig, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(output_dir, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"deseq2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".sRNAs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".fdr-"</span>, fdr, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".lfc-"</span>, log2fc, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".table.csv"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quote =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
</section>
<section id="identify-differentially-expressed-srnas" class="level3">
<h3 class="anchored" data-anchor-id="identify-differentially-expressed-srnas">6.3.4 Identify Differentially Expressed sRNAs</h3>
<div class="sourceCode" id="cb65" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb65-1"></span>
<span id="cb65-2"></span>
<span id="cb65-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract the first column values (excluding the header)</span></span>
<span id="cb65-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clusters</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">','</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-f1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/03.00-sRNAseq-gene-expression-DESeq2/deseq2.sRNAs.fdr-0.05.lfc-0.table.csv"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tail</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> +2<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb65-5"></span>
<span id="cb65-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop through each cluster and search in the Results.txt file</span></span>
<span id="cb65-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> cluster <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$clusters</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> </span>
<span id="cb65-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb65-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$cluster</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/02.00-ShortStack-31bp-fastp-merged/ShortStack_out/Results.txt"</span></span>
<span id="cb65-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/03.00-sRNAseq-gene-expression-DESeq2/DE-sRNAs.fdr-0.05.lfc-0.tab</span></code></pre></div>
</section>
</section>
<section id="variance-stabilizing-transformations-vst-1" class="level2">
<h2 class="anchored" data-anchor-id="variance-stabilizing-transformations-vst-1">6.4 Variance stabilizing transformations (VST)</h2>
<ul>
<li>Here we transform counts using a variance stabilizing transformation (VST), since we have many samples.</li>
</ul>
<div class="sourceCode" id="cb66" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1">sRNA_vsd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">varianceStabilizingTransformation</span>(sRNA_dds, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">blind=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
</section>
<section id="plotting-1" class="level2">
<h2 class="anchored" data-anchor-id="plotting-1">6.5 Plotting</h2>
<section id="sample-distances-1" class="level3">
<h3 class="anchored" data-anchor-id="sample-distances-1">6.5.1 Sample distances</h3>
<div class="sourceCode" id="cb67" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1">sRNA_sampleDists <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dist</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">t</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">assay</span>(sRNA_vsd)))</span>
<span id="cb67-2"></span>
<span id="cb67-3">sRNA_sampleDistMatrix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>( sRNA_sampleDists )</span>
<span id="cb67-4"></span>
<span id="cb67-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(sRNA_sampleDistMatrix) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>( sRNA_vsd<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>colony.id, sRNA_vsd<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>time.point, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" - "</span> )</span>
<span id="cb67-6"></span>
<span id="cb67-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(sRNA_sampleDistMatrix) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb67-8"></span>
<span id="cb67-9">colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colorRampPalette</span>( <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rev</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">brewer.pal</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Blues"</span>)) )(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>)</span>
<span id="cb67-10"></span>
<span id="cb67-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pheatmap</span>(sRNA_sampleDistMatrix,</span>
<span id="cb67-12">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clustering_distance_rows =</span> sRNA_sampleDists,</span>
<span id="cb67-13">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clustering_distance_cols =</span> sRNA_sampleDists,</span>
<span id="cb67-14">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> colors)</span></code></pre></div>
<p><img src="https://robertslab.github.io/sams-notebook/posts/2025/2025-01-31-Differential-Expression---R.philippinarum-miRNAs-Using-DEseq2/03.00-sRNAseq-gene-expression-DESeq2_files/figure-gfm/sRNA-plot-sample-distances-1.png" class="img-fluid"><!-- --></p>
</section>
<section id="pca-1" class="level3">
<h3 class="anchored" data-anchor-id="pca-1">6.5.2 PCA</h3>
<p>Visualize sample clustering via PCA (after transformation)</p>
<div class="sourceCode" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># PCA with points color coded by time point </span></span>
<span id="cb68-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plotPCA</span>(sRNA_vsd, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intgroup =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"treatment"</span>))</span></code></pre></div>
<p><img src="https://robertslab.github.io/sams-notebook/posts/2025/2025-01-31-Differential-Expression---R.philippinarum-miRNAs-Using-DEseq2/03.00-sRNAseq-gene-expression-DESeq2_files/figure-gfm/sRNA-pca-1.png" class="img-fluid"><!-- --></p>
</section>
<section id="heatmap-of-top-50-srnas" class="level3">
<h3 class="anchored" data-anchor-id="heatmap-of-top-50-srnas">6.5.3 Heatmap of Top 50 sRNAs</h3>
<div class="sourceCode" id="cb69" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1">sRNA_counts_top50 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">order</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowMeans</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">counts</span>(sRNA_dds,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normalized=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)),</span>
<span id="cb69-2">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decreasing=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>]</span>
<span id="cb69-3"></span>
<span id="cb69-4">annotation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colData</span>(sRNA_dds) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(treatment)</span>
<span id="cb69-5"></span>
<span id="cb69-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pheatmap</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">assay</span>(sRNA_vsd)[sRNA_counts_top50,], </span>
<span id="cb69-7">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cluster_rows=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, </span>
<span id="cb69-8">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show_rownames=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb69-9">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cluster_cols=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb69-10">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">annotation_col =</span> annotation)</span></code></pre></div>
<p><img src="https://robertslab.github.io/sams-notebook/posts/2025/2025-01-31-Differential-Expression---R.philippinarum-miRNAs-Using-DEseq2/03.00-sRNAseq-gene-expression-DESeq2_files/figure-gfm/sRNA-heatmap-1.png" class="img-fluid"><!-- --></p>
</section>
</section>
</section>
<section id="references" class="level1">
<h1>7 REFERENCES</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-love2014" class="csl-entry">
Love, Michael I, Wolfgang Huber, and Simon Anders. 2014. “Moderated Estimation of Fold Change and Dispersion for RNA-Seq Data with DESeq2.” <em>Genome Biology</em> 15 (12). <a href="https://doi.org/10.1186/s13059-014-0550-8" class="uri">https://doi.org/10.1186/s13059-014-0550-8</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2025</category>
  <category>Ruditapes philippinarum</category>
  <category>Manila clam</category>
  <category>DEseq2</category>
  <category>sRNA-seq</category>
  <category>miRNA</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2025/2025-01-31-Differential-Expression---R.philippinarum-miRNAs-Using-DEseq2/</guid>
  <pubDate>Fri, 31 Jan 2025 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Computer Management - Fix Most of Raven Boot Issues</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2025/2025-01-30-Computer-Management---Fix-Most-of-Raven-Boot-Issues/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>Raven has been experiencing various issues when it comes to rebooting:</p>
<ol type="1">
<li><p>Doesn’t reboot automatically after a power outage.</p></li>
<li><p>Dell Pre-boot System Performance fan failure message, which prevented the system from booting without manual intervention.</p></li>
<li><p>Booting into <code>emergency mode</code>.</p></li>
<li><p>Screen doesn’t boot into Ubuntu desktop. Instead boot is successful, but just shows a log of boot loading steps on the screen.</p></li>
</ol>
</section>
<section id="fixes" class="level1">
<h1>FIXES</h1>
<p>Performed the following changes to Raven in order to resolve most of the booting issues we’ve experienced:</p>
<ul>
<li>Installed new monitor (not related to booting, obviously, but we didn’t have a monitor for Raven which made troubleshooting some of the following items impossible).</li>
</ul>
<ol type="1">
<li><p>In BIOS, enabled automatic reboot after power outage. Pretty sure this used to be enabled. Maybe a firmware update reset it?</p></li>
<li><p>In BIOS, unchecked all of the boxes for HDD fan checks. The fans will be checked regardless, <em>if</em> the system detects that a HDD fan is installed. This will eliminate the Dell Pre-boot System Performance fan failure message, which prevented the system from booting without manual intervention. The previous fan error due to the system checking for a fan which <em>was not installed</em>.</p></li>
<li><p>Fixed <code>/etc/fstab</code> and commented out a HDD which is no longer installed in the system. This was causing the system to boot into emergency mode due to the system looking for, and not finding, said HDD.</p></li>
<li></li>
</ol>
<ul>
<li><p>4a. Switched desktop manager from <code>gdm3</code> to <code>lightdm</code> in attempt to get the system to boot to the Ubuntu desktop. This did not work.</p></li>
<li><p>4b. Edited the grub configuration file (<code>/etc/default/grub</code>) to avoid indefinite hang on Ubuntu splash screen:</p></li>
</ul>
<p>Changed: <code>GRUB_CMDLINE_LINUX_DEFAULT="quiet splash"</code></p>
<p>To: <code>GRUB_CMDLINE_LINUX_DEFAULT=""</code></p>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<p>With all of the above changes, Raven now boots successfully, without human intervention directly into a console screen. Although I couldn’t figure out how to get this to boot into the desktop, that’s really of very little consequence as this is used a “headless” system 99% of the time.</p>


</section>

 ]]></description>
  <category>2025</category>
  <category>raven</category>
  <category>Computer Management</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2025/2025-01-30-Computer-Management---Fix-Most-of-Raven-Boot-Issues/</guid>
  <pubDate>Thu, 30 Jan 2025 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Bisulfite Genome - P.tuahiniensis BS Genome Using Bismark</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2025/2025-01-29-Bisulfite-Genome---P.tuahiniensis-BS-Genome-Using-Bismark/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>In preparation for <a href="https://github.com/FelixKrueger/Bismark"><code>Bismark</code></a> alignments, we needed to generate a bisulfite-converted genome for <em>P.tuahiniensis</em>, as one did not already exist.</p>
<p>The resulting output files were added to the <a href="https://robertslab.github.io/resources/Genomic-Resources/">Genomic Resources Handbook page</a> and the <a href="https://github.com/urol-e5/timeseries_molecular/wiki/">timeseries_molecular repo Wiki</a>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The contents below are from markdown knitted from <a href="https://github.com/urol-e5/timeseries_molecular/blob/7b0bb87d1c75abce7b1a486b8718f10e43d42bfe/F-Ptua/code/00.21-F-Ptua-BS-genome.Rmd"><code>00.21-F-Ptua-BS-genome.Rmd</code></a> (commit <code>7b0bb87</code>).</p>
</div>
</div>
</section>
<section id="background" class="level1">
<h1>1 Background</h1>
<p>This Rmd file will create a bisulfite-converted genome by, and for, Bismark (Krueger and Andrews 2011) using the <code>Pocillopora_meandrina_HIv1.assembly.fasta</code> file. The genome FastA was taken from the <a href="http://cyanophora.rutgers.edu/Pocillopora_meandrina/">Cyanophora webpage</a>.</p>
<p>Due to large sizes of output files, the files cannot be sync’d to GitHub. As such, the output directories will be gzipped and available here:</p>
<ul>
<li><p><a href="https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/F-Ptua/data/Bisulfite_Genome.tar.gz" class="uri">https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/F-Ptua/data/Bisulfite_Genome.tar.gz</a> (972MB)</p></li>
<li><p><a href="https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/F-Ptua/data/Bisulfite_Genome.tar.gz.md5" class="uri">https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/F-Ptua/data/Bisulfite_Genome.tar.gz.md5</a></p>
<ul>
<li>MD5: <code>654a93dacf6a5a72475ac644599f8f8e</code></li>
</ul></li>
</ul>
</section>
<section id="inputs" class="level1">
<h1>2 Inputs</h1>
<ul>
<li>Directory containing a FastA file with the file extension: .fa or .fasta (also ending in .gz).</li>
</ul>
</section>
<section id="outputs" class="level1">
<h1>3 Outputs</h1>
<ul>
<li><p>CT Conversion</p>
<ul>
<li>Bowtie2 index files.</li>
<li>CT conversion FastA</li>
</ul></li>
<li><p>GA conversion</p>
<ul>
<li>Bowtie2 index files.</li>
<li>GA conversion FastA.</li>
</ul></li>
</ul>
</section>
<section id="create-a-bash-variables-file" class="level1">
<h1>4 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export timeseries_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export output_dir_top=${timeseries_dir}/F-Ptua/data'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export genome_dir=${timeseries_dir}/F-Ptua/data'</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-10"></span>
<span id="cb1-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Paths to programs"</span></span>
<span id="cb1-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export programs_dir="/home/shared"'</span></span>
<span id="cb1-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export bismark_dir="${programs_dir}/Bismark-0.24.0"'</span></span>
<span id="cb1-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export bowtie2_dir="${programs_dir}/bowtie2-2.4.4-linux-x86_64"'</span></span>
<span id="cb1-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-16"></span>
<span id="cb1-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set number of CPUs to use"</span></span>
<span id="cb1-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=20'</span></span>
<span id="cb1-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-20"></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Print formatting"</span></span>
<span id="cb1-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-23"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-24"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-25"></span>
<span id="cb1-26"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export timeseries_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular
export output_dir_top=${timeseries_dir}/F-Ptua/data
export genome_dir=${timeseries_dir}/F-Ptua/data

# Paths to programs
export programs_dir="/home/shared"
export bismark_dir="${programs_dir}/Bismark-0.24.0"
export bowtie2_dir="${programs_dir}/bowtie2-2.4.4-linux-x86_64"

# Set number of CPUs to use
export threads=20

# Print formatting
export line="--------------------------------------------------------"</code></pre>
</section>
<section id="bisfulite-conversion" class="level1">
<h1>5 Bisfulite conversion</h1>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bismark_dir}</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/bismark_genome_preparation</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-6">--parallel <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-7">--bowtie2 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-8">--path_to_aligner <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bowtie2_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-9">1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_dir}</span>/Ptua-bs-genome.stderr</span></code></pre></div>
<pre><code>Using 20 threads for the top and bottom strand indexing processes each, so using 40 cores in total
Writing bisulfite genomes out into a single MFA (multi FastA) file

Bisulfite Genome Indexer version v0.24.0 (last modified: 19 May 2022)

Step I - Prepare genome folders - completed



Step II - Genome bisulfite conversions - completed


Bismark Genome Preparation - Step III: Launching the Bowtie 2 indexer
Building a SMALL index
Building a SMALL index

=========================================

Parallel genome indexing complete. Enjoy!</code></pre>
<section id="inpect-bs-output" class="level2">
<h2 class="anchored" data-anchor-id="inpect-bs-output">5.1 Inpect BS output</h2>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tree</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-h</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_dir}</span>/Bisulfite_Genome</span></code></pre></div>
<pre><code>/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/F-Ptua/data/Bisulfite_Genome
├── [4.0K]  CT_conversion
│&nbsp;&nbsp; ├── [124M]  BS_CT.1.bt2
│&nbsp;&nbsp; ├── [ 90M]  BS_CT.2.bt2
│&nbsp;&nbsp; ├── [1.9K]  BS_CT.3.bt2
│&nbsp;&nbsp; ├── [ 90M]  BS_CT.4.bt2
│&nbsp;&nbsp; ├── [124M]  BS_CT.rev.1.bt2
│&nbsp;&nbsp; ├── [ 90M]  BS_CT.rev.2.bt2
│&nbsp;&nbsp; └── [359M]  genome_mfa.CT_conversion.fa
└── [4.0K]  GA_conversion
    ├── [124M]  BS_GA.1.bt2
    ├── [ 90M]  BS_GA.2.bt2
    ├── [1.9K]  BS_GA.3.bt2
    ├── [ 90M]  BS_GA.4.bt2
    ├── [124M]  BS_GA.rev.1.bt2
    ├── [ 90M]  BS_GA.rev.2.bt2
    └── [359M]  genome_mfa.GA_conversion.fa

2 directories, 14 files</code></pre>
</section>
<section id="compress-output-folder" class="level2">
<h2 class="anchored" data-anchor-id="compress-output-folder">5.2 Compress output folder</h2>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-czvf</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_dir}</span>/Bisulfite_Genome.tar.gz <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_dir}</span>/Bisulfite_Genome</span></code></pre></div>
<pre><code>tar: Removing leading `/' from member names
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/F-Ptua/data/Bisulfite_Genome/
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/F-Ptua/data/Bisulfite_Genome/CT_conversion/
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/F-Ptua/data/Bisulfite_Genome/CT_conversion/BS_CT.4.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/F-Ptua/data/Bisulfite_Genome/CT_conversion/BS_CT.rev.1.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/F-Ptua/data/Bisulfite_Genome/CT_conversion/genome_mfa.CT_conversion.fa
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/F-Ptua/data/Bisulfite_Genome/CT_conversion/BS_CT.1.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/F-Ptua/data/Bisulfite_Genome/CT_conversion/BS_CT.2.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/F-Ptua/data/Bisulfite_Genome/CT_conversion/BS_CT.3.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/F-Ptua/data/Bisulfite_Genome/CT_conversion/BS_CT.rev.2.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/F-Ptua/data/Bisulfite_Genome/GA_conversion/
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/F-Ptua/data/Bisulfite_Genome/GA_conversion/BS_GA.rev.1.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/F-Ptua/data/Bisulfite_Genome/GA_conversion/BS_GA.2.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/F-Ptua/data/Bisulfite_Genome/GA_conversion/BS_GA.4.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/F-Ptua/data/Bisulfite_Genome/GA_conversion/genome_mfa.GA_conversion.fa
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/F-Ptua/data/Bisulfite_Genome/GA_conversion/BS_GA.rev.2.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/F-Ptua/data/Bisulfite_Genome/GA_conversion/BS_GA.1.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/F-Ptua/data/Bisulfite_Genome/GA_conversion/BS_GA.3.bt2</code></pre>
</section>
<section id="create-md5sum" class="level2">
<h2 class="anchored" data-anchor-id="create-md5sum">5.3 Create MD5sum</h2>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb9-2"></span>
<span id="cb9-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_dir}</span></span>
<span id="cb9-4"></span>
<span id="cb9-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> Bisulfite_Genome.tar.gz <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> Bisulfite_Genome.tar.gz.md5</span></code></pre></div>
<pre><code>3cef8ba7316aa2bb15eafbbb438470f2  Bisulfite_Genome.tar.gz</code></pre>
</section>
</section>
<section id="references" class="level1">
<h1>6 REFERENCES</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-krueger2011" class="csl-entry">
Krueger, Felix, and Simon R. Andrews. 2011. “Bismark: A Flexible Aligner and Methylation Caller for Bisulfite-Seq Applications.” <em>Bioinformatics</em> 27 (11): 1571–72. <a href="https://doi.org/10.1093/bioinformatics/btr167" class="uri">https://doi.org/10.1093/bioinformatics/btr167</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2025</category>
  <category>Pocillopora tuahiniensis</category>
  <category>bismark</category>
  <category>bisulfite</category>
  <category>coral</category>
  <category>E5</category>
  <category>timeseries_molecular</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2025/2025-01-29-Bisulfite-Genome---P.tuahiniensis-BS-Genome-Using-Bismark/</guid>
  <pubDate>Wed, 29 Jan 2025 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Bisulfite Genome - P.evermanni BS Genome Using Bismark</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2025/2025-01-29-Bisulfite-Genome---P.evermanni-BS-Genome-Using-Bismark/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>In preparation for <a href="https://github.com/FelixKrueger/Bismark"><code>Bismark</code></a> alignments, we needed to generate a bisulfite-converted genome for <em>P.evermanni</em>, as one did not already exist.</p>
<p>The resulting output files were added to the <a href="https://robertslab.github.io/resources/Genomic-Resources/">Genomic Resources Handbook page</a> and the <a href="https://github.com/urol-e5/timeseries_molecular/wiki/00%E2%80%90Genomic%E2%80%90Resources#bisulfite-genome-1">timeseries_molecular repo Wiki</a>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The contents below are from markdown knitted from <a href="https://github.com/urol-e5/timeseries_molecular/blob/5b56975e21432f63342965b4abe87a235ec8ee62/E-Peve/code/00.21-E-Peve-BS-genome.Rmd"><code>00.21-E-Peve-BS-genome.Rmd</code></a> (commit <code>5b56975</code>).</p>
</div>
</div>
</section>
<section id="background" class="level1">
<h1>1 Background</h1>
<p>This Rmd file will create a bisulfite-converted genome by, and for, Bismark (Krueger and Andrews 2011) using the <code>Porites_evermanni_v1.fa</code> file. The genome FastA was taken from the <a href="https://www.genoscope.cns.fr/corals/genomes.html">Genoscope corals webpage</a>.</p>
<p>Due to large sizes of output files, the files cannot be sync’d to GitHub. As such, the output directories will be gzipped and available here:</p>
<ul>
<li><p><a href="https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/Bisulfite_Genome.tar.gz" class="uri">https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/Bisulfite_Genome.tar.gz</a> (1.5GB)</p></li>
<li><p><a href="https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/Bisulfite_Genome.tar.gz.md5" class="uri">https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/Bisulfite_Genome.tar.gz.md5</a></p>
<ul>
<li>MD5: <code>5a0d4f699d7d46eb9f996e677841582a</code></li>
</ul></li>
</ul>
</section>
<section id="inputs" class="level1">
<h1>2 Inputs</h1>
<ul>
<li>Directory containing a FastA file with the file extension: .fa or .fasta (also ending in .gz).</li>
</ul>
</section>
<section id="outputs" class="level1">
<h1>3 Outputs</h1>
<ul>
<li><p>CT Conversion</p>
<ul>
<li>Bowtie2 index files.</li>
<li>CT conversion FastA</li>
</ul></li>
<li><p>GA conversion</p>
<ul>
<li>Bowtie2 index files.</li>
<li>GA conversion FastA.</li>
</ul></li>
</ul>
</section>
<section id="create-a-bash-variables-file" class="level1">
<h1>4 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export timeseries_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export output_dir_top=${timeseries_dir}/E-Peve/data'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export genome_dir=${timeseries_dir}/E-Peve/data'</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-10"></span>
<span id="cb1-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Paths to programs"</span></span>
<span id="cb1-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export programs_dir="/home/shared"'</span></span>
<span id="cb1-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export bismark_dir="${programs_dir}/Bismark-0.24.0"'</span></span>
<span id="cb1-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export bowtie2_dir="${programs_dir}/bowtie2-2.4.4-linux-x86_64"'</span></span>
<span id="cb1-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-16"></span>
<span id="cb1-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set number of CPUs to use"</span></span>
<span id="cb1-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=20'</span></span>
<span id="cb1-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-20"></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Print formatting"</span></span>
<span id="cb1-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-23"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-24"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-25"></span>
<span id="cb1-26"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export timeseries_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular
export output_dir_top=${timeseries_dir}/E-Peve/data
export genome_dir=${timeseries_dir}/E-Peve/data

# Paths to programs
export programs_dir="/home/shared"
export bismark_dir="${programs_dir}/Bismark-0.24.0"
export bowtie2_dir="${programs_dir}/bowtie2-2.4.4-linux-x86_64"

# Set number of CPUs to use
export threads=20

# Print formatting
export line="--------------------------------------------------------"</code></pre>
</section>
<section id="bisfulite-conversion" class="level1">
<h1>5 Bisfulite conversion</h1>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bismark_dir}</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/bismark_genome_preparation</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-6">--parallel <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-7">--bowtie2 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-8">--path_to_aligner <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bowtie2_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-9">1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_dir}</span>/Peve-bs-genome.stderr</span></code></pre></div>
<pre><code>Using 20 threads for the top and bottom strand indexing processes each, so using 40 cores in total
Writing bisulfite genomes out into a single MFA (multi FastA) file

Bisulfite Genome Indexer version v0.24.0 (last modified: 19 May 2022)

Step I - Prepare genome folders - completed



Step II - Genome bisulfite conversions - completed


Bismark Genome Preparation - Step III: Launching the Bowtie 2 indexer
Building a SMALL index
Building a SMALL index

=========================================

Parallel genome indexing complete. Enjoy!</code></pre>
<section id="inpect-bs-output" class="level2">
<h2 class="anchored" data-anchor-id="inpect-bs-output">5.1 Inpect BS output</h2>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tree</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-h</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_dir}</span>/Bisulfite_Genome</span></code></pre></div>
<pre><code>/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/Bisulfite_Genome
├── [4.0K]  CT_conversion
│&nbsp;&nbsp; ├── [184M]  BS_CT.1.bt2
│&nbsp;&nbsp; ├── [134M]  BS_CT.2.bt2
│&nbsp;&nbsp; ├── [442K]  BS_CT.3.bt2
│&nbsp;&nbsp; ├── [134M]  BS_CT.4.bt2
│&nbsp;&nbsp; ├── [184M]  BS_CT.rev.1.bt2
│&nbsp;&nbsp; ├── [134M]  BS_CT.rev.2.bt2
│&nbsp;&nbsp; └── [586M]  genome_mfa.CT_conversion.fa
└── [4.0K]  GA_conversion
    ├── [184M]  BS_GA.1.bt2
    ├── [134M]  BS_GA.2.bt2
    ├── [442K]  BS_GA.3.bt2
    ├── [134M]  BS_GA.4.bt2
    ├── [184M]  BS_GA.rev.1.bt2
    ├── [134M]  BS_GA.rev.2.bt2
    └── [586M]  genome_mfa.GA_conversion.fa

2 directories, 14 files</code></pre>
</section>
<section id="compress-output-folder" class="level2">
<h2 class="anchored" data-anchor-id="compress-output-folder">5.2 Compress output folder</h2>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-czvf</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_dir}</span>/Bisulfite_Genome.tar.gz <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_dir}</span>/Bisulfite_Genome</span></code></pre></div>
<pre><code>tar: Removing leading `/' from member names
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/Bisulfite_Genome/
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/Bisulfite_Genome/CT_conversion/
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/Bisulfite_Genome/CT_conversion/BS_CT.4.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/Bisulfite_Genome/CT_conversion/BS_CT.rev.1.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/Bisulfite_Genome/CT_conversion/genome_mfa.CT_conversion.fa
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/Bisulfite_Genome/CT_conversion/BS_CT.1.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/Bisulfite_Genome/CT_conversion/BS_CT.2.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/Bisulfite_Genome/CT_conversion/BS_CT.3.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/Bisulfite_Genome/CT_conversion/BS_CT.rev.2.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/Bisulfite_Genome/GA_conversion/
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/Bisulfite_Genome/GA_conversion/BS_GA.rev.1.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/Bisulfite_Genome/GA_conversion/BS_GA.2.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/Bisulfite_Genome/GA_conversion/BS_GA.4.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/Bisulfite_Genome/GA_conversion/genome_mfa.GA_conversion.fa
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/Bisulfite_Genome/GA_conversion/BS_GA.rev.2.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/Bisulfite_Genome/GA_conversion/BS_GA.1.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/Bisulfite_Genome/GA_conversion/BS_GA.3.bt2</code></pre>
</section>
<section id="create-md5sum" class="level2">
<h2 class="anchored" data-anchor-id="create-md5sum">5.3 Create MD5sum</h2>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb9-2"></span>
<span id="cb9-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_dir}</span></span>
<span id="cb9-4"></span>
<span id="cb9-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> Bisulfite_Genome.tar.gz <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> Bisulfite_Genome.tar.gz.md5</span></code></pre></div>
<pre><code>1f65833895ba3c8d50fe27bb8ad5303e  Bisulfite_Genome.tar.gz</code></pre>
</section>
</section>
<section id="references" class="level1">
<h1>6 REFERENCES</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-krueger2011" class="csl-entry">
Krueger, Felix, and Simon R. Andrews. 2011. “Bismark: A Flexible Aligner and Methylation Caller for Bisulfite-Seq Applications.” <em>Bioinformatics</em> 27 (11): 1571–72. <a href="https://doi.org/10.1093/bioinformatics/btr167" class="uri">https://doi.org/10.1093/bioinformatics/btr167</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2025</category>
  <category>Porites evermanni</category>
  <category>E5</category>
  <category>timeseries_molecular</category>
  <category>bismark</category>
  <category>bisulfite genome</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2025/2025-01-29-Bisulfite-Genome---P.evermanni-BS-Genome-Using-Bismark/</guid>
  <pubDate>Wed, 29 Jan 2025 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Primer Design - C.gigas Alternative Oxidase AOX Variants Using Primer3</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2025/2025-01-17-Primer-Design---C.gigas-Alternative-Oxidase-AOX-Variants-Using-Primer3/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>This document outlines the process of designing primers for the alternative oxidase (AOX) gene variants in <em>Crassostrea gigas</em> (Pacific oyster) using Primer3. The goal is to develop specific primers for qPCR to study the expression of AOX isoforms under different experimental conditions.</p>
<p>The AOX gene is involved in the mitochondrial electron transport chain and is known to be responsive to oxidative stress. By designing specific primers for different AOX isoforms, we can investigate their expression patterns and potential roles in oyster physiology and stress responses.</p>
<p>The following sections detail the steps taken to identify AOX isoforms, retrieve their sequences, design primers using Primer3, and validate the primers using EMBOSS PrimerSearch.</p>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">Objectives</h2>
<ol type="1">
<li>Identify AOX isoforms in <em>Crassostrea gigas</em>.</li>
<li>Retrieve nucleotide sequences for the identified isoforms.</li>
<li>Design specific primers for each isoform using Primer3.</li>
<li>Validate primer specificity using EMBOSS PrimerSearch.</li>
</ol>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">Methods</h2>
<p>The methods section includes the following steps:</p>
<ol type="1">
<li><strong>Identification of AOX Isoforms</strong>: Using BLASTx to identify AOX isoforms in the <em>Crassostrea gigas</em> genome.</li>
<li><strong>Sequence Retrieval</strong>: Fetching nucleotide sequences for the identified isoforms using NCBI’s e-utilities.</li>
<li><strong>Primer Design</strong>: Using Primer3 to design specific primers for each AOX isoform.</li>
<li><strong>Primer Validation</strong>: Using EMBOSS PrimerSearch to validate the specificity of the designed primers against the <em>Crassostrea gigas</em> genome.</li>
</ol>
<p>The detailed procedures and scripts used for each step are provided in the subsequent sections.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The contents below are from markdown knitted from <a href="https://github.com/RobertsLab/code/blob/75f0197d210d79570ff60e356c70cf8232502b5b/r_projects/sam/20250117-cgig-aox-primer-design/code/20250117-cgig-aox-primer-design.Rmd"><code>20250117-cgig-aox-primer-design.Rmd</code></a> (commit <code>75f0197</code>).</p>
</div>
</div>
</section>
</section>
<section id="background" class="level1">
<h1>1 Background</h1>
<p>This notebook describes using <a href="https://github.com/primer3-org/primer3">Primer3</a> (Untergasser et al. 2012; Koressaar and Remm 2007) to reproducibly design qPCR primers for <em>Crassostrea gigas</em> (<em>Magallana gigas</em>) <a href="https://en.wikipedia.org/wiki/Alternative_oxidase">alternative oxidase (AOX)</a> (Wikipedia) isoforms. Alternative oxidase is a mitochondrial gene/enzyme known to be responsive to oxidative stress, so this may be a useful biomarker that we haven’t previously considered.</p>
<p>Isoforms of AOX in <em>Crassostrea gigas</em> (<em>Magallana gigas</em>) were identified by running BLASTx using the <a href="https://www.ncbi.nlm.nih.gov/sites/entrez?cmd=Search&amp;db=nucleotide&amp;term=NM_113135.4&amp;dopt=GenBank"><em>Arabidopsis</em> AOX1a nucleotide sequence (NM_113135.4)</a> as a query against the <em>Crassostrea gigas</em> (<em>Magallana gigas</em>) genome using NCBI’s web-based BLAST interface.</p>
<p>BLASTx returned three matches:</p>
<ul>
<li><p><a href="https://www.ncbi.nlm.nih.gov/protein/NP_001292289.1?report=genbank&amp;log$=protalign&amp;blast_rank=1&amp;RID=SMV9RMT6013">NP_001292289.1</a>: alternative oxidase, mitochondrial-like <img src="https://latex.codecogs.com/png.latex?Magallana%20gigas"></p>
<ul>
<li><p>Nucleotide: <a href="https://www.ncbi.nlm.nih.gov/nuccore/NM_001305360.1"><code>NM_001305360.1</code></a></p></li>
<li><p>Gene: <code>LOC105322704</code></p></li>
</ul></li>
<li><p><a href="https://www.ncbi.nlm.nih.gov/protein/XP_034318738.2?report=genbank&amp;log$=protalign&amp;blast_rank=2&amp;RID=SMV9RMT6013"><code>XP_034318738.2</code></a>: alternative oxidase, mitochondrial-like isoform X2 <img src="https://latex.codecogs.com/png.latex?Magallana%0Agigas"></p>
<ul>
<li><p>Nucleotide: <a href="https://www.ncbi.nlm.nih.gov/nuccore/XM_034462847.2"><code>XM_034462847.2</code></a></p></li>
<li><p>Gene: <code>LOC105322704</code></p></li>
</ul></li>
<li><p><a href="https://www.ncbi.nlm.nih.gov/protein/XP_065939571.1?report=genbank&amp;log$=protalign&amp;blast_rank=3&amp;RID=SMV9RMT6013"><code>XP_065939571.1</code></a>: alternative oxidase, mitochondrial-like isoform X1 <img src="https://latex.codecogs.com/png.latex?Magallana%0Agigas"></p>
<ul>
<li><p>Nucleotide: <a href="https://www.ncbi.nlm.nih.gov/nuccore/XM_066083499.1"><code>XM_066083499.1</code></a></p></li>
<li><p>Gene: <code>LOC105322704</code></p></li>
</ul></li>
</ul>
<section id="input-files" class="level2">
<h2 class="anchored" data-anchor-id="input-files">1.1 Input files</h2>
<ul>
<li><p>Target FastA sequences</p></li>
<li><p>Genome FastA</p></li>
</ul>
</section>
<section id="output-files" class="level2">
<h2 class="anchored" data-anchor-id="output-files">1.2 Output files</h2>
<ul>
<li><p><code>emboss-primers.txt</code>: Output from EMBOSS PrimerSearch containing primer pair matches within the genome.</p></li>
<li><p><code>*primer3-primers-default-format.txt</code>: The default output format containing Primer3 primer identification info. Machine-readable format.</p></li>
<li><p><code>*primer3-primers.txt</code>: Primer3 output file containing primer identification info. An easy-to-read format.</p></li>
</ul>
</section>
<section id="required-software" class="level2">
<h2 class="anchored" data-anchor-id="required-software">1.3 Required software</h2>
<p>Utilizes NCBI’s <a href="https://www.ncbi.nlm.nih.gov/books/NBK179288/#chapter6.Getting_Started">e-utilities</a> (Kans 2013) for fetching FastA sequences.</p>
<p>This process also utilizes <a href="https://github.com/mdshw5/pyfaidx">pyfaidx</a> (Shirley et al.&nbsp;2015).</p>
<p><a href="https://emboss.sourceforge.net/apps/cvs/emboss/apps/primersearch.html">EMBOSS PrimerSearch</a> (Rice, Longden, and Bleasby 2000) will be utilized to assess primer specificity across the genome.</p>
</section>
</section>
<section id="create-bash-variables-file" class="level1">
<h1>2 CREATE BASH VARIABLES FILE</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# DATA DIRECTORIES"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export data_dir="../data"'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export output_top="../output"'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export genome_fasta_splits_dir="${data_dir}/fasta_splits"'</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-10"></span>
<span id="cb1-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# SEQUENCES"</span></span>
<span id="cb1-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export sequence_IDs=(XM_066083499.1 XM_034462847.2 NM_001305360.1)'</span></span>
<span id="cb1-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-14"></span>
<span id="cb1-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# SEQUENCE REGIONS"</span></span>
<span id="cb1-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export left_buffer="500"'</span></span>
<span id="cb1-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export right_buffer="500"'</span></span>
<span id="cb1-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# INPUT FILES"</span></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export genome_fasta="GCF_963853765.1_xbMagGiga1.1_genomic.fna"'</span></span>
<span id="cb1-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export genome_gff="GCF_963853765.1_xbMagGiga1.1_genomic.gff"'</span></span>
<span id="cb1-23"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export ncbi_gff_gz="GCF_963853765.1_xbMagGiga1.1_genomic.gff.gz"'</span></span>
<span id="cb1-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export ncbi_fasta_gz="GCF_963853765.1_xbMagGiga1.1_genomic.fna.gz"'</span></span>
<span id="cb1-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export ncbi_md5sums="md5checksums.txt"'</span></span>
<span id="cb1-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export ncbi_url="https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/963/853/765/GCF_963853765.1_xbMagGiga1.1/"'</span></span>
<span id="cb1-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export NM_001305360_fasta="NM_001305360.1.fasta"'</span></span>
<span id="cb1-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export XM_034462847_fasta="XM_034462847.2.fasta"'</span></span>
<span id="cb1-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export XM_066083499_fasta="XM_066083499.1.fasta"'</span></span>
<span id="cb1-30"></span>
<span id="cb1-31"></span>
<span id="cb1-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# OUTPUT FILES"</span></span>
<span id="cb1-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-34"></span>
<span id="cb1-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# SET CPUS"</span></span>
<span id="cb1-36"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=40'</span></span>
<span id="cb1-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-38"></span>
<span id="cb1-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# PROGRAMS"</span></span>
<span id="cb1-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'esearch="/home/sam/edirect/esearch"'</span></span>
<span id="cb1-41"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'efetch="/home/sam/edirect/efetch"'</span></span>
<span id="cb1-42"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export pyfaidx=/home/shared/pyfaidx-0.8.1.1'</span></span>
<span id="cb1-43"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export primer3_dir="/home/shared/primer3-2.6.1/src"'</span></span>
<span id="cb1-44"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export primer3="${primer3_dir}/primer3_core"'</span></span>
<span id="cb1-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export primer3_config="${primer3_dir}/primer3_config"'</span></span>
<span id="cb1-46"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export primersearch="/home/shared/EMBOSS-6.6.0/emboss/primersearch"'</span></span>
<span id="cb1-47"></span>
<span id="cb1-48"></span>
<span id="cb1-49"></span>
<span id="cb1-50"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-51"></span>
<span id="cb1-52"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# DATA DIRECTORIES
export data_dir="../data"
export output_top="../output"
export genome_fasta_splits_dir="${data_dir}/fasta_splits"

# SEQUENCES
export sequence_IDs=(XM_066083499.1 XM_034462847.2 NM_001305360.1)

# SEQUENCE REGIONS
export left_buffer="500"
export right_buffer="500"

# INPUT FILES
export genome_fasta="GCF_963853765.1_xbMagGiga1.1_genomic.fna"
export genome_gff="GCF_963853765.1_xbMagGiga1.1_genomic.gff"
export ncbi_gff_gz="GCF_963853765.1_xbMagGiga1.1_genomic.gff.gz"
export ncbi_fasta_gz="GCF_963853765.1_xbMagGiga1.1_genomic.fna.gz"
export ncbi_md5sums="md5checksums.txt"
export ncbi_url="https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/963/853/765/GCF_963853765.1_xbMagGiga1.1/"
export NM_001305360_fasta="NM_001305360.1.fasta"
export XM_034462847_fasta="XM_034462847.2.fasta"
export XM_066083499_fasta="XM_066083499.1.fasta"
# OUTPUT FILES

# SET CPUS
export threads=40

# PROGRAMS
esearch="/home/sam/edirect/esearch"
efetch="/home/sam/edirect/efetch"
export pyfaidx=/home/shared/pyfaidx-0.8.1.1
export primer3_dir="/home/shared/primer3-2.6.1/src"
export primer3="${primer3_dir}/primer3_core"
export primer3_config="${primer3_dir}/primer3_config"
export primersearch="/home/shared/EMBOSS-6.6.0/emboss/primersearch"</code></pre>
</section>
<section id="download-ncbi-genome-files" class="level1">
<h1>3 DOWNLOAD NCBI GENOME FILES</h1>
<section id="download-the-files" class="level2">
<h2 class="anchored" data-anchor-id="download-the-files">3.1 Download the files</h2>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ncbi_gff_gz}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ncbi_fasta_gz}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ncbi_md5sums}</span></span>
<span id="cb3-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb3-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-check-certificate</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--continue</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--quiet</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--directory-prefix</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${data_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-11">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ncbi_url}${file}</span></span>
<span id="cb3-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb3-13"></span>
<span id="cb3-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${data_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<pre><code>total 1.1G
drwxr-xr-x 2 sam sam 4.0K Jan 21 16:59 fasta_splits
-rw-r--r-- 1 sam sam 545M Jun 28  2024 GCF_963853765.1_xbMagGiga1.1_genomic.fna
-rw-r--r-- 1 sam sam 1.1K Jan 21 10:28 GCF_963853765.1_xbMagGiga1.1_genomic.fna.fai
-rw-r--r-- 1 sam sam 167M Jun 28  2024 GCF_963853765.1_xbMagGiga1.1_genomic.fna.gz
-rw-r--r-- 1 sam sam 373M Jun 28  2024 GCF_963853765.1_xbMagGiga1.1_genomic.gff
-rw-r--r-- 1 sam sam  15M Jun 28  2024 GCF_963853765.1_xbMagGiga1.1_genomic.gff.gz
-rw-r--r-- 1 sam sam  20K Oct 27 16:10 md5checksums.txt
-rw-r--r-- 1 sam sam 1.4K Jan 18 23:18 NM_001305360.1.fasta
-rw-rw-r-- 1 sam sam 104K Jan 21 13:50 NM_001305360.1-NCBI-BLASTn-alignment.png
-rw-rw-r-- 1 sam sam 1.1K Jan 18 23:18 XM_034462847.2.fasta
-rw-rw-r-- 1 sam sam 119K Jan 21 13:50 XM_034462847.2-NCBI-BLASTn-alignment.png
-rw-rw-r-- 1 sam sam 1.5K Jan 18 23:18 XM_066083499.1.fasta
-rw-rw-r-- 1 sam sam 147K Jan 21 13:50 XM_066083499.1-NCBI-BLASTn-alignment.png</code></pre>
</section>
<section id="check-md5-checkums" class="level2">
<h2 class="anchored" data-anchor-id="check-md5-checkums">3.2 Check MD5 Checkums</h2>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${data_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-5"></span>
<span id="cb5-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.gz</span>
<span id="cb5-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ncbi_md5sums}</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb5-9"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<pre><code>./GCF_963853765.1_xbMagGiga1.1_genomic.fna.gz: OK
./GCF_963853765.1_xbMagGiga1.1_genomic.gff.gz: OK</code></pre>
</section>
<section id="decompress-ncbi-files" class="level2">
<h2 class="anchored" data-anchor-id="decompress-ncbi-files">3.3 Decompress NCBI files</h2>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb7-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${data_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-5"></span>
<span id="cb7-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.gz</span>
<span id="cb7-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb7-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gunzip</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-9"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb7-10"></span>
<span id="cb7-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span></span></code></pre></div>
<pre><code>gzip: GCF_963853765.1_xbMagGiga1.1_genomic.fna already exists;  not overwritten
gzip: GCF_963853765.1_xbMagGiga1.1_genomic.gff already exists;  not overwritten
total 1.1G
drwxr-xr-x 2 sam sam 4.0K Jan 21 16:59 fasta_splits
-rw-r--r-- 1 sam sam 545M Jun 28  2024 GCF_963853765.1_xbMagGiga1.1_genomic.fna
-rw-r--r-- 1 sam sam 1.1K Jan 21 10:28 GCF_963853765.1_xbMagGiga1.1_genomic.fna.fai
-rw-r--r-- 1 sam sam 167M Jun 28  2024 GCF_963853765.1_xbMagGiga1.1_genomic.fna.gz
-rw-r--r-- 1 sam sam 373M Jun 28  2024 GCF_963853765.1_xbMagGiga1.1_genomic.gff
-rw-r--r-- 1 sam sam  15M Jun 28  2024 GCF_963853765.1_xbMagGiga1.1_genomic.gff.gz
-rw-r--r-- 1 sam sam  20K Oct 27 16:10 md5checksums.txt
-rw-r--r-- 1 sam sam 1.4K Jan 18 23:18 NM_001305360.1.fasta
-rw-rw-r-- 1 sam sam 104K Jan 21 13:50 NM_001305360.1-NCBI-BLASTn-alignment.png
-rw-rw-r-- 1 sam sam 1.1K Jan 18 23:18 XM_034462847.2.fasta
-rw-rw-r-- 1 sam sam 119K Jan 21 13:50 XM_034462847.2-NCBI-BLASTn-alignment.png
-rw-rw-r-- 1 sam sam 1.5K Jan 18 23:18 XM_066083499.1.fasta
-rw-rw-r-- 1 sam sam 147K Jan 21 13:50 XM_066083499.1-NCBI-BLASTn-alignment.png</code></pre>
</section>
</section>
<section id="retrieve-gene-sequences" class="level1">
<h1>4 RETRIEVE GENE SEQUENCES</h1>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The below would <em>not</em> execute in Rstudio/Rstudio Server. I tried on two different computers and the chunk would just “run” indefinitly. Code executes without issue in a terminal.</p>
</div>
</div>
<pre><code>for ID in "${sequence_IDs[@]}"
do
  ${esearch} -db nuccore -query "${ID}" \
  | ${efetch} -format fasta \
  &gt; "${data_dir}"/"${ID}".fasta
done</code></pre>
</section>
<section id="primer-design-using-primer3" class="level1">
<h1>5 PRIMER DESIGN USING <a href="https://github.com/primer3-org/primer3">PRIMER3</a></h1>
<section id="design-primers" class="level2">
<h2 class="anchored" data-anchor-id="design-primers">5.1 Design primers</h2>
<p>Quick explanation: <a href="https://github.com/primer3-org/primer3">Primer3</a> requires a specially formatted input file. The file must be formatted similarly to this:</p>
<pre><code>SEQUENCE_ID=${seq_id}
SEQUENCE_TEMPLATE=${sequence}
PRIMER_TASK=generic
PRIMER_PICK_LEFT_PRIMER=3
PRIMER_PICK_RIGHT_PRIMER=3
PRIMER_OPT_SIZE=18
PRIMER_MIN_SIZE=15
PRIMER_MAX_SIZE=21
PRIMER_MAX_NS_ACCEPTED=1
PRIMER_PRODUCT_SIZE_RANGE=75-150
P3_FILE_FLAG=1
PRIMER_EXPLAIN_FLAG=1
=</code></pre>
<p>Values after the <code>=</code> on each line can be changed to whatever values the user decides. The ${sequence} must be a nucleotide sequence on a single line, with no line breaks.</p>
<p>The code in the chunk below uses a heredoc to write this information to a file. Use of a heredoc allows the variables specified in the Primer3 config to expand to their actual values. Everything <em>between</em> the following two lines gets printed (via cat) as shown and then redirected to the indicated file (<code>primer3-params.txt</code>):</p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt; EOF</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span>/primer3-params.txt</span>
<span id="cb11-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">This text will end up in the file.</span></span>
<span id="cb11-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">So will this.</span></span>
<span id="cb11-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">And this.</span></span>
<span id="cb11-5"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">EOF</span></span></code></pre></div>
<p><a href="https://github.com/primer3-org/primer3">Primer3</a> is run with the <code>--format_output</code> to make a nice, human-readable output format.</p>
<p>I’ve also set <a href="https://github.com/primer3-org/primer3">Primer3</a> to look for sequencing primers and have defined the <code>SEQUENCE_TARGET</code>.</p>
<section id="ncbi-blastn-alignments" class="level4">
<h4 class="anchored" data-anchor-id="ncbi-blastn-alignments">5.1.0.1 NCBI BLASTn alignments</h4>
<p>Each sequence was BLASTn’d against <em>C.gigas</em> nucleotides to identify unique regions in each of the three variants to improve our ability to detect each variant’s expression level.</p>
<section id="nm_001305360.1" class="level5">
<h5 class="anchored" data-anchor-id="nm_001305360.1">5.1.0.1.1 NM_001305360.1</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2025/2025-01-17-Primer-Design---C.gigas-Alternative-Oxidase-AOX-Variants-Using-Primer3/NM_001305360.1-NCBI-BLASTn-alignment.png" class="img-fluid figure-img"></p>
<figcaption>NM_001305360.1 BLASTn alignment</figcaption>
</figure>
</div>
</section>
<section id="xm_034462847.2" class="level5">
<h5 class="anchored" data-anchor-id="xm_034462847.2">5.1.0.1.2 XM_034462847.2</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2025/2025-01-17-Primer-Design---C.gigas-Alternative-Oxidase-AOX-Variants-Using-Primer3/XM_034462847.2-NCBI-BLASTn-alignment.png" class="img-fluid figure-img"></p>
<figcaption>XM_034462847.2 BLASTn alignment</figcaption>
</figure>
</div>
</section>
<section id="xm_066083499.1" class="level5">
<h5 class="anchored" data-anchor-id="xm_066083499.1">5.1.0.1.3 XM_066083499.1</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2025/2025-01-17-Primer-Design---C.gigas-Alternative-Oxidase-AOX-Variants-Using-Primer3/XM_066083499.1-NCBI-BLASTn-alignment.png" class="img-fluid figure-img"></p>
<figcaption>XM_066083499.1 BLASTn alignment</figcaption>
</figure>
</div>
</section>
</section>
<section id="nm_001305360.1-1" class="level3">
<h3 class="anchored" data-anchor-id="nm_001305360.1-1">5.1.1 NM_001305360.1</h3>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb12-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb12-3"></span>
<span id="cb12-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get sequence only, by skipping the first record</span></span>
<span id="cb12-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove newlines so sequence is on a single line</span></span>
<span id="cb12-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sequence</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'NR &gt; 1'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${data_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${NM_001305360_fasta}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tr</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'\n'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb12-7"></span>
<span id="cb12-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sequence_ID</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NM_001305360.1"</span></span>
<span id="cb12-9"></span>
<span id="cb12-10"></span>
<span id="cb12-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use heredoc to create Primer3 parameters file</span></span>
<span id="cb12-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># PRIMER_TASK=generic is used with PRIMER_PICK settings to be PCR primers.</span></span>
<span id="cb12-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt; EOF</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span>/NM_001305360.1-primer3-params.txt</span>
<span id="cb12-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">SEQUENCE_ID=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sequence_ID}</span></span>
<span id="cb12-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">SEQUENCE_TEMPLATE=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sequence}</span></span>
<span id="cb12-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_TASK=generic</span></span>
<span id="cb12-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_MIN_TM=50</span></span>
<span id="cb12-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_OPT_TM=60</span></span>
<span id="cb12-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">SEQUENCE_PRIMER_PAIR_OK_REGION_LIST=1109,50,,</span></span>
<span id="cb12-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_PICK_LEFT_PRIMER=1</span></span>
<span id="cb12-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_PICK_INTERNAL_OLIGO=0</span></span>
<span id="cb12-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_PICK_RIGHT_PRIMER=1</span></span>
<span id="cb12-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_OPT_SIZE=20</span></span>
<span id="cb12-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_MIN_SIZE=18</span></span>
<span id="cb12-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_MAX_SIZE=25</span></span>
<span id="cb12-26"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_PRODUCT_SIZE_RANGE=75-150</span></span>
<span id="cb12-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_MAX_NS_ACCEPTED=0</span></span>
<span id="cb12-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">P3_FILE_FLAG=1</span></span>
<span id="cb12-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_EXPLAIN_FLAG=1</span></span>
<span id="cb12-30"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_THERMODYNAMIC_PARAMETERS_PATH=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${primer3_config}</span></span>
<span id="cb12-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_NUM_RETURN=3</span></span>
<span id="cb12-32"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_PAIR_EXPLAIN=considered 0, ok 0</span></span>
<span id="cb12-33"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">=</span></span>
<span id="cb12-34"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">EOF</span></span>
<span id="cb12-35"></span>
<span id="cb12-36"></span>
<span id="cb12-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run Primer3</span></span>
<span id="cb12-38"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${primer3}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-39">--format_output <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-40">--output=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/NM_001305360.1-primer3-primers.txt"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-41"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/NM_001305360.1-primer3-params.txt"</span></span>
<span id="cb12-42"></span>
<span id="cb12-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run Primer3 with default output for parsable results</span></span>
<span id="cb12-44"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${primer3}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-45">--output=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/NM_001305360.1-primer3-primers-default-format.txt"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-46"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/NM_001305360.1-primer3-params.txt"</span></span></code></pre></div>
<section id="review-primers" class="level4">
<h4 class="anchored" data-anchor-id="review-primers">5.1.1.1 Review primers</h4>
<section id="easy-to-read" class="level5">
<h5 class="anchored" data-anchor-id="easy-to-read">5.1.1.1.1 Easy-to-read</h5>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb13-2"></span>
<span id="cb13-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/NM_001305360.1-primer3-primers.txt"</span></span></code></pre></div>
<pre><code>PRIMER PICKING RESULTS FOR NM_001305360.1

No mispriming library specified
Using 0-based sequence positions
OLIGO            start  len      tm     gc%  any_th  3'_th hairpin seq
LEFT PRIMER       1112   20   57.36   45.00    8.11   7.53    0.00 TCTCACTGTGGAAATGCACA
RIGHT PRIMER      1194   21   56.16   42.86    0.00   0.00    0.00 TGGACATTCATCTCTACTGCT
SEQUENCE SIZE: 1214
INCLUDED REGION SIZE: 1214

PRODUCT SIZE: 83, PAIR ANY_TH COMPL: 0.00, PAIR 3'_TH COMPL: 0.00
PAIR_OK_REGIONS (left_start, left_len, right_start, right_len)*: 1109,50,1158,57

    0 GGAATTTTCAGATTTGAGAAGTGAAGAATATATCTGAGGTACTTTAAATATACGATGCGC
                                                                  

   60 TATGGGAAGTTTGCGACAAATAACGAAATTGAGTGAAAATGGTGTCCGGATTTTCTGTTC
                                                                  

  120 CCAACTAAAGAATCTAGAAAATAATTCAATTCTACTGAGGGTCAGTGGAATTCGCACCAG
                                                                  

  180 CAATGGGCTTCGCAATGCAGGAACAAAGGCTGACGTTGATGAAAATATAAAGAAATTTAA
                                                                  

  240 AGAGGAAAATTTTGAAAAAATTCCAGACCCCGAACAGCTCGATCACTTCAGGAAAACACA
                                                                  

  300 GAGCACAGATCAACTGGTGGAGTCAATGAAGAACCCTCCCCCAATGGGCACGCACACACT
                                                                  

  360 GCCCCACCCAATATGGTCTGAAGAAGAACTTCATAGTGTGAAGGTCACACATAAACCGCC
                                                                  

  420 CGAGGGATTCGTAGACAAGCTTGCCTTTCGATCAGTGAAGCTGCTACGTTCAACTTTTGA
                                                                  

  480 CCTTTTAACCGGGTTCAACTGGGGAGAAAGAACGGAGAAGAAATGGGTCTTACGGATTTG
                                                                  

  540 CTTCCTAGAGACTGTCGCTGGAGTTCCAGGAATGGTGGCAGCGATGACGCGACATTTACA
                                                                  

  600 CTCTTTGCGCCGACTCAAGCGGGATCACGGCTGGATTCATACCCTTTTAGAGGAAGCAGA
                                                                  

  660 AAACGAGAGAATGCATCTGATGACAGCATTGCAGCTTCGACAACCATCTTGGTTATTTAG
                                                                  

  720 AAGTGGCGTCATCGTGTCTCAGGGTGCTTTCGTCACGATGTTCAGCATTGCCTATATGCT
                                                                  

  780 AAGTCCTCGGTTTTGTCATCGTTTCGTTGGCTATCTAGAGGAGGAAGCAGTGTTTACTTA
                                                                  

  840 TTCAAAATGTTTGAAGGATATAGAGTCAGGGTCCCTTAAACACTGGCAAACAAAAGCAGC
                                                                  

  900 ACCCGACGTGGCCATCCGCTATTGGAAACTCCCAGAAACTGCATCCATGAAGGATGTAGT
                                                                  

  960 GTTGGCAATTCGAGCAGATGAGGCTCACCATAGGGTCGTGAACCATACTCTGGCTTCCAT
                                                                  

 1020 GAAAGAAGACGAATACAATCCTTATGAGCCAGGGAAGTGATATGGAAGCAGAGAAAACAG
                                                                  

 1080 TGTTAACATTCTGTAGTTATACTGTGAATACATCTCACTGTGGAAATGCACATTACTTGC
                                      &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;        

 1140 CTTTGATACAATGTACATGTACATGTAGTAAGTAAGCAGTAGAGATGAATGTCCATTGTA
                                        &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;     

 1200 TAATTCAGGCCATG
                    

KEYS (in order of precedence):
&gt;&gt;&gt;&gt;&gt;&gt; left primer
&lt;&lt;&lt;&lt;&lt;&lt; right primer

ADDITIONAL OLIGOS
                    start  len      tm     gc%  any_th  3'_th hairpin seq

 1 LEFT PRIMER       1110   22   59.18   45.45    8.11   7.53    0.00 CATCTCACTGTGGAAATGCACA
   RIGHT PRIMER      1194   21   56.16   42.86    0.00   0.00    0.00 TGGACATTCATCTCTACTGCT
   PRODUCT SIZE: 85, PAIR ANY_TH COMPL: 0.00, PAIR 3'_TH COMPL: 0.00

 2 LEFT PRIMER       1109   22   59.18   45.45    8.11   0.00    0.00 ACATCTCACTGTGGAAATGCAC
   RIGHT PRIMER      1194   21   56.16   42.86    0.00   0.00    0.00 TGGACATTCATCTCTACTGCT
   PRODUCT SIZE: 86, PAIR ANY_TH COMPL: 0.00, PAIR 3'_TH COMPL: 0.00

Statistics
         con   too    in    in   not          no    tm    tm   high  high  high        high      
         sid  many   tar  excl    ok   bad    GC   too   too any_th 3'_th hair-  poly   end      
        ered    Ns   get   reg   reg   GC% clamp   low  high  compl compl   pin     X  stab    ok
Left    9120     0     0     0  8887     0     0    22     0      0     0     0     0     0   211
Right   9120     0     0     0  8836     0     0    90     0      0     0     0     0     0   194
Pair Stats:
considered 3, ok 3
libprimer3 release 2.6.1</code></pre>
</section>
<section id="print-the-full-output-file" class="level5">
<h5 class="anchored" data-anchor-id="print-the-full-output-file">5.1.1.1.2 Print the full output file</h5>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb15-2"></span>
<span id="cb15-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/NM_001305360.1-primer3-primers-default-format.txt"</span></span></code></pre></div>
<pre><code>SEQUENCE_ID=NM_001305360.1
SEQUENCE_TEMPLATE=GGAATTTTCAGATTTGAGAAGTGAAGAATATATCTGAGGTACTTTAAATATACGATGCGCTATGGGAAGTTTGCGACAAATAACGAAATTGAGTGAAAATGGTGTCCGGATTTTCTGTTCCCAACTAAAGAATCTAGAAAATAATTCAATTCTACTGAGGGTCAGTGGAATTCGCACCAGCAATGGGCTTCGCAATGCAGGAACAAAGGCTGACGTTGATGAAAATATAAAGAAATTTAAAGAGGAAAATTTTGAAAAAATTCCAGACCCCGAACAGCTCGATCACTTCAGGAAAACACAGAGCACAGATCAACTGGTGGAGTCAATGAAGAACCCTCCCCCAATGGGCACGCACACACTGCCCCACCCAATATGGTCTGAAGAAGAACTTCATAGTGTGAAGGTCACACATAAACCGCCCGAGGGATTCGTAGACAAGCTTGCCTTTCGATCAGTGAAGCTGCTACGTTCAACTTTTGACCTTTTAACCGGGTTCAACTGGGGAGAAAGAACGGAGAAGAAATGGGTCTTACGGATTTGCTTCCTAGAGACTGTCGCTGGAGTTCCAGGAATGGTGGCAGCGATGACGCGACATTTACACTCTTTGCGCCGACTCAAGCGGGATCACGGCTGGATTCATACCCTTTTAGAGGAAGCAGAAAACGAGAGAATGCATCTGATGACAGCATTGCAGCTTCGACAACCATCTTGGTTATTTAGAAGTGGCGTCATCGTGTCTCAGGGTGCTTTCGTCACGATGTTCAGCATTGCCTATATGCTAAGTCCTCGGTTTTGTCATCGTTTCGTTGGCTATCTAGAGGAGGAAGCAGTGTTTACTTATTCAAAATGTTTGAAGGATATAGAGTCAGGGTCCCTTAAACACTGGCAAACAAAAGCAGCACCCGACGTGGCCATCCGCTATTGGAAACTCCCAGAAACTGCATCCATGAAGGATGTAGTGTTGGCAATTCGAGCAGATGAGGCTCACCATAGGGTCGTGAACCATACTCTGGCTTCCATGAAAGAAGACGAATACAATCCTTATGAGCCAGGGAAGTGATATGGAAGCAGAGAAAACAGTGTTAACATTCTGTAGTTATACTGTGAATACATCTCACTGTGGAAATGCACATTACTTGCCTTTGATACAATGTACATGTACATGTAGTAAGTAAGCAGTAGAGATGAATGTCCATTGTATAATTCAGGCCATG
PRIMER_TASK=generic
PRIMER_MIN_TM=50
PRIMER_OPT_TM=60
SEQUENCE_PRIMER_PAIR_OK_REGION_LIST=1109,50,,
PRIMER_PICK_LEFT_PRIMER=1
PRIMER_PICK_INTERNAL_OLIGO=0
PRIMER_PICK_RIGHT_PRIMER=1
PRIMER_OPT_SIZE=20
PRIMER_MIN_SIZE=18
PRIMER_MAX_SIZE=25
PRIMER_PRODUCT_SIZE_RANGE=75-150
PRIMER_MAX_NS_ACCEPTED=0
P3_FILE_FLAG=1
PRIMER_EXPLAIN_FLAG=1
PRIMER_THERMODYNAMIC_PARAMETERS_PATH=/home/shared/primer3-2.6.1/src/primer3_config
PRIMER_NUM_RETURN=3
PRIMER_PAIR_EXPLAIN=considered 0, ok 0
PRIMER_LEFT_EXPLAIN=considered 9120, low tm 22, not in any ok left region 8887, ok 211
PRIMER_RIGHT_EXPLAIN=considered 9120, low tm 90, not in any ok right region 8836, ok 194
PRIMER_PAIR_EXPLAIN=considered 3, ok 3
PRIMER_LEFT_NUM_RETURNED=3
PRIMER_RIGHT_NUM_RETURNED=3
PRIMER_INTERNAL_NUM_RETURNED=0
PRIMER_PAIR_NUM_RETURNED=3
PRIMER_PAIR_0_PENALTY=7.475896
PRIMER_LEFT_0_PENALTY=2.636647
PRIMER_RIGHT_0_PENALTY=4.839250
PRIMER_LEFT_0_SEQUENCE=TCTCACTGTGGAAATGCACA
PRIMER_RIGHT_0_SEQUENCE=TGGACATTCATCTCTACTGCT
PRIMER_LEFT_0=1112,20
PRIMER_RIGHT_0=1194,21
PRIMER_LEFT_0_TM=57.363
PRIMER_RIGHT_0_TM=56.161
PRIMER_LEFT_0_GC_PERCENT=45.000
PRIMER_RIGHT_0_GC_PERCENT=42.857
PRIMER_LEFT_0_SELF_ANY_TH=8.11
PRIMER_RIGHT_0_SELF_ANY_TH=0.00
PRIMER_LEFT_0_SELF_END_TH=7.53
PRIMER_RIGHT_0_SELF_END_TH=0.00
PRIMER_LEFT_0_HAIRPIN_TH=0.00
PRIMER_RIGHT_0_HAIRPIN_TH=0.00
PRIMER_LEFT_0_END_STABILITY=4.5700
PRIMER_RIGHT_0_END_STABILITY=4.2400
PRIMER_PAIR_0_COMPL_ANY_TH=0.00
PRIMER_PAIR_0_COMPL_END_TH=0.00
PRIMER_PAIR_0_PRODUCT_SIZE=83
PRIMER_PAIR_0_PRODUCT_TM=76.5
PRIMER_PAIR_1_PENALTY=7.654753
PRIMER_LEFT_1_PENALTY=2.815503
PRIMER_RIGHT_1_PENALTY=4.839250
PRIMER_LEFT_1_SEQUENCE=CATCTCACTGTGGAAATGCACA
PRIMER_RIGHT_1_SEQUENCE=TGGACATTCATCTCTACTGCT
PRIMER_LEFT_1=1110,22
PRIMER_RIGHT_1=1194,21
PRIMER_LEFT_1_TM=59.184
PRIMER_RIGHT_1_TM=56.161
PRIMER_LEFT_1_GC_PERCENT=45.455
PRIMER_RIGHT_1_GC_PERCENT=42.857
PRIMER_LEFT_1_SELF_ANY_TH=8.11
PRIMER_RIGHT_1_SELF_ANY_TH=0.00
PRIMER_LEFT_1_SELF_END_TH=7.53
PRIMER_RIGHT_1_SELF_END_TH=0.00
PRIMER_LEFT_1_HAIRPIN_TH=0.00
PRIMER_RIGHT_1_HAIRPIN_TH=0.00
PRIMER_LEFT_1_END_STABILITY=4.5700
PRIMER_RIGHT_1_END_STABILITY=4.2400
PRIMER_PAIR_1_COMPL_ANY_TH=0.00
PRIMER_PAIR_1_COMPL_END_TH=0.00
PRIMER_PAIR_1_PRODUCT_SIZE=85
PRIMER_PAIR_1_PRODUCT_TM=76.8
PRIMER_PAIR_2_PENALTY=7.655337
PRIMER_LEFT_2_PENALTY=2.816087
PRIMER_RIGHT_2_PENALTY=4.839250
PRIMER_LEFT_2_SEQUENCE=ACATCTCACTGTGGAAATGCAC
PRIMER_RIGHT_2_SEQUENCE=TGGACATTCATCTCTACTGCT
PRIMER_LEFT_2=1109,22
PRIMER_RIGHT_2=1194,21
PRIMER_LEFT_2_TM=59.184
PRIMER_RIGHT_2_TM=56.161
PRIMER_LEFT_2_GC_PERCENT=45.455
PRIMER_RIGHT_2_GC_PERCENT=42.857
PRIMER_LEFT_2_SELF_ANY_TH=8.11
PRIMER_RIGHT_2_SELF_ANY_TH=0.00
PRIMER_LEFT_2_SELF_END_TH=0.00
PRIMER_RIGHT_2_SELF_END_TH=0.00
PRIMER_LEFT_2_HAIRPIN_TH=0.00
PRIMER_RIGHT_2_HAIRPIN_TH=0.00
PRIMER_LEFT_2_END_STABILITY=4.5700
PRIMER_RIGHT_2_END_STABILITY=4.2400
PRIMER_PAIR_2_COMPL_ANY_TH=0.00
PRIMER_PAIR_2_COMPL_END_TH=0.00
PRIMER_PAIR_2_PRODUCT_SIZE=86
PRIMER_PAIR_2_PRODUCT_TM=76.7
=</code></pre>
</section>
</section>
</section>
<section id="xm_034462847.2-1" class="level3">
<h3 class="anchored" data-anchor-id="xm_034462847.2-1">5.1.2 XM_034462847.2</h3>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb17-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb17-3"></span>
<span id="cb17-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get sequence only, by skipping the first record</span></span>
<span id="cb17-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove newlines so sequence is on a single line</span></span>
<span id="cb17-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sequence</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'NR &gt; 1'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${data_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${XM_034462847_fasta}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tr</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'\n'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb17-7"></span>
<span id="cb17-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sequence_ID</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"XM_034462847.2"</span></span>
<span id="cb17-9"></span>
<span id="cb17-10"></span>
<span id="cb17-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use heredoc to create Primer3 parameters file</span></span>
<span id="cb17-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># PRIMER_TASK=generic is used with PRIMER_PICK settings to be PCR primers.</span></span>
<span id="cb17-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt; EOF</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span>/XM_034462847.2-primer3-params.txt</span>
<span id="cb17-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">SEQUENCE_ID=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sequence_ID}</span></span>
<span id="cb17-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">SEQUENCE_TEMPLATE=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sequence}</span></span>
<span id="cb17-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_TASK=generic</span></span>
<span id="cb17-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_MIN_TM=50</span></span>
<span id="cb17-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_OPT_TM=60</span></span>
<span id="cb17-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">SEQUENCE_PRIMER_PAIR_OK_REGION_LIST=90,25,,</span></span>
<span id="cb17-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_PICK_LEFT_PRIMER=1</span></span>
<span id="cb17-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_PICK_INTERNAL_OLIGO=0</span></span>
<span id="cb17-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_PICK_RIGHT_PRIMER=1</span></span>
<span id="cb17-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_OPT_SIZE=20</span></span>
<span id="cb17-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_MIN_SIZE=18</span></span>
<span id="cb17-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_MAX_SIZE=25</span></span>
<span id="cb17-26"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_PRODUCT_SIZE_RANGE=75-150</span></span>
<span id="cb17-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_MAX_NS_ACCEPTED=0</span></span>
<span id="cb17-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">P3_FILE_FLAG=1</span></span>
<span id="cb17-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_EXPLAIN_FLAG=1</span></span>
<span id="cb17-30"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_THERMODYNAMIC_PARAMETERS_PATH=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${primer3_config}</span></span>
<span id="cb17-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_NUM_RETURN=3</span></span>
<span id="cb17-32"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_PAIR_EXPLAIN=considered 0, ok 0</span></span>
<span id="cb17-33"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">=</span></span>
<span id="cb17-34"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">EOF</span></span>
<span id="cb17-35"></span>
<span id="cb17-36"></span>
<span id="cb17-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run Primer3</span></span>
<span id="cb17-38"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${primer3}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb17-39">--format_output <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb17-40">--output=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/XM_034462847.2-primer3-primers.txt"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb17-41"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/XM_034462847.2-primer3-params.txt"</span></span>
<span id="cb17-42"></span>
<span id="cb17-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run Primer3 with default output for parsable results</span></span>
<span id="cb17-44"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${primer3}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb17-45">--output=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/XM_034462847.2-primer3-primers-default-format.txt"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb17-46"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/XM_034462847.2-primer3-params.txt"</span></span></code></pre></div>
<section id="review-primers-1" class="level4">
<h4 class="anchored" data-anchor-id="review-primers-1">5.1.2.1 Review primers</h4>
<section id="easy-to-read-1" class="level5">
<h5 class="anchored" data-anchor-id="easy-to-read-1">5.1.2.1.1 Easy-to-read</h5>
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb18-2"></span>
<span id="cb18-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/XM_034462847.2-primer3-primers.txt"</span></span></code></pre></div>
<pre><code>PRIMER PICKING RESULTS FOR XM_034462847.2

No mispriming library specified
Using 0-based sequence positions
OLIGO            start  len      tm     gc%  any_th  3'_th hairpin seq
LEFT PRIMER         91   24   59.07   41.67    0.00   0.00    0.00 TCGATCACTTCAGAATTTCACAGG
RIGHT PRIMER       169   20   60.03   60.00    0.00   0.00    0.00 CCATTGGGGGAGGGTTCTTC
SEQUENCE SIZE: 931
INCLUDED REGION SIZE: 931

PRODUCT SIZE: 79, PAIR ANY_TH COMPL: 0.00, PAIR 3'_TH COMPL: 0.00
PAIR_OK_REGIONS (left_start, left_len, right_start, right_len)*: 90,25,139,109

    0 CTTCGCAATGCAGGAACAAAGGCTGACGTTGATGAAAATATAAAGAAATTTAAAGAGGAA
                                                                  

   60 AATTTTGAAAAAATTCCAGACCCCGAACAGCTCGATCACTTCAGAATTTCACAGGAAAAC
                                     &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     

  120 ACAGAGCACAGATCAACTGGTGGAGTCAATGAAGAACCCTCCCCCAATGGGCACGCACAC
                                    &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;          

  180 ACTGCCCCACCCAATATGGTCTGAAGAAGAACTTCATAGTGTGAAGGTCACACATAAACC
                                                                  

  240 GCCCGAGGGATTCGTAGACAAGCTTGCCTTTCGATCAGTGAAGCTGCTACGTTCAACTTT
                                                                  

  300 TGACCTTTTAACCGGGTTCAACTGGGGAGAAAGAACGGAGAAGAAATGGGTGTTACGGAT
                                                                  

  360 TTGCTTCCTAGAGACTGTCGCTGGAGTTCCAGGGATGGTGGCAGCGATGACGCGACATTT
                                                                  

  420 ACACTCTTTGCGCCGACTCAAGCGGGATCACGGCTGGATTCATACCCTTTTAGAGGAAGC
                                                                  

  480 AGAAAACGAAAGAATGCATCTGATGACAGCATTGCAGCTTCGACAACCATCTTGGTTATT
                                                                  

  540 TAGAAGTGGCGTCATCGTGTCTCAGGGTGCTTTCGTCACGATGTTCAGCATTGCCTATAT
                                                                  

  600 GCTAAGCCCTCGGTTTTGTCATCGGTTCGTTGGCTATCTAGAGGAGGAAGCAGTGTTTAC
                                                                  

  660 TTACTCAAAATGTTTGAAGGATATAGAGTCAGGGCCCCTTAAACACTGGCAAACAAAAGC
                                                                  

  720 AGCACCCGACGTGGCTATCCGCTATTGGAAACTCCCAGAAACTGCATCCATGAAGGATGT
                                                                  

  780 AGTGTTGGCAATTCGAGCAGATGAGGCTCACCATAGGGTCGTGAACCATACTCTGGCTTC
                                                                  

  840 CATGAAAGAAGACGAATACAATCCTTATGAGCCAGGGAAGTGATATGGAAGCAGAGAAAA
                                                                  

  900 CAGCGTTAACATTCTGTAGTTATACTGTGAA
                                     

KEYS (in order of precedence):
&gt;&gt;&gt;&gt;&gt;&gt; left primer
&lt;&lt;&lt;&lt;&lt;&lt; right primer

ADDITIONAL OLIGOS
                    start  len      tm     gc%  any_th  3'_th hairpin seq

 1 LEFT PRIMER         91   24   59.07   41.67    0.00   0.00    0.00 TCGATCACTTCAGAATTTCACAGG
   RIGHT PRIMER       196   20   60.03   55.00    0.00   0.00    0.00 ATATTGGGTGGGGCAGTGTG
   PRODUCT SIZE: 106, PAIR ANY_TH COMPL: 0.00, PAIR 3'_TH COMPL: 0.00

 2 LEFT PRIMER         91   24   59.07   41.67    0.00   0.00    0.00 TCGATCACTTCAGAATTTCACAGG
   RIGHT PRIMER       197   20   60.03   55.00    0.00   0.00    0.00 CATATTGGGTGGGGCAGTGT
   PRODUCT SIZE: 107, PAIR ANY_TH COMPL: 0.00, PAIR 3'_TH COMPL: 0.00

Statistics
         con   too    in    in   not          no    tm    tm   high  high  high        high      
         sid  many   tar  excl    ok   bad    GC   too   too any_th 3'_th hair-  poly   end      
        ered    Ns   get   reg   reg   GC% clamp   low  high  compl compl   pin     X  stab    ok
Left    6856     0     0     0  6820     0     0    10     0      0     0     0     0     0    26
Right   6856     0     0     0  6148     0     0    42   255      0     0   185     0     0   226
Pair Stats:
considered 4, ok 4
libprimer3 release 2.6.1</code></pre>
</section>
<section id="print-the-full-output-file-1" class="level5">
<h5 class="anchored" data-anchor-id="print-the-full-output-file-1">5.1.2.1.2 Print the full output file</h5>
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb20-2"></span>
<span id="cb20-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/XM_034462847.2-primer3-primers-default-format.txt"</span></span></code></pre></div>
<pre><code>SEQUENCE_ID=XM_034462847.2
SEQUENCE_TEMPLATE=CTTCGCAATGCAGGAACAAAGGCTGACGTTGATGAAAATATAAAGAAATTTAAAGAGGAAAATTTTGAAAAAATTCCAGACCCCGAACAGCTCGATCACTTCAGAATTTCACAGGAAAACACAGAGCACAGATCAACTGGTGGAGTCAATGAAGAACCCTCCCCCAATGGGCACGCACACACTGCCCCACCCAATATGGTCTGAAGAAGAACTTCATAGTGTGAAGGTCACACATAAACCGCCCGAGGGATTCGTAGACAAGCTTGCCTTTCGATCAGTGAAGCTGCTACGTTCAACTTTTGACCTTTTAACCGGGTTCAACTGGGGAGAAAGAACGGAGAAGAAATGGGTGTTACGGATTTGCTTCCTAGAGACTGTCGCTGGAGTTCCAGGGATGGTGGCAGCGATGACGCGACATTTACACTCTTTGCGCCGACTCAAGCGGGATCACGGCTGGATTCATACCCTTTTAGAGGAAGCAGAAAACGAAAGAATGCATCTGATGACAGCATTGCAGCTTCGACAACCATCTTGGTTATTTAGAAGTGGCGTCATCGTGTCTCAGGGTGCTTTCGTCACGATGTTCAGCATTGCCTATATGCTAAGCCCTCGGTTTTGTCATCGGTTCGTTGGCTATCTAGAGGAGGAAGCAGTGTTTACTTACTCAAAATGTTTGAAGGATATAGAGTCAGGGCCCCTTAAACACTGGCAAACAAAAGCAGCACCCGACGTGGCTATCCGCTATTGGAAACTCCCAGAAACTGCATCCATGAAGGATGTAGTGTTGGCAATTCGAGCAGATGAGGCTCACCATAGGGTCGTGAACCATACTCTGGCTTCCATGAAAGAAGACGAATACAATCCTTATGAGCCAGGGAAGTGATATGGAAGCAGAGAAAACAGCGTTAACATTCTGTAGTTATACTGTGAA
PRIMER_TASK=generic
PRIMER_MIN_TM=50
PRIMER_OPT_TM=60
SEQUENCE_PRIMER_PAIR_OK_REGION_LIST=90,25,,
PRIMER_PICK_LEFT_PRIMER=1
PRIMER_PICK_INTERNAL_OLIGO=0
PRIMER_PICK_RIGHT_PRIMER=1
PRIMER_OPT_SIZE=20
PRIMER_MIN_SIZE=18
PRIMER_MAX_SIZE=25
PRIMER_PRODUCT_SIZE_RANGE=75-150
PRIMER_MAX_NS_ACCEPTED=0
P3_FILE_FLAG=1
PRIMER_EXPLAIN_FLAG=1
PRIMER_THERMODYNAMIC_PARAMETERS_PATH=/home/shared/primer3-2.6.1/src/primer3_config
PRIMER_NUM_RETURN=3
PRIMER_PAIR_EXPLAIN=considered 0, ok 0
PRIMER_LEFT_EXPLAIN=considered 6856, low tm 10, not in any ok left region 6820, ok 26
PRIMER_RIGHT_EXPLAIN=considered 6856, low tm 42, high tm 255, high hairpin stability 185, not in any ok right region 6148, ok 226
PRIMER_PAIR_EXPLAIN=considered 4, ok 4
PRIMER_LEFT_NUM_RETURNED=3
PRIMER_RIGHT_NUM_RETURNED=3
PRIMER_INTERNAL_NUM_RETURNED=0
PRIMER_PAIR_NUM_RETURNED=3
PRIMER_PAIR_0_PENALTY=4.964710
PRIMER_LEFT_0_PENALTY=4.931601
PRIMER_RIGHT_0_PENALTY=0.033109
PRIMER_LEFT_0_SEQUENCE=TCGATCACTTCAGAATTTCACAGG
PRIMER_RIGHT_0_SEQUENCE=CCATTGGGGGAGGGTTCTTC
PRIMER_LEFT_0=91,24
PRIMER_RIGHT_0=169,20
PRIMER_LEFT_0_TM=59.068
PRIMER_RIGHT_0_TM=60.033
PRIMER_LEFT_0_GC_PERCENT=41.667
PRIMER_RIGHT_0_GC_PERCENT=60.000
PRIMER_LEFT_0_SELF_ANY_TH=0.00
PRIMER_RIGHT_0_SELF_ANY_TH=0.00
PRIMER_LEFT_0_SELF_END_TH=0.00
PRIMER_RIGHT_0_SELF_END_TH=0.00
PRIMER_LEFT_0_HAIRPIN_TH=0.00
PRIMER_RIGHT_0_HAIRPIN_TH=0.00
PRIMER_LEFT_0_END_STABILITY=4.0000
PRIMER_RIGHT_0_END_STABILITY=2.8700
PRIMER_PAIR_0_COMPL_ANY_TH=0.00
PRIMER_PAIR_0_COMPL_END_TH=0.00
PRIMER_PAIR_0_PRODUCT_SIZE=79
PRIMER_PAIR_0_PRODUCT_TM=80.1
PRIMER_PAIR_1_PENALTY=4.964809
PRIMER_LEFT_1_PENALTY=4.931601
PRIMER_RIGHT_1_PENALTY=0.033208
PRIMER_LEFT_1_SEQUENCE=TCGATCACTTCAGAATTTCACAGG
PRIMER_RIGHT_1_SEQUENCE=ATATTGGGTGGGGCAGTGTG
PRIMER_LEFT_1=91,24
PRIMER_RIGHT_1=196,20
PRIMER_LEFT_1_TM=59.068
PRIMER_RIGHT_1_TM=60.033
PRIMER_LEFT_1_GC_PERCENT=41.667
PRIMER_RIGHT_1_GC_PERCENT=55.000
PRIMER_LEFT_1_SELF_ANY_TH=0.00
PRIMER_RIGHT_1_SELF_ANY_TH=0.00
PRIMER_LEFT_1_SELF_END_TH=0.00
PRIMER_RIGHT_1_SELF_END_TH=0.00
PRIMER_LEFT_1_HAIRPIN_TH=0.00
PRIMER_RIGHT_1_HAIRPIN_TH=0.00
PRIMER_LEFT_1_END_STABILITY=4.0000
PRIMER_RIGHT_1_END_STABILITY=3.8200
PRIMER_PAIR_1_COMPL_ANY_TH=0.00
PRIMER_PAIR_1_COMPL_END_TH=0.00
PRIMER_PAIR_1_PRODUCT_SIZE=106
PRIMER_PAIR_1_PRODUCT_TM=83.3
PRIMER_PAIR_2_PENALTY=4.964809
PRIMER_LEFT_2_PENALTY=4.931601
PRIMER_RIGHT_2_PENALTY=0.033208
PRIMER_LEFT_2_SEQUENCE=TCGATCACTTCAGAATTTCACAGG
PRIMER_RIGHT_2_SEQUENCE=CATATTGGGTGGGGCAGTGT
PRIMER_LEFT_2=91,24
PRIMER_RIGHT_2=197,20
PRIMER_LEFT_2_TM=59.068
PRIMER_RIGHT_2_TM=60.033
PRIMER_LEFT_2_GC_PERCENT=41.667
PRIMER_RIGHT_2_GC_PERCENT=55.000
PRIMER_LEFT_2_SELF_ANY_TH=0.00
PRIMER_RIGHT_2_SELF_ANY_TH=0.00
PRIMER_LEFT_2_SELF_END_TH=0.00
PRIMER_RIGHT_2_SELF_END_TH=0.00
PRIMER_LEFT_2_HAIRPIN_TH=0.00
PRIMER_RIGHT_2_HAIRPIN_TH=0.00
PRIMER_LEFT_2_END_STABILITY=4.0000
PRIMER_RIGHT_2_END_STABILITY=3.5500
PRIMER_PAIR_2_COMPL_ANY_TH=0.00
PRIMER_PAIR_2_COMPL_END_TH=0.00
PRIMER_PAIR_2_PRODUCT_SIZE=107
PRIMER_PAIR_2_PRODUCT_TM=83.5
=</code></pre>
</section>
</section>
</section>
<section id="xm_066083499.1-1" class="level3">
<h3 class="anchored" data-anchor-id="xm_066083499.1-1">5.1.3 XM_066083499.1</h3>
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb22-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb22-3"></span>
<span id="cb22-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get sequence only, by skipping the first record</span></span>
<span id="cb22-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove newlines so sequence is on a single line</span></span>
<span id="cb22-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sequence</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'NR &gt; 1'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${data_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${XM_066083499_fasta}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tr</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'\n'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb22-7"></span>
<span id="cb22-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sequence_ID</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"XM_066083499.1"</span></span>
<span id="cb22-9"></span>
<span id="cb22-10"></span>
<span id="cb22-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use heredoc to create Primer3 parameters file</span></span>
<span id="cb22-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># PRIMER_TASK=generic is used with PRIMER_PICK settings to be PCR primers.</span></span>
<span id="cb22-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt; EOF</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span>/XM_066083499.1-primer3-params.txt</span>
<span id="cb22-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">SEQUENCE_ID=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sequence_ID}</span></span>
<span id="cb22-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">SEQUENCE_TEMPLATE=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sequence}</span></span>
<span id="cb22-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_TASK=generic</span></span>
<span id="cb22-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_MIN_TM=50</span></span>
<span id="cb22-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_OPT_TM=60</span></span>
<span id="cb22-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">SEQUENCE_PRIMER_PAIR_OK_REGION_LIST=,,1100,50</span></span>
<span id="cb22-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_PICK_LEFT_PRIMER=1</span></span>
<span id="cb22-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_PICK_INTERNAL_OLIGO=0</span></span>
<span id="cb22-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_PICK_RIGHT_PRIMER=1</span></span>
<span id="cb22-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_OPT_SIZE=20</span></span>
<span id="cb22-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_MIN_SIZE=18</span></span>
<span id="cb22-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_MAX_SIZE=25</span></span>
<span id="cb22-26"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_PRODUCT_SIZE_RANGE=75-150</span></span>
<span id="cb22-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_MAX_NS_ACCEPTED=0</span></span>
<span id="cb22-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">P3_FILE_FLAG=1</span></span>
<span id="cb22-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_EXPLAIN_FLAG=1</span></span>
<span id="cb22-30"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_THERMODYNAMIC_PARAMETERS_PATH=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${primer3_config}</span></span>
<span id="cb22-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_NUM_RETURN=3</span></span>
<span id="cb22-32"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PRIMER_PAIR_EXPLAIN=considered 0, ok 0</span></span>
<span id="cb22-33"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">=</span></span>
<span id="cb22-34"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">EOF</span></span>
<span id="cb22-35"></span>
<span id="cb22-36"></span>
<span id="cb22-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run Primer3</span></span>
<span id="cb22-38"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${primer3}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb22-39">--format_output <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb22-40">--output=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/XM_066083499.1-primer3-primers.txt"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb22-41"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/XM_066083499.1-primer3-params.txt"</span></span>
<span id="cb22-42"></span>
<span id="cb22-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run Primer3 with default output for parsable results</span></span>
<span id="cb22-44"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${primer3}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb22-45">--output=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/XM_066083499.1-primer3-primers-default-format.txt"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb22-46"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/XM_066083499.1-primer3-params.txt"</span></span></code></pre></div>
<section id="review-primers-2" class="level4">
<h4 class="anchored" data-anchor-id="review-primers-2">5.1.3.1 Review primers</h4>
<section id="easy-to-read-2" class="level5">
<h5 class="anchored" data-anchor-id="easy-to-read-2">5.1.3.1.1 Easy-to-read</h5>
<div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb23-2"></span>
<span id="cb23-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/XM_066083499.1-primer3-primers.txt"</span></span></code></pre></div>
<pre><code>PRIMER PICKING RESULTS FOR XM_066083499.1

No mispriming library specified
Using 0-based sequence positions
OLIGO            start  len      tm     gc%  any_th  3'_th hairpin seq
LEFT PRIMER       1028   20   60.25   60.00    0.00   0.00    0.00 CAGACGAGGCTAATCACCGG
RIGHT PRIMER      1141   21   58.73   47.62    0.00   0.00   34.07 TGAGGCACATTAAGGGTCTGA
SEQUENCE SIZE: 1329
INCLUDED REGION SIZE: 1329

PRODUCT SIZE: 114, PAIR ANY_TH COMPL: 0.00, PAIR 3'_TH COMPL: 0.00
PAIR_OK_REGIONS (left_start, left_len, right_start, right_len)*: 967,134,1100,50

    0 ATATATTGAGACCGTCTTGCATATTTCAGAAAATAAGAAAAAAAGTCAGTGTAAGGTATT
                                                                  

   60 TTCAGATTTGAGAAGTGAAGAATATATCTGAGGTATTTTAAATATACGAATCGCTATGGG
                                                                  

  120 AAGTTTACGACAAATAACGAAATTGAGTGAAAATGGTGTCCGGATTTTCTGTTCCCAACT
                                                                  

  180 AAAGAATCTAGAAAATAATTCAATTCTACTGAGGGTCAGTGGAATTCGCACCAGCAATGG
                                                                  

  240 GCTTCGCAATGCAGGAACAAAGGCTGACGTTGATGAAAATATAAAGAAATTTAAAGAGGA
                                                                  

  300 AAATTTTGAAAAAATTCCAGACCCCGAACAGCTCGATCACTTCAGGAAAACACAGAGCAC
                                                                  

  360 AGATCAACTGGTGGAGTCAATGAAGAACCCTCCCCCAATGGGCACGCACACACTGCCCCA
                                                                  

  420 CCCAATATGGTCTGAAGAAGAACTTCATAGTGTGAAGGTCACACATAAACCGCCCGAGGG
                                                                  

  480 ATTCGTAGACAAGCTTGCCTTTCGATCAGTGAAGCTGCTACGTTCAACTTTTGACCTTTT
                                                                  

  540 AACCGGGTTCAACTGGGGAGAAAGAACGGAGAAGAAATGGGTGTTACGGATTTGCTTCCT
                                                                  

  600 AGAGACTGTCGCTGGAGTTCCAGGGATGGTGGCAGCGATGACGCGACATTTACACTCTTT
                                                                  

  660 GCGCCGACTCAAGCGGGATCACGGCTGGATTCATACCCTTTTAGAGGAAGCAGAAAACGA
                                                                  

  720 AAGAATGCATCTGATGACAGCATTGCAGCTTCGACAACCATCTTGGTTATTTAGAAGTGG
                                                                  

  780 CGTCATCGTGTCTCAGGGTGCTTTCGTCACGATGTTCAGCATTGCCTATATGCTAAGCCC
                                                                  

  840 TCGGTTTTGTCATCGGTTCGTTGGCTATCTAGAGGAGGAAGCAGTGTTTACTTACTCAAA
                                                                  

  900 ATGTTTGAAGGATATAGAGTCAGGGCCCCTTAAACACTGGCAAACAAAAGCAGCACCCGA
                                                                  

  960 CGTGGCTATCCGCTATTGGAAACTCCCAAATAACGGAACAATGAAAGACGTCATATTTAA
                                                                  

 1020 CATCCGAGCAGACGAGGCTAATCACCGGAAAGTGAACCATGTTTTGGCATCCATGAAAAC
              &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;                                

 1080 CGACCAGTACAACCCATTTCTACCCGGTCAGTAGTTTTAAATCAGACCCTTAATGTGCCT
                                               &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;

 1140 CATCTCTGTTTACAGGAAACTGCATCCATGAAGGATGTAGTGTTGGCAATTCGAGCAGAT
      &lt;&lt;                                                          

 1200 GAGGCTCACCATAGGGTCGTGAACCATACTCTGGCTTCCATGAAAGAAGACGAATACAAT
                                                                  

 1260 CCTTATGAGCCAGGGAAGTGATATGGAAGCAGAGAAAACAGCGTTAACATTCTGTAGTTA
                                                                  

 1320 TACTGTGAA
               

KEYS (in order of precedence):
&gt;&gt;&gt;&gt;&gt;&gt; left primer
&lt;&lt;&lt;&lt;&lt;&lt; right primer

ADDITIONAL OLIGOS
                    start  len      tm     gc%  any_th  3'_th hairpin seq

 1 LEFT PRIMER       1023   20   60.32   60.00    0.00   0.00   42.78 CCGAGCAGACGAGGCTAATC
   RIGHT PRIMER      1141   21   58.73   47.62    0.00   0.00   34.07 TGAGGCACATTAAGGGTCTGA
   PRODUCT SIZE: 119, PAIR ANY_TH COMPL: 0.07, PAIR 3'_TH COMPL: 0.00

 2 LEFT PRIMER       1024   20   59.62   55.00    0.00   0.00   42.78 CGAGCAGACGAGGCTAATCA
   RIGHT PRIMER      1141   21   58.73   47.62    0.00   0.00   34.07 TGAGGCACATTAAGGGTCTGA
   PRODUCT SIZE: 118, PAIR ANY_TH COMPL: 0.07, PAIR 3'_TH COMPL: 0.00

Statistics
         con   too    in    in   not          no    tm    tm   high  high  high        high      
         sid  many   tar  excl    ok   bad    GC   too   too any_th 3'_th hair-  poly   end      
        ered    Ns   get   reg   reg   GC% clamp   low  high  compl compl   pin     X  stab    ok
Left   10040     0     0     0  9132     0     0    66    87      0     0   179     0     0   576
Right  10040     0     0     0  9804     0     0    49     0      0     0     0     0     0   187
Pair Stats:
considered 3, ok 3
libprimer3 release 2.6.1</code></pre>
</section>
<section id="print-the-full-output-file-2" class="level5">
<h5 class="anchored" data-anchor-id="print-the-full-output-file-2">5.1.3.1.2 Print the full output file</h5>
<div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb25-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb25-2"></span>
<span id="cb25-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/XM_066083499.1-primer3-primers-default-format.txt"</span></span></code></pre></div>
<pre><code>SEQUENCE_ID=XM_066083499.1
SEQUENCE_TEMPLATE=ATATATTGAGACCGTCTTGCATATTTCAGAAAATAAGAAAAAAAGTCAGTGTAAGGTATTTTCAGATTTGAGAAGTGAAGAATATATCTGAGGTATTTTAAATATACGAATCGCTATGGGAAGTTTACGACAAATAACGAAATTGAGTGAAAATGGTGTCCGGATTTTCTGTTCCCAACTAAAGAATCTAGAAAATAATTCAATTCTACTGAGGGTCAGTGGAATTCGCACCAGCAATGGGCTTCGCAATGCAGGAACAAAGGCTGACGTTGATGAAAATATAAAGAAATTTAAAGAGGAAAATTTTGAAAAAATTCCAGACCCCGAACAGCTCGATCACTTCAGGAAAACACAGAGCACAGATCAACTGGTGGAGTCAATGAAGAACCCTCCCCCAATGGGCACGCACACACTGCCCCACCCAATATGGTCTGAAGAAGAACTTCATAGTGTGAAGGTCACACATAAACCGCCCGAGGGATTCGTAGACAAGCTTGCCTTTCGATCAGTGAAGCTGCTACGTTCAACTTTTGACCTTTTAACCGGGTTCAACTGGGGAGAAAGAACGGAGAAGAAATGGGTGTTACGGATTTGCTTCCTAGAGACTGTCGCTGGAGTTCCAGGGATGGTGGCAGCGATGACGCGACATTTACACTCTTTGCGCCGACTCAAGCGGGATCACGGCTGGATTCATACCCTTTTAGAGGAAGCAGAAAACGAAAGAATGCATCTGATGACAGCATTGCAGCTTCGACAACCATCTTGGTTATTTAGAAGTGGCGTCATCGTGTCTCAGGGTGCTTTCGTCACGATGTTCAGCATTGCCTATATGCTAAGCCCTCGGTTTTGTCATCGGTTCGTTGGCTATCTAGAGGAGGAAGCAGTGTTTACTTACTCAAAATGTTTGAAGGATATAGAGTCAGGGCCCCTTAAACACTGGCAAACAAAAGCAGCACCCGACGTGGCTATCCGCTATTGGAAACTCCCAAATAACGGAACAATGAAAGACGTCATATTTAACATCCGAGCAGACGAGGCTAATCACCGGAAAGTGAACCATGTTTTGGCATCCATGAAAACCGACCAGTACAACCCATTTCTACCCGGTCAGTAGTTTTAAATCAGACCCTTAATGTGCCTCATCTCTGTTTACAGGAAACTGCATCCATGAAGGATGTAGTGTTGGCAATTCGAGCAGATGAGGCTCACCATAGGGTCGTGAACCATACTCTGGCTTCCATGAAAGAAGACGAATACAATCCTTATGAGCCAGGGAAGTGATATGGAAGCAGAGAAAACAGCGTTAACATTCTGTAGTTATACTGTGAA
PRIMER_TASK=generic
PRIMER_MIN_TM=50
PRIMER_OPT_TM=60
SEQUENCE_PRIMER_PAIR_OK_REGION_LIST=,,1100,50
PRIMER_PICK_LEFT_PRIMER=1
PRIMER_PICK_INTERNAL_OLIGO=0
PRIMER_PICK_RIGHT_PRIMER=1
PRIMER_OPT_SIZE=20
PRIMER_MIN_SIZE=18
PRIMER_MAX_SIZE=25
PRIMER_PRODUCT_SIZE_RANGE=75-150
PRIMER_MAX_NS_ACCEPTED=0
P3_FILE_FLAG=1
PRIMER_EXPLAIN_FLAG=1
PRIMER_THERMODYNAMIC_PARAMETERS_PATH=/home/shared/primer3-2.6.1/src/primer3_config
PRIMER_NUM_RETURN=3
PRIMER_PAIR_EXPLAIN=considered 0, ok 0
PRIMER_LEFT_EXPLAIN=considered 10040, low tm 66, high tm 87, high hairpin stability 179, not in any ok left region 9132, ok 576
PRIMER_RIGHT_EXPLAIN=considered 10040, low tm 49, not in any ok right region 9804, ok 187
PRIMER_PAIR_EXPLAIN=considered 3, ok 3
PRIMER_LEFT_NUM_RETURNED=3
PRIMER_RIGHT_NUM_RETURNED=3
PRIMER_INTERNAL_NUM_RETURNED=0
PRIMER_PAIR_NUM_RETURNED=3
PRIMER_PAIR_0_PENALTY=2.514439
PRIMER_LEFT_0_PENALTY=0.249073
PRIMER_RIGHT_0_PENALTY=2.265367
PRIMER_LEFT_0_SEQUENCE=CAGACGAGGCTAATCACCGG
PRIMER_RIGHT_0_SEQUENCE=TGAGGCACATTAAGGGTCTGA
PRIMER_LEFT_0=1028,20
PRIMER_RIGHT_0=1141,21
PRIMER_LEFT_0_TM=60.249
PRIMER_RIGHT_0_TM=58.735
PRIMER_LEFT_0_GC_PERCENT=60.000
PRIMER_RIGHT_0_GC_PERCENT=47.619
PRIMER_LEFT_0_SELF_ANY_TH=0.00
PRIMER_RIGHT_0_SELF_ANY_TH=0.00
PRIMER_LEFT_0_SELF_END_TH=0.00
PRIMER_RIGHT_0_SELF_END_TH=0.00
PRIMER_LEFT_0_HAIRPIN_TH=0.00
PRIMER_RIGHT_0_HAIRPIN_TH=34.07
PRIMER_LEFT_0_END_STABILITY=5.2800
PRIMER_RIGHT_0_END_STABILITY=3.2700
PRIMER_PAIR_0_COMPL_ANY_TH=0.00
PRIMER_PAIR_0_COMPL_END_TH=0.00
PRIMER_PAIR_0_PRODUCT_SIZE=114
PRIMER_PAIR_0_PRODUCT_TM=81.9
PRIMER_PAIR_1_PENALTY=2.583642
PRIMER_LEFT_1_PENALTY=0.318275
PRIMER_RIGHT_1_PENALTY=2.265367
PRIMER_LEFT_1_SEQUENCE=CCGAGCAGACGAGGCTAATC
PRIMER_RIGHT_1_SEQUENCE=TGAGGCACATTAAGGGTCTGA
PRIMER_LEFT_1=1023,20
PRIMER_RIGHT_1=1141,21
PRIMER_LEFT_1_TM=60.318
PRIMER_RIGHT_1_TM=58.735
PRIMER_LEFT_1_GC_PERCENT=60.000
PRIMER_RIGHT_1_GC_PERCENT=47.619
PRIMER_LEFT_1_SELF_ANY_TH=0.00
PRIMER_RIGHT_1_SELF_ANY_TH=0.00
PRIMER_LEFT_1_SELF_END_TH=0.00
PRIMER_RIGHT_1_SELF_END_TH=0.00
PRIMER_LEFT_1_HAIRPIN_TH=42.78
PRIMER_RIGHT_1_HAIRPIN_TH=34.07
PRIMER_LEFT_1_END_STABILITY=1.7500
PRIMER_RIGHT_1_END_STABILITY=3.2700
PRIMER_PAIR_1_COMPL_ANY_TH=0.07
PRIMER_PAIR_1_COMPL_END_TH=0.00
PRIMER_PAIR_1_PRODUCT_SIZE=119
PRIMER_PAIR_1_PRODUCT_TM=82.7
PRIMER_PAIR_2_PENALTY=2.647525
PRIMER_LEFT_2_PENALTY=0.382158
PRIMER_RIGHT_2_PENALTY=2.265367
PRIMER_LEFT_2_SEQUENCE=CGAGCAGACGAGGCTAATCA
PRIMER_RIGHT_2_SEQUENCE=TGAGGCACATTAAGGGTCTGA
PRIMER_LEFT_2=1024,20
PRIMER_RIGHT_2=1141,21
PRIMER_LEFT_2_TM=59.618
PRIMER_RIGHT_2_TM=58.735
PRIMER_LEFT_2_GC_PERCENT=55.000
PRIMER_RIGHT_2_GC_PERCENT=47.619
PRIMER_LEFT_2_SELF_ANY_TH=0.00
PRIMER_RIGHT_2_SELF_ANY_TH=0.00
PRIMER_LEFT_2_SELF_END_TH=0.00
PRIMER_RIGHT_2_SELF_END_TH=0.00
PRIMER_LEFT_2_HAIRPIN_TH=42.78
PRIMER_RIGHT_2_HAIRPIN_TH=34.07
PRIMER_LEFT_2_END_STABILITY=2.5700
PRIMER_RIGHT_2_END_STABILITY=3.2700
PRIMER_PAIR_2_COMPL_ANY_TH=0.07
PRIMER_PAIR_2_COMPL_END_TH=0.00
PRIMER_PAIR_2_PRODUCT_SIZE=118
PRIMER_PAIR_2_PRODUCT_TM=82.5
=</code></pre>
<p>Next, we’ll test them against the entire genome to assess specificity.</p>
</section>
</section>
</section>
</section>
</section>
<section id="split-genome-fasta" class="level1">
<h1>6 SPLIT GENOME FASTA</h1>
<p>For some reason, I feel like the EMBOSS PrimerSearch tool will <em>not</em> work on mulit-FastA files (or, it makes the results more difficult to decipher?), but I’m just going off of memory and repeating a process I’ve done previously.</p>
<p>This will split the genome multi-FastA file into separate FastA files.</p>
<section id="split-mulit-fasta-file-in-to-individual-fasta-files-with-pyfaidx" class="level2">
<h2 class="anchored" data-anchor-id="split-mulit-fasta-file-in-to-individual-fasta-files-with-pyfaidx">6.1 Split mulit-FastA file in to individual FastA files with PyFaidx</h2>
<div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb27-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb27-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb27-3"></span>
<span id="cb27-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make directory if it doesn't exist</span></span>
<span id="cb27-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_fasta_splits_dir}</span></span>
<span id="cb27-6"></span>
<span id="cb27-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_fasta_splits_dir}</span></span>
<span id="cb27-8"></span>
<span id="cb27-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Count sequences in FastA</span></span>
<span id="cb27-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-------------------------------------------------------------------"</span></span>
<span id="cb27-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NUMBER OF SEQUENCES IN ORIGINAL FASTA"</span></span>
<span id="cb27-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^&gt;"</span> ../<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_fasta}</span></span>
<span id="cb27-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-------------------------------------------------------------------"</span></span>
<span id="cb27-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb27-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb27-16"></span>
<span id="cb27-17"></span>
<span id="cb27-18"></span>
<span id="cb27-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Split FastA</span></span>
<span id="cb27-20"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${pyfaidx}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb27-21">--split-files <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb27-22">../<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_fasta}</span></span>
<span id="cb27-23"></span>
<span id="cb27-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Count number of individual FastA files</span></span>
<span id="cb27-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-------------------------------------------------------------------"</span></span>
<span id="cb27-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NUMBER OF INDIVIDUAL FASTA FILES"</span></span>
<span id="cb27-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.fna <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span></span>
<span id="cb27-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-------------------------------------------------------------------"</span></span></code></pre></div>
<pre><code>-------------------------------------------------------------------
NUMBER OF SEQUENCES IN ORIGINAL FASTA
29
-------------------------------------------------------------------


-------------------------------------------------------------------
NUMBER OF INDIVIDUAL FASTA FILES
29
-------------------------------------------------------------------</code></pre>
</section>
</section>
<section id="primer-search-with-emboss-primersearch" class="level1">
<h1>7 PRIMER SEARCH WITH <a href="https://emboss.sourceforge.net/apps/cvs/emboss/apps/primersearch.html">EMBOSS PRIMERSEARCH</a></h1>
<p>This will run <a href="https://emboss.sourceforge.net/apps/cvs/emboss/apps/primersearch.html">EMBOSS PrimerSearch</a> against the genome to assess primer specificity.</p>
<section id="create-emboss-primersearch-primers-file" class="level2">
<h2 class="anchored" data-anchor-id="create-emboss-primersearch-primers-file">7.1 Create EMBOSS PrimerSearch Primers File</h2>
<p>Create a tab-delimited file to use with EMBOSS PrimerSearch.</p>
<div class="sourceCode" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb29-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb29-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb29-3"></span>
<span id="cb29-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove if exists.</span></span>
<span id="cb29-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prevents appending to output file repeatedly</span></span>
<span id="cb29-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/emboss-primers.txt"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb29-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/emboss-primers.txt"</span></span>
<span id="cb29-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb29-9"></span>
<span id="cb29-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> primer_file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>primer3-primers-default-format.txt</span>
<span id="cb29-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb29-12">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">seq_id</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SEQUENCE_ID="</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${primer_file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb29-13">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s/SEQUENCE_ID=//'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb29-14">  </span>
<span id="cb29-15">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">left_primer</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PRIMER_LEFT_0_SEQUENCE="</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${primer_file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb29-16">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s/PRIMER_LEFT_0_SEQUENCE=//'</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb29-17">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tr</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[:lower:]'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[:upper:]'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb29-18"></span>
<span id="cb29-19">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">right_primer</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PRIMER_RIGHT_0_SEQUENCE="</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${primer_file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb29-20">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s/PRIMER_RIGHT_0_SEQUENCE=//'</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb29-21">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tr</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[:lower:]'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[:upper:]'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb29-22">  </span>
<span id="cb29-23">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create EMBOSS primer file</span></span>
<span id="cb29-24">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%s\t%s\t%s\t\n"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${seq_id}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${left_primer}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${right_primer}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb29-25">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--append</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/emboss-primers.txt"</span></span>
<span id="cb29-26">  </span>
<span id="cb29-27"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<pre><code>NM_001305360.1  TCTCACTGTGGAAATGCACA    TGGACATTCATCTCTACTGCT   
XM_034462847.2  TCGATCACTTCAGAATTTCACAGG    CCATTGGGGGAGGGTTCTTC    
XM_066083499.1  CAGACGAGGCTAATCACCGG    TGAGGCACATTAAGGGTCTGA   </code></pre>
</section>
<section id="run-emboss-primersearch" class="level2">
<h2 class="anchored" data-anchor-id="run-emboss-primersearch">7.2 Run EMBOSS PrimerSearch</h2>
<p>This will run EMBOSS PrimerSearch and allow for a 10% mismatch in primer annealing sites (<code>${primersearch} -auto ${fasta} ${primers} 10</code>).</p>
<p>Afterwards, the resulting output files (<code>*.primersearch</code>) will be searched for the term <code>Amplimer</code>, indicating a PCR product would be produced. If no amplimer is identified in a <code>*.primersearch</code> file, then that file is deleted. This should leave just the results in which primer matches were identified.</p>
<div class="sourceCode" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb31-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb31-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb31-3"></span>
<span id="cb31-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_fasta_splits_dir}</span></span>
<span id="cb31-5"></span>
<span id="cb31-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">primers</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../output/emboss-primers.txt"</span></span>
<span id="cb31-7"></span>
<span id="cb31-8"></span>
<span id="cb31-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">time</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb31-10">for fasta in <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.fna</span>
<span id="cb31-11">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb31-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove path from FastA filename</span></span>
<span id="cb31-13">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fasta_no_path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fasta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">})</span></span>
<span id="cb31-14">  </span>
<span id="cb31-15">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove file extension from FastA filename</span></span>
<span id="cb31-16">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fasta_no_ext</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fasta_no_path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>.<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">})</span></span>
<span id="cb31-17">  </span>
<span id="cb31-18">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert filename to lowercase</span></span>
<span id="cb31-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Will be used for output from EMBOSS PrimerSearch</span></span>
<span id="cb31-20">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fasta_no_ext_lower</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fasta_no_ext}</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tr</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[:upper:]'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[:lower:]'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb31-21">  </span>
<span id="cb31-22">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###### Run EMBOSS PrimerSearch on all FastA files ########</span></span>
<span id="cb31-23">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Allows for a 10% mismatch</span></span>
<span id="cb31-24">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${primersearch}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-auto</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fasta}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${primers}</span> 10</span>
<span id="cb31-25">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##### </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> EMBOSS ##########</span></span>
<span id="cb31-26">  </span>
<span id="cb31-27">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Find EMBOSS PrimerSearch output files with primer matches</span></span>
<span id="cb31-28">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove those without a match</span></span>
<span id="cb31-29">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">! </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--quiet</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Amplimer"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fasta_no_ext_lower}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.primersearch"</span></span>
<span id="cb31-30">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fasta_no_ext_lower}</span>.primersearch</span>
<span id="cb31-31">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb31-32"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<pre><code>real    1m8.469s
user    1m5.269s
sys 0m3.411s</code></pre>
</section>
<section id="check-primer-matches" class="level2">
<h2 class="anchored" data-anchor-id="check-primer-matches">7.3 Check primer matches</h2>
<p>This will print the contents of any remaining <code>*.primersearch</code> output files (i.e.&nbsp;sequences with primer matches)</p>
<div class="sourceCode" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb33-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb33-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb33-3"></span>
<span id="cb33-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_fasta_splits_dir}</span></span>
<span id="cb33-5"></span>
<span id="cb33-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check contents of files with matches</span></span>
<span id="cb33-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.primersearch</span>
<span id="cb33-8">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb33-9">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FILE: </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb33-10">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb33-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span></span>
<span id="cb33-12">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"----------------------------------"</span></span>
<span id="cb33-13">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb33-14"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<pre><code>FILE: nc_088857.primersearch


Primer name NM_001305360.1
Amplimer 1
    Sequence: NC_088857.1  
    
    TGGACATTCATCTCTACTGCT hits forward strand at 40310307 with 0 mismatches
    TCTCACTGTGGAAATGCACA hits reverse strand at [16964538] with 0 mismatches
    Amplimer length: 83 bp

Primer name XM_034462847.2

Primer name XM_066083499.1
Amplimer 1
    Sequence: NC_088857.1  
    
    TGAGGCACATTAAGGGTCTGA hits forward strand at 40310581 with 0 mismatches
    CAGACGAGGCTAATCACCGG hits reverse strand at [16964233] with 0 mismatches
    Amplimer length: 114 bp
----------------------------------</code></pre>
</section>
</section>
<section id="summary" class="level1">
<h1>8 SUMMARY</h1>
<p>EMBOSS PrimerSearch has identified a single amplicon on chromosome <code>NC_088857.1</code> for <code>NM_001305360.1</code> and <code>XM_066083499.1</code>, and each predicted amplicon matches the lengths generated by Primer3. However, no amplicon is predicted for <code>XM_034462847.2</code>. This could possibly be explained by what appears to be an insertion of ~10bp in this variant.</p>
<p>Anyway, I’ll get these ordered and tested out!</p>
</section>
<section id="citations" class="level1">
<h1>9 CITATIONS</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-kans2013entrez" class="csl-entry">
Kans, James. 2013. <em>Entrez Direct: E-Utilities on the Unix Command Line</em>. Bethesda (MD): National Center for Biotechnology Information (US). <a href="https://www.ncbi.nlm.nih.gov/books/NBK179288/" class="uri">https://www.ncbi.nlm.nih.gov/books/NBK179288/</a>.
</div>
<div id="ref-koressaar2007" class="csl-entry">
Koressaar, Triinu, and Maido Remm. 2007. “Enhancements and Modifications of Primer Design Program Primer3.” <em>Bioinformatics</em> 23 (10): 1289–91. <a href="https://doi.org/10.1093/bioinformatics/btm091" class="uri">https://doi.org/10.1093/bioinformatics/btm091</a>.
</div>
<div id="ref-rice2000" class="csl-entry">
Rice, Peter, Ian Longden, and Alan Bleasby. 2000. “EMBOSS: The European Molecular Biology Open Software Suite.” <em>Trends in Genetics</em> 16 (6): 276–77. <a href="https://doi.org/10.1016/s0168-9525(00)02024-2" class="uri">https://doi.org/10.1016/s0168-9525(00)02024-2</a>.
</div>
<div id="ref-shirley2015" class="csl-entry">
Shirley, Matthew D, Zhaorong Ma, Brent S Pedersen, and Sarah J Wheelan. 2015. “Efficient”Pythonic” Access to FASTA Files Using Pyfaidx.” <a href="http://dx.doi.org/10.7287/peerj.preprints.970v1" class="uri">http://dx.doi.org/10.7287/peerj.preprints.970v1</a>.
</div>
<div id="ref-untergasser2012" class="csl-entry">
Untergasser, Andreas, Ioana Cutcutache, Triinu Koressaar, Jian Ye, Brant C. Faircloth, Maido Remm, and Steven G. Rozen. 2012. “Primer3new Capabilities and Interfaces.” <em>Nucleic Acids Research</em> 40 (15): e115–15. <a href="https://doi.org/10.1093/nar/gks596" class="uri">https://doi.org/10.1093/nar/gks596</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2025</category>
  <category>Crassotrea gigas</category>
  <category>Pacific oyster</category>
  <category>Primer3</category>
  <category>EMBOSS</category>
  <category>PrimerSearch</category>
  <category>Magallana gigas</category>
  <category>primers</category>
  <category>AOX</category>
  <category>alternative oxidase</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2025/2025-01-17-Primer-Design---C.gigas-Alternative-Oxidase-AOX-Variants-Using-Primer3/</guid>
  <pubDate>Fri, 17 Jan 2025 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Data Wrangling - Reformat P.evermanni GFF to Valid GFF3 Using awk genometools and AGAT</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2025/2025-01-10-Data-Wrangling---Reformat-P.evermanni-GFF-to-Valid-GFF3-Using-awk-genometools-and-AGAT/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>This notebook is part of the coral E5 <a href="https://github.com/urol-e5/timeseries_molecular">timeseries_molecular project</a> (GitHub repo).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The contents below are from markdown knitted from <a href="https://github.com/urol-e5/timeseries_molecular/blob/99f0563a067ca9d010cb206dfd44b36d8f77de00/E-Peve/code/00.00-genome-GFF-formatting.Rmd"><code>00.00-genome-GFF-formatting.Rmd</code></a> (commit <code>99f0563</code>).</p>
</div>
</div>
<hr>
</section>
<section id="background" class="level1">
<h1>1 Background</h1>
<p>This notebook reformats the original <em>P.evermanni</em> GFF (<a href="../data/Porites_evermanni_v1.annot.gff">Porites_evermanni_v1.annot.gff</a>), which is not compliant with <a href="https://github.com/the-sequence-ontology/specifications/blob/master/gff3.md">the GFF standard</a> (GitHub page). The GFF is lacking the <code>gene</code> feature, which may (or may not) be needed/useful for downstream processing. This notebook adds a <code>gene</code> feature. Additionally, it is lacking the <code>exon</code> feature. We’ve decided to insert <code>exon</code> features which cover <code>UTR</code> and <code>CDS</code> features.</p>
<p>Finally, despite the naming convention, there aren’t any actual annotations in that GFF, beyond the feature designations (i.e.&nbsp;no gene ontology, no SwissProt IDs, gene names, etc.). This notebook does <em>not</em> address those shortcomings.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Unlike other scripts, this will output to <a href="../data">E-Peve/data</a>, instead of an output directory in <code>../output</code>.</p>
</div>
</div>
<section id="software-requirements" class="level2">
<h2 class="anchored" data-anchor-id="software-requirements">1.1 Software requirements</h2>
<p>Requires <a href="https://github.com/genometools/genometools">genometools</a> (GitHub repo) to be installed and in the system <code>$PATH</code>.</p>
<p>Requires <a href="https://github.com/NBISweden/AGAT">AGAT</a> to be installed via conda/mamba for conversion to GTF.</p>
</section>
<section id="inputs" class="level2">
<h2 class="anchored" data-anchor-id="inputs">1.2 Inputs</h2>
<ul>
<li><a href="../data/Porites_evermanni_v1.annot.gff">Porites_evermanni_v1.annot.gff</a></li>
</ul>
</section>
<section id="outputs" class="level2">
<h2 class="anchored" data-anchor-id="outputs">1.3 Outputs</h2>
<ul>
<li><a href="../data/Porites_evermanni_validated.gff3">Porites_evermanni_validated.gff3</a></li>
</ul>
</section>
</section>
<section id="create-a-bash-variables-file" class="level1">
<h1>2 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export repo_dir=~/gitrepos/urol-e5/timeseries_molecular'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export data_dir=${repo_dir}/E-Peve/data'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Input files"</span></span>
<span id="cb1-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export original_gff="Porites_evermanni_v1.annot.gff"'</span></span>
<span id="cb1-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export intermediate_gff="intermediate.gff"'</span></span>
<span id="cb1-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export validated_gff="Porites_evermanni_validated.gff3"'</span></span>
<span id="cb1-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-15"></span>
<span id="cb1-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Output files"</span></span>
<span id="cb1-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export gtf="Porites_evermanni_validated.gtf"'</span></span>
<span id="cb1-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Programs"</span></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export conda_path="/home/sam/programs/miniforge3-24.7.1-0/bin/mamba"'</span></span>
<span id="cb1-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export conda_env_name="agat_env"'</span></span>
<span id="cb1-23"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-24"></span>
<span id="cb1-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Print formatting"</span></span>
<span id="cb1-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-28"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-29"></span>
<span id="cb1-30"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export repo_dir=~/gitrepos/urol-e5/timeseries_molecular
export data_dir=${repo_dir}/E-Peve/data

# Input files
export original_gff="Porites_evermanni_v1.annot.gff"
export intermediate_gff="intermediate.gff"
export validated_gff="Porites_evermanni_validated.gff3"

# Output files
export gtf="Porites_evermanni_validated.gtf"

# Programs
export conda_path="/home/sam/programs/miniforge3-24.7.1-0/bin/mamba"
export conda_env_name="agat_env"

# Print formatting
export line="--------------------------------------------------------"</code></pre>
</section>
<section id="peak-at-original-gff" class="level1">
<h1>3 Peak at original GFF</h1>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${data_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${original_gff}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<pre><code>Porites_evermani_scaffold_1 Gmove   mRNA    3107    4488    543 -   .   ID=Peve_00000001;Name=Peve_00000001;start=0;stop=1;cds_size=543
Porites_evermani_scaffold_1 Gmove   CDS 3107    3444    .   -   .   Parent=Peve_00000001
Porites_evermani_scaffold_1 Gmove   CDS 4284    4488    .   -   .   Parent=Peve_00000001
Porites_evermani_scaffold_1 Gmove   mRNA    424479  429034  2439.63 -   .   ID=Peve_00000002;Name=Peve_00000002;start=1;stop=1;cds_size=2019
Porites_evermani_scaffold_1 Gmove   CDS 424479  425361  .   -   .   Parent=Peve_00000002
Porites_evermani_scaffold_1 Gmove   CDS 426181  426735  .   -   .   Parent=Peve_00000002
Porites_evermani_scaffold_1 Gmove   CDS 427013  427140  .   -   .   Parent=Peve_00000002
Porites_evermani_scaffold_1 Gmove   CDS 427665  427724  .   -   .   Parent=Peve_00000002
Porites_evermani_scaffold_1 Gmove   CDS 428642  429034  .   -   .   Parent=Peve_00000002
Porites_evermani_scaffold_1 Gmove   mRNA    429394  438909  1570.66 +   .   ID=Peve_00000003;Name=Peve_00000003;start=1;stop=1;cds_size=1458</code></pre>
<section id="check-features" class="level2">
<h2 class="anchored" data-anchor-id="check-features">3.1 Check features</h2>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print $3}'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${data_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${original_gff}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--unique</span></span></code></pre></div>
<pre><code>CDS
mRNA
UTR</code></pre>
</section>
</section>
<section id="fix-gff" class="level1">
<h1>4 Fix GFF</h1>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb7-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">BEGIN { OFS="\t"; mrna_count = 0; utr_count = 0; gene_count = 0; cds_count = 0; exon_count = 0 }</span></span>
<span id="cb7-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb7-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    if ($3 == "mRNA") {</span></span>
<span id="cb7-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        split($9, attributes, ";")</span></span>
<span id="cb7-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        for (i in attributes) {</span></span>
<span id="cb7-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            if (attributes[i] ~ /^ID=/) {</span></span>
<span id="cb7-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                original_id = substr(attributes[i], 4)</span></span>
<span id="cb7-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                gene_id = "ID=gene-" original_id</span></span>
<span id="cb7-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                parent_id = "Parent=gene-" original_id</span></span>
<span id="cb7-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                break</span></span>
<span id="cb7-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            }</span></span>
<span id="cb7-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        }</span></span>
<span id="cb7-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        </span></span>
<span id="cb7-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        # Increment the global mRNA counter</span></span>
<span id="cb7-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        mrna_count++</span></span>
<span id="cb7-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        </span></span>
<span id="cb7-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        new_mrna_id = "ID=mrna-" sprintf("%05d", mrna_count)</span></span>
<span id="cb7-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        </span></span>
<span id="cb7-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        # Store the mapping of original mRNA ID to new mRNA ID</span></span>
<span id="cb7-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        mrna_map[original_id] = "mrna-" sprintf("%05d", mrna_count)</span></span>
<span id="cb7-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        </span></span>
<span id="cb7-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        # Replace the old ID with the new mRNA ID</span></span>
<span id="cb7-26"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        for (i in attributes) {</span></span>
<span id="cb7-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            if (attributes[i] ~ /^ID=/) {</span></span>
<span id="cb7-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                attributes[i] = new_mrna_id</span></span>
<span id="cb7-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                break</span></span>
<span id="cb7-30"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            }</span></span>
<span id="cb7-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        }</span></span>
<span id="cb7-32"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        $9 = attributes[1]</span></span>
<span id="cb7-33"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        for (i = 2; i &lt;= length(attributes); i++) {</span></span>
<span id="cb7-34"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            $9 = $9 ";" attributes[i]</span></span>
<span id="cb7-35"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        }</span></span>
<span id="cb7-36"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        $9 = $9 ";" parent_id</span></span>
<span id="cb7-37"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        print $1, $2, "gene", $4, $5, ".", $7, $8, gene_id</span></span>
<span id="cb7-38"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        print $0  # Print the original mRNA feature</span></span>
<span id="cb7-39"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        </span></span>
<span id="cb7-40"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        # Increment the gene counter and reset the CDS counter for each new gene</span></span>
<span id="cb7-41"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        gene_count++</span></span>
<span id="cb7-42"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    } else if ($3 == "UTR" || $3 == "CDS") {</span></span>
<span id="cb7-43"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        split($9, attributes, ";")</span></span>
<span id="cb7-44"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        id_set = 0</span></span>
<span id="cb7-45"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        parent_set = 0</span></span>
<span id="cb7-46"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        for (i in attributes) {</span></span>
<span id="cb7-47"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            if (attributes[i] ~ /^ID=/) {</span></span>
<span id="cb7-48"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                id_set = 1</span></span>
<span id="cb7-49"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                if ($3 == "UTR") {</span></span>
<span id="cb7-50"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                    attributes[i] = "ID=utr-" sprintf("%05d", ++utr_count)</span></span>
<span id="cb7-51"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                } else if ($3 == "CDS") {</span></span>
<span id="cb7-52"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                    attributes[i] = "ID=cds-" sprintf("%05d", ++cds_count)</span></span>
<span id="cb7-53"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                }</span></span>
<span id="cb7-54"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            }</span></span>
<span id="cb7-55"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            if (attributes[i] ~ /^Parent=/) {</span></span>
<span id="cb7-56"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                parent_set = 1</span></span>
<span id="cb7-57"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                original_parent_id = substr(attributes[i], 8)</span></span>
<span id="cb7-58"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                if (original_parent_id in mrna_map) {</span></span>
<span id="cb7-59"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                    attributes[i] = "Parent=" mrna_map[original_parent_id]</span></span>
<span id="cb7-60"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                }</span></span>
<span id="cb7-61"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            }</span></span>
<span id="cb7-62"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        }</span></span>
<span id="cb7-63"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        if (id_set == 0) {</span></span>
<span id="cb7-64"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            if ($3 == "UTR") {</span></span>
<span id="cb7-65"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                attributes[1] = "ID=utr-" sprintf("%05d", ++utr_count) ";" attributes[1]</span></span>
<span id="cb7-66"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            } else if ($3 == "CDS") {</span></span>
<span id="cb7-67"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                attributes[1] = "ID=cds-" sprintf("%05d", ++cds_count) ";" attributes[1]</span></span>
<span id="cb7-68"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            }</span></span>
<span id="cb7-69"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        }</span></span>
<span id="cb7-70"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        if (parent_set == 0) {</span></span>
<span id="cb7-71"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            attributes[length(attributes) + 1] = "Parent=" mrna_map[original_id]</span></span>
<span id="cb7-72"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        }</span></span>
<span id="cb7-73"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        $9 = attributes[1]</span></span>
<span id="cb7-74"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        for (i = 2; i &lt;= length(attributes); i++) {</span></span>
<span id="cb7-75"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            $9 = $9 ";" attributes[i]</span></span>
<span id="cb7-76"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        }</span></span>
<span id="cb7-77"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        print $1, $2, $3, $4, $5, $6, $7, $8, $9  # Print the original UTR or CDS feature</span></span>
<span id="cb7-78"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        </span></span>
<span id="cb7-79"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        # Add exon feature</span></span>
<span id="cb7-80"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        exon_count++</span></span>
<span id="cb7-81"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        new_exon_id = "ID=exon-" sprintf("%06d", exon_count)</span></span>
<span id="cb7-82"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        exon_attributes = new_exon_id</span></span>
<span id="cb7-83"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        for (i = 1; i &lt;= length(attributes); i++) {</span></span>
<span id="cb7-84"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            if (attributes[i] !~ /^ID=/) {</span></span>
<span id="cb7-85"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                exon_attributes = exon_attributes ";" attributes[i]</span></span>
<span id="cb7-86"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            }</span></span>
<span id="cb7-87"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        }</span></span>
<span id="cb7-88"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        # Ensure Parent attribute is included in exon attributes</span></span>
<span id="cb7-89"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        if (parent_set == 1) {</span></span>
<span id="cb7-90"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            exon_attributes = exon_attributes ";Parent=" mrna_map[original_parent_id]</span></span>
<span id="cb7-91"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        }</span></span>
<span id="cb7-92"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        print $1, $2, "exon", $4, $5, $6, $7, $8, exon_attributes</span></span>
<span id="cb7-93"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    }</span></span>
<span id="cb7-94"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-95"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${data_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${original_gff}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${data_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${intermediate_gff}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<section id="inspect-intermediate-gff" class="level2">
<h2 class="anchored" data-anchor-id="inspect-intermediate-gff">4.1 Inspect intermediate GFF</h2>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb8-2"></span>
<span id="cb8-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${data_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${intermediate_gff}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<pre><code>Porites_evermani_scaffold_1 Gmove   gene    3107    4488    .   -   .   ID=gene-Peve_00000001
Porites_evermani_scaffold_1 Gmove   mRNA    3107    4488    543 -   .   ID=mrna-00001;Name=Peve_00000001;start=0;stop=1;cds_size=543;Parent=gene-Peve_00000001
Porites_evermani_scaffold_1 Gmove   CDS 3107    3444    .   -   .   ID=cds-00001;Parent=mrna-00001
Porites_evermani_scaffold_1 Gmove   exon    3107    3444    .   -   .   ID=exon-000001;Parent=mrna-00001
Porites_evermani_scaffold_1 Gmove   CDS 4284    4488    .   -   .   ID=cds-00002;Parent=mrna-00001
Porites_evermani_scaffold_1 Gmove   exon    4284    4488    .   -   .   ID=exon-000002;Parent=mrna-00001
Porites_evermani_scaffold_1 Gmove   gene    424479  429034  .   -   .   ID=gene-Peve_00000002
Porites_evermani_scaffold_1 Gmove   mRNA    424479  429034  2439.63 -   .   ID=mrna-00002;Name=Peve_00000002;start=1;stop=1;cds_size=2019;Parent=gene-Peve_00000002
Porites_evermani_scaffold_1 Gmove   CDS 424479  425361  .   -   .   ID=cds-00003;Parent=mrna-00002
Porites_evermani_scaffold_1 Gmove   exon    424479  425361  .   -   .   ID=exon-000003;Parent=mrna-00002</code></pre>
</section>
</section>
<section id="validate-gff" class="level1">
<h1>5 Validate GFF</h1>
<p>Validate GFF using genometools <code>gff3</code>.</p>
<ul>
<li><p><code>-tidy</code>: Attempts to clean/fix any potential issues.</p></li>
<li><p><code>-checkids</code>: Checks IDs.</p></li>
<li><p><code>-retainids</code>: Retains IDs from input GFF instead of assigning new ones.</p></li>
</ul>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb10-2"></span>
<span id="cb10-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">gt</span> gff3 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-4">-tidy <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-5">-checkids <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-6">-retainids <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-7">-sort <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${data_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${intermediate_gff}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-9"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${data_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${validated_gff}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-10">2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${data_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/gt_gff3_validation_errors.log</span></code></pre></div>
<section id="check-for-errors-in-validation" class="level2">
<h2 class="anchored" data-anchor-id="check-for-errors-in-validation">5.1 Check for error(s) in validation</h2>
<p>Process would stop if error occurred, so only need to check end of file.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Warnings are expected, as they generally indicated modifications to the GFF to bring it into compliance.</p>
</div>
</div>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb11-2"></span>
<span id="cb11-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tail</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${data_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/gt_gff3_validation_errors.log</span></code></pre></div>
<pre><code>warning: CDS feature on line 81189 in file "/home/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/intermediate.gff" has the wrong phase . -&gt; correcting it to 0
warning: CDS feature on line 81191 in file "/home/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/intermediate.gff" has the wrong phase . -&gt; correcting it to 2
warning: CDS feature on line 81193 in file "/home/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/intermediate.gff" has the wrong phase . -&gt; correcting it to 2
warning: CDS feature on line 81197 in file "/home/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/intermediate.gff" has the wrong phase . -&gt; correcting it to 0
warning: CDS feature on line 81199 in file "/home/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/intermediate.gff" has the wrong phase . -&gt; correcting it to 0
warning: CDS feature on line 81203 in file "/home/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/intermediate.gff" has the wrong phase . -&gt; correcting it to 0
warning: CDS feature on line 81205 in file "/home/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/intermediate.gff" has the wrong phase . -&gt; correcting it to 0
warning: CDS feature on line 81207 in file "/home/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/intermediate.gff" has the wrong phase . -&gt; correcting it to 2
warning: CDS feature on line 81209 in file "/home/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/intermediate.gff" has the wrong phase . -&gt; correcting it to 0
warning: CDS feature on line 81211 in file "/home/sam/gitrepos/urol-e5/timeseries_molecular/E-Peve/data/intermediate.gff" has the wrong phase . -&gt; correcting it to 0</code></pre>
</section>
<section id="inspect-validated-gff" class="level2">
<h2 class="anchored" data-anchor-id="inspect-validated-gff">5.2 Inspect Validated GFF</h2>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb13-2"></span>
<span id="cb13-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${data_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${validated_gff}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<pre><code>##gff-version 3
##sequence-region   Porites_evermani_scaffold_1 3107 1802489
##sequence-region   Porites_evermani_scaffold_10 16486 1155879
##sequence-region   Porites_evermani_scaffold_100 2448 527357
##sequence-region   Porites_evermani_scaffold_1000 5675 163688
##sequence-region   Porites_evermani_scaffold_1001 5840 151448
##sequence-region   Porites_evermani_scaffold_1002 3372 125467
##sequence-region   Porites_evermani_scaffold_1003 139 162450
##sequence-region   Porites_evermani_scaffold_1004 10061 159112
##sequence-region   Porites_evermani_scaffold_1005 28090 152503</code></pre>
</section>
</section>
<section id="remove-intermediate-gff" class="level1">
<h1>6 Remove intermediate GFF</h1>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb15-2"></span>
<span id="cb15-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${data_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${intermediate_gff}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</section>
<section id="convert-to-gtf" class="level1">
<h1>7 Convert to GTF</h1>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb16-2"></span>
<span id="cb16-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sends progress to /dev/null to avoid crashing Rmd notebook</span></span>
<span id="cb16-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${conda_path}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> run <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${conda_env_name}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-5">agat_convert_sp_gff2gtf.pl <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-6">--gff <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${data_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${validated_gff}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-7">--output <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${data_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${gtf}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-8">1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${data_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/agat.log <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-9">2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> /dev/null</span></code></pre></div>
<section id="check-agat-gtf-log" class="level2">
<h2 class="anchored" data-anchor-id="check-agat-gtf-log">7.1 Check AGAT GTF Log</h2>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb17-2"></span>
<span id="cb17-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${data_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/agat.log</span></code></pre></div>
<pre><code>converting to GTF3
********************************************************************************
*                              - Start parsing -                               *
********************************************************************************
-------------------------- parse options and metadata --------------------------
=&gt; Accessing the feature level json files
    Using standard /home/sam/programs/miniforge3-24.7.1-0/envs/agat_env/lib/site_perl/5.26.2/auto/share/dist/AGAT/features_level1.json file
    Using standard /home/sam/programs/miniforge3-24.7.1-0/envs/agat_env/lib/site_perl/5.26.2/auto/share/dist/AGAT/features_level2.json file
    Using standard /home/sam/programs/miniforge3-24.7.1-0/envs/agat_env/lib/site_perl/5.26.2/auto/share/dist/AGAT/features_level3.json file
    Using standard /home/sam/programs/miniforge3-24.7.1-0/envs/agat_env/lib/site_perl/5.26.2/auto/share/dist/AGAT/features_spread.json file
=&gt; Attribute used to group features when no Parent/ID relationship exists:
    * locus_tag
    * gene_id
=&gt; merge_loci option deactivated
=&gt; Accessing Ontology
    No ontology accessible from the gff file header!
    We use the SOFA ontology distributed with AGAT:
        /home/sam/programs/miniforge3-24.7.1-0/envs/agat_env/lib/site_perl/5.26.2/auto/share/dist/AGAT/so.obo
    Read ontology /home/sam/programs/miniforge3-24.7.1-0/envs/agat_env/lib/site_perl/5.26.2/auto/share/dist/AGAT/so.obo:
        4 root terms, and 2472 total terms, and 1436 leaf terms
    Filtering ontology:
        We found 1757 terms that are sequence_feature or is_a child of it.
-------------------------------- parse features --------------------------------
=&gt; GFF parser version used: 3

********************************************************************************
*                               - End parsing -                                *
*                             done in 113 seconds                              *
********************************************************************************

********************************************************************************
*                               - Start checks -                               *
********************************************************************************
---------------------------- Check1: feature types -----------------------------
----------------------------------- ontology -----------------------------------
All feature types in agreement with the Ontology.
------------------------------------- agat -------------------------------------
AGAT can deal with all the encountered feature types (3rd column)
------------------------------ done in 0 seconds -------------------------------

------------------------------ Check2: duplicates ------------------------------
None found
------------------------------ done in 0 seconds -------------------------------

-------------------------- Check3: sequential bucket ---------------------------
Nothing to check as sequential bucket!
------------------------------ done in 0 seconds -------------------------------

--------------------------- Check4: l2 linked to l3 ----------------------------
No problem found
------------------------------ done in 0 seconds -------------------------------

--------------------------- Check5: l1 linked to l2 ----------------------------
No problem found
------------------------------ done in 0 seconds -------------------------------

--------------------------- Check6: remove orphan l1 ---------------------------
We remove only those not supposed to be orphan
None found
------------------------------ done in 1 seconds -------------------------------

------------------------------ Check7: check cds -------------------------------
No problem found
------------------------------ done in 0 seconds -------------------------------

----------------------------- Check8: check exons ------------------------------
No exons created
No exons locations modified
10475 exons removed that were supernumerary
No level2 locations modified
------------------------------ done in 13 seconds ------------------------------

------------------------------ Check9: check utrs ------------------------------
No UTRs created
No UTRs locations modified
No supernumerary UTRs removed
------------------------------ done in 7 seconds -------------------------------

------------------------ Check10: all level2 locations -------------------------
No problem found
------------------------------ done in 6 seconds -------------------------------

------------------------ Check11: all level1 locations -------------------------
No problem found
------------------------------ done in 1 seconds -------------------------------

---------------------- Check12: remove identical isoforms ----------------------
None found
------------------------------ done in 0 seconds -------------------------------
********************************************************************************
*                                - End checks -                                *
*                              done in 28 seconds                              *
********************************************************************************

=&gt; OmniscientI total time: 141 seconds
Bye Bye</code></pre>
</section>
<section id="inspect-gtf" class="level2">
<h2 class="anchored" data-anchor-id="inspect-gtf">7.2 Inspect GTF</h2>
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb19-2"></span>
<span id="cb19-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${data_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${gtf}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<pre><code>##gtf-version 3
##sequence-region   Porites_evermani_scaffold_1 3107 1802489
##sequence-region   Porites_evermani_scaffold_10 16486 1155879
##sequence-region   Porites_evermani_scaffold_100 2448 527357
##sequence-region   Porites_evermani_scaffold_1000 5675 163688
##sequence-region   Porites_evermani_scaffold_1001 5840 151448
##sequence-region   Porites_evermani_scaffold_1002 3372 125467
##sequence-region   Porites_evermani_scaffold_1003 139 162450
##sequence-region   Porites_evermani_scaffold_1004 10061 159112
##sequence-region   Porites_evermani_scaffold_1005 28090 152503</code></pre>


</section>
</section>

 ]]></description>
  <category>2025</category>
  <category>GFF</category>
  <category>genometools</category>
  <category>E5</category>
  <category>timeseries_molecular</category>
  <category>Porites evermanni</category>
  <category>coral</category>
  <category>AGAT</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2025/2025-01-10-Data-Wrangling---Reformat-P.evermanni-GFF-to-Valid-GFF3-Using-awk-genometools-and-AGAT/</guid>
  <pubDate>Fri, 10 Jan 2025 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Bismark Alignments - A.pulchra Trimmed Reads Using Bismark on Hyak</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2025/2025-01-02-Bismark-Alignments---A.pulchra-Trimmed-Reads-Using-Bismark-on-Hyak/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>This notebook is part of the coral E5 <a href="https://github.com/urol-e5/timeseries_molecular">timeseries_molecular project</a> (GitHub repo). Due to the desire to have some preliminary data to use for a presentation, <a href="https://github.com/RobertsLab/resources/issues/2063#issue-2764616293">Steven wanted the alignment of <em>A.pulchra</em> UNTRIMMED reads</a>(GitHub Issue). However, when initially getting code setup/tweaked, I initiated <a href="../../../posts/2025/2025-01-02-Trimming---A.pulchra-WGBS-with-fastp-FastQC-and-MultiQC-on-Raven/index.html">trimming in the meantime on</a>, so just ended up using the <em>trimmed</em> reads. To aid with speed, performed alignments using Bismark on the Hyak computing cluster running an array of nodes on the <code>coenv</code> cluster. This is technically frowned upon, but seeing as this was during a holiday week, it seemed like there was no other activity, so I just went for it!</p>
</section>
<section id="methods" class="level1">
<h1>METHODS</h1>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>When launching the SLURM job, you can initiate the array to automatically calculate the appropriate number of nodes by using Bash calculations.</p>
<p>The file <code>fastq_pairs.txt</code> has to exist before execution!</p>
<p>Here’s how the array jobs were launched:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sbatch</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> ../output/01.20-D-Apul-WGBS-trimming-fastp-FastQC-MultiQC/fastq_pairs.txt<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> 02.20-D-Apul-WGBS-alignment-SLURM-job.sh</span></code></pre></div>
</div>
</div>
<p>This approach required two scripts:</p>
<ul>
<li><p>Job script</p>
<ul>
<li><p><a href="https://github.com/urol-e5/timeseries_molecular/blob/04746494c0dad822c683367ec264a7f86875695d/D-Apul/code/02.20-D-Apul-WGBS-alignment-SLURM_array-bismark.sh">02.20-D-Apul-WGBS-alignment-SLURM_array-bismark.sh</a> (GitHub repo; commit <code>0474649</code>)</p>
<ul>
<li>This script is executed by each node so that each node operates on unique FastQ pairs.</li>
</ul></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This script is designed to be called by a SLURM script which</span></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># runs this script across an array of HPC nodes.</span></span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### IMPORTANT </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">###</span></span>
<span id="cb2-7"></span>
<span id="cb2-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># INPUT FILES</span></span>
<span id="cb2-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">repo_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/sam/gitrepos/urol-e5/timeseries_molecular"</span></span>
<span id="cb2-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trimmed_fastqs_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${repo_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/D-Apul/output/01.20-D-Apul-WGBS-trimming-fastp-FastQC-MultiQC"</span></span>
<span id="cb2-11"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bisulfite_genome_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${repo_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/D-Apul/data"</span></span>
<span id="cb2-12"></span>
<span id="cb2-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># OUTPUT FILES</span></span>
<span id="cb2-14"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_dir_top</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${repo_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/D-Apul/output/02.20-D-Apul-WGBS-alignment-SLURM_array-bismark"</span></span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># PARAMETERS</span></span>
<span id="cb2-17"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bowtie2_min_score</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L,0,-0.6"</span></span>
<span id="cb2-18"></span>
<span id="cb2-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># CPU threads</span></span>
<span id="cb2-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Bismark already spawns multiple instances and additional threads are multiplicative."</span></span>
<span id="cb2-21"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bismark_threads</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>5</span>
<span id="cb2-22"></span>
<span id="cb2-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################</span></span>
<span id="cb2-24"></span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## SET ARRAY TASKS ##</span></span>
<span id="cb2-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb2-28"></span>
<span id="cb2-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the FastQ file pair for this task</span></span>
<span id="cb2-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># the `p` sets the line number to process</span></span>
<span id="cb2-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># which corresponds to the array task ID</span></span>
<span id="cb2-32"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pair</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SLURM_ARRAY_TASK_ID}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">p"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/fastq_pairs.txt"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb2-33"></span>
<span id="cb2-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Contents of pair:"</span></span>
<span id="cb2-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${pair}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb2-36"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb2-37"></span>
<span id="cb2-38"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R1_file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$pair</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print $1}'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb2-39"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R2_file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$pair</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print $2}'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb2-40"></span>
<span id="cb2-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get just the sample name (excludes the _R[12]_001*)</span></span>
<span id="cb2-42"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$R1_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print $1}'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb2-43"></span>
<span id="cb2-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if R1_file and R2_file are not empty</span></span>
<span id="cb2-45"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-z</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$R1_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-z</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$R2_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb2-46">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Error: R1_file or R2_file is empty. Exiting."</span></span>
<span id="cb2-47">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">exit</span> 1</span>
<span id="cb2-48"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb2-49"></span>
<span id="cb2-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if sample_name is not empty</span></span>
<span id="cb2-51"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-z</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_name</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb2-52">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Error: sample_name is empty. Exiting."</span></span>
<span id="cb2-53">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">exit</span> 1</span>
<span id="cb2-54"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb2-55"></span>
<span id="cb2-56"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Contents of sample_name: </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb2-57"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb2-58"></span>
<span id="cb2-59"></span>
<span id="cb2-60"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## RUN BISMARK ALIGNMENTS ##</span></span>
<span id="cb2-61"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bismark</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-62">--genome <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bisulfite_genome_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-63">--score_min <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bowtie2_min_score}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-64">--parallel <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bismark_threads}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-65">--non_directional <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-66">--gzip <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-67">-p <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bismark_threads}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-68">-1 <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_file}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-69">-2 <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_file}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-70">--output_dir <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-71">2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span>-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SLURM_ARRAY_TASK_ID}</span>-bismark_summary.txt</span></code></pre></div>
<ul>
<li><p>SLURM script:</p>
<ul>
<li><p><a href="https://github.com/urol-e5/timeseries_molecular/blob/9d9b9b462074d5dae839a6b22447a0199ddc5b99/D-Apul/code/02.20-D-Apul-WGBS-alignment-SLURM-job.sh">02.20-D-Apul-WGBS-alignment-SLURM-job.sh</a> (GitHub repo; commit <code>9d9b9b4</code>)</p>
<ul>
<li>This is the SLURM script which controls the SLURM job parameters.</li>
</ul></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --job-name=bismark_job_array</span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --account=coenv</span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --partition=cpu-g2</span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --output=bismark_job_%A_%a.out</span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --error=bismark_job_%A_%a.err</span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --ntasks=1</span></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --cpus-per-task=20</span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mem=100G</span></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --time=72:00:00</span></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##turn on e-mail notification</span></span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-type=ALL</span></span>
<span id="cb3-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-user=samwhite@uw.edu</span></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Specify the working directory for this job</span></span>
<span id="cb3-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --chdir=/gscratch/srlab/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/output/02.20-D-Apul-WGBS-alignment-SLURM_array-bismark/</span></span>
<span id="cb3-16"></span>
<span id="cb3-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Execute Roberts Lab bioinformatics container</span></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Binds home directory</span></span>
<span id="cb3-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Binds /gscratch directory</span></span>
<span id="cb3-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Directory bindings allow outputs to be written to the hard drive.</span></span>
<span id="cb3-21"></span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Executes Bismark alignment using 02.01-bismark-bowtie2-alignment-SLURM-array.sh script.</span></span>
<span id="cb3-23"></span>
<span id="cb3-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># To execute this SLURM script as an array, start the script with the following command:</span></span>
<span id="cb3-25"></span>
<span id="cb3-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sbatch --array=1-$(wc -l &lt; ../output/01.20-D-Apul-WGBS-trimming-fastp-FastQC-MultiQC/fastq_pairs.txt) 02.20-D-Apul-WGBS-alignment-SLURM-job.sh</span></span>
<span id="cb3-27"></span>
<span id="cb3-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># IMPORTANT: Requires fastq_pairs.txt to exist prior to submission!</span></span>
<span id="cb3-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apptainer</span> exec <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-30">--home <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$PWD</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-31">--bind /mmfs1/home/ <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-32">--bind /gscratch <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-33">/gscratch/srlab/sr320/srlab-bioinformatics-container-586bf21.sif <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-34">/gscratch/srlab/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/code/02.20-D-Apul-WGBS-alignment-SLURM_array-bismark.sh</span></code></pre></div>


</section>

 ]]></description>
  <category>2025</category>
  <category>Bismark</category>
  <category>Acropora pulchra</category>
  <category>coral</category>
  <category>timeseries_molecular</category>
  <category>E5</category>
  <category>klone</category>
  <category>hyak</category>
  <category>alignment</category>
  <category>WGBS</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2025/2025-01-02-Bismark-Alignments---A.pulchra-Trimmed-Reads-Using-Bismark-on-Hyak/</guid>
  <pubDate>Thu, 02 Jan 2025 08:00:00 GMT</pubDate>
  <media:content url="https://robertslab.github.io/sams-notebook/posts/2025/2025-01-02-Bismark-Alignments---A.pulchra-Trimmed-Reads-Using-Bismark-on-Hyak/20250102-apul-bismark-alignments-klone-array-01.png" medium="image" type="image/png" height="84" width="144"/>
</item>
<item>
  <title>Trimming - A.pulchra WGBS with fastp FastQC and MultiQC on Raven</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2025/2025-01-02-Trimming---A.pulchra-WGBS-with-fastp-FastQC-and-MultiQC-on-Raven/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>This notebook is part of the coral E5 <a href="https://github.com/urol-e5/timeseries_molecular">timeseries_molecular project</a> (GitHub repo). Whole genome bisulfite sequencing (WGBS) data was <a href="../../../posts/2024/2024-12-30-Data-Received---Coral-E5-WGBS-Time-Series-from-Azenta-Project-30-1067895835/index.html">received on 20241230</a> (Notebook entry) and then <a href="../../../posts/2024/2024-12-31-FastQC-MultiQC---A.pulchra-WGBS-E5-Timeseries/index.html">QC’d on 20241231</a>. Based on initial QC, I decided to trim 25bp from the 5’ end of each read. Trimming was done with <a href="https://github.com/OpenGene/fastp"><code>fastp</code></a>, followed by <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/"><code>FastQC</code></a> and <a href="https://multiqc.info/"><code>MultiQC</code></a>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The contents below are from markdown knitted from <a href="https://github.com/urol-e5/timeseries_molecular/blob/05ca78c9c1b6fbbbfba709ea1911cd69b9324f69/D-Apul/code/01.20-D-Apul-WGBS-trimming-fastp-FastQC-MultiQC.Rmd"><code>01.20-D-Apul-WGBS-trimming-fastp-FastQC-MultiQC.Rmd</code></a> (commit <code>05ca78c</code>).</p>
</div>
</div>
</section>
<section id="background" class="level1">
<h1>1 Background</h1>
<p>This notebook will trim raw WGBS FastQs using <a href="https://github.com/OpenGene/fastp">fastp</a>. Samples which generate an error during trimming will attempt to be repaired using <a href="https://jgi.doe.gov/data-and-tools/software-tools/bbtools/">BBTools <code>repairl.sh</code></a> (BBMap – Bushnell B. – sourceforge.net/projects/bbmap/). Trimming results will be analyzed with FastQC and summarized by <a href="https://github.com/MultiQC/MultiQC">MultiQC</a> (Ewels et al.&nbsp;2016).</p>
<p>Based off of the initial FastQC/MultiQC, we trimmed 25bp from each read.</p>
<section id="inputs" class="level2">
<h2 class="anchored" data-anchor-id="inputs">1.1 Inputs</h2>
<p>Raw WGBS FastQ files with the following pattern:</p>
<ul>
<li><code>*.fastq.gz</code></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If one needs to download the raw FastQs, please see <a href="./00.20-D-Apul-WGBS-reads-FastQC-MultiQC.Rmd">00.20-D-Apul-WGBS-reads-FastQC-MultiQC.Rmd</a></p>
</div>
</div>
</section>
<section id="outputs" class="level2">
<h2 class="anchored" data-anchor-id="outputs">1.2 Outputs</h2>
<p>The expected outputs will be:</p>
<ul>
<li><p><code>*_fastqc.html</code>: Individual FastQC reports.</p></li>
<li><p><code>*fastp-trim*.fq.gz</code>: Trimmed FastQ files.</p></li>
<li><p><code>*.md5</code>: Individual MD5 checksums for trimmed FastQs.</p></li>
<li><p><code>*.fastp-trim.report.html</code>: Individual fastp trimming reports. HTML format.</p></li>
<li><p><code>*.fastp-trim.report.json</code>: Individual fastp trimming reports. JSON format.</p></li>
<li><p><code>multiqc_report.html</code>: A summary report of the alignment results generated by <a href="https://github.com/MultiQC/MultiQC">MultiQC</a>, in HTML format.</p>
<ul>
<li><p>Due to the large file sizes of FastQs, these cannot be hosted in the <a href="https://github.com/urol-e5/timeseries_molecular/tree/main">timeseries_molecular GitHub repo</a>. As such these files are available for download here:</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/D-Apul/output/01.20-D-Apul-WGBS-trimming-fastp-FastQC-MultiQC/" class="uri">https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/D-Apul/output/01.20-D-Apul-WGBS-trimming-fastp-FastQC-MultiQC/</a></li>
</ul></li>
</ul></li>
</ul>
</section>
</section>
<section id="create-a-bash-variables-file" class="level1">
<h1>2 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export repo_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export output_dir_top=${repo_dir}/D-Apul/output/01.20-D-Apul-WGBS-trimming-fastp-FastQC-MultiQC'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_dir="${repo_dir}/D-Apul/data/wgbs-raw-fastqs"'</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export trimmed_fastqs_dir="${output_dir_top}/trimmed-fastqs"'</span></span>
<span id="cb1-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Paths to programs"</span></span>
<span id="cb1-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export programs_dir="/home/shared"'</span></span>
<span id="cb1-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export bbmap_repair="${programs_dir}/bbmap-39.12/repair.sh"'</span></span>
<span id="cb1-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export bismark_dir="${programs_dir}/Bismark-0.24.0"'</span></span>
<span id="cb1-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export bowtie2_dir="${programs_dir}/bowtie2-2.4.4-linux-x86_64"'</span></span>
<span id="cb1-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastp="${programs_dir}/fastp-v0.24.0/fastp"'</span></span>
<span id="cb1-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastqc="${programs_dir}/FastQC-0.12.1/fastqc"'</span></span>
<span id="cb1-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export multiqc="/home/sam/programs/mambaforge/bin/multiqc"'</span></span>
<span id="cb1-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export samtools_dir="${programs_dir}/samtools-1.12"'</span></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-22"></span>
<span id="cb1-23"></span>
<span id="cb1-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set FastQ filename patterns"</span></span>
<span id="cb1-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export fastq_pattern='*.fastq.gz'"</span></span>
<span id="cb1-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R1_fastq_pattern='*_R1_*.fastq.gz'"</span></span>
<span id="cb1-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R2_fastq_pattern='*_R2_*.fastq.gz'"</span></span>
<span id="cb1-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export trimmed_fastq_pattern='*fastp-trim*.fq.gz'"</span></span>
<span id="cb1-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-30"></span>
<span id="cb1-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set number of CPUs to use"</span></span>
<span id="cb1-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=40'</span></span>
<span id="cb1-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-34"></span>
<span id="cb1-35"></span>
<span id="cb1-36"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"## Inititalize arrays"</span></span>
<span id="cb1-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R1=()'</span></span>
<span id="cb1-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R2=()'</span></span>
<span id="cb1-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export trimmed_fastqs_array=()'</span></span>
<span id="cb1-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R1_names_array=()'</span></span>
<span id="cb1-41"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R2_names_array=()'</span></span>
<span id="cb1-42"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-43"></span>
<span id="cb1-44"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Print formatting"</span></span>
<span id="cb1-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-46"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-47"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-48"></span>
<span id="cb1-49"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export repo_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular
export output_dir_top=${repo_dir}/D-Apul/output/01.20-D-Apul-WGBS-trimming-fastp-FastQC-MultiQC
export raw_reads_dir="${repo_dir}/D-Apul/data/wgbs-raw-fastqs"
export trimmed_fastqs_dir="${output_dir_top}/trimmed-fastqs"

# Paths to programs
export programs_dir="/home/shared"
export bbmap_repair="${programs_dir}/bbmap-39.12/repair.sh"
export bismark_dir="${programs_dir}/Bismark-0.24.0"
export bowtie2_dir="${programs_dir}/bowtie2-2.4.4-linux-x86_64"
export fastp="${programs_dir}/fastp-v0.24.0/fastp"
export fastqc="${programs_dir}/FastQC-0.12.1/fastqc"
export multiqc="/home/sam/programs/mambaforge/bin/multiqc"
export samtools_dir="${programs_dir}/samtools-1.12"

# Set FastQ filename patterns
export fastq_pattern='*.fastq.gz'
export R1_fastq_pattern='*_R1_*.fastq.gz'
export R2_fastq_pattern='*_R2_*.fastq.gz'
export trimmed_fastq_pattern='*fastp-trim*.fq.gz'

# Set number of CPUs to use
export threads=40

## Inititalize arrays
export fastq_array_R1=()
export fastq_array_R2=()
export trimmed_fastqs_array=()
export R1_names_array=()
export R2_names_array=()

# Print formatting
export line="--------------------------------------------------------"</code></pre>
</section>
<section id="trimming-and-error-repair" class="level1">
<h1>3 Trimming and Error Repair</h1>
<p>Trimming will remove any Illumina sequencing adapters, as well as polyG and polyX (primarily polyA) sequences. Trimming will also remove the first 25bp from the 5’ end of each read.</p>
<p>Samples generating an error during trimming will attempt to be repaired with BBTools’ <code>repair.sh</code> script.</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directory, if it doesn't exist</span></span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span></span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-8"></span>
<span id="cb3-9"></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create arrays of fastq R1 files and sample names</span></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Do NOT quote R1_fastq_pattern variable</span></span>
<span id="cb3-12"></span>
<span id="cb3-13"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_fastq_pattern}</span></span>
<span id="cb3-14"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb3-15">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-16"></span>
<span id="cb3-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use parameter substitution to remove all text up to and including last "." from</span></span>
<span id="cb3-18">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># right side of string.</span></span>
<span id="cb3-19">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R1_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>.<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-20"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb3-21"></span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of fastq R2 files</span></span>
<span id="cb3-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Do NOT quote R2_fastq_pattern variable</span></span>
<span id="cb3-24"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_fastq_pattern}</span></span>
<span id="cb3-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb3-26">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-27"></span>
<span id="cb3-28">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use parameter substitution to remove all text up to and including last "." from</span></span>
<span id="cb3-29">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># right side of string.</span></span>
<span id="cb3-30">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R2_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(${fastq</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>.<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">})</span></span>
<span id="cb3-31"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb3-32"></span>
<span id="cb3-33"></span>
<span id="cb3-34"></span>
<span id="cb3-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run fastp on files</span></span>
<span id="cb3-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adds JSON report output for downstream usage by MultiQC</span></span>
<span id="cb3-37"></span>
<span id="cb3-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning fastp trimming."</span></span>
<span id="cb3-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-40"></span>
<span id="cb3-41"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> index <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-42"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb3-43">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R1_sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-44">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R2_sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-45">  </span>
<span id="cb3-46">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">stderr_PE_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print $1}'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-47">  </span>
<span id="cb3-48">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastp}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-49">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--in1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-50">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--in2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-51">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--detect_adapter_for_pe</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-52">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_poly_g</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-53">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_poly_x</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-54">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--thread</span> 16 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-55">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_front1</span> 25 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-56">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_front2</span> 25 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-57">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--html</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.report.html <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-58">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--json</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.report.json <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-59">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--out1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-60">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--out2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-61">  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_PE_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.stderr</span>
<span id="cb3-62">  </span>
<span id="cb3-63">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--before-context</span> 5 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERROR"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_PE_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.stderr</span>
<span id="cb3-64">  </span>
<span id="cb3-65">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check for fastp errors and then repair</span></span>
<span id="cb3-66">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--quiet</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERROR"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_PE_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.stderr<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb3-67">      </span>
<span id="cb3-68">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz</span>
<span id="cb3-69">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz</span>
<span id="cb3-70">    </span>
<span id="cb3-71">    </span>
<span id="cb3-72">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bbmap_repair}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-73">    in1=<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-74">    in2=<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-75">    out1=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.REPAIRED.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-76">    out2=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.REPAIRED.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-77">    outs=/dev/null <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-78">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.REPAIRED.stderr</span>
<span id="cb3-79">    </span>
<span id="cb3-80">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastp}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--in1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.REPAIRED.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--in2</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.REPAIRED.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--detect_adapter_for_pe</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_poly_g</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_poly_x</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--thread</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_front1</span> 25 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-88">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_front2</span> 25 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-89">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--html</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.REPAIRED.report.html <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-90">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--json</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.REPAIRED.report.json <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--out1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.REPAIRED.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--out2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.REPAIRED.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-93">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_PE_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.REPAIRED.stderr</span>
<span id="cb3-94"> </span>
<span id="cb3-95">    </span>
<span id="cb3-96">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--quiet</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERROR"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_PE_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.REPAIRED.stderr<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb3-97">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"These </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_PE_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> samples are broken."</span></span>
<span id="cb3-98">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Just give up.  :("</span></span>
<span id="cb3-99">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-100">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb3-101">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb3-102"></span>
<span id="cb3-103">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Finished trimming:"</span></span>
<span id="cb3-104">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-105">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-106">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-107">  </span>
<span id="cb3-108">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate md5 checksums for newly trimmed files</span></span>
<span id="cb3-109">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-110">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz.md5</span>
<span id="cb3-111">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz.md5</span>
<span id="cb3-112">  </span>
<span id="cb3-113">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-114"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<pre><code>Beginning fastp trimming.

Finished trimming:
ACR-139-TP1_R1_001.fastq.gz
ACR-139-TP1_R1_001.fastq.gz

Finished trimming:
ACR-139-TP2_R1_001.fastq.gz
ACR-139-TP2_R1_001.fastq.gz

Finished trimming:
ACR-139-TP3_R1_001.fastq.gz
ACR-139-TP3_R1_001.fastq.gz

Finished trimming:
ACR-139-TP4_R1_001.fastq.gz
ACR-139-TP4_R1_001.fastq.gz

Finished trimming:
ACR-145-TP1_R1_001.fastq.gz
ACR-145-TP1_R1_001.fastq.gz

Finished trimming:
ACR-145-TP2_R1_001.fastq.gz
ACR-145-TP2_R1_001.fastq.gz

Finished trimming:
ACR-145-TP3_R1_001.fastq.gz
ACR-145-TP3_R1_001.fastq.gz

Finished trimming:
ACR-145-TP4_R1_001.fastq.gz
ACR-145-TP4_R1_001.fastq.gz

Finished trimming:
ACR-150-TP1_R1_001.fastq.gz
ACR-150-TP1_R1_001.fastq.gz

Finished trimming:
ACR-150-TP2_R1_001.fastq.gz
ACR-150-TP2_R1_001.fastq.gz

Finished trimming:
ACR-150-TP3_R1_001.fastq.gz
ACR-150-TP3_R1_001.fastq.gz

Finished trimming:
ACR-150-TP4_R1_001.fastq.gz
ACR-150-TP4_R1_001.fastq.gz

Finished trimming:
ACR-173-TP1_R1_001.fastq.gz
ACR-173-TP1_R1_001.fastq.gz

Finished trimming:
ACR-173-TP2_R1_001.fastq.gz
ACR-173-TP2_R1_001.fastq.gz

Finished trimming:
ACR-173-TP3_R1_001.fastq.gz
ACR-173-TP3_R1_001.fastq.gz

Finished trimming:
ACR-173-TP4_R1_001.fastq.gz
ACR-173-TP4_R1_001.fastq.gz

Finished trimming:
ACR-186-TP1_R1_001.fastq.gz
ACR-186-TP1_R1_001.fastq.gz

Finished trimming:
ACR-186-TP2_R1_001.fastq.gz
ACR-186-TP2_R1_001.fastq.gz

Finished trimming:
ACR-186-TP3_R1_001.fastq.gz
ACR-186-TP3_R1_001.fastq.gz

Finished trimming:
ACR-186-TP4_R1_001.fastq.gz
ACR-186-TP4_R1_001.fastq.gz

Finished trimming:
ACR-225-TP1_R1_001.fastq.gz
ACR-225-TP1_R1_001.fastq.gz

Finished trimming:
ACR-225-TP2_R1_001.fastq.gz
ACR-225-TP2_R1_001.fastq.gz

Finished trimming:
ACR-225-TP3_R1_001.fastq.gz
ACR-225-TP3_R1_001.fastq.gz

Finished trimming:
ACR-225-TP4_R1_001.fastq.gz
ACR-225-TP4_R1_001.fastq.gz

Finished trimming:
ACR-229-TP1_R1_001.fastq.gz
ACR-229-TP1_R1_001.fastq.gz

Finished trimming:
ACR-229-TP2_R1_001.fastq.gz
ACR-229-TP2_R1_001.fastq.gz

Finished trimming:
ACR-229-TP3_R1_001.fastq.gz
ACR-229-TP3_R1_001.fastq.gz

Finished trimming:
ACR-229-TP4_R1_001.fastq.gz
ACR-229-TP4_R1_001.fastq.gz

Finished trimming:
ACR-237-TP1_R1_001.fastq.gz
ACR-237-TP1_R1_001.fastq.gz

Finished trimming:
ACR-237-TP2_R1_001.fastq.gz
ACR-237-TP2_R1_001.fastq.gz

Finished trimming:
ACR-237-TP3_R1_001.fastq.gz
ACR-237-TP3_R1_001.fastq.gz

Finished trimming:
ACR-237-TP4_R1_001.fastq.gz
ACR-237-TP4_R1_001.fastq.gz

Finished trimming:
ACR-244-TP1_R1_001.fastq.gz
ACR-244-TP1_R1_001.fastq.gz

Finished trimming:
ACR-244-TP2_R1_001.fastq.gz
ACR-244-TP2_R1_001.fastq.gz

Finished trimming:
ACR-244-TP3_R1_001.fastq.gz
ACR-244-TP3_R1_001.fastq.gz

Finished trimming:
ACR-244-TP4_R1_001.fastq.gz
ACR-244-TP4_R1_001.fastq.gz

Finished trimming:
ACR-265-TP1_R1_001.fastq.gz
ACR-265-TP1_R1_001.fastq.gz

Finished trimming:
ACR-265-TP2_R1_001.fastq.gz
ACR-265-TP2_R1_001.fastq.gz

Finished trimming:
ACR-265-TP3_R1_001.fastq.gz
ACR-265-TP3_R1_001.fastq.gz

Finished trimming:
ACR-265-TP4_R1_001.fastq.gz
ACR-265-TP4_R1_001.fastq.gz</code></pre>
</section>
<section id="fastqc" class="level1">
<h1>4 FastQC</h1>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-5"></span>
<span id="cb5-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN FASTQC ############</span></span>
<span id="cb5-7"></span>
<span id="cb5-8"></span>
<span id="cb5-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of trimmed FastQs</span></span>
<span id="cb5-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trimmed_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(${trimmed_fastq_pattern})</span></span>
<span id="cb5-11"></span>
<span id="cb5-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pass array contents to new variable as space-delimited list</span></span>
<span id="cb5-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trimmed_fastqc_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[*]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-14"></span>
<span id="cb5-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning FastQC on trimmed reads..."</span></span>
<span id="cb5-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-17"></span>
<span id="cb5-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run FastQC</span></span>
<span id="cb5-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Do NOT quote raw_fastqc_list</span></span>
<span id="cb5-20"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastqc}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-21">--threads <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-22">--outdir <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-23">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-24"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqc_list}</span></span>
<span id="cb5-25"></span>
<span id="cb5-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC on trimmed reads complete!"</span></span>
<span id="cb5-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-28"></span>
<span id="cb5-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> FASTQC ############</span></span></code></pre></div>
<pre><code>Beginning FastQC on trimmed reads...

application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
FastQC on trimmed reads complete!</code></pre>
</section>
<section id="multiqc" class="level1">
<h1>5 MultiQC</h1>
<p>Uses <code>--cl-config "sp: { fastp: { fn: '*report.json' } }"</code> to update the MultiQC search pattern for the fastp module.</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb7-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb7-3"></span>
<span id="cb7-4"></span>
<span id="cb7-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${multiqc}</span> . <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-8">--cl-config <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sp: { fastp: { fn: '*report.json' } }"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-9">--interactive</span>
<span id="cb7-10"></span>
<span id="cb7-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove zip files</span></span>
<span id="cb7-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_fastqc.zip</span></code></pre></div>
<pre><code>  /// MultiQC 🔍 | v1.14

|           multiqc | MultiQC Version v1.27 now available!
|           multiqc | Search path : /home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/output/01.20-D-Apul-WGBS-trimming-fastp-FastQC-MultiQC
|         searching | ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 440/440  
|             fastp | Found 40 reports
|            fastqc | Found 80 reports
|           multiqc | Compressing plot data
|           multiqc | Report      : multiqc_report.html
|           multiqc | Data        : multiqc_data
|           multiqc | MultiQC complete</code></pre>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<p>Trimming worked, and all samples show &lt; 5% adapter contamination (which is considered acceptable by FastQC). However, it is still annoying that any samples show adapter contamination. Additionally, there are a number of samples with relatively high levels of polyA contamination (approaching 5% of reads), despite specifying that <a href="https://github.com/OpenGene/fastp"><code>fastp</code></a> should trim polyA sequences… Regardless, the results are acceptable.</p>
<section id="output-files" class="level2">
<h2 class="anchored" data-anchor-id="output-files">Output files</h2>
<p>Output files are here:</p>
<ul>
<li><p><a href="https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/D-Apul/output/01.20-D-Apul-WGBS-trimming-fastp-FastQC-MultiQC/">https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/D-Apul/output/01.20-D-Apul-WGBS-trimming-fastp-FastQC-MultiQC/</a></p>
<ul>
<li><p>MultiQC report (HTML)</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/D-Apul/output/01.20-D-Apul-WGBS-trimming-fastp-FastQC-MultiQC/multiqc_report.html">multiqc_report.html</a></li>
</ul></li>
</ul></li>
</ul>
</section>
</section>
<section id="references" class="level1">
<h1>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ewels2016" class="csl-entry">
Ewels, Philip, Måns Magnusson, Sverker Lundin, and Max Käller. 2016. “MultiQC: Summarize Analysis Results for Multiple Tools and Samples in a Single Report.” <em>Bioinformatics</em> 32 (19): 3047–48. <a href="https://doi.org/10.1093/bioinformatics/btw354" class="uri">https://doi.org/10.1093/bioinformatics/btw354</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2025</category>
  <category>Acopora pulchra</category>
  <category>WGBS</category>
  <category>trimming</category>
  <category>fastp</category>
  <category>FastQC</category>
  <category>MultiQC</category>
  <category>Raven</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2025/2025-01-02-Trimming---A.pulchra-WGBS-with-fastp-FastQC-and-MultiQC-on-Raven/</guid>
  <pubDate>Thu, 02 Jan 2025 08:00:00 GMT</pubDate>
  <media:content url="https://robertslab.github.io/sams-notebook/posts/2025/2025-01-02-Trimming---A.pulchra-WGBS-with-fastp-FastQC-and-MultiQC-on-Raven/20250102-apul-wgbs-trimmed-per-base-sequence-plot-01.png" medium="image" type="image/png" height="76" width="144"/>
</item>
<item>
  <title>Bisulfite Genome - A.pulchra BS Genome Using Bismark</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2025/2025-01-02-Bisulfite-Genome---A.pulchra-BS-Genome-Using-Bismark/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>In preparation for a quick <a href="https://github.com/FelixKrueger/Bismark"><code>Bismark</code></a> alignment, per <a href="https://github.com/RobertsLab/resources/issues/2063">Steven’s request</a> (GitHub Issue), I needed to generate a bisulfite-converted genome for <em>A.pulchra</em>, as one did not already exist. Although I’m not entirely sure of the source, I used the <code>Apulchra-genome.fa</code> file provided by Steven in <a href="https://github.com/urol-e5/timeseries_molecular/issues/1#issue-2564344644">this GitHub Issue</a>.</p>
<p>The resulting output files were added to the <a href="https://robertslab.github.io/resources/Genomic-Resources/">Genomic Resources Handbook page</a>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The contents below are from markdown knitted from <a href="https://github.com/urol-e5/timeseries_molecular/blob/f8b2e0100ecaa9c0d008f7466cabdf54ab261de8/D-Apul/code/00.21-D-Apul-BS-genome.Rmd"><code>00.21-D-Apul-BS-genome.Rmd</code></a> (commit <code>f8b2e01</code>).</p>
</div>
</div>
</section>
<section id="background" class="level1">
<h1>1 Background</h1>
<p>This Rmd file will create a bisulfite-converted genome by, and for, Bismark (Krueger and Andrews 2011) using the <code>Apulchra-genome.fa</code> file. The genome FastA was taken from the <a href="https://github.com/urol-e5/deep-dive-expression/wiki/00-Genomic-Resources#acropora-pulchra">deep-dive-expression Wiki</a> (GitHub Wiki), but I’m not sure of its exact origin.</p>
<p>Due to large sizes of output files, the files cannot be sync’d to GitHub. As such, the output directories will be gzipped and available here:</p>
<ul>
<li><p><a href="https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/Bisulfite_Genome.tar.gz" class="uri">https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/Bisulfite_Genome.tar.gz</a> (1.3GB)</p></li>
<li><p><a href="https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/Bisulfite_Genome.tar.gz.md5" class="uri">https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/Bisulfite_Genome.tar.gz.md5</a></p>
<ul>
<li>MD5: <code>9e1db5875f210007a43e2083f01c2db9</code></li>
</ul></li>
</ul>
</section>
<section id="inputs" class="level1">
<h1>2 Inputs</h1>
<ul>
<li>Directory containing a FastA file with the file extension: .fa or .fasta (also ending in .gz).</li>
</ul>
</section>
<section id="outputs" class="level1">
<h1>3 Outputs</h1>
<ul>
<li><p>CT Conversion</p>
<ul>
<li>Bowtie2 index files.</li>
<li>CT conversion FastA</li>
</ul></li>
<li><p>GA conversion</p>
<ul>
<li>Bowtie2 index files.</li>
<li>GA conversion FastA.</li>
</ul></li>
</ul>
</section>
<section id="create-a-bash-variables-file" class="level1">
<h1>4 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export timeseries_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export output_dir_top=${timeseries_dir}/D-Apul/data'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export genome_dir=${timeseries_dir}/D-Apul/data'</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-10"></span>
<span id="cb1-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Paths to programs"</span></span>
<span id="cb1-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export programs_dir="/home/shared"'</span></span>
<span id="cb1-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export bismark_dir="${programs_dir}/Bismark-0.24.0"'</span></span>
<span id="cb1-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export bowtie2_dir="${programs_dir}/bowtie2-2.4.4-linux-x86_64"'</span></span>
<span id="cb1-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-16"></span>
<span id="cb1-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set number of CPUs to use"</span></span>
<span id="cb1-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=20'</span></span>
<span id="cb1-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-20"></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Print formatting"</span></span>
<span id="cb1-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-23"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-24"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-25"></span>
<span id="cb1-26"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export timeseries_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular
export output_dir_top=${timeseries_dir}/D-Apul/data
export genome_dir=${timeseries_dir}/D-Apul/data

# Paths to programs
export programs_dir="/home/shared"
export bismark_dir="${programs_dir}/Bismark-0.24.0"
export bowtie2_dir="${programs_dir}/bowtie2-2.4.4-linux-x86_64"

# Set number of CPUs to use
export threads=20

# Print formatting
export line="--------------------------------------------------------"</code></pre>
</section>
<section id="bisfulite-conversion" class="level1">
<h1>5 Bisfulite conversion</h1>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bismark_dir}</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/bismark_genome_preparation</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-6">--parallel <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-7">--bowtie2 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-8">--path_to_aligner <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bowtie2_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-9">1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_dir}</span>/Apulchra-bs-genome.stderr</span></code></pre></div>
<pre><code>Using 20 threads for the top and bottom strand indexing processes each, so using 40 cores in total
Writing bisulfite genomes out into a single MFA (multi FastA) file

Bisulfite Genome Indexer version v0.24.0 (last modified: 19 May 2022)

Step I - Prepare genome folders - completed



Step II - Genome bisulfite conversions - completed


Bismark Genome Preparation - Step III: Launching the Bowtie 2 indexer
Building a SMALL index
Building a SMALL index

=========================================

Parallel genome indexing complete. Enjoy!</code></pre>
<section id="inpect-bs-output" class="level2">
<h2 class="anchored" data-anchor-id="inpect-bs-output">5.1 Inpect BS output</h2>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tree</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-h</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_dir}</span>/Bisulfite_Genome</span></code></pre></div>
<pre><code>/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/Bisulfite_Genome
├── [4.0K]  CT_conversion
│&nbsp;&nbsp; ├── [169M]  BS_CT.1.bt2
│&nbsp;&nbsp; ├── [124M]  BS_CT.2.bt2
│&nbsp;&nbsp; ├── [1.5K]  BS_CT.3.bt2
│&nbsp;&nbsp; ├── [124M]  BS_CT.4.bt2
│&nbsp;&nbsp; ├── [169M]  BS_CT.rev.1.bt2
│&nbsp;&nbsp; ├── [124M]  BS_CT.rev.2.bt2
│&nbsp;&nbsp; └── [504M]  genome_mfa.CT_conversion.fa
└── [4.0K]  GA_conversion
    ├── [169M]  BS_GA.1.bt2
    ├── [124M]  BS_GA.2.bt2
    ├── [1.5K]  BS_GA.3.bt2
    ├── [124M]  BS_GA.4.bt2
    ├── [169M]  BS_GA.rev.1.bt2
    ├── [124M]  BS_GA.rev.2.bt2
    └── [504M]  genome_mfa.GA_conversion.fa

2 directories, 14 files</code></pre>
</section>
<section id="compress-output-folder" class="level2">
<h2 class="anchored" data-anchor-id="compress-output-folder">5.2 Compress output folder</h2>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-czvf</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_dir}</span>/Bisulfite_Genome.tar.gz <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_dir}</span>/Bisulfite_Genome</span></code></pre></div>
<pre><code>tar: Removing leading `/' from member names
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/Bisulfite_Genome/
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/Bisulfite_Genome/CT_conversion/
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/Bisulfite_Genome/CT_conversion/BS_CT.4.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/Bisulfite_Genome/CT_conversion/BS_CT.rev.1.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/Bisulfite_Genome/CT_conversion/genome_mfa.CT_conversion.fa
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/Bisulfite_Genome/CT_conversion/BS_CT.1.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/Bisulfite_Genome/CT_conversion/BS_CT.2.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/Bisulfite_Genome/CT_conversion/BS_CT.3.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/Bisulfite_Genome/CT_conversion/BS_CT.rev.2.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/Bisulfite_Genome/GA_conversion/
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/Bisulfite_Genome/GA_conversion/BS_GA.rev.1.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/Bisulfite_Genome/GA_conversion/BS_GA.2.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/Bisulfite_Genome/GA_conversion/BS_GA.4.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/Bisulfite_Genome/GA_conversion/genome_mfa.GA_conversion.fa
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/Bisulfite_Genome/GA_conversion/BS_GA.rev.2.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/Bisulfite_Genome/GA_conversion/BS_GA.1.bt2
/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/Bisulfite_Genome/GA_conversion/BS_GA.3.bt2</code></pre>
</section>
<section id="create-md5sum" class="level2">
<h2 class="anchored" data-anchor-id="create-md5sum">5.3 Create MD5sum</h2>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb9-2"></span>
<span id="cb9-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_dir}</span></span>
<span id="cb9-4"></span>
<span id="cb9-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> Bisulfite_Genome.tar.gz <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> Bisulfite_Genome.tar.gz.md5</span></code></pre></div>
<pre><code>399a196fc1dfc202a9f084a8fb342dd9  Bisulfite_Genome.tar.gz</code></pre>
</section>
</section>
<section id="references" class="level1">
<h1>6 REFERENCES</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-krueger2011" class="csl-entry">
Krueger, Felix, and Simon R. Andrews. 2011. “Bismark: A Flexible Aligner and Methylation Caller for Bisulfite-Seq Applications.” <em>Bioinformatics</em> 27 (11): 1571–72. <a href="https://doi.org/10.1093/bioinformatics/btr167" class="uri">https://doi.org/10.1093/bioinformatics/btr167</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2025</category>
  <category>Acropora pulchra</category>
  <category>bismark</category>
  <category>bisulfite</category>
  <category>coral</category>
  <category>E5</category>
  <category>timeseries_molecular</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2025/2025-01-02-Bisulfite-Genome---A.pulchra-BS-Genome-Using-Bismark/</guid>
  <pubDate>Thu, 02 Jan 2025 08:00:00 GMT</pubDate>
</item>
<item>
  <title>FastQC MultiQC - A.pulchra WGBS E5 Timeseries</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-12-31-FastQC-MultiQC---A.pulchra-WGBS-E5-Timeseries/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>The notebook entry is part of the coral E5 <a href="https://github.com/urol-e5/timeseries_molecular">molecular_timeseries project</a> (GitHub repo). I ran <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/"><code>FastQC</code></a> and <a href="https://multiqc.info/"><code>MultiQC</code></a> on the <em>A.pulchra</em> WGBS <a href="../../../posts/2024/2024-12-30-Data-Received---Coral-E5-WGBS-Time-Series-from-Azenta-Project-30-1067895835/index.html">data received on 20241230</a> in preparation for a quick <a href="https://github.com/FelixKrueger/Bismark"><code>Bismark</code></a> alignment, per <a href="https://github.com/RobertsLab/resources/issues/2063">Steven’s request</a> (GitHub Issue).</p>
<p>Although I didn’t <em>need</em> to run <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/"><code>FastQC</code></a> or <a href="https://multiqc.info/"><code>MultiQC</code></a>, I did so because I used recycled code to download the data. Since <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/"><code>FastQC</code></a> and <a href="https://multiqc.info/"><code>MultiQC</code></a> are fast, I just ran the entire R Markdown doc anyway.</p>
<p>The resulting <a href="https://multiqc.info/"><code>MultiQC</code></a> Report is here (HTML):</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/wgbs-raw-fastqs/multiqc_report.html">https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/wgbs-raw-fastqs/multiqc_report.html</a></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The markdown below was knitted from <a href="https://github.com/urol-e5/timeseries_molecular/blob/e1675941e629293b8255cc56b23c8fedc7024b80/D-Apul/code/00.20-D-Apul-WGBS-reads-FastQC-MultiQC.Rmd"><code>00.20-D-Apul-WGBS-reads-FastQC-MultiQC.Rmd</code></a> (commit <code>e167594</code>).</p>
</div>
</div>
</section>
<section id="background" class="level1">
<h1>1 Background</h1>
<p>This Rmd file will download raw WGBS FastQs for <em>A.pulchra</em> and evaluate them using <a href="https://github.com/s-andrews/FastQC">FastQC</a> and <a href="https://multiqc.info/">MultiQC</a>(Ewels et al.&nbsp;2016).</p>
<p>Additionally, it will rename the files. New naming format will be <code>&lt;colony_id&gt;-&lt;timepoint&gt;</code>. This will make the naming consistent across species, improve sample identification, and improve parsing in downstream analyses.</p>
</section>
<section id="create-a-bash-variables-file" class="level1">
<h1>2 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export timeseries_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export output_dir_top=${timeseries_dir}/D-Apul/output/00.20-D-Apul-WGBS-reads-FastQC-MultiQC'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_dir=${timeseries_dir}/D-Apul/data/wgbs-raw-fastqs'</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_url="https://owl.fish.washington.edu/nightingales/E5-coral-time-series/30-1067895835/"'</span></span>
<span id="cb1-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Input files"</span></span>
<span id="cb1-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export metadata_file="${timeseries_dir}/M-multi-species/data/e5_DNA_Azenta_metadata.csv"'</span></span>
<span id="cb1-14"></span>
<span id="cb1-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Paths to programs"</span></span>
<span id="cb1-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastqc=/home/shared/FastQC-0.12.1/fastqc'</span></span>
<span id="cb1-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export multiqc=/home/sam/programs/mambaforge/bin/multiqc'</span></span>
<span id="cb1-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set FastQ filename patterns"</span></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export fastq_pattern='*.fastq.gz'"</span></span>
<span id="cb1-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R1_fastq_pattern='*_R1_*.fastq.gz'"</span></span>
<span id="cb1-23"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R2_fastq_pattern='*_R2_*.fastq.gz'"</span></span>
<span id="cb1-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-25"></span>
<span id="cb1-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set number of CPUs to use"</span></span>
<span id="cb1-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=40'</span></span>
<span id="cb1-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-29"></span>
<span id="cb1-30"></span>
<span id="cb1-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"## Inititalize arrays"</span></span>
<span id="cb1-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R1=()'</span></span>
<span id="cb1-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R2=()'</span></span>
<span id="cb1-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_fastqs_array=()'</span></span>
<span id="cb1-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R1_names_array=()'</span></span>
<span id="cb1-36"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R2_names_array=()'</span></span>
<span id="cb1-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-38"></span>
<span id="cb1-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Programs associative array"</span></span>
<span id="cb1-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"declare -A programs_array"</span></span>
<span id="cb1-41"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"programs_array=("</span></span>
<span id="cb1-42"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[fastqc]="${fastqc}" \'</span></span>
<span id="cb1-43"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[multiqc]="${multiqc}" \'</span></span>
<span id="cb1-44"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span></span>
<span id="cb1-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-46"></span>
<span id="cb1-47"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Print formatting"</span></span>
<span id="cb1-48"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-49"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-50"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-51"></span>
<span id="cb1-52"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export timeseries_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular
export output_dir_top=${timeseries_dir}/D-Apul/output/00.20-D-Apul-WGBS-reads-FastQC-MultiQC
export raw_reads_dir=${timeseries_dir}/D-Apul/data/wgbs-raw-fastqs
export raw_reads_url="https://owl.fish.washington.edu/nightingales/E5-coral-time-series/30-1067895835/"

# Input files
export metadata_file="${timeseries_dir}/M-multi-species/data/e5_DNA_Azenta_metadata.csv"
# Paths to programs
export fastqc=/home/shared/FastQC-0.12.1/fastqc
export multiqc=/home/sam/programs/mambaforge/bin/multiqc

# Set FastQ filename patterns
export fastq_pattern='*.fastq.gz'
export R1_fastq_pattern='*_R1_*.fastq.gz'
export R2_fastq_pattern='*_R2_*.fastq.gz'

# Set number of CPUs to use
export threads=40

## Inititalize arrays
export fastq_array_R1=()
export fastq_array_R2=()
export raw_fastqs_array=()
export R1_names_array=()
export R2_names_array=()

# Programs associative array
declare -A programs_array
programs_array=(
[fastqc]="${fastqc}" \
[multiqc]="${multiqc}" \
)

# Print formatting
export line="--------------------------------------------------------"</code></pre>
</section>
<section id="download-a.pulchra-wgbs-fastqs" class="level1">
<h1>3 Download <em>A.pulchra</em> WGBS FastQs</h1>
<section id="inspect-metadata-file" class="level2">
<h2 class="anchored" data-anchor-id="inspect-metadata-file">3.1 Inspect metadata file</h2>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${metadata_file}</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span></span>
<span id="cb3-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">column</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span></span></code></pre></div>
<pre><code>Sample Name*  Plate         Well number  Azenta sample name  Colony ID  Timepoint  Sample Type*  Species/Strain*  Sample Buffer*    Total Amount (ng)*    Volume (µL)  Conc (ng/µL)  Purification Method*  Biosafety Level (BSL)            Method Used for Fluorescence  Method Used for Spectrophotometry  Method Used for Electrophoresis  
1             41            1            G4                  1G4        ACR-225    TP1           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  2064         80            25.8                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"
2             291-20220211  2            A3                  2A3        ACR-225    TP2           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  5064         80            63.3                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"
3             527           1            H5                  1H5        ACR-225    TP3           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  4232         80            52.9                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"
4             911           1            C6                  1C6        ACR-225    TP4           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  4488         80            56.1                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"
5             55            1            B2                  1B2        ACR-229    TP1           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  2432         80            30.4                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"
6             295           1            E3                  1E3        ACR-229    TP2           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  2760         80            34.5                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"
7             531           1            H3                  1H3        ACR-229    TP3           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  5752         80            71.9                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"
8             931           1            F7                  1F7        ACR-229    TP4           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  6008         80            75.1                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"
9             49            1            A1                  1A1        ACR-237    TP1           Genomic DNA      Acropora pulchra  Tris buffer (8.0 pH)  1456         80            18.2                  Column clean-up (Zymo Miniprep)  None                          Qubit                              NA                               1.5% TAE agarose non-denaturing gel  "Please keep methylation libraries   as we may want to sequence more"</code></pre>
</section>
<section id="download-raw-wgbs-reads" class="level2">
<h2 class="anchored" data-anchor-id="download-raw-wgbs-reads">3.2 Download raw WGBS reads</h2>
<p>Reads are downloaded from <a href="https://owl.fish.washington.edu/nightingales/E5-coral-time-series/30-1067895835/" class="uri">https://owl.fish.washington.edu/nightingales/E5-coral-time-series/30-1067895835/</a></p>
<p>Since sequencing included multiple species, the code will also parse only those that are <em>A.pulchra</em>.</p>
<p>Some filenames are preceeded by <code>&lt;sample_number&gt;--</code> for some reason. This formatting is limited to only samples in <code>E</code> wells, so the code below uses that aspect to retrieve those samples as well.</p>
<p>The <code>--cut-dirs 3</code> command cuts the preceding directory structure (i.e.&nbsp;<code>nightingales/E5-coral-time-series/30-1067895835/</code>) so that we just end up with the reads.</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directory if it doesn't exist</span></span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span></span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create list of only A.pulchra sample names</span></span>
<span id="cb5-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Some samples names are preceded by the Sample Number for some reason,</span></span>
<span id="cb5-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># so this handles that formatting.</span></span>
<span id="cb5-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$11 == "Acropora pulchra" { if ($9 ~ /E/) { print $8 "--" $9 } else { print $9 } }'</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${timeseries_dir}</span>/M-multi-species/data/30-1067895835-WGBS-sample-submission-form.csv <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-11"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-12"></span>
<span id="cb5-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample list:"</span></span>
<span id="cb5-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_list}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-22"></span>
<span id="cb5-23"></span>
<span id="cb5-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use printf to format each item for use in wget</span></span>
<span id="cb5-25"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">formatted_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%s_*,"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_list})</span></span>
<span id="cb5-26"></span>
<span id="cb5-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove the trailing comma</span></span>
<span id="cb5-28"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">formatted_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${formatted_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-29"></span>
<span id="cb5-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output the final wget command</span></span>
<span id="cb5-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Formatted wget accept list:"</span></span>
<span id="cb5-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-36"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wget --accept=</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$formatted_list</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-40"></span>
<span id="cb5-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run wget to retrieve FastQs and MD5 files</span></span>
<span id="cb5-42"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-43">--directory-prefix <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-44">--recursive <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-45">--no-check-certificate <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-46">--continue <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-47">--cut-dirs 3 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-48">--no-host-directories <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-49">--no-parent <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-50">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-51">--accept=<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$formatted_list</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_url}</span></span>
<span id="cb5-52"></span>
<span id="cb5-53"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<pre><code>--------------------------------------------------------

Sample list:

10--1E7
1A1
1A10
1A12
1A3
1A5
1A6
1A8
1B1
1B10
1B2
1B4
1B5
1C6
1C8
1C9
1D3
1D7
1D8
1D9
1F1
1F5
1F7
1F9
1G4
1G5
1H11
1H2
1H3
1H5
1H6
1H9
2A3
2C2
2D1
2D2
2G2
2H3
39--2E2
6--1E3

--------------------------------------------------------


--------------------------------------------------------

Formatted wget accept list:

wget --accept="10--1E7_*,1A1_*,1A10_*,1A12_*,1A3_*,1A5_*,1A6_*,1A8_*,1B1_*,1B10_*,1B2_*,1B4_*,1B5_*,1C6_*,1C8_*,1C9_*,1D3_*,1D7_*,1D8_*,1D9_*,1F1_*,1F5_*,1F7_*,1F9_*,1G4_*,1G5_*,1H11_*,1H2_*,1H3_*,1H5_*,1H6_*,1H9_*,2A3_*,2C2_*,2D1_*,2D2_*,2G2_*,2H3_*,39--2E2_*,6--1E3_*"

--------------------------------------------------------

total 213G
-rw-r--r-- 1 sam sam 2.6G Dec 30 07:56 10--1E7_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Dec 30 07:56 10--1E7_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 07:59 10--1E7_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Dec 30 07:59 10--1E7_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.8G Dec 30 08:22 1A10_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 08:22 1A10_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.8G Dec 30 08:25 1A10_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 08:25 1A10_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.8G Dec 30 08:33 1A12_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 08:33 1A12_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.8G Dec 30 08:35 1A12_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 08:35 1A12_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 08:38 1A1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 08:38 1A1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 08:41 1A1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 08:41 1A1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.1G Dec 30 08:51 1A3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 08:51 1A3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.1G Dec 30 08:54 1A3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 08:54 1A3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.8G Dec 30 09:02 1A5_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 09:02 1A5_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.8G Dec 30 09:05 1A5_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 09:05 1A5_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.5G Dec 30 09:07 1A6_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 09:07 1A6_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.4G Dec 30 09:10 1A6_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 09:10 1A6_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.4G Dec 30 09:18 1A8_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 09:18 1A8_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.5G Dec 30 09:21 1A8_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 09:21 1A8_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.7G Dec 30 09:32 1B10_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 09:32 1B10_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.7G Dec 30 09:35 1B10_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 09:35 1B10_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.7G Dec 30 09:48 1B1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 09:48 1B1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.7G Dec 30 09:51 1B1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 09:51 1B1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.4G Dec 30 09:54 1B2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 09:54 1B2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.4G Dec 30 09:57 1B2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 09:57 1B2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.0G Dec 30 10:05 1B4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 10:05 1B4_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.0G Dec 30 10:08 1B4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 10:08 1B4_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.7G Dec 30 10:10 1B5_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 10:10 1B5_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.7G Dec 30 10:13 1B5_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 10:13 1B5_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.5G Dec 30 11:15 1C6_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 11:15 1C6_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.5G Dec 30 11:18 1C6_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 11:18 1C6_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.9G Dec 30 11:26 1C8_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 11:26 1C8_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.9G Dec 30 11:29 1C8_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 11:29 1C8_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.7G Dec 30 11:31 1C9_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 11:31 1C9_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.7G Dec 30 11:34 1C9_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 11:34 1C9_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 12:00 1D3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 12:00 1D3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.5G Dec 30 12:03 1D3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 12:03 1D3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.5G Dec 30 12:21 1D7_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 12:21 1D7_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.4G Dec 30 12:23 1D7_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 12:23 1D7_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.7G Dec 30 12:26 1D8_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 12:26 1D8_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.7G Dec 30 12:28 1D8_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 12:28 1D8_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.0G Dec 30 12:31 1D9_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 12:31 1D9_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.0G Dec 30 12:34 1D9_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 12:34 1D9_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.1G Dec 30 12:51 1F1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 12:51 1F1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.1G Dec 30 12:54 1F1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 12:54 1F1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.1G Dec 30 13:10 1F5_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 13:10 1F5_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.0G Dec 30 13:13 1F5_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 13:13 1F5_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.4G Dec 30 13:19 1F7_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 13:19 1F7_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.4G Dec 30 13:21 1F7_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 13:21 1F7_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.5G Dec 30 13:28 1F9_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 13:28 1F9_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.5G Dec 30 13:30 1F9_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 13:30 1F9_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.3G Dec 30 14:01 1G4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 14:01 1G4_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.3G Dec 30 14:03 1G4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 14:03 1G4_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.8G Dec 30 14:06 1G5_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 14:06 1G5_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.8G Dec 30 14:09 1G5_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 14:09 1G5_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.5G Dec 30 14:35 1H11_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 14:35 1H11_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.5G Dec 30 14:38 1H11_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   57 Dec 30 14:38 1H11_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.9G Dec 30 14:51 1H2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 14:51 1H2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.0G Dec 30 14:54 1H2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 14:54 1H2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 14:56 1H3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 14:56 1H3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 14:59 1H3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 14:59 1H3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.7G Dec 30 15:07 1H5_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 15:07 1H5_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.7G Dec 30 15:10 1H5_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 15:10 1H5_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 15:13 1H6_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 15:13 1H6_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 15:16 1H6_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 15:16 1H6_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.8G Dec 30 15:30 1H9_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 15:30 1H9_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.7G Dec 30 15:33 1H9_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 15:33 1H9_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.1G Dec 30 15:45 2A3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 15:45 2A3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.1G Dec 30 15:47 2A3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 15:47 2A3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 16:11 2C2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 16:11 2C2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.6G Dec 30 16:14 2C2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 16:14 2C2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.3G Dec 30 16:23 2D1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 16:23 2D1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.3G Dec 30 16:26 2D1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 16:26 2D1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.8G Dec 30 16:28 2D2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 16:28 2D2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.8G Dec 30 16:30 2D2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 16:30 2D2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.7G Dec 30 17:00 2G2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 17:00 2G2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.7G Dec 30 17:03 2G2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 17:03 2G2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.9G Dec 30 17:22 2H3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 17:22 2H3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.9G Dec 30 17:24 2H3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   56 Dec 30 17:24 2H3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.4G Dec 30 17:27 39--2E2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Dec 30 17:27 39--2E2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.4G Dec 30 17:30 39--2E2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Dec 30 17:30 39--2E2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.2G Dec 30 17:57 6--1E3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   59 Dec 30 17:57 6--1E3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 3.2G Dec 30 18:00 6--1E3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   59 Dec 30 18:00 6--1E3_R2_001.fastq.gz.md5
-rw-rw-r-- 1 sam sam 1.6K Jan  2 11:08 fastq_pairs.txt</code></pre>
</section>
<section id="verify-raw-read-checksums" class="level2">
<h2 class="anchored" data-anchor-id="verify-raw-read-checksums">3.3 Verify raw read checksums</h2>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb7-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-5"></span>
<span id="cb7-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.md5</span>
<span id="cb7-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb7-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--check</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-9"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<pre><code>./10--1E7_R1_001.fastq.gz: OK
./10--1E7_R2_001.fastq.gz: OK
./1A10_R1_001.fastq.gz: OK
./1A10_R2_001.fastq.gz: OK
./1A12_R1_001.fastq.gz: OK
./1A12_R2_001.fastq.gz: OK
./1A1_R1_001.fastq.gz: OK
./1A1_R2_001.fastq.gz: OK
./1A3_R1_001.fastq.gz: OK
./1A3_R2_001.fastq.gz: OK
./1A5_R1_001.fastq.gz: OK
./1A5_R2_001.fastq.gz: OK
./1A6_R1_001.fastq.gz: OK
./1A6_R2_001.fastq.gz: OK
./1A8_R1_001.fastq.gz: OK
./1A8_R2_001.fastq.gz: OK
./1B10_R1_001.fastq.gz: OK
./1B10_R2_001.fastq.gz: OK
./1B1_R1_001.fastq.gz: OK
./1B1_R2_001.fastq.gz: OK
./1B2_R1_001.fastq.gz: OK
./1B2_R2_001.fastq.gz: OK
./1B4_R1_001.fastq.gz: OK
./1B4_R2_001.fastq.gz: OK
./1B5_R1_001.fastq.gz: OK
./1B5_R2_001.fastq.gz: OK
./1C6_R1_001.fastq.gz: OK
./1C6_R2_001.fastq.gz: OK
./1C8_R1_001.fastq.gz: OK
./1C8_R2_001.fastq.gz: OK
./1C9_R1_001.fastq.gz: OK
./1C9_R2_001.fastq.gz: OK
./1D3_R1_001.fastq.gz: OK
./1D3_R2_001.fastq.gz: OK
./1D7_R1_001.fastq.gz: OK
./1D7_R2_001.fastq.gz: OK
./1D8_R1_001.fastq.gz: OK
./1D8_R2_001.fastq.gz: OK
./1D9_R1_001.fastq.gz: OK
./1D9_R2_001.fastq.gz: OK
./1F1_R1_001.fastq.gz: OK
./1F1_R2_001.fastq.gz: OK
./1F5_R1_001.fastq.gz: OK
./1F5_R2_001.fastq.gz: OK
./1F7_R1_001.fastq.gz: OK
./1F7_R2_001.fastq.gz: OK
./1F9_R1_001.fastq.gz: OK
./1F9_R2_001.fastq.gz: OK
./1G4_R1_001.fastq.gz: OK
./1G4_R2_001.fastq.gz: OK
./1G5_R1_001.fastq.gz: OK
./1G5_R2_001.fastq.gz: OK
./1H11_R1_001.fastq.gz: OK
./1H11_R2_001.fastq.gz: OK
./1H2_R1_001.fastq.gz: OK
./1H2_R2_001.fastq.gz: OK
./1H3_R1_001.fastq.gz: OK
./1H3_R2_001.fastq.gz: OK
./1H5_R1_001.fastq.gz: OK
./1H5_R2_001.fastq.gz: OK
./1H6_R1_001.fastq.gz: OK
./1H6_R2_001.fastq.gz: OK
./1H9_R1_001.fastq.gz: OK
./1H9_R2_001.fastq.gz: OK
./2A3_R1_001.fastq.gz: OK
./2A3_R2_001.fastq.gz: OK
./2C2_R1_001.fastq.gz: OK
./2C2_R2_001.fastq.gz: OK
./2D1_R1_001.fastq.gz: OK
./2D1_R2_001.fastq.gz: OK
./2D2_R1_001.fastq.gz: OK
./2D2_R2_001.fastq.gz: OK
./2G2_R1_001.fastq.gz: OK
./2G2_R2_001.fastq.gz: OK
./2H3_R1_001.fastq.gz: OK
./2H3_R2_001.fastq.gz: OK
./39--2E2_R1_001.fastq.gz: OK
./39--2E2_R2_001.fastq.gz: OK
./6--1E3_R1_001.fastq.gz: OK
./6--1E3_R2_001.fastq.gz: OK</code></pre>
</section>
</section>
<section id="rename-fastqs-for-project-consistency" class="level1">
<h1>4 Rename FastQs for Project Consistency</h1>
<p>New naming format will be <code>&lt;colony_id&gt;-&lt;timepoint&gt;</code>.</p>
<p>Use of a temp file, instead of working directory from the metadata file can avoid potential issues with character/text formatting from the input CSV.</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb9-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb9-3"></span>
<span id="cb9-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-5"></span>
<span id="cb9-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create an associative array to store the mapping</span></span>
<span id="cb9-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">declare</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_to_colony_timepoint</span></span>
<span id="cb9-8"></span>
<span id="cb9-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a temporary file to store the mapping</span></span>
<span id="cb9-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">temp_mapping_file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mktemp</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb9-11"></span>
<span id="cb9-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the metadata file and populate the temporary file using awk</span></span>
<span id="cb9-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Maps Azenta sample name to colony_id and timepoint.</span></span>
<span id="cb9-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'NR &gt; 1 { print $5, $6 "-" $7 }'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$metadata_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$temp_mapping_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-15"></span>
<span id="cb9-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the temporary file and populate the associative array</span></span>
<span id="cb9-17"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">read</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Number</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">colony_timepoint</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb9-18">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_to_colony_timepoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$Number</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$colony_timepoint</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-19"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$temp_mapping_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-20"></span>
<span id="cb9-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove the temporary file</span></span>
<span id="cb9-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$temp_mapping_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-23"></span>
<span id="cb9-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print the associative array for debugging</span></span>
<span id="cb9-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number to colony_id-Timepoint mapping:"</span></span>
<span id="cb9-26"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> key <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_to_colony_timepoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb9-27">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb9-28">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$key</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> -&gt; </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${number_to_colony_timepoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$key</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-29">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb9-30"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb9-31"></span>
<span id="cb9-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Iterate over the FastQ files in the current directory</span></span>
<span id="cb9-33"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fastq_file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.fastq.gz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb9-34">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract the sample number from the filename</span></span>
<span id="cb9-35">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_number</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fastq_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-E</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s/^([0-9]+--)?([A-Za-z0-9]+).*/\2/'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb9-36">    </span>
<span id="cb9-37">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the sample number exists in the associative array</span></span>
<span id="cb9-38">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-n</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${number_to_colony_timepoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_number</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb9-39">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">new_sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${number_to_colony_timepoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_number</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-40">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">new_filename</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fastq_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-E</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"s/^([0-9]+--)?</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_number</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$new_sample_name</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb9-41">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fastq_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$new_filename</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb9-42">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mv</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fastq_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$new_filename</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-43">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Renamed </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fastq_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> to </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$new_filename</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-44">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb9-45">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No renaming needed for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fastq_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-46">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb9-47">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb9-48">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample number '</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_number</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">' not found in metadata."</span></span>
<span id="cb9-49">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Debugging: Print all keys in the associative array with quotes</span></span>
<span id="cb9-50">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Available keys in the associative array:"</span></span>
<span id="cb9-51">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> key <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_to_colony_timepoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb9-52">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$key</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'"</span></span>
<span id="cb9-53">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb9-54">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb9-55"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<pre><code>Number to colony_id-Timepoint mapping:

1B3 -&gt; SR_1-440-NA


1B2 -&gt; ACR-229-TP1


1B1 -&gt; ACR-150-TP3


1B7 -&gt; POC-40-TP3


1B6 -&gt; POR-245-TP2


1B5 -&gt; ACR-244-TP2


1B4 -&gt; ACR-244-TP4


1B9 -&gt; POR-236-TP2


1B8 -&gt; POR-69-TP1


1D5 -&gt; POC-57-TP1


1D4 -&gt; POC-52-TP3


1C1 -&gt; POC-222-TP3


1C2 -&gt; POR-83-TP4


1D7 -&gt; ACR-186-TP4


1D6 -&gt; POR-245-TP4


1C3 -&gt; POC-53-TP3


1D1 -&gt; POR-216-TP2


1B12 -&gt; POC-219-TP4


1C4 -&gt; POC-201-TP2


1C5 -&gt; POC-52-TP4


1B10 -&gt; ACR-150-TP1


1D3 -&gt; ACR-237-TP4


1C6 -&gt; ACR-225-TP4


1B11 -&gt; POR-69-TP4


1D2 -&gt; POR-260-TP1


1C7 -&gt; POC-53-TP1


1C8 -&gt; ACR-145-TP2


1C9 -&gt; ACR-237-TP3


2C3 -&gt; POR-73-TP1


1D9 -&gt; ACR-139-TP3


2C2 -&gt; ACR-145-TP3


1D8 -&gt; ACR-139-TP4


2C1 -&gt; POR-216-TP1


1E2 -&gt; POC-42-TP3


1E3 -&gt; ACR-229-TP2


1E1 -&gt; POC-259-TP4


1E6 -&gt; POR-83-TP1


1E7 -&gt; ACR-237-TP2


1E4 -&gt; POR-74-TP2


1E5 -&gt; POR-245-TP3


1E11 -&gt; POR-260-TP4


1E10 -&gt; POC-259-TP3


1E8 -&gt; POR-262-TP3


1E9 -&gt; POR-73-TP4


1E12 -&gt; POC-222-TP2


2B1 -&gt; SR_3-440B-NA


2B2 -&gt; POC-40-TP2


2B3 -&gt; POR-262-TP4


2E1 -&gt; POR-74-TP1


2E3 -&gt; POC-255-TP4


2E2 -&gt; ACR-186-TP3


1H1 -&gt; POC-57-TP4


1H3 -&gt; ACR-229-TP3


1H2 -&gt; ACR-173-TP3


2D2 -&gt; ACR-173-TP2


1H5 -&gt; ACR-225-TP3


2D3 -&gt; POC-52-TP1


1H4 -&gt; POC-201-TP1


1H7 -&gt; POC-219-TP1


1F9 -&gt; ACR-265-TP2


1F8 -&gt; POC-53-TP4


2D1 -&gt; ACR-150-TP4


1H6 -&gt; ACR-150-TP2


1H9 -&gt; ACR-173-TP1


1F7 -&gt; ACR-229-TP4


1H8 -&gt; POR-74-TP4


1F6 -&gt; POR-260-TP2


1F5 -&gt; ACR-145-TP4


1F4 -&gt; POC-255-TP1


1F3 -&gt; POR-83-TP3


1D10 -&gt; POR-69-TP2


1D11 -&gt; SR_2-84-NA


1F2 -&gt; POC-57-TP3


1D12 -&gt; POR-73-TP3


1F1 -&gt; ACR-244-TP1


2G3 -&gt; POR-74-TP3


2G2 -&gt; ACR-265-TP1


2G1 -&gt; POR-245-TP1


1G8 -&gt; POC-222-TP1


1G9 -&gt; POR-260-TP3


1G12 -&gt; POC-40-TP1


1G11 -&gt; POR-216-TP3


1G10 -&gt; POR-72-TP3


1G4 -&gt; ACR-225-TP1


1G5 -&gt; ACR-173-TP4


1G6 -&gt; POR-236-TP1


1G7 -&gt; POC-222-TP4


1G1 -&gt; POC-57-TP2


1G2 -&gt; POR-216-TP4


1G3 -&gt; POC-259-TP1


2F1 -&gt; POC-255-TP3


2F2 -&gt; POR-83-TP2


2F3 -&gt; POR-72-TP4


2A1 -&gt; POC-40-TP4


1A11 -&gt; POC-201-TP3


1A10 -&gt; ACR-139-TP1


2A3 -&gt; ACR-225-TP2


2A2 -&gt; POR-72-TP2


1A12 -&gt; ACR-186-TP2


2H2 -&gt; POR-262-TP2


2H3 -&gt; ACR-244-TP3


2H1 -&gt; POC-42-TP1


1H10 -&gt; POC-219-TP2


1A6 -&gt; ACR-265-TP3


1A7 -&gt; POR-262-TP1


1C12 -&gt; POC-52-TP2


1H11 -&gt; ACR-265-TP4


1H12 -&gt; POR-73-TP2


1C11 -&gt; POC-42-TP4


1A4 -&gt; POC-259-TP2


1C10 -&gt; POC-53-TP2


1A5 -&gt; ACR-139-TP2


1A2 -&gt; POC-219-TP3


1A3 -&gt; ACR-145-TP1


1A1 -&gt; ACR-237-TP1


1F12 -&gt; POC-255-TP2


1F10 -&gt; POR-72-TP1


1F11 -&gt; POC-42-TP2


1A8 -&gt; ACR-186-TP1


1A9 -&gt; POR-69-TP3

Renamed 10--1E7_R1_001.fastq.gz to ACR-237-TP2_R1_001.fastq.gz
Renamed 10--1E7_R2_001.fastq.gz to ACR-237-TP2_R2_001.fastq.gz
Renamed 1A10_R1_001.fastq.gz to ACR-139-TP1_R1_001.fastq.gz
Renamed 1A10_R2_001.fastq.gz to ACR-139-TP1_R2_001.fastq.gz
Renamed 1A12_R1_001.fastq.gz to ACR-186-TP2_R1_001.fastq.gz
Renamed 1A12_R2_001.fastq.gz to ACR-186-TP2_R2_001.fastq.gz
Renamed 1A1_R1_001.fastq.gz to ACR-237-TP1_R1_001.fastq.gz
Renamed 1A1_R2_001.fastq.gz to ACR-237-TP1_R2_001.fastq.gz
Renamed 1A3_R1_001.fastq.gz to ACR-145-TP1_R1_001.fastq.gz
Renamed 1A3_R2_001.fastq.gz to ACR-145-TP1_R2_001.fastq.gz
Renamed 1A5_R1_001.fastq.gz to ACR-139-TP2_R1_001.fastq.gz
Renamed 1A5_R2_001.fastq.gz to ACR-139-TP2_R2_001.fastq.gz
Renamed 1A6_R1_001.fastq.gz to ACR-265-TP3_R1_001.fastq.gz
Renamed 1A6_R2_001.fastq.gz to ACR-265-TP3_R2_001.fastq.gz
Renamed 1A8_R1_001.fastq.gz to ACR-186-TP1_R1_001.fastq.gz
Renamed 1A8_R2_001.fastq.gz to ACR-186-TP1_R2_001.fastq.gz
Renamed 1B10_R1_001.fastq.gz to ACR-150-TP1_R1_001.fastq.gz
Renamed 1B10_R2_001.fastq.gz to ACR-150-TP1_R2_001.fastq.gz
Renamed 1B1_R1_001.fastq.gz to ACR-150-TP3_R1_001.fastq.gz
Renamed 1B1_R2_001.fastq.gz to ACR-150-TP3_R2_001.fastq.gz
Renamed 1B2_R1_001.fastq.gz to ACR-229-TP1_R1_001.fastq.gz
Renamed 1B2_R2_001.fastq.gz to ACR-229-TP1_R2_001.fastq.gz
Renamed 1B4_R1_001.fastq.gz to ACR-244-TP4_R1_001.fastq.gz
Renamed 1B4_R2_001.fastq.gz to ACR-244-TP4_R2_001.fastq.gz
Renamed 1B5_R1_001.fastq.gz to ACR-244-TP2_R1_001.fastq.gz
Renamed 1B5_R2_001.fastq.gz to ACR-244-TP2_R2_001.fastq.gz
Renamed 1C6_R1_001.fastq.gz to ACR-225-TP4_R1_001.fastq.gz
Renamed 1C6_R2_001.fastq.gz to ACR-225-TP4_R2_001.fastq.gz
Renamed 1C8_R1_001.fastq.gz to ACR-145-TP2_R1_001.fastq.gz
Renamed 1C8_R2_001.fastq.gz to ACR-145-TP2_R2_001.fastq.gz
Renamed 1C9_R1_001.fastq.gz to ACR-237-TP3_R1_001.fastq.gz
Renamed 1C9_R2_001.fastq.gz to ACR-237-TP3_R2_001.fastq.gz
Renamed 1D3_R1_001.fastq.gz to ACR-237-TP4_R1_001.fastq.gz
Renamed 1D3_R2_001.fastq.gz to ACR-237-TP4_R2_001.fastq.gz
Renamed 1D7_R1_001.fastq.gz to ACR-186-TP4_R1_001.fastq.gz
Renamed 1D7_R2_001.fastq.gz to ACR-186-TP4_R2_001.fastq.gz
Renamed 1D8_R1_001.fastq.gz to ACR-139-TP4_R1_001.fastq.gz
Renamed 1D8_R2_001.fastq.gz to ACR-139-TP4_R2_001.fastq.gz
Renamed 1D9_R1_001.fastq.gz to ACR-139-TP3_R1_001.fastq.gz
Renamed 1D9_R2_001.fastq.gz to ACR-139-TP3_R2_001.fastq.gz
Renamed 1F1_R1_001.fastq.gz to ACR-244-TP1_R1_001.fastq.gz
Renamed 1F1_R2_001.fastq.gz to ACR-244-TP1_R2_001.fastq.gz
Renamed 1F5_R1_001.fastq.gz to ACR-145-TP4_R1_001.fastq.gz
Renamed 1F5_R2_001.fastq.gz to ACR-145-TP4_R2_001.fastq.gz
Renamed 1F7_R1_001.fastq.gz to ACR-229-TP4_R1_001.fastq.gz
Renamed 1F7_R2_001.fastq.gz to ACR-229-TP4_R2_001.fastq.gz
Renamed 1F9_R1_001.fastq.gz to ACR-265-TP2_R1_001.fastq.gz
Renamed 1F9_R2_001.fastq.gz to ACR-265-TP2_R2_001.fastq.gz
Renamed 1G4_R1_001.fastq.gz to ACR-225-TP1_R1_001.fastq.gz
Renamed 1G4_R2_001.fastq.gz to ACR-225-TP1_R2_001.fastq.gz
Renamed 1G5_R1_001.fastq.gz to ACR-173-TP4_R1_001.fastq.gz
Renamed 1G5_R2_001.fastq.gz to ACR-173-TP4_R2_001.fastq.gz
Renamed 1H11_R1_001.fastq.gz to ACR-265-TP4_R1_001.fastq.gz
Renamed 1H11_R2_001.fastq.gz to ACR-265-TP4_R2_001.fastq.gz
Renamed 1H2_R1_001.fastq.gz to ACR-173-TP3_R1_001.fastq.gz
Renamed 1H2_R2_001.fastq.gz to ACR-173-TP3_R2_001.fastq.gz
Renamed 1H3_R1_001.fastq.gz to ACR-229-TP3_R1_001.fastq.gz
Renamed 1H3_R2_001.fastq.gz to ACR-229-TP3_R2_001.fastq.gz
Renamed 1H5_R1_001.fastq.gz to ACR-225-TP3_R1_001.fastq.gz
Renamed 1H5_R2_001.fastq.gz to ACR-225-TP3_R2_001.fastq.gz
Renamed 1H6_R1_001.fastq.gz to ACR-150-TP2_R1_001.fastq.gz
Renamed 1H6_R2_001.fastq.gz to ACR-150-TP2_R2_001.fastq.gz
Renamed 1H9_R1_001.fastq.gz to ACR-173-TP1_R1_001.fastq.gz
Renamed 1H9_R2_001.fastq.gz to ACR-173-TP1_R2_001.fastq.gz
Renamed 2A3_R1_001.fastq.gz to ACR-225-TP2_R1_001.fastq.gz
Renamed 2A3_R2_001.fastq.gz to ACR-225-TP2_R2_001.fastq.gz
Renamed 2C2_R1_001.fastq.gz to ACR-145-TP3_R1_001.fastq.gz
Renamed 2C2_R2_001.fastq.gz to ACR-145-TP3_R2_001.fastq.gz
Renamed 2D1_R1_001.fastq.gz to ACR-150-TP4_R1_001.fastq.gz
Renamed 2D1_R2_001.fastq.gz to ACR-150-TP4_R2_001.fastq.gz
Renamed 2D2_R1_001.fastq.gz to ACR-173-TP2_R1_001.fastq.gz
Renamed 2D2_R2_001.fastq.gz to ACR-173-TP2_R2_001.fastq.gz
Renamed 2G2_R1_001.fastq.gz to ACR-265-TP1_R1_001.fastq.gz
Renamed 2G2_R2_001.fastq.gz to ACR-265-TP1_R2_001.fastq.gz
Renamed 2H3_R1_001.fastq.gz to ACR-244-TP3_R1_001.fastq.gz
Renamed 2H3_R2_001.fastq.gz to ACR-244-TP3_R2_001.fastq.gz
Renamed 39--2E2_R1_001.fastq.gz to ACR-186-TP3_R1_001.fastq.gz
Renamed 39--2E2_R2_001.fastq.gz to ACR-186-TP3_R2_001.fastq.gz
Renamed 6--1E3_R1_001.fastq.gz to ACR-229-TP2_R1_001.fastq.gz
Renamed 6--1E3_R2_001.fastq.gz to ACR-229-TP2_R2_001.fastq.gz</code></pre>
</section>
<section id="fastqcmultiqc-on-raw-reads" class="level1">
<h1>5 FastQC/MultiQC on raw reads</h1>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb11-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb11-3"></span>
<span id="cb11-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN FASTQC ############</span></span>
<span id="cb11-5"></span>
<span id="cb11-6"></span>
<span id="cb11-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of trimmed FastQs</span></span>
<span id="cb11-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">raw_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(${raw_reads_dir}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_pattern})</span></span>
<span id="cb11-9"></span>
<span id="cb11-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pass array contents to new variable as space-delimited list</span></span>
<span id="cb11-11"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">raw_fastqc_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[*]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb11-12"></span>
<span id="cb11-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning FastQC on raw reads..."</span></span>
<span id="cb11-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb11-15"></span>
<span id="cb11-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run FastQC</span></span>
<span id="cb11-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Do NOT quote raw_fastqc_list</span></span>
<span id="cb11-18"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>fastqc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-19">--threads <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-20">--outdir <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-21">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-22"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_list}</span></span>
<span id="cb11-23"></span>
<span id="cb11-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC on raw reads complete!"</span></span>
<span id="cb11-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb11-26"></span>
<span id="cb11-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> FASTQC ############</span></span>
<span id="cb11-28"></span>
<span id="cb11-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN MULTIQC ############</span></span>
<span id="cb11-30"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning MultiQC on raw FastQC..."</span></span>
<span id="cb11-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb11-32"></span>
<span id="cb11-33"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>multiqc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-34"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-35">--interactive <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-36">-o <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span></span>
<span id="cb11-37"></span>
<span id="cb11-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb11-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MultiQC on raw FastQs complete."</span></span>
<span id="cb11-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb11-41"></span>
<span id="cb11-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> MULTIQC ############</span></span>
<span id="cb11-43"></span>
<span id="cb11-44"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Removing FastQC zip files."</span></span>
<span id="cb11-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb11-46"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.zip</span>
<span id="cb11-47"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC zip files removed."</span></span>
<span id="cb11-48"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb11-49"></span>
<span id="cb11-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># View directory contents</span></span>
<span id="cb11-51"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span></span></code></pre></div>
<pre><code>Beginning FastQC on raw reads...

application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
FastQC on raw reads complete!

Beginning MultiQC on raw FastQC...


  /// MultiQC 🔍 | v1.14

|           multiqc | MultiQC Version v1.27 now available!
|           multiqc | Search path : /home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/wgbs-raw-fastqs
|         searching | ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 321/321  
|            fastqc | Found 80 reports
|           multiqc | Compressing plot data
|           multiqc | Report      : ../data/wgbs-raw-fastqs/multiqc_report.html
|           multiqc | Data        : ../data/wgbs-raw-fastqs/multiqc_data
|           multiqc | MultiQC complete

MultiQC on raw FastQs complete.

Removing FastQC zip files.

FastQC zip files removed.

total 213G
-rw-r--r-- 1 sam sam   60 Dec 30 07:56 10--1E7_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   60 Dec 30 07:59 10--1E7_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 08:22 1A10_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 08:25 1A10_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 08:33 1A12_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 08:35 1A12_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 08:38 1A1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 08:41 1A1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 08:51 1A3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 08:54 1A3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 09:02 1A5_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 09:05 1A5_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 09:07 1A6_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 09:10 1A6_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 09:18 1A8_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 09:21 1A8_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 09:32 1B10_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 09:35 1B10_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 09:48 1B1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 09:51 1B1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 09:54 1B2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 09:57 1B2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 10:05 1B4_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 10:08 1B4_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 10:10 1B5_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 10:13 1B5_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 11:15 1C6_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 11:18 1C6_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 11:26 1C8_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 11:29 1C8_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 11:31 1C9_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 11:34 1C9_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 12:00 1D3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 12:03 1D3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 12:21 1D7_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 12:23 1D7_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 12:26 1D8_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 12:28 1D8_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 12:31 1D9_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 12:34 1D9_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 12:51 1F1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 12:54 1F1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 13:10 1F5_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 13:13 1F5_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 13:19 1F7_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 13:21 1F7_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 13:28 1F9_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 13:30 1F9_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 14:01 1G4_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 14:03 1G4_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 14:06 1G5_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 14:09 1G5_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 14:35 1H11_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   57 Dec 30 14:38 1H11_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 14:51 1H2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 14:54 1H2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 14:56 1H3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 14:59 1H3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 15:07 1H5_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 15:10 1H5_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 15:13 1H6_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 15:16 1H6_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 15:30 1H9_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 15:33 1H9_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 15:45 2A3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 15:47 2A3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 16:11 2C2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 16:14 2C2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 16:23 2D1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 16:26 2D1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 16:28 2D2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 16:30 2D2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 17:00 2G2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 17:03 2G2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 17:22 2H3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   56 Dec 30 17:24 2H3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   60 Dec 30 17:27 39--2E2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   60 Dec 30 17:30 39--2E2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   59 Dec 30 17:57 6--1E3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam   59 Dec 30 18:00 6--1E3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 585K Feb 19 09:17 ACR-139-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.8G Dec 30 08:22 ACR-139-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 605K Feb 19 09:17 ACR-139-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.8G Dec 30 08:25 ACR-139-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 589K Feb 19 09:17 ACR-139-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.8G Dec 30 09:02 ACR-139-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 606K Feb 19 09:18 ACR-139-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.8G Dec 30 09:05 ACR-139-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 591K Feb 19 09:18 ACR-139-TP3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 3.0G Dec 30 12:31 ACR-139-TP3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 611K Feb 19 09:19 ACR-139-TP3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 3.0G Dec 30 12:34 ACR-139-TP3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 586K Feb 19 09:16 ACR-139-TP4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.7G Dec 30 12:26 ACR-139-TP4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 604K Feb 19 09:17 ACR-139-TP4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.7G Dec 30 12:28 ACR-139-TP4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 594K Feb 19 09:20 ACR-145-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 3.1G Dec 30 08:51 ACR-145-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 611K Feb 19 09:19 ACR-145-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 3.1G Dec 30 08:54 ACR-145-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 589K Feb 19 09:18 ACR-145-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.9G Dec 30 11:26 ACR-145-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 608K Feb 19 09:16 ACR-145-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.9G Dec 30 11:29 ACR-145-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 589K Feb 19 09:17 ACR-145-TP3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 16:11 ACR-145-TP3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 597K Feb 19 09:16 ACR-145-TP3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 16:14 ACR-145-TP3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 591K Feb 19 09:19 ACR-145-TP4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 3.1G Dec 30 13:10 ACR-145-TP4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 610K Feb 19 09:20 ACR-145-TP4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 3.0G Dec 30 13:13 ACR-145-TP4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 595K Feb 19 09:24 ACR-150-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 3.7G Dec 30 09:32 ACR-150-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 616K Feb 19 09:22 ACR-150-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 3.7G Dec 30 09:35 ACR-150-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 586K Feb 19 09:15 ACR-150-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 15:13 ACR-150-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 602K Feb 19 09:16 ACR-150-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 15:16 ACR-150-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 586K Feb 19 09:17 ACR-150-TP3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.7G Dec 30 09:48 ACR-150-TP3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 604K Feb 19 09:17 ACR-150-TP3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.7G Dec 30 09:51 ACR-150-TP3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 583K Feb 19 09:14 ACR-150-TP4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.3G Dec 30 16:23 ACR-150-TP4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 596K Feb 19 09:16 ACR-150-TP4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.3G Dec 30 16:26 ACR-150-TP4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 594K Feb 19 09:17 ACR-173-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.8G Dec 30 15:30 ACR-173-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 610K Feb 19 09:17 ACR-173-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.7G Dec 30 15:33 ACR-173-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 583K Feb 19 09:13 ACR-173-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 1.8G Dec 30 16:28 ACR-173-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 590K Feb 19 09:13 ACR-173-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 1.8G Dec 30 16:30 ACR-173-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 595K Feb 19 09:18 ACR-173-TP3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.9G Dec 30 14:51 ACR-173-TP3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 614K Feb 19 09:19 ACR-173-TP3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 3.0G Dec 30 14:54 ACR-173-TP3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 597K Feb 19 09:17 ACR-173-TP4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.8G Dec 30 14:06 ACR-173-TP4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 615K Feb 19 09:17 ACR-173-TP4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.8G Dec 30 14:09 ACR-173-TP4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 599K Feb 19 09:22 ACR-186-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 3.4G Dec 30 09:18 ACR-186-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 621K Feb 19 09:23 ACR-186-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 3.5G Dec 30 09:21 ACR-186-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 583K Feb 19 09:18 ACR-186-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.8G Dec 30 08:33 ACR-186-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 610K Feb 19 09:18 ACR-186-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.8G Dec 30 08:35 ACR-186-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 589K Feb 19 09:16 ACR-186-TP3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.4G Dec 30 17:27 ACR-186-TP3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 596K Feb 19 09:17 ACR-186-TP3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.4G Dec 30 17:30 ACR-186-TP3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 590K Feb 19 09:16 ACR-186-TP4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.5G Dec 30 12:21 ACR-186-TP4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 608K Feb 19 09:17 ACR-186-TP4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.4G Dec 30 12:23 ACR-186-TP4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 587K Feb 19 09:25 ACR-225-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.3G Dec 30 14:01 ACR-225-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 606K Feb 19 09:27 ACR-225-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.3G Dec 30 14:03 ACR-225-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 584K Feb 19 09:25 ACR-225-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.1G Dec 30 15:45 ACR-225-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 592K Feb 19 09:26 ACR-225-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.1G Dec 30 15:47 ACR-225-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 595K Feb 19 09:28 ACR-225-TP3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.7G Dec 30 15:07 ACR-225-TP3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 618K Feb 19 09:30 ACR-225-TP3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.7G Dec 30 15:10 ACR-225-TP3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 591K Feb 19 09:29 ACR-225-TP4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.5G Dec 30 11:15 ACR-225-TP4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 615K Feb 19 09:29 ACR-225-TP4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.5G Dec 30 11:18 ACR-225-TP4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 588K Feb 19 09:33 ACR-229-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 3.4G Dec 30 09:54 ACR-229-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 604K Feb 19 09:33 ACR-229-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 3.4G Dec 30 09:57 ACR-229-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 586K Feb 19 09:31 ACR-229-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 3.2G Dec 30 17:57 ACR-229-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 606K Feb 19 09:31 ACR-229-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 3.2G Dec 30 18:00 ACR-229-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 587K Feb 19 09:29 ACR-229-TP3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 14:56 ACR-229-TP3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 606K Feb 19 09:30 ACR-229-TP3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 14:59 ACR-229-TP3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 592K Feb 19 09:29 ACR-229-TP4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.4G Dec 30 13:19 ACR-229-TP4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 607K Feb 19 09:29 ACR-229-TP4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.4G Dec 30 13:21 ACR-229-TP4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 587K Feb 19 09:33 ACR-237-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 08:38 ACR-237-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 608K Feb 19 09:32 ACR-237-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 08:41 ACR-237-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 587K Feb 19 09:32 ACR-237-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 07:56 ACR-237-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 604K Feb 19 09:31 ACR-237-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 07:59 ACR-237-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 586K Feb 19 09:31 ACR-237-TP3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.7G Dec 30 11:31 ACR-237-TP3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 605K Feb 19 09:32 ACR-237-TP3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.7G Dec 30 11:34 ACR-237-TP3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 589K Feb 19 09:31 ACR-237-TP4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.6G Dec 30 12:00 ACR-237-TP4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 605K Feb 19 09:31 ACR-237-TP4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.5G Dec 30 12:03 ACR-237-TP4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 589K Feb 19 09:33 ACR-244-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 3.1G Dec 30 12:51 ACR-244-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 611K Feb 19 09:33 ACR-244-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 3.1G Dec 30 12:54 ACR-244-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 582K Feb 19 09:32 ACR-244-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.7G Dec 30 10:10 ACR-244-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 602K Feb 19 09:33 ACR-244-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.7G Dec 30 10:13 ACR-244-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 582K Feb 19 09:28 ACR-244-TP3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 1.9G Dec 30 17:22 ACR-244-TP3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 588K Feb 19 09:28 ACR-244-TP3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 1.9G Dec 30 17:24 ACR-244-TP3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 589K Feb 19 09:33 ACR-244-TP4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 3.0G Dec 30 10:05 ACR-244-TP4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 606K Feb 19 09:33 ACR-244-TP4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 3.0G Dec 30 10:08 ACR-244-TP4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 582K Feb 19 09:33 ACR-265-TP1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.7G Dec 30 17:00 ACR-265-TP1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 592K Feb 19 09:33 ACR-265-TP1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.7G Dec 30 17:03 ACR-265-TP1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 587K Feb 19 09:32 ACR-265-TP2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.5G Dec 30 13:28 ACR-265-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 606K Feb 19 09:32 ACR-265-TP2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.5G Dec 30 13:30 ACR-265-TP2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 589K Feb 19 09:33 ACR-265-TP3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.5G Dec 30 09:07 ACR-265-TP3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 608K Feb 19 09:33 ACR-265-TP3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.4G Dec 30 09:10 ACR-265-TP3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam 594K Feb 19 09:34 ACR-265-TP4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 2.5G Dec 30 14:35 ACR-265-TP4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 615K Feb 19 09:34 ACR-265-TP4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 2.5G Dec 30 14:38 ACR-265-TP4_R2_001.fastq.gz
-rw-rw-r-- 1 sam sam 1.6K Jan  2 11:08 fastq_pairs.txt
drwxr-xr-x 2 sam sam 4.0K Feb 19 09:34 multiqc_data
-rw-r--r-- 1 sam sam 2.2M Feb 19 09:34 multiqc_report.html</code></pre>
</section>
<section id="references" class="level1">
<h1>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ewels2016" class="csl-entry">
Ewels, Philip, Måns Magnusson, Sverker Lundin, and Max Käller. 2016. “MultiQC: Summarize Analysis Results for Multiple Tools and Samples in a Single Report.” <em>Bioinformatics</em> 32 (19): 3047–48. <a href="https://doi.org/10.1093/bioinformatics/btw354" class="uri">https://doi.org/10.1093/bioinformatics/btw354</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2024</category>
  <category>E5</category>
  <category>timeseries_molecular</category>
  <category>WGBS</category>
  <category>Acropora pulchra</category>
  <category>FastQC</category>
  <category>MultiQC</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-12-31-FastQC-MultiQC---A.pulchra-WGBS-E5-Timeseries/</guid>
  <pubDate>Tue, 31 Dec 2024 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Data Received - Coral E5 WGBS Time Series from Azenta Project 30-1067895835</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-12-30-Data-Received---Coral-E5-WGBS-Time-Series-from-Azenta-Project-30-1067895835/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>We received whole genome bisulfite sequencing (WGBS) data from Azenta project 30-1067895835 as part of the <a href="https://github.com/urol-e5/timeseries_molecular/tree/main">urol-e5/timeseries_molecular project</a> (GitHub repo). All files were downloaded and MD5 checksums were verified. Raw FastQ files are available here:</p>
<ul>
<li>https://owl.fish.washington.edu/nightingales/E5-coral-time-series/30-1067895835/</li>
</ul>
<p>Azenta report (HTML):</p>
<ul>
<li><a href="https://owl.fish.washington.edu/nightingales/E5-coral-time-series/30-1067895835/Azenta_30-1067895835_Data_Report.html">https://owl.fish.washington.edu/nightingales/E5-coral-time-series/30-1067895835/Azenta_30-1067895835_Data_Report.html</a></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Read counts range from 25M - 58M. Normally, a large range like this would be concerning, however, we advised Azenta to go forward with “best effort”, due to some samples failing their initial QC.</p>
</div>
</div>
</section>
<section id="checksum-verification" class="level1">
<h1>CHECKSUM VERIFICATION</h1>
<div id="fig-MD5-01" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="Screenshot of MD5 checksum verifications.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-MD5-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241230-E5-timeseries-WGBS-checksums-01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Screenshot of MD5 checksum verifications."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-12-30-Data-Received---Coral-E5-WGBS-Time-Series-from-Azenta-Project-30-1067895835/20241230-E5-timeseries-WGBS-checksums-01.png" class="img-fluid figure-img" alt="Screenshot of MD5 checksum verifications."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-MD5-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Screenshot of MD5 checksum verifications.
</figcaption>
</figure>
</div>
<div id="fig-MD5-02" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="Screenshot of MD5 checksum verifications.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-MD5-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241230-E5-timeseries-WGBS-checksums-02.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Screenshot of MD5 checksum verifications."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-12-30-Data-Received---Coral-E5-WGBS-Time-Series-from-Azenta-Project-30-1067895835/20241230-E5-timeseries-WGBS-checksums-02.png" class="img-fluid figure-img" alt="Screenshot of MD5 checksum verifications."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-MD5-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Screenshot of MD5 checksum verifications.
</figcaption>
</figure>
</div>
<div id="fig-MD5-03" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="Screenshot of MD5 checksum verifications.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-MD5-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241230-E5-timeseries-WGBS-checksums-03.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: Screenshot of MD5 checksum verifications."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-12-30-Data-Received---Coral-E5-WGBS-Time-Series-from-Azenta-Project-30-1067895835/20241230-E5-timeseries-WGBS-checksums-03.png" class="img-fluid figure-img" alt="Screenshot of MD5 checksum verifications."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-MD5-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Screenshot of MD5 checksum verifications.
</figcaption>
</figure>
</div>
<div id="fig-MD5-04" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="Screenshot of MD5 checksum verifications.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-MD5-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241230-E5-timeseries-WGBS-checksums-04.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;4: Screenshot of MD5 checksum verifications."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-12-30-Data-Received---Coral-E5-WGBS-Time-Series-from-Azenta-Project-30-1067895835/20241230-E5-timeseries-WGBS-checksums-04.png" class="img-fluid figure-img" alt="Screenshot of MD5 checksum verifications."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-MD5-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Screenshot of MD5 checksum verifications.
</figcaption>
</figure>
</div>
<div id="fig-MD5-05" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="Screenshot of MD5 checksum verifications.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-MD5-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241230-E5-timeseries-WGBS-checksums-05.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;5: Screenshot of MD5 checksum verifications."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-12-30-Data-Received---Coral-E5-WGBS-Time-Series-from-Azenta-Project-30-1067895835/20241230-E5-timeseries-WGBS-checksums-05.png" class="img-fluid figure-img" alt="Screenshot of MD5 checksum verifications."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-MD5-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Screenshot of MD5 checksum verifications.
</figcaption>
</figure>
</div>
<div id="fig-MD5-06" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="Screenshot of MD5 checksum verifications.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-MD5-06-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241230-E5-timeseries-WGBS-checksums-06.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;6: Screenshot of MD5 checksum verifications."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-12-30-Data-Received---Coral-E5-WGBS-Time-Series-from-Azenta-Project-30-1067895835/20241230-E5-timeseries-WGBS-checksums-06.png" class="img-fluid figure-img" alt="Screenshot of MD5 checksum verifications."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-MD5-06-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Screenshot of MD5 checksum verifications.
</figcaption>
</figure>
</div>


</section>

 ]]></description>
  <category>2024</category>
  <category>E5</category>
  <category>30-1067895835</category>
  <category>WGBS</category>
  <category>BS-seq</category>
  <category>bisulfite</category>
  <category>Data Received</category>
  <category>timeseries_molecular</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-12-30-Data-Received---Coral-E5-WGBS-Time-Series-from-Azenta-Project-30-1067895835/</guid>
  <pubDate>Mon, 30 Dec 2024 08:00:00 GMT</pubDate>
</item>
</channel>
</rss>
