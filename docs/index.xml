<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Sam&#39;s Notebook</title>
<link>https://robertslab.github.io/sams-notebook/</link>
<atom:link href="https://robertslab.github.io/sams-notebook/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.5.57</generator>
<lastBuildDate>Wed, 06 Nov 2024 08:00:00 GMT</lastBuildDate>
<item>
  <title>Data Wrangling - GO to GOslims for Graces Dermasterias imbricata Project from Trinity Assembly Genes</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-06-Data-Wrangling---GO-to-GOslims-for-Graces-Dermasterias-imbricata-Project-from-Trinity-Assembly-Genes/</link>
  <description><![CDATA[ 





<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This notebook consists of a markdown rendering of <a href="https://github.com/RobertsLab/code/blob/04a796dda0545340146d694964bcf4abdb626a73/r_projects/sam/20241106-dimb-GO-to-GOslim/code/01-GO-to-GOslim.Rmd">01-GO-to-GOslim.Rmd</a> (commit: <code>04a796d</code>).</p>
</div>
</div>
<section id="intro" class="level1">
<h1>1 INTRO</h1>
<p>This notebook is setup to <a href="https://github.com/RobertsLab/resources/issues/2012">take GO IDs and categorize them into their corresponding GOslims</a> (GitHub Issue). Specifically, it will use the following tab-delimited input file:</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/seashell/bu-github/project-pycno-multispecies-2023/output/06-Go-3-species/der_go.tsv">der_go.tsv</a></li>
</ul>
<p><a href="https://github.com/RobertsLab/resources/issues/1989#issuecomment-2448757444">Desired output format</a> (GitHub Issue comment) is:</p>
<pre><code>Term                                                    Count
anatomical structure development                        1137
signaling                                               600
cell differentiation                                    533
immune system process                                   331
lipid metabolic process                                 212</code></pre>
<p>This was performed using R, with the following packages:</p>
<ul>
<li>GSEABase (Martin Morgan 2017)</li>
<li>GO.db (Carlson 2017)</li>
<li>tidyverse (Wickham et al.&nbsp;2019)</li>
</ul>
<p>It also relied on gene ontology (GO) information from the <a href="https://geneontology.org/">Gene Ontology Consortium</a> (Ashburner et al.&nbsp;2000; Aleksander et al.&nbsp;2023).</p>
<section id="code" class="level2">
<h2 class="anchored" data-anchor-id="code">1.1 CODE</h2>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(GSEABase)</span></code></pre></div>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(GO.db)</span></code></pre></div>
<pre><code>## </code></pre>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(knitr)</span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span></code></pre></div>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>opts_chunk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set</span>(</span>
<span id="cb6-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">echo =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display code chunks</span></span>
<span id="cb6-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">eval =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Evaluate code chunks</span></span>
<span id="cb6-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">warning =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hide warnings</span></span>
<span id="cb6-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">message =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hide messages</span></span>
<span id="cb6-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">comment =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prevents appending '##' to beginning of lines in code output</span></span>
<span id="cb6-7">)</span></code></pre></div>
<section id="variables" class="level3">
<h3 class="anchored" data-anchor-id="variables">1.1.1 Variables</h3>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Column names corresponding to gene name/ID and GO IDs</span></span>
<span id="cb7-2">GO.ID.column <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene.Ontology.IDs"</span></span>
<span id="cb7-3">gene.ID.column <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"X1"</span></span>
<span id="cb7-4"></span>
<span id="cb7-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Relative path or URL to input file</span></span>
<span id="cb7-6">input.file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/seashell/bu-github/project-pycno-multispecies-2023/output/06-Go-3-species/der_go.tsv"</span></span>
<span id="cb7-7"></span>
<span id="cb7-8"></span>
<span id="cb7-9"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##### Official GO info - no need to change #####</span></span>
<span id="cb7-10">goslims_obo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"goslim_generic.obo"</span></span>
<span id="cb7-11">goslims_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"http://current.geneontology.org/ontology/subsets/goslim_generic.obo"</span></span></code></pre></div>
</section>
<section id="set-gseabase-location-and-download-goslim_generic.obo" class="level3">
<h3 class="anchored" data-anchor-id="set-gseabase-location-and-download-goslim_generic.obo">1.1.2 Set GSEAbase location and download <code>goslim_generic.obo</code></h3>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Find GSEAbase installation location</span></span>
<span id="cb8-2">gseabase_location <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find.package</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GSEABase"</span>)</span>
<span id="cb8-3"></span>
<span id="cb8-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load path to GOslim OBO file</span></span>
<span id="cb8-5">goslim_obo_destintation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(gseabase_location, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"extdata"</span>, goslims_obo, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fsep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/"</span>)</span>
<span id="cb8-6"></span>
<span id="cb8-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Download the GOslim OBO file</span></span>
<span id="cb8-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">download.file</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">url =</span> goslims_url, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">destfile =</span> goslim_obo_destintation)</span>
<span id="cb8-9"></span>
<span id="cb8-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loads package files</span></span>
<span id="cb8-11">gseabase_files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"extdata"</span>, goslims_obo, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GSEABase"</span>)</span></code></pre></div>
</section>
<section id="read-in-genego-file" class="level3">
<h3 class="anchored" data-anchor-id="read-in-genego-file">1.1.3 Read in gene/GO file</h3>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">full.gene.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> input.file, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb9-2"></span>
<span id="cb9-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(full.gene.df)</span></code></pre></div>
<pre><code>'data.frame':   34254 obs. of  25 variables:
 $ X1                                : chr  "TRINITY_DN37009_c0_g3_i1" "TRINITY_DN37009_c0_g3_i3" "TRINITY_DN37035_c0_g1_i1" "TRINITY_DN37023_c0_g1_i1" ...
 $ X2                                : chr  "sp" "sp" "sp" "sp" ...
 $ X3                                : chr  "Q9BYN0" "Q9BYN0" "P21329" "P07700" ...
 $ X4                                : chr  "SRXN1_HUMAN" "SRXN1_HUMAN" "RTJK_DROFU" "ADRB1_MELGA" ...
 $ X5                                : num  57.6 57.6 28.6 33.3 31.6 ...
 $ X6                                : int  125 125 147 99 133 49 90 179 85 37 ...
 $ X7                                : int  47 47 92 65 87 21 47 105 44 13 ...
 $ X8                                : int  2 2 4 1 3 0 3 7 2 1 ...
 $ X9                                : int  2822 1720 169 47 473 85 15 1 104 102 ...
 $ X10                               : int  2448 1346 579 340 84 231 275 513 343 4 ...
 $ X11                               : int  18 18 613 59 44 374 425 85 64 1097 ...
 $ X12                               : int  136 136 756 157 175 422 509 246 148 1133 ...
 $ X13                               : num  1.11e-39 3.47e-40 4.94e-08 6.59e-09 9.86e-12 ...
 $ X14                               : num  147 147 55.8 55.5 66.6 58.9 49.7 51.6 69.3 46.2 ...
 $ Reviewed                          : chr  "reviewed" "reviewed" NA "reviewed" ...
 $ Entry.Name                        : chr  "SRXN1_HUMAN" "SRXN1_HUMAN" NA "ADRB1_MELGA" ...
 $ Protein.names                     : chr  "Sulfiredoxin-1 (EC 1.8.98.2)" "Sulfiredoxin-1 (EC 1.8.98.2)" NA "Beta-1 adrenergic receptor (Beta-1 adrenoreceptor) (Beta-1 adrenoceptor) (Beta-T)" ...
 $ Gene.Names                        : chr  "SRXN1 C20orf139 SRX SRX1" "SRXN1 C20orf139 SRX SRX1" NA "ADRB1" ...
 $ Organism                          : chr  "Homo sapiens (Human)" "Homo sapiens (Human)" NA "Meleagris gallopavo (Wild turkey)" ...
 $ Length                            : int  137 137 NA 483 483 1056 NA 364 640 1358 ...
 $ Gene.Ontology..biological.process.: chr  "cellular response to oxidative stress [GO:0034599]; response to oxidative stress [GO:0006979]" "cellular response to oxidative stress [GO:0034599]; response to oxidative stress [GO:0006979]" NA "adenylate cyclase-activating adrenergic receptor signaling pathway [GO:0071880]; positive regulation of heart c"| __truncated__ ...
 $ Gene.Ontology..cellular.component.: chr  "cytoplasm [GO:0005737]; cytosol [GO:0005829]; endoplasmic reticulum membrane [GO:0005789]" "cytoplasm [GO:0005737]; cytosol [GO:0005829]; endoplasmic reticulum membrane [GO:0005789]" NA "early endosome [GO:0005769]; membrane [GO:0016020]; plasma membrane [GO:0005886]" ...
 $ Gene.Ontology..GO.                : chr  "cytoplasm [GO:0005737]; cytosol [GO:0005829]; endoplasmic reticulum membrane [GO:0005789]; ATP binding [GO:0005"| __truncated__ "cytoplasm [GO:0005737]; cytosol [GO:0005829]; endoplasmic reticulum membrane [GO:0005789]; ATP binding [GO:0005"| __truncated__ NA "early endosome [GO:0005769]; membrane [GO:0016020]; plasma membrane [GO:0005886]; beta1-adrenergic receptor act"| __truncated__ ...
 $ Gene.Ontology..molecular.function.: chr  "ATP binding [GO:0005524]; oxidoreductase activity, acting on a sulfur group of donors [GO:0016667]; sulfiredoxi"| __truncated__ "ATP binding [GO:0005524]; oxidoreductase activity, acting on a sulfur group of donors [GO:0016667]; sulfiredoxi"| __truncated__ NA "beta1-adrenergic receptor activity [GO:0004940]; identical protein binding [GO:0042802]" ...
 $ Gene.Ontology.IDs                 : chr  "GO:0005524; GO:0005737; GO:0005789; GO:0005829; GO:0006979; GO:0016667; GO:0032542; GO:0034599" "GO:0005524; GO:0005737; GO:0005789; GO:0005829; GO:0006979; GO:0016667; GO:0032542; GO:0034599" NA "GO:0004940; GO:0005769; GO:0005886; GO:0016020; GO:0042802; GO:0045187; GO:0045823; GO:0071880" ...</code></pre>
</section>
<section id="remove-rows-with-na-remove-whitespace-in-go-ids-column-and-keep-just-genego-ids-columns" class="level3">
<h3 class="anchored" data-anchor-id="remove-rows-with-na-remove-whitespace-in-go-ids-column-and-keep-just-genego-ids-columns">1.1.4 Remove rows with NA, remove whitespace in GO IDs column and keep just gene/GO IDs columns</h3>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clean whitespace, filter NA/empty rows, select columns, and split GO terms using column name variables</span></span>
<span id="cb11-2">gene.GO.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> full.gene.df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GO.ID.column :=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(.data[[GO.ID.column]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">s*;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">s*"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clean up spaces around ";"</span></span>
<span id="cb11-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(.data[[gene.ID.column]]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(.data[[GO.ID.column]]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> .data[[GO.ID.column]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb11-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all_of</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(gene.ID.column, GO.ID.column)))</span>
<span id="cb11-6"></span>
<span id="cb11-7"></span>
<span id="cb11-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(gene.GO.df)</span></code></pre></div>
<pre><code>'data.frame':   23192 obs. of  2 variables:
 $ X1               : chr  "TRINITY_DN37009_c0_g3_i1" "TRINITY_DN37009_c0_g3_i3" "TRINITY_DN37023_c0_g1_i1" "TRINITY_DN37023_c1_g1_i1" ...
 $ Gene.Ontology.IDs: chr  "GO:0005524;GO:0005737;GO:0005789;GO:0005829;GO:0006979;GO:0016667;GO:0032542;GO:0034599" "GO:0005524;GO:0005737;GO:0005789;GO:0005829;GO:0006979;GO:0016667;GO:0032542;GO:0034599" "GO:0004940;GO:0005769;GO:0005886;GO:0016020;GO:0042802;GO:0045187;GO:0045823;GO:0071880" "GO:0004940;GO:0005769;GO:0005886;GO:0016020;GO:0042802;GO:0045187;GO:0045823;GO:0071880" ...</code></pre>
</section>
<section id="flatten-gene-and-go-ids" class="level3">
<h3 class="anchored" data-anchor-id="flatten-gene-and-go-ids">1.1.5 “Flatten” gene and GO IDs</h3>
<p>This flattens the file so all of the GO IDs per gene are separated into one GO ID per gene per row.</p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">flat.gene.GO.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene.GO.df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_rows</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sym</span>(GO.ID.column), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)</span>
<span id="cb13-2"></span>
<span id="cb13-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(flat.gene.GO.df)</span></code></pre></div>
<pre><code>tibble [363,990 × 2] (S3: tbl_df/tbl/data.frame)
 $ X1               : chr [1:363990] "TRINITY_DN37009_c0_g3_i1" "TRINITY_DN37009_c0_g3_i1" "TRINITY_DN37009_c0_g3_i1" "TRINITY_DN37009_c0_g3_i1" ...
 $ Gene.Ontology.IDs: chr [1:363990] "GO:0005524" "GO:0005737" "GO:0005789" "GO:0005829" ...</code></pre>
</section>
<section id="group" class="level3">
<h3 class="anchored" data-anchor-id="group">1.1.6 Group</h3>
<p>Groups the genes by GO ID (i.e.&nbsp;lists all genes associated with each unique GO ID)</p>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">grouped.gene.GO.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> flat.gene.GO.df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb15-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sym</span>(GO.ID.column)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb15-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene.ID.column :=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(.data[[gene.ID.column]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>))</span>
<span id="cb15-4"></span>
<span id="cb15-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(grouped.gene.GO.df)</span></code></pre></div>
<pre><code>tibble [15,068 × 2] (S3: tbl_df/tbl/data.frame)
 $ Gene.Ontology.IDs: chr [1:15068] "GO:0000002" "GO:0000009" "GO:0000012" "GO:0000014" ...
 $ X1               : chr [1:15068] "TRINITY_DN12635_c0_g1_i1,TRINITY_DN6578_c1_g1_i2,TRINITY_DN20059_c0_g1_i11,TRINITY_DN20059_c0_g1_i13,TRINITY_DN"| __truncated__ "TRINITY_DN3933_c0_g3_i1" "TRINITY_DN2179_c0_g7_i1,TRINITY_DN2179_c0_g7_i2,TRINITY_DN8923_c0_g2_i1,TRINITY_DN8283_c0_g1_i3,TRINITY_DN8283_"| __truncated__ "TRINITY_DN31365_c0_g1_i1,TRINITY_DN31365_c0_g1_i2,TRINITY_DN53840_c0_g1_i1,TRINITY_DN662_c0_g1_i2,TRINITY_DN149"| __truncated__ ...</code></pre>
</section>
<section id="map-go-ids-to-goslims" class="level3">
<h3 class="anchored" data-anchor-id="map-go-ids-to-goslims">1.1.7 Map GO IDs to GOslims</h3>
<p>The mapping steps were derived from this <a href="https://support.bioconductor.org/p/128407/#128408">bioconductor forum response</a></p>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Vector of GO IDs</span></span>
<span id="cb17-2">go_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> grouped.gene.GO.df[[GO.ID.column]]</span>
<span id="cb17-3"></span>
<span id="cb17-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(go_ids)</span></code></pre></div>
<pre><code> chr [1:15068] "GO:0000002" "GO:0000009" "GO:0000012" "GO:0000014" ...</code></pre>
</section>
<section id="extract-goslims-from-obo" class="level3">
<h3 class="anchored" data-anchor-id="extract-goslims-from-obo">1.1.8 Extract GOslims from OBO</h3>
<p>Creates new OBO Collection object of just GOslims, based on provided GO IDs.</p>
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create GSEAbase GOCollection using `go_ids`</span></span>
<span id="cb19-2">myCollection <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">GOCollection</span>(go_ids)</span>
<span id="cb19-3"></span>
<span id="cb19-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Retrieve GOslims from GO OBO file set</span></span>
<span id="cb19-5">slim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getOBOCollection</span>(gseabase_files)</span>
<span id="cb19-6"></span>
<span id="cb19-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(slim)</span></code></pre></div>
<pre><code>Formal class 'OBOCollection' [package "GSEABase"] with 7 slots
  ..@ .stanza     :'data.frame':    153 obs. of  1 variable:
  .. ..$ value: chr [1:153] "Root" "Term" "Term" "Term" ...
  ..@ .subset     :'data.frame':    22 obs. of  1 variable:
  .. ..$ value: chr [1:22] "Rhea list of ChEBI terms representing the major species at pH 7.3." "Term not to be used for direct annotation" "Terms planned for obsoletion" "AGR slim" ...
  ..@ .kv         :'data.frame':    2075 obs. of  3 variables:
  .. ..$ stanza_id: chr [1:2075] ".__Root__" ".__Root__" ".__Root__" ".__Root__" ...
  .. ..$ key      : chr [1:2075] "format-version" "data-version" "synonymtypedef" "synonymtypedef" ...
  .. ..$ value    : chr [1:2075] "1.2" "go/2024-09-08/subsets/goslim_generic.owl" "syngo_official_label \"label approved by the SynGO project\"" "systematic_synonym \"Systematic synonym\" EXACT" ...
  ..@ evidenceCode: chr [1:26] "EXP" "IDA" "IPI" "IMP" ...
  ..@ ontology    : chr NA
  ..@ ids         : chr [1:141] "GO:0000228" "GO:0000278" "GO:0000910" "GO:0001618" ...
  ..@ type        : chr "OBO"</code></pre>
</section>
<section id="get-biological-process-bp-goslims-associated-with-provided-go-ids." class="level3">
<h3 class="anchored" data-anchor-id="get-biological-process-bp-goslims-associated-with-provided-go-ids.">1.1.9 Get Biological Process (BP) GOslims associated with provided GO IDs.</h3>
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Retrieve Biological Process (BP) GOslims</span></span>
<span id="cb21-2">slimdf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">goSlim</span>(myCollection, slim, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BP"</span>, verbose)</span>
<span id="cb21-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(slimdf)</span></code></pre></div>
<pre><code>'data.frame':   72 obs. of  3 variables:
 $ Count  : int  93 22 18 554 81 107 31 5 103 58 ...
 $ Percent: num  0.925 0.219 0.179 5.508 0.805 ...
 $ Term   : chr  "mitotic cell cycle" "cytokinesis" "cytoplasmic translation" "immune system process" ...</code></pre>
</section>
<section id="map-go-to-goslims" class="level3">
<h3 class="anchored" data-anchor-id="map-go-to-goslims">1.1.10 Map GO to GOslims</h3>
<p>Performs mapping of of GOIDs to GOslims</p>
<p>Returns:</p>
<ul>
<li>GOslim IDs (as rownames)</li>
<li>GOslim terms</li>
<li>Counts of GO IDs matching to corresponding GOslim</li>
<li>Percentage of GO IDs matching to corresponding GOslim</li>
<li>GOIDs mapped to corresponding GOslim, in a semi-colon delimited format</li>
</ul>
<div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># List of GOslims and all GO IDs from `go_ids`</span></span>
<span id="cb23-2">gomap <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.list</span>(GOBPOFFSPRING[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(slimdf)])</span>
<span id="cb23-3"></span>
<span id="cb23-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Maps `go_ids` to matching GOslims</span></span>
<span id="cb23-5">mapped <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(gomap, intersect, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ids</span>(myCollection))</span>
<span id="cb23-6"></span>
<span id="cb23-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Append all mapped GO IDs to `slimdf`</span></span>
<span id="cb23-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># `sapply` needed to apply paste() to create semi-colon delimited values</span></span>
<span id="cb23-9">slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(gomap, intersect, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ids</span>(myCollection)), paste, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)</span>
<span id="cb23-10"></span>
<span id="cb23-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove "character(0) string from "GO.IDs" column</span></span>
<span id="cb23-12">slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs[slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"character(0)"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb23-13"></span>
<span id="cb23-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add self-matching GOIDs to "GO.IDs" column, if not present</span></span>
<span id="cb23-15"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (go_id <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> go_ids) {</span>
<span id="cb23-16">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the go_id is present in the row names</span></span>
<span id="cb23-17">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (go_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(slimdf)) {</span>
<span id="cb23-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the go_id is not present in the GO.IDs column</span></span>
<span id="cb23-19">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Also removes white space "trimws()" and converts all to upper case to handle</span></span>
<span id="cb23-20">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># any weird, "invisible" formatting issues.</span></span>
<span id="cb23-21">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>go_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">trimws</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">toupper</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">strsplit</span>(slimdf[go_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]))) {</span>
<span id="cb23-22">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Append the go_id to the GO.IDs column with a semi-colon separator</span></span>
<span id="cb23-23">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nchar</span>(slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(slimdf)]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb23-24">        slimdf[go_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(slimdf[go_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"; "</span>, go_id)</span>
<span id="cb23-25">      } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb23-26">        slimdf[go_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> go_id</span>
<span id="cb23-27">      }</span>
<span id="cb23-28">    }</span>
<span id="cb23-29">  }</span>
<span id="cb23-30">}</span>
<span id="cb23-31"></span>
<span id="cb23-32"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(slimdf)</span></code></pre></div>
<pre><code>'data.frame':   72 obs. of  4 variables:
 $ Count  : int  93 22 18 554 81 107 31 5 103 58 ...
 $ Percent: num  0.925 0.219 0.179 5.508 0.805 ...
 $ Term   : chr  "mitotic cell cycle" "cytokinesis" "cytoplasmic translation" "immune system process" ...
 $ GO.IDs : chr  "GO:0000022;GO:0000070;GO:0000082;GO:0000086;GO:0000132;GO:0000281;GO:0006977;GO:0007052;GO:0007076;GO:0007079;G"| __truncated__ "GO:0000281;GO:0000911;GO:0000915;GO:0007112;GO:0031991;GO:0032465;GO:0032466;GO:0032467;GO:0032506;GO:0033206;G"| __truncated__ "GO:0001731;GO:0001732;GO:0002183;GO:0002184;GO:0002188;GO:0002190;GO:0002191;GO:0002192;GO:0140018;GO:0140708;G"| __truncated__ "GO:0001768;GO:0001771;GO:0001773;GO:0001774;GO:0001776;GO:0001779;GO:0001780;GO:0001782;GO:0001798;GO:0001805;G"| __truncated__ ...</code></pre>
</section>
<section id="flatten-goslims" class="level3">
<h3 class="anchored" data-anchor-id="flatten-goslims">1.1.11 Flatten GOslims</h3>
<div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "Flatten" file so each row is single GO ID with corresponding GOslim</span></span>
<span id="cb25-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rownames_to_column needed to retain row name info</span></span>
<span id="cb25-3">slimdf_separated <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(slimdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames_to_column</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GOslim'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_rows</span>(GO.IDs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>))</span>
<span id="cb25-6"></span>
<span id="cb25-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Group by unique GO ID</span></span>
<span id="cb25-8">grouped_slimdf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> slimdf_separated <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(GO.IDs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> GO.IDs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(GO.IDs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GOslim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(GOslim, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>),</span>
<span id="cb25-12">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Term =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(Term, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>))</span>
<span id="cb25-13"></span>
<span id="cb25-14"></span>
<span id="cb25-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(grouped_slimdf)</span></code></pre></div>
<pre><code>tibble [6,942 × 3] (S3: tbl_df/tbl/data.frame)
 $ GO.IDs: chr [1:6942] " GO:0000278" " GO:0002181" " GO:0002376" " GO:0003014" ...
 $ GOslim: chr [1:6942] "GO:0000278" "GO:0002181" "GO:0002376" "GO:0003014" ...
 $ Term  : chr [1:6942] "mitotic cell cycle" "cytoplasmic translation" "immune system process" "renal system process" ...</code></pre>
</section>
</section>
<section id="write-slimdf-to-file" class="level2">
<h2 class="anchored" data-anchor-id="write-slimdf-to-file">1.2 Write slimdf to file</h2>
<section id="sort-and-select-slmidf" class="level3">
<h3 class="anchored" data-anchor-id="sort-and-select-slmidf">1.2.1 Sort and select slmidf</h3>
<p>Sorts GOslims by <code>Count</code>, in descending order and then selects just the <code>Term</code> and <code>Count</code> columns.</p>
<div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1">slimdf.sorted <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> slimdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(Count))</span>
<span id="cb27-2"></span>
<span id="cb27-3">slim.count.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> slimdf.sorted <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb27-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(Term, Count)</span>
<span id="cb27-5"></span>
<span id="cb27-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(slim.count.df)</span></code></pre></div>
<pre><code>'data.frame':   72 obs. of  2 variables:
 $ Term : chr  "anatomical structure development" "cell differentiation" "signaling" "immune system process" ...
 $ Count: int  2091 932 908 554 352 306 278 275 264 246 ...</code></pre>
</section>
<section id="write-formatted-slim.count.df-to-file" class="level3">
<h3 class="anchored" data-anchor-id="write-formatted-slim.count.df-to-file">1.2.2 Write formatted slim.count.df to file</h3>
<div class="sourceCode" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_tsv</span>(slim.count.df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/01-GO-to-GOslim/counts.GOID-per-GOslim_term.tab"</span>)</span></code></pre></div>
</section>
</section>
<section id="count-unique-biological-process-go-ids" class="level2">
<h2 class="anchored" data-anchor-id="count-unique-biological-process-go-ids">1.3 Count unique Biological Process GO IDs</h2>
<div class="sourceCode" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Flatten the list and count total GO IDs</span></span>
<span id="cb30-2">total_go_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(gomap))</span>
<span id="cb30-3"></span>
<span id="cb30-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display the total count</span></span>
<span id="cb30-5">total_go_ids</span></code></pre></div>
<pre><code>[1] 26534</code></pre>
<div class="sourceCode" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Unlist to extract all GO IDs, then find unique ones and count them</span></span>
<span id="cb32-2">unique_go_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(gomap))</span>
<span id="cb32-3">total_unique_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(unique_go_ids)</span>
<span id="cb32-4"></span>
<span id="cb32-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display the total count of unique GO IDs</span></span>
<span id="cb32-6">total_unique_ids</span></code></pre></div>
<pre><code>[1] 17913</code></pre>
<p>Total starting BP GO IDs: 26534</p>
<p>Total unique BP GO IDs: 17913</p>
</section>
</section>
<section id="references" class="level1">
<h1>2 REFERENCES</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-thegene2023" class="csl-entry">
Aleksander, Suzi A, James Balhoff, Seth Carbon, J Michael Cherry, Harold J Drabkin, Dustin Ebert, Marc Feuermann, et al.&nbsp;2023. “The Gene Ontology Knowledgebase in 2023.” Edited by A Baryshnikova. <em>GENETICS</em> 224 (1). <a href="https://doi.org/10.1093/genetics/iyad031" class="uri">https://doi.org/10.1093/genetics/iyad031</a>.
</div>
<div id="ref-ashburner2000" class="csl-entry">
Ashburner, Michael, Catherine A. Ball, Judith A. Blake, David Botstein, Heather Butler, J. Michael Cherry, Allan P. Davis, et al.&nbsp;2000. “Gene Ontology: Tool for the Unification of Biology.” <em>Nature Genetics</em> 25 (1): 25–29. <a href="https://doi.org/10.1038/75556" class="uri">https://doi.org/10.1038/75556</a>.
</div>
<div id="ref-carlson2017" class="csl-entry">
Carlson, Marc. 2017. “GO.db.” <a href="https://doi.org/10.18129/B9.BIOC.GO.DB" class="uri">https://doi.org/10.18129/B9.BIOC.GO.DB</a>.
</div>
<div id="ref-martinmorgan2017" class="csl-entry">
Martin Morgan, Seth Falcon. 2017. “GSEABase.” <a href="https://doi.org/10.18129/B9.BIOC.GSEABASE" class="uri">https://doi.org/10.18129/B9.BIOC.GSEABASE</a>.
</div>
<div id="ref-wickham2019" class="csl-entry">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy McGowan, Romain François, Garrett Grolemund, et al.&nbsp;2019. “Welcome to the Tidyverse.” <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686" class="uri">https://doi.org/10.21105/joss.01686</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2024</category>
  <category>Dermasterias imbricata</category>
  <category>GO</category>
  <category>GOslim</category>
  <category>gene ontology</category>
  <category>Trinity</category>
  <category>Leather star</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-06-Data-Wrangling---GO-to-GOslims-for-Graces-Dermasterias-imbricata-Project-from-Trinity-Assembly-Genes/</guid>
  <pubDate>Wed, 06 Nov 2024 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Data Wrangling - GO to GOslims for Graces Pycnopodia helianthoides Project from Trinity Assembly Genes</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-06-Data-Wrangling---GO-to-GOslims-for-Pycnopodia-helianthoides-Project-from-Trinity-Assembly-Genes/</link>
  <description><![CDATA[ 





<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This notebook consists of a markdown rendering of <a href="https://github.com/RobertsLab/code/blob/3b642b455cf0e1bcf3fd77b8f22736b79ce0ade3/r_projects/sam/20241106-phel-GO-to-GOslim/code/01-GO-to-GOslim.Rmd">01-GO-to-GOslim.Rmd</a> (commit: <code>3b642b4</code>).</p>
</div>
</div>
<section id="intro" class="level1">
<h1>1 INTRO</h1>
<p>This notebook is setup to <a href="https://github.com/RobertsLab/resources/issues/2012">take GO IDs and categorize them into their corresponding GOslims</a> (GitHub Issue). Specifically, it will use the following tab-delimited input file:</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/seashell/bu-github/project-pycno-multispecies-2023/output/06-Go-3-species/pyc_go.tsv">pyc_go.tsv</a></li>
</ul>
<p><a href="https://github.com/RobertsLab/resources/issues/1989#issuecomment-2448757444">Desired output format</a> (GitHub Issue comment) is:</p>
<pre><code>Term                                                    Count
anatomical structure development                        1137
signaling                                               600
cell differentiation                                    533
immune system process                                   331
lipid metabolic process                                 212</code></pre>
<p>This was performed using R, with the following packages:</p>
<ul>
<li>GSEABase (Martin Morgan 2017)</li>
<li>GO.db (Carlson 2017)</li>
<li>tidyverse (Wickham et al.&nbsp;2019)</li>
</ul>
<p>It also relied on gene ontology (GO) information from the <a href="https://geneontology.org/">Gene Ontology Consortium</a> (Ashburner et al.&nbsp;2000; Aleksander et al.&nbsp;2023).</p>
<section id="code" class="level2">
<h2 class="anchored" data-anchor-id="code">1.1 CODE</h2>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(GSEABase)</span></code></pre></div>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(GO.db)</span></code></pre></div>
<pre><code>## </code></pre>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(knitr)</span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span></code></pre></div>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>opts_chunk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set</span>(</span>
<span id="cb6-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">echo =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display code chunks</span></span>
<span id="cb6-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">eval =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Evaluate code chunks</span></span>
<span id="cb6-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">warning =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hide warnings</span></span>
<span id="cb6-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">message =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hide messages</span></span>
<span id="cb6-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">comment =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prevents appending '##' to beginning of lines in code output</span></span>
<span id="cb6-7">)</span></code></pre></div>
<section id="variables" class="level3">
<h3 class="anchored" data-anchor-id="variables">1.1.1 Variables</h3>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Column names corresponding to gene name/ID and GO IDs</span></span>
<span id="cb7-2">GO.ID.column <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene.Ontology.IDs"</span></span>
<span id="cb7-3">gene.ID.column <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"X1"</span></span>
<span id="cb7-4"></span>
<span id="cb7-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Relative path or URL to input file</span></span>
<span id="cb7-6">input.file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/seashell/bu-github/project-pycno-multispecies-2023/output/06-Go-3-species/pyc_go.tsv"</span></span>
<span id="cb7-7"></span>
<span id="cb7-8"></span>
<span id="cb7-9"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##### Official GO info - no need to change #####</span></span>
<span id="cb7-10">goslims_obo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"goslim_generic.obo"</span></span>
<span id="cb7-11">goslims_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"http://current.geneontology.org/ontology/subsets/goslim_generic.obo"</span></span></code></pre></div>
</section>
<section id="set-gseabase-location-and-download-goslim_generic.obo" class="level3">
<h3 class="anchored" data-anchor-id="set-gseabase-location-and-download-goslim_generic.obo">1.1.2 Set GSEAbase location and download <code>goslim_generic.obo</code></h3>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Find GSEAbase installation location</span></span>
<span id="cb8-2">gseabase_location <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find.package</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GSEABase"</span>)</span>
<span id="cb8-3"></span>
<span id="cb8-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load path to GOslim OBO file</span></span>
<span id="cb8-5">goslim_obo_destintation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(gseabase_location, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"extdata"</span>, goslims_obo, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fsep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/"</span>)</span>
<span id="cb8-6"></span>
<span id="cb8-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Download the GOslim OBO file</span></span>
<span id="cb8-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">download.file</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">url =</span> goslims_url, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">destfile =</span> goslim_obo_destintation)</span>
<span id="cb8-9"></span>
<span id="cb8-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loads package files</span></span>
<span id="cb8-11">gseabase_files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"extdata"</span>, goslims_obo, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GSEABase"</span>)</span></code></pre></div>
</section>
<section id="read-in-genego-file" class="level3">
<h3 class="anchored" data-anchor-id="read-in-genego-file">1.1.3 Read in gene/GO file</h3>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">full.gene.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> input.file, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb9-2"></span>
<span id="cb9-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(full.gene.df)</span></code></pre></div>
<pre><code>'data.frame':   29145 obs. of  25 variables:
 $ X1                                : chr  "TRINITY_DN37046_c0_g1_i2" "TRINITY_DN37065_c0_g1_i1" "TRINITY_DN37015_c0_g1_i1" "TRINITY_DN45769_c0_g1_i1" ...
 $ X2                                : chr  "sp" "sp" "sp" "sp" ...
 $ X3                                : chr  "Q32NR4" "Q95NT6" "Q9Z0Z4" "Q09575" ...
 $ X4                                : chr  "TTC29_XENLA" "MTH2_DROYA" "HEPH_MOUSE" "YRD6_CAEEL" ...
 $ X5                                : num  36.4 26 47.5 37.2 51.7 ...
 $ X6                                : int  439 231 80 121 58 60 35 88 78 88 ...
 $ X7                                : int  269 155 42 75 28 35 17 59 42 45 ...
 $ X8                                : int  5 8 0 1 0 1 0 1 1 3 ...
 $ X9                                : int  502 688 2 361 12 217 55 86 274 266 ...
 $ X10                               : int  1818 29 241 2 185 38 159 349 41 12 ...
 $ X11                               : int  19 224 38 776 1146 445 297 456 437 34 ...
 $ X12                               : int  447 449 117 896 1203 503 331 542 512 113 ...
 $ X13                               : num  6.37e-79 2.22e-13 3.37e-21 4.39e-25 1.02e-14 ...
 $ X14                               : num  263 75.5 89 102 70.1 55.8 45.8 50.1 62.8 47.8 ...
 $ Reviewed                          : chr  NA NA "reviewed" NA ...
 $ Entry.Name                        : chr  NA NA "HEPH_MOUSE" NA ...
 $ Protein.names                     : chr  NA NA "Hephaestin (Hp) (EC 1.16.3.1)" NA ...
 $ Gene.Names                        : chr  NA NA "Heph Kiaa0698" NA ...
 $ Organism                          : chr  NA NA "Mus musculus (Mouse)" NA ...
 $ Length                            : int  NA NA 1157 NA 2812 NA NA NA 583 NA ...
 $ Gene.Ontology..biological.process.: chr  NA NA "intestinal iron absorption [GO:0160179]; iron ion transport [GO:0006826]; multicellular organismal-level iron i"| __truncated__ NA ...
 $ Gene.Ontology..cellular.component.: chr  NA NA "basolateral plasma membrane [GO:0016323]; extracellular region [GO:0005576]; perinuclear region of cytoplasm [G"| __truncated__ NA ...
 $ Gene.Ontology..GO.                : chr  NA NA "basolateral plasma membrane [GO:0016323]; extracellular region [GO:0005576]; perinuclear region of cytoplasm [G"| __truncated__ NA ...
 $ Gene.Ontology..molecular.function.: chr  NA NA "copper ion binding [GO:0005507]; ferrous iron binding [GO:0008198]; ferroxidase activity [GO:0004322]; oxidored"| __truncated__ NA ...
 $ Gene.Ontology.IDs                 : chr  NA NA "GO:0004322; GO:0005507; GO:0005576; GO:0005886; GO:0006826; GO:0008198; GO:0016323; GO:0016491; GO:0048471; GO:"| __truncated__ NA ...</code></pre>
</section>
<section id="remove-rows-with-na-remove-whitespace-in-go-ids-column-and-keep-just-genego-ids-columns" class="level3">
<h3 class="anchored" data-anchor-id="remove-rows-with-na-remove-whitespace-in-go-ids-column-and-keep-just-genego-ids-columns">1.1.4 Remove rows with NA, remove whitespace in GO IDs column and keep just gene/GO IDs columns</h3>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clean whitespace, filter NA/empty rows, select columns, and split GO terms using column name variables</span></span>
<span id="cb11-2">gene.GO.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> full.gene.df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GO.ID.column :=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(.data[[GO.ID.column]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">s*;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">s*"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clean up spaces around ";"</span></span>
<span id="cb11-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(.data[[gene.ID.column]]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(.data[[GO.ID.column]]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> .data[[GO.ID.column]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb11-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all_of</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(gene.ID.column, GO.ID.column)))</span>
<span id="cb11-6"></span>
<span id="cb11-7"></span>
<span id="cb11-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(gene.GO.df)</span></code></pre></div>
<pre><code>'data.frame':   19842 obs. of  2 variables:
 $ X1               : chr  "TRINITY_DN37015_c0_g1_i1" "TRINITY_DN45794_c0_g1_i1" "TRINITY_DN45764_c0_g1_i1" "TRINITY_DN48070_c0_g1_i1" ...
 $ Gene.Ontology.IDs: chr  "GO:0004322;GO:0005507;GO:0005576;GO:0005886;GO:0006826;GO:0008198;GO:0016323;GO:0016491;GO:0048471;GO:0060586;G"| __truncated__ "GO:0005615;GO:0005886;GO:0007339;GO:0031012;GO:0098609" "GO:0000139;GO:0001736;GO:0001737;GO:0004674;GO:0005615;GO:0005737;GO:0005886;GO:0006468;GO:0007219;GO:0007267;G"| __truncated__ "GO:0005102;GO:0005739;GO:0005777;GO:0005778;GO:0006633;GO:0019166;GO:0033306;GO:0043231" ...</code></pre>
</section>
<section id="flatten-gene-and-go-ids" class="level3">
<h3 class="anchored" data-anchor-id="flatten-gene-and-go-ids">1.1.5 “Flatten” gene and GO IDs</h3>
<p>This flattens the file so all of the GO IDs per gene are separated into one GO ID per gene per row.</p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">flat.gene.GO.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene.GO.df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_rows</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sym</span>(GO.ID.column), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)</span>
<span id="cb13-2"></span>
<span id="cb13-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(flat.gene.GO.df)</span></code></pre></div>
<pre><code>tibble [319,980 × 2] (S3: tbl_df/tbl/data.frame)
 $ X1               : chr [1:319980] "TRINITY_DN37015_c0_g1_i1" "TRINITY_DN37015_c0_g1_i1" "TRINITY_DN37015_c0_g1_i1" "TRINITY_DN37015_c0_g1_i1" ...
 $ Gene.Ontology.IDs: chr [1:319980] "GO:0004322" "GO:0005507" "GO:0005576" "GO:0005886" ...</code></pre>
</section>
<section id="group" class="level3">
<h3 class="anchored" data-anchor-id="group">1.1.6 Group</h3>
<p>Groups the genes by GO ID (i.e.&nbsp;lists all genes associated with each unique GO ID)</p>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">grouped.gene.GO.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> flat.gene.GO.df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb15-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sym</span>(GO.ID.column)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb15-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene.ID.column :=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(.data[[gene.ID.column]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>))</span>
<span id="cb15-4"></span>
<span id="cb15-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(grouped.gene.GO.df)</span></code></pre></div>
<pre><code>tibble [14,922 × 2] (S3: tbl_df/tbl/data.frame)
 $ Gene.Ontology.IDs: chr [1:14922] "GO:0000002" "GO:0000009" "GO:0000011" "GO:0000012" ...
 $ X1               : chr [1:14922] "TRINITY_DN624_c0_g1_i1,TRINITY_DN624_c0_g1_i2,TRINITY_DN678_c0_g1_i1,TRINITY_DN678_c0_g1_i2,TRINITY_DN678_c0_g1"| __truncated__ "TRINITY_DN10071_c0_g4_i1" "TRINITY_DN628_c0_g2_i1,TRINITY_DN9588_c0_g1_i1,TRINITY_DN9588_c0_g1_i5" "TRINITY_DN3105_c1_g1_i3,TRINITY_DN4630_c0_g1_i2,TRINITY_DN4630_c0_g1_i4,TRINITY_DN4630_c0_g1_i5,TRINITY_DN8346_"| __truncated__ ...</code></pre>
</section>
<section id="map-go-ids-to-goslims" class="level3">
<h3 class="anchored" data-anchor-id="map-go-ids-to-goslims">1.1.7 Map GO IDs to GOslims</h3>
<p>The mapping steps were derived from this <a href="https://support.bioconductor.org/p/128407/#128408">bioconductor forum response</a></p>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Vector of GO IDs</span></span>
<span id="cb17-2">go_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> grouped.gene.GO.df[[GO.ID.column]]</span>
<span id="cb17-3"></span>
<span id="cb17-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(go_ids)</span></code></pre></div>
<pre><code> chr [1:14922] "GO:0000002" "GO:0000009" "GO:0000011" "GO:0000012" ...</code></pre>
</section>
<section id="extract-goslims-from-obo" class="level3">
<h3 class="anchored" data-anchor-id="extract-goslims-from-obo">1.1.8 Extract GOslims from OBO</h3>
<p>Creates new OBO Collection object of just GOslims, based on provided GO IDs.</p>
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create GSEAbase GOCollection using `go_ids`</span></span>
<span id="cb19-2">myCollection <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">GOCollection</span>(go_ids)</span>
<span id="cb19-3"></span>
<span id="cb19-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Retrieve GOslims from GO OBO file set</span></span>
<span id="cb19-5">slim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getOBOCollection</span>(gseabase_files)</span>
<span id="cb19-6"></span>
<span id="cb19-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(slim)</span></code></pre></div>
<pre><code>Formal class 'OBOCollection' [package "GSEABase"] with 7 slots
  ..@ .stanza     :'data.frame':    153 obs. of  1 variable:
  .. ..$ value: chr [1:153] "Root" "Term" "Term" "Term" ...
  ..@ .subset     :'data.frame':    22 obs. of  1 variable:
  .. ..$ value: chr [1:22] "Rhea list of ChEBI terms representing the major species at pH 7.3." "Term not to be used for direct annotation" "Terms planned for obsoletion" "AGR slim" ...
  ..@ .kv         :'data.frame':    2075 obs. of  3 variables:
  .. ..$ stanza_id: chr [1:2075] ".__Root__" ".__Root__" ".__Root__" ".__Root__" ...
  .. ..$ key      : chr [1:2075] "format-version" "data-version" "synonymtypedef" "synonymtypedef" ...
  .. ..$ value    : chr [1:2075] "1.2" "go/2024-09-08/subsets/goslim_generic.owl" "syngo_official_label \"label approved by the SynGO project\"" "systematic_synonym \"Systematic synonym\" EXACT" ...
  ..@ evidenceCode: chr [1:26] "EXP" "IDA" "IPI" "IMP" ...
  ..@ ontology    : chr NA
  ..@ ids         : chr [1:141] "GO:0000228" "GO:0000278" "GO:0000910" "GO:0001618" ...
  ..@ type        : chr "OBO"</code></pre>
</section>
<section id="get-biological-process-bp-goslims-associated-with-provided-go-ids." class="level3">
<h3 class="anchored" data-anchor-id="get-biological-process-bp-goslims-associated-with-provided-go-ids.">1.1.9 Get Biological Process (BP) GOslims associated with provided GO IDs.</h3>
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Retrieve Biological Process (BP) GOslims</span></span>
<span id="cb21-2">slimdf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">goSlim</span>(myCollection, slim, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BP"</span>, verbose)</span>
<span id="cb21-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(slimdf)</span></code></pre></div>
<pre><code>'data.frame':   72 obs. of  3 variables:
 $ Count  : int  102 23 17 533 83 107 28 5 96 60 ...
 $ Percent: num  1.016 0.229 0.169 5.308 0.827 ...
 $ Term   : chr  "mitotic cell cycle" "cytokinesis" "cytoplasmic translation" "immune system process" ...</code></pre>
</section>
<section id="map-go-to-goslims" class="level3">
<h3 class="anchored" data-anchor-id="map-go-to-goslims">1.1.10 Map GO to GOslims</h3>
<p>Performs mapping of of GOIDs to GOslims</p>
<p>Returns:</p>
<ul>
<li>GOslim IDs (as rownames)</li>
<li>GOslim terms</li>
<li>Counts of GO IDs matching to corresponding GOslim</li>
<li>Percentage of GO IDs matching to corresponding GOslim</li>
<li>GOIDs mapped to corresponding GOslim, in a semi-colon delimited format</li>
</ul>
<div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># List of GOslims and all GO IDs from `go_ids`</span></span>
<span id="cb23-2">gomap <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.list</span>(GOBPOFFSPRING[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(slimdf)])</span>
<span id="cb23-3"></span>
<span id="cb23-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Maps `go_ids` to matching GOslims</span></span>
<span id="cb23-5">mapped <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(gomap, intersect, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ids</span>(myCollection))</span>
<span id="cb23-6"></span>
<span id="cb23-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Append all mapped GO IDs to `slimdf`</span></span>
<span id="cb23-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># `sapply` needed to apply paste() to create semi-colon delimited values</span></span>
<span id="cb23-9">slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(gomap, intersect, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ids</span>(myCollection)), paste, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)</span>
<span id="cb23-10"></span>
<span id="cb23-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove "character(0) string from "GO.IDs" column</span></span>
<span id="cb23-12">slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs[slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"character(0)"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb23-13"></span>
<span id="cb23-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add self-matching GOIDs to "GO.IDs" column, if not present</span></span>
<span id="cb23-15"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (go_id <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> go_ids) {</span>
<span id="cb23-16">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the go_id is present in the row names</span></span>
<span id="cb23-17">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (go_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(slimdf)) {</span>
<span id="cb23-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the go_id is not present in the GO.IDs column</span></span>
<span id="cb23-19">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Also removes white space "trimws()" and converts all to upper case to handle</span></span>
<span id="cb23-20">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># any weird, "invisible" formatting issues.</span></span>
<span id="cb23-21">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>go_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">trimws</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">toupper</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">strsplit</span>(slimdf[go_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]))) {</span>
<span id="cb23-22">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Append the go_id to the GO.IDs column with a semi-colon separator</span></span>
<span id="cb23-23">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nchar</span>(slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(slimdf)]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb23-24">        slimdf[go_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(slimdf[go_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"; "</span>, go_id)</span>
<span id="cb23-25">      } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb23-26">        slimdf[go_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> go_id</span>
<span id="cb23-27">      }</span>
<span id="cb23-28">    }</span>
<span id="cb23-29">  }</span>
<span id="cb23-30">}</span>
<span id="cb23-31"></span>
<span id="cb23-32"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(slimdf)</span></code></pre></div>
<pre><code>'data.frame':   72 obs. of  4 variables:
 $ Count  : int  102 23 17 533 83 107 28 5 96 60 ...
 $ Percent: num  1.016 0.229 0.169 5.308 0.827 ...
 $ Term   : chr  "mitotic cell cycle" "cytokinesis" "cytoplasmic translation" "immune system process" ...
 $ GO.IDs : chr  "GO:0000022;GO:0000070;GO:0000082;GO:0000086;GO:0000132;GO:0000281;GO:0000282;GO:0001100;GO:0006977;GO:0007052;G"| __truncated__ "GO:0000281;GO:0000282;GO:0000911;GO:0000915;GO:0000917;GO:0007111;GO:0032465;GO:0032466;GO:0032467;GO:0032506;G"| __truncated__ "GO:0001731;GO:0001732;GO:0002182;GO:0002183;GO:0002190;GO:0002191;GO:0002192;GO:0140018;GO:0140708;GO:1903679;G"| __truncated__ "GO:0001771;GO:0001773;GO:0001774;GO:0001776;GO:0001777;GO:0001779;GO:0001780;GO:0001782;GO:0001805;GO:0001812;G"| __truncated__ ...</code></pre>
</section>
<section id="flatten-goslims" class="level3">
<h3 class="anchored" data-anchor-id="flatten-goslims">1.1.11 Flatten GOslims</h3>
<div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "Flatten" file so each row is single GO ID with corresponding GOslim</span></span>
<span id="cb25-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rownames_to_column needed to retain row name info</span></span>
<span id="cb25-3">slimdf_separated <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(slimdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames_to_column</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GOslim'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_rows</span>(GO.IDs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>))</span>
<span id="cb25-6"></span>
<span id="cb25-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Group by unique GO ID</span></span>
<span id="cb25-8">grouped_slimdf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> slimdf_separated <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(GO.IDs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> GO.IDs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(GO.IDs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GOslim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(GOslim, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>),</span>
<span id="cb25-12">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Term =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(Term, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>))</span>
<span id="cb25-13"></span>
<span id="cb25-14"></span>
<span id="cb25-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(grouped_slimdf)</span></code></pre></div>
<pre><code>tibble [6,903 × 3] (S3: tbl_df/tbl/data.frame)
 $ GO.IDs: chr [1:6903] " GO:0000278" " GO:0002181" " GO:0002376" " GO:0003014" ...
 $ GOslim: chr [1:6903] "GO:0000278" "GO:0002181" "GO:0002376" "GO:0003014" ...
 $ Term  : chr [1:6903] "mitotic cell cycle" "cytoplasmic translation" "immune system process" "renal system process" ...</code></pre>
</section>
</section>
<section id="write-slimdf-to-file" class="level2">
<h2 class="anchored" data-anchor-id="write-slimdf-to-file">1.2 Write slimdf to file</h2>
<section id="sort-and-select-slmidf" class="level3">
<h3 class="anchored" data-anchor-id="sort-and-select-slmidf">1.2.1 Sort and select slmidf</h3>
<p>Sorts GOslims by <code>Count</code>, in descending order and then selects just the <code>Term</code> and <code>Count</code> columns.</p>
<div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1">slimdf.sorted <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> slimdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(Count))</span>
<span id="cb27-2"></span>
<span id="cb27-3">slim.count.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> slimdf.sorted <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb27-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(Term, Count)</span>
<span id="cb27-5"></span>
<span id="cb27-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(slim.count.df)</span></code></pre></div>
<pre><code>'data.frame':   72 obs. of  2 variables:
 $ Term : chr  "anatomical structure development" "cell differentiation" "signaling" "immune system process" ...
 $ Count: int  2120 941 925 533 331 316 268 267 253 244 ...</code></pre>
</section>
<section id="write-formatted-slim.count.df-to-file" class="level3">
<h3 class="anchored" data-anchor-id="write-formatted-slim.count.df-to-file">1.2.2 Write formatted slim.count.df to file</h3>
<div class="sourceCode" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_tsv</span>(slim.count.df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/01-GO-to-GOslim/counts.GOID-per-GOslim_term.tab"</span>)</span></code></pre></div>
</section>
</section>
<section id="count-unique-biological-process-go-ids" class="level2">
<h2 class="anchored" data-anchor-id="count-unique-biological-process-go-ids">1.3 Count unique Biological Process GO IDs</h2>
<div class="sourceCode" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Flatten the list and count total GO IDs</span></span>
<span id="cb30-2">total_go_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(gomap))</span>
<span id="cb30-3"></span>
<span id="cb30-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display the total count</span></span>
<span id="cb30-5">total_go_ids</span></code></pre></div>
<pre><code>[1] 26534</code></pre>
<div class="sourceCode" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Unlist to extract all GO IDs, then find unique ones and count them</span></span>
<span id="cb32-2">unique_go_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(gomap))</span>
<span id="cb32-3">total_unique_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(unique_go_ids)</span>
<span id="cb32-4"></span>
<span id="cb32-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display the total count of unique GO IDs</span></span>
<span id="cb32-6">total_unique_ids</span></code></pre></div>
<pre><code>[1] 17913</code></pre>
<p>Total starting BP GO IDs: 26534</p>
<p>Total unique BP GO IDs: 17913</p>
</section>
</section>
<section id="references" class="level1">
<h1>2 REFERENCES</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-thegene2023" class="csl-entry">
Aleksander, Suzi A, James Balhoff, Seth Carbon, J Michael Cherry, Harold J Drabkin, Dustin Ebert, Marc Feuermann, et al.&nbsp;2023. “The Gene Ontology Knowledgebase in 2023.” Edited by A Baryshnikova. <em>GENETICS</em> 224 (1). <a href="https://doi.org/10.1093/genetics/iyad031" class="uri">https://doi.org/10.1093/genetics/iyad031</a>.
</div>
<div id="ref-ashburner2000" class="csl-entry">
Ashburner, Michael, Catherine A. Ball, Judith A. Blake, David Botstein, Heather Butler, J. Michael Cherry, Allan P. Davis, et al.&nbsp;2000. “Gene Ontology: Tool for the Unification of Biology.” <em>Nature Genetics</em> 25 (1): 25–29. <a href="https://doi.org/10.1038/75556" class="uri">https://doi.org/10.1038/75556</a>.
</div>
<div id="ref-carlson2017" class="csl-entry">
Carlson, Marc. 2017. “GO.db.” <a href="https://doi.org/10.18129/B9.BIOC.GO.DB" class="uri">https://doi.org/10.18129/B9.BIOC.GO.DB</a>.
</div>
<div id="ref-martinmorgan2017" class="csl-entry">
Martin Morgan, Seth Falcon. 2017. “GSEABase.” <a href="https://doi.org/10.18129/B9.BIOC.GSEABASE" class="uri">https://doi.org/10.18129/B9.BIOC.GSEABASE</a>.
</div>
<div id="ref-wickham2019" class="csl-entry">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy McGowan, Romain François, Garrett Grolemund, et al.&nbsp;2019. “Welcome to the Tidyverse.” <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686" class="uri">https://doi.org/10.21105/joss.01686</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2024</category>
  <category>GO</category>
  <category>gene ontology</category>
  <category>GOslim</category>
  <category>Pycnopodia helianthoides</category>
  <category>Trinity</category>
  <category>Sunflower sea star</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-06-Data-Wrangling---GO-to-GOslims-for-Pycnopodia-helianthoides-Project-from-Trinity-Assembly-Genes/</guid>
  <pubDate>Wed, 06 Nov 2024 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Sequencing Read Taxonomic Classification - Unmapped P.helanthoides RNA-seq Using DIAMOND-BLASTx and MEGAN6 on Mox</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-05-Sequencing-Read-Taxonomic-Classification---Unmapped-P.helanthoides-RNA-seq-Using-DIAMOND-BLASTx-and-MEGAN6-on-Mox/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>In preparation for a grant proposal involving sea star wasting disease, due in about two weeks, Steven <a href="https://github.com/RobertsLab/resources/issues/2009">asked that I perform taxonomic classification on unmapped P.helanthoides RNA-seq reads</a> (GitHub Issue). Due to time constraints, and a bit of luck, I opted to run this on Mox (Mox <em>should</em> have been decommissioned on 11/1/2024, but it’s still running and being able to use Mox, which is already set up, instead of resorting to Klone, was much faster to get this going). Also, due to time constraints, Steven <a href="https://github.com/RobertsLab/resources/issues/2009#issuecomment-2457459109">suggested I run this on just a single set of reads</a> (GitHub Issue comment). I opted for the following, since this analysis had already been started and was already working on these:</p>
<ul>
<li><code>PSC-0519_unmapped_reads.[12].fastq</code></li>
</ul>
</section>
<section id="sbatch-script" class="level1">
<h1>SBATCH SCRIPT</h1>
<p>GitHub:</p>
<ul>
<li><a href="https://github.com/RobertsLab/sams-notebook/blob/master/sbatch_scripts/20241105-phel-diamond-meganizer.sh">20241105-phel-diamond-meganizer.sh</a></li>
</ul>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Job Name</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --job-name=20241105-phel-diamond-meganizer</span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Allocation Definition</span></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --account=srlab</span></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --partition=srlab</span></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Resources</span></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Nodes</span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --nodes=1</span></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Walltime (days-hours:minutes:seconds format)</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --time=7-00:00:00</span></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Memory per node</span></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mem=120G</span></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##turn on e-mail notification</span></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-type=ALL</span></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-user=samwhite@uw.edu</span></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Specify the working directory for this job</span></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --chdir=/gscratch/scrubbed/samwhite/outputs/20241105-phel-diamond-meganizer</span></span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Perform DIAMOND BLASTx on unmapped P.helanthoides RNA-seq files from Steven.</span></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Will be used to view taxonomic breakdown of sequencing reads.</span></span>
<span id="cb1-22"></span>
<span id="cb1-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Expects input FastQ files to be match this pattern: *reads.[12].fastq</span></span>
<span id="cb1-24"></span>
<span id="cb1-25"></span>
<span id="cb1-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################</span></span>
<span id="cb1-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># These variables need to be set by user</span></span>
<span id="cb1-28"></span>
<span id="cb1-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Assign Variables</span></span>
<span id="cb1-30"></span>
<span id="cb1-31"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_pattern</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'*reads.[12].fastq'</span></span>
<span id="cb1-32"></span>
<span id="cb1-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Program paths</span></span>
<span id="cb1-34"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">diamond</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/gscratch/srlab/programs/diamond-v2.1.1/diamond</span>
<span id="cb1-35"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">meganizer</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/gscratch/srlab/programs/MEGAN-6.22.0/tools/daa-meganizer</span>
<span id="cb1-36"></span>
<span id="cb1-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># DIAMOND NCBI nr database</span></span>
<span id="cb1-38"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dmnd_db</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/gscratch/srlab/blastdbs/20230215-ncbi-nr/20230215-ncbi-nr.dmnd</span>
<span id="cb1-39"></span>
<span id="cb1-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># MEGAN mapping files</span></span>
<span id="cb1-41"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">megan_mapping_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/gscratch/srlab/sam/data/databases/MEGAN</span>
<span id="cb1-42"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">megan_mapdb</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${megan_mapping_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/megan-map-Feb2022.db"</span></span>
<span id="cb1-43"></span>
<span id="cb1-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># FastQ files directory</span></span>
<span id="cb1-45"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/gscratch/scrubbed/samwhite/data/P_helianthoides/RNAseq</span>
<span id="cb1-46"></span>
<span id="cb1-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># CPU threads</span></span>
<span id="cb1-48"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">threads</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>40</span>
<span id="cb1-49"></span>
<span id="cb1-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># MEGAN memory limit</span></span>
<span id="cb1-51"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mem_limit</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>100G</span>
<span id="cb1-52"></span>
<span id="cb1-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Programs associative array</span></span>
<span id="cb1-54"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">declare</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span></span>
<span id="cb1-55"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb1-56"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>diamond<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${diamond}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-57"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">meganizer</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${meganizer}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-58"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-59"></span>
<span id="cb1-60"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################################</span></span>
<span id="cb1-61"></span>
<span id="cb1-62"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Exit script if any command fails</span></span>
<span id="cb1-63"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span></span>
<span id="cb1-64"></span>
<span id="cb1-65"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load Python Mox module for Python module availability</span></span>
<span id="cb1-66"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load intel-python3_2017</span>
<span id="cb1-67"></span>
<span id="cb1-68"></span>
<span id="cb1-69"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop through FastQ files, log filenames to fastq_list.txt.</span></span>
<span id="cb1-70"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run DIAMOND on each FastQ, followed by "MEGANization"</span></span>
<span id="cb1-71"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># DO NOT QUOTE ${fastq_pattern}</span></span>
<span id="cb1-72"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_pattern}</span></span>
<span id="cb1-73"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb1-74">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Log input FastQs</span></span>
<span id="cb1-75">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-76">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Generating MD5 checksum for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">..."</span></span>
<span id="cb1-77">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--append</span> input_fastqs-checksums.md5</span>
<span id="cb1-78">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-79"></span>
<span id="cb1-80">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Strip leading path ${fastq##*/} by eliminating all text up to and including last slash from the left side.</span></span>
<span id="cb1-81">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Strip extensions by eliminating ".fastq.gz" from the right side.</span></span>
<span id="cb1-82">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">no_path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-83">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">no_ext</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${no_path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>.fastq<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-84"></span>
<span id="cb1-85">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run DIAMOND with blastx</span></span>
<span id="cb1-86">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output format 100 produces a DAA binary file for use with MEGAN</span></span>
<span id="cb1-87">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Running DIAMOND BLASTx on </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">."</span></span>
<span id="cb1-88">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-89">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>diamond<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> blastx <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-90">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--db</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${dmnd_db}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--query</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--out</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${no_ext}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.blastx.meganized.daa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-93">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--outfmt</span> 100 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--top</span> 5 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-95">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--block-size</span> 15.0 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-96">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--index-chunks</span> 4 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-97">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--memory-limit</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${mem_limit}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-98">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--threads</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span></span>
<span id="cb1-99">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DIAMOND BLASTx on </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> complete: </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${no_ext}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.blastx.meganized.daa"</span></span>
<span id="cb1-100">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-101"></span>
<span id="cb1-102">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Meganize DAA files</span></span>
<span id="cb1-103">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Used for ability to import into MEGAN6</span></span>
<span id="cb1-104">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Now MEGANizing </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${no_ext}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.blastx.meganized.daa"</span></span>
<span id="cb1-105">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>meganizer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${no_ext}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.blastx.meganized.daa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-107">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--threads</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-108">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--mapDB</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${megan_mapdb}</span></span>
<span id="cb1-109">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MEGANization of </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${no_ext}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.blastx.meganized.daa completed."</span></span>
<span id="cb1-110">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-111"></span>
<span id="cb1-112"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb1-113"></span>
<span id="cb1-114"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate MD5 checksums</span></span>
<span id="cb1-115"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb1-116"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb1-117">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-118">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Generating MD5 checksums for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:"</span></span>
<span id="cb1-119">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--append</span> checksums.md5</span>
<span id="cb1-120">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-121"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb1-122"></span>
<span id="cb1-123"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate checksum for MEGAN database(s)</span></span>
<span id="cb1-124"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-125">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${megan_mapdb}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-126">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${dmnd_db}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-127"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> checksums.md5</span>
<span id="cb1-128"></span>
<span id="cb1-129"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#######################################################################################################</span></span>
<span id="cb1-130"></span>
<span id="cb1-131"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Capture program options</span></span>
<span id="cb1-132"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-gt</span> 0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb1-133">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Logging program options..."</span></span>
<span id="cb1-134">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> program <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-135">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb1-136">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-137">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Program options for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">: "</span></span>
<span id="cb1-138">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-139">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle samtools help menus</span></span>
<span id="cb1-140">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_index"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-141">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_sort"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-142">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_view"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]]</span></span>
<span id="cb1-143">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb1-144">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-145"></span>
<span id="cb1-146">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle DIAMOND BLAST menu</span></span>
<span id="cb1-147">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"diamond"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb1-148">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> help</span>
<span id="cb1-149"></span>
<span id="cb1-150">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle NCBI BLASTx menu</span></span>
<span id="cb1-151">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blastx"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb1-152">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-help</span></span>
<span id="cb1-153">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb1-154">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-h</span></span>
<span id="cb1-155">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-156">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-157">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"----------------------------------------------"</span></span>
<span id="cb1-158">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-159">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-160">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&gt;&gt;</span> program_options.log <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb1-161"></span>
<span id="cb1-162">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If MultiQC is in programs_array, copy the config file to this directory.</span></span>
<span id="cb1-163">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"multiqc"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb1-164">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cp</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--preserve</span> ~/.multiqc_config.yaml multiqc_config.yaml</span>
<span id="cb1-165">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb1-166">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb1-167">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Finished logging programs options."</span></span>
<span id="cb1-168">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-169"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb1-170"></span>
<span id="cb1-171"></span>
<span id="cb1-172"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Document programs in PATH (primarily for program version ID)</span></span>
<span id="cb1-173"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Logging system </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$PATH</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">..."</span></span>
<span id="cb1-174"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-175"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">date</span></span>
<span id="cb1-176"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-177"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"System PATH for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$SLURM_JOB_ID</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-178"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-179"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%0.s-"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">..</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-180"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${PATH}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tr</span> : <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\\</span>n</span>
<span id="cb1-181"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> system_path.log</span>
<span id="cb1-182"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Finished logging system </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$PATH</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">."</span></span></code></pre></div>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>


</section>

 ]]></description>
  <category>2024</category>
  <category>MEGAN6</category>
  <category>RNAseq</category>
  <category>DIAMOND</category>
  <category>BLASTx</category>
  <category>Pycnopodia helianthoides</category>
  <category>sunflower sea star</category>
  <category>Mox</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-05-Sequencing-Read-Taxonomic-Classification---Unmapped-P.helanthoides-RNA-seq-Using-DIAMOND-BLASTx-and-MEGAN6-on-Mox/</guid>
  <pubDate>Tue, 05 Nov 2024 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Data Received - Manila clam Supplemental sRNA-seq Data from Azenta</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-01-Data-Received---Manila-clam-Supplemental-sRNA-seq-Data-from-Azenta/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>Received supplemental sRNA-seq data for Azenta Project 30-1035633055, since the <a href="../../../posts/2024/2024-10-01-Data-Received---R.philippinarum-(Manilla-clam)-sRNA-seq-Data-from-Azenta-Project-30-1035633055/index.html">previous data sent</a> (Notebook) didn’t amount to the minimum expected read count for a number of samples. Azenta agreed to perform additional sequencing to reach that threshold.</p>
<p>Data was downloaded to:</p>
<p>https://owl.fish.washington.edu/nightingales/R_philippinarum/30-1035633055-TS01/</p>
<p>MD5 checksums were verified:</p>
<div id="fig-ladder" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="Screenshot showing successful MD5 checksum verifications.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241101-rphi-md5-checksums-screenshot.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Screenshot showing successful MD5 checksum verifications."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-11-01-Data-Received---Manila-clam-Supplemental-sRNA-seq-Data-from-Azenta/20241101-rphi-md5-checksums-screenshot.png" class="img-fluid figure-img" alt="Screenshot showing successful MD5 checksum verifications."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Screenshot showing successful MD5 checksum verifications.
</figcaption>
</figure>
</div>
<p>Since it appears that there is sequencing data for <em>all</em> samples, it probably make sense to concatenate this supplemental data to the initial run, but I’ll check with Steven before doing so.</p>


</section>

 ]]></description>
  <category>2024</category>
  <category>sRNA-seq</category>
  <category>Manila clam</category>
  <category>Ruditapes philippinarum</category>
  <category>30-1035633055</category>
  <category>30-1035633055-TS01</category>
  <category>Data Received</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-01-Data-Received---Manila-clam-Supplemental-sRNA-seq-Data-from-Azenta/</guid>
  <pubDate>Fri, 01 Nov 2024 07:00:00 GMT</pubDate>
  <media:content url="https://robertslab.github.io/sams-notebook/posts/2024/2024-11-01-Data-Received---Manila-clam-Supplemental-sRNA-seq-Data-from-Azenta/20241101-rphi-md5-checksums-screenshot.png" medium="image" type="image/png" height="118" width="144"/>
</item>
<item>
  <title>Data Received - Mytilus trossulus WGBS Data from Psomagen</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-01-Data-Received---Mytilus-trossulus-WGBS-Data-from-Psomagen/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>Received WGBS data for Chris’ Psomagen Project AN00021156.</p>
<p>Data was downloaded to:</p>
<p>https://owl.fish.washington.edu/nightingales/M_trossulus/</p>
<p>MD5 checksums were verified:</p>
<div id="fig-ladder" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="Screenshot showing successful MD5 checksum verifications.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241101-mtro-md5sum-check-screenshot.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Screenshot showing successful MD5 checksum verifications."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-11-01-Data-Received---Mytilus-trossulus-WGBS-Data-from-Psomagen/20241101-mtro-md5sum-check-screenshot.png" class="img-fluid figure-img" alt="Screenshot showing successful MD5 checksum verifications."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Screenshot showing successful MD5 checksum verifications.
</figcaption>
</figure>
</div>


</section>

 ]]></description>
  <category>2024</category>
  <category>Mytilus trossulus</category>
  <category>bay mussel</category>
  <category>WGBS</category>
  <category>Psomagen</category>
  <category>AN00021156</category>
  <category>BS-seq</category>
  <category>bisulfite sequencing</category>
  <category>Data Received</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-01-Data-Received---Mytilus-trossulus-WGBS-Data-from-Psomagen/</guid>
  <pubDate>Fri, 01 Nov 2024 07:00:00 GMT</pubDate>
</item>
<item>
  <title>Daily Bits - November 2024</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-01-Daily-Bits---November-2024/</link>
  <description><![CDATA[ 





<section id="section" class="level1">

<section id="miscellaneous" class="level2">

<ul>
<li><a href="https://github.com/RobertsLab/resources/issues/2002">Installed RepeatMasker on Raven</a> (GitHub Issue). Installed with <code>dfam38_full.0.h5</code> repeats partition/database. Deatils on the database here: https://github.com/Dfam-consortium/FamDB. This was a lengthy procees. Glad its done!</li>
</ul>
</section>
<section id="science-hour" class="level2">

<ul>
<li>Downloaded Chris’s <a href="https://en.wikipedia.org/wiki/Mytilus_trossulus"><em>Mytilus trossulus</em> (bay mussel)</a> WGBS data from Psomagen.</li>
</ul>


</section>
</section>

 ]]></description>
  <category>2024</category>
  <category>Daily Bits</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-01-Daily-Bits---November-2024/</guid>
  <pubDate>Fri, 01 Nov 2024 07:00:00 GMT</pubDate>
</item>
<item>
  <title>Data Wrangling - Get GOslims from GO IDs for Graces Pycnopodia helianthoides Project</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-30-Data-Wrangling---Get-GOslims-from-GO-IDs-for-Graces-Pycnopodia-helianthoides-Project/</link>
  <description><![CDATA[ 





<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This notebook consists of a markdown rendering of <a href="https://github.com/RobertsLab/code/blob/351b2ad5a31fac96f48da84c76955cab2c506d28/r_projects/sam/20241030-phel-GO-to-GOslim/code/01-GO-to-GOslim.Rmd">01-GO-to-GOslim.Rmd</a> (commit: <code>351b2ad</code>).</p>
</div>
</div>
<section id="intro" class="level1">
<h1>1 INTRO</h1>
<p>This notebook is setup to <a href="https://github.com/RobertsLab/resources/issues/1989">take GO IDs and categorize them into their corresponding GOslims</a> (GitHub Issue). Specifically, it will use the following tab-delimited input file:</p>
<ul>
<li><a href="https://raw.githubusercontent.com/grace-ac/paper-pycno-sswd-2021-2022/d1cdf13c36085868df4ef4b75d2b7de03ef08d1c/analyses/25-compare-2021-2022/DEGlist_same_2021-2022_forGOslim.tab">DEGlist_same_2021-2022_forGOslim.tab</a> (commit: <code>d1cdf13</code>)</li>
</ul>
<p><a href="https://github.com/RobertsLab/resources/issues/1989#issuecomment-2448757444">Desired output format</a> (GitHub Issue comment) is:</p>
<pre><code>Term                                                    Count
anatomical structure development                        1137
signaling                                               600
cell differentiation                                    533
immune system process                                   331
lipid metabolic process                                 212</code></pre>
<p>This was performed using R, with the following packages:</p>
<ul>
<li>GSEABase (Martin Morgan 2017)</li>
<li>GO.db (Carlson 2017)</li>
<li>tidyverse (Wickham et al.&nbsp;2019)</li>
</ul>
<p>It also relied on gene ontology (GO) information from the <a href="https://geneontology.org/">Gene Ontology Consortium</a> (Ashburner et al.&nbsp;2000; Aleksander et al.&nbsp;2023).</p>
<section id="code" class="level2">
<h2 class="anchored" data-anchor-id="code">1.1 CODE</h2>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(GSEABase)</span></code></pre></div>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(GO.db)</span></code></pre></div>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(knitr)</span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span></code></pre></div>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>opts_chunk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set</span>(</span>
<span id="cb5-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">echo =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display code chunks</span></span>
<span id="cb5-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">eval =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Evaluate code chunks</span></span>
<span id="cb5-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">warning =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hide warnings</span></span>
<span id="cb5-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">message =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hide messages</span></span>
<span id="cb5-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">comment =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prevents appending '##' to beginning of lines in code output</span></span>
<span id="cb5-7">)</span></code></pre></div>
<section id="variables" class="level3">
<h3 class="anchored" data-anchor-id="variables">1.1.1 Variables</h3>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Column names corresponding to gene name/ID and GO IDs</span></span>
<span id="cb6-2">GO.ID.column <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene.Ontology.IDs"</span></span>
<span id="cb6-3">gene.ID.column <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span></span>
<span id="cb6-4"></span>
<span id="cb6-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Relative path or URL to input file</span></span>
<span id="cb6-6">input.file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/grace-ac/paper-pycno-sswd-2021-2022/d1cdf13c36085868df4ef4b75d2b7de03ef08d1c/analyses/25-compare-2021-2022/DEGlist_same_2021-2022_forGOslim.tab"</span></span>
<span id="cb6-7"></span>
<span id="cb6-8"></span>
<span id="cb6-9"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##### Official GO info - no need to change #####</span></span>
<span id="cb6-10">goslims_obo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"goslim_generic.obo"</span></span>
<span id="cb6-11">goslims_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"http://current.geneontology.org/ontology/subsets/goslim_generic.obo"</span></span></code></pre></div>
</section>
<section id="set-gseabase-location-and-download-goslim_generic.obo" class="level3">
<h3 class="anchored" data-anchor-id="set-gseabase-location-and-download-goslim_generic.obo">1.1.2 Set GSEAbase location and download <code>goslim_generic.obo</code></h3>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Find GSEAbase installation location</span></span>
<span id="cb7-2">gseabase_location <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find.package</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GSEABase"</span>)</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load path to GOslim OBO file</span></span>
<span id="cb7-5">goslim_obo_destintation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(gseabase_location, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"extdata"</span>, goslims_obo, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fsep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/"</span>)</span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Download the GOslim OBO file</span></span>
<span id="cb7-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">download.file</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">url =</span> goslims_url, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">destfile =</span> goslim_obo_destintation)</span>
<span id="cb7-9"></span>
<span id="cb7-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loads package files</span></span>
<span id="cb7-11">gseabase_files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"extdata"</span>, goslims_obo, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GSEABase"</span>)</span></code></pre></div>
</section>
<section id="read-in-genego-file" class="level3">
<h3 class="anchored" data-anchor-id="read-in-genego-file">1.1.3 Read in gene/GO file</h3>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">full.gene.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> input.file, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb8-2"></span>
<span id="cb8-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(full.gene.df)</span></code></pre></div>
<pre><code>'data.frame':   4114 obs. of  3 variables:
 $ gene_id          : chr  "g21712" "g21713" "g15181" "g15182" ...
 $ uniprot_accession: chr  "P54985" "Q8TDM6" NA NA ...
 $ Gene.Ontology.IDs: chr  "GO:0003755; GO:0005737; GO:0006457; GO:0043231" "GO:0001837; GO:0005737; GO:0005886; GO:0005912; GO:0007165; GO:0008013; GO:0008092; GO:0008285; GO:0014069; GO:"| __truncated__ NA NA ...</code></pre>
</section>
<section id="remove-rows-with-na-remove-whitespace-in-go-ids-column-and-keep-just-genego-ids-columns" class="level3">
<h3 class="anchored" data-anchor-id="remove-rows-with-na-remove-whitespace-in-go-ids-column-and-keep-just-genego-ids-columns">1.1.4 Remove rows with NA, remove whitespace in GO IDs column and keep just gene/GO IDs columns</h3>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clean whitespace, filter NA/empty rows, select columns, and split GO terms using column name variables</span></span>
<span id="cb10-2">gene.GO.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> full.gene.df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GO.ID.column :=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(.data[[GO.ID.column]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">s*;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">s*"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clean up spaces around ";"</span></span>
<span id="cb10-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(.data[[gene.ID.column]]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(.data[[GO.ID.column]]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> .data[[GO.ID.column]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb10-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all_of</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(gene.ID.column, GO.ID.column)))</span>
<span id="cb10-6"></span>
<span id="cb10-7"></span>
<span id="cb10-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(gene.GO.df)</span></code></pre></div>
<pre><code>'data.frame':   3295 obs. of  2 variables:
 $ gene_id          : chr  "g21712" "g21713" "g15183" "g7651" ...
 $ Gene.Ontology.IDs: chr  "GO:0003755;GO:0005737;GO:0006457;GO:0043231" "GO:0001837;GO:0005737;GO:0005886;GO:0005912;GO:0007165;GO:0008013;GO:0008092;GO:0008285;GO:0014069;GO:0030011;G"| __truncated__ "GO:0000785;GO:0000978;GO:0000981;GO:0001228;GO:0001657;GO:0001701;GO:0001706;GO:0001707;GO:0003140;GO:0003180;G"| __truncated__ "GO:0005543;GO:0005737;GO:0005768;GO:0005829;GO:0005886;GO:0006897;GO:0007010;GO:0007015;GO:0030100;GO:0030659;G"| __truncated__ ...</code></pre>
</section>
<section id="flatten-gene-and-go-ids" class="level3">
<h3 class="anchored" data-anchor-id="flatten-gene-and-go-ids">1.1.5 “Flatten” gene and GO IDs</h3>
<p>This flattens the file so all of the GO IDs per gene are separated into one GO ID per gene per row.</p>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">flat.gene.GO.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene.GO.df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_rows</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sym</span>(GO.ID.column), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)</span>
<span id="cb12-2"></span>
<span id="cb12-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(flat.gene.GO.df)</span></code></pre></div>
<pre><code>tibble [42,028 × 2] (S3: tbl_df/tbl/data.frame)
 $ gene_id          : chr [1:42028] "g21712" "g21712" "g21712" "g21712" ...
 $ Gene.Ontology.IDs: chr [1:42028] "GO:0003755" "GO:0005737" "GO:0006457" "GO:0043231" ...</code></pre>
</section>
<section id="group" class="level3">
<h3 class="anchored" data-anchor-id="group">1.1.6 Group</h3>
<p>Groups the genes by GO ID (i.e.&nbsp;lists all genes associated with each unique GO ID)</p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">grouped.gene.GO.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> flat.gene.GO.df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sym</span>(GO.ID.column)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene.ID.column :=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(.data[[gene.ID.column]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>))</span>
<span id="cb14-4"></span>
<span id="cb14-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(grouped.gene.GO.df)</span></code></pre></div>
<pre><code>tibble [8,666 × 2] (S3: tbl_df/tbl/data.frame)
 $ Gene.Ontology.IDs: chr [1:8666] "GO:0000012" "GO:0000014" "GO:0000015" "GO:0000025" ...
 $ gene_id          : chr [1:8666] "g22030,g22031,g16480,g4241" "g13422,g21327" "g12040" "g9214" ...</code></pre>
</section>
<section id="map-go-ids-to-goslims" class="level3">
<h3 class="anchored" data-anchor-id="map-go-ids-to-goslims">1.1.7 Map GO IDs to GOslims</h3>
<p>The mapping steps were derived from this <a href="https://support.bioconductor.org/p/128407/#128408">bioconductor forum response</a></p>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Vector of GO IDs</span></span>
<span id="cb16-2">go_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> grouped.gene.GO.df[[GO.ID.column]]</span>
<span id="cb16-3"></span>
<span id="cb16-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(go_ids)</span></code></pre></div>
<pre><code> chr [1:8666] "GO:0000012" "GO:0000014" "GO:0000015" "GO:0000025" ...</code></pre>
</section>
<section id="extract-goslims-from-obo" class="level3">
<h3 class="anchored" data-anchor-id="extract-goslims-from-obo">1.1.8 Extract GOslims from OBO</h3>
<p>Creates new OBO Collection object of just GOslims, based on provided GO IDs.</p>
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create GSEAbase GOCollection using `go_ids`</span></span>
<span id="cb18-2">myCollection <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">GOCollection</span>(go_ids)</span>
<span id="cb18-3"></span>
<span id="cb18-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Retrieve GOslims from GO OBO file set</span></span>
<span id="cb18-5">slim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getOBOCollection</span>(gseabase_files)</span>
<span id="cb18-6"></span>
<span id="cb18-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(slim)</span></code></pre></div>
<pre><code>Formal class 'OBOCollection' [package "GSEABase"] with 7 slots
  ..@ .stanza     :'data.frame':    153 obs. of  1 variable:
  .. ..$ value: chr [1:153] "Root" "Term" "Term" "Term" ...
  ..@ .subset     :'data.frame':    22 obs. of  1 variable:
  .. ..$ value: chr [1:22] "Rhea list of ChEBI terms representing the major species at pH 7.3." "Term not to be used for direct annotation" "Terms planned for obsoletion" "AGR slim" ...
  ..@ .kv         :'data.frame':    2075 obs. of  3 variables:
  .. ..$ stanza_id: chr [1:2075] ".__Root__" ".__Root__" ".__Root__" ".__Root__" ...
  .. ..$ key      : chr [1:2075] "format-version" "data-version" "synonymtypedef" "synonymtypedef" ...
  .. ..$ value    : chr [1:2075] "1.2" "go/2024-09-08/subsets/goslim_generic.owl" "syngo_official_label \"label approved by the SynGO project\"" "systematic_synonym \"Systematic synonym\" EXACT" ...
  ..@ evidenceCode: chr [1:26] "EXP" "IDA" "IPI" "IMP" ...
  ..@ ontology    : chr NA
  ..@ ids         : chr [1:141] "GO:0000228" "GO:0000278" "GO:0000910" "GO:0001618" ...
  ..@ type        : chr "OBO"</code></pre>
</section>
<section id="get-biological-process-bp-goslims-associated-with-provided-go-ids." class="level3">
<h3 class="anchored" data-anchor-id="get-biological-process-bp-goslims-associated-with-provided-go-ids.">1.1.9 Get Biological Process (BP) GOslims associated with provided GO IDs.</h3>
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Retrieve Biological Process (BP) GOslims</span></span>
<span id="cb20-2">slimdf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">goSlim</span>(myCollection, slim, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BP"</span>, verbose)</span>
<span id="cb20-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(slimdf)</span></code></pre></div>
<pre><code>'data.frame':   72 obs. of  3 variables:
 $ Count  : int  45 12 8 331 37 51 13 3 58 38 ...
 $ Percent: num  0.793 0.211 0.141 5.834 0.652 ...
 $ Term   : chr  "mitotic cell cycle" "cytokinesis" "cytoplasmic translation" "immune system process" ...</code></pre>
</section>
<section id="map-go-to-goslims" class="level3">
<h3 class="anchored" data-anchor-id="map-go-to-goslims">1.1.10 Map GO to GOslims</h3>
<p>Performs mapping of of GOIDs to GOslims</p>
<p>Returns:</p>
<ul>
<li>GOslim IDs (as rownames)</li>
<li>GOslim terms</li>
<li>Counts of GO IDs matching to corresponding GOslim</li>
<li>Percentage of GO IDs matching to corresponding GOslim</li>
<li>GOIDs mapped to corresponding GOslim, in a semi-colon delimited format</li>
</ul>
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># List of GOslims and all GO IDs from `go_ids`</span></span>
<span id="cb22-2">gomap <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.list</span>(GOBPOFFSPRING[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(slimdf)])</span>
<span id="cb22-3"></span>
<span id="cb22-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Maps `go_ids` to matching GOslims</span></span>
<span id="cb22-5">mapped <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(gomap, intersect, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ids</span>(myCollection))</span>
<span id="cb22-6"></span>
<span id="cb22-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Append all mapped GO IDs to `slimdf`</span></span>
<span id="cb22-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># `sapply` needed to apply paste() to create semi-colon delimited values</span></span>
<span id="cb22-9">slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(gomap, intersect, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ids</span>(myCollection)), paste, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)</span>
<span id="cb22-10"></span>
<span id="cb22-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove "character(0) string from "GO.IDs" column</span></span>
<span id="cb22-12">slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs[slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"character(0)"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb22-13"></span>
<span id="cb22-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add self-matching GOIDs to "GO.IDs" column, if not present</span></span>
<span id="cb22-15"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (go_id <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> go_ids) {</span>
<span id="cb22-16">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the go_id is present in the row names</span></span>
<span id="cb22-17">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (go_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(slimdf)) {</span>
<span id="cb22-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the go_id is not present in the GO.IDs column</span></span>
<span id="cb22-19">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Also removes white space "trimws()" and converts all to upper case to handle</span></span>
<span id="cb22-20">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># any weird, "invisible" formatting issues.</span></span>
<span id="cb22-21">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>go_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">trimws</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">toupper</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">strsplit</span>(slimdf[go_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]))) {</span>
<span id="cb22-22">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Append the go_id to the GO.IDs column with a semi-colon separator</span></span>
<span id="cb22-23">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nchar</span>(slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(slimdf)]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb22-24">        slimdf[go_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(slimdf[go_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"; "</span>, go_id)</span>
<span id="cb22-25">      } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb22-26">        slimdf[go_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> go_id</span>
<span id="cb22-27">      }</span>
<span id="cb22-28">    }</span>
<span id="cb22-29">  }</span>
<span id="cb22-30">}</span>
<span id="cb22-31"></span>
<span id="cb22-32"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(slimdf)</span></code></pre></div>
<pre><code>'data.frame':   72 obs. of  4 variables:
 $ Count  : int  45 12 8 331 37 51 13 3 58 38 ...
 $ Percent: num  0.793 0.211 0.141 5.834 0.652 ...
 $ Term   : chr  "mitotic cell cycle" "cytokinesis" "cytoplasmic translation" "immune system process" ...
 $ GO.IDs : chr  "GO:0000070;GO:0000082;GO:0000086;GO:0000132;GO:0000281;GO:0006977;GO:0007052;GO:0007076;GO:0007079;GO:0007080;G"| __truncated__ "GO:0000281;GO:0000915;GO:0000917;GO:0031991;GO:0032465;GO:0032467;GO:0036089;GO:0040038;GO:0061640;GO:0061952;G"| __truncated__ "GO:0001731;GO:0001732;GO:0002183;GO:1901194;GO:1903679;GO:2000765;GO:2000767; GO:0002181" "GO:0001771;GO:0001774;GO:0001776;GO:0001779;GO:0001782;GO:0001865;GO:0001867;GO:0001913;GO:0001916;GO:0001922;G"| __truncated__ ...</code></pre>
</section>
<section id="flatten-goslims" class="level3">
<h3 class="anchored" data-anchor-id="flatten-goslims">1.1.11 Flatten GOslims</h3>
<div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "Flatten" file so each row is single GO ID with corresponding GOslim</span></span>
<span id="cb24-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rownames_to_column needed to retain row name info</span></span>
<span id="cb24-3">slimdf_separated <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(slimdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames_to_column</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GOslim'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_rows</span>(GO.IDs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>))</span>
<span id="cb24-6"></span>
<span id="cb24-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Group by unique GO ID</span></span>
<span id="cb24-8">grouped_slimdf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> slimdf_separated <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(GO.IDs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> GO.IDs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(GO.IDs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GOslim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(GOslim, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>),</span>
<span id="cb24-12">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Term =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(Term, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>))</span>
<span id="cb24-13"></span>
<span id="cb24-14"></span>
<span id="cb24-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(grouped_slimdf)</span></code></pre></div>
<pre><code>tibble [3,968 × 3] (S3: tbl_df/tbl/data.frame)
 $ GO.IDs: chr [1:3968] " GO:0000278" " GO:0002181" " GO:0002376" " GO:0003014" ...
 $ GOslim: chr [1:3968] "GO:0000278" "GO:0002181" "GO:0002376" "GO:0003014" ...
 $ Term  : chr [1:3968] "mitotic cell cycle" "cytoplasmic translation" "immune system process" "renal system process" ...</code></pre>
</section>
</section>
<section id="write-slimdf-to-file" class="level2">
<h2 class="anchored" data-anchor-id="write-slimdf-to-file">1.2 Write slimdf to file</h2>
<section id="sort-and-select-slmidf" class="level3">
<h3 class="anchored" data-anchor-id="sort-and-select-slmidf">1.2.1 Sort and select slmidf</h3>
<p>Sorts GOslims by <code>Count</code>, in descending order and then selects just the <code>Term</code> and <code>Count</code> columns.</p>
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1">slimdf.sorted <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> slimdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(Count))</span>
<span id="cb26-2"></span>
<span id="cb26-3">slim.count.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> slimdf.sorted <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb26-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(Term, Count)</span>
<span id="cb26-5"></span>
<span id="cb26-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(slim.count.df)</span></code></pre></div>
<pre><code>'data.frame':   72 obs. of  2 variables:
 $ Term : chr  "anatomical structure development" "signaling" "cell differentiation" "immune system process" ...
 $ Count: int  1137 600 533 331 212 164 158 158 148 123 ...</code></pre>
</section>
<section id="write-formatted-slim.count.df-to-file" class="level3">
<h3 class="anchored" data-anchor-id="write-formatted-slim.count.df-to-file">1.2.2 Write formatted slim.count.df to file</h3>
<div class="sourceCode" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_tsv</span>(slim.count.df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/01-GO-to-GOslim/counts.GOID-per-GOslim_term.tab"</span>)</span></code></pre></div>
</section>
</section>
<section id="count-unique-biological-process-go-ids" class="level2">
<h2 class="anchored" data-anchor-id="count-unique-biological-process-go-ids">1.3 Count unique Biological Process GO IDs</h2>
<div class="sourceCode" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Flatten the list and count total GO IDs</span></span>
<span id="cb29-2">total_go_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(gomap))</span>
<span id="cb29-3"></span>
<span id="cb29-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display the total count</span></span>
<span id="cb29-5">total_go_ids</span></code></pre></div>
<pre><code>[1] 26534</code></pre>
<div class="sourceCode" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Unlist to extract all GO IDs, then find unique ones and count them</span></span>
<span id="cb31-2">unique_go_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(gomap))</span>
<span id="cb31-3">total_unique_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(unique_go_ids)</span>
<span id="cb31-4"></span>
<span id="cb31-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display the total count of unique GO IDs</span></span>
<span id="cb31-6">total_unique_ids</span></code></pre></div>
<pre><code>[1] 17913</code></pre>
<p>Total starting BP GO IDs: 26534</p>
<p>Total unique BP GO IDs: 17913</p>
</section>
</section>
<section id="references" class="level1">
<h1>2 REFERENCES</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-thegene2023" class="csl-entry">
Aleksander, Suzi A, James Balhoff, Seth Carbon, J Michael Cherry, Harold J Drabkin, Dustin Ebert, Marc Feuermann, et al.&nbsp;2023. “The Gene Ontology Knowledgebase in 2023.” Edited by A Baryshnikova. <em>GENETICS</em> 224 (1). <a href="https://doi.org/10.1093/genetics/iyad031" class="uri">https://doi.org/10.1093/genetics/iyad031</a>.
</div>
<div id="ref-ashburner2000" class="csl-entry">
Ashburner, Michael, Catherine A. Ball, Judith A. Blake, David Botstein, Heather Butler, J. Michael Cherry, Allan P. Davis, et al.&nbsp;2000. “Gene Ontology: Tool for the Unification of Biology.” <em>Nature Genetics</em> 25 (1): 25–29. <a href="https://doi.org/10.1038/75556" class="uri">https://doi.org/10.1038/75556</a>.
</div>
<div id="ref-carlson2017" class="csl-entry">
Carlson, Marc. 2017. “GO.db.” <a href="https://doi.org/10.18129/B9.BIOC.GO.DB" class="uri">https://doi.org/10.18129/B9.BIOC.GO.DB</a>.
</div>
<div id="ref-martinmorgan2017" class="csl-entry">
Martin Morgan, Seth Falcon. 2017. “GSEABase.” <a href="https://doi.org/10.18129/B9.BIOC.GSEABASE" class="uri">https://doi.org/10.18129/B9.BIOC.GSEABASE</a>.
</div>
<div id="ref-wickham2019" class="csl-entry">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy McGowan, Romain François, Garrett Grolemund, et al.&nbsp;2019. “Welcome to the Tidyverse.” <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686" class="uri">https://doi.org/10.21105/joss.01686</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2024</category>
  <category>Pycnopodia helianthoides</category>
  <category>sunflower sea star</category>
  <category>gene ontology</category>
  <category>GO</category>
  <category>GOslim</category>
  <category>data wrangling</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-30-Data-Wrangling---Get-GOslims-from-GO-IDs-for-Graces-Pycnopodia-helianthoides-Project/</guid>
  <pubDate>Wed, 30 Oct 2024 07:00:00 GMT</pubDate>
</item>
<item>
  <title>DNA Isolation Quantification and Gel - Lake Trout Liver Samples</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-25-DNA-Isolation-Quantification-and-Gel---Lake-Trout-Liver-Samples/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>Steven asked that I <a href="https://github.com/RobertsLab/resources/issues/1981">isolate gDNA from a subset of lake trout (<em>S.namaycush</em>) liver samples</a> (GitHub Issue).</p>
</section>
<section id="methods" class="level1">
<h1>METHODS</h1>
<section id="dna-isolation" class="level2">
<h2 class="anchored" data-anchor-id="dna-isolation">DNA Isolation</h2>
<p>DNA was isolated using the Quick-DNA Miniprep Kit (ZymoResearch), according to the manufacturer’s protocol - including the recommended addition of beta-mercaptoethanol to the lysis buffer. Liver tissues had been stored @ -20<sup>o</sup>C in RNALater (Ambion). I thawed the tubes, transferred the entire liver tissue (which was very small) to a disposable mortar/pestle combo (1.5mL tube) and homogenized. DNA was eventually eluted with 50uL of Elution Buffer.</p>
<p>Subsequently, DNA was quantified using the 1x dsDNA Broad Range Qubit Assay (ThermoFisher). One microliter of sample was combined with 199uL of the dye/buffer mix and measured on a Qubit 3.0.</p>
<p>DNA was stored in a box labelled “Lake Trout Liver gDNA” in the FTR 209 -20<sup>o</sup>C freezer.</p>
</section>
<section id="agarose-gel" class="level2">
<h2 class="anchored" data-anchor-id="agarose-gel">Agarose gel</h2>
<p>Approximately 0.1uL of each sample was run an a 0.8% low-TAE agarose gel, stained with ethidium bromide. Sample volumes were mixed with 10uL of H<sub>2</sub>O and 2uL of <a href="https://www.thermofisher.com/order/catalog/product/R0631">6x Orange DNA Loading Dye (Thermo Scientific)</a>.</p>
<p>The gel was run @ 107V for ~45mins and then imaged.</p>
<p><a href="https://www.fishersci.se/shop/products/fermentas-o-generuler-ready-to-use-dna-ladder-mix/11803983">O’GeneRuler DNA Ladder Mix, Ready-to-Use 100-10,00bp (Thermo Scientific)</a> was used (5uL) for size reference:</p>
<div id="fig-ladder" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="O'GeneRuler">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="../../../images/ogene-ruler.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Ladder"><img src="https://robertslab.github.io/sams-notebook/images/ogene-ruler.jpeg" class="img-fluid figure-img" alt="O'GeneRuler"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Ladder
</figcaption>
</figure>
</div>
</section>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<section id="qubit-data" class="level2">
<h2 class="anchored" data-anchor-id="qubit-data">Qubit data</h2>
<ul>
<li><a href="./20241025-snam-qubit-DNA.br-liver">20241025-snam-qubit-DNA.br-liver</a></li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th>sample_ID</th>
<th>Original sample conc. (ng/uL)</th>
<th>yield(ng)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>FA046</td>
<td>224</td>
<td>8960</td>
</tr>
<tr class="even">
<td>FA047</td>
<td>984</td>
<td>39360</td>
</tr>
<tr class="odd">
<td>FA048</td>
<td>1180</td>
<td>47200</td>
</tr>
<tr class="even">
<td>FA049</td>
<td>584</td>
<td>23360</td>
</tr>
<tr class="odd">
<td>FA050</td>
<td>185</td>
<td>7400</td>
</tr>
<tr class="even">
<td>FA051</td>
<td>990</td>
<td>39600</td>
</tr>
<tr class="odd">
<td>FA055</td>
<td>770</td>
<td>30800</td>
</tr>
<tr class="even">
<td>FA056</td>
<td>792</td>
<td>31680</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Yield calculation is based on a total sample volume of 40uL. This is likely a conservative volume estimation for each sample, so the total yield is likely a bit higher for each.</p>
</div>
</div>
</section>
<section id="agarose-gel-1" class="level2">
<h2 class="anchored" data-anchor-id="agarose-gel-1">Agarose Gel</h2>
<p>Samples were loaded in numerical order, left to right.</p>
<p>Samples FA47 and FA48 have the most prominent bands, but faint bands are visible in all the other lanes (you may need to squint, LOL). Low visibility of bands is most likely due to the inaccuracy involved with attempting to pipette 0.1uL using a P10 pipette… All bands are high molecular weight and don’t show any evidence of degradation (smearing).</p>
<div id="fig-ladder" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="Agarose gel showing high molecular weight bands for most samples. Those lacking visible bands are likely due to the inaccuracy in pipetting 0.1uL.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241025-snam-liver-gDNA-gel.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Agarose gel showing high molecular weight bands for most samples. Those lacking visible bands are likely due to the inaccuracy in pipetting 0.1uL."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-10-25-DNA-Isolation-Quantification-and-Gel---Lake-Trout-Liver-Samples/20241025-snam-liver-gDNA-gel.jpg" class="img-fluid figure-img" alt="Agarose gel showing high molecular weight bands for most samples. Those lacking visible bands are likely due to the inaccuracy in pipetting 0.1uL."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Agarose gel showing high molecular weight bands for most samples. Those lacking visible bands are likely due to the inaccuracy in pipetting 0.1uL.
</figcaption>
</figure>
</div>


</section>
</section>

 ]]></description>
  <category>2024</category>
  <category>DNA isolation</category>
  <category>Qubit</category>
  <category>DNA quantification</category>
  <category>agarose gel</category>
  <category>lake trout</category>
  <category>Salvelinus namaycush</category>
  <category>liver</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-25-DNA-Isolation-Quantification-and-Gel---Lake-Trout-Liver-Samples/</guid>
  <pubDate>Fri, 25 Oct 2024 07:00:00 GMT</pubDate>
  <media:content url="https://robertslab.github.io/sams-notebook/posts/2024/2024-10-25-DNA-Isolation-Quantification-and-Gel---Lake-Trout-Liver-Samples/20241025-snam-liver-gDNA-gel.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Reverse Transcription - C.gigas Lifestage Carryover RNA</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-24-Reverse-Transcription---C.gigas-Lifestage-Carryover-RNA/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>Continuing with <a href="https://github.com/RobertsLab/resources/issues/1891">Ariana’s request to extract RNA and run qPCRs</a> (GitHub Issue) for the <a href="https://github.com/RobertsLab/project-gigas-carryover/tree/main/lifestage_carryover"><code>lifestage_carryover</code> project</a> (GitHub repo), I performed reverse transcription on RNA I previously isolated:</p>
<ul>
<li><a href="../../../posts/2024/2024-06-17-RNA-Quantification---C.gigas-RNA-Lifestage-Carryover-from-20240615-and-20240617/index.html">20240615 and 20240617</a> (Notebook)</li>
<li><a href="../../../posts/2024/2024-06-18-RNA-Isolation-and-Quantification---C.gigas-Lifestage-Carryover-Seed-Juvenile-and-Adult/index.html">20240618</a> (Notebook)</li>
<li><a href="../../../posts/2024/2024-07-01-RNA-Isolation-and-Quantification---C.gigas-Lifestage-Carryover-Seed-Juvenile-and-Adult/index.html">20240701</a> (Notebook)</li>
</ul>
</section>
<section id="materials-methods" class="level1">
<h1>MATERIALS &amp; METHODS</h1>
<p>Reverse transcription was performed using the <a href="https://github.com/RobertsLab/resources/blob/master/protocols/Commercial_Protocols/Promega-goscript-reverse-transcription-system-protocol.pdf">GoScript Reverse Transcription System (Promega)</a> (PDF), using oligo dT primers and 1.5mM MgCl<sub>2</sub>. The reaction size was doubled, from 20uL to 40uL, to allow for sufficient cDNA for all the downstream qPCRs we plan to perform. The optional RNasin was also used. Reactions were set up in a 96-well, low profile qPCR plate. Plate was sealed with strip caps. The reverse transcriptase components were prepared as a master mix and then distributed to RNA/oligo dT mixtures.</p>
<p>I used 200ng of RNA in most reactions, but there were a number of samples which had insufficient RNA to accommodate that amount. In those instances, the maximum <em>volume</em> of RNA which fit into the reaction volume was used (i.e.&nbsp;9uL of RNA). Those samples, and the actual quantity of RNA used for each, are listed below:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>sample</th>
<th>RNA in RT Rxn (ng)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>213</td>
<td>43.2</td>
</tr>
<tr class="even">
<td>227</td>
<td>43.2</td>
</tr>
<tr class="odd">
<td>231</td>
<td>166.5</td>
</tr>
<tr class="even">
<td>238</td>
<td>171</td>
</tr>
<tr class="odd">
<td>287</td>
<td>139.5</td>
</tr>
<tr class="even">
<td>371</td>
<td>59.04</td>
</tr>
</tbody>
</table>
<p>Briefly, here is how the reactions were setup:</p>
<ol type="1">
<li>Combined RNA (200ng), oligo dT primers, and H<sub>2</sub>O to a final volume of 10uL.</li>
<li>Incubated plate at 70<sup>o</sup>C for 5mins and immediately chilled plate in ice water for 5mins.</li>
<li>Added 30uL of RT reaction master mix to each sample.</li>
<li>Incubated plate at 25<sup>o</sup>C for 5mins.</li>
<li>Incubated plate at 42<sup>o</sup>C for 5mins.</li>
<li>Incubated plate at 70<sup>o</sup>C for 15mins to deactivate reverse transcriptase.</li>
</ol>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Step 6 is <em>required</em> if using cDNA for downstream qPCR analyses.</p>
</div>
</div>
<section id="cdna-calcs-and-plate-layout" class="level2">
<h2 class="anchored" data-anchor-id="cdna-calcs-and-plate-layout">cDNA calcs and plate layout:</h2>
<ul>
<li><a href="https://docs.google.com/spreadsheets/d/1m7nn7cTXrRHMMGzz9npPGa04huvve6Xm0wofIGpzGws/edit?usp=sharing">cgig-lifestage-carryover-cDNA-calcs</a> (Google Sheet)</li>
</ul>
<p>Plate was stored at -20<sup>o</sup>C.</p>


</section>
</section>

 ]]></description>
  <category>2024</category>
  <category>reverse transcription</category>
  <category>cDNA</category>
  <category>GoScript</category>
  <category>Crassostrea gigas</category>
  <category>Pacific oyster</category>
  <category>RNA</category>
  <category>project-gigas-carryover</category>
  <category>lifestage_carryover</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-24-Reverse-Transcription---C.gigas-Lifestage-Carryover-RNA/</guid>
  <pubDate>Thu, 24 Oct 2024 07:00:00 GMT</pubDate>
  <media:content url="https://robertslab.github.io/sams-notebook/posts/2024/2024-10-24-Reverse-Transcription---C.gigas-Lifestage-Carryover-RNA/20241024-cgig-lifestage_carryover-RT-01.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Computer Management - Configure 16TB OWC ThunderBlade X8 External HDD on Raven</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-21-Computer-Management---Configure-16TB-OWC-ThunderBlade-X8-External-HDD-on-Raven/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>We recently purchased a 16TB OWC ThunderBlade X8 as additional storage for Raven (Ubuntu 18.04LTS), primarily to be used for Shelly and Emma’s project. Although I thought this would just be “plug and play,” when I plugged it in, Raven recognized each individual SSD as its own drive. Firstly, I didn’t expect there to be mutliple drives (guess I should’ve read the product description more closely) and thought it was just a single, massive SSD drive. Secondly, Raven didn’t automount the drives.</p>
<p>So, I had to deal with both of those issues. Luckily, it turns out it wasn’t particularly difficult or timeconsuming!</p>
<div id="fig-ladder" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="New external drive isn't listed (i.e. isn't automounted) after being plugged in.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241021-initial-df_output-01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: New external drive isn’t listed (i.e.&nbsp;isn’t automounted) after being plugged in."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-10-21-Computer-Management---Configure-16TB-OWC-ThunderBlade-X8-External-HDD-on-Raven/20241021-initial-df_output-01.png" class="img-fluid figure-img" alt="New external drive isn't listed (i.e. isn't automounted) after being plugged in."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: New external drive isn’t listed (i.e.&nbsp;isn’t automounted) after being plugged in.
</figcaption>
</figure>
</div>
<div id="fig-ladder" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="blkid command shows eight nvme drives, corresponding to the Thunderblad X8 SSD drivves.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241021-initial-blkid_output-01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: blkid command shows eight nvme drives, corresponding to the Thunderblad X8 SSD drives."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-10-21-Computer-Management---Configure-16TB-OWC-ThunderBlade-X8-External-HDD-on-Raven/20241021-initial-blkid_output-01.png" class="img-fluid figure-img" alt="blkid command shows eight nvme drives, corresponding to the Thunderblad X8 SSD drivves."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: blkid command shows eight nvme drives, corresponding to the Thunderblad X8 SSD drives.
</figcaption>
</figure>
</div>
</section>
<section id="procedure" class="level1">
<h1>PROCEDURE</h1>
<section id="combine-drives-into-raid0" class="level2">
<h2 class="anchored" data-anchor-id="combine-drives-into-raid0">Combine drives into RAID0</h2>
<p>RAID0 essentially treats all the SSDs of the Thunderblad X8 as a single volume (i.e.&nbsp;drive). This maximizes space, but sacrificies any data redundancy. This is fine, as we purchased this solely to function as additional storage and aren’t concerned about data redundancy (data on Raven should be sync’d to Gannet with regularity, as Gannet <em>does</em> have data redundancy in a RAID6 setup).</p>
<p>To do this, we use the <a href="https://en.wikipedia.org/wiki/Mdadm"><code>mdadm</code> command</a> (Wikipedia).</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> mdadm <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-2">--create <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-3">--verbose <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-4">/dev/md0 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-5">--level=0 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-6">--raid-devices=8 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-7">/dev/nvme0n1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-8">/dev/nvme1n1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-9">/dev/nvme2n1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-10">/dev/nvme3n1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-11">/dev/nvme4n1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-12">/dev/nvme5n1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-13">/dev/nvme6n1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-14">/dev/nvme7n1</span></code></pre></div>
<p>This assigns the combined drive to <code>/dev/md0</code> and then sets the RAID level to <code>0</code>. This is followed by the drive count and the locations of the drives you want to include in the RAID configuration.</p>
<div id="fig-ladder" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="Screenshot confirming mdadm command and confirming we'd like to proceed.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241021-mdadm-confirmation.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: Screenshot confirming mdadm command and confirming we’d like to proceed."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-10-21-Computer-Management---Configure-16TB-OWC-ThunderBlade-X8-External-HDD-on-Raven/20241021-mdadm-confirmation.png" class="img-fluid figure-img" alt="Screenshot confirming mdadm command and confirming we'd like to proceed."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Screenshot confirming mdadm command and confirming we’d like to proceed.
</figcaption>
</figure>
</div>
<p>After running the <code>mdadm --create</code> command, we can confirm the details of the command’s process and confirm that things look the way we expected:</p>
<div id="fig-ladder" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="Screenshot of mdadm --details command confirming the procedure worked as expected.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241021-mdadm-detail_output-01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;4: Screenshot of mdadm –details command confirming the procedure worked as expected."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-10-21-Computer-Management---Configure-16TB-OWC-ThunderBlade-X8-External-HDD-on-Raven/20241021-mdadm-detail_output-01.png" class="img-fluid figure-img" alt="Screenshot of mdadm --details command confirming the procedure worked as expected."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Screenshot of mdadm –details command confirming the procedure worked as expected.
</figcaption>
</figure>
</div>
<div id="fig-ladder" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="Screenshot of blkid now showing all nvme drives associated with md0">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241021-raid0-blkid_output-01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;5: Screenshot of blkid now showing all nvme drives associated with md0"><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-10-21-Computer-Management---Configure-16TB-OWC-ThunderBlade-X8-External-HDD-on-Raven/20241021-raid0-blkid_output-01.png" class="img-fluid figure-img" alt="Screenshot of blkid now showing all nvme drives associated with md0"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Screenshot of blkid now showing all nvme drives associated with md0
</figcaption>
</figure>
</div>
<p>Next, we need to format the new RAID0 drives with a file system. In this case, we’ll go with <code>ext4</code>, which is a standard file system used in Linux/Ubuntu.</p>
</section>
<section id="format-hdds" class="level2">
<h2 class="anchored" data-anchor-id="format-hdds">Format HDDs</h2>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> mkfs.ext4 /dev/md0</span></code></pre></div>
<p>After that’s done, we need to create a mount point and mount the drive.</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> mkdir <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> /home/shared/16TB_HDD_01</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> mount /dev/md0 /home/shared/16TB_HDD_01</span></code></pre></div>
<p>Finally, we want this to automount any time the computer is rebooted, so we add it to <code>/etc/fstab</code>. Since that table contains the unique drive IDs, I think we don’t want them displayed on the open internet. So, if you want to see how that’s set up, you’ll need to look at <code>/etc/fstab</code> on your own.</p>
</section>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<p>Now, check to see that the newly RAID’d and formatted drive shows up.</p>
<div id="fig-ladder" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="Screenshot of df -h now showing a single drive with 14TB of storage mounted at /dev/md0.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241021-final-df_output-01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;6: Screenshot of df -h now showing a single drive with 14TB of storage mounted at /dev/md0."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-10-21-Computer-Management---Configure-16TB-OWC-ThunderBlade-X8-External-HDD-on-Raven/20241021-final-df_output-01.png" class="img-fluid figure-img" alt="Screenshot of df -h now showing a single drive with 14TB of storage mounted at /dev/md0."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Screenshot of df -h now showing a single drive with 14TB of storage mounted at /dev/md0.
</figcaption>
</figure>
</div>
<p>Alrighty, looks great! Easy, peasy!</p>


</section>

 ]]></description>
  <category>2024</category>
  <category>Computer Management</category>
  <category>HDD</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-21-Computer-Management---Configure-16TB-OWC-ThunderBlade-X8-External-HDD-on-Raven/</guid>
  <pubDate>Mon, 21 Oct 2024 07:00:00 GMT</pubDate>
</item>
<item>
  <title>PCR - Lake Trout C1q Primers with Bisulfite-treated gDNA</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-09-PCR---Lake-Trout-C1q-Primers-with-Bisulfite-treated-gDNA/</link>
  <description><![CDATA[ 





<section id="intro" class="level2">
<h2 class="anchored" data-anchor-id="intro">INTRO</h2>
<p>The original _<a href="https://en.wikipedia.org/wiki/Lake_trout"><em>Salvelinus namaycush</em></a> <a href="../../../posts/2024/2024-09-11-Bisulfite-PCR---Second-Primer-Annealing-Gradient-Test-with-Lake-Trout-Bisulfite-treated-DNA/index.html">C1q bisulfite PCR on 20240911</a> (Notebook) using <a href="../../../posts/2024/2024-07-29-Primer-Design---Lake-Trout-C1q-Gene-Bisulfite-Sequencing-Primers-Using-Primer3/index.html">bisulfite primers designed on 20240729</a> (Notebook) failed to produce any amplification. In response, we opted to just confirm that we could actually amplify the C1q gene using <a href="../../../posts/2024/2024-09-16-Primer-Design---Lake-Trout-C1q-Gene-Sequencing-Primers-Using-Primer3/index.html">regular primers, designed on 20240916</a> (Notebook) and the <a href="../../../posts/2024/2024-07-12-DNA-Isolation-and-Quantification---Lake-Trout-Liver/index.html">original liver gDNA from 20240712</a>. This latter PCR was successful. So, just for kicks, we decided to try running a PCR with the regular C1q primers and the bisulfite-treated gDNA.</p>
</section>
<section id="materials-methods" class="level2">
<h2 class="anchored" data-anchor-id="materials-methods">MATERIALS &amp; METHODS</h2>
<section id="dna-pooling" class="level3">
<h3 class="anchored" data-anchor-id="dna-pooling">DNA Pooling</h3>
<p>Used 0.5uL of the pooled gDNA in each reaction.</p>
</section>
<section id="pcr-reactions" class="level3">
<h3 class="anchored" data-anchor-id="pcr-reactions">PCR Reactions</h3>
<p>PCR reactions were run using <a href="https://www.neb.com/en-us/products/m0490-epimark-hot-start-taq-dna-polymerase">EpiMark Hot Start Taq DNA Polymerase</a> (New England Biolabs), according to the <a href="https://www.neb.com/en-us/protocols/2012/09/25/epimark-hot-start-taq-dna-polymerase-guidelines-for-pcr-reactions-m0490">manufacturer’s protocol</a>, in a total reaction volume of 25uL.</p>
<p>I ran the reaction in duplicate, using 0.5uL of the pooled liver gDNA for template. Each reaction was prepared <em>individually</em> (i.e.&nbsp;no master mix was created).</p>
<p>Primers used:</p>
<ul>
<li><code>Sn-C1q-F/R</code> (SRIDs: 1842/3)</li>
</ul>
</section>
<section id="pcr-cycling" class="level3">
<h3 class="anchored" data-anchor-id="pcr-cycling">PCR Cycling</h3>
<p>Annealing temperature gradient PCR was performed in a CFX Connect (BioRad) thermalcycler.</p>
<p>Cycling params:</p>
<div id="fig-PCR-parameters" class="quarto-float quarto-figure quarto-figure-center anchored" alt="PCR cycling parameters.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-PCR-parameters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-10-09-PCR---Lake-Trout-C1q-Primers-with-Bisulfite-treated-gDNA/202401009-snam-c1q-BS-DNA-pcr.png" class="img-fluid figure-img" alt="PCR cycling parameters.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-PCR-parameters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Screenshot of cycling program, also sdhowing temperature gradient.
</figcaption>
</figure>
</div>
<ol type="1">
<li>95<sup>o</sup>C - 30s</li>
<li>95<sup>o</sup>C - 15s</li>
<li>55<sup>o</sup>C - 30s</li>
<li>68<sup>o</sup>C - 4m</li>
<li>Go to Step 2 x 39.</li>
<li>68<sup>o</sup>C - 5m</li>
<li>4<sup>o</sup>C - FOREVER</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Extension step was set to 4m due to the <a href="../../../posts/2024/2024-09-16-Primer-Design---Lake-Trout-C1q-Gene-Sequencing-Primers-Using-Primer3/index.html">expected amplicon size of C1q using the Roberts Lab primers</a> (Notebook) of 3192bp. Most DNA polymerases (including <a href="https://www.neb.com/en-us/products/m0490-epimark-hot-start-taq-dna-polymerase">EpiMark Hot Start Taq DNA Polymerase</a>) process 1Kbp/min, so setting to four mins is a tad long, but will certainly ensure the full gene length is amplified.</p>
</div>
</div>
<p>PCR reactions were loaded on a low-TAE, 1.0% agarose gel, with ethidium bromide. Gel was run at 107V for ~45mins and then imaged.</p>
<p>O’GeneRuler (ThermoFisher) Ladder was used (5uL) for size reference:</p>
<div id="fig-ladder" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="O'GeneRuler">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="../../../images/ogene-ruler.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;2: Ladder"><img src="https://robertslab.github.io/sams-notebook/images/ogene-ruler.jpeg" class="img-fluid figure-img" alt="O'GeneRuler"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Ladder
</figcaption>
</figure>
</div>
</section>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">RESULTS</h2>
<p>Unsurprisingly, we do not see any amplification.</p>
<div id="fig-gel-image" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="Gel image showing only molecular weight marker and no visible amplicons in the other lanes.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gel-image-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241009-snam-c1q-PCR-gel.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;3: Gel image showing only molecular weight marker and no visible amplicons in the other lanes."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-10-09-PCR---Lake-Trout-C1q-Primers-with-Bisulfite-treated-gDNA/20241009-snam-c1q-PCR-gel.jpg" class="img-fluid figure-img" alt="Gel image showing only molecular weight marker and no visible amplicons in the other lanes."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gel-image-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Gel image showing only molecular weight marker and no visible amplicons in the other lanes.
</figcaption>
</figure>
</div>
</section>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">DISCUSSION</h2>
<p>Based on the failure of our previous <a href="../../../posts/2024/2024-09-11-Bisulfite-PCR---Second-Primer-Annealing-Gradient-Test-with-Lake-Trout-Bisulfite-treated-DNA/index.html">bisulfite PCR using bisulfite primers</a> (Notebook), which utilized primers specifically designed to amplify bisulfite-treated DNA, I had little expectation this would work. It did not.</p>
<p>In retrospect, we probably shouldn’t have had <em>any</em> expectations this would work. The reasons for this are related to the amount of DNA fragmentation/degradation that takes place during bisulfite treatment of gDNA. I was certainly aware of the fact that bisulfite treatement was considered “harsh” and resulted in single-stranded gDNA, as well as some degradation. However, after some investigation into this (spurred by the results of this project), it’s clear that the degradation that occurs is high! High enough, in fact, one is unlikely to ever expect any successful PCR of products larger than ~2,000bp.</p>
<p>As an example, <a href="https://www.zymoresearch.com/pages/bisulfite-beginner-guide">ZymoResearch’s “Bisulfite Beginner Guide”</a> (ZymoResearch website), provides an example gel to display the level of degradation expected from bisulfite treatment of gDNA. Keep in mind, companies usually display their <em>best</em> examples:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./zymo-bs-dna-gel.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Screencapture from ZymoResearch website of a two gel images showing bisulfite gDNA. The gel image on the left has been run under normal circumstances. The gel on the right shows the same gel, but after cooling in an ice bath; allowing the DNA to form enough base pairing to allow the ethidium bromide to intercalate the DNA."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-10-09-PCR---Lake-Trout-C1q-Primers-with-Bisulfite-treated-gDNA/zymo-bs-dna-gel.png" class="img-fluid figure-img" alt="Screencapture from ZymoResearch website of a two gel images showing bisulfite gDNA. The gel image on the left has been run under normal circumstances. The gel on the right shows the same gel, but after cooling in an ice bath; allowing the DNA to form enough base pairing to allow the ethidium bromide to intercalate the DNA."></a></p>
<figcaption>Screencapture from ZymoResearch website of a two gel images showing bisulfite gDNA. The gel image on the left has been run under normal circumstances. The gel on the right shows the same gel, but after cooling in an ice bath; allowing the DNA to form enough base pairing to allow the ethidium bromide to intercalate the DNA.</figcaption>
</figure>
</div>
<p>Notice that the molecular weight marker is a 100bp marker. This means the highest molecular weight band in the marker corresponds to 1500bp! That means our attempts to potentially amplify a ~3,200bp from bisulfite-treated gDNA were virtually impossible to achieve.</p>
<p>Also, as part of my research into the impacts of bisulfite degradation on gDNA, I came acroos this excellent paper (<a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0199091">“Evaluation of bisulfite kits for DNA methylation profiling in terms of DNA fragmentation and DNA recovery using digital PCR”</a>) <span class="citation" data-cites="kint2018">(Kint et al. 2018)</span> which compares the performance of multiple bisulfite treatment kits, including:</p>
<ul>
<li>recovery (yield)</li>
<li>recovery integrity</li>
<li>processing time</li>
</ul>
<p>The combination of information from that ZymoResearch site and the paper make it pretty clear that PCR of a product size of ~3,200bp would not happen. Have discussed with Steven and we’ll try to come up with some other ideas on how to approach the issue of determining gene-level DNA methylation of C1q in individuals.</p>
</section>
<section id="citations" class="level2">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">CITATIONS</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-kint2018" class="csl-entry">
Kint, Sam, Ward De Spiegelaere, Jonas De Kesel, Linos Vandekerckhove, and Wim Van Criekinge. 2018. <span>“Evaluation of Bisulfite Kits for DNA Methylation Profiling in Terms of DNA Fragmentation and DNA Recovery Using Digital PCR.”</span> Edited by Emidio Albertini. <em>PLOS ONE</em> 13 (6): e0199091. <a href="https://doi.org/10.1371/journal.pone.0199091">https://doi.org/10.1371/journal.pone.0199091</a>.
</div>
</div></section></div> ]]></description>
  <category>2024</category>
  <category>C1q</category>
  <category>Lake trout</category>
  <category>Salvelinus namaycush</category>
  <category>PCR</category>
  <category>bisulfite</category>
  <category>gDNA</category>
  <category>liver</category>
  <category>gel</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-09-PCR---Lake-Trout-C1q-Primers-with-Bisulfite-treated-gDNA/</guid>
  <pubDate>Wed, 09 Oct 2024 07:00:00 GMT</pubDate>
</item>
<item>
  <title>RNA-seq Alignment - A.pulchra RNA-seq Alignments Using HISAT2 and StringTie for Azenta Project 30-1047560508</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-08-RNA-seq-Alignment---A.pulchra-RNA-seq-Alignments-Using-HISAT2-and-StringTie-for-Azenta-Project-30-1047560508/</link>
  <description><![CDATA[ 





<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This notebook entry is knitted from <a href="https://github.com/urol-e5/timeseries_molecular/blob/0f801c0bd0e66eb33aeb8597fe759be44011d1b8/D-Apul/code/02.20-D-Apul-RNAseq-alignment-HiSat2.Rmd"><code>urol-e5/timeseries_molecular/D-Apul/code/02.20-D-Apul-RNAseq-alignment-HiSat2.Rmd</code></a> (GitHub), commit <code>0f801c0</code>.</p>
</div>
</div>
<section id="introduction" class="level1">
<h1>1 INTRODUCTION</h1>
<p>This notebook will align trimmed <em>A.pulchra</em> RNA-seq data to the <em>A.pulchra</em> genome using <a href="https://github.com/DaehwanKimLab/hisat2">HISAT2</a> <span class="citation" data-cites="kim2019">(Kim et al. 2019)</span>. Follwed by <a href="https://ccb.jhu.edu/software/stringtie/index.shtml?t=manual">StringTie</a> <span class="citation" data-cites="pertea2016 pertea2015">(Pertea et al. 2016, 2015)</span> for transcript assembly/identification and count matrices for downstream expression analysis with <a href="https://github.com/thelovelab/DESeq2">DESeq2</a> and/or <a href="https://github.com/alyssafrazee/ballgown">Ballgown</a>.</p>
<p>Since the BAM files produced by this notebook are too large for GitHub, they can be accessed on our server here:</p>
<p><a href="https://gannet.fish.washington.edu/Atumefaciens/gitrepos/urol-e5/timeseries_molecular/D-Apul/output/02.20-D-Apul-RNAseq-alignment-HiSat2/" class="uri">https://gannet.fish.washington.edu/Atumefaciens/gitrepos/urol-e5/timeseries_molecular/D-Apul/output/02.20-D-Apul-RNAseq-alignment-HiSat2/</a></p>
<p>Input(s)</p>
<ul>
<li>Trimmed FastQ files, with format: <code>*fastp-trim.fq.gz</code></li>
<li>HISAT2 genome index: <code>Apulcrha-genome</code></li>
<li>Genome GTF: <code>Apulchra-genome.gtf</code></li>
<li>Sample metadata: <code>M-multi-species/data/rna_metadata.csv</code></li>
</ul>
<p>Outputs:</p>
<ul>
<li><p>Primary:</p>
<ul>
<li><p><code>checksums.md5</code>: MD5 checksum for all files in this directory. Excludes subdirectories.</p></li>
<li><p><code>apul-gene_count_matrix.csv</code>: Gene count matrix for use in <a href="https://github.com/thelovelab/DESeq2">DESeq2</a>.</p></li>
<li><p><code>apul-transcript_count_matrix.csv</code>: Transcript count matrix for use in <a href="https://github.com/thelovelab/DESeq2">DESeq2</a>.</p></li>
<li><p><code>prepDE-sample_list.txt</code>: Sample file list provided as input to StringTie for DESeq2 count matrix generation. Also serves as documentation of which files were used for this step.</p></li>
<li><p><code>Apulchra-genome.stringtie.gtf</code>: Canonical StringTie GTF file compiled from all individual sample GTFs.</p></li>
<li><p><code>sorted-bams-merged.bam</code>: Merged (and sorted) BAM consisting of all individual sample BAMs.</p></li>
<li><p><code>sorted-bams-merged.bam.bai</code>: BAM index file. Useful for visualizing assemblies in IGV.</p></li>
<li><p><code>sorted_bams.list</code>: List file needed for merging of BAMS with samtools. Also serves as documentation of which files were used for this step.</p></li>
<li><p><code>multiqc_report.html</code>: MultiQC report aggregating all individual HISAT2 alignment stats and samtools flagstats.</p></li>
<li><p><code>gtf_list.txt</code>: List file needed for merging of GTF files with StringTie. Also serves as documentation of which files were used for this step.</p></li>
</ul></li>
<li><p>Individuals: Each subdirectory is labelled based on sample name and each contains individual HISAT2 alignment and StringTie output files.</p>
<ul>
<li><p><code>&lt;sample_name&gt;_checksums.md5</code>: MD5 checksums for all files in the directory.</p></li>
<li><p><code>*.ctab</code>: Data tables formatted for import into Ballgown.</p></li>
<li><p><code>&lt;sample_name&gt;.cov_refs.gtf</code>: StringTie genome reference sequnce coverage GTF.</p></li>
<li><p><code>&lt;sample_name&gt;.gtf</code>: StringTie GTF.</p></li>
<li><p><code>&lt;sample_name&gt;.sorted.bam</code>: HISAT2 assembly BAM.</p></li>
<li><p><code>&lt;sample_name&gt;.sorted.bam.bai</code>: BAM index file. Useful for visualizing assemblies in IGV.</p></li>
<li><p><code>&lt;sample_name&gt;-hisat2_output.flagstat</code>: samtools flagstat output file.</p></li>
<li><p><code>&lt;sample_name&gt;_hisat2.stats</code>: HISAT2 assembly stats.</p></li>
<li><p><code>input_fastqs_checksums.md5</code>: MD5 checksums of files used as input for assembly. Primarily serves as documentation to track/verify which files were actually used.</p></li>
</ul></li>
</ul>
</section>
<section id="create-a-bash-variables-file" class="level1">
<h1>2 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export timeseries_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export genome_dir="${timeseries_dir}/D-Apul/data"'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export genome_index_dir="${timeseries_dir}/D-Apul/output/02.10-D-Apul-RNAseq-genome-index-HiSat2"'</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export output_dir_top="${timeseries_dir}/D-Apul/output/02.20-D-Apul-RNAseq-alignment-HiSat2"'</span></span>
<span id="cb1-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export trimmed_fastqs_dir="${timeseries_dir}/D-Apul/output/01.00-D-Apul-RNAseq-trimming-fastp-FastQC-MultiQC/trimmed-fastqs"'</span></span>
<span id="cb1-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export trimmed_reads_url="https://gannet.fish.washington.edu/Atumefaciens/gitrepos/urol-e5/timeseries_molecular/D-Apul/output/01.00-D-Apul-RNAseq-trimming-fastp-FastQC-MultiQC/trimmed-fastqs/"'</span></span>
<span id="cb1-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-13"></span>
<span id="cb1-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Location of Hisat2 index files"</span></span>
<span id="cb1-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Must keep variable name formatting, as it's used by HiSat2"</span></span>
<span id="cb1-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export HISAT2_INDEXES="${genome_index_dir}"'</span></span>
<span id="cb1-17"></span>
<span id="cb1-18"></span>
<span id="cb1-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Input files"</span></span>
<span id="cb1-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export exons="${output_dir_top}/Apulchra-genome_hisat2_exons.tab"'</span></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export genome_index_name="Apulchra-genome"'</span></span>
<span id="cb1-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export genome_gff="${genome_dir}/Apulchra-genome.gff"'</span></span>
<span id="cb1-23"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export genome_fasta="${genome_dir}/Apulchra-genome.fa"'</span></span>
<span id="cb1-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export splice_sites="${output_dir_top}/Apulchra-genome_hisat2_splice_sites.tab"'</span></span>
<span id="cb1-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export transcripts_gtf="${genome_dir}/Apulchra-genome.gtf"'</span></span>
<span id="cb1-26"></span>
<span id="cb1-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Output files"</span></span>
<span id="cb1-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export gtf_list="${output_dir_top}/gtf_list.txt"'</span></span>
<span id="cb1-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export merged_bam="${output_dir_top}/sorted-bams-merged.bam"'</span></span>
<span id="cb1-30"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-31"></span>
<span id="cb1-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Paths to programs"</span></span>
<span id="cb1-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export programs_dir="/home/shared"'</span></span>
<span id="cb1-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export hisat2_dir="${programs_dir}/hisat2-2.2.1"'</span></span>
<span id="cb1-35"></span>
<span id="cb1-36"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export hisat2="${hisat2_dir}/hisat2"'</span></span>
<span id="cb1-37"></span>
<span id="cb1-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export multiqc=/home/sam/programs/mambaforge/bin/multiqc'</span></span>
<span id="cb1-39"></span>
<span id="cb1-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export samtools="${programs_dir}/samtools-1.12/samtools"'</span></span>
<span id="cb1-41"></span>
<span id="cb1-42"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export prepDE="${programs_dir}/stringtie-2.2.1.Linux_x86_64/prepDE.py3"'</span></span>
<span id="cb1-43"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export stringtie="${programs_dir}/stringtie-2.2.1.Linux_x86_64/stringtie"'</span></span>
<span id="cb1-44"></span>
<span id="cb1-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-46"></span>
<span id="cb1-47"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set FastQ filename patterns"</span></span>
<span id="cb1-48"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R1_fastq_pattern='*_R1_*.fq.gz'"</span></span>
<span id="cb1-49"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R2_fastq_pattern='*_R2_*.fq.gz'"</span></span>
<span id="cb1-50"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export trimmed_fastq_pattern='*fastp-trim.fq.gz'"</span></span>
<span id="cb1-51"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-52"></span>
<span id="cb1-53"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set number of CPUs to use"</span></span>
<span id="cb1-54"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=40'</span></span>
<span id="cb1-55"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-56"></span>
<span id="cb1-57"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set average read length - for StringTie prepDE.py"</span></span>
<span id="cb1-58"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export read_length=125'</span></span>
<span id="cb1-59"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-60"></span>
<span id="cb1-61"></span>
<span id="cb1-62"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"## Initialize arrays"</span></span>
<span id="cb1-63"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R1=()'</span></span>
<span id="cb1-64"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R2=()'</span></span>
<span id="cb1-65"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R1_names_array=()'</span></span>
<span id="cb1-66"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R2_names_array=()'</span></span>
<span id="cb1-67"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"declare -A sample_timepoint_map"</span></span>
<span id="cb1-68"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-69"></span>
<span id="cb1-70"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Programs associative array"</span></span>
<span id="cb1-71"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"declare -A programs_array"</span></span>
<span id="cb1-72"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"programs_array=("</span></span>
<span id="cb1-73"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[hisat2]="${hisat2}" \'</span></span>
<span id="cb1-74"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[multiqc]="${multiqc}" \'</span></span>
<span id="cb1-75"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[prepDE]="${prepDE}" \'</span></span>
<span id="cb1-76"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[samtools]="${samtools}" \'</span></span>
<span id="cb1-77"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[stringtie]="${stringtie}" \'</span></span>
<span id="cb1-78"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span></span>
<span id="cb1-79"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-80"></span>
<span id="cb1-81"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Print formatting"</span></span>
<span id="cb1-82"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-83"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-84"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-85"></span>
<span id="cb1-86"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export timeseries_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular
export genome_dir="${timeseries_dir}/D-Apul/data"
export genome_index_dir="${timeseries_dir}/D-Apul/output/02.10-D-Apul-RNAseq-genome-index-HiSat2"
export output_dir_top="${timeseries_dir}/D-Apul/output/02.20-D-Apul-RNAseq-alignment-HiSat2"
export trimmed_fastqs_dir="${timeseries_dir}/D-Apul/output/01.00-D-Apul-RNAseq-trimming-fastp-FastQC-MultiQC/trimmed-fastqs"
export trimmed_reads_url="https://gannet.fish.washington.edu/Atumefaciens/gitrepos/urol-e5/timeseries_molecular/D-Apul/output/01.00-D-Apul-RNAseq-trimming-fastp-FastQC-MultiQC/trimmed-fastqs/"

# Location of Hisat2 index files
# Must keep variable name formatting, as it's used by HiSat2
export HISAT2_INDEXES="${genome_index_dir}"
# Input files
export exons="${output_dir_top}/Apulchra-genome_hisat2_exons.tab"
export genome_index_name="Apulchra-genome"
export genome_gff="${genome_dir}/Apulchra-genome.gff"
export genome_fasta="${genome_dir}/Apulchra-genome.fa"
export splice_sites="${output_dir_top}/Apulchra-genome_hisat2_splice_sites.tab"
export transcripts_gtf="${genome_dir}/Apulchra-genome.gtf"
# Output files
export gtf_list="${output_dir_top}/gtf_list.txt"
export merged_bam="${output_dir_top}/sorted-bams-merged.bam"

# Paths to programs
export programs_dir="/home/shared"
export hisat2_dir="${programs_dir}/hisat2-2.2.1"
export hisat2="${hisat2_dir}/hisat2"
export multiqc=/home/sam/programs/mambaforge/bin/multiqc
export samtools="${programs_dir}/samtools-1.12/samtools"
export prepDE="${programs_dir}/stringtie-2.2.1.Linux_x86_64/prepDE.py3"
export stringtie="${programs_dir}/stringtie-2.2.1.Linux_x86_64/stringtie"

# Set FastQ filename patterns
export R1_fastq_pattern='*_R1_*.fq.gz'
export R2_fastq_pattern='*_R2_*.fq.gz'
export trimmed_fastq_pattern='*fastp-trim.fq.gz'

# Set number of CPUs to use
export threads=40

# Set average read length - for StringTie prepDE.py
export read_length=125

## Initialize arrays
export fastq_array_R1=()
export fastq_array_R2=()
export R1_names_array=()
export R2_names_array=()
declare -A sample_timepoint_map

# Programs associative array
declare -A programs_array
programs_array=(
[hisat2]="${hisat2}" \
[multiqc]="${multiqc}" \
[prepDE]="${prepDE}" \
[samtools]="${samtools}" \
[stringtie]="${stringtie}" \
)

# Print formatting
export line="--------------------------------------------------------"</code></pre>
<p>If needed, download raw RNA-seq.</p>
<p>Change <code>eval=FALSE</code> to <code>eval=TRUE</code> to execute the next two chunks to download RNA-seq and then verify MD5 checksums.</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directory if it doesn't exist</span></span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span></span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run wget to retrieve FastQs and MD5 files</span></span>
<span id="cb3-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-9">--directory-prefix <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-10">--recursive <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-11">--no-check-certificate <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-12">--continue <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-13">--cut-dirs 3 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-14">--no-host-directories <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-15">--no-parent <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-16">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-17">--accept=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*fastp-trim*, *.md5"</span></span>
<span id="cb3-18"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_reads_url}</span></span>
<span id="cb3-19"></span>
<span id="cb3-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<p>Verify raw read checksums</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb4-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb4-5"></span>
<span id="cb4-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Verify checksums</span></span>
<span id="cb4-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.md5</span>
<span id="cb4-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb4-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--check</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb4-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
<section id="align-reads-using-hisat2" class="level1">
<h1>3 Align reads using HISAT2</h1>
<p>This requires usage of the <code>rna_metadata.csv</code></p>
<p>This step has a lengthy, semi-complex workflow:</p>
<ol type="1">
<li>Parse <code>rna_metadata.csv</code> for <em>A.pulchra</em> sample names and time point. This info will be used for downstream file naming and to assing the time point to the read group (<code>SM:</code>) in the alignment file.</li>
<li>Loop through all samples and perform individual alignments using HISAT2.</li>
<li>HISAT2 output is piped to through multiple samtools tools: flagstat (stats aggregation), sort (creates/sorts BAM), index (creates BAM index). Piping saves time and disk space, by avoiding the generation of large SAM files.</li>
<li>Loop continues and runs StringTie on sorted BAM file to produce individual GTF file.</li>
<li>Loop continues and adds GTF path/filename to a list file, which will be used downstream.</li>
</ol>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directories, if they don't exist</span></span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change to ouput directory</span></span>
<span id="cb5-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-9"></span>
<span id="cb5-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create associative array with sample and timepoint</span></span>
<span id="cb5-11"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">metadata</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../../M-multi-species/data/rna_metadata.csv"</span></span>
<span id="cb5-12"></span>
<span id="cb5-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Declare the array</span></span>
<span id="cb5-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">declare</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_timepoint_map</span></span>
<span id="cb5-15"></span>
<span id="cb5-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the metadata file line by line</span></span>
<span id="cb5-17"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">IFS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">','</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">read</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_number</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_name</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plate</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">well_number</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">azenta_sample_name</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">colony_id</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">timepoint</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_type</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">species_strain</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">SampleBuffer</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the species is "Acropora pulchra"</span></span>
<span id="cb5-19">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${species_strain}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Acropora pulchra"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb5-20">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add the Azenta sample name as the key and Timepoint as the value in the associative array</span></span>
<span id="cb5-21">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_timepoint_map</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${azenta_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${timepoint}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-22">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb5-23"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tail</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> +2 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${metadata}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Skip the header</span></span>
<span id="cb5-24"></span>
<span id="cb5-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Populate trimmed reads arrays</span></span>
<span id="cb5-26"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_fastq_pattern})</span></span>
<span id="cb5-27"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_fastq_pattern})</span></span>
<span id="cb5-28"></span>
<span id="cb5-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############## </span><span class="re">BEGIN</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> HISAT2 ALIGNMENTS ##############</span></span>
<span id="cb5-30"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> sample <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_timepoint_map</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-31"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-32"></span>
<span id="cb5-33"></span>
<span id="cb5-34">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create and switch to dedicated sample directory</span></span>
<span id="cb5-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$_</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-36"></span>
<span id="cb5-37">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create HISAT2 list of fastq R1 files</span></span>
<span id="cb5-38">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># and generated MD5 checksums file.</span></span>
<span id="cb5-39">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-40">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-41">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Parse sample name from FastQ filename</span></span>
<span id="cb5-42">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[_-]"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print $3}'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-43">    </span>
<span id="cb5-44">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Process matching FastQ file, based on sample name</span></span>
<span id="cb5-45">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb5-46">      </span>
<span id="cb5-47">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate checksum/list of input files used</span></span>
<span id="cb5-48">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> input_fastqs_checksums.md5</span>
<span id="cb5-49">      </span>
<span id="cb5-50">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create comma-separated lists of FastQs for HISAT2</span></span>
<span id="cb5-51">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-v</span> joined_R1 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'%s,'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-52">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_list_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${joined_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-53">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb5-54">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb5-55"></span>
<span id="cb5-56">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create HISAT2 list of fastq R1 files</span></span>
<span id="cb5-57">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># and generated MD5 checksums file.</span></span>
<span id="cb5-58">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-59">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-60">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Parse sample name from FastQ filename</span></span>
<span id="cb5-61">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[_-]"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print $3}'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-62">    </span>
<span id="cb5-63">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Process matching FastQ file, based on sample name</span></span>
<span id="cb5-64">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb5-65">      </span>
<span id="cb5-66">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate checksum/list of input files used</span></span>
<span id="cb5-67">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> input_fastqs_checksums.md5</span>
<span id="cb5-68"></span>
<span id="cb5-69">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create comma-separated lists of FastQs for HISAT2</span></span>
<span id="cb5-70">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-v</span> joined_R2 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'%s,'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-71">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_list_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${joined_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-72">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb5-73">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb5-74"></span>
<span id="cb5-75"></span>
<span id="cb5-76"></span>
<span id="cb5-77">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># HISAT2 alignments</span></span>
<span id="cb5-78">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sets read group info (RG) using samples array</span></span>
<span id="cb5-79">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>hisat2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-80">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-x</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_index_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-81">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_list_R1}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-82">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-2</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_list_R2}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-83">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--threads</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-84">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--rg-id</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-85">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--rg</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SM:""</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_timepoint_map</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-86">  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_hisat2.stats <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-87">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>samtools<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> flagstat <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>-hisat2_output.flagstat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-88">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>samtools<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> sort <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-@</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-O</span> BAM <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-89">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.sorted.bam <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-90">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>samtools<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> index <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.sorted.bam.bai</span>
<span id="cb5-91">  </span>
<span id="cb5-92">  </span>
<span id="cb5-93">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run stringtie on alignments</span></span>
<span id="cb5-94">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Uses "-B" option to output tables intended for use in Ballgown</span></span>
<span id="cb5-95">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Uses "-e" option; recommended when using "-B" option.</span></span>
<span id="cb5-96">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Limits analysis to only reads alignments matching reference.</span></span>
<span id="cb5-97">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>stringtie<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.sorted.bam <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-98">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-99">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-100">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-G</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_gff}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-101">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-C</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.cov_refs.gtf"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-102">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-B</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-103">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> </span>
<span id="cb5-104">  </span>
<span id="cb5-105">  </span>
<span id="cb5-106">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add GTFs to list file, only if non-empty</span></span>
<span id="cb5-107">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Identifies GTF files that only have header</span></span>
<span id="cb5-108">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gtf_lines</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.gtf <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-109">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${gtf_lines}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-gt</span> 2 <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb5-110">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.gtf"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${gtf_list}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-111">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span> </span>
<span id="cb5-112"></span>
<span id="cb5-113">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate checksums</span></span>
<span id="cb5-114">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> ./ <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-type</span> f <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-not</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-name</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.md5"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-exec</span> md5sum {} <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span>_checksums.md5</span>
<span id="cb5-115">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Move up to orig. working directory</span></span>
<span id="cb5-116">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ..</span>
<span id="cb5-117"></span>
<span id="cb5-118"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<section id="review-hisat2-output" class="level2">
<h2 class="anchored" data-anchor-id="review-hisat2-output">3.1 Review HISAT2 Output</h2>
<p>View the resulting directory structure of resulting from the HISAT2/StringTie process.</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb6-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change to ouput directory</span></span>
<span id="cb6-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb6-6"></span>
<span id="cb6-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display HISAT2 output directory structure</span></span>
<span id="cb6-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># with directory (--du) and file sizes (-h)</span></span>
<span id="cb6-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tree</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--du</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-h</span></span></code></pre></div>
<pre><code>.
├── [1.8G]  1A1
│   ├── [ 553]  1A1_checksums.md5
│   ├── [4.8M]  1A1.cov_refs.gtf
│   ├── [ 34M]  1A1.gtf
│   ├── [ 451]  1A1-hisat2_output.flagstat
│   ├── [ 637]  1A1_hisat2.stats
│   ├── [1.7G]  1A1.sorted.bam
│   ├── [936K]  1A1.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.2M]  i_data.ctab
│   ├── [ 420]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.8G]  1A10
│   ├── [ 559]  1A10_checksums.md5
│   ├── [3.5M]  1A10.cov_refs.gtf
│   ├── [ 34M]  1A10.gtf
│   ├── [ 449]  1A10-hisat2_output.flagstat
│   ├── [ 638]  1A10_hisat2.stats
│   ├── [1.8G]  1A10.sorted.bam
│   ├── [779K]  1A10.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.2M]  i_data.ctab
│   ├── [ 424]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.6G]  1A12
│   ├── [ 559]  1A12_checksums.md5
│   ├── [8.3M]  1A12.cov_refs.gtf
│   ├── [ 34M]  1A12.gtf
│   ├── [ 449]  1A12-hisat2_output.flagstat
│   ├── [ 636]  1A12_hisat2.stats
│   ├── [1.5G]  1A12.sorted.bam
│   ├── [777K]  1A12.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.3M]  i_data.ctab
│   ├── [ 424]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.8G]  1A2
│   ├── [ 553]  1A2_checksums.md5
│   ├── [3.1M]  1A2.cov_refs.gtf
│   ├── [ 34M]  1A2.gtf
│   ├── [ 449]  1A2-hisat2_output.flagstat
│   ├── [ 640]  1A2_hisat2.stats
│   ├── [1.7G]  1A2.sorted.bam
│   ├── [864K]  1A2.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.2M]  i_data.ctab
│   ├── [ 420]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.5G]  1A8
│   ├── [ 553]  1A8_checksums.md5
│   ├── [6.9M]  1A8.cov_refs.gtf
│   ├── [ 34M]  1A8.gtf
│   ├── [ 449]  1A8-hisat2_output.flagstat
│   ├── [ 637]  1A8_hisat2.stats
│   ├── [1.5G]  1A8.sorted.bam
│   ├── [789K]  1A8.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.3M]  i_data.ctab
│   ├── [ 422]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.9G]  1A9
│   ├── [ 553]  1A9_checksums.md5
│   ├── [7.2M]  1A9.cov_refs.gtf
│   ├── [ 34M]  1A9.gtf
│   ├── [ 450]  1A9-hisat2_output.flagstat
│   ├── [ 638]  1A9_hisat2.stats
│   ├── [1.9G]  1A9.sorted.bam
│   ├── [795K]  1A9.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.3M]  i_data.ctab
│   ├── [ 422]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.8G]  1B1
│   ├── [ 553]  1B1_checksums.md5
│   ├── [6.9M]  1B1.cov_refs.gtf
│   ├── [ 34M]  1B1.gtf
│   ├── [ 449]  1B1-hisat2_output.flagstat
│   ├── [ 638]  1B1_hisat2.stats
│   ├── [1.8G]  1B1.sorted.bam
│   ├── [824K]  1B1.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.3M]  i_data.ctab
│   ├── [ 420]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.8G]  1B10
│   ├── [ 559]  1B10_checksums.md5
│   ├── [7.0M]  1B10.cov_refs.gtf
│   ├── [ 34M]  1B10.gtf
│   ├── [ 449]  1B10-hisat2_output.flagstat
│   ├── [ 637]  1B10_hisat2.stats
│   ├── [1.7G]  1B10.sorted.bam
│   ├── [819K]  1B10.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.3M]  i_data.ctab
│   ├── [ 424]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.8G]  1B2
│   ├── [ 553]  1B2_checksums.md5
│   ├── [5.0M]  1B2.cov_refs.gtf
│   ├── [ 34M]  1B2.gtf
│   ├── [ 449]  1B2-hisat2_output.flagstat
│   ├── [ 638]  1B2_hisat2.stats
│   ├── [1.7G]  1B2.sorted.bam
│   ├── [814K]  1B2.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.3M]  i_data.ctab
│   ├── [ 422]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [2.0G]  1B5
│   ├── [ 553]  1B5_checksums.md5
│   ├── [7.8M]  1B5.cov_refs.gtf
│   ├── [ 34M]  1B5.gtf
│   ├── [ 450]  1B5-hisat2_output.flagstat
│   ├── [ 637]  1B5_hisat2.stats
│   ├── [1.9G]  1B5.sorted.bam
│   ├── [919K]  1B5.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.3M]  i_data.ctab
│   ├── [ 422]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [2.0G]  1B9
│   ├── [ 553]  1B9_checksums.md5
│   ├── [3.8M]  1B9.cov_refs.gtf
│   ├── [ 34M]  1B9.gtf
│   ├── [ 449]  1B9-hisat2_output.flagstat
│   ├── [ 640]  1B9_hisat2.stats
│   ├── [1.9G]  1B9.sorted.bam
│   ├── [832K]  1B9.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.2M]  i_data.ctab
│   ├── [ 422]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.5G]  1C10
│   ├── [ 559]  1C10_checksums.md5
│   ├── [4.0M]  1C10.cov_refs.gtf
│   ├── [ 34M]  1C10.gtf
│   ├── [ 449]  1C10-hisat2_output.flagstat
│   ├── [ 636]  1C10_hisat2.stats
│   ├── [1.4G]  1C10.sorted.bam
│   ├── [714K]  1C10.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.2M]  i_data.ctab
│   ├── [ 424]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.8G]  1C4
│   ├── [ 553]  1C4_checksums.md5
│   ├── [6.8M]  1C4.cov_refs.gtf
│   ├── [ 34M]  1C4.gtf
│   ├── [ 450]  1C4-hisat2_output.flagstat
│   ├── [ 638]  1C4_hisat2.stats
│   ├── [1.8G]  1C4.sorted.bam
│   ├── [837K]  1C4.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.3M]  i_data.ctab
│   ├── [ 422]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.9G]  1D10
│   ├── [ 559]  1D10_checksums.md5
│   ├── [6.3M]  1D10.cov_refs.gtf
│   ├── [ 34M]  1D10.gtf
│   ├── [ 450]  1D10-hisat2_output.flagstat
│   ├── [ 637]  1D10_hisat2.stats
│   ├── [1.8G]  1D10.sorted.bam
│   ├── [848K]  1D10.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.3M]  i_data.ctab
│   ├── [ 424]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.4G]  1D3
│   ├── [ 553]  1D3_checksums.md5
│   ├── [4.1M]  1D3.cov_refs.gtf
│   ├── [ 34M]  1D3.gtf
│   ├── [ 449]  1D3-hisat2_output.flagstat
│   ├── [ 636]  1D3_hisat2.stats
│   ├── [1.3G]  1D3.sorted.bam
│   ├── [713K]  1D3.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.2M]  i_data.ctab
│   ├── [ 422]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [2.0G]  1D4
│   ├── [ 553]  1D4_checksums.md5
│   ├── [4.5M]  1D4.cov_refs.gtf
│   ├── [ 34M]  1D4.gtf
│   ├── [ 449]  1D4-hisat2_output.flagstat
│   ├── [ 638]  1D4_hisat2.stats
│   ├── [1.9G]  1D4.sorted.bam
│   ├── [884K]  1D4.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.2M]  i_data.ctab
│   ├── [ 422]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.6G]  1D6
│   ├── [ 553]  1D6_checksums.md5
│   ├── [6.8M]  1D6.cov_refs.gtf
│   ├── [ 34M]  1D6.gtf
│   ├── [ 449]  1D6-hisat2_output.flagstat
│   ├── [ 637]  1D6_hisat2.stats
│   ├── [1.6G]  1D6.sorted.bam
│   ├── [778K]  1D6.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.3M]  i_data.ctab
│   ├── [ 422]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.5G]  1D8
│   ├── [ 553]  1D8_checksums.md5
│   ├── [5.6M]  1D8.cov_refs.gtf
│   ├── [ 34M]  1D8.gtf
│   ├── [ 449]  1D8-hisat2_output.flagstat
│   ├── [ 637]  1D8_hisat2.stats
│   ├── [1.4G]  1D8.sorted.bam
│   ├── [688K]  1D8.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.3M]  i_data.ctab
│   ├── [ 422]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.9G]  1D9
│   ├── [ 553]  1D9_checksums.md5
│   ├── [2.4M]  1D9.cov_refs.gtf
│   ├── [ 34M]  1D9.gtf
│   ├── [ 449]  1D9-hisat2_output.flagstat
│   ├── [ 640]  1D9_hisat2.stats
│   ├── [1.8G]  1D9.sorted.bam
│   ├── [799K]  1D9.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.2M]  i_data.ctab
│   ├── [ 422]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [2.0G]  1E1
│   ├── [ 553]  1E1_checksums.md5
│   ├── [5.6M]  1E1.cov_refs.gtf
│   ├── [ 34M]  1E1.gtf
│   ├── [ 450]  1E1-hisat2_output.flagstat
│   ├── [ 638]  1E1_hisat2.stats
│   ├── [1.9G]  1E1.sorted.bam
│   ├── [919K]  1E1.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.3M]  i_data.ctab
│   ├── [ 420]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.6G]  1E3
│   ├── [ 553]  1E3_checksums.md5
│   ├── [7.4M]  1E3.cov_refs.gtf
│   ├── [ 34M]  1E3.gtf
│   ├── [ 449]  1E3-hisat2_output.flagstat
│   ├── [ 637]  1E3_hisat2.stats
│   ├── [1.6G]  1E3.sorted.bam
│   ├── [783K]  1E3.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.3M]  i_data.ctab
│   ├── [ 422]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.6G]  1E5
│   ├── [ 553]  1E5_checksums.md5
│   ├── [6.2M]  1E5.cov_refs.gtf
│   ├── [ 34M]  1E5.gtf
│   ├── [ 449]  1E5-hisat2_output.flagstat
│   ├── [ 637]  1E5_hisat2.stats
│   ├── [1.5G]  1E5.sorted.bam
│   ├── [822K]  1E5.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.3M]  i_data.ctab
│   ├── [ 422]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.8G]  1E9
│   ├── [ 553]  1E9_checksums.md5
│   ├── [4.4M]  1E9.cov_refs.gtf
│   ├── [ 34M]  1E9.gtf
│   ├── [ 449]  1E9-hisat2_output.flagstat
│   ├── [ 638]  1E9_hisat2.stats
│   ├── [1.8G]  1E9.sorted.bam
│   ├── [814K]  1E9.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.2M]  i_data.ctab
│   ├── [ 422]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.6G]  1F11
│   ├── [ 559]  1F11_checksums.md5
│   ├── [7.9M]  1F11.cov_refs.gtf
│   ├── [ 34M]  1F11.gtf
│   ├── [ 449]  1F11-hisat2_output.flagstat
│   ├── [ 636]  1F11_hisat2.stats
│   ├── [1.5G]  1F11.sorted.bam
│   ├── [745K]  1F11.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.3M]  i_data.ctab
│   ├── [ 424]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.6G]  1F4
│   ├── [ 553]  1F4_checksums.md5
│   ├── [7.9M]  1F4.cov_refs.gtf
│   ├── [ 34M]  1F4.gtf
│   ├── [ 449]  1F4-hisat2_output.flagstat
│   ├── [ 637]  1F4_hisat2.stats
│   ├── [1.5G]  1F4.sorted.bam
│   ├── [786K]  1F4.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.3M]  i_data.ctab
│   ├── [ 422]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.8G]  1F8
│   ├── [ 553]  1F8_checksums.md5
│   ├── [2.9M]  1F8.cov_refs.gtf
│   ├── [ 34M]  1F8.gtf
│   ├── [ 449]  1F8-hisat2_output.flagstat
│   ├── [ 640]  1F8_hisat2.stats
│   ├── [1.8G]  1F8.sorted.bam
│   ├── [784K]  1F8.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.2M]  i_data.ctab
│   ├── [ 422]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [2.1G]  1G5
│   ├── [ 553]  1G5_checksums.md5
│   ├── [8.5M]  1G5.cov_refs.gtf
│   ├── [ 34M]  1G5.gtf
│   ├── [ 450]  1G5-hisat2_output.flagstat
│   ├── [ 638]  1G5_hisat2.stats
│   ├── [2.0G]  1G5.sorted.bam
│   ├── [988K]  1G5.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.3M]  i_data.ctab
│   ├── [ 422]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.6G]  1H11
│   ├── [ 559]  1H11_checksums.md5
│   ├── [8.3M]  1H11.cov_refs.gtf
│   ├── [ 34M]  1H11.gtf
│   ├── [ 449]  1H11-hisat2_output.flagstat
│   ├── [ 636]  1H11_hisat2.stats
│   ├── [1.5G]  1H11.sorted.bam
│   ├── [778K]  1H11.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.3M]  i_data.ctab
│   └── [3.7M]  t_data.ctab
├── [1.3G]  1H12
│   ├── [ 559]  1H12_checksums.md5
│   ├── [3.5M]  1H12.cov_refs.gtf
│   ├── [ 34M]  1H12.gtf
│   ├── [ 449]  1H12-hisat2_output.flagstat
│   ├── [ 636]  1H12_hisat2.stats
│   ├── [1.3G]  1H12.sorted.bam
│   ├── [698K]  1H12.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.2M]  i_data.ctab
│   ├── [ 424]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.8G]  1H6
│   ├── [ 553]  1H6_checksums.md5
│   ├── [2.9M]  1H6.cov_refs.gtf
│   ├── [ 34M]  1H6.gtf
│   ├── [ 449]  1H6-hisat2_output.flagstat
│   ├── [ 640]  1H6_hisat2.stats
│   ├── [1.8G]  1H6.sorted.bam
│   ├── [784K]  1H6.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.2M]  i_data.ctab
│   └── [3.7M]  t_data.ctab
├── [1.5G]  1H7
│   ├── [ 553]  1H7_checksums.md5
│   ├── [7.4M]  1H7.cov_refs.gtf
│   ├── [ 34M]  1H7.gtf
│   ├── [ 449]  1H7-hisat2_output.flagstat
│   ├── [ 637]  1H7_hisat2.stats
│   ├── [1.5G]  1H7.sorted.bam
│   ├── [780K]  1H7.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.3M]  i_data.ctab
│   ├── [ 422]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.6G]  1H8
│   ├── [ 553]  1H8_checksums.md5
│   ├── [6.6M]  1H8.cov_refs.gtf
│   ├── [ 34M]  1H8.gtf
│   ├── [ 449]  1H8-hisat2_output.flagstat
│   ├── [ 637]  1H8_hisat2.stats
│   ├── [1.6G]  1H8.sorted.bam
│   ├── [791K]  1H8.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.3M]  i_data.ctab
│   ├── [ 422]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [2.1G]  2B2
│   ├── [ 553]  2B2_checksums.md5
│   ├── [5.3M]  2B2.cov_refs.gtf
│   ├── [ 34M]  2B2.gtf
│   ├── [ 450]  2B2-hisat2_output.flagstat
│   ├── [ 639]  2B2_hisat2.stats
│   ├── [2.0G]  2B2.sorted.bam
│   ├── [961K]  2B2.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.3M]  i_data.ctab
│   ├── [ 424]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.8G]  2B3
│   ├── [ 553]  2B3_checksums.md5
│   ├── [8.2M]  2B3.cov_refs.gtf
│   ├── [ 34M]  2B3.gtf
│   ├── [ 449]  2B3-hisat2_output.flagstat
│   ├── [ 638]  2B3_hisat2.stats
│   ├── [1.7G]  2B3.sorted.bam
│   ├── [818K]  2B3.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.3M]  i_data.ctab
│   ├── [ 424]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.8G]  2C1
│   ├── [ 553]  2C1_checksums.md5
│   ├── [4.0M]  2C1.cov_refs.gtf
│   ├── [ 34M]  2C1.gtf
│   ├── [ 448]  2C1-hisat2_output.flagstat
│   ├── [ 638]  2C1_hisat2.stats
│   ├── [1.7G]  2C1.sorted.bam
│   ├── [636K]  2C1.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.2M]  i_data.ctab
│   ├── [ 422]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.6G]  2C2
│   ├── [ 553]  2C2_checksums.md5
│   ├── [7.6M]  2C2.cov_refs.gtf
│   ├── [ 34M]  2C2.gtf
│   ├── [ 450]  2C2-hisat2_output.flagstat
│   ├── [ 637]  2C2_hisat2.stats
│   ├── [1.5G]  2C2.sorted.bam
│   ├── [794K]  2C2.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.3M]  i_data.ctab
│   ├── [ 424]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [2.0G]  2D2
│   ├── [ 553]  2D2_checksums.md5
│   ├── [2.9M]  2D2.cov_refs.gtf
│   ├── [ 34M]  2D2.gtf
│   ├── [ 449]  2D2-hisat2_output.flagstat
│   ├── [ 640]  2D2_hisat2.stats
│   ├── [1.9G]  2D2.sorted.bam
│   ├── [795K]  2D2.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.2M]  i_data.ctab
│   ├── [ 424]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.4G]  2E2
│   ├── [ 553]  2E2_checksums.md5
│   ├── [2.2M]  2E2.cov_refs.gtf
│   ├── [ 33M]  2E2.gtf
│   ├── [ 449]  2E2-hisat2_output.flagstat
│   ├── [ 639]  2E2_hisat2.stats
│   ├── [1.4G]  2E2.sorted.bam
│   ├── [632K]  2E2.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.2M]  i_data.ctab
│   ├── [ 424]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [2.6G]  2F1
│   ├── [ 553]  2F1_checksums.md5
│   ├── [2.9M]  2F1.cov_refs.gtf
│   ├── [ 34M]  2F1.gtf
│   ├── [ 451]  2F1-hisat2_output.flagstat
│   ├── [ 642]  2F1_hisat2.stats
│   ├── [2.5G]  2F1.sorted.bam
│   ├── [980K]  2F1.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.2M]  i_data.ctab
│   ├── [ 424]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [1.6G]  2G1
│   ├── [ 553]  2G1_checksums.md5
│   ├── [6.1M]  2G1.cov_refs.gtf
│   ├── [ 34M]  2G1.gtf
│   ├── [ 449]  2G1-hisat2_output.flagstat
│   ├── [ 637]  2G1_hisat2.stats
│   ├── [1.6G]  2G1.sorted.bam
│   ├── [724K]  2G1.sorted.bam.bai
│   ├── [2.4M]  e2t.ctab
│   ├── [ 15M]  e_data.ctab
│   ├── [1.9M]  i2t.ctab
│   ├── [7.3M]  i_data.ctab
│   ├── [ 424]  input_fastqs_checksums.md5
│   └── [3.7M]  t_data.ctab
├── [ 35M]  Apulchra-genome.stringtie.gtf
├── [5.1M]  apul-gene_count_matrix.csv
├── [5.2M]  apul-transcript_count_matrix.csv
├── [ 587]  checksums.md5
├── [5.1K]  gtf_list.txt
├── [306K]  multiqc_data
│   ├── [5.0K]  multiqc_bowtie2.txt
│   ├── [ 307]  multiqc_citations.txt
│   ├── [268K]  multiqc_data.json
│   ├── [2.7K]  multiqc_general_stats.txt
│   ├── [4.1K]  multiqc.log
│   ├── [7.7K]  multiqc_samtools_flagstat.txt
│   └── [ 14K]  multiqc_sources.txt
├── [1.1M]  multiqc_report.html
├── [5.2K]  prepDE-sample_list.txt
├── [ 856]  sorted_bams.list
├── [ 64G]  sorted-bams-merged.bam
└── [ 13M]  sorted-bams-merged.bam.bai

 135G used in 41 directories, 535 files</code></pre>
</section>
<section id="multiqc-alignment-rates" class="level2">
<h2 class="anchored" data-anchor-id="multiqc-alignment-rates">3.2 MultiQC alignment rates</h2>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb8-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb8-3"></span>
<span id="cb8-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change to ouput directory</span></span>
<span id="cb8-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb8-6"></span>
<span id="cb8-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>multiqc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> .</span></code></pre></div>
</section>
</section>
<section id="merge-sorted-bams" class="level1">
<h1>4 Merge sorted BAMs</h1>
<p>Merge all BAMs to singular BAM for use in transcriptome assembly later, if needed.</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb9-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb9-3"></span>
<span id="cb9-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change to ouput directory</span></span>
<span id="cb9-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-6"></span>
<span id="cb9-7"></span>
<span id="cb9-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Create list of sorted BAMs for merging</span></span>
<span id="cb9-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> . <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-name</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*sorted.bam"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> sorted_bams.list</span>
<span id="cb9-10"></span>
<span id="cb9-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Merge sorted BAMs</span></span>
<span id="cb9-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>samtools<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> merge <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-13">-b sorted_bams.list <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-14"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${merged_bam}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-15">--threads <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span></span>
<span id="cb9-16"></span>
<span id="cb9-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Index merged BAM</span></span>
<span id="cb9-18"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>samtools<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> index <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${merged_bam}</span></span></code></pre></div>
</section>
<section id="create-combined-gtf" class="level1">
<h1>5 Create combined GTF</h1>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb10-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb10-3"></span>
<span id="cb10-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change to ouput directory</span></span>
<span id="cb10-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb10-6"></span>
<span id="cb10-7"></span>
<span id="cb10-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create singular transcript file, using GTF list file</span></span>
<span id="cb10-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>stringtie<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--merge</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${gtf_list}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-11">-p <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-12">-G <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_gff}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-13">-o <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_index_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.stringtie.gtf</span></code></pre></div>
</section>
<section id="create-deseq2-count-matrices" class="level1">
<h1>6 Create DESeq2 Count Matrices</h1>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb11-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb11-3"></span>
<span id="cb11-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change to ouput directory</span></span>
<span id="cb11-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb11-6"></span>
<span id="cb11-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create file list for prepDE.py</span></span>
<span id="cb11-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">read</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">line</span></span>
<span id="cb11-9"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb11-10">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_no_path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb11-11">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_no_path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>.<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb11-12">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span></span>
<span id="cb11-13"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> gtf_list.txt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> prepDE-sample_list.txt</span>
<span id="cb11-14"></span>
<span id="cb11-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create count matrices for genes and transcripts</span></span>
<span id="cb11-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compatible with import to DESeq2</span></span>
<span id="cb11-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>prepDE<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-18">--input=prepDE-sample_list.txt <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-19">-g apul-gene_count_matrix.csv <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-20">-t apul-transcript_count_matrix.csv <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-21">--length=<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${read_length}</span></span></code></pre></div>
</section>
<section id="generate-checksums" class="level1">
<h1>7 Generate checksums</h1>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb12-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb12-3"></span>
<span id="cb12-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change to ouput directory</span></span>
<span id="cb12-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb12-6"></span>
<span id="cb12-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Uses find command to avoid passing</span></span>
<span id="cb12-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># directory names to the md5sum command.</span></span>
<span id="cb12-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> . <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-maxdepth</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-type</span> f <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-exec</span> md5sum {} + <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-10"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--append</span> checksums.md5</span></code></pre></div>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-kim2019" class="csl-entry">
Kim, Daehwan, Joseph M. Paggi, Chanhee Park, Christopher Bennett, and Steven L. Salzberg. 2019. <span>“Graph-Based Genome Alignment and Genotyping with HISAT2 and HISAT-Genotype.”</span> <em>Nature Biotechnology</em> 37 (8): 907–15. <a href="https://doi.org/10.1038/s41587-019-0201-4">https://doi.org/10.1038/s41587-019-0201-4</a>.
</div>
<div id="ref-pertea2016" class="csl-entry">
Pertea, Mihaela, Daehwan Kim, Geo M Pertea, Jeffrey T Leek, and Steven L Salzberg. 2016. <span>“Transcript-Level Expression Analysis of RNA-Seq Experiments with HISAT, StringTie and Ballgown.”</span> <em>Nature Protocols</em> 11 (9): 1650–67. <a href="https://doi.org/10.1038/nprot.2016.095">https://doi.org/10.1038/nprot.2016.095</a>.
</div>
<div id="ref-pertea2015" class="csl-entry">
Pertea, Mihaela, Geo M Pertea, Corina M Antonescu, Tsung-Cheng Chang, Joshua T Mendell, and Steven L Salzberg. 2015. <span>“StringTie Enables Improved Reconstruction of a Transcriptome from RNA-Seq Reads.”</span> <em>Nature Biotechnology</em> 33 (3): 290–95. <a href="https://doi.org/10.1038/nbt.3122">https://doi.org/10.1038/nbt.3122</a>.
</div>
</div></section></div> ]]></description>
  <category>2024</category>
  <category>30-1047560508</category>
  <category>RNA-seq</category>
  <category>E5</category>
  <category>timeseries_molecular</category>
  <category>HISAT2</category>
  <category>StringTie</category>
  <category>alignment</category>
  <category>Acropora pulchra</category>
  <category>coral</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-08-RNA-seq-Alignment---A.pulchra-RNA-seq-Alignments-Using-HISAT2-and-StringTie-for-Azenta-Project-30-1047560508/</guid>
  <pubDate>Tue, 08 Oct 2024 07:00:00 GMT</pubDate>
</item>
<item>
  <title>Data Wrangling - Generate GTF from A.pulchra Genome GFF Using gffread</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-08-Data-Wrangling---Generate-GTF-from-A.pulchra-Genome-GFF-Using-gffread/</link>
  <description><![CDATA[ 





<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This notebook entry is knitted from <a href="https://github.com/urol-e5/timeseries_molecular/blob/cf654b9967c7a5d81e3aeca370b0c8f324badcbd/D-Apul/code/02.00-D-Apul-RNAseq-gff-to-gtf.Rmd"><code>urol-e5/timeseries_molecular/D-Apul/code/02.00-D-Apul-RNAseq-gff-to-gtf.Rmd</code></a> (GitHub), commit <code>cf654b9</code>.</p>
</div>
</div>
<p>This notebook will utilize <a href="https://ccb.jhu.edu/software/stringtie/gff.shtml">gffread</a> <span class="citation" data-cites="pertea2020">(Pertea and Pertea 2020)</span> to create an <em>A.pulchras</em> GTF file from the <em>A.pulchra</em> genome GFF, which is needed for downstream analysis with <a href="https://github.com/DaehwanKimLab/hisat2">HISAT2</a>; specifically for identification of exons and splice sites.</p>
<section id="create-a-bash-variables-file" class="level1">
<h1>1 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export timeseries_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export genome_dir="${timeseries_dir}/D-Apul/data"'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export output_dir_top=${timeseries_dir}/D-Apul/output/02.00-D-Apul-RNAseq-gff-to-gtf'</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-10"></span>
<span id="cb1-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Input/output files"</span></span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export genome_gff="${genome_dir}/Apulchra-genome.gff"'</span></span>
<span id="cb1-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export transcripts_gtf="Apulchra-genome.gtf"'</span></span>
<span id="cb1-15"></span>
<span id="cb1-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Paths to programs"</span></span>
<span id="cb1-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export programs_dir="/home/shared"'</span></span>
<span id="cb1-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export gffread="${programs_dir}/gffread-0.12.7.Linux_x86_64/gffread"'</span></span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set number of CPUs to use"</span></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=40'</span></span>
<span id="cb1-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-23"></span>
<span id="cb1-24"></span>
<span id="cb1-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Programs associative array"</span></span>
<span id="cb1-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"declare -A programs_array"</span></span>
<span id="cb1-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"programs_array=("</span></span>
<span id="cb1-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[gffread]="${gffread}" \'</span></span>
<span id="cb1-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span></span>
<span id="cb1-30"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-31"></span>
<span id="cb1-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Print formatting"</span></span>
<span id="cb1-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-35"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-36"></span>
<span id="cb1-37"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export timeseries_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular
export genome_dir="${timeseries_dir}/D-Apul/data"
export output_dir_top=${timeseries_dir}/D-Apul/output/02.00-D-Apul-RNAseq-gff-to-gtf

# Input/output files
export genome_gff="${genome_dir}/Apulchra-genome.gff"
export transcripts_gtf="Apulchra-genome.gtf"
# Paths to programs
export programs_dir="/home/shared"
export gffread="${programs_dir}/gffread-0.12.7.Linux_x86_64/gffread"
# Set number of CPUs to use
export threads=40

# Programs associative array
declare -A programs_array
programs_array=(
[gffread]="${gffread}" \
)

# Print formatting
export line="--------------------------------------------------------"</code></pre>
</section>
<section id="preview-and-validate-genome-gff" class="level1">
<h1>2 Preview and Validate Genome GFF</h1>
<section id="inspect-gff" class="level2">
<h2 class="anchored" data-anchor-id="inspect-gff">2.1 Inspect GFF</h2>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make directories, if they don't exist</span></span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 20 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_gff}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<pre><code>##gff-version 3
ntLink_0    funannotate gene    1105    7056    .   +   .   ID=FUN_000001;
ntLink_0    funannotate mRNA    1105    7056    .   +   .   ID=FUN_000001-T1;Parent=FUN_000001;product=hypothetical protein;
ntLink_0    funannotate exon    1105    1188    .   +   .   ID=FUN_000001-T1.exon1;Parent=FUN_000001-T1;
ntLink_0    funannotate exon    1861    1941    .   +   .   ID=FUN_000001-T1.exon2;Parent=FUN_000001-T1;
ntLink_0    funannotate exon    2762    2839    .   +   .   ID=FUN_000001-T1.exon3;Parent=FUN_000001-T1;
ntLink_0    funannotate exon    5044    7056    .   +   .   ID=FUN_000001-T1.exon4;Parent=FUN_000001-T1;
ntLink_0    funannotate CDS 1105    1188    .   +   0   ID=FUN_000001-T1.cds;Parent=FUN_000001-T1;
ntLink_0    funannotate CDS 1861    1941    .   +   0   ID=FUN_000001-T1.cds;Parent=FUN_000001-T1;
ntLink_0    funannotate CDS 2762    2839    .   +   0   ID=FUN_000001-T1.cds;Parent=FUN_000001-T1;
ntLink_0    funannotate CDS 5044    7056    .   +   0   ID=FUN_000001-T1.cds;Parent=FUN_000001-T1;
ntLink_0    funannotate gene    10215   15286   .   +   .   ID=FUN_000002;
ntLink_0    funannotate mRNA    10215   15286   .   +   .   ID=FUN_000002-T1;Parent=FUN_000002;product=hypothetical protein;
ntLink_0    funannotate exon    10215   10413   .   +   .   ID=FUN_000002-T1.exon1;Parent=FUN_000002-T1;
ntLink_0    funannotate exon    10614   10676   .   +   .   ID=FUN_000002-T1.exon2;Parent=FUN_000002-T1;
ntLink_0    funannotate exon    11272   11316   .   +   .   ID=FUN_000002-T1.exon3;Parent=FUN_000002-T1;
ntLink_0    funannotate exon    11518   11591   .   +   .   ID=FUN_000002-T1.exon4;Parent=FUN_000002-T1;
ntLink_0    funannotate exon    12241   12501   .   +   .   ID=FUN_000002-T1.exon5;Parent=FUN_000002-T1;
ntLink_0    funannotate exon    13074   14383   .   +   .   ID=FUN_000002-T1.exon6;Parent=FUN_000002-T1;
ntLink_0    funannotate exon    14722   14900   .   +   .   ID=FUN_000002-T1.exon7;Parent=FUN_000002-T1;</code></pre>
</section>
<section id="valdiate-gff" class="level2">
<h2 class="anchored" data-anchor-id="valdiate-gff">2.2 Valdiate GFF</h2>
<p>This identifies if there are rows with &gt;9 fields (which there shouldn’t be in a <a href="http://gmod.org/wiki/GFF3">GFF3</a>).</p>
<p>Additionally, it provides a preview of all rows lengths identified.</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Capture number of fields (NF) in each row in array.</span></span>
<span id="cb5-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">field_count_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">($(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\t"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print NF}'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_gff}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--unique</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">))</span></span>
<span id="cb5-6"></span>
<span id="cb5-7"></span>
<span id="cb5-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check array contents</span></span>
<span id="cb5-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"List of number of fields in </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_gff}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:"</span></span>
<span id="cb5-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> field_count <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${field_count_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-13">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${field_count}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-14"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb5-15"></span>
<span id="cb5-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-19"></span>
<span id="cb5-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Preview of each line "type" with a given number of fields</span></span>
<span id="cb5-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check array contents</span></span>
<span id="cb5-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-23"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> field_count <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${field_count_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-24"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-25">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Preview of lines with </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${field_count}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> field(s):"</span></span>
<span id="cb5-26">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-v</span> field_count=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${field_count}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\t"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-30">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'NF == field_count'</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-31">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_gff}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-32">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span></span>
<span id="cb5-33">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-34">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-35">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-36"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<pre><code>List of number of fields in /home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/Apulchra-genome.gff:

1
9

--------------------------------------------------------


Preview of lines with 1 field(s):

##gff-version 3

--------------------------------------------------------

Preview of lines with 9 field(s):

ntLink_0    funannotate gene    1105    7056    .   +   .   ID=FUN_000001;
ntLink_0    funannotate mRNA    1105    7056    .   +   .   ID=FUN_000001-T1;Parent=FUN_000001;product=hypothetical protein;
ntLink_0    funannotate exon    1105    1188    .   +   .   ID=FUN_000001-T1.exon1;Parent=FUN_000001-T1;
ntLink_0    funannotate exon    1861    1941    .   +   .   ID=FUN_000001-T1.exon2;Parent=FUN_000001-T1;
ntLink_0    funannotate exon    2762    2839    .   +   .   ID=FUN_000001-T1.exon3;Parent=FUN_000001-T1;
ntLink_0    funannotate exon    5044    7056    .   +   .   ID=FUN_000001-T1.exon4;Parent=FUN_000001-T1;
ntLink_0    funannotate CDS 1105    1188    .   +   0   ID=FUN_000001-T1.cds;Parent=FUN_000001-T1;
ntLink_0    funannotate CDS 1861    1941    .   +   0   ID=FUN_000001-T1.cds;Parent=FUN_000001-T1;
ntLink_0    funannotate CDS 2762    2839    .   +   0   ID=FUN_000001-T1.cds;Parent=FUN_000001-T1;
ntLink_0    funannotate CDS 5044    7056    .   +   0   ID=FUN_000001-T1.cds;Parent=FUN_000001-T1;

--------------------------------------------------------</code></pre>
<p>Great! This looks like a valid GFF. Can proceed with GTF generation.</p>
</section>
</section>
<section id="generate-gtf" class="level1">
<h1>3 Generate GTF</h1>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb7-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>gffread<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-E</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_gff}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-T</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-6">1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${transcripts_gtf}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-7">2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/gffread-gff_to_gtf.stderr</span></code></pre></div>
</section>
<section id="inspect-gtf" class="level1">
<h1>4 Inspect GTF</h1>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb8-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb8-3"></span>
<span id="cb8-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${transcripts_gtf}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<pre><code>ntLink_0    funannotate transcript  1105    7056    .   +   .   transcript_id "FUN_000001-T1"; gene_id "FUN_000001"
ntLink_0    funannotate exon    1105    1188    .   +   .   transcript_id "FUN_000001-T1"; gene_id "FUN_000001";
ntLink_0    funannotate exon    1861    1941    .   +   .   transcript_id "FUN_000001-T1"; gene_id "FUN_000001";
ntLink_0    funannotate exon    2762    2839    .   +   .   transcript_id "FUN_000001-T1"; gene_id "FUN_000001";
ntLink_0    funannotate exon    5044    7056    .   +   .   transcript_id "FUN_000001-T1"; gene_id "FUN_000001";
ntLink_0    funannotate CDS 1105    1188    .   +   0   transcript_id "FUN_000001-T1"; gene_id "FUN_000001";
ntLink_0    funannotate CDS 1861    1941    .   +   0   transcript_id "FUN_000001-T1"; gene_id "FUN_000001";
ntLink_0    funannotate CDS 2762    2839    .   +   0   transcript_id "FUN_000001-T1"; gene_id "FUN_000001";
ntLink_0    funannotate CDS 5044    7056    .   +   0   transcript_id "FUN_000001-T1"; gene_id "FUN_000001";
ntLink_0    funannotate transcript  10215   15286   .   +   .   transcript_id "FUN_000002-T1"; gene_id "FUN_000002"</code></pre>
<section id="copy-gtf-to-d-apuldata" class="level2">
<h2 class="anchored" data-anchor-id="copy-gtf-to-d-apuldata">4.1 Copy GTF to <code>D-Apul/data</code></h2>
<p>To help make this easier to locate, will copy to the <code>D-Apul/data</code> directory, which also contains the genome FastA, genome FastA index, and the genome GFF files.</p>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb10-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb10-3"></span>
<span id="cb10-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cp</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${transcripts_gtf}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-pertea2020" class="csl-entry">
Pertea, Geo, and Mihaela Pertea. 2020. <span>“GFF Utilities: GffRead and GffCompare.”</span> <em>F1000Research</em> 9 (April): 304. <a href="https://doi.org/10.12688/f1000research.23297.1">https://doi.org/10.12688/f1000research.23297.1</a>.
</div>
</div></section></div> ]]></description>
  <category>2024</category>
  <category>coral</category>
  <category>Acropora pulchra</category>
  <category>genome</category>
  <category>GFF</category>
  <category>GTF</category>
  <category>gffread</category>
  <category>E5</category>
  <category>timeseries_molecular</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-08-Data-Wrangling---Generate-GTF-from-A.pulchra-Genome-GFF-Using-gffread/</guid>
  <pubDate>Tue, 08 Oct 2024 07:00:00 GMT</pubDate>
</item>
<item>
  <title>Genome Indexing - A.pulchra Genome Using HISAT2</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-08-Genome-Indexing---A.pulchra-Genome-Using-HISAT2/</link>
  <description><![CDATA[ 





<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This notebook entry is knitted from <a href="https://github.com/urol-e5/timeseries_molecular/blob/da11371ef1d0b24b991446cef9865357773c4301/D-Apul/code/02.10-D-Apul-RNAseq-genome-index-HiSat2.Rmd"><code>urol-e5/timeseries_molecular/D-Apul/code/02.10-D-Apul-RNAseq-genome-index-HiSat2.Rmd</code></a> (GitHub), commit <code>da11371</code>.</p>
</div>
</div>
<p>This notebook will build an index of the <em>A.pulchra</em> genome using <a href="https://github.com/DaehwanKimLab/hisat2">HISAT2</a> <span class="citation" data-cites="kim2019">(Kim et al. 2019)</span>. It utilizes the GTF file created in <a href="https://github.com/urol-e5/timeseries_molecular/blob/main/D-Apul/code/02.00-D-Apul-RNAseq-gff-to-gtf.Rmd"><code>02.00-D-Apul-RNAseq-gff-to-gtf.Rmd</code></a>.</p>
<section id="create-a-bash-variables-file" class="level1">
<h1>1 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export timeseries_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export genome_dir="${timeseries_dir}/D-Apul/data"'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export output_dir_top=${timeseries_dir}/D-Apul/output/02.10-D-Apul-RNAseq-genome-index-HiSat2'</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-10"></span>
<span id="cb1-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Input/output files"</span></span>
<span id="cb1-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export genome_index_name="Apulchra-genome"'</span></span>
<span id="cb1-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export exons="${output_dir_top}/Apulchra-genome_hisat2_exons.tab"'</span></span>
<span id="cb1-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export genome_gff="${genome_dir}/Apulchra-genome.gff"'</span></span>
<span id="cb1-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export genome_fasta="${genome_dir}/Apulchra-genome.fa"'</span></span>
<span id="cb1-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export splice_sites="${output_dir_top}/Apulchra-genome_hisat2_splice_sites.tab"'</span></span>
<span id="cb1-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export transcripts_gtf="${genome_dir}/Apulchra-genome.gtf"'</span></span>
<span id="cb1-18"></span>
<span id="cb1-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Paths to programs"</span></span>
<span id="cb1-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export programs_dir="/home/shared"'</span></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export hisat2_dir="${programs_dir}/hisat2-2.2.1"'</span></span>
<span id="cb1-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-23"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export hisat2_build="${hisat2_dir}/hisat2-build"'</span></span>
<span id="cb1-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export hisat2_exons="${hisat2_dir}/hisat2_extract_exons.py"'</span></span>
<span id="cb1-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export hisat2_splice_sites="${hisat2_dir}/hisat2_extract_splice_sites.py"'</span></span>
<span id="cb1-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-27"></span>
<span id="cb1-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set number of CPUs to use"</span></span>
<span id="cb1-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=40'</span></span>
<span id="cb1-30"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-31"></span>
<span id="cb1-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Programs associative array"</span></span>
<span id="cb1-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"declare -A programs_array"</span></span>
<span id="cb1-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"programs_array=("</span></span>
<span id="cb1-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[hisat2]="${hisat2}" \'</span></span>
<span id="cb1-36"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[hisat2_build]="${hisat2_build}" \'</span></span>
<span id="cb1-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[hisat2_exons]="${hisat2_exons}" \'</span></span>
<span id="cb1-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[hisat2_splice_sites]="${hisat2_splice_sites}" \'</span></span>
<span id="cb1-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span></span>
<span id="cb1-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-41"></span>
<span id="cb1-42"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Print formatting"</span></span>
<span id="cb1-43"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-44"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-45"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-46"></span>
<span id="cb1-47"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export timeseries_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular
export genome_dir="${timeseries_dir}/D-Apul/data"
export output_dir_top=${timeseries_dir}/D-Apul/output/02.10-D-Apul-RNAseq-genome-index-HiSat2

# Input/output files
export genome_index_name="Apulchra-genome"
export exons="${output_dir_top}/Apulchra-genome_hisat2_exons.tab"
export genome_gff="${genome_dir}/Apulchra-genome.gff"
export genome_fasta="${genome_dir}/Apulchra-genome.fa"
export splice_sites="${output_dir_top}/Apulchra-genome_hisat2_splice_sites.tab"
export transcripts_gtf="${genome_dir}/Apulchra-genome.gtf"
# Paths to programs
export programs_dir="/home/shared"
export hisat2_dir="${programs_dir}/hisat2-2.2.1"

export hisat2_build="${hisat2_dir}/hisat2-build"
export hisat2_exons="${hisat2_dir}/hisat2_extract_exons.py"
export hisat2_splice_sites="${hisat2_dir}/hisat2_extract_splice_sites.py"

# Set number of CPUs to use
export threads=40

# Programs associative array
declare -A programs_array
programs_array=(
[hisat2]="${hisat2}" \
[hisat2_build]="${hisat2_build}" \
[hisat2_exons]="${hisat2_exons}" \
[hisat2_splice_sites]="${hisat2_splice_sites}" \
)

# Print formatting
export line="--------------------------------------------------------"</code></pre>
</section>
<section id="identify-exons" class="level1">
<h1>2 Identify exons</h1>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make directories, if they don't exist</span></span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create Hisat2 exons tab file</span></span>
<span id="cb3-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>hisat2_exons<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${transcripts_gtf}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-10"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${exons}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-11"></span>
<span id="cb3-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${exons}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<pre><code>ntLink_0    1104    1187    +
ntLink_0    1860    1940    +
ntLink_0    2761    2838    +
ntLink_0    5043    7055    +
ntLink_0    10214   10412   +
ntLink_0    10613   10675   +
ntLink_0    11271   11315   +
ntLink_0    11517   11590   +
ntLink_0    12240   12500   +
ntLink_0    13073   14382   +</code></pre>
</section>
<section id="identify-splice-sites" class="level1">
<h1>3 Identify splice sites</h1>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create Hisat2 splice sites tab file</span></span>
<span id="cb5-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>hisat2_splice_sites<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${transcripts_gtf}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-7"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${splice_sites}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-8"></span>
<span id="cb5-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${splice_sites}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<pre><code>ntLink_0    1187    1860    +
ntLink_0    1940    2761    +
ntLink_0    2838    5043    +
ntLink_0    10412   10613   +
ntLink_0    10675   11271   +
ntLink_0    11315   11517   +
ntLink_0    11590   12240   +
ntLink_0    12500   13073   +
ntLink_0    14382   14721   +
ntLink_0    14899   15032   +</code></pre>
</section>
<section id="build-hisat2-genome-index" class="level1">
<h1>4 Build HISAT2 genome index</h1>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb7-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change to working directory</span></span>
<span id="cb7-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Build Hisat2 reference index using splice sites and exons</span></span>
<span id="cb7-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>hisat2_build<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_fasta}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_index_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-11">--exon <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${exons}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-12">--ss <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${splice_sites}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-13">-p <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-14">2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_index_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>-hisat2_build.err</span>
<span id="cb7-15"></span>
<span id="cb7-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span></span></code></pre></div>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb8-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb8-3"></span>
<span id="cb8-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> index <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.ht2</span>
<span id="cb8-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb8-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cp</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${index}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_dir}</span></span>
<span id="cb8-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb8-8"></span>
<span id="cb8-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<pre><code>total 1.1G
-rw-r--r-- 1 sam sam 312M Oct  8 12:19 Apulchra-genome.1.ht2
-rw-r--r-- 1 sam sam 125M Oct  8 12:19 Apulchra-genome.2.ht2
-rw-r--r-- 1 sam sam 1.6K Oct  8 12:09 Apulchra-genome.3.ht2
-rw-r--r-- 1 sam sam 124M Oct  8 12:09 Apulchra-genome.4.ht2
-rw-r--r-- 1 sam sam 335M Oct  8 12:21 Apulchra-genome.5.ht2
-rw-r--r-- 1 sam sam 127M Oct  8 12:21 Apulchra-genome.6.ht2
-rw-r--r-- 1 sam sam 7.2M Oct  8 12:09 Apulchra-genome.7.ht2
-rw-r--r-- 1 sam sam 1.5M Oct  8 12:09 Apulchra-genome.8.ht2
-rw-r--r-- 1 sam sam  21K Oct  8 12:21 Apulchra-genome-hisat2_build.err
-rw-r--r-- 1 sam sam 5.9M Oct  8 12:35 Apulchra-genome_hisat2_exons.tab
-rw-r--r-- 1 sam sam 4.7M Oct  8 12:35 Apulchra-genome_hisat2_splice_sites.tab</code></pre>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-kim2019" class="csl-entry">
Kim, Daehwan, Joseph M. Paggi, Chanhee Park, Christopher Bennett, and Steven L. Salzberg. 2019. <span>“Graph-Based Genome Alignment and Genotyping with HISAT2 and HISAT-Genotype.”</span> <em>Nature Biotechnology</em> 37 (8): 907–15. <a href="https://doi.org/10.1038/s41587-019-0201-4">https://doi.org/10.1038/s41587-019-0201-4</a>.
</div>
</div></section></div> ]]></description>
  <category>2024</category>
  <category>coral</category>
  <category>Acropora pulchra</category>
  <category>HISAT2</category>
  <category>E5</category>
  <category>timeseries_molecular</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-08-Genome-Indexing---A.pulchra-Genome-Using-HISAT2/</guid>
  <pubDate>Tue, 08 Oct 2024 07:00:00 GMT</pubDate>
</item>
<item>
  <title>FastQC Trimming and QC - A.pulchra RNA-seq from Azenta Project 30-1047560508 Using fastp</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-05-FastQC-Trimming-and-QC---A.pulchra-RNA-seq-from-Azenta-Project-30-1047560508-Using-fastp/</link>
  <description><![CDATA[ 





<p>This Rmd file trims <em>A.pulchra</em> RNA-seq files using <a href="https://github.com/OpenGene/fastp">fastp</a> <span class="citation" data-cites="chen2023">(Chen 2023)</span>, followed by quality checks with <a href="https://github.com/s-andrews/FastQC">FastQC</a> and <a href="https://multiqc.info/">MultiQC</a> <span class="citation" data-cites="ewels2016">(Ewels et al. 2016)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This notebook entry is knitted from <a href="https://github.com/urol-e5/timeseries_molecular/blob/5245d490fceb30c2ddecdbaa5dead3eccf56be95/D-Apul/code/01.00-D-Apul-RNAseq-trimming-fastp-FastQC-MultiQC.Rmd"><code>urol-e5/timeseries_molecular/D-Apul/code/01.00-D-Apul-RNAseq-trimming-fastp-FastQC-MultiQC.Rmd</code></a> (GitHub), commit <code>5245d49</code>.</p>
</div>
</div>
<p>This Rmd file trims <em>A.pulchra</em> RNA-seq files using <a href="https://github.com/OpenGene/fastp">fastp</a> <span class="citation" data-cites="chen2023">(Chen 2023)</span>, followed by quality checks with <a href="https://github.com/s-andrews/FastQC">FastQC</a> and <a href="https://multiqc.info/">MultiQC</a> <span class="citation" data-cites="ewels2016">(Ewels et al. 2016)</span>.</p>
<p>Expects input files formatted like so: <code>&lt;number&gt;--&lt;sample_name&gt;_R[12]_001.fastq.gz</code></p>
<p>All trimmed FastQs produced by this script are here:</p>
<p><a href="https://gannet.fish.washington.edu/Atumefaciens/gitrepos/urol-e5/timeseries_molecular/D-Apul/output/01.00-D-Apul-RNAseq-trimming-fastp-FastQC-MultiQC/trimmed-fastqs/">01.00-D-Apul-RNAseq-trimming-fastp-FastQC-MultiQC/trimmed-fastqs/</a></p>
<section id="create-a-bash-variables-file" class="level1">
<h1>1 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export timeseries_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export output_dir_top=${timeseries_dir}/D-Apul/output/01.00-D-Apul-RNAseq-trimming-fastp-FastQC-MultiQC'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_dir=${timeseries_dir}/D-Apul/data/raw-fastqs'</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_url="https://owl.fish.washington.edu/nightingales/E5-coral-time-series/30-1047560508/"'</span></span>
<span id="cb1-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export trimmed_fastqs_dir=${output_dir_top}/trimmed-fastqs'</span></span>
<span id="cb1-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export trimmed_fastqc_dir=${output_dir_top}/trimmed-fastqc'</span></span>
<span id="cb1-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-13"></span>
<span id="cb1-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Paths to programs"</span></span>
<span id="cb1-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export programs_dir="/home/shared"'</span></span>
<span id="cb1-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastp="${programs_dir}/fastp"'</span></span>
<span id="cb1-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastqc=${programs_dir}/FastQC-0.12.1/fastqc'</span></span>
<span id="cb1-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export multiqc=/home/sam/programs/mambaforge/bin/multiqc'</span></span>
<span id="cb1-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-20"></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set FastQ filename patterns"</span></span>
<span id="cb1-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export fastq_pattern='*.fastq.gz'"</span></span>
<span id="cb1-23"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R1_fastq_pattern='*_R1_*.fastq.gz'"</span></span>
<span id="cb1-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R2_fastq_pattern='*_R2_*.fastq.gz'"</span></span>
<span id="cb1-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export trimmed_fastq_pattern='*fastp-trim.fq.gz'"</span></span>
<span id="cb1-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-27"></span>
<span id="cb1-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set number of CPUs to use"</span></span>
<span id="cb1-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=40'</span></span>
<span id="cb1-30"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-31"></span>
<span id="cb1-32"></span>
<span id="cb1-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"## Inititalize arrays"</span></span>
<span id="cb1-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R1=()'</span></span>
<span id="cb1-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R2=()'</span></span>
<span id="cb1-36"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_fastqs_array=()'</span></span>
<span id="cb1-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R1_names_array=()'</span></span>
<span id="cb1-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R2_names_array=()'</span></span>
<span id="cb1-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-40"></span>
<span id="cb1-41"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Programs associative array"</span></span>
<span id="cb1-42"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"declare -A programs_array"</span></span>
<span id="cb1-43"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"programs_array=("</span></span>
<span id="cb1-44"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[fastp]="${fastp}" \'</span></span>
<span id="cb1-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[fastqc]="${fastqc}" \'</span></span>
<span id="cb1-46"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[multiqc]="${multiqc}" \'</span></span>
<span id="cb1-47"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span></span>
<span id="cb1-48"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-49"></span>
<span id="cb1-50"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Print formatting"</span></span>
<span id="cb1-51"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-52"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-53"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-54"></span>
<span id="cb1-55"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export timeseries_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular
export output_dir_top=${timeseries_dir}/D-Apul/output/01.00-D-Apul-RNAseq-trimming-fastp-FastQC-MultiQC
export raw_reads_dir=${timeseries_dir}/D-Apul/data/raw-fastqs
export raw_reads_url="https://owl.fish.washington.edu/nightingales/E5-coral-time-series/30-1047560508/"
export trimmed_fastqs_dir=${output_dir_top}/trimmed-fastqs
export trimmed_fastqc_dir=${output_dir_top}/trimmed-fastqc

# Paths to programs
export programs_dir="/home/shared"
export fastp="${programs_dir}/fastp"
export fastqc=${programs_dir}/FastQC-0.12.1/fastqc
export multiqc=/home/sam/programs/mambaforge/bin/multiqc

# Set FastQ filename patterns
export fastq_pattern='*.fastq.gz'
export R1_fastq_pattern='*_R1_*.fastq.gz'
export R2_fastq_pattern='*_R2_*.fastq.gz'
export trimmed_fastq_pattern='*fastp-trim.fq.gz'

# Set number of CPUs to use
export threads=40

## Inititalize arrays
export fastq_array_R1=()
export fastq_array_R2=()
export raw_fastqs_array=()
export R1_names_array=()
export R2_names_array=()

# Programs associative array
declare -A programs_array
programs_array=(
[fastp]="${fastp}" \
[fastqc]="${fastqc}" \
[multiqc]="${multiqc}" \
)

# Print formatting
export line="--------------------------------------------------------"</code></pre>
<p>If needed, download raw RNA-seq.</p>
<p>Change <code>eval=FALSE</code> to <code>eval=TRUE</code> to execute the next two chunks to download RNA-seq and then verify MD5 checksums.</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directory if it doesn't exist</span></span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span></span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create list of only A.pulchra sample names</span></span>
<span id="cb3-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'NR &gt; 2 {print $5"\t"$6}'</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${timeseries_dir}</span>/data/rna_metadata.csv <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[\t-]"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$2 == "ACR" {print $1}'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-9"></span>
<span id="cb3-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample list:"</span></span>
<span id="cb3-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_list}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-19"></span>
<span id="cb3-20"></span>
<span id="cb3-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use printf to format each item for use in wget</span></span>
<span id="cb3-22"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">formatted_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*%s*,"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_list})</span></span>
<span id="cb3-23"></span>
<span id="cb3-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove the trailing comma and append *.md5</span></span>
<span id="cb3-25"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">formatted_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${formatted_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">,*.md5"</span></span>
<span id="cb3-26"></span>
<span id="cb3-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output the final wget command</span></span>
<span id="cb3-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-30"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Formatted wget accept list:"</span></span>
<span id="cb3-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wget --accept=</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$formatted_list</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-36"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-37"></span>
<span id="cb3-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run wget to retrieve FastQs and MD5 files</span></span>
<span id="cb3-39"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-40">--directory-prefix <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-41">--recursive <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-42">--no-check-certificate <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-43">--continue <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-44">--cut-dirs 3 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-45">--no-host-directories <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-46">--no-parent <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-47">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-48">--accept=<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$formatted_list</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_url}</span></span>
<span id="cb3-49"></span>
<span id="cb3-50"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<p>Verify raw read checksums</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb4-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb4-5"></span>
<span id="cb4-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Checksums file contains other files, so this just looks for the sRNAseq files.</span></span>
<span id="cb4-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.md5</span>
<span id="cb4-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb4-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--check</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb4-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
<section id="fastp-trimming" class="level1">
<h1>2 Fastp Trimming</h1>
<p><a href="https://github.com/OpenGene/fastp">fastp</a> (Chen 2023) is set to auto-detect Illumina adapters, as well as trim the first 20bp from each read, as past experience shows these first 20bp are more inconsistent than the remainder of the read length.</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directories, if it doesn't exist</span></span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change to raw reads directory</span></span>
<span id="cb5-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-9"></span>
<span id="cb5-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create arrays of fastq R1 files and sample names</span></span>
<span id="cb5-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_fastq_pattern}</span></span>
<span id="cb5-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-13">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-14">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R1_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print $1}'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-15"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb5-16"></span>
<span id="cb5-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of fastq R2 files</span></span>
<span id="cb5-18"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_fastq_pattern}</span></span>
<span id="cb5-19"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-20">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-21">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R2_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print $1}'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-22"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb5-23"></span>
<span id="cb5-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create list of fastq files used in analysis</span></span>
<span id="cb5-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create MD5 checksum for reference</span></span>
<span id="cb5-26"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">!</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-f</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/raw-fastq-checksums.md5 <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb5-27"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.gz</span>
<span id="cb5-28">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-29">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/raw-fastq-checksums.md5</span>
<span id="cb5-30">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb5-31"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb5-32"></span>
<span id="cb5-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run fastp on files</span></span>
<span id="cb5-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adds JSON report output for downstream usage by MultiQC</span></span>
<span id="cb5-35"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> index <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-36"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-37">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R1_sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-38">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R2_sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-39">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastp}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-40">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--in1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-41">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--in2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-42">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--detect_adapter_for_pe</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-43">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_front1</span> 20 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-44">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_front2</span> 20 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-45">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--thread</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-46">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--html</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.report.html <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-47">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--json</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.report.json <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-48">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--out1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_R1_001.fastp-trim.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-49">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--out2</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_R2_001.fastp-trim.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-50">  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/fastp.stderr</span>
<span id="cb5-51"></span>
<span id="cb5-52">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate md5 checksums for newly trimmed files</span></span>
<span id="cb5-53">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_R1_001.fastp-trim.fq.gz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_R1_001.fastp-trim.fq.gz.md5</span>
<span id="cb5-55">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_R2_001.fastp-trim.fq.gz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_R2_001.fastp-trim.fq.gz.md5</span>
<span id="cb5-56">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb5-57"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
<section id="quality-check-with-fastqc-and-multiqc" class="level1">
<h1>3 Quality Check with FastQC and MultiQC</h1>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb6-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directory if it doesn't exist</span></span>
<span id="cb6-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqc_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb6-6"></span>
<span id="cb6-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN FASTQC ############</span></span>
<span id="cb6-8"></span>
<span id="cb6-9"></span>
<span id="cb6-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of trimmed FastQs</span></span>
<span id="cb6-11"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trimmed_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(${trimmed_fastqs_dir}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastq_pattern})</span></span>
<span id="cb6-12"></span>
<span id="cb6-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pass array contents to new variable as space-delimited list</span></span>
<span id="cb6-14"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trimmed_fastqc_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[*]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb6-15"></span>
<span id="cb6-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning FastQC on trimmed reads..."</span></span>
<span id="cb6-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb6-18"></span>
<span id="cb6-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run FastQC</span></span>
<span id="cb6-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Do NOT quote raw_fastqc_list</span></span>
<span id="cb6-21"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>fastqc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-22">--threads <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-23">--outdir <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-24">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-25"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqc_list}</span></span>
<span id="cb6-26"></span>
<span id="cb6-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC on trimmed reads complete!"</span></span>
<span id="cb6-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb6-29"></span>
<span id="cb6-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> FASTQC ############</span></span>
<span id="cb6-31"></span>
<span id="cb6-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN MULTIQC ############</span></span>
<span id="cb6-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning MultiQC on trimmed FastQC..."</span></span>
<span id="cb6-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb6-35"></span>
<span id="cb6-36"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>multiqc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span></span>
<span id="cb6-37"></span>
<span id="cb6-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb6-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MultiQC on trimmed FastQs complete."</span></span>
<span id="cb6-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb6-41"></span>
<span id="cb6-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> MULTIQC ############</span></span>
<span id="cb6-43"></span>
<span id="cb6-44"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Removing FastQC zip files."</span></span>
<span id="cb6-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb6-46"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.zip</span>
<span id="cb6-47"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC zip files removed."</span></span>
<span id="cb6-48"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span></code></pre></div>
<pre><code>Beginning FastQC on trimmed reads...

application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
FastQC on trimmed reads complete!

Beginning MultiQC on trimmed FastQC...


  /// MultiQC 🔍 | v1.14

|           multiqc | MultiQC Version v1.25.1 now available!
|           multiqc | Search path : /home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/output/01.00-D-Apul-RNAseq-trimming-fastp-FastQC-MultiQC/trimmed-fastqs
|         searching | ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 442/442  
|            fastqc | Found 88 reports
|           multiqc | Compressing plot data
|           multiqc | Previous MultiQC output found! Adjusting filenames..
|           multiqc | Use -f or --force to overwrite existing reports instead
|           multiqc | Report      : ../output/01.00-D-Apul-RNAseq-trimming-fastp-FastQC-MultiQC/trimmed-fastqs/multiqc_report_1.html
|           multiqc | Data        : ../output/01.00-D-Apul-RNAseq-trimming-fastp-FastQC-MultiQC/trimmed-fastqs/multiqc_data_1
|           multiqc | MultiQC complete
|           multiqc | 1 flat-image plot used in the report due to large sample numbers
|           multiqc | To force interactive plots, use the '--interactive' flag. 
See the documentation.

MultiQC on trimmed FastQs complete.

Removing FastQC zip files.

FastQC zip files removed.</code></pre>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-chen2023" class="csl-entry">
Chen, Shifu. 2023. “Ultrafast One-Pass FASTQ Data Preprocessing, Quality Control, and Deduplication Using Fastp.” <em>iMeta</em> 2 (2). <a href="https://doi.org/10.1002/imt2.107" class="uri">https://doi.org/10.1002/imt2.107</a>.
</div>
<div id="ref-ewels2016" class="csl-entry">
Ewels, Philip, Måns Magnusson, Sverker Lundin, and Max Käller. 2016. “MultiQC: Summarize Analysis Results for Multiple Tools and Samples in a Single Report.” <em>Bioinformatics</em> 32 (19): 3047–48. <a href="https://doi.org/10.1093/bioinformatics/btw354" class="uri">https://doi.org/10.1093/bioinformatics/btw354</a>.
</div>
<div id="ref-chen2023" class="csl-entry">
Chen, Shifu. 2023. <span>“Ultrafast One<span>-</span>Pass FASTQ Data Preprocessing, Quality Control, and Deduplication Using Fastp.”</span> <em>iMeta</em> 2 (2). <a href="https://doi.org/10.1002/imt2.107">https://doi.org/10.1002/imt2.107</a>.
</div>
<div id="ref-ewels2016" class="csl-entry">
Ewels, Philip, Måns Magnusson, Sverker Lundin, and Max Käller. 2016. <span>“MultiQC: Summarize Analysis Results for Multiple Tools and Samples in a Single Report.”</span> <em>Bioinformatics</em> 32 (19): 3047–48. <a href="https://doi.org/10.1093/bioinformatics/btw354">https://doi.org/10.1093/bioinformatics/btw354</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2024</category>
  <category>RNA-seq</category>
  <category>30-1047560508</category>
  <category>Azenta</category>
  <category>coral</category>
  <category>Acropora pulchra</category>
  <category>fastp</category>
  <category>FastQC</category>
  <category>MultiQC</category>
  <category>trimming</category>
  <category>E5</category>
  <category>timeseries_molecular</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-05-FastQC-Trimming-and-QC---A.pulchra-RNA-seq-from-Azenta-Project-30-1047560508-Using-fastp/</guid>
  <pubDate>Sat, 05 Oct 2024 07:00:00 GMT</pubDate>
</item>
<item>
  <title>FastQ QC - A.pulchra RNA-seq from Azenta Project 30-1047560508</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-04-FastQ-QC---A.pulchra-RNA-seq-from-Azenta-Project-30-1047560508/</link>
  <description><![CDATA[ 





<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This notebook entry is knitted from <a href="https://github.com/urol-e5/timeseries_molecular/blob/b7a80beee932d773e3c61eb3e7c7f2aede5020d6/D-Apul/code/00.00-D-Apul-RNAseq-reads-FastQC-MultiQC.Rmd"><code>urol-e5/timeseries_molecular/D-Apul/code/00.00-D-Apul-RNAseq-reads-FastQC-MultiQC.Rmd</code></a> (GitHub), commit <code>b7a80be</code>.</p>
</div>
</div>
<p>This Rmd file will download raw RNA-seq FastQs for <em>A.pulchra</em> and evaluate them using <a href="https://github.com/s-andrews/FastQC">FastQC</a> and <a href="https://multiqc.info/">MultiQC</a> <span class="citation" data-cites="ewels2016">(Ewels et al. 2016)</span>.</p>
<section id="create-a-bash-variables-file" class="level1">
<h1>1 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export timeseries_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export output_dir_top=${timeseries_dir}/D-Apul/output/00.00-D-Apul-RNAseq-reads-FastQC-MultiQC'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_fastqc_dir=${timeseries_dir}/D-Apul/${output_dir_top}/raw-fastqc'</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_dir=${timeseries_dir}/D-Apul/data/raw-fastqs'</span></span>
<span id="cb1-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_url="https://owl.fish.washington.edu/nightingales/E5-coral-time-series/30-1047560508/"'</span></span>
<span id="cb1-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Paths to programs"</span></span>
<span id="cb1-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastqc=/home/shared/FastQC-0.12.1/fastqc'</span></span>
<span id="cb1-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export multiqc=/home/sam/programs/mambaforge/bin/multiqc'</span></span>
<span id="cb1-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-17"></span>
<span id="cb1-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set FastQ filename patterns"</span></span>
<span id="cb1-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export fastq_pattern='*.fastq.gz'"</span></span>
<span id="cb1-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R1_fastq_pattern='*_R1_*.fastq.gz'"</span></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R2_fastq_pattern='*_R2_*.fastq.gz'"</span></span>
<span id="cb1-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-23"></span>
<span id="cb1-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set number of CPUs to use"</span></span>
<span id="cb1-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=40'</span></span>
<span id="cb1-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-27"></span>
<span id="cb1-28"></span>
<span id="cb1-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"## Inititalize arrays"</span></span>
<span id="cb1-30"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R1=()'</span></span>
<span id="cb1-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R2=()'</span></span>
<span id="cb1-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_fastqs_array=()'</span></span>
<span id="cb1-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R1_names_array=()'</span></span>
<span id="cb1-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R2_names_array=()'</span></span>
<span id="cb1-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-36"></span>
<span id="cb1-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Programs associative array"</span></span>
<span id="cb1-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"declare -A programs_array"</span></span>
<span id="cb1-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"programs_array=("</span></span>
<span id="cb1-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[fastqc]="${fastqc}" \'</span></span>
<span id="cb1-41"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[multiqc]="${multiqc}" \'</span></span>
<span id="cb1-42"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span></span>
<span id="cb1-43"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-44"></span>
<span id="cb1-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Print formatting"</span></span>
<span id="cb1-46"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-47"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-48"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-49"></span>
<span id="cb1-50"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export timeseries_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular
export output_dir_top=${timeseries_dir}/D-Apul/output/00.00-D-Apul-RNAseq-reads-FastQC-MultiQC
export raw_fastqc_dir=${timeseries_dir}/D-Apul/${output_dir_top}/raw-fastqc
export raw_reads_dir=${timeseries_dir}/D-Apul/data/raw-fastqs
export raw_reads_url="https://owl.fish.washington.edu/nightingales/E5-coral-time-series/30-1047560508/"

# Paths to programs
export fastqc=/home/shared/FastQC-0.12.1/fastqc
export multiqc=/home/sam/programs/mambaforge/bin/multiqc

# Set FastQ filename patterns
export fastq_pattern='*.fastq.gz'
export R1_fastq_pattern='*_R1_*.fastq.gz'
export R2_fastq_pattern='*_R2_*.fastq.gz'

# Set number of CPUs to use
export threads=40

## Inititalize arrays
export fastq_array_R1=()
export fastq_array_R2=()
export raw_fastqs_array=()
export R1_names_array=()
export R2_names_array=()

# Programs associative array
declare -A programs_array
programs_array=(
[fastqc]="${fastqc}" \
[multiqc]="${multiqc}" \
)

# Print formatting
export line="--------------------------------------------------------"</code></pre>
</section>
<section id="download-a.pulchra-rna-seq-fastqs" class="level1">
<h1>2 Download <em>A.pulchra</em> RNA-seq FastQs</h1>
<section id="download-raw-rna-seq-reads" class="level2">
<h2 class="anchored" data-anchor-id="download-raw-rna-seq-reads">2.1 Download raw RNA-seq reads</h2>
<p>Reads are downloaded from <a href="https://owl.fish.washington.edu/nightingales/E5-coral-time-series/30-1047560508/" class="uri">https://owl.fish.washington.edu/nightingales/E5-coral-time-series/30-1047560508/</a></p>
<p>Since sequencing included multiple species, the code will also parse only those that are <em>A.pulchra</em>.</p>
<p>The <code>--cut-dirs 3</code> command cuts the preceding directory structure (i.e.&nbsp;<code>nightingales/E5-coral-time-series/30-1047560508/</code>) so that we just end up with the reads.</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directory if it doesn't exist</span></span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span></span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create list of only A.pulchra sample names</span></span>
<span id="cb3-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'NR &gt; 2 {print $5"\t"$6}'</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${timeseries_dir}</span>/data/rna_metadata.csv <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[\t-]"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$2 == "ACR" {print $1}'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-9"></span>
<span id="cb3-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample list:"</span></span>
<span id="cb3-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_list}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-19"></span>
<span id="cb3-20"></span>
<span id="cb3-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use printf to format each item for use in wget</span></span>
<span id="cb3-22"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">formatted_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*%s*,"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_list})</span></span>
<span id="cb3-23"></span>
<span id="cb3-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove the trailing comma and append *.md5</span></span>
<span id="cb3-25"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">formatted_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${formatted_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">,*.md5"</span></span>
<span id="cb3-26"></span>
<span id="cb3-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output the final wget command</span></span>
<span id="cb3-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-30"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Formatted wget accept list:"</span></span>
<span id="cb3-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wget --accept=</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$formatted_list</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-36"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-37"></span>
<span id="cb3-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run wget to retrieve FastQs and MD5 files</span></span>
<span id="cb3-39"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-40">--directory-prefix <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-41">--recursive <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-42">--no-check-certificate <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-43">--continue <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-44">--cut-dirs 3 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-45">--no-host-directories <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-46">--no-parent <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-47">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-48">--accept=<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$formatted_list</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_url}</span></span>
<span id="cb3-49"></span>
<span id="cb3-50"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<pre><code>awk: fatal: cannot open file `/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/data/rna_metadata.csv' for reading (No such file or directory)

--------------------------------------------------------

Sample list:



--------------------------------------------------------


--------------------------------------------------------

Formatted wget accept list:

wget --accept="**,*.md5"

--------------------------------------------------------

total 116G
-rw-r--r-- 1 sam sam 1.4G Oct  3 08:30 10--1B2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 08:30 10--1B2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.4G Oct  3 08:32 10--1B2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 08:32 10--1B2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.1G Oct  3 08:42 102--2F1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 08:42 102--2F1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 2.1G Oct  3 08:45 102--2F1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 08:45 102--2F1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.2G Oct  3 08:46 103--2G1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 08:46 103--2G1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.2G Oct  3 08:48 103--2G1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 08:48 103--2G1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.5G Oct  3 08:57 106--2B2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 08:57 106--2B2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.5G Oct  3 08:59 106--2B2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 08:59 106--2B2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.2G Oct  3 09:01 107--2C2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 09:01 107--2C2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.2G Oct  3 09:03 107--2C2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 09:03 107--2C2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.6G Oct  3 09:05 108--2D2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 09:05 108--2D2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.6G Oct  3 09:07 108--2D2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 09:07 108--2D2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.2G Oct  3 09:09 109--2E2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 09:09 109--2E2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.2G Oct  3 09:11 109--2E2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 09:11 109--2E2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.3G Oct  3 09:31 114--2B3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 09:31 114--2B3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.3G Oct  3 09:33 114--2B3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 09:33 114--2B3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.3G Oct  3 08:26 1--1A1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   59 Oct  3 08:26 1--1A1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.3G Oct  3 08:28 1--1A1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   59 Oct  3 08:28 1--1A1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.1G Oct  3 10:20 20--1D3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 10:20 20--1D3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.1G Oct  3 10:21 20--1D3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 10:21 20--1D3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.2G Oct  3 10:23 21--1E3_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 10:23 21--1E3_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.2G Oct  3 10:25 21--1E3_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 10:25 21--1E3_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.4G Oct  3 10:16 2--1B1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   59 Oct  3 10:16 2--1B1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.4G Oct  3 10:18 2--1B1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   59 Oct  3 10:18 2--1B1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.4G Oct  3 10:45 27--1C4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 10:45 27--1C4_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.4G Oct  3 10:47 27--1C4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 10:47 27--1C4_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.6G Oct  3 10:49 28--1D4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 10:49 28--1D4_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.6G Oct  3 10:51 28--1D4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 10:51 28--1D4_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.2G Oct  3 11:00 30--1F4_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 11:00 30--1F4_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.2G Oct  3 11:02 30--1F4_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 11:02 30--1F4_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.5G Oct  3 11:17 34--1B5_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 11:17 34--1B5_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.5G Oct  3 11:19 34--1B5_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 11:19 34--1B5_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.2G Oct  3 11:28 37--1E5_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 11:28 37--1E5_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.2G Oct  3 11:30 37--1E5_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 11:30 37--1E5_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.5G Oct  3 11:36 39--1G5_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 11:36 39--1G5_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.6G Oct  3 11:38 39--1G5_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 11:38 39--1G5_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.3G Oct  3 11:56 44--1D6_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 11:56 44--1D6_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.3G Oct  3 11:58 44--1D6_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 11:58 44--1D6_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.5G Oct  3 12:20 5--1E1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   59 Oct  3 12:20 5--1E1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.5G Oct  3 12:22 5--1E1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   59 Oct  3 12:22 5--1E1_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.2G Oct  3 12:44 56--1H7_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 12:44 56--1H7_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.2G Oct  3 12:45 56--1H7_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 12:45 56--1H7_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.2G Oct  3 12:47 57--1A8_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 12:47 57--1A8_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.2G Oct  3 12:48 57--1A8_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 12:48 57--1A8_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.1G Oct  3 13:00 60--1D8_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 13:01 60--1D8_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.1G Oct  3 13:02 60--1D8_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 13:02 60--1D8_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.6G Oct  3 13:08 62--1F8_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 13:08 62--1F8_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.6G Oct  3 13:11 62--1F8_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 13:11 62--1F8_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.3G Oct  3 13:17 64--1H8_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 13:17 64--1H8_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.3G Oct  3 13:18 64--1H8_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 13:18 64--1H8_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.5G Oct  3 13:20 65--1A9_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 13:20 65--1A9_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.5G Oct  3 13:23 65--1A9_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 13:23 65--1A9_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.7G Oct  3 13:25 66--1B9_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 13:25 66--1B9_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.6G Oct  3 13:27 66--1B9_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 13:27 66--1B9_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.6G Oct  3 13:33 68--1D9_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 13:33 68--1D9_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.6G Oct  3 13:35 68--1D9_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 13:35 68--1D9_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.5G Oct  3 13:38 69--1E9_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 13:38 69--1E9_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.5G Oct  3 13:40 69--1E9_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 13:40 69--1E9_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.5G Oct  3 13:55 73--1A10_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 13:56 73--1A10_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.5G Oct  3 13:58 73--1A10_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 13:58 73--1A10_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.4G Oct  3 13:59 74--1B10_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 13:59 74--1B10_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.4G Oct  3 14:01 74--1B10_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 14:01 74--1B10_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.2G Oct  3 14:03 75--1C10_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 14:03 75--1C10_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.2G Oct  3 14:05 75--1C10_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 14:05 75--1C10_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.4G Oct  3 14:07 76--1D10_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 14:07 76--1D10_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.4G Oct  3 14:09 76--1D10_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 14:09 76--1D10_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.4G Oct  3 14:11 77--1E10_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 14:11 77--1E10_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.4G Oct  3 14:13 77--1E10_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 14:13 77--1E10_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.2G Oct  3 14:29 81--1A11_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 14:29 81--1A11_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.3G Oct  3 14:30 81--1A11_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 14:30 81--1A11_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.2G Oct  3 14:32 82--1B11_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 14:32 82--1B11_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.2G Oct  3 14:34 82--1B11_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 14:34 82--1B11_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.4G Oct  3 14:44 85--1E11_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 14:44 85--1E11_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.4G Oct  3 14:45 85--1E11_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 14:45 85--1E11_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.1G Oct  3 14:47 86--1F11_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 14:47 86--1F11_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.1G Oct  3 14:49 86--1F11_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 14:49 86--1F11_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.2G Oct  3 14:57 89--1A12_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 14:57 89--1A12_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.2G Oct  3 14:58 89--1A12_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 14:58 89--1A12_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.5G Oct  3 15:04 90--1B12_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 15:04 90--1B12_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.5G Oct  3 15:06 90--1B12_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 15:06 90--1B12_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.5G Oct  3 15:00 9--1A2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   59 Oct  3 15:00 9--1A2_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.5G Oct  3 15:02 9--1A2_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   59 Oct  3 15:02 9--1A2_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.4G Oct  3 15:15 93--1E12_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 15:15 93--1E12_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.4G Oct  3 15:17 93--1E12_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 15:17 93--1E12_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.1G Oct  3 15:27 96--1H12_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 15:27 96--1H12_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.1G Oct  3 15:29 96--1H12_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   61 Oct  3 15:29 96--1H12_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.3G Oct  3 15:38 99--2C1_R1_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 15:38 99--2C1_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam 1.3G Oct  3 15:40 99--2C1_R2_001.fastq.gz
-rw-r--r-- 1 sam sam   60 Oct  3 15:40 99--2C1_R2_001.fastq.gz.md5
-rw-rw-r-- 1 sam sam  138 Oct  4 10:52 README.md</code></pre>
</section>
<section id="verify-raw-read-checksums" class="level2">
<h2 class="anchored" data-anchor-id="verify-raw-read-checksums">2.2 Verify raw read checksums</h2>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-5"></span>
<span id="cb5-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Checksums file contains other files, so this just looks for the sRNAseq files.</span></span>
<span id="cb5-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.md5</span>
<span id="cb5-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--check</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<pre><code>./10--1B2_R1_001.fastq.gz: OK
./10--1B2_R2_001.fastq.gz: OK
./102--2F1_R1_001.fastq.gz: OK
./102--2F1_R2_001.fastq.gz: OK
./103--2G1_R1_001.fastq.gz: OK
./103--2G1_R2_001.fastq.gz: OK
./106--2B2_R1_001.fastq.gz: OK
./106--2B2_R2_001.fastq.gz: OK
./107--2C2_R1_001.fastq.gz: OK
./107--2C2_R2_001.fastq.gz: OK
./108--2D2_R1_001.fastq.gz: OK
./108--2D2_R2_001.fastq.gz: OK
./109--2E2_R1_001.fastq.gz: OK
./109--2E2_R2_001.fastq.gz: OK
./114--2B3_R1_001.fastq.gz: OK
./114--2B3_R2_001.fastq.gz: OK
./1--1A1_R1_001.fastq.gz: OK
./1--1A1_R2_001.fastq.gz: OK
./20--1D3_R1_001.fastq.gz: OK
./20--1D3_R2_001.fastq.gz: OK
./21--1E3_R1_001.fastq.gz: OK
./21--1E3_R2_001.fastq.gz: OK
./2--1B1_R1_001.fastq.gz: OK
./2--1B1_R2_001.fastq.gz: OK
./27--1C4_R1_001.fastq.gz: OK
./27--1C4_R2_001.fastq.gz: OK
./28--1D4_R1_001.fastq.gz: OK
./28--1D4_R2_001.fastq.gz: OK
./30--1F4_R1_001.fastq.gz: OK
./30--1F4_R2_001.fastq.gz: OK
./34--1B5_R1_001.fastq.gz: OK
./34--1B5_R2_001.fastq.gz: OK
./37--1E5_R1_001.fastq.gz: OK
./37--1E5_R2_001.fastq.gz: OK
./39--1G5_R1_001.fastq.gz: OK
./39--1G5_R2_001.fastq.gz: OK
./44--1D6_R1_001.fastq.gz: OK
./44--1D6_R2_001.fastq.gz: OK
./5--1E1_R1_001.fastq.gz: OK
./5--1E1_R2_001.fastq.gz: OK
./56--1H7_R1_001.fastq.gz: OK
./56--1H7_R2_001.fastq.gz: OK
./57--1A8_R1_001.fastq.gz: OK
./57--1A8_R2_001.fastq.gz: OK
./60--1D8_R1_001.fastq.gz: OK
./60--1D8_R2_001.fastq.gz: OK
./62--1F8_R1_001.fastq.gz: OK
./62--1F8_R2_001.fastq.gz: OK
./64--1H8_R1_001.fastq.gz: OK
./64--1H8_R2_001.fastq.gz: OK
./65--1A9_R1_001.fastq.gz: OK
./65--1A9_R2_001.fastq.gz: OK
./66--1B9_R1_001.fastq.gz: OK
./66--1B9_R2_001.fastq.gz: OK
./68--1D9_R1_001.fastq.gz: OK
./68--1D9_R2_001.fastq.gz: OK
./69--1E9_R1_001.fastq.gz: OK
./69--1E9_R2_001.fastq.gz: OK
./73--1A10_R1_001.fastq.gz: OK
./73--1A10_R2_001.fastq.gz: OK
./74--1B10_R1_001.fastq.gz: OK
./74--1B10_R2_001.fastq.gz: OK
./75--1C10_R1_001.fastq.gz: OK
./75--1C10_R2_001.fastq.gz: OK
./76--1D10_R1_001.fastq.gz: OK
./76--1D10_R2_001.fastq.gz: OK
./77--1E10_R1_001.fastq.gz: OK
./77--1E10_R2_001.fastq.gz: OK
./81--1A11_R1_001.fastq.gz: OK
./81--1A11_R2_001.fastq.gz: OK
./82--1B11_R1_001.fastq.gz: OK
./82--1B11_R2_001.fastq.gz: OK
./85--1E11_R1_001.fastq.gz: OK
./85--1E11_R2_001.fastq.gz: OK
./86--1F11_R1_001.fastq.gz: OK
./86--1F11_R2_001.fastq.gz: OK
./89--1A12_R1_001.fastq.gz: OK
./89--1A12_R2_001.fastq.gz: OK
./90--1B12_R1_001.fastq.gz: OK
./90--1B12_R2_001.fastq.gz: OK
./9--1A2_R1_001.fastq.gz: OK
./9--1A2_R2_001.fastq.gz: OK
./93--1E12_R1_001.fastq.gz: OK
./93--1E12_R2_001.fastq.gz: OK
./96--1H12_R1_001.fastq.gz: OK
./96--1H12_R2_001.fastq.gz: OK
./99--2C1_R1_001.fastq.gz: OK
./99--2C1_R2_001.fastq.gz: OK</code></pre>
</section>
</section>
<section id="fastqcmultiqc-on-raw-reads" class="level1">
<h1>3 FastQC/MultiQC on raw reads</h1>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb7-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directory if it doesn't exist</span></span>
<span id="cb7-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN FASTQC ############</span></span>
<span id="cb7-8"></span>
<span id="cb7-9"></span>
<span id="cb7-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of trimmed FastQs</span></span>
<span id="cb7-11"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">raw_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(${raw_reads_dir}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_pattern})</span></span>
<span id="cb7-12"></span>
<span id="cb7-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pass array contents to new variable as space-delimited list</span></span>
<span id="cb7-14"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">raw_fastqc_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[*]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb7-15"></span>
<span id="cb7-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning FastQC on raw reads..."</span></span>
<span id="cb7-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb7-18"></span>
<span id="cb7-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run FastQC</span></span>
<span id="cb7-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Do NOT quote raw_fastqc_list</span></span>
<span id="cb7-21"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>fastqc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-22">--threads <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-23">--outdir <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-24">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-25"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_list}</span></span>
<span id="cb7-26"></span>
<span id="cb7-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC on raw reads complete!"</span></span>
<span id="cb7-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb7-29"></span>
<span id="cb7-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> FASTQC ############</span></span>
<span id="cb7-31"></span>
<span id="cb7-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN MULTIQC ############</span></span>
<span id="cb7-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning MultiQC on raw FastQC..."</span></span>
<span id="cb7-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb7-35"></span>
<span id="cb7-36"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>multiqc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span></span>
<span id="cb7-37"></span>
<span id="cb7-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb7-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MultiQC on raw FastQs complete."</span></span>
<span id="cb7-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb7-41"></span>
<span id="cb7-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> MULTIQC ############</span></span>
<span id="cb7-43"></span>
<span id="cb7-44"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Removing FastQC zip files."</span></span>
<span id="cb7-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb7-46"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.zip</span>
<span id="cb7-47"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC zip files removed."</span></span>
<span id="cb7-48"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb7-49"></span>
<span id="cb7-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># View directory contents</span></span>
<span id="cb7-51"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span></span></code></pre></div>
<pre><code>Beginning FastQC on raw reads...

application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
FastQC on raw reads complete!

Beginning MultiQC on raw FastQC...


  /// MultiQC 🔍 | v1.14

|           multiqc | MultiQC Version v1.25.1 now available!
|           multiqc | Search path : /home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/output/00.00-D-Apul-RNAseq-reads-FastQC-MultiQC/raw-fastqc
|         searching | ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 176/176  
|            fastqc | Found 88 reports
|           multiqc | Compressing plot data
|           multiqc | Report      : ../home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/output/00.00-D-Apul-RNAseq-reads-FastQC-MultiQC/raw-fastqc/multiqc_report.html
|           multiqc | Data        : ../home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/output/00.00-D-Apul-RNAseq-reads-FastQC-MultiQC/raw-fastqc/multiqc_data
|           multiqc | MultiQC complete
|           multiqc | 1 flat-image plot used in the report due to large sample numbers
|           multiqc | To force interactive plots, use the '--interactive' flag. 
See the documentation.

MultiQC on raw FastQs complete.

Removing FastQC zip files.

FastQC zip files removed.

total 55M
-rw-r--r-- 1 sam sam 603K Oct  7 09:15 10--1B2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 604K Oct  7 09:15 10--1B2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 601K Oct  7 09:18 102--2F1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 605K Oct  7 09:18 102--2F1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 599K Oct  7 09:14 103--2G1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 605K Oct  7 09:15 103--2G1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 601K Oct  7 09:16 106--2B2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 600K Oct  7 09:16 106--2B2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 602K Oct  7 09:15 107--2C2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 601K Oct  7 09:15 107--2C2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 603K Oct  7 09:16 108--2D2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 604K Oct  7 09:16 108--2D2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 610K Oct  7 09:14 109--2E2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 608K Oct  7 09:14 109--2E2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 601K Oct  7 09:15 114--2B3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 600K Oct  7 09:15 114--2B3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 601K Oct  7 09:14 1--1A1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 608K Oct  7 09:15 1--1A1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 601K Oct  7 09:14 20--1D3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 596K Oct  7 09:14 20--1D3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 602K Oct  7 09:15 21--1E3_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 602K Oct  7 09:14 21--1E3_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 604K Oct  7 09:15 2--1B1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 605K Oct  7 09:15 2--1B1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 602K Oct  7 09:16 27--1C4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 604K Oct  7 09:15 27--1C4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 599K Oct  7 09:17 28--1D4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 602K Oct  7 09:16 28--1D4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 599K Oct  7 09:15 30--1F4_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 603K Oct  7 09:14 30--1F4_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 595K Oct  7 09:16 34--1B5_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 605K Oct  7 09:16 34--1B5_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 600K Oct  7 09:14 37--1E5_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 599K Oct  7 09:14 37--1E5_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 600K Oct  7 09:16 39--1G5_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 607K Oct  7 09:16 39--1G5_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 603K Oct  7 09:15 44--1D6_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 603K Oct  7 09:15 44--1D6_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 600K Oct  7 09:16 5--1E1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 600K Oct  7 09:16 5--1E1_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 601K Oct  7 09:19 56--1H7_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 602K Oct  7 09:19 56--1H7_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 604K Oct  7 09:19 57--1A8_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 605K Oct  7 09:19 57--1A8_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 603K Oct  7 09:19 60--1D8_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 606K Oct  7 09:19 60--1D8_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 602K Oct  7 09:20 62--1F8_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 602K Oct  7 09:21 62--1F8_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 602K Oct  7 09:19 64--1H8_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 599K Oct  7 09:20 64--1H8_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 600K Oct  7 09:21 65--1A9_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 604K Oct  7 09:21 65--1A9_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 602K Oct  7 09:21 66--1B9_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 602K Oct  7 09:21 66--1B9_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 606K Oct  7 09:21 68--1D9_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 604K Oct  7 09:21 68--1D9_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 598K Oct  7 09:21 69--1E9_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 602K Oct  7 09:21 69--1E9_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 599K Oct  7 09:21 73--1A10_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 602K Oct  7 09:21 73--1A10_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 599K Oct  7 09:21 74--1B10_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 603K Oct  7 09:21 74--1B10_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 599K Oct  7 09:20 75--1C10_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 604K Oct  7 09:20 75--1C10_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 600K Oct  7 09:21 76--1D10_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 605K Oct  7 09:21 76--1D10_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 603K Oct  7 09:21 77--1E10_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 605K Oct  7 09:21 77--1E10_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 606K Oct  7 09:21 81--1A11_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 613K Oct  7 09:21 81--1A11_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 603K Oct  7 09:21 82--1B11_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 601K Oct  7 09:21 82--1B11_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 603K Oct  7 09:22 85--1E11_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 608K Oct  7 09:21 85--1E11_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 599K Oct  7 09:21 86--1F11_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 602K Oct  7 09:21 86--1F11_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 602K Oct  7 09:21 89--1A12_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 601K Oct  7 09:21 89--1A12_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 603K Oct  7 09:22 90--1B12_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 603K Oct  7 09:22 90--1B12_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 598K Oct  7 09:23 9--1A2_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 604K Oct  7 09:23 9--1A2_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 595K Oct  7 09:23 93--1E12_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 603K Oct  7 09:23 93--1E12_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 603K Oct  7 09:22 96--1H12_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 601K Oct  7 09:22 96--1H12_R2_001_fastqc.html
-rw-r--r-- 1 sam sam 607K Oct  7 09:23 99--2C1_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 607K Oct  7 09:23 99--2C1_R2_001_fastqc.html
drwxr-xr-x 2 sam sam 4.0K Oct  7 09:23 multiqc_data
-rw-r--r-- 1 sam sam 2.3M Oct  7 09:23 multiqc_report.html</code></pre>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-ewels2016" class="csl-entry">
Ewels, Philip, Måns Magnusson, Sverker Lundin, and Max Käller. 2016. “MultiQC: Summarize Analysis Results for Multiple Tools and Samples in a Single Report.” <em>Bioinformatics</em> 32 (19): 3047–48. <a href="https://doi.org/10.1093/bioinformatics/btw354" class="uri">https://doi.org/10.1093/bioinformatics/btw354</a>.
</div>
<div id="ref-ewels2016" class="csl-entry">
Ewels, Philip, Måns Magnusson, Sverker Lundin, and Max Käller. 2016. <span>“MultiQC: Summarize Analysis Results for Multiple Tools and Samples in a Single Report.”</span> <em>Bioinformatics</em> 32 (19): 3047–48. <a href="https://doi.org/10.1093/bioinformatics/btw354">https://doi.org/10.1093/bioinformatics/btw354</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2024</category>
  <category>RNA-seq</category>
  <category>30-1047560508</category>
  <category>Azenta</category>
  <category>coral</category>
  <category>Acropora pulchra</category>
  <category>FastQC</category>
  <category>MultiQC</category>
  <category>timeseries_molecular</category>
  <category>E5</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-04-FastQ-QC---A.pulchra-RNA-seq-from-Azenta-Project-30-1047560508/</guid>
  <pubDate>Fri, 04 Oct 2024 07:00:00 GMT</pubDate>
</item>
<item>
  <title>Daily Bits - October 2024</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-01-Daily-Bits---October-2024/</link>
  <description><![CDATA[ 





<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section">20241003</h2>
<section id="coral-e5" class="level3">
<h3 class="anchored" data-anchor-id="coral-e5">Coral E5</h3>
<ul>
<li><p><a href="../../../posts/2024/2024-09-26-Data-Received---E5-Coral-Time-Series-RNA-seq-Azenta-Project-30-1047560508/index.html">Downloaded updated RNA-seq data</a>, from Azenta, which was previously incomplete.</p></li>
<li><p>Began work on script to <a href="https://github.com/urol-e5/timeseries_molecular/issues/1">align <em>A.pulchra</em> time series RNA-seq data</a> (GitHub Issue) in <a href="https://github.com/urol-e5/timeseries_molecular/tree/main"><code>urol-e5/timeseries_molecular</code> repo</a></p></li>
</ul>
</section>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1">20241002</h2>
<ul>
<li><a href="../../../posts/2024/2024-10-01-Data-Received---R.philippinarum-(Manilla-clam)-sRNA-seq-Data-from-Azenta-Project-30-1035633055/index.html">Downloaded Mac’s <em>R.philippinarum</em> (Manila clam) sRNA-seq data</a>. Emailed Azenta about read counts being less than promised (~20M reads/sample).</li>
</ul>
<section id="ceasmallr" class="level3">
<h3 class="anchored" data-anchor-id="ceasmallr"><a href="https://github.com/sr320/ceasmallr">ceasmallr</a></h3>
<ul>
<li>Worked on <a href="https://github.com/sr320/ceasmallr/wiki">updating wiki</a> with links/info to sequencing data.</li>
</ul>
</section>
</section>
<section id="section-2" class="level2">
<h2 class="anchored" data-anchor-id="section-2">20241001</h2>
<ul>
<li><p>In lab.</p>
<ul>
<li>Grabbed some packages.</li>
</ul></li>
</ul>


</section>

 ]]></description>
  <category>2024</category>
  <category>Daily Bits</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-01-Daily-Bits---October-2024/</guid>
  <pubDate>Tue, 01 Oct 2024 07:00:00 GMT</pubDate>
</item>
<item>
  <title>Data Received - R.philippinarum (Manilla clam) sRNA-seq Data from Azenta Project 30-1035633055</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-01-Data-Received---R.philippinarum-(Manilla-clam)-sRNA-seq-Data-from-Azenta-Project-30-1035633055/</link>
  <description><![CDATA[ 





<p>The sRNA-seq data from <a href="../../../posts/2024/2024-07-22-Samples-Submitted---Macs-Manilla-Clam-Egg-Samples-for-sRNA-seq-at-Azenta/index.html">Mac’s Manila clam egg samples submitted on 20240722</a> (Notebook) became available today. Data was downloaded to Owl and is available here:</p>
<p><a href="https://owl.fish.washington.edu/nightingales/R_philippinarum/30-1035633055">https://owl.fish.washington.edu/nightingales/R_philippinarum/30-1035633055</a></p>
<p>Azenta sequencing report is here:</p>
<p><a href="https://owl.fish.washington.edu/nightingales/R_philippinarum/30-1035633055/Azenta_30-1035633055_Data_Report.html">https://owl.fish.washington.edu/nightingales/R_philippinarum/30-1035633055/Azenta_30-1035633055_Data_Report.html</a></p>
<p>All MD5 checksums were verified:</p>
<div id="fig-md5-checksums-01" class="quarto-float quarto-figure quarto-figure-center anchored" alt="MD5 checksum verification.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-md5-checksums-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-10-01-Data-Received---R.philippinarum-(Manilla-clam)-sRNA-seq-Data-from-Azenta-Project-30-1035633055/20241001-rphi-rSNAseq-checksums-01.png" class="img-fluid figure-img" alt="MD5 checksum verification.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-md5-checksums-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: MD5 checksum verification.
</figcaption>
</figure>
</div>



 ]]></description>
  <category>2024</category>
  <category>Data Received</category>
  <category>sRNA-seq</category>
  <category>30-1035633055</category>
  <category>Ruditapes philippinarum</category>
  <category>Manila clam</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-01-Data-Received---R.philippinarum-(Manilla-clam)-sRNA-seq-Data-from-Azenta-Project-30-1035633055/</guid>
  <pubDate>Tue, 01 Oct 2024 07:00:00 GMT</pubDate>
</item>
<item>
  <title>Data Received - E5 Coral Time Series RNA-seq Azenta Project 30-1047560508</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-09-26-Data-Received---E5-Coral-Time-Series-RNA-seq-Azenta-Project-30-1047560508/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>Coral time series RNA-seq data for Azenta project 30-1047560508 became availalbe today. Data was downloaded to <a href="https://owl.fish.washington.edu/nightingales/E5-coral-time-series/30-1047560508/">nigthingales on Owl</a> and MD5 checksums were verified.</p>
<p>Sequencing report is here:</p>
<p><a href="https://owl.fish.washington.edu/nightingales/E5-coral-time-series/30-1047560508/Azenta_30-1047560508_Data_Report.html">Azenta_30-1047560508_Data_Report.html</a></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Data was initially received on 20240926, but Azenta provided updated data on 20241002. All files were replaced with the updated data.</p>
</div>
</div>
</section>
<section id="md5-checksum-verification" class="level1">
<h1>MD5 CHECKSUM VERIFICATION</h1>
<p>All MD5 checksums were successfully verified.</p>
<div id="fig-MD5-checksum-verification-01" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="MD5 checksum verification 01">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-MD5-checksum-verification-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20240926-E5-coral-RNAseq-checksums-01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Screenshot showing successful MD5 checksum verification 01"><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-09-26-Data-Received---E5-Coral-Time-Series-RNA-seq-Azenta-Project-30-1047560508/20240926-E5-coral-RNAseq-checksums-01.png" class="img-fluid figure-img" alt="MD5 checksum verification 01"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-MD5-checksum-verification-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Screenshot showing successful MD5 checksum verification 01
</figcaption>
</figure>
</div>
<div id="fig-MD5-checksum-verification-02" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="MD5 checksum verification 02">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-MD5-checksum-verification-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20240926-E5-coral-RNAseq-checksums-02.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Screenshot showing successful MD5 checksum verification 02"><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-09-26-Data-Received---E5-Coral-Time-Series-RNA-seq-Azenta-Project-30-1047560508/20240926-E5-coral-RNAseq-checksums-02.png" class="img-fluid figure-img" alt="MD5 checksum verification 02"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-MD5-checksum-verification-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Screenshot showing successful MD5 checksum verification 02
</figcaption>
</figure>
</div>
<div id="fig-MD5-checksum-verification-03" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="MD5 checksum verification 03">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-MD5-checksum-verification-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20240926-E5-coral-RNAseq-checksums-03.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: Screenshot showing successful MD5 checksum verification 03"><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-09-26-Data-Received---E5-Coral-Time-Series-RNA-seq-Azenta-Project-30-1047560508/20240926-E5-coral-RNAseq-checksums-03.png" class="img-fluid figure-img" alt="MD5 checksum verification 03"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-MD5-checksum-verification-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Screenshot showing successful MD5 checksum verification 03
</figcaption>
</figure>
</div>
<div id="fig-MD5-checksum-verification-04" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="MD5 checksum verification 04">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-MD5-checksum-verification-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20240926-E5-coral-RNAseq-checksums-04.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;4: Screenshot showing successful MD5 checksum verification 04"><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-09-26-Data-Received---E5-Coral-Time-Series-RNA-seq-Azenta-Project-30-1047560508/20240926-E5-coral-RNAseq-checksums-04.png" class="img-fluid figure-img" alt="MD5 checksum verification 04"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-MD5-checksum-verification-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Screenshot showing successful MD5 checksum verification 04
</figcaption>
</figure>
</div>
</section>
<section id="sample-list" class="level1">
<h1>SAMPLE LIST</h1>
<p>Here is the full list of samples with which we received data for in this round (9/26/2024):</p>
<pre><code>1--1A1
2--1B1
3--1C1
4--1D1
5--1E1
6--1F1
7--1G1
8--1H1
9--1A2
10--1B2
11--1C2
12--1D2
13--1E2
14--1F2
15--1G2
16--1H2
17--1A3
18--1B3
19--1C3
20--1D3
21--1E3
22--1F3
23--1G3
24--1H3
25--1A4
26--1B4
27--1C4
28--1D4
29--1E4
30--1F4
31--1G4
32--1H4
33--1A5
34--1B5
35--1C5
36--1D5
37--1E5
38--1F5
39--1G5
40--1H5
41--1A6
42--1B6
43--1C6
44--1D6
45--1E6
46--1F6
47--1G6
48--1H6
49--1A7
50--1B7
51--1C7
52--1D7
53--1E7
54--1F7
55--1G7
56--1H7
57--1A8
58--1B8
59--1C8
60--1D8
61--1E8
62--1F8
63--1G8
64--1H8
65--1A9
66--1B9
67--1C9
68--1D9
69--1E9
70--1F9
71--1G9
72--1H9
73--1A10
74--1B10
75--1C10
76--1D10
77--1E10
78--1F10
79--1G10
80--1H10
81--1A11
82--1B11
83--1C11
84--1D11
85--1E11
86--1F11
87--1G11
88--1H11
89--1A12
90--1B12
91--1C12
92--1D12
93--1E12
94--1F12
95--1G12
96--1H12
97--2A1
98--2B1
99--2C1
100--2D1
101--2E1
102--2F1
103--2G1
104--2H1
105--2A2
106--2B2
107--2C2
108--2D2
109--2E2
110--2F2
111--2G2
112--2H2
113--2A3
114--2B3
115--2C3
116--2D3
117--2E3</code></pre>


</section>

 ]]></description>
  <category>2024</category>
  <category>E5</category>
  <category>coral</category>
  <category>RNA-seq</category>
  <category>30-1047560508</category>
  <category>Azenta</category>
  <category>Data Received</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-09-26-Data-Received---E5-Coral-Time-Series-RNA-seq-Azenta-Project-30-1047560508/</guid>
  <pubDate>Thu, 26 Sep 2024 07:00:00 GMT</pubDate>
</item>
<item>
  <title>Agarose Gel - gDNA Integrity Check of Lake Trout Liver gDNA from 20240712</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-09-25-Agarose-Gel---gDNA-Integrity-Check-of-Lake-Trout-Liver-gDNA-from-20240712/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>After a previous attempt at <a href="../../../posts/2024/2024-09-11-Bisulfite-PCR---Second-Primer-Annealing-Gradient-Test-with-Lake-Trout-Bisulfite-treated-DNA/index.html">amplifying the C1q gene in bisulfite-converted DNA failed</a>, we decided we should test out a standard PCR on untreated liver gDNA. I <a href="../../../posts/2024/2024-09-16-Primer-Design---Lake-Trout-C1q-Gene-Sequencing-Primers-Using-Primer3/index.html">designed PCR primers for the C1Q gene on 20240916</a>, I decided to evaluate <a href="../../../posts/2024/2024-07-12-DNA-Isolation-and-Quantification---Lake-Trout-Liver/index.html"><em>Salvelinus namaycush</em> gDNA integrity isolated on 20240712</a> to see if the DNA was degraded (or not).</p>
</section>
<section id="materials-methods" class="level1">
<h1>MATERIALS &amp; METHODS</h1>
<p>Samples were run on 1.0% agarose, low-TAE gel with ethidium bromide. I prepared the DNA for loading by combining 0.5uL of each sample with 19.5uL of 1x TE, and 4uL of <a href="https://www.thermofisher.com/order/catalog/product/R0631">6x Orange DNA Loading Dye (Thermo Scientific)</a>. The gel was run @ 107V for ~45mins and then imaged.</p>
<p><a href="https://www.fishersci.se/shop/products/fermentas-o-generuler-ready-to-use-dna-ladder-mix/11803983">O’GeneRuler DNA Ladder Mix, Ready-to-Use 100-10,00bp (Thermo Scientific)</a> was used (5uL) for size reference:</p>
<div id="fig-ladder" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="O'GeneRuler">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="../../../images/ogene-ruler.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Ladder"><img src="https://robertslab.github.io/sams-notebook/images/ogene-ruler.jpeg" class="img-fluid figure-img" alt="O'GeneRuler"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Ladder
</figcaption>
</figure>
</div>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
</section>
<section id="discussion" class="level1">
<h1>DISCUSSION</h1>


</section>

 ]]></description>
  <category>2024</category>
  <category>agarose gel</category>
  <category>gDNA</category>
  <category>Lake trout</category>
  <category>liver</category>
  <category>Salvelinus namaycush</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-09-25-Agarose-Gel---gDNA-Integrity-Check-of-Lake-Trout-Liver-gDNA-from-20240712/</guid>
  <pubDate>Wed, 25 Sep 2024 07:00:00 GMT</pubDate>
</item>
</channel>
</rss>
