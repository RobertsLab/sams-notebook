<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Sam&#39;s Notebook</title>
<link>https://robertslab.github.io/sams-notebook/</link>
<atom:link href="https://robertslab.github.io/sams-notebook/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.5.57</generator>
<lastBuildDate>Fri, 06 Dec 2024 08:00:00 GMT</lastBuildDate>
<item>
  <title>Trimming and Merging - R.philippinarum sRNA-seq Data Using fastp FastQC and MultiQC</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-12-06-Trimming-and-Merging---R.philippinarum-sRNA-seq-Data-Using-fastp-FastQC-and-MultiQC/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>This notebook is part of <a href="https://github.com/RobertsLab/project-clam-oa/tree/main">project-clam-oa</a> (GitHub repo).</p>
<p>I previously performed concatenation of reads, and <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/"><code>FastQC</code></a> and <a href="https://multiqc.info/"><code>MultiQC</code></a> QC assessments of the sRNA-seq data received <a href="../../../posts/2024/2024-12-05-FastQ-Concatentation-and-QC---R.philippinarum-sRNA-seq-Data-Using-FastQC-and-MultiQC/index.html">previously, on 20241205</a> (Notebook entry).</p>
<p>Here, I needed to trim reads, as well as merge them. Since these are sRNA-seq data (meaning, the actual sequence length is short), having paired-end reads is of little value, However, weâ€™ve previously decided we might as well as keep as much information as possible, instead of just simply discarding the R2 reads. So, we used <a href="https://github.com/OpenGene/fastp"><code>fastp</code></a> to trim and merge the reads.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This notebook is copied from knitted markdown from <a href="https://github.com/RobertsLab/project-clam-oa/blob/90e8bcd7d514966bdcd0ceb93c925fc44772cdb0/code/01.00-trimming-fastp-fastqc.Rmd"><code>01.00-trimming-fastp-fastqc.Rmd</code></a> (commit <code>90e8bcd</code>).</p>
</div>
</div>
</section>
<section id="description" class="level1">
<h1>1 Description</h1>
<p>This notebook will trim and merge R1 and R2 reads. The max length of 31bp is based on the <code>fastp</code> insert peak size from previous trimming tests based on the the adapter and polyG trimming results, and previous evaluation of mean read lengths via <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/"><code>FastQC</code></a> and <a href="https://multiqc.info/"><code>MultiQC</code></a>.</p>
<section id="inputs" class="level2">
<h2 class="anchored" data-anchor-id="inputs">1.1 Inputs:</h2>
<ul>
<li>sRNAseq paired-end FastQs (e.g.&nbsp;<code>*.fastq.gz</code>)</li>
</ul>
</section>
<section id="outputs" class="level2">
<h2 class="anchored" data-anchor-id="outputs">1.2 Outputs:</h2>
<ul>
<li><p><code>*.fastqc.html</code>: FastQC results, in HTML format.</p></li>
<li><p><code>*fastp-adapters-polyG-31bp-merged.fq.gz</code>: Trimmed and merged reads with final length of 31bp.</p></li>
<li><p><code>multiqc_report.html</code>: A summary report of the alignment results generated by <a href="https://github.com/MultiQC/MultiQC">MultiQC</a>, in HTML format.</p></li>
</ul>
<p>Libraries were prepared and sequenced by Azenta:</p>
<ul>
<li><p>Library prep: <a href="https://www.neb.com/en-us/-/media/nebus/files/manuals/manuale7300_e7330_e7560_e7580.pdf?rev=d0964a2e637843b1afcb9f7d666d07b2&amp;hash=7AC0B0EB012708EFAB0E4DBEEAF1446A">NEB nebnext-small-rna-library-prep-set-for-illumina kit</a> (PDF)</p></li>
<li><p>Sequencing: Illumina HiSeq 4000, 150bp PE</p></li>
</ul>
<p>Due to large file sizes of FastQs, they cannot be added to GitHub. Full output from this notebook are available here:</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/gitrepos/project-clam-oa/output/01.00-trimming-fastp-fastqc" class="uri">https://gannet.fish.washington.edu/gitrepos/project-clam-oa/output/01.00-trimming-fastp-fastqc</a></li>
</ul>
</section>
</section>
<section id="create-a-bash-variables-file" class="level1">
<h1>2 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export repo_dir=/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export output_dir_top=${repo_dir}/output/01.00-trimming-fastp-fastqc'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_dir="${repo_dir}/output/00.00-fastqc-concatenation-raw_reads"'</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export trimmed_fastqs_dir="${output_dir_top}"'</span></span>
<span id="cb1-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Paths to programs"</span></span>
<span id="cb1-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export programs_dir="/home/shared"'</span></span>
<span id="cb1-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastp="${programs_dir}/fastp-v0.24.0/fastp"'</span></span>
<span id="cb1-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastqc="${programs_dir}/FastQC-0.12.1/fastqc"'</span></span>
<span id="cb1-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export multiqc="/home/sam/programs/mambaforge/bin/multiqc"'</span></span>
<span id="cb1-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-18"></span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set FastQ filename patterns"</span></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export fastq_pattern='*.fastq.gz'"</span></span>
<span id="cb1-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R1_fastq_pattern='*_R1_*.fastq.gz'"</span></span>
<span id="cb1-23"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R2_fastq_pattern='*_R2_*.fastq.gz'"</span></span>
<span id="cb1-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export trimmed_fastq_pattern='*fastp-trim*.fq.gz'"</span></span>
<span id="cb1-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-26"></span>
<span id="cb1-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Input/output files"</span></span>
<span id="cb1-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_checksums=input_fastq_checksums.md5'</span></span>
<span id="cb1-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export NEB_adapters_fasta=NEB-adapters.fasta'</span></span>
<span id="cb1-30"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-31"></span>
<span id="cb1-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"## NEB nebnext-small-rna-library-prep-set-for-illumina adapters"</span></span>
<span id="cb1-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export first_adapter="AGATCGGAAGAGCACACGTCTGAACTCCAGTCAC"'</span></span>
<span id="cb1-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export second_adapter="GATCGTCGGACTGTAGAACTCTGAACGTGTAGATCTCGGTGGTCGCCGTATCATT"'</span></span>
<span id="cb1-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-36"></span>
<span id="cb1-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set maximum read length for fastp merging"</span></span>
<span id="cb1-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export max_read_length="31"'</span></span>
<span id="cb1-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-40"></span>
<span id="cb1-41"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set number of CPUs to use"</span></span>
<span id="cb1-42"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=40'</span></span>
<span id="cb1-43"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-44"></span>
<span id="cb1-45"></span>
<span id="cb1-46"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"## Inititalize arrays"</span></span>
<span id="cb1-47"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R1=()'</span></span>
<span id="cb1-48"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R2=()'</span></span>
<span id="cb1-49"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export trimmed_fastqs_array=()'</span></span>
<span id="cb1-50"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R1_names_array=()'</span></span>
<span id="cb1-51"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R2_names_array=()'</span></span>
<span id="cb1-52"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-53"></span>
<span id="cb1-54"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Print formatting"</span></span>
<span id="cb1-55"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-56"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-57"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-58"></span>
<span id="cb1-59"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export repo_dir=/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa
export output_dir_top=${repo_dir}/output/01.00-trimming-fastp-fastqc
export raw_reads_dir="${repo_dir}/output/00.00-fastqc-concatenation-raw_reads"
export trimmed_fastqs_dir="${output_dir_top}"

# Paths to programs
export programs_dir="/home/shared"
export fastp="${programs_dir}/fastp-v0.24.0/fastp"
export fastqc="${programs_dir}/FastQC-0.12.1/fastqc"
export multiqc="/home/sam/programs/mambaforge/bin/multiqc"

# Set FastQ filename patterns
export fastq_pattern='*.fastq.gz'
export R1_fastq_pattern='*_R1_*.fastq.gz'
export R2_fastq_pattern='*_R2_*.fastq.gz'
export trimmed_fastq_pattern='*fastp-trim*.fq.gz'

# Input/output files
export fastq_checksums=input_fastq_checksums.md5
export NEB_adapters_fasta=NEB-adapters.fasta

## NEB nebnext-small-rna-library-prep-set-for-illumina adapters
export first_adapter="AGATCGGAAGAGCACACGTCTGAACTCCAGTCAC"
export second_adapter="GATCGTCGGACTGTAGAACTCTGAACGTGTAGATCTCGGTGGTCGCCGTATCATT"

# Set maximum read length for fastp merging
export max_read_length="31"

# Set number of CPUs to use
export threads=40

## Inititalize arrays
export fastq_array_R1=()
export fastq_array_R2=()
export trimmed_fastqs_array=()
export R1_names_array=()
export R2_names_array=()

# Print formatting
export line="--------------------------------------------------------"</code></pre>
</section>
<section id="create-adapters-fasta-for-use-with-fastp-trimming" class="level1">
<h1>3 Create adapters FastA for use with <a href="https://github.com/OpenGene/fastp"><code>fastp</code></a> trimming</h1>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create output directory, if it doesn't exist</span></span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Creating adapters FastA."</span></span>
<span id="cb3-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">adapter_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb3-10"></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check for adapters file first</span></span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Then create adapters file if doesn't exist</span></span>
<span id="cb3-13"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-f</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${NEB_adapters_fasta}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb3-14">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${NEB_adapters_fasta}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> already exists. Nothing to do."</span></span>
<span id="cb3-15"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb3-16">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> adapter <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_adapter}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${second_adapter}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-17">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb3-18">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">adapter_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$((adapter_count</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">))</span></span>
<span id="cb3-19">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt;%s\n%s\n"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"adapter_</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${adapter_count}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${adapter}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-20">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${NEB_adapters_fasta}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-21"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb3-22"></span>
<span id="cb3-23"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Adapters FastA:"</span></span>
<span id="cb3-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-26"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${NEB_adapters_fasta}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span></code></pre></div>
<pre><code>Creating adapters FastA.


Adapters FastA:

&gt;adapter_1
AGATCGGAAGAGCACACGTCTGAACTCCAGTCAC
&gt;adapter_2
GATCGTCGGACTGTAGAACTCTGAACGTGTAGATCTCGGTGGTCGCCGTATCATT</code></pre>
</section>
<section id="trimming-and-merging-with-fastp" class="level1">
<h1>4 Trimming and merging with fastp</h1>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create output directory, if it doesn't exist.</span></span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change to directory with raw reads</span></span>
<span id="cb5-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-9"></span>
<span id="cb5-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create arrays of FastQ R1 files and sample names</span></span>
<span id="cb5-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Do NOT quote R1_fastq_pattern variable</span></span>
<span id="cb5-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_fastq_pattern}</span></span>
<span id="cb5-13"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-14">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-15"></span>
<span id="cb5-16">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use parameter substitution to remove all text up to and including last "." from</span></span>
<span id="cb5-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># right side of string.</span></span>
<span id="cb5-18">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R1_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>.<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-19"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb5-20"></span>
<span id="cb5-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of FastQ R2 files</span></span>
<span id="cb5-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Do NOT quote R2_fastq_pattern variable</span></span>
<span id="cb5-23"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_fastq_pattern}</span></span>
<span id="cb5-24"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-25">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-26"></span>
<span id="cb5-27">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use parameter substitution to remove all text up to and including last "." from</span></span>
<span id="cb5-28">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># right side of string.</span></span>
<span id="cb5-29">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R2_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>.<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-30"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb5-31"></span>
<span id="cb5-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN FASTP ############</span></span>
<span id="cb5-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Uses parameter substitution (e.g. ${R1_sample_name%%_*})to rm the _R[12]</span></span>
<span id="cb5-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Uses NEB adapter file</span></span>
<span id="cb5-35"></span>
<span id="cb5-36"></span>
<span id="cb5-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run fastp on files</span></span>
<span id="cb5-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning fastp trimming."</span></span>
<span id="cb5-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-40"></span>
<span id="cb5-41"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">time</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-42">for index in <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-43"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-44">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get sample name</span></span>
<span id="cb5-45">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R1_sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]%%</span>_<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-46">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R2_sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]%%</span>_<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-47"></span>
<span id="cb5-48">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Save merged sample name</span></span>
<span id="cb5-49">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">merged_sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">-fastp-adapters-polyG-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${max_read_length}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">bp-merged"</span></span>
<span id="cb5-50">  </span>
<span id="cb5-51">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Begin fastp trimming</span></span>
<span id="cb5-52">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastp}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-53">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--in1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-54">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--in2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-55">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--adapter_fasta</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${NEB_adapters_fasta}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-56">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_poly_g</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-57">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--overlap_len_require</span> 17 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-58">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--length_limit</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${max_read_length}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-59">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--merge</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-60">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--merged_out</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${merged_sample_name}</span>.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-61">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--thread</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-62">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--html</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${merged_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.html"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-63">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--json</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${merged_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.json"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-64">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--report_title</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${merged_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-65">  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${merged_sample_name}</span>.stderr</span>
<span id="cb5-66">    </span>
<span id="cb5-67">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Move to trimmed directory</span></span>
<span id="cb5-68">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This is done so checksums file doesn't include excess path</span></span>
<span id="cb5-69">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span></span>
<span id="cb5-70"></span>
<span id="cb5-71">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate md5 checksums for newly trimmed files</span></span>
<span id="cb5-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${merged_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.fq.gz"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--append</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${merged_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.fq.gz.md5"</span></span>
<span id="cb5-73">    </span>
<span id="cb5-74">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change back to to raw reads directory</span></span>
<span id="cb5-75">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-76"></span>
<span id="cb5-77"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb5-78"></span>
<span id="cb5-79"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-80"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastp trimming complete."</span></span>
<span id="cb5-81"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-82"></span>
<span id="cb5-83"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> fastp ############</span></span></code></pre></div>
<pre><code>Beginning fastp trimming.

51f055f1810a19deb2ca09ea5bb9df0b  196-fastp-adapters-polyG-31bp-merged.fq.gz
a0673f4ad1fda1fe3f375aa2c76d5fa3  199-fastp-adapters-polyG-31bp-merged.fq.gz
b989841536ec95b3aeb10ef20f848ea7  211-fastp-adapters-polyG-31bp-merged.fq.gz
c33d44ac03a2095e55c3167b35fde0da  24-fastp-adapters-polyG-31bp-merged.fq.gz
02ddae1e57b7b9e7e63d74b4e1f725b8  260-fastp-adapters-polyG-31bp-merged.fq.gz
7c54b3c782c4ed0f15625243dfacc10a  26-fastp-adapters-polyG-31bp-merged.fq.gz
ca7286f6967abf299a9557f204eee659  30-fastp-adapters-polyG-31bp-merged.fq.gz
96c1e31ce89b5caa8a59b54c2745ae1e  310-fastp-adapters-polyG-31bp-merged.fq.gz
6d5a35136a20d9da975cf8740493a711  33-fastp-adapters-polyG-31bp-merged.fq.gz
b9c94cba5c2d2df557a833ab3a868763  341-fastp-adapters-polyG-31bp-merged.fq.gz
7530a8c684b78aa86dee725a71601f8e  34-fastp-adapters-polyG-31bp-merged.fq.gz
7c898a66f9119084ca290f0d85a34f12  35-fastp-adapters-polyG-31bp-merged.fq.gz
d80f6b589e5228731de750dd6ec5dac9  363-fastp-adapters-polyG-31bp-merged.fq.gz
f77f9aa54e2c6662abe24c3a063b6006  367-fastp-adapters-polyG-31bp-merged.fq.gz
a2281f8237ae8cb385a2c22bd185fe57  376-fastp-adapters-polyG-31bp-merged.fq.gz
03b221d3f58f3efb6a6c9a7dcfd37233  460-fastp-adapters-polyG-31bp-merged.fq.gz
c266d11555b76213d739626d40715dde  485-fastp-adapters-polyG-31bp-merged.fq.gz
3fdd30605d7a94c36b9191b34e06fbd3  501-fastp-adapters-polyG-31bp-merged.fq.gz
6929563775fded5a7a9023e3b87d76cd  71-fastp-adapters-polyG-31bp-merged.fq.gz
048d7334f58f5ce149aeadc5745fc28a  88-fastp-adapters-polyG-31bp-merged.fq.gz

real    11m50.402s
user    140m1.165s
sys 3m20.369s

fastp trimming complete.</code></pre>
</section>
<section id="fastqcmultiqc-on-trimmed-reads" class="level1">
<h1>5 FastQC/MultiQC on trimmed reads</h1>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb7-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create output directory, if it doesn't exist.</span></span>
<span id="cb7-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN FASTQC ############</span></span>
<span id="cb7-8"></span>
<span id="cb7-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Do NOT quote raw_fastqc_list</span></span>
<span id="cb7-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of trimmed FastQs</span></span>
<span id="cb7-11"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trimmed_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(${trimmed_fastqs_dir}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>merged.fq.gz<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb7-12"></span>
<span id="cb7-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pass array contents to new variable as space-delimited list</span></span>
<span id="cb7-14"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trimmed_fastqc_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[*]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb7-15"></span>
<span id="cb7-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning FastQC on raw reads..."</span></span>
<span id="cb7-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb7-18"></span>
<span id="cb7-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run FastQC</span></span>
<span id="cb7-20"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastqc}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-21">--threads <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-22">--outdir <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-23">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-24"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqc_list}</span></span>
<span id="cb7-25"></span>
<span id="cb7-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC on trimmed reads complete!"</span></span>
<span id="cb7-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb7-28"></span>
<span id="cb7-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> FASTQC ############</span></span>
<span id="cb7-30"></span>
<span id="cb7-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN MULTIQC ############</span></span>
<span id="cb7-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning MultiQC on raw FastQC..."</span></span>
<span id="cb7-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb7-34"></span>
<span id="cb7-35"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${multiqc}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span></span>
<span id="cb7-36"></span>
<span id="cb7-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb7-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MultiQC on trimmed FastQs complete."</span></span>
<span id="cb7-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb7-40"></span>
<span id="cb7-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> MULTIQC ############</span></span>
<span id="cb7-42"></span>
<span id="cb7-43"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Removing FastQC zip files."</span></span>
<span id="cb7-44"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb7-45"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.zip</span>
<span id="cb7-46"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC zip files removed."</span></span>
<span id="cb7-47"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span></code></pre></div>
<pre><code>Beginning FastQC on raw reads...

application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
FastQC on trimmed reads complete!

Beginning MultiQC on raw FastQC...


  /// MultiQC ðŸ” | v1.14

|           multiqc | MultiQC Version v1.25.2 now available!
|           multiqc | Search path : /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/01.00-trimming-fastp-fastqc
|         searching | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 100% 141/141  
|            fastqc | Found 20 reports
|           multiqc | Compressing plot data
|           multiqc | Report      : ../output/01.00-trimming-fastp-fastqc/multiqc_report.html
|           multiqc | Data        : ../output/01.00-trimming-fastp-fastqc/multiqc_data
|           multiqc | MultiQC complete

MultiQC on trimmed FastQs complete.

Removing FastQC zip files.

FastQC zip files removed.</code></pre>
</section>
<section id="list-output-files" class="level1">
<h1>6 List output files</h1>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb9-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb9-3"></span>
<span id="cb9-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># View directory contents</span></span>
<span id="cb9-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span></span></code></pre></div>
<pre><code>total 6.8G
-rw-r--r-- 1 sam sam 564K Dec  5 18:48 196-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 336M Dec  5 18:36 196-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   77 Dec  5 18:36 196-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:36 196-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:36 196-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.3K Dec  5 18:36 196-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 569K Dec  5 18:48 199-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 283M Dec  5 18:37 199-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   77 Dec  5 18:37 199-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:37 199-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:37 199-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.3K Dec  5 18:37 199-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 567K Dec  5 18:48 211-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 298M Dec  5 18:37 211-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   77 Dec  5 18:37 211-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 349K Dec  5 18:37 211-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  91K Dec  5 18:37 211-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.3K Dec  5 18:37 211-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 566K Dec  5 18:48 24-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 320M Dec  5 18:38 24-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   76 Dec  5 18:38 24-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:38 24-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:38 24-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.2K Dec  5 18:38 24-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 569K Dec  5 18:48 260-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 327M Dec  5 18:38 260-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   77 Dec  5 18:38 260-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:38 260-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:38 260-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.3K Dec  5 18:38 260-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 568K Dec  5 18:48 26-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 306M Dec  5 18:39 26-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   76 Dec  5 18:39 26-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 349K Dec  5 18:39 26-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  91K Dec  5 18:39 26-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.2K Dec  5 18:39 26-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 570K Dec  5 18:48 30-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 331M Dec  5 18:39 30-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   76 Dec  5 18:39 30-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:39 30-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:39 30-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.2K Dec  5 18:39 30-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 571K Dec  5 18:48 310-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 326M Dec  5 18:40 310-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   77 Dec  5 18:40 310-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:40 310-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:40 310-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.3K Dec  5 18:40 310-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 566K Dec  5 18:49 33-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 341M Dec  5 18:41 33-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   76 Dec  5 18:41 33-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 351K Dec  5 18:40 33-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:40 33-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.2K Dec  5 18:41 33-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 564K Dec  5 18:48 341-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 325M Dec  5 18:41 341-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   77 Dec  5 18:41 341-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:41 341-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:41 341-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.3K Dec  5 18:41 341-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 564K Dec  5 18:49 34-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 394M Dec  5 18:42 34-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   76 Dec  5 18:42 34-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:42 34-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:42 34-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.2K Dec  5 18:42 34-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 570K Dec  5 18:48 35-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 298M Dec  5 18:42 35-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   76 Dec  5 18:42 35-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 349K Dec  5 18:42 35-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  91K Dec  5 18:42 35-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.2K Dec  5 18:42 35-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 572K Dec  5 18:49 363-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 354M Dec  5 18:43 363-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   77 Dec  5 18:43 363-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:43 363-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:43 363-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.3K Dec  5 18:43 363-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 564K Dec  5 18:49 367-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 323M Dec  5 18:43 367-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   77 Dec  5 18:43 367-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 349K Dec  5 18:43 367-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  91K Dec  5 18:43 367-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.3K Dec  5 18:43 367-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 566K Dec  5 18:49 376-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 603M Dec  5 18:44 376-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   77 Dec  5 18:44 376-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 351K Dec  5 18:44 376-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  93K Dec  5 18:44 376-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.3K Dec  5 18:44 376-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 565K Dec  5 18:48 460-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 305M Dec  5 18:45 460-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   77 Dec  5 18:45 460-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:45 460-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:45 460-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.3K Dec  5 18:45 460-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 566K Dec  5 18:49 485-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 320M Dec  5 18:46 485-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   77 Dec  5 18:46 485-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:46 485-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:46 485-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.3K Dec  5 18:46 485-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 563K Dec  5 18:49 501-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 353M Dec  5 18:46 501-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   77 Dec  5 18:46 501-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:46 501-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:46 501-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.3K Dec  5 18:46 501-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 568K Dec  5 18:49 71-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 380M Dec  5 18:47 71-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   76 Dec  5 18:47 71-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:47 71-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:47 71-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.2K Dec  5 18:47 71-fastp-adapters-polyG-31bp-merged.stderr
-rw-r--r-- 1 sam sam 563K Dec  5 18:49 88-fastp-adapters-polyG-31bp-merged_fastqc.html
-rw-r--r-- 1 sam sam 374M Dec  5 18:47 88-fastp-adapters-polyG-31bp-merged.fq.gz
-rw-r--r-- 1 sam sam   76 Dec  5 18:47 88-fastp-adapters-polyG-31bp-merged.fq.gz.md5
-rw-r--r-- 1 sam sam 350K Dec  5 18:47 88-fastp-adapters-polyG-31bp-merged.html
-rw-r--r-- 1 sam sam  92K Dec  5 18:47 88-fastp-adapters-polyG-31bp-merged.json
-rw-r--r-- 1 sam sam 2.2K Dec  5 18:47 88-fastp-adapters-polyG-31bp-merged.stderr
drwxr-xr-x 2 sam sam 4.0K Dec  5 18:49 multiqc_data
-rw-r--r-- 1 sam sam 1.3M Dec  5 18:49 multiqc_report.html
-rw-r--r-- 1 sam sam  113 Dec  5 18:36 NEB-adapters.fasta</code></pre>


</section>

 ]]></description>
  <category>2024</category>
  <category>Ruditapes philippinarum</category>
  <category>Manila clam</category>
  <category>project-clam-oa</category>
  <category>sRNA-seq</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-12-06-Trimming-and-Merging---R.philippinarum-sRNA-seq-Data-Using-fastp-FastQC-and-MultiQC/</guid>
  <pubDate>Fri, 06 Dec 2024 08:00:00 GMT</pubDate>
  <media:content url="https://robertslab.github.io/sams-notebook/posts/2024/2024-12-06-Trimming-and-Merging---R.philippinarum-sRNA-seq-Data-Using-fastp-FastQC-and-MultiQC/20241206-rphi-fastp-trim_merge-fastqc_sequence_length_distribution_plot.png" medium="image" type="image/png" height="96" width="144"/>
</item>
<item>
  <title>FastQ Concatentation and QC - R.philippinarum sRNA-seq Data Using FastQC and MultiQC</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-12-05-FastQ-Concatentation-and-QC---R.philippinarum-sRNA-seq-Data-Using-FastQC-and-MultiQC/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>This notebook is part of <a href="https://github.com/RobertsLab/project-clam-oa/tree/main">project-clam-oa</a> (GitHub repo).</p>
<p>I performed concatenation and <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/"><code>FastQC</code></a> and <a href="https://multiqc.info/"><code>MultiQC</code></a> QC assessments of the sRNA-seq data received:</p>
<ul>
<li><p><a href="../../../posts/2024/2024-10-01-Data-Received---R.philippinarum-(Manilla-clam)-sRNA-seq-Data-from-Azenta-Project-30-1035633055/index.html">20241001</a> (Notebook entry)</p></li>
<li><p><a href="../../../posts/2024/2024-11-01-Data-Received---Manila-clam-Supplemental-sRNA-seq-Data-from-Azenta/index.html">20241101 Supplemental data</a> (Notebook entry)</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This notebook is copied from knitted markdown from <a href="https://github.com/RobertsLab/project-clam-oa/blob/74b05215bc5a72ff6d6f5626f18af621818523ef/code/00.00-fastqc-concatenation-raw_reads.Rmd"><code>00.00-fastqc-concatenation-raw_reads.Rmd</code></a> (commit <code>74b0521</code>).</p>
</div>
</div>
</section>
<section id="description" class="level1">
<h1>1 Description</h1>
<p>This notebook will download raw sRNA-seq FastQs, concatenate them (there were multiple lanes run), and then assess with <a href="https://github.com/s-andrews/FastQC">FastQC</a> and <a href="https://github.com/MultiQC/MultiQC">MultiQC</a> (Ewels et al.&nbsp;2016).</p>
<section id="inputs" class="level2">
<h2 class="anchored" data-anchor-id="inputs">1.1 Inputs</h2>
<p>Raw FastQ files with the following pattern:</p>
<ul>
<li><code>*.fastq.gz</code></li>
</ul>
</section>
<section id="outputs" class="level2">
<h2 class="anchored" data-anchor-id="outputs">1.2 Outputs</h2>
<p>The expected outputs will be:</p>
<ul>
<li><p><code>*.fastq.gz</code>: Concatenated FastQ files.</p></li>
<li><p><code>*.fastqc.html</code>: FastQC results, in HTML format.</p></li>
<li><p><code>multiqc_report.html</code>: A summary report of the alignment results generated by <a href="https://github.com/MultiQC/MultiQC">MultiQC</a>, in HTML format.</p></li>
</ul>
</section>
</section>
<section id="create-a-bash-variables-file" class="level1">
<h1>2 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export repo_dir=/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export output_dir_top=${repo_dir}/output/00.00-fastqc-concatenation-raw_reads'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_url="https://owl.fish.washington.edu/nightingales/R_philippinarum/"'</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_dir="${repo_dir}/data/raw_reads"'</span></span>
<span id="cb1-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export project_dir_1="30-1035633055"'</span></span>
<span id="cb1-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export project_dir_2="30-1035633055-TS01"'</span></span>
<span id="cb1-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-13"></span>
<span id="cb1-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Paths to programs"</span></span>
<span id="cb1-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export programs_dir="/home/shared"'</span></span>
<span id="cb1-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastqc="${programs_dir}/FastQC-0.12.1/fastqc"'</span></span>
<span id="cb1-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export multiqc="/home/sam/programs/mambaforge/bin/multiqc"'</span></span>
<span id="cb1-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-19"></span>
<span id="cb1-20"></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set FastQ filename patterns"</span></span>
<span id="cb1-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export fastq_pattern='*.fastq.gz'"</span></span>
<span id="cb1-23"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R1_fastq_pattern='*_R1_*.fastq.gz'"</span></span>
<span id="cb1-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R2_fastq_pattern='*_R2_*.fastq.gz'"</span></span>
<span id="cb1-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-26"></span>
<span id="cb1-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set number of CPUs to use"</span></span>
<span id="cb1-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=40'</span></span>
<span id="cb1-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-30"></span>
<span id="cb1-31"></span>
<span id="cb1-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"## Inititalize arrays"</span></span>
<span id="cb1-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R1=()'</span></span>
<span id="cb1-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R2=()'</span></span>
<span id="cb1-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export trimmed_fastqs_array=()'</span></span>
<span id="cb1-36"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R1_names_array=()'</span></span>
<span id="cb1-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R2_names_array=()'</span></span>
<span id="cb1-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-39"></span>
<span id="cb1-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Print formatting"</span></span>
<span id="cb1-41"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-42"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-43"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-44"></span>
<span id="cb1-45"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export repo_dir=/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa
export output_dir_top=${repo_dir}/output/00.00-fastqc-concatenation-raw_reads
export raw_reads_url="https://owl.fish.washington.edu/nightingales/R_philippinarum/"
export raw_reads_dir="${repo_dir}/data/raw_reads"
export project_dir_1="30-1035633055"
export project_dir_2="30-1035633055-TS01"

# Paths to programs
export programs_dir="/home/shared"
export fastqc="${programs_dir}/FastQC-0.12.1/fastqc"
export multiqc="/home/sam/programs/mambaforge/bin/multiqc"

# Set FastQ filename patterns
export fastq_pattern='*.fastq.gz'
export R1_fastq_pattern='*_R1_*.fastq.gz'
export R2_fastq_pattern='*_R2_*.fastq.gz'

# Set number of CPUs to use
export threads=40

## Inititalize arrays
export fastq_array_R1=()
export fastq_array_R2=()
export trimmed_fastqs_array=()
export R1_names_array=()
export R2_names_array=()

# Print formatting
export line="--------------------------------------------------------"</code></pre>
</section>
<section id="download-raw-reads" class="level1">
<h1>3 Download raw reads</h1>
<p>The <code>--cut-dirs 3</code> command cuts the preceding directory structure (i.e.&nbsp;<code>R_philippinarum/30-1035633055/</code>) so that we just end up with the reads.</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create directory, if it doesn't exist</span></span>
<span id="cb3-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${project_dir_1}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${project_dir_2}</span></span>
<span id="cb3-9"></span>
<span id="cb3-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> directory <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${project_dir_1}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${project_dir_2}</span></span>
<span id="cb3-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb3-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--directory-prefix</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${directory}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--recursive</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-check-certificate</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--continue</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cut-dirs</span> 3 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-parent</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-host-directories</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--quiet</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-21">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_url}</span></span>
<span id="cb3-22">  </span>
<span id="cb3-23">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove extraneous indext files</span></span>
<span id="cb3-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${project_dir_1}</span>/index<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb3-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${project_dir_2}</span>/index<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb3-26"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<section id="overview-of-downloads" class="level2">
<h2 class="anchored" data-anchor-id="overview-of-downloads">3.1 Overview of downloads</h2>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb4-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tree</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--du</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-h</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<pre><code>/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
â”œâ”€â”€ [694K]  196_R1_001_fastqc.html
â”œâ”€â”€ [1.0G]  196_R1_001.fastq.gz
â”œâ”€â”€ [ 162]  196_R1_001.fastq.gz.md5
â”œâ”€â”€ [679K]  196_R2_001_fastqc.html
â”œâ”€â”€ [740M]  196_R2_001.fastq.gz
â”œâ”€â”€ [  54]  196_R2_001.fastq.gz.md5
â”œâ”€â”€ [699K]  199_R1_001_fastqc.html
â”œâ”€â”€ [859M]  199_R1_001.fastq.gz
â”œâ”€â”€ [ 162]  199_R1_001.fastq.gz.md5
â”œâ”€â”€ [682K]  199_R2_001_fastqc.html
â”œâ”€â”€ [574M]  199_R2_001.fastq.gz
â”œâ”€â”€ [  54]  199_R2_001.fastq.gz.md5
â”œâ”€â”€ [699K]  211_R1_001_fastqc.html
â”œâ”€â”€ [926M]  211_R1_001.fastq.gz
â”œâ”€â”€ [ 162]  211_R1_001.fastq.gz.md5
â”œâ”€â”€ [683K]  211_R2_001_fastqc.html
â”œâ”€â”€ [607M]  211_R2_001.fastq.gz
â”œâ”€â”€ [  54]  211_R2_001.fastq.gz.md5
â”œâ”€â”€ [700K]  24_R1_001_fastqc.html
â”œâ”€â”€ [899M]  24_R1_001.fastq.gz
â”œâ”€â”€ [ 159]  24_R1_001.fastq.gz.md5
â”œâ”€â”€ [681K]  24_R2_001_fastqc.html
â”œâ”€â”€ [642M]  24_R2_001.fastq.gz
â”œâ”€â”€ [  53]  24_R2_001.fastq.gz.md5
â”œâ”€â”€ [705K]  260_R1_001_fastqc.html
â”œâ”€â”€ [955M]  260_R1_001.fastq.gz
â”œâ”€â”€ [ 162]  260_R1_001.fastq.gz.md5
â”œâ”€â”€ [681K]  260_R2_001_fastqc.html
â”œâ”€â”€ [653M]  260_R2_001.fastq.gz
â”œâ”€â”€ [  54]  260_R2_001.fastq.gz.md5
â”œâ”€â”€ [700K]  26_R1_001_fastqc.html
â”œâ”€â”€ [944M]  26_R1_001.fastq.gz
â”œâ”€â”€ [ 159]  26_R1_001.fastq.gz.md5
â”œâ”€â”€ [681K]  26_R2_001_fastqc.html
â”œâ”€â”€ [607M]  26_R2_001.fastq.gz
â”œâ”€â”€ [  53]  26_R2_001.fastq.gz.md5
â”œâ”€â”€ [ 28G]  30-1035633055
â”‚&nbsp;&nbsp; â”œâ”€â”€ [898M]  196_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  196_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [617M]  196_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  196_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [722M]  199_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  199_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [481M]  199_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  199_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [778M]  211_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  211_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [508M]  211_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  211_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [753M]  24_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  24_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [535M]  24_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  24_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [798M]  260_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  260_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [544M]  260_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  260_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [788M]  26_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  26_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [507M]  26_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  26_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [837M]  30_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  30_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [562M]  30_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  30_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [792M]  310_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  310_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [554M]  310_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  310_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [801M]  33_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  33_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [561M]  33_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  33_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [832M]  341_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  341_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [555M]  341_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  341_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [900M]  34_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  34_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [640M]  34_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  34_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [766M]  35_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  35_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [497M]  35_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  35_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [855M]  363_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  363_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [591M]  363_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  363_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [825M]  367_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  367_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [541M]  367_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  367_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [1.4G]  376_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  376_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [1016M]  376_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  376_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [798M]  460_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  460_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [535M]  460_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  460_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [814M]  485_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  485_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [550M]  485_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  485_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [886M]  501_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  501_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [598M]  501_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  501_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [946M]  71_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  71_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [619M]  71_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  71_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [939M]  88_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  88_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [645M]  88_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  88_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â””â”€â”€ [585K]  Azenta_30-1035633055_Data_Report.html
â”œâ”€â”€ [5.5G]  30-1035633055-TS01
â”‚&nbsp;&nbsp; â”œâ”€â”€ [175M]  196_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  196_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [123M]  196_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  196_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [137M]  199_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  199_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [ 93M]  199_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  199_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [148M]  211_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  211_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [ 99M]  211_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  211_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [146M]  24_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  24_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [107M]  24_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  24_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [157M]  260_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  260_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [109M]  260_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  260_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [155M]  26_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  26_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [100M]  26_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  26_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [163M]  30_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  30_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [114M]  30_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  30_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [151M]  310_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  310_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [109M]  310_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  310_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [154M]  33_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  33_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [110M]  33_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  33_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [161M]  341_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  341_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [109M]  341_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  341_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [179M]  34_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  34_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [128M]  34_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  34_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [148M]  35_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  35_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [ 99M]  35_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  35_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [165M]  363_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  363_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [116M]  363_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  363_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [159M]  367_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  367_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [107M]  367_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  367_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [290M]  376_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  376_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [203M]  376_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  376_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [153M]  460_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  460_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [106M]  460_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  460_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [160M]  485_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  485_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [111M]  485_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  485_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [176M]  501_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  501_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [122M]  501_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  56]  501_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [181M]  71_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  71_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [121M]  71_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  71_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [181M]  88_R1_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  88_R1_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â”œâ”€â”€ [127M]  88_R2_001.fastq.gz
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  55]  88_R2_001.fastq.gz.md5
â”‚&nbsp;&nbsp; â””â”€â”€ [585K]  Azenta_30-1035633055-TS01_Data_Report.html
â”œâ”€â”€ [703K]  30_R1_001_fastqc.html
â”œâ”€â”€ [1000M]  30_R1_001.fastq.gz
â”œâ”€â”€ [ 159]  30_R1_001.fastq.gz.md5
â”œâ”€â”€ [681K]  30_R2_001_fastqc.html
â”œâ”€â”€ [676M]  30_R2_001.fastq.gz
â”œâ”€â”€ [  53]  30_R2_001.fastq.gz.md5
â”œâ”€â”€ [699K]  310_R1_001_fastqc.html
â”œâ”€â”€ [942M]  310_R1_001.fastq.gz
â”œâ”€â”€ [ 162]  310_R1_001.fastq.gz.md5
â”œâ”€â”€ [683K]  310_R2_001_fastqc.html
â”œâ”€â”€ [663M]  310_R2_001.fastq.gz
â”œâ”€â”€ [  54]  310_R2_001.fastq.gz.md5
â”œâ”€â”€ [703K]  33_R1_001_fastqc.html
â”œâ”€â”€ [955M]  33_R1_001.fastq.gz
â”œâ”€â”€ [ 159]  33_R1_001.fastq.gz.md5
â”œâ”€â”€ [679K]  33_R2_001_fastqc.html
â”œâ”€â”€ [671M]  33_R2_001.fastq.gz
â”œâ”€â”€ [  53]  33_R2_001.fastq.gz.md5
â”œâ”€â”€ [701K]  341_R1_001_fastqc.html
â”œâ”€â”€ [992M]  341_R1_001.fastq.gz
â”œâ”€â”€ [ 162]  341_R1_001.fastq.gz.md5
â”œâ”€â”€ [686K]  341_R2_001_fastqc.html
â”œâ”€â”€ [664M]  341_R2_001.fastq.gz
â”œâ”€â”€ [  54]  341_R2_001.fastq.gz.md5
â”œâ”€â”€ [700K]  34_R1_001_fastqc.html
â”œâ”€â”€ [1.1G]  34_R1_001.fastq.gz
â”œâ”€â”€ [ 159]  34_R1_001.fastq.gz.md5
â”œâ”€â”€ [677K]  34_R2_001_fastqc.html
â”œâ”€â”€ [768M]  34_R2_001.fastq.gz
â”œâ”€â”€ [  53]  34_R2_001.fastq.gz.md5
â”œâ”€â”€ [702K]  35_R1_001_fastqc.html
â”œâ”€â”€ [914M]  35_R1_001.fastq.gz
â”œâ”€â”€ [ 159]  35_R1_001.fastq.gz.md5
â”œâ”€â”€ [681K]  35_R2_001_fastqc.html
â”œâ”€â”€ [595M]  35_R2_001.fastq.gz
â”œâ”€â”€ [  53]  35_R2_001.fastq.gz.md5
â”œâ”€â”€ [703K]  363_R1_001_fastqc.html
â”œâ”€â”€ [1021M]  363_R1_001.fastq.gz
â”œâ”€â”€ [ 162]  363_R1_001.fastq.gz.md5
â”œâ”€â”€ [681K]  363_R2_001_fastqc.html
â”œâ”€â”€ [707M]  363_R2_001.fastq.gz
â”œâ”€â”€ [  54]  363_R2_001.fastq.gz.md5
â”œâ”€â”€ [698K]  367_R1_001_fastqc.html
â”œâ”€â”€ [984M]  367_R1_001.fastq.gz
â”œâ”€â”€ [ 162]  367_R1_001.fastq.gz.md5
â”œâ”€â”€ [681K]  367_R2_001_fastqc.html
â”œâ”€â”€ [648M]  367_R2_001.fastq.gz
â”œâ”€â”€ [  54]  367_R2_001.fastq.gz.md5
â”œâ”€â”€ [701K]  376_R1_001_fastqc.html
â”œâ”€â”€ [1.7G]  376_R1_001.fastq.gz
â”œâ”€â”€ [ 162]  376_R1_001.fastq.gz.md5
â”œâ”€â”€ [682K]  376_R2_001_fastqc.html
â”œâ”€â”€ [1.2G]  376_R2_001.fastq.gz
â”œâ”€â”€ [  54]  376_R2_001.fastq.gz.md5
â”œâ”€â”€ [696K]  460_R1_001_fastqc.html
â”œâ”€â”€ [951M]  460_R1_001.fastq.gz
â”œâ”€â”€ [ 162]  460_R1_001.fastq.gz.md5
â”œâ”€â”€ [682K]  460_R2_001_fastqc.html
â”œâ”€â”€ [641M]  460_R2_001.fastq.gz
â”œâ”€â”€ [  54]  460_R2_001.fastq.gz.md5
â”œâ”€â”€ [700K]  485_R1_001_fastqc.html
â”œâ”€â”€ [974M]  485_R1_001.fastq.gz
â”œâ”€â”€ [ 162]  485_R1_001.fastq.gz.md5
â”œâ”€â”€ [683K]  485_R2_001_fastqc.html
â”œâ”€â”€ [661M]  485_R2_001.fastq.gz
â”œâ”€â”€ [  54]  485_R2_001.fastq.gz.md5
â”œâ”€â”€ [701K]  501_R1_001_fastqc.html
â”œâ”€â”€ [1.0G]  501_R1_001.fastq.gz
â”œâ”€â”€ [ 162]  501_R1_001.fastq.gz.md5
â”œâ”€â”€ [680K]  501_R2_001_fastqc.html
â”œâ”€â”€ [720M]  501_R2_001.fastq.gz
â”œâ”€â”€ [  54]  501_R2_001.fastq.gz.md5
â”œâ”€â”€ [692K]  71_R1_001_fastqc.html
â”œâ”€â”€ [1.1G]  71_R1_001.fastq.gz
â”œâ”€â”€ [ 159]  71_R1_001.fastq.gz.md5
â”œâ”€â”€ [671K]  71_R2_001_fastqc.html
â”œâ”€â”€ [740M]  71_R2_001.fastq.gz
â”œâ”€â”€ [  53]  71_R2_001.fastq.gz.md5
â”œâ”€â”€ [699K]  88_R1_001_fastqc.html
â”œâ”€â”€ [1.1G]  88_R1_001.fastq.gz
â”œâ”€â”€ [ 159]  88_R1_001.fastq.gz.md5
â”œâ”€â”€ [679K]  88_R2_001_fastqc.html
â”œâ”€â”€ [772M]  88_R2_001.fastq.gz
â”œâ”€â”€ [  53]  88_R2_001.fastq.gz.md5
â”œâ”€â”€ [2.8M]  multiqc_data
â”‚&nbsp;&nbsp; â”œâ”€â”€ [  62]  multiqc_citations.txt
â”‚&nbsp;&nbsp; â”œâ”€â”€ [2.8M]  multiqc_data.json
â”‚&nbsp;&nbsp; â”œâ”€â”€ [8.0K]  multiqc_fastqc.txt
â”‚&nbsp;&nbsp; â”œâ”€â”€ [3.1K]  multiqc_general_stats.txt
â”‚&nbsp;&nbsp; â”œâ”€â”€ [4.0K]  multiqc.log
â”‚&nbsp;&nbsp; â””â”€â”€ [5.2K]  multiqc_sources.txt
â””â”€â”€ [1.6M]  multiqc_report.html

  67G used in 3 directories, 289 files</code></pre>
</section>
<section id="verify-checkums" class="level2">
<h2 class="anchored" data-anchor-id="verify-checkums">3.2 Verify checkums</h2>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb6-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${project_dir_1}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb6-5"></span>
<span id="cb6-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span></span>
<span id="cb6-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb6-8"></span>
<span id="cb6-9"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> checksum <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.md5</span>
<span id="cb6-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb6-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--check</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${checksum}</span></span>
<span id="cb6-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb6-13"></span>
<span id="cb6-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb6-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb6-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb6-17"></span>
<span id="cb6-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${project_dir_2}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb6-19"></span>
<span id="cb6-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span></span>
<span id="cb6-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb6-22"></span>
<span id="cb6-23"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> checksum <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.md5</span>
<span id="cb6-24"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb6-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--check</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${checksum}</span></span>
<span id="cb6-26"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<pre><code>/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055

./196_R1_001.fastq.gz: OK
./196_R2_001.fastq.gz: OK
./199_R1_001.fastq.gz: OK
./199_R2_001.fastq.gz: OK
./211_R1_001.fastq.gz: OK
./211_R2_001.fastq.gz: OK
./24_R1_001.fastq.gz: OK
./24_R2_001.fastq.gz: OK
./260_R1_001.fastq.gz: OK
./260_R2_001.fastq.gz: OK
./26_R1_001.fastq.gz: OK
./26_R2_001.fastq.gz: OK
./30_R1_001.fastq.gz: OK
./30_R2_001.fastq.gz: OK
./310_R1_001.fastq.gz: OK
./310_R2_001.fastq.gz: OK
./33_R1_001.fastq.gz: OK
./33_R2_001.fastq.gz: OK
./341_R1_001.fastq.gz: OK
./341_R2_001.fastq.gz: OK
./34_R1_001.fastq.gz: OK
./34_R2_001.fastq.gz: OK
./35_R1_001.fastq.gz: OK
./35_R2_001.fastq.gz: OK
./363_R1_001.fastq.gz: OK
./363_R2_001.fastq.gz: OK
./367_R1_001.fastq.gz: OK
./367_R2_001.fastq.gz: OK
./376_R1_001.fastq.gz: OK
./376_R2_001.fastq.gz: OK
./460_R1_001.fastq.gz: OK
./460_R2_001.fastq.gz: OK
./485_R1_001.fastq.gz: OK
./485_R2_001.fastq.gz: OK
./501_R1_001.fastq.gz: OK
./501_R2_001.fastq.gz: OK
./71_R1_001.fastq.gz: OK
./71_R2_001.fastq.gz: OK
./88_R1_001.fastq.gz: OK
./88_R2_001.fastq.gz: OK

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01

./196_R1_001.fastq.gz: OK
./196_R2_001.fastq.gz: OK
./199_R1_001.fastq.gz: OK
./199_R2_001.fastq.gz: OK
./211_R1_001.fastq.gz: OK
./211_R2_001.fastq.gz: OK
./24_R1_001.fastq.gz: OK
./24_R2_001.fastq.gz: OK
./260_R1_001.fastq.gz: OK
./260_R2_001.fastq.gz: OK
./26_R1_001.fastq.gz: OK
./26_R2_001.fastq.gz: OK
./30_R1_001.fastq.gz: OK
./30_R2_001.fastq.gz: OK
./310_R1_001.fastq.gz: OK
./310_R2_001.fastq.gz: OK
./33_R1_001.fastq.gz: OK
./33_R2_001.fastq.gz: OK
./341_R1_001.fastq.gz: OK
./341_R2_001.fastq.gz: OK
./34_R1_001.fastq.gz: OK
./34_R2_001.fastq.gz: OK
./35_R1_001.fastq.gz: OK
./35_R2_001.fastq.gz: OK
./363_R1_001.fastq.gz: OK
./363_R2_001.fastq.gz: OK
./367_R1_001.fastq.gz: OK
./367_R2_001.fastq.gz: OK
./376_R1_001.fastq.gz: OK
./376_R2_001.fastq.gz: OK
./460_R1_001.fastq.gz: OK
./460_R2_001.fastq.gz: OK
./485_R1_001.fastq.gz: OK
./485_R2_001.fastq.gz: OK
./501_R1_001.fastq.gz: OK
./501_R2_001.fastq.gz: OK
./71_R1_001.fastq.gz: OK
./71_R2_001.fastq.gz: OK
./88_R1_001.fastq.gz: OK
./88_R2_001.fastq.gz: OK</code></pre>
</section>
</section>
<section id="concatenate-reads" class="level1">
<h1>4 Concatenate reads</h1>
<p>Concatenation also handles samples where there might be a missing set of R2 reads in the second round of sequencing.</p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb8-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb8-3"></span>
<span id="cb8-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directory, if it doens't exist</span></span>
<span id="cb8-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span></span>
<span id="cb8-6"></span>
<span id="cb8-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb8-8"></span>
<span id="cb8-9"></span>
<span id="cb8-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Concatenate FastQ files from 1st and 2nd runs</span></span>
<span id="cb8-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Do NOT quote fastq_pattern variable</span></span>
<span id="cb8-12"></span>
<span id="cb8-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Declare an associative array to keep track of processed files</span></span>
<span id="cb8-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">declare</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">processed_files</span></span>
<span id="cb8-15"></span>
<span id="cb8-16"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> first_run_fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${project_dir_1}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_pattern}</span></span>
<span id="cb8-17"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb8-18">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Strip full path to just get filename.</span></span>
<span id="cb8-19">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">first_run_fastq_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb8-20"></span>
<span id="cb8-21">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize a flag to check if a match is found</span></span>
<span id="cb8-22">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">match_found</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>false</span>
<span id="cb8-23"></span>
<span id="cb8-24">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Process second run and concatenate with corresponding FastQ from first run</span></span>
<span id="cb8-25">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Do NOT quote fastq_pattern variable</span></span>
<span id="cb8-26">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> second_run_fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${project_dir_2}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_pattern}</span></span>
<span id="cb8-27">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb8-28">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Strip full path to just get filename.</span></span>
<span id="cb8-29">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">second_run_fastq_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${second_run_fastq</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb8-30"></span>
<span id="cb8-31">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Concatenate FastQs with same filenames</span></span>
<span id="cb8-32">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${second_run_fastq_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]]</span></span>
<span id="cb8-33">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb8-34">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Concatenating </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> with </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${second_run_fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> to </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb8-35">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb8-36">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${second_run_fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb8-37">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">match_found</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true</span>
<span id="cb8-38">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">processed_files</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>true</span>
<span id="cb8-39">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">break</span></span>
<span id="cb8-40">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb8-41">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb8-42"></span>
<span id="cb8-43">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If no match is found, copy the file to the target directory</span></span>
<span id="cb8-44">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${match_found}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> false <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]]</span></span>
<span id="cb8-45">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb8-46">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-z</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${processed_files</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq_name}</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]]</span></span>
<span id="cb8-47">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb8-48">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NO MATCH!"</span></span>
<span id="cb8-49">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Copying </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> to </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb8-50">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb8-51">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cp</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb8-52">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">processed_files</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>true</span>
<span id="cb8-53">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb8-54">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb8-55">  </span>
<span id="cb8-56">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate MD5 checksums</span></span>
<span id="cb8-57">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span></span>
<span id="cb8-58">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Generating checksums for concatenated FastQs..."</span></span>
<span id="cb8-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--append</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.md5</span>
<span id="cb8-60">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb8-61">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb8-62">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb8-63">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb8-64"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<pre><code>Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/196_R1_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/196_R1_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/196_R1_001.fastq.gz

Generating checksums for concatenated FastQs...
9417deb3991ecedd89bd0b796b609deb  196_R1_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/196_R2_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/196_R2_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/196_R2_001.fastq.gz

Generating checksums for concatenated FastQs...
a24eecd018b5f0f8a60cc8df104a15f3  196_R2_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/199_R1_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/199_R1_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/199_R1_001.fastq.gz

Generating checksums for concatenated FastQs...
862564fb77d382c9d18949335dd8aa23  199_R1_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/199_R2_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/199_R2_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/199_R2_001.fastq.gz

Generating checksums for concatenated FastQs...
72369d2d653f177647331dc5c83adae9  199_R2_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/211_R1_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/211_R1_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/211_R1_001.fastq.gz

Generating checksums for concatenated FastQs...
ade53539022aa28c1a60533823c38107  211_R1_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/211_R2_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/211_R2_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/211_R2_001.fastq.gz

Generating checksums for concatenated FastQs...
ea1e84b96485e1e6d3e48e146c0c22b3  211_R2_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/24_R1_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/24_R1_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/24_R1_001.fastq.gz

Generating checksums for concatenated FastQs...
e958e60126298c3567ba61f1ac061c31  24_R1_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/24_R2_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/24_R2_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/24_R2_001.fastq.gz

Generating checksums for concatenated FastQs...
2dd7215f5695f85b5ae5eabf87d0aae2  24_R2_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/260_R1_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/260_R1_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/260_R1_001.fastq.gz

Generating checksums for concatenated FastQs...
8f3df276c61a575a779f24a5a1524972  260_R1_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/260_R2_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/260_R2_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/260_R2_001.fastq.gz

Generating checksums for concatenated FastQs...
e830f7f7e4ebee517243d0256107d036  260_R2_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/26_R1_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/26_R1_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/26_R1_001.fastq.gz

Generating checksums for concatenated FastQs...
b0bacc581eb09abc35002df6242d4395  26_R1_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/26_R2_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/26_R2_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/26_R2_001.fastq.gz

Generating checksums for concatenated FastQs...
0377d016bb2284f466388c56d0351c0a  26_R2_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/30_R1_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/30_R1_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/30_R1_001.fastq.gz

Generating checksums for concatenated FastQs...
b27369e79417c98c558d86a8b11bb092  30_R1_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/30_R2_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/30_R2_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/30_R2_001.fastq.gz

Generating checksums for concatenated FastQs...
3e246bcbe3b5f8d83ce16960b4c0ce9a  30_R2_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/310_R1_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/310_R1_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/310_R1_001.fastq.gz

Generating checksums for concatenated FastQs...
1aee070979f4e2484d42ae1d53c13825  310_R1_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/310_R2_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/310_R2_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/310_R2_001.fastq.gz

Generating checksums for concatenated FastQs...
0566e0d8d195fc9c6a6253e5c19d2032  310_R2_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/33_R1_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/33_R1_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/33_R1_001.fastq.gz

Generating checksums for concatenated FastQs...
cf6af56a0a882e8c92f9b7a63b305711  33_R1_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/33_R2_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/33_R2_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/33_R2_001.fastq.gz

Generating checksums for concatenated FastQs...
73fafa2ae9986be6d1be405f8f6fec78  33_R2_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/341_R1_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/341_R1_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/341_R1_001.fastq.gz

Generating checksums for concatenated FastQs...
d84af357aca0e0237dd67b7bcbab32c3  341_R1_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/341_R2_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/341_R2_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/341_R2_001.fastq.gz

Generating checksums for concatenated FastQs...
35d54cdf44f0deaed484b35d34b1a3e4  341_R2_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/34_R1_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/34_R1_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/34_R1_001.fastq.gz

Generating checksums for concatenated FastQs...
a1d8006b21ac5f5ade62549d7377beef  34_R1_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/34_R2_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/34_R2_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/34_R2_001.fastq.gz

Generating checksums for concatenated FastQs...
a44a721f9cb8dda05fe669b98ced2112  34_R2_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/35_R1_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/35_R1_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/35_R1_001.fastq.gz

Generating checksums for concatenated FastQs...
25fccca8264c0a3eea8ece52d0ed6c4a  35_R1_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/35_R2_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/35_R2_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/35_R2_001.fastq.gz

Generating checksums for concatenated FastQs...
f53632400b3a7b5142890df086594561  35_R2_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/363_R1_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/363_R1_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/363_R1_001.fastq.gz

Generating checksums for concatenated FastQs...
476d3bfc92ed8234d4f05b2eb51316c0  363_R1_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/363_R2_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/363_R2_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/363_R2_001.fastq.gz

Generating checksums for concatenated FastQs...
108a47c38b3ce4ec7a9c43c656d66d78  363_R2_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/367_R1_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/367_R1_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/367_R1_001.fastq.gz

Generating checksums for concatenated FastQs...
9d4dc55e2c5a025cb452db4ba58b2426  367_R1_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/367_R2_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/367_R2_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/367_R2_001.fastq.gz

Generating checksums for concatenated FastQs...
e9ca895177af7f4ecd7b4cea1efb8e94  367_R2_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/376_R1_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/376_R1_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/376_R1_001.fastq.gz

Generating checksums for concatenated FastQs...
ed7f367e99fa14a79d9d76e7f6602504  376_R1_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/376_R2_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/376_R2_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/376_R2_001.fastq.gz

Generating checksums for concatenated FastQs...
b34a6b8a21c2d753c70c6f0ada622ae3  376_R2_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/460_R1_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/460_R1_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/460_R1_001.fastq.gz

Generating checksums for concatenated FastQs...
0b76ea694146524fb3d920d0ce893700  460_R1_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/460_R2_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/460_R2_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/460_R2_001.fastq.gz

Generating checksums for concatenated FastQs...
129fa23dd27e800eefdf9857cd486e04  460_R2_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/485_R1_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/485_R1_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/485_R1_001.fastq.gz

Generating checksums for concatenated FastQs...
8fb813628e19f16a2ebc38a3b25d86c9  485_R1_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/485_R2_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/485_R2_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/485_R2_001.fastq.gz

Generating checksums for concatenated FastQs...
778fd2901d89edb88bd3b3258794483c  485_R2_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/501_R1_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/501_R1_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/501_R1_001.fastq.gz

Generating checksums for concatenated FastQs...
661ecf50a08410be5f497191ccbcab53  501_R1_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/501_R2_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/501_R2_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/501_R2_001.fastq.gz

Generating checksums for concatenated FastQs...
25fce7fb0d38c82790021a67f6d7f7bf  501_R2_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/71_R1_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/71_R1_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/71_R1_001.fastq.gz

Generating checksums for concatenated FastQs...
91a62551b545b89180b8cf8bba7a9972  71_R1_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/71_R2_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/71_R2_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/71_R2_001.fastq.gz

Generating checksums for concatenated FastQs...
061d5ddab8b33f54564f8fde19ceb479  71_R2_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/88_R1_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/88_R1_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/88_R1_001.fastq.gz

Generating checksums for concatenated FastQs...
01f8e68f4993aa9fc4d6d56b29719afa  88_R1_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads
Concatenating /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055/88_R2_001.fastq.gz with /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads/30-1035633055-TS01/88_R2_001.fastq.gz to /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads/88_R2_001.fastq.gz

Generating checksums for concatenated FastQs...
2933ae02943ead5548223833cbeb41de  88_R2_001.fastq.gz

--------------------------------------------------------

/home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/data/raw_reads</code></pre>
</section>
<section id="fastqcmultiqc-on-raw-reads" class="level1">
<h1>5 FastQC/MultiQC on raw reads</h1>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb10-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb10-3"></span>
<span id="cb10-4"></span>
<span id="cb10-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN FASTQC ############</span></span>
<span id="cb10-6"></span>
<span id="cb10-7"></span>
<span id="cb10-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of trimmed FastQs</span></span>
<span id="cb10-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">raw_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(${output_dir_top}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_pattern})</span></span>
<span id="cb10-10"></span>
<span id="cb10-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pass array contents to new variable as space-delimited list</span></span>
<span id="cb10-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">raw_fastqc_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[*]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb10-13"></span>
<span id="cb10-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning FastQC on raw reads..."</span></span>
<span id="cb10-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb10-16"></span>
<span id="cb10-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run FastQC</span></span>
<span id="cb10-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Do NOT quote raw_fastqc_list</span></span>
<span id="cb10-19"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastqc}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-20">--threads <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-21">--outdir <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-22">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-23"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_list}</span></span>
<span id="cb10-24"></span>
<span id="cb10-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC on raw reads complete!"</span></span>
<span id="cb10-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb10-27"></span>
<span id="cb10-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> FASTQC ############</span></span>
<span id="cb10-29"></span>
<span id="cb10-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN MULTIQC ############</span></span>
<span id="cb10-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning MultiQC on raw FastQC..."</span></span>
<span id="cb10-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb10-33"></span>
<span id="cb10-34"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${multiqc}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span></span>
<span id="cb10-35"></span>
<span id="cb10-36"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb10-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MultiQC on raw FastQs complete."</span></span>
<span id="cb10-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb10-39"></span>
<span id="cb10-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> MULTIQC ############</span></span>
<span id="cb10-41"></span>
<span id="cb10-42"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Removing FastQC zip files."</span></span>
<span id="cb10-43"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb10-44"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.zip</span>
<span id="cb10-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC zip files removed."</span></span>
<span id="cb10-46"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span></code></pre></div>
<pre><code>Beginning FastQC on raw reads...

application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
FastQC on raw reads complete!

Beginning MultiQC on raw FastQC...


  /// MultiQC ðŸ” | v1.14

|           multiqc | MultiQC Version v1.25.2 now available!
|           multiqc | Search path : /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/project-clam-oa/output/00.00-fastqc-concatenation-raw_reads
|         searching | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 100% 160/160  
|            fastqc | Found 40 reports
|           multiqc | Compressing plot data
|           multiqc | Report      : ../output/00.00-fastqc-concatenation-raw_reads/multiqc_report.html
|           multiqc | Data        : ../output/00.00-fastqc-concatenation-raw_reads/multiqc_data
|           multiqc | MultiQC complete

MultiQC on raw FastQs complete.

Removing FastQC zip files.

FastQC zip files removed.</code></pre>
<section id="view-directory-contents" class="level2">
<h2 class="anchored" data-anchor-id="view-directory-contents">5.1 View directory contents</h2>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb12-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb12-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span></span></code></pre></div>
<pre><code>total 34G
-rw-r--r-- 1 sam sam  694K Dec  5 13:29 196_R1_001_fastqc.html
-rw-r--r-- 1 sam sam  1.1G Dec  5 13:22 196_R1_001.fastq.gz
-rw-r--r-- 1 sam sam    54 Dec  5 13:22 196_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  680K Dec  5 13:29 196_R2_001_fastqc.html
-rw-r--r-- 1 sam sam  740M Dec  5 13:22 196_R2_001.fastq.gz
-rw-r--r-- 1 sam sam    54 Dec  5 13:22 196_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  700K Dec  5 13:29 199_R1_001_fastqc.html
-rw-r--r-- 1 sam sam  859M Dec  5 13:22 199_R1_001.fastq.gz
-rw-r--r-- 1 sam sam    54 Dec  5 13:22 199_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  682K Dec  5 13:28 199_R2_001_fastqc.html
-rw-r--r-- 1 sam sam  575M Dec  5 13:22 199_R2_001.fastq.gz
-rw-r--r-- 1 sam sam    54 Dec  5 13:22 199_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  699K Dec  5 13:29 211_R1_001_fastqc.html
-rw-r--r-- 1 sam sam  927M Dec  5 13:22 211_R1_001.fastq.gz
-rw-r--r-- 1 sam sam    54 Dec  5 13:22 211_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  684K Dec  5 13:28 211_R2_001_fastqc.html
-rw-r--r-- 1 sam sam  607M Dec  5 13:22 211_R2_001.fastq.gz
-rw-r--r-- 1 sam sam    54 Dec  5 13:22 211_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  700K Dec  5 13:29 24_R1_001_fastqc.html
-rw-r--r-- 1 sam sam  900M Dec  5 13:22 24_R1_001.fastq.gz
-rw-r--r-- 1 sam sam    53 Dec  5 13:22 24_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  681K Dec  5 13:29 24_R2_001_fastqc.html
-rw-r--r-- 1 sam sam  643M Dec  5 13:22 24_R2_001.fastq.gz
-rw-r--r-- 1 sam sam    53 Dec  5 13:22 24_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  706K Dec  5 13:29 260_R1_001_fastqc.html
-rw-r--r-- 1 sam sam  956M Dec  5 13:22 260_R1_001.fastq.gz
-rw-r--r-- 1 sam sam    54 Dec  5 13:22 260_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  682K Dec  5 13:29 260_R2_001_fastqc.html
-rw-r--r-- 1 sam sam  653M Dec  5 13:22 260_R2_001.fastq.gz
-rw-r--r-- 1 sam sam    54 Dec  5 13:22 260_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  701K Dec  5 13:29 26_R1_001_fastqc.html
-rw-r--r-- 1 sam sam  944M Dec  5 13:22 26_R1_001.fastq.gz
-rw-r--r-- 1 sam sam    53 Dec  5 13:22 26_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  682K Dec  5 13:28 26_R2_001_fastqc.html
-rw-r--r-- 1 sam sam  607M Dec  5 13:22 26_R2_001.fastq.gz
-rw-r--r-- 1 sam sam    53 Dec  5 13:22 26_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  703K Dec  5 13:29 30_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 1000M Dec  5 13:22 30_R1_001.fastq.gz
-rw-r--r-- 1 sam sam    53 Dec  5 13:22 30_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  682K Dec  5 13:29 30_R2_001_fastqc.html
-rw-r--r-- 1 sam sam  677M Dec  5 13:22 30_R2_001.fastq.gz
-rw-r--r-- 1 sam sam    53 Dec  5 13:22 30_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  699K Dec  5 13:29 310_R1_001_fastqc.html
-rw-r--r-- 1 sam sam  943M Dec  5 13:22 310_R1_001.fastq.gz
-rw-r--r-- 1 sam sam    54 Dec  5 13:22 310_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  683K Dec  5 13:29 310_R2_001_fastqc.html
-rw-r--r-- 1 sam sam  663M Dec  5 13:22 310_R2_001.fastq.gz
-rw-r--r-- 1 sam sam    54 Dec  5 13:22 310_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  703K Dec  5 13:29 33_R1_001_fastqc.html
-rw-r--r-- 1 sam sam  955M Dec  5 13:22 33_R1_001.fastq.gz
-rw-r--r-- 1 sam sam    53 Dec  5 13:22 33_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  680K Dec  5 13:29 33_R2_001_fastqc.html
-rw-r--r-- 1 sam sam  672M Dec  5 13:22 33_R2_001.fastq.gz
-rw-r--r-- 1 sam sam    53 Dec  5 13:22 33_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  701K Dec  5 13:29 341_R1_001_fastqc.html
-rw-r--r-- 1 sam sam  993M Dec  5 13:22 341_R1_001.fastq.gz
-rw-r--r-- 1 sam sam    54 Dec  5 13:22 341_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  687K Dec  5 13:29 341_R2_001_fastqc.html
-rw-r--r-- 1 sam sam  665M Dec  5 13:22 341_R2_001.fastq.gz
-rw-r--r-- 1 sam sam    54 Dec  5 13:22 341_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  700K Dec  5 13:29 34_R1_001_fastqc.html
-rw-r--r-- 1 sam sam  1.1G Dec  5 13:22 34_R1_001.fastq.gz
-rw-r--r-- 1 sam sam    53 Dec  5 13:22 34_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  678K Dec  5 13:29 34_R2_001_fastqc.html
-rw-r--r-- 1 sam sam  769M Dec  5 13:22 34_R2_001.fastq.gz
-rw-r--r-- 1 sam sam    53 Dec  5 13:22 34_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  702K Dec  5 13:29 35_R1_001_fastqc.html
-rw-r--r-- 1 sam sam  914M Dec  5 13:22 35_R1_001.fastq.gz
-rw-r--r-- 1 sam sam    53 Dec  5 13:22 35_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  681K Dec  5 13:28 35_R2_001_fastqc.html
-rw-r--r-- 1 sam sam  596M Dec  5 13:22 35_R2_001.fastq.gz
-rw-r--r-- 1 sam sam    53 Dec  5 13:22 35_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  704K Dec  5 13:29 363_R1_001_fastqc.html
-rw-r--r-- 1 sam sam 1021M Dec  5 13:22 363_R1_001.fastq.gz
-rw-r--r-- 1 sam sam    54 Dec  5 13:22 363_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  682K Dec  5 13:29 363_R2_001_fastqc.html
-rw-r--r-- 1 sam sam  708M Dec  5 13:22 363_R2_001.fastq.gz
-rw-r--r-- 1 sam sam    54 Dec  5 13:23 363_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  699K Dec  5 13:29 367_R1_001_fastqc.html
-rw-r--r-- 1 sam sam  984M Dec  5 13:23 367_R1_001.fastq.gz
-rw-r--r-- 1 sam sam    54 Dec  5 13:23 367_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  682K Dec  5 13:29 367_R2_001_fastqc.html
-rw-r--r-- 1 sam sam  648M Dec  5 13:23 367_R2_001.fastq.gz
-rw-r--r-- 1 sam sam    54 Dec  5 13:23 367_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  701K Dec  5 13:30 376_R1_001_fastqc.html
-rw-r--r-- 1 sam sam  1.8G Dec  5 13:23 376_R1_001.fastq.gz
-rw-r--r-- 1 sam sam    54 Dec  5 13:23 376_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  683K Dec  5 13:30 376_R2_001_fastqc.html
-rw-r--r-- 1 sam sam  1.2G Dec  5 13:23 376_R2_001.fastq.gz
-rw-r--r-- 1 sam sam    54 Dec  5 13:23 376_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  697K Dec  5 13:29 460_R1_001_fastqc.html
-rw-r--r-- 1 sam sam  951M Dec  5 13:23 460_R1_001.fastq.gz
-rw-r--r-- 1 sam sam    54 Dec  5 13:23 460_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  683K Dec  5 13:29 460_R2_001_fastqc.html
-rw-r--r-- 1 sam sam  641M Dec  5 13:23 460_R2_001.fastq.gz
-rw-r--r-- 1 sam sam    54 Dec  5 13:23 460_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  701K Dec  5 13:29 485_R1_001_fastqc.html
-rw-r--r-- 1 sam sam  974M Dec  5 13:23 485_R1_001.fastq.gz
-rw-r--r-- 1 sam sam    54 Dec  5 13:23 485_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  683K Dec  5 13:29 485_R2_001_fastqc.html
-rw-r--r-- 1 sam sam  661M Dec  5 13:23 485_R2_001.fastq.gz
-rw-r--r-- 1 sam sam    54 Dec  5 13:23 485_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  702K Dec  5 13:29 501_R1_001_fastqc.html
-rw-r--r-- 1 sam sam  1.1G Dec  5 13:23 501_R1_001.fastq.gz
-rw-r--r-- 1 sam sam    54 Dec  5 13:23 501_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  680K Dec  5 13:29 501_R2_001_fastqc.html
-rw-r--r-- 1 sam sam  721M Dec  5 13:23 501_R2_001.fastq.gz
-rw-r--r-- 1 sam sam    54 Dec  5 13:23 501_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  693K Dec  5 13:29 71_R1_001_fastqc.html
-rw-r--r-- 1 sam sam  1.2G Dec  5 13:23 71_R1_001.fastq.gz
-rw-r--r-- 1 sam sam    53 Dec  5 13:23 71_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  671K Dec  5 13:29 71_R2_001_fastqc.html
-rw-r--r-- 1 sam sam  741M Dec  5 13:23 71_R2_001.fastq.gz
-rw-r--r-- 1 sam sam    53 Dec  5 13:23 71_R2_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  700K Dec  5 13:29 88_R1_001_fastqc.html
-rw-r--r-- 1 sam sam  1.1G Dec  5 13:23 88_R1_001.fastq.gz
-rw-r--r-- 1 sam sam    53 Dec  5 13:23 88_R1_001.fastq.gz.md5
-rw-r--r-- 1 sam sam  679K Dec  5 13:29 88_R2_001_fastqc.html
-rw-r--r-- 1 sam sam  772M Dec  5 13:23 88_R2_001.fastq.gz
-rw-r--r-- 1 sam sam    53 Dec  5 13:23 88_R2_001.fastq.gz.md5
drwxr-xr-x 2 sam sam  4.0K Dec  5 13:31 multiqc_data
-rw-r--r-- 1 sam sam  1.6M Dec  5 13:31 multiqc_report.html</code></pre>
</section>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<p>These are sRNA-seq reads, sequenced at a length of 150bp PE. Itâ€™s overkill, but this is how Azenta performs their sRNA-seq.</p>
<div id="fig-multiqc_adapter_content" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="MulitQC of adapter content showing (expected) excessive adapter content and polyG content.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-multiqc_adapter_content-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241205-rphi-project-clam-oafastqc_adapter_content_plot.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: MulitQC of adapter content showing (expected) excessive adapter content and polyG content."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-12-05-FastQ-Concatentation-and-QC---R.philippinarum-sRNA-seq-Data-Using-FastQC-and-MultiQC/20241205-rphi-project-clam-oafastqc_adapter_content_plot.png" class="img-fluid figure-img" alt="MulitQC of adapter content showing (expected) excessive adapter content and polyG content."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-multiqc_adapter_content-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: MulitQC of adapter content showing (expected) excessive adapter content and polyG content.
</figcaption>
</figure>
</div>
<p>Knowing that, itâ€™s unsurprising that the FastQC plots donâ€™t look great, as read lengths are 150bp, but the fragement lengths used for library construction are likely ~50bp. This results in poor sequence quality for the majority of the read length, as well as excessive adapter content and polyG content. This issues will be addressed downstream during trimming.</p>
</section>
<section id="citations" class="level1">
<h1>CITATIONS</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ewels2016" class="csl-entry">
Ewels, Philip, MÃ¥ns Magnusson, Sverker Lundin, and Max KÃ¤ller. 2016. â€œMultiQC: Summarize Analysis Results for Multiple Tools and Samples in a Single Report.â€ <em>Bioinformatics</em> 32 (19): 3047â€“48. <a href="https://doi.org/10.1093/bioinformatics/btw354" class="uri">https://doi.org/10.1093/bioinformatics/btw354</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2024</category>
  <category>Manila clam</category>
  <category>Ruditapes philippinarum</category>
  <category>30-1035633055</category>
  <category>30-1035633055-TS01</category>
  <category>project-clam-oa</category>
  <category>FastQC</category>
  <category>MultiQC</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-12-05-FastQ-Concatentation-and-QC---R.philippinarum-sRNA-seq-Data-Using-FastQC-and-MultiQC/</guid>
  <pubDate>Thu, 05 Dec 2024 08:00:00 GMT</pubDate>
  <media:content url="https://robertslab.github.io/sams-notebook/posts/2024/2024-12-05-FastQ-Concatentation-and-QC---R.philippinarum-sRNA-seq-Data-Using-FastQC-and-MultiQC/20241205-rphi-project-clam-oafastqc_adapter_content_plot.png" medium="image" type="image/png" height="96" width="144"/>
</item>
<item>
  <title>Methylation Extraction - C.virginica CEASMALLR WGBS Using Bismark</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-26-Methylation-Extraction---C.virginica-CEASMALLR-WGBS-Using-Bismark/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>This notebook is part of the <a href="https://github.com/sr320/ceasmallr">ceasmallr</a> (GitHub repo) project, comparing DNA methylation in <a href="https://en.wikipedia.org/wiki/Eastern_oyster"><em>Crassostrea virginica</em> (Eastern oyster)</a> larvae and zygotes, via whole-genome bisulfite sequencing (WGBS).</p>
<p>Deduplication was <a href="../../../posts/2024/2024-11-25-Deduplication---C.virginica-CEASMALLR-WGBS-Using-Bismark/index.html">previously performed on 20241125</a> and now needed to <a href="https://felixkrueger.github.io/Bismark/">Bismark methylation extraction</a> (Bismark GitHub).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This notebook was copied from knitted markdown from <a href="https://github.com/sr320/ceasmallr/blob/92cf9be13679dce017df317673a597004690ddfa/code/02.20-bismark-methylation-extraction.Rmd"><code>02.20-bismark-methylation-extraction.Rmd</code></a> (commit <code>92cf9be</code>).</p>
</div>
</div>
</section>
<section id="description" class="level1">
<h1>1 DESCRIPTION</h1>
<p>This notebook is a continuation of using <a href="https://felixkrueger.github.io/Bismark/">Bismark</a> (Krueger and Andrews 2011) to perform methylation analysis. This step will perform methylation extraction.</p>
<p>Results will be summarized by <a href="https://github.com/MultiQC/MultiQC">MultiQC</a> (Ewels et al.&nbsp;2016).</p>
<section id="inputs" class="level2">
<h2 class="anchored" data-anchor-id="inputs">1.1 Inputs</h2>
<p>This notebook relies on deduplicated BAMs generated by <a href="./02.10-bismark-deduplication.Rmd"><code>02.10-bismark-deduplication.Rmd</code></a>.</p>
</section>
<section id="outputs" class="level2">
<h2 class="anchored" data-anchor-id="outputs">1.2 Outputs</h2>
<ul>
<li><p><code>*.CpG_report.merged_CpG_evidence.cov.gz</code>: CpG position and counts merged from all strands. Generated by <code>coverage2cytosine</code>.</p></li>
<li><p><code>*.deduplicated.bedGraph.gz</code>: Bedgraph file with CpG loci and percent methylation.</p></li>
<li><p><code>*.deduplicated.bedGraph.gz.bismark.zero.cov</code>: Extension of <code>*deduplicated.bedGraph.gz</code> which includes two additional columns, count methylated and count unmethylated, in that order.</p></li>
<li><p><code>*.deduplicated.bismark.cov.gz</code>: 1-based counting version of <code>*.deduplicated.bedGraph.gz.bismark.zero.cov</code>. E.g. loci are at 49 49, instead of 48 49.</p></li>
<li><p><code>*.deduplicated.CpG_report.txt.gz</code>: Report on all CpGs. <code>&lt;chromosome&gt; &lt;0-based start&gt; &lt;methylation status, +/-&gt; &lt;count_methyldated&gt; &lt;CG&gt; &lt;trinucleotide_context&gt;</code></p></li>
<li><p><code>*.deduplicated.cytosine_context_summary.txt</code>: Cytosine context summary. See file headers for info.</p></li>
<li><p><code>*.deduplicated.M-bias.txt</code>: Methylation bias table. See file headers for info.</p></li>
<li><p><code>*.deduplicated_splitting_report.txt</code>: Summary methylation report in a human-readable format.</p></li>
<li><p><code>CH*.deduplicated.txt.gz</code>: Strand-specific methylation status for each read in <code>CHH</code> or <code>CHG</code> context.</p></li>
<li><p><code>CpG*.deduplicated.txt.gz</code>: Strand-specific methylation status for each read in <code>CpG</code> context.</p></li>
<li><p><code>multiqc_report.html</code>: A summary report of the alignment results generated by <a href="https://github.com/MultiQC/MultiQC">MultiQC</a>, in HTML format.</p></li>
</ul>
<p>Due to the large file sizes of most of the output files, these cannot be hosted in the <a href="https://github.com/sr320/ceasmallr">ceasmallr GitHub repo</a>. As such these files are available for download here:</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/gitrepos/ceasmallr/output/02.20-bismark-methylation-extraction/" class="uri">https://gannet.fish.washington.edu/gitrepos/ceasmallr/output/02.20-bismark-methylation-extraction/</a></li>
</ul>
</section>
</section>
<section id="create-a-bash-variables-file" class="level1">
<h1>2 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export repo_dir=/home/shared/8TB_HDD_01/sam/gitrepos/ceasmallr'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export output_dir_top=${repo_dir}/output/02.20-bismark-methylation-extraction'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export deduplication_dir="${repo_dir}/output/02.10-bismark-deduplication"'</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export genome_dir="${repo_dir}/data/Cvirginica_v300/"'</span></span>
<span id="cb1-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-11"></span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Paths to programs"</span></span>
<span id="cb1-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export programs_dir="/home/shared"'</span></span>
<span id="cb1-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export bismark_dir="${programs_dir}/Bismark-0.24.0"'</span></span>
<span id="cb1-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export bowtie2_dir="${programs_dir}/bowtie2-2.4.4-linux-x86_64"'</span></span>
<span id="cb1-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export multiqc="/home/sam/programs/mambaforge/bin/multiqc"'</span></span>
<span id="cb1-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export samtools_dir="${programs_dir}/samtools-1.12"'</span></span>
<span id="cb1-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-20"></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set number of CPUs to use"</span></span>
<span id="cb1-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=40'</span></span>
<span id="cb1-23"></span>
<span id="cb1-24"></span>
<span id="cb1-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Print formatting"</span></span>
<span id="cb1-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-28"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-29"></span>
<span id="cb1-30"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export repo_dir=/home/shared/8TB_HDD_01/sam/gitrepos/ceasmallr
export output_dir_top=${repo_dir}/output/02.20-bismark-methylation-extraction
export deduplication_dir="${repo_dir}/output/02.10-bismark-deduplication"
export genome_dir="${repo_dir}/data/Cvirginica_v300/"

# Paths to programs
export programs_dir="/home/shared"
export bismark_dir="${programs_dir}/Bismark-0.24.0"
export bowtie2_dir="${programs_dir}/bowtie2-2.4.4-linux-x86_64"
export multiqc="/home/sam/programs/mambaforge/bin/multiqc"
export samtools_dir="${programs_dir}/samtools-1.12"

# Set number of CPUs to use
export threads=40
# Print formatting
export line="--------------------------------------------------------"</code></pre>
</section>
<section id="methylation-extraction" class="level1">
<h1>3 Methylation Extraction</h1>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${deduplication_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-5"></span>
<span id="cb3-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bismark_dir}</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/bismark_methylation_extractor</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-7">--bedGraph <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-8">--counts <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-9">--scaffolds <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-10">--parallel 10 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-11">--output_dir <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-12">--samtools_path <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samtools_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-13">--gzip <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-14">--paired-end <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-15">--comprehensive <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-16">--merge_non_CpG <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-17">--zero_based <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-18">--buffer_size 75% <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-19">--cytosine_report <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-20">--genome_folder <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-21"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>deduplicated.bam</span></code></pre></div>
</section>
<section id="cytosine-coverage" class="level1">
<h1>4 Cytosine coverage</h1>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb4-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb4-5"></span>
<span id="cb4-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>deduplicated.bismark.cov.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> _bismark_bt2_pe.deduplicated.bismark.cov.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-8"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I{}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bismark_dir}</span>/coverage2cytosine <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-9">--genome_folder <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-10">-o {} <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-11">--merge_CpG <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-12">--zero_based <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-13">--gzip <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-14">{}_bismark_bt2_pe.deduplicated.bismark.cov.gz</span></code></pre></div>
</section>
<section id="peek-at-output-files" class="level1">
<h1>5 Peek at output files</h1>
<p>Glance at output file formats, using CF01-CM01-Zygote files as example.</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-5"></span>
<span id="cb5-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>CF01-CM01-Zygote<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-7">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-f</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb5-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.gz <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb5-9">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;===== </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> ====&gt;"</span></span>
<span id="cb5-10">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-11">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">zcat</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">column</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">$'</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb5-12">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-13">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-14">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-15">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb5-16">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;===== </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> ====&gt;"</span></span>
<span id="cb5-17">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-18">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-19">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">column</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">$'</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb5-20">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-21">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-22">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-23">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb5-24">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb5-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<pre><code>&lt;===== CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.bedGraph.gz ====&gt;

track type=bedGraph
NC_007175.2          48   49   2.08333333333333
NC_007175.2          49   50   0
NC_007175.2          50   51   1.92307692307692
NC_007175.2          51   52   0
NC_007175.2          87   88   0
NC_007175.2          88   89   0
NC_007175.2          146  147  0
NC_007175.2          147  148  1.75438596491228
NC_007175.2          148  149  0

--------------------------------------------------------

&lt;===== CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov ====&gt;

CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
NC_007175.2  48   49   2.08333333333333  1  47
NC_007175.2  49   50   0                 0  2
NC_007175.2  50   51   1.92307692307692  1  51
NC_007175.2  51   52   0                 0  1
NC_007175.2  87   88   0                 0  104
NC_007175.2  88   89   0                 0  33
NC_007175.2  146  147  0                 0  116
NC_007175.2  147  148  1.75438596491228  1  56
NC_007175.2  148  149  0                 0  1
NC_007175.2  192  193  0                 0  51

--------------------------------------------------------

&lt;===== CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.bismark.cov.gz ====&gt;

NC_007175.2  49   49   2.08333333333333  1  47
NC_007175.2  50   50   0                 0  2
NC_007175.2  51   51   1.92307692307692  1  51
NC_007175.2  52   52   0                 0  1
NC_007175.2  88   88   0                 0  104
NC_007175.2  89   89   0                 0  33
NC_007175.2  147  147  0                 0  116
NC_007175.2  148  148  1.75438596491228  1  56
NC_007175.2  149  149  0                 0  1
NC_007175.2  193  193  0                 0  51

--------------------------------------------------------

&lt;===== CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.CpG_report.txt.gz ====&gt;

NC_007175.2  48   +  1  47   CG  CGC
NC_007175.2  49   -  0  2    CG  CGA
NC_007175.2  50   +  1  51   CG  CGG
NC_007175.2  51   -  0  1    CG  CGC
NC_007175.2  87   +  0  104  CG  CGT
NC_007175.2  88   -  0  33   CG  CGT
NC_007175.2  146  +  0  116  CG  CGG
NC_007175.2  147  -  1  56   CG  CGA
NC_007175.2  192  +  0  51   CG  CGC
NC_007175.2  193  -  0  39   CG  CGA

--------------------------------------------------------

&lt;===== CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt ====&gt;

CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
upstream  C-context  full context  count methylated  count unmethylated  percent methylation
A         CAA        ACAA          66                446                 12.89
C         CAA        CCAA          66                479                 12.11
G         CAA        GCAA          19                198                 8.76
T         CAA        TCAA          59                526                 10.09
A         CAC        ACAC          16                118                 11.94
C         CAC        CCAC          7                 69                  9.21
G         CAC        GCAC          9                 38                  19.15
T         CAC        TCAC          15                120                 11.11
A         CAG        ACAG          142               1235                10.31

--------------------------------------------------------

&lt;===== CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.M-bias.txt ====&gt;

CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.M-bias.txt
CpG context (R1)
================
position          count methylated  count unmethylated  % methylation  coverage
1                 9383              45046               17.24          54429
2                 9270              45432               16.95          54702
3                 9184              45622               16.76          54806
4                 9457              45750               17.13          55207
5                 10083             48122               17.32          58205
6                 10548             48157               17.97          58705
7                 10617             48528               17.95          59145

--------------------------------------------------------

&lt;===== CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated_splitting_report.txt ====&gt;

CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated_splitting_report.txt
CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.bam
Parameters used to extract methylation information:
Bismark Extractor Version: v0.24.0
Bismark result file: paired-end (SAM format)
Output specified: comprehensive
No overlapping methylation calls specified
Methylation in CHG and CHH context will be merged into "non-CpG context" output

--------------------------------------------------------

&lt;===== CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED.CpG_report.merged_CpG_evidence.cov.gz ====&gt;

NC_007175.2  48   50   2.000000  1  49
NC_007175.2  50   52   1.886792  1  52
NC_007175.2  87   89   0.000000  0  137
NC_007175.2  146  148  0.578035  1  172
NC_007175.2  192  194  0.000000  0  90
NC_007175.2  245  247  2.898551  2  67
NC_007175.2  256  258  4.166667  5  115
NC_007175.2  263  265  0.000000  0  155
NC_007175.2  265  267  1.142857  2  173
NC_007175.2  331  333  0.546448  1  182

--------------------------------------------------------

&lt;===== CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED.CpG_report.txt.gz ====&gt;

NC_007175.2  48   +  1  47   CG  CGC
NC_007175.2  49   -  0  2    CG  CGA
NC_007175.2  50   +  1  51   CG  CGG
NC_007175.2  51   -  0  1    CG  CGC
NC_007175.2  87   +  0  104  CG  CGT
NC_007175.2  88   -  0  33   CG  CGT
NC_007175.2  146  +  0  116  CG  CGG
NC_007175.2  147  -  1  56   CG  CGA
NC_007175.2  192  +  0  51   CG  CGC
NC_007175.2  193  -  0  39   CG  CGA

--------------------------------------------------------

&lt;===== CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED.cytosine_context_summary.txt ====&gt;

CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED.cytosine_context_summary.txt
upstream  C-context  full context  count methylated  count unmethylated  percent methylation
A         CAA        ACAA          66                446                 12.89
C         CAA        CCAA          66                479                 12.11
G         CAA        GCAA          19                198                 8.76
T         CAA        TCAA          59                526                 10.09
A         CAC        ACAC          16                118                 11.94
C         CAC        CCAC          7                 69                  9.21
G         CAC        GCAC          9                 38                  19.15
T         CAC        TCAC          15                120                 11.11
A         CAG        ACAG          142               1235                10.31

--------------------------------------------------------

&lt;===== CpG_context_CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.txt.gz ====&gt;

Bismark methylation extractor version v0.24.0
GWNJ-1012:512:GW210315000:4:1101:21884:1094_1:N:0:TTATAACC+TCGATATC  -  NC_035785.1  24407680  z
GWNJ-1012:512:GW210315000:4:1101:11776:1219_1:N:0:TTATAACC+TCGATATC  -  NC_035780.1  32653438  z
GWNJ-1012:512:GW210315000:4:1101:20699:1141_1:N:0:TTATAACC+TCGATATC  -  NC_035788.1  57095043  z
GWNJ-1012:512:GW210315000:4:1101:20699:1141_1:N:0:TTATAACC+TCGATATC  -  NC_035788.1  57095087  z
GWNJ-1012:512:GW210315000:4:1101:20699:1141_1:N:0:TTATAACC+TCGATATC  -  NC_035788.1  57095119  z
GWNJ-1012:512:GW210315000:4:1101:20699:1141_1:N:0:TTATAACC+TCGATATC  -  NC_035788.1  57095138  z
GWNJ-1012:512:GW210315000:4:1101:9372:1595_1:N:0:TTATAACC+TCGATATC   +  NC_035781.1  2018694   Z
GWNJ-1012:512:GW210315000:4:1101:15402:1642_1:N:0:TTATAACC+TCGATATC  +  NC_035783.1  49860452  Z
GWNJ-1012:512:GW210315000:4:1101:9372:1595_1:N:0:TTATAACC+TCGATATC   +  NC_035781.1  2018682   Z

--------------------------------------------------------

&lt;===== Non_CpG_context_CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.txt.gz ====&gt;

Bismark methylation extractor version v0.24.0
GWNJ-1012:512:GW210315000:4:1101:11776:1219_1:N:0:TTATAACC+TCGATATC  -  NC_035780.1  32653467  x
GWNJ-1012:512:GW210315000:4:1101:11776:1219_1:N:0:TTATAACC+TCGATATC  -  NC_035780.1  32653466  h
GWNJ-1012:512:GW210315000:4:1101:11776:1219_1:N:0:TTATAACC+TCGATATC  -  NC_035780.1  32653465  h
GWNJ-1012:512:GW210315000:4:1101:11776:1219_1:N:0:TTATAACC+TCGATATC  -  NC_035780.1  32653464  h
GWNJ-1012:512:GW210315000:4:1101:11776:1219_1:N:0:TTATAACC+TCGATATC  -  NC_035780.1  32653461  x
GWNJ-1012:512:GW210315000:4:1101:11776:1219_1:N:0:TTATAACC+TCGATATC  -  NC_035780.1  32653455  h
GWNJ-1012:512:GW210315000:4:1101:11776:1219_1:N:0:TTATAACC+TCGATATC  -  NC_035780.1  32653454  h
GWNJ-1012:512:GW210315000:4:1101:11776:1219_1:N:0:TTATAACC+TCGATATC  -  NC_035780.1  32653450  h
GWNJ-1012:512:GW210315000:4:1101:20699:1141_1:N:0:TTATAACC+TCGATATC  +  NC_035788.1  57095003  X

--------------------------------------------------------</code></pre>
</section>
<section id="list-all-outputs" class="level1">
<h1>6 List all outputs</h1>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb7-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-5"></span>
<span id="cb7-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span></span></code></pre></div>
<pre><code>total 93G
-rw-r--r-- 1 sam sam  21M Nov 26 11:17 CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 124M Nov 26 11:17 CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  18M Nov 26 11:17 CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 107M Nov 26 11:27 CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.7K Dec  4 12:17 CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  20K Dec  4 12:17 CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  926 Dec  4 12:17 CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  21M Dec  4 12:17 CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 107M Nov 27 07:59 CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.7K Dec  4 12:17 CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  90M Nov 26 11:43 CF01-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 551M Nov 26 11:43 CF01-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  89M Nov 26 11:43 CF01-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 126M Nov 26 11:54 CF01-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 CF01-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  23K Dec  4 12:17 CF01-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  928 Dec  4 12:17 CF01-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  72M Dec  4 12:17 CF01-CM02-Larvae_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 126M Nov 27 08:11 CF01-CM02-Larvae_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 CF01-CM02-Larvae_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  44M Nov 26 12:00 CF02-CM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 263M Nov 26 12:00 CF02-CM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  41M Nov 26 12:00 CF02-CM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 113M Nov 26 12:12 CF02-CM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 CF02-CM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  21K Dec  4 12:17 CF02-CM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  926 Dec  4 12:17 CF02-CM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  41M Dec  4 12:17 CF02-CM02-Zygote_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 113M Nov 27 08:22 CF02-CM02-Zygote_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 CF02-CM02-Zygote_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  65M Nov 26 12:20 CF03-CM03-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 395M Nov 26 12:20 CF03-CM03-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  61M Nov 26 12:20 CF03-CM03-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 118M Nov 26 12:32 CF03-CM03-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 CF03-CM03-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  22K Dec  4 12:17 CF03-CM03-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  925 Dec  4 12:17 CF03-CM03-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  57M Dec  4 12:17 CF03-CM03-Zygote_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 118M Nov 27 08:33 CF03-CM03-Zygote_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 CF03-CM03-Zygote_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  85M Nov 26 12:45 CF03-CM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 528M Nov 26 12:45 CF03-CM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  83M Nov 26 12:45 CF03-CM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 123M Nov 26 12:57 CF03-CM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 CF03-CM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  23K Dec  4 12:17 CF03-CM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  927 Dec  4 12:17 CF03-CM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  69M Dec  4 12:17 CF03-CM04-Larvae_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 123M Nov 27 08:45 CF03-CM04-Larvae_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 CF03-CM04-Larvae_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  90M Nov 26 13:12 CF03-CM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 551M Nov 26 13:12 CF03-CM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  88M Nov 26 13:12 CF03-CM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 125M Nov 26 13:23 CF03-CM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 CF03-CM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  23K Dec  4 12:17 CF03-CM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  928 Dec  4 12:17 CF03-CM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  71M Dec  4 12:17 CF03-CM05-Larvae_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 125M Nov 27 08:57 CF03-CM05-Larvae_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 CF03-CM05-Larvae_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  74M Nov 26 13:33 CF04-CM04-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 458M Nov 26 13:33 CF04-CM04-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  71M Nov 26 13:33 CF04-CM04-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 120M Nov 26 13:44 CF04-CM04-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 CF04-CM04-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  22K Dec  4 12:17 CF04-CM04-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  925 Dec  4 12:17 CF04-CM04-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  62M Dec  4 12:17 CF04-CM04-Zygote_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 120M Nov 27 09:09 CF04-CM04-Zygote_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 CF04-CM04-Zygote_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  97M Nov 26 14:05 CF05-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 599M Nov 26 14:05 CF05-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  98M Nov 26 14:05 CF05-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 128M Nov 26 14:16 CF05-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 CF05-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  23K Dec  4 12:17 CF05-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  928 Dec  4 12:17 CF05-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  78M Dec  4 12:17 CF05-CM02-Larvae_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 128M Nov 27 09:20 CF05-CM02-Larvae_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 CF05-CM02-Larvae_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  82M Nov 26 14:28 CF05-CM05-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 506M Nov 26 14:28 CF05-CM05-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  80M Nov 26 14:28 CF05-CM05-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 122M Nov 26 14:39 CF05-CM05-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 CF05-CM05-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  23K Dec  4 12:17 CF05-CM05-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  927 Dec  4 12:17 CF05-CM05-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  67M Dec  4 12:17 CF05-CM05-Zygote_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 122M Nov 27 09:32 CF05-CM05-Zygote_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 CF05-CM05-Zygote_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  74M Nov 26 14:50 CF06-CM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 452M Nov 26 14:50 CF06-CM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  70M Nov 26 14:50 CF06-CM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 120M Nov 26 15:01 CF06-CM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 CF06-CM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  22K Dec  4 12:17 CF06-CM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  926 Dec  4 12:17 CF06-CM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  63M Dec  4 12:17 CF06-CM01-Zygote_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 120M Nov 27 09:44 CF06-CM01-Zygote_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 CF06-CM01-Zygote_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  73M Nov 26 15:09 CF06-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 444M Nov 26 15:09 CF06-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  68M Nov 26 15:09 CF06-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 119M Nov 26 15:20 CF06-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 CF06-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  23K Dec  4 12:17 CF06-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  926 Dec  4 12:17 CF06-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  62M Dec  4 12:17 CF06-CM02-Larvae_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 119M Nov 27 09:56 CF06-CM02-Larvae_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 CF06-CM02-Larvae_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  62M Nov 26 15:27 CF07-CM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 383M Nov 26 15:27 CF07-CM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  57M Nov 26 15:27 CF07-CM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 116M Nov 26 15:38 CF07-CM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 CF07-CM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  22K Dec  4 12:17 CF07-CM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  924 Dec  4 12:17 CF07-CM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  54M Dec  4 12:17 CF07-CM02-Zygote_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 116M Nov 27 10:07 CF07-CM02-Zygote_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 CF07-CM02-Zygote_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  48M Nov 26 15:44 CF08-CM03-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 287M Nov 26 15:44 CF08-CM03-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  44M Nov 26 15:44 CF08-CM03-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 114M Nov 26 15:55 CF08-CM03-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 CF08-CM03-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  22K Dec  4 12:17 CF08-CM03-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  925 Dec  4 12:17 CF08-CM03-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  44M Dec  4 12:17 CF08-CM03-Zygote_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 114M Nov 27 10:18 CF08-CM03-Zygote_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 CF08-CM03-Zygote_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam 3.8M Nov 26 15:55 CF08-CM04-Larvae_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam  22M Nov 26 15:55 CF08-CM04-Larvae_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam 3.0M Nov 26 15:55 CF08-CM04-Larvae_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 103M Nov 26 16:05 CF08-CM04-Larvae_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.6K Dec  4 12:17 CF08-CM04-Larvae_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  19K Dec  4 12:17 CF08-CM04-Larvae_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  919 Dec  4 12:17 CF08-CM04-Larvae_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam 3.8M Dec  4 12:17 CF08-CM04-Larvae_R1_001.fastp-trim.REPAIRED.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 103M Nov 27 10:28 CF08-CM04-Larvae_R1_001.fastp-trim.REPAIRED.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.6K Dec  4 12:17 CF08-CM04-Larvae_R1_001.fastp-trim.REPAIRED.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam 3.7M Nov 26 16:05 CF08-CM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam  22M Nov 26 16:05 CF08-CM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam 3.0M Nov 26 16:05 CF08-CM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 103M Nov 26 16:15 CF08-CM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.6K Dec  4 12:17 CF08-CM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  19K Dec  4 12:17 CF08-CM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  910 Dec  4 12:17 CF08-CM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam 3.8M Dec  4 12:17 CF08-CM05-Larvae_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 103M Nov 27 10:38 CF08-CM05-Larvae_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.6K Dec  4 12:17 CF08-CM05-Larvae_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  43K Dec  4 12:17 checksums.md5
-rw-r--r-- 1 sam sam  45M Nov 26 11:16 CpG_context_CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 725M Nov 26 11:37 CpG_context_CF01-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 191M Nov 26 11:59 CpG_context_CF02-CM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 323M Nov 26 12:18 CpG_context_CF03-CM03-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 557M Nov 26 12:41 CpG_context_CF03-CM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 664M Nov 26 13:07 CpG_context_CF03-CM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 387M Nov 26 13:30 CpG_context_CF04-CM04-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 943M Nov 26 13:58 CpG_context_CF05-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 496M Nov 26 14:25 CpG_context_CF05-CM05-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 390M Nov 26 14:47 CpG_context_CF06-CM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 344M Nov 26 15:07 CpG_context_CF06-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 240M Nov 26 15:25 CpG_context_CF07-CM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 215M Nov 26 15:42 CpG_context_CF08-CM03-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 5.7M Nov 26 15:55 CpG_context_CF08-CM04-Larvae_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 5.8M Nov 26 16:05 CpG_context_CF08-CM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 368M Nov 26 16:21 CpG_context_EF01-EM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 427M Nov 26 16:42 CpG_context_EF02-EM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 211M Nov 26 17:01 CpG_context_EF03-EM03-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 607M Nov 26 17:23 CpG_context_EF03-EM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 625M Nov 26 17:49 CpG_context_EF03-EM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 123M Nov 26 18:08 CpG_context_EF04-EM04-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 857M Nov 26 18:32 CpG_context_EF04-EM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 514M Nov 26 18:58 CpG_context_EF05-EM01-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam  68M Nov 26 19:14 CpG_context_EF05-EM05-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 838M Nov 26 19:39 CpG_context_EF05-EM06-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 832M Nov 26 20:10 CpG_context_EF06-EM01-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 638M Nov 26 20:38 CpG_context_EF06-EM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 128M Nov 26 20:57 CpG_context_EF06-EM06-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 151M Nov 26 21:12 CpG_context_EF07-EM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 617M Nov 26 21:33 CpG_context_EF07-EM03-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 735M Nov 26 22:01 CpG_context_EF08-EM03-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 597M Nov 26 22:27 CpG_context_EF08-EM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam  75M Nov 26 16:24 EF01-EM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 455M Nov 26 16:24 EF01-EM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  70M Nov 26 16:24 EF01-EM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 120M Nov 26 16:35 EF01-EM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF01-EM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  23K Dec  4 12:17 EF01-EM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  927 Dec  4 12:17 EF01-EM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  63M Dec  4 12:17 EF01-EM01-Zygote_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 120M Nov 27 10:49 EF01-EM01-Zygote_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF01-EM01-Zygote_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  75M Nov 26 16:45 EF02-EM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 463M Nov 26 16:45 EF02-EM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  72M Nov 26 16:45 EF02-EM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 120M Nov 26 16:56 EF02-EM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF02-EM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  22K Dec  4 12:17 EF02-EM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  925 Dec  4 12:17 EF02-EM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  62M Dec  4 12:17 EF02-EM02-Zygote_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 120M Nov 27 11:01 EF02-EM02-Zygote_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF02-EM02-Zygote_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  54M Nov 26 17:02 EF03-EM03-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 327M Nov 26 17:02 EF03-EM03-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  50M Nov 26 17:02 EF03-EM03-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 115M Nov 26 17:13 EF03-EM03-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF03-EM03-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  22K Dec  4 12:17 EF03-EM03-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  934 Dec  4 12:17 EF03-EM03-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  49M Dec  4 12:17 EF03-EM03-Zygote_R1_001.fastp-trim.REPAIRED.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 115M Nov 27 11:12 EF03-EM03-Zygote_R1_001.fastp-trim.REPAIRED.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF03-EM03-Zygote_R1_001.fastp-trim.REPAIRED.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  94M Nov 26 17:28 EF03-EM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 575M Nov 26 17:28 EF03-EM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  91M Nov 26 17:28 EF03-EM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 125M Nov 26 17:39 EF03-EM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF03-EM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  23K Dec  4 12:17 EF03-EM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  928 Dec  4 12:17 EF03-EM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  73M Dec  4 12:17 EF03-EM04-Larvae_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 125M Nov 27 11:24 EF03-EM04-Larvae_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF03-EM04-Larvae_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  93M Nov 26 17:54 EF03-EM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 572M Nov 26 17:54 EF03-EM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  91M Nov 26 17:54 EF03-EM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 125M Nov 26 18:06 EF03-EM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF03-EM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  23K Dec  4 12:17 EF03-EM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  928 Dec  4 12:17 EF03-EM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  73M Dec  4 12:17 EF03-EM05-Larvae_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 125M Nov 27 11:36 EF03-EM05-Larvae_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF03-EM05-Larvae_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  41M Nov 26 18:09 EF04-EM04-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 249M Nov 26 18:09 EF04-EM04-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  37M Nov 26 18:09 EF04-EM04-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 111M Nov 26 18:20 EF04-EM04-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF04-EM04-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  20K Dec  4 12:17 EF04-EM04-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  921 Dec  4 12:17 EF04-EM04-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  38M Dec  4 12:17 EF04-EM04-Zygote_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 111M Nov 27 11:47 EF04-EM04-Zygote_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF04-EM04-Zygote_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  97M Nov 26 18:39 EF04-EM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 597M Nov 26 18:39 EF04-EM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  97M Nov 26 18:39 EF04-EM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 127M Nov 26 18:50 EF04-EM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF04-EM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  23K Dec  4 12:17 EF04-EM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  927 Dec  4 12:17 EF04-EM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  77M Dec  4 12:17 EF04-EM05-Larvae_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 127M Nov 27 11:59 EF04-EM05-Larvae_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF04-EM05-Larvae_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  81M Nov 26 19:02 EF05-EM01-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 498M Nov 26 19:02 EF05-EM01-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  78M Nov 26 19:02 EF05-EM01-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 122M Nov 26 19:13 EF05-EM01-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF05-EM01-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  23K Dec  4 12:17 EF05-EM01-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  926 Dec  4 12:17 EF05-EM01-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  66M Dec  4 12:17 EF05-EM01-Larvae_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 122M Nov 27 12:11 EF05-EM01-Larvae_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF05-EM01-Larvae_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  27M Nov 26 19:15 EF05-EM05-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 162M Nov 26 19:15 EF05-EM05-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  23M Nov 26 19:15 EF05-EM05-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 108M Nov 26 19:25 EF05-EM05-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.7K Dec  4 12:17 EF05-EM05-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  19K Dec  4 12:17 EF05-EM05-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  918 Dec  4 12:17 EF05-EM05-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  26M Dec  4 12:17 EF05-EM05-Zygote_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 108M Nov 27 12:22 EF05-EM05-Zygote_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.7K Dec  4 12:17 EF05-EM05-Zygote_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam 110M Nov 26 19:46 EF05-EM06-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 684M Nov 26 19:46 EF05-EM06-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam 108M Nov 26 19:46 EF05-EM06-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 129M Nov 26 19:58 EF05-EM06-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF05-EM06-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  24K Dec  4 12:17 EF05-EM06-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  928 Dec  4 12:17 EF05-EM06-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  83M Dec  4 12:17 EF05-EM06-Larvae_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 129M Nov 27 12:34 EF05-EM06-Larvae_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF05-EM06-Larvae_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam 101M Nov 26 20:17 EF06-EM01-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 627M Nov 26 20:17 EF06-EM01-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam 101M Nov 26 20:17 EF06-EM01-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 127M Nov 26 20:28 EF06-EM01-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF06-EM01-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  24K Dec  4 12:17 EF06-EM01-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  928 Dec  4 12:17 EF06-EM01-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  79M Dec  4 12:17 EF06-EM01-Larvae_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 127M Nov 27 12:46 EF06-EM01-Larvae_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF06-EM01-Larvae_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  88M Nov 26 20:43 EF06-EM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 541M Nov 26 20:43 EF06-EM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  86M Nov 26 20:43 EF06-EM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 125M Nov 26 20:55 EF06-EM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF06-EM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  23K Dec  4 12:17 EF06-EM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  928 Dec  4 12:17 EF06-EM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  71M Dec  4 12:17 EF06-EM02-Larvae_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 125M Nov 27 12:58 EF06-EM02-Larvae_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF06-EM02-Larvae_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  45M Nov 26 20:58 EF06-EM06-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 274M Nov 26 20:58 EF06-EM06-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  40M Nov 26 20:58 EF06-EM06-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 112M Nov 26 21:09 EF06-EM06-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.7K Dec  4 12:17 EF06-EM06-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  21K Dec  4 12:17 EF06-EM06-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  922 Dec  4 12:17 EF06-EM06-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  42M Dec  4 12:17 EF06-EM06-Larvae_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 112M Nov 27 13:09 EF06-EM06-Larvae_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.7K Dec  4 12:17 EF06-EM06-Larvae_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  48M Nov 26 21:13 EF07-EM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 297M Nov 26 21:13 EF07-EM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  44M Nov 26 21:13 EF07-EM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 112M Nov 26 21:24 EF07-EM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.7K Dec  4 12:17 EF07-EM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  21K Dec  4 12:17 EF07-EM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  923 Dec  4 12:17 EF07-EM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  44M Dec  4 12:17 EF07-EM01-Zygote_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 112M Nov 27 13:22 EF07-EM01-Zygote_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.7K Dec  4 12:17 EF07-EM01-Zygote_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  88M Nov 26 21:38 EF07-EM03-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 547M Nov 26 21:38 EF07-EM03-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  87M Nov 26 21:38 EF07-EM03-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 124M Nov 26 21:50 EF07-EM03-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF07-EM03-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  23K Dec  4 12:17 EF07-EM03-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  927 Dec  4 12:17 EF07-EM03-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  71M Dec  4 12:17 EF07-EM03-Larvae_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 124M Nov 27 13:34 EF07-EM03-Larvae_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF07-EM03-Larvae_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  89M Nov 26 22:06 EF08-EM03-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 546M Nov 26 22:06 EF08-EM03-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  88M Nov 26 22:06 EF08-EM03-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 125M Nov 26 22:18 EF08-EM03-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF08-EM03-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  23K Dec  4 12:17 EF08-EM03-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  927 Dec  4 12:17 EF08-EM03-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  72M Dec  4 12:17 EF08-EM03-Larvae_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 125M Nov 27 13:46 EF08-EM03-Larvae_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF08-EM03-Larvae_R1_001.fastp-trim.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  84M Nov 26 22:31 EF08-EM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz
-rw-r--r-- 1 sam sam 517M Nov 26 22:31 EF08-EM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bedGraph.gz.bismark.zero.cov
-rw-r--r-- 1 sam sam  82M Nov 26 22:31 EF08-EM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
-rw-r--r-- 1 sam sam 124M Nov 26 22:43 EF08-EM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF08-EM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.cytosine_context_summary.txt
-rw-r--r-- 1 sam sam  23K Dec  4 12:17 EF08-EM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.M-bias.txt
-rw-r--r-- 1 sam sam  928 Dec  4 12:17 EF08-EM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated_splitting_report.txt
-rw-r--r-- 1 sam sam  68M Dec  4 12:17 EF08-EM04-Larvae_R1_001.fastp-trim.CpG_report.merged_CpG_evidence.cov.gz
-rw-r--r-- 1 sam sam 124M Nov 27 13:57 EF08-EM04-Larvae_R1_001.fastp-trim.CpG_report.txt.gz
-rw-r--r-- 1 sam sam 1.8K Dec  4 12:17 EF08-EM04-Larvae_R1_001.fastp-trim.cytosine_context_summary.txt
drwxr-xr-x 2 sam sam 4.0K Dec  4 12:17 multiqc_data
-rw-r--r-- 1 sam sam 1.2M Dec  4 12:17 multiqc_report.html
-rw-r--r-- 1 sam sam 191M Nov 26 11:16 Non_CpG_context_CF01-CM01-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 2.6G Nov 26 11:37 Non_CpG_context_CF01-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 890M Nov 26 11:59 Non_CpG_context_CF02-CM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 1.3G Nov 26 12:18 Non_CpG_context_CF03-CM03-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 2.2G Nov 26 12:41 Non_CpG_context_CF03-CM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 2.4G Nov 26 13:07 Non_CpG_context_CF03-CM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 1.6G Nov 26 13:30 Non_CpG_context_CF04-CM04-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 3.4G Nov 26 13:58 Non_CpG_context_CF05-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 1.9G Nov 26 14:25 Non_CpG_context_CF05-CM05-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 1.6G Nov 26 14:47 Non_CpG_context_CF06-CM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 1.4G Nov 26 15:07 Non_CpG_context_CF06-CM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 992M Nov 26 15:25 Non_CpG_context_CF07-CM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 970M Nov 26 15:42 Non_CpG_context_CF08-CM03-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam  29M Nov 26 15:55 Non_CpG_context_CF08-CM04-Larvae_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam  27M Nov 26 16:05 Non_CpG_context_CF08-CM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 1.5G Nov 26 16:21 Non_CpG_context_EF01-EM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 1.6G Nov 26 16:42 Non_CpG_context_EF02-EM02-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 904M Nov 26 17:01 Non_CpG_context_EF03-EM03-Zygote_R1_001.fastp-trim.REPAIRED_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 2.3G Nov 26 17:23 Non_CpG_context_EF03-EM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 2.4G Nov 26 17:49 Non_CpG_context_EF03-EM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 485M Nov 26 18:08 Non_CpG_context_EF04-EM04-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 3.1G Nov 26 18:32 Non_CpG_context_EF04-EM05-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 1.9G Nov 26 18:58 Non_CpG_context_EF05-EM01-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 275M Nov 26 19:14 Non_CpG_context_EF05-EM05-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 3.4G Nov 26 19:39 Non_CpG_context_EF05-EM06-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 3.1G Nov 26 20:10 Non_CpG_context_EF06-EM01-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 2.3G Nov 26 20:38 Non_CpG_context_EF06-EM02-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 550M Nov 26 20:57 Non_CpG_context_EF06-EM06-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 653M Nov 26 21:12 Non_CpG_context_EF07-EM01-Zygote_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 2.4G Nov 26 21:33 Non_CpG_context_EF07-EM03-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 2.7G Nov 26 22:01 Non_CpG_context_EF08-EM03-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz
-rw-r--r-- 1 sam sam 2.1G Nov 26 22:27 Non_CpG_context_EF08-EM04-Larvae_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.txt.gz</code></pre>
</section>
<section id="checksums" class="level1">
<h1>7 Checksums</h1>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb9-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb9-3"></span>
<span id="cb9-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-5"></span>
<span id="cb9-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb9-7">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"checksums.md5"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb9-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> checksums.md5</span>
<span id="cb9-9">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb9-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
<section id="multiqc" class="level1">
<h1>8 MultiQC</h1>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb10-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb10-3"></span>
<span id="cb10-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb10-5"></span>
<span id="cb10-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${multiqc}</span> .</span></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ewels2016" class="csl-entry">
Ewels, Philip, MÃ¥ns Magnusson, Sverker Lundin, and Max KÃ¤ller. 2016. â€œMultiQC: Summarize Analysis Results for Multiple Tools and Samples in a Single Report.â€ <em>Bioinformatics</em> 32 (19): 3047â€“48. <a href="https://doi.org/10.1093/bioinformatics/btw354" class="uri">https://doi.org/10.1093/bioinformatics/btw354</a>.
</div>
<div id="ref-krueger2011" class="csl-entry">
Krueger, Felix, and Simon R. Andrews. 2011. â€œBismark: A Flexible Aligner and Methylation Caller for Bisulfite-Seq Applications.â€ <em>Bioinformatics</em> 27 (11): 1571â€“72. <a href="https://doi.org/10.1093/bioinformatics/btr167" class="uri">https://doi.org/10.1093/bioinformatics/btr167</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2024</category>
  <category>Crassostrea virginica</category>
  <category>Eastern oyster</category>
  <category>ceasmallr</category>
  <category>wgbs</category>
  <category>BS-seq</category>
  <category>Bismark</category>
  <category>methylation extraction</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-26-Methylation-Extraction---C.virginica-CEASMALLR-WGBS-Using-Bismark/</guid>
  <pubDate>Tue, 26 Nov 2024 08:00:00 GMT</pubDate>
  <media:content url="https://robertslab.github.io/sams-notebook/posts/2024/2024-11-26-Methylation-Extraction---C.virginica-CEASMALLR-WGBS-Using-Bismark/20241126-cvir-ceasmallr-multiqc-cytosine_methylation-plot.png" medium="image" type="image/png" height="28" width="144"/>
</item>
<item>
  <title>Deduplication - C.virginica CEASMALLR WGBS Using Bismark</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-25-Deduplication---C.virginica-CEASMALLR-WGBS-Using-Bismark/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>This notebook is part of the <a href="https://github.com/sr320/ceasmallr">ceasmallr</a> (GitHub repo) project, comparing DNA methylation in <a href="https://en.wikipedia.org/wiki/Eastern_oyster"><em>Crassostrea virginica</em> (Eastern oyster)</a> larvae and zygotes, via whole-genome bisulfite sequencing (WGBS).</p>
<p>Sequences were <a href="../../../posts/2024/2024-11-18-Alignment---C.virginica-CEASMALLR-WGBS-Using-Bismark-on-Klone-Array/index.html">previously align with Bismark on 20241118</a>.</p>
<p>Next step was to perform deduplication, using <a href="https://felixkrueger.github.io/Bismark/bismark/deduplication/">Bismark <code>deduplication</code></a> (Bismark manual).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This notebook was copied from knitted markdown from <a href="https://github.com/sr320/ceasmallr/blob/1d64c7032df8c961b65cb9914d58b82559229cff/code/02.10-bismark-deduplication.Rmd"><code>02.10-bismark-deduplication.Rmd</code></a> (commit <code>1d64c70</code>)/</p>
</div>
</div>
</section>
<section id="description" class="level1">
<h1>1 DESCRIPTION</h1>
<section id="inputs" class="level2">
<h2 class="anchored" data-anchor-id="inputs">1.1 Inputs</h2>
<p>This notebook is a continuation of using <a href="https://felixkrueger.github.io/Bismark/">Bismark</a> (Krueger and Andrews 2011) to perform methylation analysis. Read alignments were run in <a href="./02.00-bismark-bowtie2-alignment.Rmd">02.00-bismark-bowtie2-alignment.Rmd</a>. This step will perform <a href="https://felixkrueger.github.io/Bismark/bismark/deduplication/">deduplication</a> (Bismark manual) of the BAM files generated by alignment. Results will be summarized by <a href="https://github.com/MultiQC/MultiQC">MultiQC</a> (Ewels et al.&nbsp;2016).</p>
</section>
<section id="outputs" class="level2">
<h2 class="anchored" data-anchor-id="outputs">1.2 Outputs</h2>
<ul>
<li><p><code>*_dedup.sorted.bam</code>: Deduplicated, sorted BAMs.</p></li>
<li><p><code>*_dedup.sorted.bam.bai</code>: Deduplicated, sorted BAM index file. Useful for IGV.</p></li>
<li><p><code>*.deduplicated.bam</code>: Deduplicated BAMs. These are <em>not</em> sorted.</p></li>
<li><p><code>*.deduplication_report.txt</code>: Individual summary reports for each deduplication process.</p></li>
<li><p><code>multiqc_report.html</code>: A summary report of the alignment results generated by <a href="https://github.com/MultiQC/MultiQC">MultiQC</a>, in HTML format.</p></li>
</ul>
<p>Due to the large file sizes of BAMS, these cannot be hosted in the <a href="https://github.com/sr320/ceasmallr">ceasmallr GitHub repo</a>. As such these files are available for download here:</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/gitrepos/ceasmallr/output/02.10-bismark-deduplication/" class="uri">https://gannet.fish.washington.edu/gitrepos/ceasmallr/output/02.10-bismark-deduplication/</a></li>
</ul>
</section>
</section>
<section id="create-a-bash-variables-file" class="level1">
<h1>2 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export repo_dir=/home/shared/8TB_HDD_01/sam/gitrepos/ceasmallr'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export output_dir_top=${repo_dir}/output/02.10-bismark-deduplication'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export alignment_dir="${repo_dir}/output/02.00-bismark-bowtie2-alignment"'</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-10"></span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Paths to programs"</span></span>
<span id="cb1-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export programs_dir="/home/shared"'</span></span>
<span id="cb1-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export bismark_dir="${programs_dir}/Bismark-0.24.0"'</span></span>
<span id="cb1-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export bowtie2_dir="${programs_dir}/bowtie2-2.4.4-linux-x86_64"'</span></span>
<span id="cb1-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export multiqc="/home/sam/programs/mambaforge/bin/multiqc"'</span></span>
<span id="cb1-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export samtools_dir="${programs_dir}/samtools-1.12"'</span></span>
<span id="cb1-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set number of CPUs to use"</span></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=40'</span></span>
<span id="cb1-22"></span>
<span id="cb1-23"></span>
<span id="cb1-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Print formatting"</span></span>
<span id="cb1-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-27"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-28"></span>
<span id="cb1-29"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export repo_dir=/home/shared/8TB_HDD_01/sam/gitrepos/ceasmallr
export output_dir_top=${repo_dir}/output/02.10-bismark-deduplication
export alignment_dir="${repo_dir}/output/02.00-bismark-bowtie2-alignment"

# Paths to programs
export programs_dir="/home/shared"
export bismark_dir="${programs_dir}/Bismark-0.24.0"
export bowtie2_dir="${programs_dir}/bowtie2-2.4.4-linux-x86_64"
export multiqc="/home/sam/programs/mambaforge/bin/multiqc"
export samtools_dir="${programs_dir}/samtools-1.12"

# Set number of CPUs to use
export threads=40
# Print formatting
export line="--------------------------------------------------------"</code></pre>
</section>
<section id="deduplication" class="level1">
<h1>3 Deduplication</h1>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directory, if it doesn't exist</span></span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${alignment_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_bismark_bt2_pe.bam</span>
<span id="cb3-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb3-11">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set stderr filename</span></span>
<span id="cb3-12">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">stderr_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bam}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"."</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print $1"."$2"."$3".deduplication.stderr"}'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-13">  </span>
<span id="cb3-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run deduplication</span></span>
<span id="cb3-15">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bismark_dir}</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/deduplicate_bismark</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--samtools_path</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samtools_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--paired</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--bam</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--output_dir</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-20">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bam}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-21">  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_name}</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb3-22"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
<section id="sorting" class="level1">
<h1>4 Sorting</h1>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb4-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb4-5"></span>
<span id="cb4-6"></span>
<span id="cb4-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Sorting for Downstream Applications</span></span>
<span id="cb4-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>deduplicated.bam <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-9"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> _R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-10"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I{}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samtools_dir}</span>/samtools <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-11">sort {}_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-12">-@ <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-13">-o {}_dedup.sorted.bam</span></code></pre></div>
</section>
<section id="indexing-for-downstream-applications" class="level1">
<h1>5 Indexing for Downstream Applications</h1>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>dedup.sorted.bam <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> _dedup.sorted.bam <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I{}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samtools_dir}</span>/samtools <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-8">index {}_dedup.sorted.bam</span></code></pre></div>
</section>
<section id="multiqc" class="level1">
<h1>6 MultiQC</h1>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb6-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb6-5"></span>
<span id="cb6-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${multiqc}</span> .</span></code></pre></div>
</section>
<section id="checksums" class="level1">
<h1>7 Checksums</h1>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb7-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-5"></span>
<span id="cb7-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb7-7">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"checksums.md5"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb7-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> checksums.md5</span>
<span id="cb7-9">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb7-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
<section id="list-output-files" class="level1">
<h1>8 List output files</h1>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb8-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb8-3"></span>
<span id="cb8-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb8-5"></span>
<span id="cb8-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span></span></code></pre></div>
<pre><code>total 213G
-rw-r--r-- 1 sam sam 455M Nov 14 07:15 CF01-CM01-Zygote_dedup.sorted.bam
-rw-r--r-- 1 sam sam 603K Nov 14 08:30 CF01-CM01-Zygote_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 498M Nov 13 13:56 CF01-CM01-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  315 Nov 13 13:56 CF01-CM01-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 13:56 CF01-CM01-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 4.4G Nov 14 07:19 CF01-CM02-Larvae_dedup.sorted.bam
-rw-r--r-- 1 sam sam 1.4M Nov 14 08:31 CF01-CM02-Larvae_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 5.9G Nov 13 14:12 CF01-CM02-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  319 Nov 13 14:12 CF01-CM02-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 14:12 CF01-CM02-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 2.1G Nov 14 07:20 CF02-CM02-Zygote_dedup.sorted.bam
-rw-r--r-- 1 sam sam 921K Nov 14 08:32 CF02-CM02-Zygote_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 2.5G Nov 13 14:19 CF02-CM02-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  319 Nov 13 14:19 CF02-CM02-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 14:19 CF02-CM02-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 3.0G Nov 14 07:22 CF03-CM03-Zygote_dedup.sorted.bam
-rw-r--r-- 1 sam sam 1.2M Nov 14 08:33 CF03-CM03-Zygote_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 3.7G Nov 13 14:29 CF03-CM03-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  318 Nov 13 14:29 CF03-CM03-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 14:29 CF03-CM03-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 3.4G Nov 14 07:24 CF03-CM04-Larvae_dedup.sorted.bam
-rw-r--r-- 1 sam sam 1.3M Nov 14 08:34 CF03-CM04-Larvae_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 4.6G Nov 13 14:43 CF03-CM04-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  320 Nov 13 14:43 CF03-CM04-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 14:43 CF03-CM04-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 4.1G Nov 14 07:26 CF03-CM05-Larvae_dedup.sorted.bam
-rw-r--r-- 1 sam sam 1.4M Nov 14 08:35 CF03-CM05-Larvae_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 5.4G Nov 13 14:58 CF03-CM05-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  318 Nov 13 14:58 CF03-CM05-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 14:58 CF03-CM05-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 3.0G Nov 14 07:28 CF04-CM04-Zygote_dedup.sorted.bam
-rw-r--r-- 1 sam sam 1.2M Nov 14 08:36 CF04-CM04-Zygote_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 3.7G Nov 13 15:08 CF04-CM04-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  319 Nov 13 15:08 CF04-CM04-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 15:08 CF04-CM04-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 5.4G Nov 14 07:33 CF05-CM02-Larvae_dedup.sorted.bam
-rw-r--r-- 1 sam sam 1.6M Nov 14 08:38 CF05-CM02-Larvae_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 7.5G Nov 13 15:29 CF05-CM02-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  320 Nov 13 15:29 CF05-CM02-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 15:30 CF05-CM02-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 3.5G Nov 14 07:35 CF05-CM05-Zygote_dedup.sorted.bam
-rw-r--r-- 1 sam sam 1.3M Nov 14 08:39 CF05-CM05-Zygote_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 4.4G Nov 13 15:42 CF05-CM05-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  319 Nov 13 15:42 CF05-CM05-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 15:42 CF05-CM05-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 3.3G Nov 14 07:37 CF06-CM01-Zygote_dedup.sorted.bam
-rw-r--r-- 1 sam sam 1.3M Nov 14 08:40 CF06-CM01-Zygote_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 4.0G Nov 13 15:52 CF06-CM01-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  318 Nov 13 15:52 CF06-CM01-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 15:53 CF06-CM01-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 2.6G Nov 14 07:38 CF06-CM02-Larvae_dedup.sorted.bam
-rw-r--r-- 1 sam sam 1.1M Nov 14 08:41 CF06-CM02-Larvae_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 3.1G Nov 13 16:01 CF06-CM02-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  318 Nov 13 16:01 CF06-CM02-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 16:01 CF06-CM02-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 2.0G Nov 14 07:39 CF07-CM02-Zygote_dedup.sorted.bam
-rw-r--r-- 1 sam sam 968K Nov 14 08:41 CF07-CM02-Zygote_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 2.4G Nov 13 16:08 CF07-CM02-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  318 Nov 13 16:08 CF07-CM02-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 16:08 CF07-CM02-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 2.2G Nov 14 07:41 CF08-CM03-Zygote_dedup.sorted.bam
-rw-r--r-- 1 sam sam 950K Nov 14 08:42 CF08-CM03-Zygote_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 2.6G Nov 13 16:15 CF08-CM03-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  319 Nov 13 16:15 CF08-CM03-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 16:15 CF08-CM03-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam  58M Nov 14 07:41 CF08-CM04-Larvae_dedup.sorted.bam
-rw-r--r-- 1 sam sam 1.1M Nov 14 08:42 CF08-CM04-Larvae_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam  60M Nov 13 16:15 CF08-CM04-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  312 Nov 13 16:15 CF08-CM04-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 16:15 CF08-CM04-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam  50M Nov 14 07:41 CF08-CM05-Larvae_dedup.sorted.bam
-rw-r--r-- 1 sam sam 1.1M Nov 14 08:42 CF08-CM05-Larvae_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam  52M Nov 13 16:15 CF08-CM05-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  314 Nov 13 16:15 CF08-CM05-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 16:15 CF08-CM05-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam  16K Nov 14 09:44 checksums.md5
-rw-r--r-- 1 sam sam 2.8G Nov 14 07:42 EF01-EM01-Zygote_dedup.sorted.bam
-rw-r--r-- 1 sam sam 1.2M Nov 14 08:43 EF01-EM01-Zygote_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 3.5G Nov 13 16:25 EF01-EM01-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  318 Nov 13 16:25 EF01-EM01-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 16:25 EF01-EM01-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 3.0G Nov 14 07:44 EF02-EM02-Zygote_dedup.sorted.bam
-rw-r--r-- 1 sam sam 1.2M Nov 14 08:44 EF02-EM02-Zygote_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 3.7G Nov 13 16:35 EF02-EM02-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  318 Nov 13 16:35 EF02-EM02-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 16:35 EF02-EM02-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 2.0G Nov 14 07:45 EF03-EM03-Zygote_dedup.sorted.bam
-rw-r--r-- 1 sam sam 897K Nov 14 08:45 EF03-EM03-Zygote_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 2.3G Nov 13 16:41 EF03-EM03-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  318 Nov 13 16:41 EF03-EM03-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 16:41 EF03-EM03-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 4.1G Nov 14 07:47 EF03-EM04-Larvae_dedup.sorted.bam
-rw-r--r-- 1 sam sam 1.4M Nov 14 08:46 EF03-EM04-Larvae_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 5.1G Nov 13 16:55 EF03-EM04-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  319 Nov 13 16:55 EF03-EM04-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 16:56 EF03-EM04-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 4.1G Nov 14 07:50 EF03-EM05-Larvae_dedup.sorted.bam
-rw-r--r-- 1 sam sam 1.5M Nov 14 08:47 EF03-EM05-Larvae_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 5.4G Nov 13 17:10 EF03-EM05-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  318 Nov 13 17:10 EF03-EM05-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 17:11 EF03-EM05-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 1.1G Nov 14 07:50 EF04-EM04-Zygote_dedup.sorted.bam
-rw-r--r-- 1 sam sam 600K Nov 14 08:47 EF04-EM04-Zygote_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 1.2G Nov 13 17:14 EF04-EM04-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  317 Nov 13 17:14 EF04-EM04-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 17:14 EF04-EM04-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 4.9G Nov 14 07:55 EF04-EM05-Larvae_dedup.sorted.bam
-rw-r--r-- 1 sam sam 1.5M Nov 14 08:49 EF04-EM05-Larvae_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 6.8G Nov 13 17:33 EF04-EM05-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  320 Nov 13 17:33 EF04-EM05-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 17:33 EF04-EM05-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 3.1G Nov 14 07:57 EF05-EM01-Larvae_dedup.sorted.bam
-rw-r--r-- 1 sam sam 1.2M Nov 14 08:50 EF05-EM01-Larvae_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 4.1G Nov 13 17:45 EF05-EM01-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  318 Nov 13 17:45 EF05-EM01-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 17:45 EF05-EM01-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 702M Nov 14 07:57 EF05-EM05-Zygote_dedup.sorted.bam
-rw-r--r-- 1 sam sam 567K Nov 14 08:50 EF05-EM05-Zygote_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 756M Nov 13 17:47 EF05-EM05-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  316 Nov 13 17:47 EF05-EM05-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 17:47 EF05-EM05-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 5.0G Nov 14 08:02 EF05-EM06-Larvae_dedup.sorted.bam
-rw-r--r-- 1 sam sam 1.6M Nov 14 08:52 EF05-EM06-Larvae_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 7.0G Nov 13 18:07 EF05-EM06-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  320 Nov 13 18:07 EF05-EM06-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 18:07 EF05-EM06-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 4.9G Nov 14 08:06 EF06-EM01-Larvae_dedup.sorted.bam
-rw-r--r-- 1 sam sam 1.6M Nov 14 08:53 EF06-EM01-Larvae_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 6.8G Nov 13 18:26 EF06-EM01-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  319 Nov 13 18:26 EF06-EM01-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 18:26 EF06-EM01-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 4.0G Nov 14 08:09 EF06-EM02-Larvae_dedup.sorted.bam
-rw-r--r-- 1 sam sam 1.4M Nov 14 08:55 EF06-EM02-Larvae_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 5.2G Nov 13 18:41 EF06-EM02-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  319 Nov 13 18:41 EF06-EM02-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 18:41 EF06-EM02-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 1.2G Nov 14 08:09 EF06-EM06-Larvae_dedup.sorted.bam
-rw-r--r-- 1 sam sam 574K Nov 14 08:55 EF06-EM06-Larvae_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 1.3G Nov 13 18:48 EF06-EM06-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  318 Nov 13 18:48 EF06-EM06-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 18:48 EF06-EM06-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 1.5G Nov 14 08:10 EF07-EM01-Zygote_dedup.sorted.bam
-rw-r--r-- 1 sam sam 730K Nov 14 08:55 EF07-EM01-Zygote_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 1.7G Nov 13 18:53 EF07-EM01-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  319 Nov 13 18:53 EF07-EM01-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 18:53 EF07-EM01-Zygote_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 3.8G Nov 14 08:12 EF07-EM03-Larvae_dedup.sorted.bam
-rw-r--r-- 1 sam sam 1.4M Nov 14 08:57 EF07-EM03-Larvae_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 5.2G Nov 13 19:08 EF07-EM03-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  319 Nov 13 19:08 EF07-EM03-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 19:08 EF07-EM03-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 4.3G Nov 14 08:17 EF08-EM03-Larvae_dedup.sorted.bam
-rw-r--r-- 1 sam sam 1.4M Nov 14 08:58 EF08-EM03-Larvae_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 6.0G Nov 13 19:25 EF08-EM03-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  320 Nov 13 19:25 EF08-EM03-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 19:25 EF08-EM03-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
-rw-r--r-- 1 sam sam 3.8G Nov 14 08:19 EF08-EM04-Larvae_dedup.sorted.bam
-rw-r--r-- 1 sam sam 1.3M Nov 14 08:59 EF08-EM04-Larvae_dedup.sorted.bam.bai
-rw-r--r-- 1 sam sam 4.9G Nov 13 19:38 EF08-EM04-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplicated.bam
-rw-r--r-- 1 sam sam  319 Nov 13 19:38 EF08-EM04-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication_report.txt
-rw-r--r-- 1 sam sam 3.4K Nov 13 19:39 EF08-EM04-Larvae_R1_001.fastp-trim.20220827_bismark_bt2_pe.deduplication.stderr
drwxr-xr-x 2 sam sam 4.0K Nov 14 09:30 multiqc_data
-rw-r--r-- 1 sam sam 1.1M Nov 14 09:30 multiqc_report.html</code></pre>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ewels2016" class="csl-entry">
Ewels, Philip, MÃ¥ns Magnusson, Sverker Lundin, and Max KÃ¤ller. 2016. â€œMultiQC: Summarize Analysis Results for Multiple Tools and Samples in a Single Report.â€ <em>Bioinformatics</em> 32 (19): 3047â€“48. <a href="https://doi.org/10.1093/bioinformatics/btw354" class="uri">https://doi.org/10.1093/bioinformatics/btw354</a>.
</div>
<div id="ref-krueger2011" class="csl-entry">
Krueger, Felix, and Simon R. Andrews. 2011. â€œBismark: A Flexible Aligner and Methylation Caller for Bisulfite-Seq Applications.â€ <em>Bioinformatics</em> 27 (11): 1571â€“72. <a href="https://doi.org/10.1093/bioinformatics/btr167" class="uri">https://doi.org/10.1093/bioinformatics/btr167</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2024</category>
  <category>Crassostrea virginica</category>
  <category>Eastern oyster</category>
  <category>ceasmallr</category>
  <category>Bismark</category>
  <category>WGBS</category>
  <category>BS-seq</category>
  <category>deduplication</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-25-Deduplication---C.virginica-CEASMALLR-WGBS-Using-Bismark/</guid>
  <pubDate>Mon, 25 Nov 2024 08:00:00 GMT</pubDate>
  <media:content url="https://robertslab.github.io/sams-notebook/posts/2024/2024-11-25-Deduplication---C.virginica-CEASMALLR-WGBS-Using-Bismark/20241125-cvir-ceasmallr-multiq-bismark_deduplication-plot.png" medium="image" type="image/png" height="96" width="144"/>
</item>
<item>
  <title>Computer Management - Replace Failed Hard Drive on Gannet</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-18-Computer-Management---Replace-Failed-Hard-Drive-on-Gannet/</link>
  <description><![CDATA[ 





<p>Gannet was inaccessible, so went into lab to investigate. When I arrived, Gannet appeared to be powered on and the â€œStatusâ€ light was green, but none of the drive light indicators were on.</p>
<div id="fig-no_lights" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="Blue power indicator is illuminated, however, all drive lights are out.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-no_lights-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241118-gannet-hdds-no_lights.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Blue power indicator is illuminated, however, all drive lights are out."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-11-18-Computer-Management---Replace-Failed-Hard-Drive-on-Gannet/20241118-gannet-hdds-no_lights.jpg" class="img-fluid figure-img" alt="Blue power indicator is illuminated, however, all drive lights are out."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-no_lights-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Blue power indicator is illuminated, however, all drive lights are out.
</figcaption>
</figure>
</div>
<p>With no other recourse, I powered off Gannet and then powered it back on. All drive lights illuminated, with one of them red, indicating that drive had failed.</p>
<div id="fig-one_red_light" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="All drive lights are green, except one, which is red.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-one_red_light-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241118-gannet-hdds-red_light.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: All drive lights are green, except one, which is red."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-11-18-Computer-Management---Replace-Failed-Hard-Drive-on-Gannet/20241118-gannet-hdds-red_light.jpg" class="img-fluid figure-img" alt="All drive lights are green, except one, which is red."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-one_red_light-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: All drive lights are green, except one, which is red.
</figcaption>
</figure>
</div>
<p>I was then able to access the Synology DSM web interface, removed the bad drive from the storage pool, physically replaced the bad drive, and added the new drive to the storage pool.</p>
<div id="fig-dsm_repair_mode" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="Screenshot of Synology DSM showing all drives as healthy and pool is in repair mode.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dsm_repair_mode-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241118-gannet-hdd-replacement-repairing-01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: Screenshot of Synology DSM showing all drives as healthy and pool is in repair mode."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-11-18-Computer-Management---Replace-Failed-Hard-Drive-on-Gannet/20241118-gannet-hdd-replacement-repairing-01.png" class="img-fluid figure-img" alt="Screenshot of Synology DSM showing all drives as healthy and pool is in repair mode."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dsm_repair_mode-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Screenshot of Synology DSM showing all drives as healthy and pool is in repair mode.
</figcaption>
</figure>
</div>
<p>Everything looks good now, but itâ€™s not clear why Synology marked the drive as bad. Quick S.M.A.R.T. tests run on Synology and using Seagateâ€™s <a href="https://www.seagate.com/support/downloads/seatools/">SeaTools</a> indicated the drive was fineâ€¦</p>
<p>Iâ€™ll run an extended test using <a href="https://www.seagate.com/support/downloads/seatools/">SeaTools</a> to see if that reports anything different.</p>



 ]]></description>
  <category>2024</category>
  <category>Gannet</category>
  <category>HDD</category>
  <category>Computer Management</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-18-Computer-Management---Replace-Failed-Hard-Drive-on-Gannet/</guid>
  <pubDate>Mon, 18 Nov 2024 08:00:00 GMT</pubDate>
  <media:content url="https://robertslab.github.io/sams-notebook/posts/2024/2024-11-18-Computer-Management---Replace-Failed-Hard-Drive-on-Gannet/20241118-gannet-hdd-replacement-repairing-01.png" medium="image" type="image/png" height="85" width="144"/>
</item>
<item>
  <title>Alignment - C.virginica CEASMALLR WGBS Using Bismark on Klone Array</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-18-Alignment---C.virginica-CEASMALLR-WGBS-Using-Bismark-on-Klone-Array/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>This notebook is part of the <a href="https://github.com/sr320/ceasmallr">ceasmallr</a> (GitHub repo) project, comparing DNA methylation in <a href="https://en.wikipedia.org/wiki/Eastern_oyster"><em>Crassostrea virginica</em> (Eastern oyster)</a> larvae and zygotes, via whole-genome bisulfite sequencing (WGBS).</p>
<p>Trimming was previously <a href="../../../posts/2024/2024-11-15-Trimming-and-QC---C.virginica-CEASMALLR-FastQs-Using-fastp-BBTools-and-FastQC-MultiQC/index.html">performed on 20241115</a> (Notebook entry).</p>
<p>Subsequently, the trimmed reads needed to aligned to the <a href="https://en.wikipedia.org/wiki/Eastern_oyster"><em>Crassostrea virginica</em> (Eastern oyster)</a> genome, using <a href="https://github.com/FelixKrueger/Bismark"><code>Bismark</code></a>. Alignments were initially performed on Raven, but were done using <a href="../../../posts/2022/2022-08-29-FastQ-Trimming-and-QC---C.virginica-Larval-BS-seq-Data-from-Lotterhos-Lab-and-Part-of-CEABIGR-Project-Using-fastp-on-Mox/index.html">trimmed reads containing errors from 20220829</a> (Notebook entry), so needed to be re-trimmed <em>and</em> realigned. Additionally, the alignments took nearly two <em>weeks</em>! So, we explored a different approach to speed things up by utilizing node arrays on the Univ. of Washingtonâ€™s HPC, Klone (Hyak).</p>
<p>The code originally run is here, and is still useful for those without access to HPC resources:</p>
<ul>
<li><a href="https://github.com/sr320/ceasmallr/blob/main/code/02.00-bismark-bowtie2-alignment.Rmd">02.00-bismark-bowtie2-alignment.Rmd</a> (GitHub repo)</li>
</ul>
</section>
<section id="methods" class="level1">
<h1>METHODS</h1>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>When launching the SLURM job, you can initiate the array to determine the appropriate number of nodes by using Bash calculations.</p>
<p>The file <code>fastq_pairs.txt</code> has to exist before execution!</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sbatch</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(($$</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">wc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">l</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_pairs</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">txt</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">))</span> 02.02-bismark-SLURM-job.sh</span></code></pre></div>
</div>
</div>
<p>This approach required two scripts:</p>
<ul>
<li><p>SLURM script</p>
<ul>
<li><a href="https://github.com/sr320/ceasmallr/blob/main/code/02.02-bismark-SLURM-job.sh">02.02-bismark-SLURM-job.sh</a></li>
</ul>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --job-name=bismark_job_array</span></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --account=coenv</span></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --partition=cpu-g2</span></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --output=bismark_job_%A_%a.out</span></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --error=bismark_job_%A_%a.err</span></span>
<span id="cb2-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --ntasks=1</span></span>
<span id="cb2-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --cpus-per-task=20</span></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mem=100G</span></span>
<span id="cb2-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --time=72:00:00</span></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##turn on e-mail notification</span></span>
<span id="cb2-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-type=ALL</span></span>
<span id="cb2-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-user=samwhite@uw.edu</span></span>
<span id="cb2-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Specify the working directory for this job</span></span>
<span id="cb2-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --chdir=/gscratch/scrubbed/samwhite/gitrepos/ceasmallr/output/02.01-bismark-bowtie2-alignment-SLURM-array/</span></span>
<span id="cb2-16"></span>
<span id="cb2-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Execute Roberts Lab bioinformatics container</span></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Binds home directory</span></span>
<span id="cb2-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Binds /gscratch directory</span></span>
<span id="cb2-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Directory bindings allow outputs to be written to the hard drive.</span></span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Executes Bismark alignment using 02.01-bismark-bowtie2-alignment-SLURM-array.sh script.</span></span>
<span id="cb2-23"></span>
<span id="cb2-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># To execture this SLURM script as an array, start the script with the following command:</span></span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sbatch --array=0-$(($$(wc -l &lt; fastq_pairs.txt) - 1)) 02.02-bismark-SLURM-job.sh</span></span>
<span id="cb2-27"></span>
<span id="cb2-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># IMPORTANT: Requires fastq_pairs.txt to exist prior to submission!</span></span>
<span id="cb2-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apptainer</span> exec <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-30">--home <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$PWD</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-31">--bind /mmfs1/home/ <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-32">--bind /gscratch <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-33">/gscratch/srlab/sr320/srlab-bioinformatics-container-586bf21.sif <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-34">/gscratch/scrubbed/samwhite/gitrepos/ceasmallr/code/02.01-bismark-bowtie2-alignment-SLURM-array.sh</span></code></pre></div></li>
<li><p>Job script:</p>
<ul>
<li><a href="https://github.com/sr320/ceasmallr/blob/main/code/02.01-bismark-bowtie2-alignment-SLURM-array.sh">02.01-bismark-bowtie2-alignment-SLURM-array.sh</a> (GitHub repo)</li>
</ul>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This script is designed to be called by a SLURM script which</span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># runs this script across an array of HPC nodes.</span></span>
<span id="cb3-5"></span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################</span></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># These variables need to be set by user</span></span>
<span id="cb3-9"></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Assign Variables</span></span>
<span id="cb3-11"></span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># INPUT FILES</span></span>
<span id="cb3-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">repo_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/scrubbed/samwhite/gitrepos/ceasmallr"</span></span>
<span id="cb3-14"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trimmed_fastqs_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${repo_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/output/00.00-trimming-fastp"</span></span>
<span id="cb3-15"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bisulfite_genome_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${repo_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/data/Cvirginica_v300"</span></span>
<span id="cb3-16"></span>
<span id="cb3-17"></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># OUTPUT FILES</span></span>
<span id="cb3-19"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_dir_top</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${repo_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/output/02.01-bismark-bowtie2-alignment-SLURM-array"</span></span>
<span id="cb3-20"></span>
<span id="cb3-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># PARAMETERS</span></span>
<span id="cb3-22"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bowtie2_min_score</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L,0,-0.6"</span></span>
<span id="cb3-23"></span>
<span id="cb3-24"></span>
<span id="cb3-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># CPU threads</span></span>
<span id="cb3-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Bismark already spawns multiple instances and additional threads are multiplicative."</span></span>
<span id="cb3-27"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bismark_threads</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>15</span>
<span id="cb3-28"></span>
<span id="cb3-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################</span></span>
<span id="cb3-30"></span>
<span id="cb3-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print name of container</span></span>
<span id="cb3-32"></span>
<span id="cb3-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Running in Apptainer container: </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${APPTAINER_CONTAINER}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-35"></span>
<span id="cb3-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directory, if it doesn't exist</span></span>
<span id="cb3-37"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"02.01-bismark-bowtie2-alignment-SLURM-array"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-38"></span>
<span id="cb3-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## CREATE LIST OF PAIRED READS ##</span></span>
<span id="cb3-40"></span>
<span id="cb3-41"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-42"></span>
<span id="cb3-43"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-f</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/fastq_pairs.txt <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb3-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/fastq_pairs.txt</span>
<span id="cb3-45"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb3-46"></span>
<span id="cb3-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Find all _R1_ files and match them with their corresponding _R2_ files</span></span>
<span id="cb3-48"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> R1_file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_R1_<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.fq.gz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb3-49">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R2_file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_R1_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>_R2_<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-50">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-f</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$R2_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb3-51">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$R1_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$R2_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/fastq_pairs.txt</span>
<span id="cb3-52">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb3-53">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Warning: No matching R2 file for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$R1_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-54">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb3-55"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb3-56"></span>
<span id="cb3-57"></span>
<span id="cb3-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## SET ARRAY TASKS ##</span></span>
<span id="cb3-59"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-60"></span>
<span id="cb3-61"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the FastQ file pair for this task</span></span>
<span id="cb3-62"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pair</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SLURM_ARRAY_TASK_ID}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">p"</span> fastq_pairs.txt<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-63"></span>
<span id="cb3-64"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$pair</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print $1}'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-65"></span>
<span id="cb3-66"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$pair</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print $2}'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-67"></span>
<span id="cb3-68"></span>
<span id="cb3-69"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if R1 and R2 are not empty</span></span>
<span id="cb3-70"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-z</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$R1</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-z</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$R2</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb3-71">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Error: R1 or R2 is empty. Exiting."</span></span>
<span id="cb3-72">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">exit</span> 1</span>
<span id="cb3-73"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb3-74"></span>
<span id="cb3-75"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get just the sample name (excludes the _R[12]_001*)</span></span>
<span id="cb3-76"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>_<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-77"></span>
<span id="cb3-78"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if sample_name is not empty</span></span>
<span id="cb3-79"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-z</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_name</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb3-80">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Error: sample_name is empty. Exiting."</span></span>
<span id="cb3-81">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">exit</span> 1</span>
<span id="cb3-82"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb3-83"></span>
<span id="cb3-84"></span>
<span id="cb3-85"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## RUN BISMARK ALIGNMENTS ##</span></span>
<span id="cb3-86"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bismark</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-87">--genome <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bisulfite_genome_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-88">--score_min <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bowtie2_min_score}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-89">--parallel <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bismark_threads}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-90">--non_directional <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-91">--gzip <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-92">-p <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bismark_threads}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-93">-1 <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-94">-2 <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-95">--output_dir <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-96">2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span>-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SLURM_ARRAY_TASK_ID}</span>-bismark_summary.txt</span></code></pre></div></li>
</ul>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<section id="outputs" class="level2">
<h2 class="anchored" data-anchor-id="outputs">Outputs</h2>
<p>The expected outputs will be:</p>
<ul>
<li><p><code>*_R1_001.fastp-trim_bismark_bt2_PE_report.txt</code>: A text file summarizing the alignment input and results. Despite the <code>R1</code> naming, these reports are based on <em>paired reads</em>; the <code>R1</code> naming is a quirk of <a href="https://felixkrueger.github.io/Bismark/">Bismark</a>.</p></li>
<li><p><code>*_R1_001.fastp-trim_bismark_bt2_pe.bam</code>:A BAM alignment. Despite the <code>R1</code> naming, these BAMs are <em>paired reads</em>; the <code>R1</code> naming is a quirk of <a href="https://felixkrueger.github.io/Bismark/">Bismark</a>.</p></li>
<li><p><code>bismark_summary.txt</code>: An overall summary report of the alignment process. Essentially, this is all of the individual <code>*report.txt</code> files combined into a single file.</p></li>
<li><p><code>multiqc_report.html</code>: A summary report of the alignment results generated by <a href="https://github.com/MultiQC/MultiQC">MultiQC</a>, in HTML format.</p></li>
</ul>
<p>Due to the large file sizes of BAMS, these cannot be hosted in the <a href="https://github.com/sr320/ceasmallr">ceasmallr GitHub repo</a>. As such these files are available for download here:</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/gitrepos/ceasmallr/">https://gannet.fish.washington.edu/gitrepos/ceasmallr/</a></li>
</ul>


</section>
</section>

 ]]></description>
  <category>2024</category>
  <category>trimming</category>
  <category>Crassostrea virginica</category>
  <category>Eastern oyster</category>
  <category>ceasmallr</category>
  <category>WGBS</category>
  <category>BS-seq</category>
  <category>Klone</category>
  <category>Bismark</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-18-Alignment---C.virginica-CEASMALLR-WGBS-Using-Bismark-on-Klone-Array/</guid>
  <pubDate>Mon, 18 Nov 2024 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Trimming and QC - C.virginica CEASMALLR FastQs Using fastp BBTools and FastQC-MultiQC</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-15-Trimming-and-QC---C.virginica-CEASMALLR-FastQs-Using-fastp-BBTools-and-FastQC-MultiQC/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>This notebook is part of the <a href="https://github.com/sr320/ceasmallr">ceasmallr</a> (GitHub repo) project, comparing DNA methylation in <a href="https://en.wikipedia.org/wiki/Eastern_oyster"><em>Crassostrea virginica</em> (Eastern oyster)</a> larvae and zygotes, via whole-genome bisulfite sequencing (WGBS).</p>
<p>Trimming was done using <a href="https://github.com/OpenGene/fastp"><code>fastp</code></a>. After an initial round of trimming, it was discovered that there were problems with some of the FastQ R1/R2 pairs - some did not have an equal number of reads. This leads to an error (and incomplete trimming) in those samples. As such, a step was added to assess these samples and repair them using the <a href="https://jgi.doe.gov/data-and-tools/software-tools/bbtools/">BBTools</a> <code>repair.sh</code> script.</p>
<p>Also, trimming had <a href="../../../posts/2022/2022-08-29-FastQ-Trimming-and-QC---C.virginica-Larval-BS-seq-Data-from-Lotterhos-Lab-and-Part-of-CEABIGR-Project-Using-fastp-on-Mox/index.html">originally been performed on 20220829</a> (Notebook entry), but had not been fully assessed, which led to the discovery of the trimming errors, and the implemented repair in this notebook.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This notebook was copied from knitted markdown from <a href="https://github.com/sr320/ceasmallr/blob/daa2453e45377711745635b81a3bb3a9b894d546/code/00.00-trimming-fastp.Rmd"><code>00.00-trimming-fastp.Rmd</code></a> (commit <code>daa2453</code>)</p>
</div>
</div>
</section>
<section id="description" class="level1">
<h1>1 Description</h1>
<p>This notebook will download raw WGBS FastQs, concatenate them (there were multiple lanes run), and then trim them using <a href="https://github.com/OpenGene/fastp">fastp</a>. Samples which generate an error during trimming will attempt to be repaired using <a href="https://jgi.doe.gov/data-and-tools/software-tools/bbtools/">BBTools <code>repairl.sh</code></a> (BBMap â€“ Bushnell B. â€“ sourceforge.net/projects/bbmap/). Trimming results will be analyzed with FastQC and summarized by <a href="https://github.com/MultiQC/MultiQC">MultiQC</a> (Ewels et al.&nbsp;2016).</p>
<section id="inputs" class="level2">
<h2 class="anchored" data-anchor-id="inputs">1.1 Inputs</h2>
<p>Raw FastQ files with the following pattern:</p>
<ul>
<li><code>*.fastq.gz</code></li>
</ul>
</section>
<section id="outputs" class="level2">
<h2 class="anchored" data-anchor-id="outputs">1.2 Outputs</h2>
<p>The expected outputs will be:</p>
<ul>
<li><p><code>multiqc_report.html</code>: A summary report of the alignment results generated by <a href="https://github.com/MultiQC/MultiQC">MultiQC</a>, in HTML format.</p></li>
<li><p><code>*fastp-trim*.fq.gz</code>: Trimmed FastQ files.</p>
<ul>
<li><p>Due to the large file sizes of FastQs, these cannot be hosted in the <a href="https://github.com/sr320/ceasmallr">ceasmallr GitHub repo</a>. As such these files are available for download here:</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/gitrepos/ceasmallr/output/00.00-trimming-fastp/" class="uri">https://gannet.fish.washington.edu/gitrepos/ceasmallr/output/00.00-trimming-fastp/</a></li>
</ul></li>
</ul></li>
</ul>
</section>
</section>
<section id="create-a-bash-variables-file" class="level1">
<h1>2 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export repo_dir=/home/shared/8TB_HDD_01/sam/gitrepos/ceasmallr'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export output_dir_top=${repo_dir}/output/00.00-trimming-fastp'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_url="https://owl.fish.washington.edu/nightingales/C_virginica/2018OALarvae_DNAm_discovery/"'</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_dir="${repo_dir}/data/raw_reads"'</span></span>
<span id="cb1-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export trimmed_fastqs_dir="${output_dir_top}/trimmed-fastqs"'</span></span>
<span id="cb1-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Paths to programs"</span></span>
<span id="cb1-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export programs_dir="/home/shared"'</span></span>
<span id="cb1-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export bbmap_repair="${programs_dir}/bbmap-39.12/repair.sh"'</span></span>
<span id="cb1-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export bismark_dir="${programs_dir}/Bismark-0.24.0"'</span></span>
<span id="cb1-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export bowtie2_dir="${programs_dir}/bowtie2-2.4.4-linux-x86_64"'</span></span>
<span id="cb1-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastp="${programs_dir}/fastp-v0.24.0/fastp"'</span></span>
<span id="cb1-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastqc="${programs_dir}/FastQC-0.12.1/fastqc"'</span></span>
<span id="cb1-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export multiqc="/home/sam/programs/mambaforge/bin/multiqc"'</span></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export samtools_dir="${programs_dir}/samtools-1.12"'</span></span>
<span id="cb1-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-23"></span>
<span id="cb1-24"></span>
<span id="cb1-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set FastQ filename patterns"</span></span>
<span id="cb1-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export fastq_pattern='*.fastq.gz'"</span></span>
<span id="cb1-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R1_fastq_pattern='*_R1_*.fastq.gz'"</span></span>
<span id="cb1-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R2_fastq_pattern='*_R2_*.fastq.gz'"</span></span>
<span id="cb1-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export trimmed_fastq_pattern='*fastp-trim*.fq.gz'"</span></span>
<span id="cb1-30"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-31"></span>
<span id="cb1-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set number of CPUs to use"</span></span>
<span id="cb1-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=40'</span></span>
<span id="cb1-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-35"></span>
<span id="cb1-36"></span>
<span id="cb1-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"## Inititalize arrays"</span></span>
<span id="cb1-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R1=()'</span></span>
<span id="cb1-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R2=()'</span></span>
<span id="cb1-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export trimmed_fastqs_array=()'</span></span>
<span id="cb1-41"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R1_names_array=()'</span></span>
<span id="cb1-42"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R2_names_array=()'</span></span>
<span id="cb1-43"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-44"></span>
<span id="cb1-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Print formatting"</span></span>
<span id="cb1-46"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-47"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-48"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-49"></span>
<span id="cb1-50"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export repo_dir=/home/shared/8TB_HDD_01/sam/gitrepos/ceasmallr
export output_dir_top=${repo_dir}/output/00.00-trimming-fastp
export raw_reads_url="https://owl.fish.washington.edu/nightingales/C_virginica/2018OALarvae_DNAm_discovery/"
export raw_reads_dir="${repo_dir}/data/raw_reads"
export trimmed_fastqs_dir="${output_dir_top}/trimmed-fastqs"

# Paths to programs
export programs_dir="/home/shared"
export bbmap_repair="${programs_dir}/bbmap-39.12/repair.sh"
export bismark_dir="${programs_dir}/Bismark-0.24.0"
export bowtie2_dir="${programs_dir}/bowtie2-2.4.4-linux-x86_64"
export fastp="${programs_dir}/fastp-v0.24.0/fastp"
export fastqc="${programs_dir}/FastQC-0.12.1/fastqc"
export multiqc="/home/sam/programs/mambaforge/bin/multiqc"
export samtools_dir="${programs_dir}/samtools-1.12"

# Set FastQ filename patterns
export fastq_pattern='*.fastq.gz'
export R1_fastq_pattern='*_R1_*.fastq.gz'
export R2_fastq_pattern='*_R2_*.fastq.gz'
export trimmed_fastq_pattern='*fastp-trim*.fq.gz'

# Set number of CPUs to use
export threads=40

## Inititalize arrays
export fastq_array_R1=()
export fastq_array_R2=()
export trimmed_fastqs_array=()
export R1_names_array=()
export R2_names_array=()

# Print formatting
export line="--------------------------------------------------------"</code></pre>
</section>
<section id="download-raw-reads" class="level1">
<h1>3 Download raw reads</h1>
<p>The <code>--cut-dirs 2</code> command cuts the preceding directory structure (i.e.&nbsp;<code>nightingales/C_virginica/</code>) so that we just end up with the reads.</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create directory, if it doesn't exist</span></span>
<span id="cb3-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span></span>
<span id="cb3-7"></span>
<span id="cb3-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-9">--directory-prefix <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-10">--recursive <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-11">--no-check-certificate <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-12">--continue <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-13">--cut-dirs 2 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-14">--no-parent <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-15">--no-host-directories <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-16">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-17"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_url}</span></span>
<span id="cb3-18"></span>
<span id="cb3-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<section id="verify-checkums" class="level2">
<h2 class="anchored" data-anchor-id="verify-checkums">3.1 Verify checkums</h2>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb4-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/2018OALarvae_DNAm_discovery</span>
<span id="cb4-5"></span>
<span id="cb4-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--check</span> md5sum_list.txt</span>
<span id="cb4-7"></span>
<span id="cb4-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb4-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb4-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb4-11"></span>
<span id="cb4-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> second_lane</span>
<span id="cb4-13"></span>
<span id="cb4-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--check</span> md5sum_list.txt</span></code></pre></div>
</section>
</section>
<section id="concatenate-reads" class="level1">
<h1>4 Concatenate reads</h1>
<p>Concatenation also handles samples where there might be a missing set of R2 reads in the second round of sequencing.</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-5"></span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Concatenate FastQ files from 1st and 2nd runs</span></span>
<span id="cb5-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Do NOT quote fastq_pattern variable</span></span>
<span id="cb5-9"></span>
<span id="cb5-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Declare an associative array to keep track of processed files</span></span>
<span id="cb5-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">declare</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">processed_files</span></span>
<span id="cb5-12"></span>
<span id="cb5-13"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> first_run_fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/2018OALarvae_DNAm_discovery/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_pattern}</span></span>
<span id="cb5-14"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-15">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Strip full path to just get filename.</span></span>
<span id="cb5-16">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">first_run_fastq_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-17"></span>
<span id="cb5-18">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize a flag to check if a match is found</span></span>
<span id="cb5-19">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">match_found</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>false</span>
<span id="cb5-20"></span>
<span id="cb5-21">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Process second run and concatenate with corresponding FastQ from first run</span></span>
<span id="cb5-22">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Do NOT quote fastq_pattern variable</span></span>
<span id="cb5-23">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> second_run_fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/2018OALarvae_DNAm_discovery/second_lane/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_pattern}</span></span>
<span id="cb5-24">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-25">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Strip full path to just get filename.</span></span>
<span id="cb5-26">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">second_run_fastq_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${second_run_fastq</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-27"></span>
<span id="cb5-28">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Concatenate FastQs with same filenames</span></span>
<span id="cb5-29">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${second_run_fastq_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]]</span></span>
<span id="cb5-30">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb5-31">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Concatenating </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> with </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${second_run_fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> to </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-32">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-33">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${second_run_fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-34">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">match_found</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true</span>
<span id="cb5-35">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">processed_files</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>true</span>
<span id="cb5-36">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">break</span></span>
<span id="cb5-37">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb5-38">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb5-39"></span>
<span id="cb5-40">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If no match is found, copy the file to the target directory</span></span>
<span id="cb5-41">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${match_found}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> false <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]]</span></span>
<span id="cb5-42">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb5-43">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-z</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${processed_files</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq_name}</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]]</span></span>
<span id="cb5-44">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb5-45">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NO MATCH!"</span></span>
<span id="cb5-46">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Copying </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> to </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-47">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-48">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cp</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-49">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">processed_files</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>true</span>
<span id="cb5-50">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb5-51">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb5-52"></span>
<span id="cb5-53">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Generating checksums for concatenated FastQs..."</span></span>
<span id="cb5-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--append</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_run_fastq_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.md5</span>
<span id="cb5-55">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-56">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-57">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-58"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
<section id="trimming-and-error-repair" class="level1">
<h1>5 Trimming and Error Repair</h1>
<p>Trimming will remove any Illumina sequencing adapters, as well as polyG and polyX (primarily polyA) sequences. Trimming will also remove the first 15bp from the 5â€™ end of each read.</p>
<p>Samples generating an error during trimming will attempt to be repaired with BBToolsâ€™ <code>repair.sh</code> script.</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb6-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directory, if it doesn't exist</span></span>
<span id="cb6-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span></span>
<span id="cb6-6"></span>
<span id="cb6-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb6-8"></span>
<span id="cb6-9"></span>
<span id="cb6-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create arrays of fastq R1 files and sample names</span></span>
<span id="cb6-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Do NOT quote R1_fastq_pattern variable</span></span>
<span id="cb6-12"></span>
<span id="cb6-13"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_fastq_pattern}</span></span>
<span id="cb6-14"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb6-15">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb6-16"></span>
<span id="cb6-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use parameter substitution to remove all text up to and including last "." from</span></span>
<span id="cb6-18">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># right side of string.</span></span>
<span id="cb6-19">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R1_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>.<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb6-20"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb6-21"></span>
<span id="cb6-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of fastq R2 files</span></span>
<span id="cb6-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Do NOT quote R2_fastq_pattern variable</span></span>
<span id="cb6-24"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_fastq_pattern}</span></span>
<span id="cb6-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb6-26">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb6-27"></span>
<span id="cb6-28">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use parameter substitution to remove all text up to and including last "." from</span></span>
<span id="cb6-29">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># right side of string.</span></span>
<span id="cb6-30">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R2_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(${fastq</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>.<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">})</span></span>
<span id="cb6-31"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb6-32"></span>
<span id="cb6-33"></span>
<span id="cb6-34"></span>
<span id="cb6-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run fastp on files</span></span>
<span id="cb6-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adds JSON report output for downstream usage by MultiQC</span></span>
<span id="cb6-37"></span>
<span id="cb6-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning fastp trimming."</span></span>
<span id="cb6-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb6-40"></span>
<span id="cb6-41"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> index <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb6-42"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb6-43">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R1_sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb6-44">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R2_sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb6-45">  </span>
<span id="cb6-46">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">stderr_PE_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print $1}'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb6-47">  </span>
<span id="cb6-48">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastp}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-49">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--in1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-50">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--in2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-51">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--detect_adapter_for_pe</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-52">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_poly_g</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-53">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_poly_x</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-54">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--thread</span> 16 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-55">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_front1</span> 15 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-56">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_front2</span> 15 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-57">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--html</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.report.html <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-58">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--json</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.report.json <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-59">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--out1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-60">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--out2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-61">  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_PE_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.stderr</span>
<span id="cb6-62">  </span>
<span id="cb6-63">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--before-context</span> 5 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERROR"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_PE_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.stderr</span>
<span id="cb6-64">  </span>
<span id="cb6-65">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check for fastp errors and then repair</span></span>
<span id="cb6-66">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--quiet</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERROR"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_PE_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.stderr<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb6-67">      </span>
<span id="cb6-68">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz</span>
<span id="cb6-69">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz</span>
<span id="cb6-70">    </span>
<span id="cb6-71">    </span>
<span id="cb6-72">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bbmap_repair}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-73">    in1=<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-74">    in2=<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-75">    out1=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.REPAIRED.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-76">    out2=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.REPAIRED.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-77">    outs=/dev/null <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-78">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.REPAIRED.stderr</span>
<span id="cb6-79">    </span>
<span id="cb6-80">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastp}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--in1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.REPAIRED.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--in2</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.REPAIRED.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--detect_adapter_for_pe</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_poly_g</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_poly_x</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--thread</span> 16 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_front1</span> 15 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-88">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_front2</span> 15 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-89">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--html</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.REPAIRED.report.html <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-90">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--json</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.REPAIRED.report.json <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--out1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.REPAIRED.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--out2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.REPAIRED.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-93">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_PE_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.REPAIRED.stderr</span>
<span id="cb6-94"> </span>
<span id="cb6-95">    </span>
<span id="cb6-96">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--quiet</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERROR"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_PE_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.REPAIRED.stderr<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb6-97">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"These </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_PE_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> samples are broken."</span></span>
<span id="cb6-98">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Just give up.  :("</span></span>
<span id="cb6-99">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb6-100">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb6-101">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb6-102"></span>
<span id="cb6-103">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Finished trimming:"</span></span>
<span id="cb6-104">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb6-105">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb6-106">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb6-107">  </span>
<span id="cb6-108">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate md5 checksums for newly trimmed files</span></span>
<span id="cb6-109">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb6-110">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz.md5</span>
<span id="cb6-111">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.fq.gz.md5</span>
<span id="cb6-112">  </span>
<span id="cb6-113">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb6-114"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
<section id="fastqc" class="level1">
<h1>6 FastQC</h1>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb7-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-5"></span>
<span id="cb7-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN FASTQC ############</span></span>
<span id="cb7-7"></span>
<span id="cb7-8"></span>
<span id="cb7-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of trimmed FastQs</span></span>
<span id="cb7-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trimmed_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(${trimmed_fastq_pattern})</span></span>
<span id="cb7-11"></span>
<span id="cb7-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pass array contents to new variable as space-delimited list</span></span>
<span id="cb7-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trimmed_fastqc_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[*]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb7-14"></span>
<span id="cb7-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning FastQC on trimmed reads..."</span></span>
<span id="cb7-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb7-17"></span>
<span id="cb7-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run FastQC</span></span>
<span id="cb7-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Do NOT quote raw_fastqc_list</span></span>
<span id="cb7-20"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastqc}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-21">--threads <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-22">--outdir <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-23">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-24"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqc_list}</span></span>
<span id="cb7-25"></span>
<span id="cb7-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC on trimmed reads complete!"</span></span>
<span id="cb7-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb7-28"></span>
<span id="cb7-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> FASTQC ############</span></span></code></pre></div>
</section>
<section id="multiqc" class="level1">
<h1>7 MultiQC</h1>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb8-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb8-3"></span>
<span id="cb8-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb8-5"></span>
<span id="cb8-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${multiqc}</span> .</span></code></pre></div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>There are two files which have excessive polyG sequences after trimming, despite specifying <a href="https://github.com/OpenGene/fastp"><code>fastp</code></a> to trim polyG sequences</p>
<ul>
<li><code>CF03-CM03-Zygote_R1</code></li>
<li><code>EF04-EM04-Zygote_R1</code></li>
</ul>
<p>Each of the corresponging R2 samples has excessive polyA sequences present.</p>
</div>
</div>
<div id="fig-CF03_CM03_R1_polyG" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="FastQC adaptor sequences plot showing excessive polyG sequences in CF03-CM03-Zygote_R1.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-CF03_CM03_R1_polyG-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241115-cvir-trimming-fastqc-CF03-CM03-Zygote_R1-adaptor.plot.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: FastQC adaptor sequences plot showing excessive polyG sequences in CF03-CM03-Zygote_R1."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-11-15-Trimming-and-QC---C.virginica-CEASMALLR-FastQs-Using-fastp-BBTools-and-FastQC-MultiQC/20241115-cvir-trimming-fastqc-CF03-CM03-Zygote_R1-adaptor.plot.png" class="img-fluid figure-img" alt="FastQC adaptor sequences plot showing excessive polyG sequences in CF03-CM03-Zygote_R1."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-CF03_CM03_R1_polyG-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: FastQC adaptor sequences plot showing excessive polyG sequences in CF03-CM03-Zygote_R1.
</figcaption>
</figure>
</div>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ewels2016" class="csl-entry">
Ewels, Philip, MÃ¥ns Magnusson, Sverker Lundin, and Max KÃ¤ller. 2016. â€œMultiQC: Summarize Analysis Results for Multiple Tools and Samples in a Single Report.â€ <em>Bioinformatics</em> 32 (19): 3047â€“48. <a href="https://doi.org/10.1093/bioinformatics/btw354" class="uri">https://doi.org/10.1093/bioinformatics/btw354</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2024</category>
  <category>trimming</category>
  <category>FastQC</category>
  <category>fastp</category>
  <category>BBTools</category>
  <category>MultiQC</category>
  <category>Crassostrea virginica</category>
  <category>WGBS</category>
  <category>BS-seq</category>
  <category>bisulfite</category>
  <category>Eastern oyster</category>
  <category>ceasmallr</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-15-Trimming-and-QC---C.virginica-CEASMALLR-FastQs-Using-fastp-BBTools-and-FastQC-MultiQC/</guid>
  <pubDate>Fri, 15 Nov 2024 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Taxonomic Classification - Trinity Assembly of Unmapped P.helianthoides RNA-seq Using DIAMOND BLASTx and MEGAN6 on Mox</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-08-Taxonomic-Classification---Trinity-Assembly-of-Unmapped-P.helianthoides-RNA-seq-Using-DIAMOND-BLASTx-and-MEGAN6-on-Mox/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>In preparation for a grant proposal involving sea star wasting disease, due in about two weeks, Steven <a href="https://github.com/RobertsLab/resources/issues/2022">asked that I perform taxonomic classification on a Trinity assembly of unmapped P.helanthoides RNA-seq reads</a> (GitHub Issue). This was to compare to the results of <a href="../../../posts/2024/2024-11-05-Sequencing-Read-Taxonomic-Classification---Unmapped-P.helanthoides-RNA-seq-Using-DIAMOND-BLASTx-and-MEGAN6-on-Mox/index.html">classifying just the unmapped reads</a> (Notebook). Due to time constraints, and a bit of luck, I opted to run this on Mox (Mox <em>should</em> have been decommissioned on 11/1/2024, but itâ€™s still running and being able to use Mox, which is already set up, instead of resorting to Klone, was much faster to get this going).</p>
</section>
<section id="methods" class="level1">
<h1>METHODS</h1>
<section id="diamond-blastx-and-meganization" class="level2">
<h2 class="anchored" data-anchor-id="diamond-blastx-and-meganization">DIAMOND BLASTx and MEGANization</h2>
<p>The Trinitay assembly FastA was <a href="https://github.com/bbuchfink/diamond"><code>DIAMOND</code></a> BLASTxâ€™d against a previously constructed DIAMON BLAST database. Since this was using an assembly and not individual sequencing reads, I used the <code>--long-reads</code> option. After <a href="https://github.com/bbuchfink/diamond"><code>DIAMOND</code></a> BLASTx, the resulting DAA files were â€œMEGANizedâ€ in preparation for use in <a href="https://software-ab.cs.uni-tuebingen.de/download/megan6/welcome.html">MEGAN6</a>. Both steps were run on Mox.</p>
<section id="sbatch-script" class="level3">
<h3 class="anchored" data-anchor-id="sbatch-script">SBATCH SCRIPT</h3>
<p>GitHub:</p>
<ul>
<li><a href="../../../sbatch_scripts/20241108-phel-diamond-meganizer-trinity_unmapped.sh">20241108-phel-diamond-meganizer-trinity_unmapped.sh</a></li>
</ul>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Job Name</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --job-name=20241108-phel-diamond-meganizer-trinity_unmapped</span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Allocation Definition</span></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --account=srlab</span></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --partition=srlab</span></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Resources</span></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Nodes</span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --nodes=1</span></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Walltime (days-hours:minutes:seconds format)</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --time=3-00:00:00</span></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Memory per node</span></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mem=120G</span></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##turn on e-mail notification</span></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-type=ALL</span></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-user=samwhite@uw.edu</span></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Specify the working directory for this job</span></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --chdir=/gscratch/scrubbed/samwhite/outputs/20241108-phel-diamond-meganizer-trinity_unmapped</span></span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Perform DIAMOND BLASTx on Trinity assembly of unmapped P.helanthoides RNA-seq reads from  Steven.</span></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Run with the --long-reads option due to using assembled reads.</span></span>
<span id="cb1-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Will be used to view taxonomic breakdown.</span></span>
<span id="cb1-23"></span>
<span id="cb1-24"></span>
<span id="cb1-25"></span>
<span id="cb1-26"></span>
<span id="cb1-27"></span>
<span id="cb1-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################</span></span>
<span id="cb1-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># These variables need to be set by user</span></span>
<span id="cb1-30"></span>
<span id="cb1-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Assign Variables</span></span>
<span id="cb1-32"></span>
<span id="cb1-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Program paths</span></span>
<span id="cb1-34"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">diamond</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/gscratch/srlab/programs/diamond-v2.1.1/diamond</span>
<span id="cb1-35"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">meganizer</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/gscratch/srlab/programs/MEGAN-6.22.0/tools/daa-meganizer</span>
<span id="cb1-36"></span>
<span id="cb1-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># DIAMOND NCBI nr database</span></span>
<span id="cb1-38"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dmnd_db</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/gscratch/srlab/blastdbs/20230215-ncbi-nr/20230215-ncbi-nr.dmnd</span>
<span id="cb1-39"></span>
<span id="cb1-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># MEGAN mapping files</span></span>
<span id="cb1-41"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">megan_mapping_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/gscratch/srlab/sam/data/databases/MEGAN</span>
<span id="cb1-42"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">megan_mapdb</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${megan_mapping_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/megan-map-Feb2022.db"</span></span>
<span id="cb1-43"></span>
<span id="cb1-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># CPU threads</span></span>
<span id="cb1-45"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">threads</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>40</span>
<span id="cb1-46"></span>
<span id="cb1-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># MEGAN memory limit</span></span>
<span id="cb1-48"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mem_limit</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>100G</span>
<span id="cb1-49"></span>
<span id="cb1-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Programs associative array</span></span>
<span id="cb1-51"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">declare</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span></span>
<span id="cb1-52"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb1-53"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>diamond<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${diamond}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-54"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">meganizer</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${meganizer}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-55"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-56"></span>
<span id="cb1-57"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################################</span></span>
<span id="cb1-58"></span>
<span id="cb1-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Exit script if any command fails</span></span>
<span id="cb1-60"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span></span>
<span id="cb1-61"></span>
<span id="cb1-62"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load Python Mox module for Python module availability</span></span>
<span id="cb1-63"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load intel-python3_2017</span>
<span id="cb1-64"></span>
<span id="cb1-65"></span>
<span id="cb1-66"></span>
<span id="cb1-67"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run DIAMOND BLASTx, followed by "MEGANization"</span></span>
<span id="cb1-68"></span>
<span id="cb1-69"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run DIAMOND with blastx</span></span>
<span id="cb1-70"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output format 100 produces a DAA binary file for use with MEGAN</span></span>
<span id="cb1-71"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Running DIAMOND BLASTx on </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">."</span></span>
<span id="cb1-72"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-73"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>diamond<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> blastx <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-74">--db <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${dmnd_db}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-75">--query Trinity.fasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-76">--out Trinity.fasta-phel-unmapped.blastx.meganized.daa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-77">--long-reads <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-78">--outfmt 100 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-79">--top 5 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-80">--block-size 15.0 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-81">--index-chunks 4 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-82">--memory-limit <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${mem_limit}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-83">--threads <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span></span>
<span id="cb1-84"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DIAMOND BLASTx complete: Trinity.fasta-phel-unmapped.blastx.meganized.daa"</span></span>
<span id="cb1-85"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-86"></span>
<span id="cb1-87"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Meganize DAA files</span></span>
<span id="cb1-88"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Used for ability to import into MEGAN6</span></span>
<span id="cb1-89"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Now MEGANizing Trinity.fasta-phel-unmapped.blastx.meganized.daa"</span></span>
<span id="cb1-90"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>meganizer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-91">--in Trinity.fasta-phel-unmapped.blastx.meganized.daa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-92">--threads <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-93">--mapDB <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${megan_mapdb}</span></span>
<span id="cb1-94"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MEGANization of Trinity.fasta-phel-unmapped.blastx.meganized.daa completed."</span></span>
<span id="cb1-95"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-96"></span>
<span id="cb1-97"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate MD5 checksums</span></span>
<span id="cb1-98"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb1-99"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb1-100">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"checksums.md5"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb1-101">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-102">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Generating MD5 checksums for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:"</span></span>
<span id="cb1-103">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--append</span> checksums.md5</span>
<span id="cb1-104">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-105">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb1-106"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb1-107"></span>
<span id="cb1-108"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate checksum for MEGAN database(s)</span></span>
<span id="cb1-109"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-110">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${megan_mapdb}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-111">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${dmnd_db}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-112"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> checksums.md5</span>
<span id="cb1-113"></span>
<span id="cb1-114"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#######################################################################################################</span></span>
<span id="cb1-115"></span>
<span id="cb1-116"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Capture program options</span></span>
<span id="cb1-117"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-gt</span> 0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb1-118">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Logging program options..."</span></span>
<span id="cb1-119">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> program <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-120">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb1-121">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-122">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Program options for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">: "</span></span>
<span id="cb1-123">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-124">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle samtools help menus</span></span>
<span id="cb1-125">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_index"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-126">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_sort"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-127">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_view"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]]</span></span>
<span id="cb1-128">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb1-129">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-130"></span>
<span id="cb1-131">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle DIAMOND BLAST menu</span></span>
<span id="cb1-132">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"diamond"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb1-133">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> help</span>
<span id="cb1-134"></span>
<span id="cb1-135">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle NCBI BLASTx menu</span></span>
<span id="cb1-136">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blastx"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb1-137">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-help</span></span>
<span id="cb1-138">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb1-139">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-h</span></span>
<span id="cb1-140">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-141">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-142">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"----------------------------------------------"</span></span>
<span id="cb1-143">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-144">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-145">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&gt;&gt;</span> program_options.log <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb1-146"></span>
<span id="cb1-147">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If MultiQC is in programs_array, copy the config file to this directory.</span></span>
<span id="cb1-148">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"multiqc"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb1-149">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cp</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--preserve</span> ~/.multiqc_config.yaml multiqc_config.yaml</span>
<span id="cb1-150">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb1-151">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb1-152">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Finished logging programs options."</span></span>
<span id="cb1-153">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-154"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb1-155"></span>
<span id="cb1-156"></span>
<span id="cb1-157"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Document programs in PATH (primarily for program version ID)</span></span>
<span id="cb1-158"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Logging system </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$PATH</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">..."</span></span>
<span id="cb1-159"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-160"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">date</span></span>
<span id="cb1-161"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-162"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"System PATH for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$SLURM_JOB_ID</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-163"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-164"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%0.s-"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">..</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-165"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${PATH}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tr</span> : <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\\</span>n</span>
<span id="cb1-166"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> system_path.log</span>
<span id="cb1-167"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Finished logging system </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$PATH</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">."</span></span></code></pre></div>
</section>
</section>
<section id="daa-to-rma-conversion" class="level2">
<h2 class="anchored" data-anchor-id="daa-to-rma-conversion">DAA to RMA Conversion</h2>
<p>Resulting DAA file was converted to RMA6 format for import and analysis in MEGAN6. Due to time constraints, this was performed on Raven without a script. Command used:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/megan-6.24.20/tools/daa2rma</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-2">--in ./Trinity.fasta-phel-unmapped.blastx.meganized.daa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-3">--mapDB ~/data/databases/MEGAN/megan-map-Feb2022.db <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-4">--out ./Trinity.fasta-phel-unmapped.blastx.meganized.daa.rma6 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-5">--threads 40 <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--append</span> daa2rma_log.txt</span></code></pre></div>
</section>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<p>The Mox run took just under 2hrs to complete:</p>
<div id="fig-mox_runtime" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="Screencap showing Mox runtime of 1hrs 43mins and 07secs for DIAMOND BLASTx.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mox_runtime-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241108-phel-mox-runtime.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Screencap showing Mox runtime of 1hrs 43mins and 07secs for DIAMOND BLASTx."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-11-08-Taxonomic-Classification---Trinity-Assembly-of-Unmapped-P.helianthoides-RNA-seq-Using-DIAMOND-BLASTx-and-MEGAN6-on-Mox/20241108-phel-mox-runtime.png" class="img-fluid figure-img" alt="Screencap showing Mox runtime of 1hrs 43mins and 07secs for DIAMOND BLASTx."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mox_runtime-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Screencap showing Mox runtime of 1hrs 43mins and 07secs for DIAMOND BLASTx.
</figcaption>
</figure>
</div>
</section>
<section id="discussion" class="level1">
<h1>DISCUSSION</h1>
<p>Looking at the entire taxonomies, down to the species level, most of the asembled reads get assigned to <a href="https://en.wikipedia.org/wiki/Common_starfish"><em>Asterias rubens</em></a> (Wikipedia), the common sea star. This is the same as we saw when we performed this on just <a href="../../../posts/2024/2024-10-05-FastQC-Trimming-and-QC---A.pulchra-RNA-seq-from-Azenta-Project-30-1047560508-Using-fastp/index.html">the RNA-seq reads</a>. This is surprising, as Iâ€™m fairly certain these sequencing reads came from <a href="https://en.wikipedia.org/wiki/Sunflower_sea_star"><em>Pycnopodia helianthoides</em></a> (Wikipedia), the sunflower star. Of course, these results are also dependent upon how much sequence data in NCBI for any given species. However, with that said, sequences are only assigned to a given taxonomic level based on the BLASTx results. Thus, even if a sequence comes from a sea star, it would (should?) <em>not</em> get assigned to a particular species unless the BLASTx confidence was <em>very</em> highâ€¦</p>
<p>Looking at the highest read assignments for non-eukaryotic species, we see that of the Bacteria (7,153 reads), <a href="https://link.springer.com/article/10.1007/s10482-019-01348-7"><em>Bacillus yapensis</em></a> (Journal article website), while in Archae (17,742 reads), <a href="https://en.wikipedia.org/wiki/Methanocaldococcus_jannaschii"><em>Methanocaldococcus jannaschii</em></a> (Wikipedia) had the most reads assigned.</p>
<div id="fig-mox_runtime" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="MEGAN6 taxonomic heat map of assignments down to species level. Darkest green box shows highest numbers of sequences assigned to _Asterias rubens_.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mox_runtime-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./Trinity.fasta-phel-unmapped.blastx.meganized.daa-heatmap-all.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: MEGAN6 taxonomic heat map of assignments down to Species level. Darkest green box shows highest numbers of sequences assigned to Asterias rubens."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-11-08-Taxonomic-Classification---Trinity-Assembly-of-Unmapped-P.helianthoides-RNA-seq-Using-DIAMOND-BLASTx-and-MEGAN6-on-Mox/Trinity.fasta-phel-unmapped.blastx.meganized.daa-heatmap-all.jpg" class="img-fluid figure-img" alt="MEGAN6 taxonomic heat map of assignments down to species level. Darkest green box shows highest numbers of sequences assigned to _Asterias rubens_."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mox_runtime-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: MEGAN6 taxonomic heat map of assignments down to Species level. Darkest green box shows highest numbers of sequences assigned to <em>Asterias rubens</em>.
</figcaption>
</figure>
</div>
<section id="output-files" class="level2">
<h2 class="anchored" data-anchor-id="output-files">Output files</h2>
<p>Output directory:</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/20241108-phel-diamond-meganizer-trinity_unmapped/">https://gannet.fish.washington.edu/Atumefaciens/20241108-phel-diamond-meganizer-trinity_unmapped/</a></li>
</ul>
<section id="diamond-blastxmeganizer" class="level3">
<h3 class="anchored" data-anchor-id="diamond-blastxmeganizer">DIAMOND BLASTX/MEGANIZER</h3>
<p>Output files:</p>
<ul>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20241108-phel-diamond-meganizer-trinity_unmapped/Trinity.fasta-phel-unmapped.blastx.meganized.daa"><code>Trinity.fasta-phel-unmapped.blastx.meganized.daa</code></a> (211MB)</p>
<ul>
<li>MD5: <code>c9eb53478aa937ea7e094e023895918c</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20241108-phel-diamond-meganizer-trinity_unmapped/checksums.md5"><code>checksums.md5</code></a></p></li>
</ul>
</section>
<section id="rma6" class="level3">
<h3 class="anchored" data-anchor-id="rma6">RMA6</h3>
<ul>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20241108-phel-diamond-meganizer-trinity_unmapped/Trinity.fasta-phel-unmapped.blastx.meganized.daa.rma6"><code>Trinity.fasta-phel-unmapped.blastx.meganized.daa.rma6</code></a></p>
<ul>
<li>MD5: <code>50f150a9ce97034ffd5bad54b4017903</code></li>
</ul></li>
</ul>


</section>
</section>
</section>

 ]]></description>
  <category>2024</category>
  <category>DIAMOND</category>
  <category>BLASTx</category>
  <category>MEGAN6</category>
  <category>Pycnopodia helianthoides</category>
  <category>sunflower sea star</category>
  <category>Mox</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-08-Taxonomic-Classification---Trinity-Assembly-of-Unmapped-P.helianthoides-RNA-seq-Using-DIAMOND-BLASTx-and-MEGAN6-on-Mox/</guid>
  <pubDate>Fri, 08 Nov 2024 08:00:00 GMT</pubDate>
  <media:content url="https://robertslab.github.io/sams-notebook/posts/2024/2024-11-08-Taxonomic-Classification---Trinity-Assembly-of-Unmapped-P.helianthoides-RNA-seq-Using-DIAMOND-BLASTx-and-MEGAN6-on-Mox/Trinity.fasta-phel-unmapped.blastx.meganized.daa-heatmap-all.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>FastQ QC - M.trossulus WGBS from Psomagen Using FastQC and MultiQC</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-07-FastQ-QC---M.trossulus-WGBS-from-Psomagen-Using-FastQC-and-MultiQC/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>This is part of Chrisâ€™ <a href="https://github.com/RobertsLab/project-mytilus-methylation">project-mytilus-methylation</a>(GitHub repo). Data was received from Psomagen on <a href="../../../posts/2024/2024-11-01-Data-Received---Mytilus-trossulus-WGBS-Data-from-Psomagen/index.html">20241101</a> (Notebook entry). I performed the initial QC using <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/"><code>FastQC</code></a> and <a href="https://multiqc.info/"><code>MultiQC</code></a>. Iâ€™ll add this info to <a href="https://b.link/nightingales"><code>Nightingales</code></a> (Google Sheet).</p>
<p>A full backup of this repo, including large files is available here:</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/gitrepos/project-mytilus-methylation/">https://gannet.fish.washington.edu/Atumefaciens/gitrepos/project-mytilus-methylation/</a></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This notebook is markdown knitted from <a href="https://github.com/RobertsLab/project-mytilus-methylation/blob/b352e666f21e6e39f5843fd886e3502bf3b754ba/code/00.00-WGBSseq-reads-FastQC-MultiQC.Rmd"><code>00.00-WGBSseq-reads-FastQC-MultiQC.Rmd</code></a> (commit <code>b352e66</code>).</p>
</div>
</div>
<p>This Rmd file will download raw WGBSseq FastQs and evaluate them using <a href="https://github.com/s-andrews/FastQC">FastQC</a> and <a href="https://multiqc.info/">MultiQC</a>(Ewels et al.&nbsp;2016).</p>
</section>
<section id="create-a-bash-variables-file" class="level1">
<h1>1 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export output_dir_top="../output/00.00-WGBSseq-reads-FastQC-MultiQC"'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_fastqc_dir="${output_dir_top}/raw-fastqc"'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_dir="../data/raw-wgbs"'</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_url="https://owl.fish.washington.edu/nightingales/M_trossulus/"'</span></span>
<span id="cb1-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-11"></span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set FastQ filename patterns"</span></span>
<span id="cb1-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export fastq_pattern='*.fastq.gz'"</span></span>
<span id="cb1-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R1_fastq_pattern='*_1.fastq.gz'"</span></span>
<span id="cb1-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R2_fastq_pattern='*_2.fastq.gz'"</span></span>
<span id="cb1-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-18"></span>
<span id="cb1-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set number of CPUs to use"</span></span>
<span id="cb1-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=50'</span></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-22"></span>
<span id="cb1-23"></span>
<span id="cb1-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"## Inititalize arrays"</span></span>
<span id="cb1-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R1=()'</span></span>
<span id="cb1-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R2=()'</span></span>
<span id="cb1-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_fastqs_array=()'</span></span>
<span id="cb1-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R1_names_array=()'</span></span>
<span id="cb1-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R2_names_array=()'</span></span>
<span id="cb1-30"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-31"></span>
<span id="cb1-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Print formatting"</span></span>
<span id="cb1-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-35"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-36"></span>
<span id="cb1-37"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export output_dir_top="../output/00.00-WGBSseq-reads-FastQC-MultiQC"
export raw_fastqc_dir="${output_dir_top}/raw-fastqc"
export raw_reads_dir="../data/raw-wgbs"
export raw_reads_url="https://owl.fish.washington.edu/nightingales/M_trossulus/"

# Set FastQ filename patterns
export fastq_pattern='*.fastq.gz'
export R1_fastq_pattern='*_1.fastq.gz'
export R2_fastq_pattern='*_2.fastq.gz'

# Set number of CPUs to use
export threads=50

## Inititalize arrays
export fastq_array_R1=()
export fastq_array_R2=()
export raw_fastqs_array=()
export R1_names_array=()
export R2_names_array=()

# Print formatting
export line="--------------------------------------------------------"</code></pre>
</section>
<section id="download-raw-fastqs" class="level1">
<h1>2 Download raw FastQs</h1>
<section id="download-raw-reads" class="level2">
<h2 class="anchored" data-anchor-id="download-raw-reads">2.1 Download raw reads</h2>
<p>Reads are downloaded from <a href="https://owl.fish.washington.edu/nightingales/M_trossulus/" class="uri">https://owl.fish.washington.edu/nightingales/M_trossulus/</a></p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directory if it doesn't exist</span></span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span></span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run wget to retrieve FastQs and MD5 files</span></span>
<span id="cb3-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-9">--directory-prefix <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-10">--recursive <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-11">--no-check-certificate <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-12">--continue <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-13">--cut-dirs 3 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-14">--no-host-directories <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-15">--no-parent <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-16">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-17">--level=1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-18">--accept <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[0-9]M*.fastq.gz,[0-9]M*.fastq.gz.md5sum"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-19"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_url}</span></span></code></pre></div>
</section>
<section id="verify-raw-read-checksums" class="level2">
<h2 class="anchored" data-anchor-id="verify-raw-read-checksums">2.2 Verify raw read checksums</h2>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb4-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb4-5"></span>
<span id="cb4-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Checksums file contains other files, so this just looks for the sRNAseq files.</span></span>
<span id="cb4-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.md5sum</span>
<span id="cb4-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb4-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--check</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb4-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
</section>
<section id="fastqcmultiqc-on-raw-reads" class="level1">
<h1>3 FastQC/MultiQC on raw reads</h1>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directory if it doesn't exist</span></span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN FASTQC ############</span></span>
<span id="cb5-8"></span>
<span id="cb5-9"></span>
<span id="cb5-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of trimmed FastQs</span></span>
<span id="cb5-11"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">raw_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(${raw_reads_dir}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_pattern})</span></span>
<span id="cb5-12"></span>
<span id="cb5-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pass array contents to new variable as space-delimited list</span></span>
<span id="cb5-14"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">raw_fastqc_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[*]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-15"></span>
<span id="cb5-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning FastQC on raw reads..."</span></span>
<span id="cb5-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-18"></span>
<span id="cb5-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run FastQC</span></span>
<span id="cb5-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Do NOT quote raw_fastqc_list</span></span>
<span id="cb5-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fastqc</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-22">--threads <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-23">--outdir <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-24">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-25"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_list}</span></span>
<span id="cb5-26"></span>
<span id="cb5-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC on raw reads complete!"</span></span>
<span id="cb5-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-29"></span>
<span id="cb5-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> FASTQC ############</span></span>
<span id="cb5-31"></span>
<span id="cb5-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN MULTIQC ############</span></span>
<span id="cb5-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning MultiQC on raw FastQC..."</span></span>
<span id="cb5-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-35"></span>
<span id="cb5-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">multiqc</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span></span>
<span id="cb5-37"></span>
<span id="cb5-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MultiQC on raw FastQs complete."</span></span>
<span id="cb5-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-41"></span>
<span id="cb5-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> MULTIQC ############</span></span>
<span id="cb5-43"></span>
<span id="cb5-44"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Removing FastQC zip files."</span></span>
<span id="cb5-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-46"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.zip</span>
<span id="cb5-47"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC zip files removed."</span></span>
<span id="cb5-48"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-49"></span>
<span id="cb5-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># View directory contents</span></span>
<span id="cb5-51"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_fastqc_dir}</span></span></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ewels2016" class="csl-entry">
Ewels, Philip, MÃ¥ns Magnusson, Sverker Lundin, and Max KÃ¤ller. 2016. â€œMultiQC: Summarize Analysis Results for Multiple Tools and Samples in a Single Report.â€ <em>Bioinformatics</em> 32 (19): 3047â€“48. <a href="https://doi.org/10.1093/bioinformatics/btw354" class="uri">https://doi.org/10.1093/bioinformatics/btw354</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2024</category>
  <category>Mytilus trossulus</category>
  <category>WGBS</category>
  <category>Psomagen</category>
  <category>FastQC</category>
  <category>MultiQC</category>
  <category>mussel</category>
  <category>project-mytilus-methylation</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-07-FastQ-QC---M.trossulus-WGBS-from-Psomagen-Using-FastQC-and-MultiQC/</guid>
  <pubDate>Thu, 07 Nov 2024 08:00:00 GMT</pubDate>
  <media:content url="https://robertslab.github.io/sams-notebook/posts/2024/2024-11-07-FastQ-QC---M.trossulus-WGBS-from-Psomagen-Using-FastQC-and-MultiQC/20241107-mtro-screenshot-fastqc-example.png" medium="image" type="image/png" height="68" width="144"/>
</item>
<item>
  <title>Trimming and QC - M.trossulus WGBS Using fastp and FastQC-MultiQC</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-07-Trimming-and-QC---M.trossulus-WGBS-Using-fastp-and-FastQC-MultiQC/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>This is part of Chrisâ€™ <a href="https://github.com/RobertsLab/project-mytilus-methylation">project-mytilus-methylation</a>(GitHub repo). Data was received from Psomagen on <a href="../../../posts/2024/2024-11-01-Data-Received---Mytilus-trossulus-WGBS-Data-from-Psomagen/index.html">20241101</a> (Notebook entry). I performed the initial QC using <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/"><code>FastQC</code></a> and <a href="https://multiqc.info/"><code>MultiQC</code></a> <a href="../../../posts/2024/2024-11-07-FastQ-QC---M.trossulus-WGBS-from-Psomagen-Using-FastQC-and-MultiQC/index.html">earlier today</a> (Notebook entry).</p>
<p>Samples were trimmed using <a href="https://github.com/OpenGene/fastp"><code>fastp</code></a>, followed by QC with <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/"><code>FastQC</code></a> and <a href="https://multiqc.info/"><code>MultiQC</code></a>.</p>
<p>A full backup of this repo, including large files, is available here:</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/gitrepos/project-mytilus-methylation/">https://gannet.fish.washington.edu/Atumefaciens/gitrepos/project-mytilus-methylation/</a></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This notebook is markdown knitted from <a href="https://github.com/RobertsLab/project-mytilus-methylation/blob/086a277968ccc4452ebe6dfca468e762a9557cef/code/00.10-trimming-fastp-FastQC-MultiQC.Rmd"><code>00.10-trimming-fastp-FastQC-MultiQC.Rmd</code></a> (commit <code>086a277</code>).</p>
</div>
</div>
<hr>
<p>This Rmd file trims WGBS-seq files using <a href="https://github.com/OpenGene/fastp">fastp</a> (Chen 2023), followed by quality checks with <a href="https://github.com/s-andrews/FastQC">FastQC</a> and <a href="https://multiqc.info/">MultiQC</a>(Ewels et al.&nbsp;2016).</p>
<p>Expects input files formatted like so: <code>&lt;number&gt;M_[12].fastq.gz</code></p>
<p>All trimmed FastQs produced by this script are here:</p>
<p><a href="https://gannet.fish.washington.edu/Atumefaciens/gitrepos/project-mytilus-methylation/output/00.10-trimming-fastp-FastQC-MultiQC/trimmed-fastqs/">00.10-trimming-fastp-FastQC-MultiQC/trimmed-fastqs/</a></p>
</section>
<section id="create-a-bash-variables-file" class="level1">
<h1>1 Create a Bash variables file</h1>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export repo_dir="/gscratch/scrubbed/samwhite/gitrepos/project-mytilus-methylation"'</span></span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export output_dir_top="${repo_dir}/output/00.10-trimming-fastp-FastQC-MultiQC"'</span></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_dir="${repo_dir}/data/raw-wgbs"'</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_url="https://owl.fish.washington.edu/nightingales/M_trossulus/"'</span></span>
<span id="cb1-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export trimmed_fastqs_dir=${output_dir_top}/trimmed-fastqs'</span></span>
<span id="cb1-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export trimmed_fastqc_dir=${output_dir_top}/trimmed-fastqc'</span></span>
<span id="cb1-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-13"></span>
<span id="cb1-14"></span>
<span id="cb1-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set FastQ filename patterns"</span></span>
<span id="cb1-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export fastq_pattern='*.fastq.gz'"</span></span>
<span id="cb1-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R1_fastq_pattern='*_1.fastq.gz'"</span></span>
<span id="cb1-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export R2_fastq_pattern='*_2.fastq.gz'"</span></span>
<span id="cb1-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export trimmed_fastq_pattern='*fastp-trim.fq.gz'"</span></span>
<span id="cb1-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-21"></span>
<span id="cb1-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set number of CPUs to use"</span></span>
<span id="cb1-23"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=50'</span></span>
<span id="cb1-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-25"></span>
<span id="cb1-26"></span>
<span id="cb1-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"## Inititalize arrays"</span></span>
<span id="cb1-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R1=()'</span></span>
<span id="cb1-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastq_array_R2=()'</span></span>
<span id="cb1-30"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_fastqs_array=()'</span></span>
<span id="cb1-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R1_names_array=()'</span></span>
<span id="cb1-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export R2_names_array=()'</span></span>
<span id="cb1-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-34"></span>
<span id="cb1-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Print formatting"</span></span>
<span id="cb1-36"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export line="--------------------------------------------------------"'</span></span>
<span id="cb1-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-38"></span>
<span id="cb1-39"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-40"></span>
<span id="cb1-41"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<pre><code>#### Assign Variables ####

# Data directories
export repo_dir="/gscratch/scrubbed/samwhite/gitrepos/project-mytilus-methylation"
export output_dir_top="${repo_dir}/output/00.10-trimming-fastp-FastQC-MultiQC"
export raw_reads_dir="${repo_dir}/data/raw-wgbs"
export raw_reads_url="https://owl.fish.washington.edu/nightingales/M_trossulus/"
export trimmed_fastqs_dir=${output_dir_top}/trimmed-fastqs
export trimmed_fastqc_dir=${output_dir_top}/trimmed-fastqc

# Set FastQ filename patterns
export fastq_pattern='*.fastq.gz'
export R1_fastq_pattern='*_1.fastq.gz'
export R2_fastq_pattern='*_2.fastq.gz'
export trimmed_fastq_pattern='*fastp-trim.fq.gz'

# Set number of CPUs to use
export threads=50

## Inititalize arrays
export fastq_array_R1=()
export fastq_array_R2=()
export raw_fastqs_array=()
export R1_names_array=()
export R2_names_array=()

# Print formatting
export line="--------------------------------------------------------"</code></pre>
<p>If needed, download raw FastQs.</p>
<p>Change <code>eval=FALSE</code> to <code>eval=TRUE</code> to execute the next two chunks to download RNA-seq and then verify MD5 checksums.</p>
<p>Reads are downloaded from <a href="https://owl.fish.washington.edu/nightingales/M_trossulus/" class="uri">https://owl.fish.washington.edu/nightingales/M_trossulus/</a></p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directory if it doesn't exist</span></span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span></span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run wget to retrieve FastQs and MD5 files</span></span>
<span id="cb3-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-9">--directory-prefix <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-10">--recursive <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-11">--no-check-certificate <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-12">--continue <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-13">--cut-dirs 3 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-14">--no-host-directories <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-15">--no-parent <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-16">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-17">--level=1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-18">--accept <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[0-9]M*.fastq.gz,[0-9]M*.fastq.gz.md5sum"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-19"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_url}</span></span>
<span id="cb3-20"></span>
<span id="cb3-21"></span>
<span id="cb3-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<p>Verify raw read checksums</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb4-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb4-5"></span>
<span id="cb4-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Checksums file contains other files, so this just looks for the sRNAseq files.</span></span>
<span id="cb4-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.md5sum</span>
<span id="cb4-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb4-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--check</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb4-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
<section id="fastp-trimming" class="level1">
<h1>2 Fastp Trimming</h1>
<p><a href="https://github.com/OpenGene/fastp">fastp</a> (Chen 2023) is set to auto-detect Illumina adapters, as well as trim the first 20bp from each read, as past experience shows these first 20bp are more inconsistent than the remainder of the read length.</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directories, if it doesn't exist</span></span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change to raw reads directory</span></span>
<span id="cb5-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-9"></span>
<span id="cb5-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create arrays of fastq R1 files and sample names</span></span>
<span id="cb5-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_fastq_pattern}</span></span>
<span id="cb5-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-13">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-14">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R1_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print $1}'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-15"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb5-16"></span>
<span id="cb5-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of fastq R2 files</span></span>
<span id="cb5-18"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_fastq_pattern}</span></span>
<span id="cb5-19"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-20">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-21">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R2_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print $1}'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-22"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb5-23"></span>
<span id="cb5-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create list of fastq files used in analysis</span></span>
<span id="cb5-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create MD5 checksum for reference</span></span>
<span id="cb5-26"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">!</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-f</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/raw-fastq-checksums.md5 <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb5-27">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.gz</span>
<span id="cb5-28">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-29">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir_top}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/raw-fastq-checksums.md5</span>
<span id="cb5-30">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb5-31"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb5-32"></span>
<span id="cb5-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run fastp on files</span></span>
<span id="cb5-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adds JSON report output for downstream usage by MultiQC</span></span>
<span id="cb5-35"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> index <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-36"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-37">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R1_sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-38">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R2_sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_names_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-39">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-40">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-41">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fastp</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-42">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--in1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-43">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--in2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-44">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--detect_adapter_for_pe</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-45">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_front1</span> 20 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-46">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--trim_front2</span> 20 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-47">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--thread</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-48">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--html</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.report.html <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-49">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--json</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fastp-trim.report.json <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-50">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--out1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_R1.fastp-trim.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-51">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--out2</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_R2.fastp-trim.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-52">  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/fastp.stderr</span>
<span id="cb5-53"></span>
<span id="cb5-54">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate md5 checksums for newly trimmed files</span></span>
<span id="cb5-55">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_R1.fastp-trim.fq.gz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_R1.fastp-trim.fq.gz.md5</span>
<span id="cb5-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_R2.fastp-trim.fq.gz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_R2.fastp-trim.fq.gz.md5</span>
<span id="cb5-58">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb5-59"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
<section id="quality-check-with-fastqc-and-multiqc" class="level1">
<h1>3 Quality Check with FastQC and MultiQC</h1>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb6-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb6-3"></span>
<span id="cb6-4"></span>
<span id="cb6-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN FASTQC ############</span></span>
<span id="cb6-6"></span>
<span id="cb6-7"></span>
<span id="cb6-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of trimmed FastQs</span></span>
<span id="cb6-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trimmed_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(${trimmed_fastqs_dir}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastq_pattern})</span></span>
<span id="cb6-10"></span>
<span id="cb6-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pass array contents to new variable as space-delimited list</span></span>
<span id="cb6-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trimmed_fastqc_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[*]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb6-13"></span>
<span id="cb6-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning FastQC on trimmed reads..."</span></span>
<span id="cb6-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb6-16"></span>
<span id="cb6-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run FastQC</span></span>
<span id="cb6-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Do NOT quote raw_fastqc_list</span></span>
<span id="cb6-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fastqc</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-20">--threads <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-21">--outdir <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-22">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-23"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqc_list}</span></span>
<span id="cb6-24"></span>
<span id="cb6-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC on trimmed reads complete!"</span></span>
<span id="cb6-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb6-27"></span>
<span id="cb6-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> FASTQC ############</span></span>
<span id="cb6-29"></span>
<span id="cb6-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ RUN MULTIQC ############</span></span>
<span id="cb6-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning MultiQC on trimmed FastQC..."</span></span>
<span id="cb6-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb6-33"></span>
<span id="cb6-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">multiqc</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span></span>
<span id="cb6-35"></span>
<span id="cb6-36"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb6-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MultiQC on trimmed FastQs complete."</span></span>
<span id="cb6-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb6-39"></span>
<span id="cb6-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">############ </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> MULTIQC ############</span></span>
<span id="cb6-41"></span>
<span id="cb6-42"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Removing FastQC zip files."</span></span>
<span id="cb6-43"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb6-44"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.zip</span>
<span id="cb6-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FastQC zip files removed."</span></span>
<span id="cb6-46"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-chen2023" class="csl-entry">
Chen, Shifu. 2023. â€œUltrafast One-Pass FASTQ Data Preprocessing, Quality Control, and Deduplication Using Fastp.â€ <em>iMeta</em> 2 (2). <a href="https://doi.org/10.1002/imt2.107" class="uri">https://doi.org/10.1002/imt2.107</a>.
</div>
<div id="ref-ewels2016" class="csl-entry">
Ewels, Philip, MÃ¥ns Magnusson, Sverker Lundin, and Max KÃ¤ller. 2016. â€œMultiQC: Summarize Analysis Results for Multiple Tools and Samples in a Single Report.â€ <em>Bioinformatics</em> 32 (19): 3047â€“48. <a href="https://doi.org/10.1093/bioinformatics/btw354" class="uri">https://doi.org/10.1093/bioinformatics/btw354</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2024</category>
  <category>Mytilus trossulus</category>
  <category>WGBS</category>
  <category>fastp</category>
  <category>FastQC</category>
  <category>MultiQC</category>
  <category>bay mussel</category>
  <category>project-mytilus-methylation</category>
  <category>trimming</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-07-Trimming-and-QC---M.trossulus-WGBS-Using-fastp-and-FastQC-MultiQC/</guid>
  <pubDate>Thu, 07 Nov 2024 08:00:00 GMT</pubDate>
  <media:content url="https://robertslab.github.io/sams-notebook/posts/2024/2024-11-07-Trimming-and-QC---M.trossulus-WGBS-Using-fastp-and-FastQC-MultiQC/20241107-mtro-trimming-multiqc-screenshot.png" medium="image" type="image/png" height="67" width="144"/>
</item>
<item>
  <title>Data Wrangling - GO to GOslims for Graces Dermasterias imbricata Project from Trinity Assembly Genes</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-06-Data-Wrangling---GO-to-GOslims-for-Graces-Dermasterias-imbricata-Project-from-Trinity-Assembly-Genes/</link>
  <description><![CDATA[ 





<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This notebook consists of a markdown rendering of <a href="https://github.com/RobertsLab/code/blob/04a796dda0545340146d694964bcf4abdb626a73/r_projects/sam/20241106-dimb-GO-to-GOslim/code/01-GO-to-GOslim.Rmd">01-GO-to-GOslim.Rmd</a> (commit: <code>04a796d</code>).</p>
</div>
</div>
<section id="intro" class="level1">
<h1>1 INTRO</h1>
<p>This notebook is setup to <a href="https://github.com/RobertsLab/resources/issues/2012">take GO IDs and categorize them into their corresponding GOslims</a> (GitHub Issue). Specifically, it will use the following tab-delimited input file:</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/seashell/bu-github/project-pycno-multispecies-2023/output/06-Go-3-species/der_go.tsv">der_go.tsv</a></li>
</ul>
<p><a href="https://github.com/RobertsLab/resources/issues/1989#issuecomment-2448757444">Desired output format</a> (GitHub Issue comment) is:</p>
<pre><code>Term                                                    Count
anatomical structure development                        1137
signaling                                               600
cell differentiation                                    533
immune system process                                   331
lipid metabolic process                                 212</code></pre>
<p>This was performed using R, with the following packages:</p>
<ul>
<li>GSEABase (Martin Morgan 2017)</li>
<li>GO.db (Carlson 2017)</li>
<li>tidyverse (Wickham et al.&nbsp;2019)</li>
</ul>
<p>It also relied on gene ontology (GO) information from the <a href="https://geneontology.org/">Gene Ontology Consortium</a> (Ashburner et al.&nbsp;2000; Aleksander et al.&nbsp;2023).</p>
<section id="code" class="level2">
<h2 class="anchored" data-anchor-id="code">1.1 CODE</h2>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(GSEABase)</span></code></pre></div>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(GO.db)</span></code></pre></div>
<pre><code>## </code></pre>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(knitr)</span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span></code></pre></div>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>opts_chunk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set</span>(</span>
<span id="cb6-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">echo =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display code chunks</span></span>
<span id="cb6-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">eval =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Evaluate code chunks</span></span>
<span id="cb6-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">warning =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hide warnings</span></span>
<span id="cb6-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">message =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hide messages</span></span>
<span id="cb6-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">comment =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prevents appending '##' to beginning of lines in code output</span></span>
<span id="cb6-7">)</span></code></pre></div>
<section id="variables" class="level3">
<h3 class="anchored" data-anchor-id="variables">1.1.1 Variables</h3>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Column names corresponding to gene name/ID and GO IDs</span></span>
<span id="cb7-2">GO.ID.column <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene.Ontology.IDs"</span></span>
<span id="cb7-3">gene.ID.column <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"X1"</span></span>
<span id="cb7-4"></span>
<span id="cb7-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Relative path or URL to input file</span></span>
<span id="cb7-6">input.file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/seashell/bu-github/project-pycno-multispecies-2023/output/06-Go-3-species/der_go.tsv"</span></span>
<span id="cb7-7"></span>
<span id="cb7-8"></span>
<span id="cb7-9"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##### Official GO info - no need to change #####</span></span>
<span id="cb7-10">goslims_obo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"goslim_generic.obo"</span></span>
<span id="cb7-11">goslims_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"http://current.geneontology.org/ontology/subsets/goslim_generic.obo"</span></span></code></pre></div>
</section>
<section id="set-gseabase-location-and-download-goslim_generic.obo" class="level3">
<h3 class="anchored" data-anchor-id="set-gseabase-location-and-download-goslim_generic.obo">1.1.2 Set GSEAbase location and download <code>goslim_generic.obo</code></h3>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Find GSEAbase installation location</span></span>
<span id="cb8-2">gseabase_location <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find.package</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GSEABase"</span>)</span>
<span id="cb8-3"></span>
<span id="cb8-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load path to GOslim OBO file</span></span>
<span id="cb8-5">goslim_obo_destintation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(gseabase_location, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"extdata"</span>, goslims_obo, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fsep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/"</span>)</span>
<span id="cb8-6"></span>
<span id="cb8-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Download the GOslim OBO file</span></span>
<span id="cb8-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">download.file</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">url =</span> goslims_url, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">destfile =</span> goslim_obo_destintation)</span>
<span id="cb8-9"></span>
<span id="cb8-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loads package files</span></span>
<span id="cb8-11">gseabase_files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"extdata"</span>, goslims_obo, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GSEABase"</span>)</span></code></pre></div>
</section>
<section id="read-in-genego-file" class="level3">
<h3 class="anchored" data-anchor-id="read-in-genego-file">1.1.3 Read in gene/GO file</h3>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">full.gene.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> input.file, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb9-2"></span>
<span id="cb9-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(full.gene.df)</span></code></pre></div>
<pre><code>'data.frame':   34254 obs. of  25 variables:
 $ X1                                : chr  "TRINITY_DN37009_c0_g3_i1" "TRINITY_DN37009_c0_g3_i3" "TRINITY_DN37035_c0_g1_i1" "TRINITY_DN37023_c0_g1_i1" ...
 $ X2                                : chr  "sp" "sp" "sp" "sp" ...
 $ X3                                : chr  "Q9BYN0" "Q9BYN0" "P21329" "P07700" ...
 $ X4                                : chr  "SRXN1_HUMAN" "SRXN1_HUMAN" "RTJK_DROFU" "ADRB1_MELGA" ...
 $ X5                                : num  57.6 57.6 28.6 33.3 31.6 ...
 $ X6                                : int  125 125 147 99 133 49 90 179 85 37 ...
 $ X7                                : int  47 47 92 65 87 21 47 105 44 13 ...
 $ X8                                : int  2 2 4 1 3 0 3 7 2 1 ...
 $ X9                                : int  2822 1720 169 47 473 85 15 1 104 102 ...
 $ X10                               : int  2448 1346 579 340 84 231 275 513 343 4 ...
 $ X11                               : int  18 18 613 59 44 374 425 85 64 1097 ...
 $ X12                               : int  136 136 756 157 175 422 509 246 148 1133 ...
 $ X13                               : num  1.11e-39 3.47e-40 4.94e-08 6.59e-09 9.86e-12 ...
 $ X14                               : num  147 147 55.8 55.5 66.6 58.9 49.7 51.6 69.3 46.2 ...
 $ Reviewed                          : chr  "reviewed" "reviewed" NA "reviewed" ...
 $ Entry.Name                        : chr  "SRXN1_HUMAN" "SRXN1_HUMAN" NA "ADRB1_MELGA" ...
 $ Protein.names                     : chr  "Sulfiredoxin-1 (EC 1.8.98.2)" "Sulfiredoxin-1 (EC 1.8.98.2)" NA "Beta-1 adrenergic receptor (Beta-1 adrenoreceptor) (Beta-1 adrenoceptor) (Beta-T)" ...
 $ Gene.Names                        : chr  "SRXN1 C20orf139 SRX SRX1" "SRXN1 C20orf139 SRX SRX1" NA "ADRB1" ...
 $ Organism                          : chr  "Homo sapiens (Human)" "Homo sapiens (Human)" NA "Meleagris gallopavo (Wild turkey)" ...
 $ Length                            : int  137 137 NA 483 483 1056 NA 364 640 1358 ...
 $ Gene.Ontology..biological.process.: chr  "cellular response to oxidative stress [GO:0034599]; response to oxidative stress [GO:0006979]" "cellular response to oxidative stress [GO:0034599]; response to oxidative stress [GO:0006979]" NA "adenylate cyclase-activating adrenergic receptor signaling pathway [GO:0071880]; positive regulation of heart c"| __truncated__ ...
 $ Gene.Ontology..cellular.component.: chr  "cytoplasm [GO:0005737]; cytosol [GO:0005829]; endoplasmic reticulum membrane [GO:0005789]" "cytoplasm [GO:0005737]; cytosol [GO:0005829]; endoplasmic reticulum membrane [GO:0005789]" NA "early endosome [GO:0005769]; membrane [GO:0016020]; plasma membrane [GO:0005886]" ...
 $ Gene.Ontology..GO.                : chr  "cytoplasm [GO:0005737]; cytosol [GO:0005829]; endoplasmic reticulum membrane [GO:0005789]; ATP binding [GO:0005"| __truncated__ "cytoplasm [GO:0005737]; cytosol [GO:0005829]; endoplasmic reticulum membrane [GO:0005789]; ATP binding [GO:0005"| __truncated__ NA "early endosome [GO:0005769]; membrane [GO:0016020]; plasma membrane [GO:0005886]; beta1-adrenergic receptor act"| __truncated__ ...
 $ Gene.Ontology..molecular.function.: chr  "ATP binding [GO:0005524]; oxidoreductase activity, acting on a sulfur group of donors [GO:0016667]; sulfiredoxi"| __truncated__ "ATP binding [GO:0005524]; oxidoreductase activity, acting on a sulfur group of donors [GO:0016667]; sulfiredoxi"| __truncated__ NA "beta1-adrenergic receptor activity [GO:0004940]; identical protein binding [GO:0042802]" ...
 $ Gene.Ontology.IDs                 : chr  "GO:0005524; GO:0005737; GO:0005789; GO:0005829; GO:0006979; GO:0016667; GO:0032542; GO:0034599" "GO:0005524; GO:0005737; GO:0005789; GO:0005829; GO:0006979; GO:0016667; GO:0032542; GO:0034599" NA "GO:0004940; GO:0005769; GO:0005886; GO:0016020; GO:0042802; GO:0045187; GO:0045823; GO:0071880" ...</code></pre>
</section>
<section id="remove-rows-with-na-remove-whitespace-in-go-ids-column-and-keep-just-genego-ids-columns" class="level3">
<h3 class="anchored" data-anchor-id="remove-rows-with-na-remove-whitespace-in-go-ids-column-and-keep-just-genego-ids-columns">1.1.4 Remove rows with NA, remove whitespace in GO IDs column and keep just gene/GO IDs columns</h3>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clean whitespace, filter NA/empty rows, select columns, and split GO terms using column name variables</span></span>
<span id="cb11-2">gene.GO.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> full.gene.df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GO.ID.column :=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(.data[[GO.ID.column]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">s*;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">s*"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clean up spaces around ";"</span></span>
<span id="cb11-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(.data[[gene.ID.column]]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(.data[[GO.ID.column]]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> .data[[GO.ID.column]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb11-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all_of</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(gene.ID.column, GO.ID.column)))</span>
<span id="cb11-6"></span>
<span id="cb11-7"></span>
<span id="cb11-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(gene.GO.df)</span></code></pre></div>
<pre><code>'data.frame':   23192 obs. of  2 variables:
 $ X1               : chr  "TRINITY_DN37009_c0_g3_i1" "TRINITY_DN37009_c0_g3_i3" "TRINITY_DN37023_c0_g1_i1" "TRINITY_DN37023_c1_g1_i1" ...
 $ Gene.Ontology.IDs: chr  "GO:0005524;GO:0005737;GO:0005789;GO:0005829;GO:0006979;GO:0016667;GO:0032542;GO:0034599" "GO:0005524;GO:0005737;GO:0005789;GO:0005829;GO:0006979;GO:0016667;GO:0032542;GO:0034599" "GO:0004940;GO:0005769;GO:0005886;GO:0016020;GO:0042802;GO:0045187;GO:0045823;GO:0071880" "GO:0004940;GO:0005769;GO:0005886;GO:0016020;GO:0042802;GO:0045187;GO:0045823;GO:0071880" ...</code></pre>
</section>
<section id="flatten-gene-and-go-ids" class="level3">
<h3 class="anchored" data-anchor-id="flatten-gene-and-go-ids">1.1.5 â€œFlattenâ€ gene and GO IDs</h3>
<p>This flattens the file so all of the GO IDs per gene are separated into one GO ID per gene per row.</p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">flat.gene.GO.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene.GO.df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_rows</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sym</span>(GO.ID.column), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)</span>
<span id="cb13-2"></span>
<span id="cb13-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(flat.gene.GO.df)</span></code></pre></div>
<pre><code>tibble [363,990 Ã— 2] (S3: tbl_df/tbl/data.frame)
 $ X1               : chr [1:363990] "TRINITY_DN37009_c0_g3_i1" "TRINITY_DN37009_c0_g3_i1" "TRINITY_DN37009_c0_g3_i1" "TRINITY_DN37009_c0_g3_i1" ...
 $ Gene.Ontology.IDs: chr [1:363990] "GO:0005524" "GO:0005737" "GO:0005789" "GO:0005829" ...</code></pre>
</section>
<section id="group" class="level3">
<h3 class="anchored" data-anchor-id="group">1.1.6 Group</h3>
<p>Groups the genes by GO ID (i.e.&nbsp;lists all genes associated with each unique GO ID)</p>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">grouped.gene.GO.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> flat.gene.GO.df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb15-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sym</span>(GO.ID.column)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb15-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene.ID.column :=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(.data[[gene.ID.column]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>))</span>
<span id="cb15-4"></span>
<span id="cb15-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(grouped.gene.GO.df)</span></code></pre></div>
<pre><code>tibble [15,068 Ã— 2] (S3: tbl_df/tbl/data.frame)
 $ Gene.Ontology.IDs: chr [1:15068] "GO:0000002" "GO:0000009" "GO:0000012" "GO:0000014" ...
 $ X1               : chr [1:15068] "TRINITY_DN12635_c0_g1_i1,TRINITY_DN6578_c1_g1_i2,TRINITY_DN20059_c0_g1_i11,TRINITY_DN20059_c0_g1_i13,TRINITY_DN"| __truncated__ "TRINITY_DN3933_c0_g3_i1" "TRINITY_DN2179_c0_g7_i1,TRINITY_DN2179_c0_g7_i2,TRINITY_DN8923_c0_g2_i1,TRINITY_DN8283_c0_g1_i3,TRINITY_DN8283_"| __truncated__ "TRINITY_DN31365_c0_g1_i1,TRINITY_DN31365_c0_g1_i2,TRINITY_DN53840_c0_g1_i1,TRINITY_DN662_c0_g1_i2,TRINITY_DN149"| __truncated__ ...</code></pre>
</section>
<section id="map-go-ids-to-goslims" class="level3">
<h3 class="anchored" data-anchor-id="map-go-ids-to-goslims">1.1.7 Map GO IDs to GOslims</h3>
<p>The mapping steps were derived from this <a href="https://support.bioconductor.org/p/128407/#128408">bioconductor forum response</a></p>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Vector of GO IDs</span></span>
<span id="cb17-2">go_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> grouped.gene.GO.df[[GO.ID.column]]</span>
<span id="cb17-3"></span>
<span id="cb17-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(go_ids)</span></code></pre></div>
<pre><code> chr [1:15068] "GO:0000002" "GO:0000009" "GO:0000012" "GO:0000014" ...</code></pre>
</section>
<section id="extract-goslims-from-obo" class="level3">
<h3 class="anchored" data-anchor-id="extract-goslims-from-obo">1.1.8 Extract GOslims from OBO</h3>
<p>Creates new OBO Collection object of just GOslims, based on provided GO IDs.</p>
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create GSEAbase GOCollection using `go_ids`</span></span>
<span id="cb19-2">myCollection <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">GOCollection</span>(go_ids)</span>
<span id="cb19-3"></span>
<span id="cb19-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Retrieve GOslims from GO OBO file set</span></span>
<span id="cb19-5">slim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getOBOCollection</span>(gseabase_files)</span>
<span id="cb19-6"></span>
<span id="cb19-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(slim)</span></code></pre></div>
<pre><code>Formal class 'OBOCollection' [package "GSEABase"] with 7 slots
  ..@ .stanza     :'data.frame':    153 obs. of  1 variable:
  .. ..$ value: chr [1:153] "Root" "Term" "Term" "Term" ...
  ..@ .subset     :'data.frame':    22 obs. of  1 variable:
  .. ..$ value: chr [1:22] "Rhea list of ChEBI terms representing the major species at pH 7.3." "Term not to be used for direct annotation" "Terms planned for obsoletion" "AGR slim" ...
  ..@ .kv         :'data.frame':    2075 obs. of  3 variables:
  .. ..$ stanza_id: chr [1:2075] ".__Root__" ".__Root__" ".__Root__" ".__Root__" ...
  .. ..$ key      : chr [1:2075] "format-version" "data-version" "synonymtypedef" "synonymtypedef" ...
  .. ..$ value    : chr [1:2075] "1.2" "go/2024-09-08/subsets/goslim_generic.owl" "syngo_official_label \"label approved by the SynGO project\"" "systematic_synonym \"Systematic synonym\" EXACT" ...
  ..@ evidenceCode: chr [1:26] "EXP" "IDA" "IPI" "IMP" ...
  ..@ ontology    : chr NA
  ..@ ids         : chr [1:141] "GO:0000228" "GO:0000278" "GO:0000910" "GO:0001618" ...
  ..@ type        : chr "OBO"</code></pre>
</section>
<section id="get-biological-process-bp-goslims-associated-with-provided-go-ids." class="level3">
<h3 class="anchored" data-anchor-id="get-biological-process-bp-goslims-associated-with-provided-go-ids.">1.1.9 Get Biological Process (BP) GOslims associated with provided GO IDs.</h3>
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Retrieve Biological Process (BP) GOslims</span></span>
<span id="cb21-2">slimdf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">goSlim</span>(myCollection, slim, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BP"</span>, verbose)</span>
<span id="cb21-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(slimdf)</span></code></pre></div>
<pre><code>'data.frame':   72 obs. of  3 variables:
 $ Count  : int  93 22 18 554 81 107 31 5 103 58 ...
 $ Percent: num  0.925 0.219 0.179 5.508 0.805 ...
 $ Term   : chr  "mitotic cell cycle" "cytokinesis" "cytoplasmic translation" "immune system process" ...</code></pre>
</section>
<section id="map-go-to-goslims" class="level3">
<h3 class="anchored" data-anchor-id="map-go-to-goslims">1.1.10 Map GO to GOslims</h3>
<p>Performs mapping of of GOIDs to GOslims</p>
<p>Returns:</p>
<ul>
<li>GOslim IDs (as rownames)</li>
<li>GOslim terms</li>
<li>Counts of GO IDs matching to corresponding GOslim</li>
<li>Percentage of GO IDs matching to corresponding GOslim</li>
<li>GOIDs mapped to corresponding GOslim, in a semi-colon delimited format</li>
</ul>
<div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># List of GOslims and all GO IDs from `go_ids`</span></span>
<span id="cb23-2">gomap <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.list</span>(GOBPOFFSPRING[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(slimdf)])</span>
<span id="cb23-3"></span>
<span id="cb23-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Maps `go_ids` to matching GOslims</span></span>
<span id="cb23-5">mapped <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(gomap, intersect, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ids</span>(myCollection))</span>
<span id="cb23-6"></span>
<span id="cb23-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Append all mapped GO IDs to `slimdf`</span></span>
<span id="cb23-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># `sapply` needed to apply paste() to create semi-colon delimited values</span></span>
<span id="cb23-9">slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(gomap, intersect, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ids</span>(myCollection)), paste, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)</span>
<span id="cb23-10"></span>
<span id="cb23-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove "character(0) string from "GO.IDs" column</span></span>
<span id="cb23-12">slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs[slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"character(0)"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb23-13"></span>
<span id="cb23-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add self-matching GOIDs to "GO.IDs" column, if not present</span></span>
<span id="cb23-15"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (go_id <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> go_ids) {</span>
<span id="cb23-16">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the go_id is present in the row names</span></span>
<span id="cb23-17">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (go_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(slimdf)) {</span>
<span id="cb23-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the go_id is not present in the GO.IDs column</span></span>
<span id="cb23-19">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Also removes white space "trimws()" and converts all to upper case to handle</span></span>
<span id="cb23-20">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># any weird, "invisible" formatting issues.</span></span>
<span id="cb23-21">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>go_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">trimws</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">toupper</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">strsplit</span>(slimdf[go_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]))) {</span>
<span id="cb23-22">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Append the go_id to the GO.IDs column with a semi-colon separator</span></span>
<span id="cb23-23">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nchar</span>(slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(slimdf)]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb23-24">        slimdf[go_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(slimdf[go_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"; "</span>, go_id)</span>
<span id="cb23-25">      } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb23-26">        slimdf[go_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> go_id</span>
<span id="cb23-27">      }</span>
<span id="cb23-28">    }</span>
<span id="cb23-29">  }</span>
<span id="cb23-30">}</span>
<span id="cb23-31"></span>
<span id="cb23-32"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(slimdf)</span></code></pre></div>
<pre><code>'data.frame':   72 obs. of  4 variables:
 $ Count  : int  93 22 18 554 81 107 31 5 103 58 ...
 $ Percent: num  0.925 0.219 0.179 5.508 0.805 ...
 $ Term   : chr  "mitotic cell cycle" "cytokinesis" "cytoplasmic translation" "immune system process" ...
 $ GO.IDs : chr  "GO:0000022;GO:0000070;GO:0000082;GO:0000086;GO:0000132;GO:0000281;GO:0006977;GO:0007052;GO:0007076;GO:0007079;G"| __truncated__ "GO:0000281;GO:0000911;GO:0000915;GO:0007112;GO:0031991;GO:0032465;GO:0032466;GO:0032467;GO:0032506;GO:0033206;G"| __truncated__ "GO:0001731;GO:0001732;GO:0002183;GO:0002184;GO:0002188;GO:0002190;GO:0002191;GO:0002192;GO:0140018;GO:0140708;G"| __truncated__ "GO:0001768;GO:0001771;GO:0001773;GO:0001774;GO:0001776;GO:0001779;GO:0001780;GO:0001782;GO:0001798;GO:0001805;G"| __truncated__ ...</code></pre>
</section>
<section id="flatten-goslims" class="level3">
<h3 class="anchored" data-anchor-id="flatten-goslims">1.1.11 Flatten GOslims</h3>
<div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "Flatten" file so each row is single GO ID with corresponding GOslim</span></span>
<span id="cb25-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rownames_to_column needed to retain row name info</span></span>
<span id="cb25-3">slimdf_separated <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(slimdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames_to_column</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GOslim'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_rows</span>(GO.IDs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>))</span>
<span id="cb25-6"></span>
<span id="cb25-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Group by unique GO ID</span></span>
<span id="cb25-8">grouped_slimdf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> slimdf_separated <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(GO.IDs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> GO.IDs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(GO.IDs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GOslim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(GOslim, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>),</span>
<span id="cb25-12">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Term =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(Term, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>))</span>
<span id="cb25-13"></span>
<span id="cb25-14"></span>
<span id="cb25-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(grouped_slimdf)</span></code></pre></div>
<pre><code>tibble [6,942 Ã— 3] (S3: tbl_df/tbl/data.frame)
 $ GO.IDs: chr [1:6942] " GO:0000278" " GO:0002181" " GO:0002376" " GO:0003014" ...
 $ GOslim: chr [1:6942] "GO:0000278" "GO:0002181" "GO:0002376" "GO:0003014" ...
 $ Term  : chr [1:6942] "mitotic cell cycle" "cytoplasmic translation" "immune system process" "renal system process" ...</code></pre>
</section>
</section>
<section id="write-slimdf-to-file" class="level2">
<h2 class="anchored" data-anchor-id="write-slimdf-to-file">1.2 Write slimdf to file</h2>
<section id="sort-and-select-slmidf" class="level3">
<h3 class="anchored" data-anchor-id="sort-and-select-slmidf">1.2.1 Sort and select slmidf</h3>
<p>Sorts GOslims by <code>Count</code>, in descending order and then selects just the <code>Term</code> and <code>Count</code> columns.</p>
<div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1">slimdf.sorted <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> slimdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(Count))</span>
<span id="cb27-2"></span>
<span id="cb27-3">slim.count.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> slimdf.sorted <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb27-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(Term, Count)</span>
<span id="cb27-5"></span>
<span id="cb27-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(slim.count.df)</span></code></pre></div>
<pre><code>'data.frame':   72 obs. of  2 variables:
 $ Term : chr  "anatomical structure development" "cell differentiation" "signaling" "immune system process" ...
 $ Count: int  2091 932 908 554 352 306 278 275 264 246 ...</code></pre>
</section>
<section id="write-formatted-slim.count.df-to-file" class="level3">
<h3 class="anchored" data-anchor-id="write-formatted-slim.count.df-to-file">1.2.2 Write formatted slim.count.df to file</h3>
<div class="sourceCode" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_tsv</span>(slim.count.df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/01-GO-to-GOslim/counts.GOID-per-GOslim_term.tab"</span>)</span></code></pre></div>
</section>
</section>
<section id="count-unique-biological-process-go-ids" class="level2">
<h2 class="anchored" data-anchor-id="count-unique-biological-process-go-ids">1.3 Count unique Biological Process GO IDs</h2>
<div class="sourceCode" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Flatten the list and count total GO IDs</span></span>
<span id="cb30-2">total_go_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(gomap))</span>
<span id="cb30-3"></span>
<span id="cb30-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display the total count</span></span>
<span id="cb30-5">total_go_ids</span></code></pre></div>
<pre><code>[1] 26534</code></pre>
<div class="sourceCode" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Unlist to extract all GO IDs, then find unique ones and count them</span></span>
<span id="cb32-2">unique_go_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(gomap))</span>
<span id="cb32-3">total_unique_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(unique_go_ids)</span>
<span id="cb32-4"></span>
<span id="cb32-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display the total count of unique GO IDs</span></span>
<span id="cb32-6">total_unique_ids</span></code></pre></div>
<pre><code>[1] 17913</code></pre>
<p>Total starting BP GO IDs: 26534</p>
<p>Total unique BP GO IDs: 17913</p>
</section>
</section>
<section id="references" class="level1">
<h1>2 REFERENCES</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-thegene2023" class="csl-entry">
Aleksander, Suzi A, James Balhoff, Seth Carbon, J Michael Cherry, Harold J Drabkin, Dustin Ebert, Marc Feuermann, et al.&nbsp;2023. â€œThe Gene Ontology Knowledgebase in 2023.â€ Edited by A Baryshnikova. <em>GENETICS</em> 224 (1). <a href="https://doi.org/10.1093/genetics/iyad031" class="uri">https://doi.org/10.1093/genetics/iyad031</a>.
</div>
<div id="ref-ashburner2000" class="csl-entry">
Ashburner, Michael, Catherine A. Ball, Judith A. Blake, David Botstein, Heather Butler, J. Michael Cherry, Allan P. Davis, et al.&nbsp;2000. â€œGene Ontology: Tool for the Unification of Biology.â€ <em>Nature Genetics</em> 25 (1): 25â€“29. <a href="https://doi.org/10.1038/75556" class="uri">https://doi.org/10.1038/75556</a>.
</div>
<div id="ref-carlson2017" class="csl-entry">
Carlson, Marc. 2017. â€œGO.db.â€ <a href="https://doi.org/10.18129/B9.BIOC.GO.DB" class="uri">https://doi.org/10.18129/B9.BIOC.GO.DB</a>.
</div>
<div id="ref-martinmorgan2017" class="csl-entry">
Martin Morgan, Seth Falcon. 2017. â€œGSEABase.â€ <a href="https://doi.org/10.18129/B9.BIOC.GSEABASE" class="uri">https://doi.org/10.18129/B9.BIOC.GSEABASE</a>.
</div>
<div id="ref-wickham2019" class="csl-entry">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy McGowan, Romain FranÃ§ois, Garrett Grolemund, et al.&nbsp;2019. â€œWelcome to the Tidyverse.â€ <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686" class="uri">https://doi.org/10.21105/joss.01686</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2024</category>
  <category>Dermasterias imbricata</category>
  <category>GO</category>
  <category>GOslim</category>
  <category>gene ontology</category>
  <category>Trinity</category>
  <category>Leather star</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-06-Data-Wrangling---GO-to-GOslims-for-Graces-Dermasterias-imbricata-Project-from-Trinity-Assembly-Genes/</guid>
  <pubDate>Wed, 06 Nov 2024 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Data Wrangling - GO to GOslims for Graces Pycnopodia helianthoides Project from Trinity Assembly Genes</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-06-Data-Wrangling---GO-to-GOslims-for-Pycnopodia-helianthoides-Project-from-Trinity-Assembly-Genes/</link>
  <description><![CDATA[ 





<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This notebook consists of a markdown rendering of <a href="https://github.com/RobertsLab/code/blob/3b642b455cf0e1bcf3fd77b8f22736b79ce0ade3/r_projects/sam/20241106-phel-GO-to-GOslim/code/01-GO-to-GOslim.Rmd">01-GO-to-GOslim.Rmd</a> (commit: <code>3b642b4</code>).</p>
</div>
</div>
<section id="intro" class="level1">
<h1>1 INTRO</h1>
<p>This notebook is setup to <a href="https://github.com/RobertsLab/resources/issues/2012">take GO IDs and categorize them into their corresponding GOslims</a> (GitHub Issue). Specifically, it will use the following tab-delimited input file:</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/seashell/bu-github/project-pycno-multispecies-2023/output/06-Go-3-species/pyc_go.tsv">pyc_go.tsv</a></li>
</ul>
<p><a href="https://github.com/RobertsLab/resources/issues/1989#issuecomment-2448757444">Desired output format</a> (GitHub Issue comment) is:</p>
<pre><code>Term                                                    Count
anatomical structure development                        1137
signaling                                               600
cell differentiation                                    533
immune system process                                   331
lipid metabolic process                                 212</code></pre>
<p>This was performed using R, with the following packages:</p>
<ul>
<li>GSEABase (Martin Morgan 2017)</li>
<li>GO.db (Carlson 2017)</li>
<li>tidyverse (Wickham et al.&nbsp;2019)</li>
</ul>
<p>It also relied on gene ontology (GO) information from the <a href="https://geneontology.org/">Gene Ontology Consortium</a> (Ashburner et al.&nbsp;2000; Aleksander et al.&nbsp;2023).</p>
<section id="code" class="level2">
<h2 class="anchored" data-anchor-id="code">1.1 CODE</h2>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(GSEABase)</span></code></pre></div>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(GO.db)</span></code></pre></div>
<pre><code>## </code></pre>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(knitr)</span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span></code></pre></div>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>opts_chunk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set</span>(</span>
<span id="cb6-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">echo =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display code chunks</span></span>
<span id="cb6-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">eval =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Evaluate code chunks</span></span>
<span id="cb6-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">warning =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hide warnings</span></span>
<span id="cb6-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">message =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hide messages</span></span>
<span id="cb6-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">comment =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prevents appending '##' to beginning of lines in code output</span></span>
<span id="cb6-7">)</span></code></pre></div>
<section id="variables" class="level3">
<h3 class="anchored" data-anchor-id="variables">1.1.1 Variables</h3>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Column names corresponding to gene name/ID and GO IDs</span></span>
<span id="cb7-2">GO.ID.column <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene.Ontology.IDs"</span></span>
<span id="cb7-3">gene.ID.column <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"X1"</span></span>
<span id="cb7-4"></span>
<span id="cb7-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Relative path or URL to input file</span></span>
<span id="cb7-6">input.file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/seashell/bu-github/project-pycno-multispecies-2023/output/06-Go-3-species/pyc_go.tsv"</span></span>
<span id="cb7-7"></span>
<span id="cb7-8"></span>
<span id="cb7-9"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##### Official GO info - no need to change #####</span></span>
<span id="cb7-10">goslims_obo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"goslim_generic.obo"</span></span>
<span id="cb7-11">goslims_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"http://current.geneontology.org/ontology/subsets/goslim_generic.obo"</span></span></code></pre></div>
</section>
<section id="set-gseabase-location-and-download-goslim_generic.obo" class="level3">
<h3 class="anchored" data-anchor-id="set-gseabase-location-and-download-goslim_generic.obo">1.1.2 Set GSEAbase location and download <code>goslim_generic.obo</code></h3>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Find GSEAbase installation location</span></span>
<span id="cb8-2">gseabase_location <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find.package</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GSEABase"</span>)</span>
<span id="cb8-3"></span>
<span id="cb8-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load path to GOslim OBO file</span></span>
<span id="cb8-5">goslim_obo_destintation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(gseabase_location, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"extdata"</span>, goslims_obo, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fsep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/"</span>)</span>
<span id="cb8-6"></span>
<span id="cb8-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Download the GOslim OBO file</span></span>
<span id="cb8-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">download.file</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">url =</span> goslims_url, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">destfile =</span> goslim_obo_destintation)</span>
<span id="cb8-9"></span>
<span id="cb8-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loads package files</span></span>
<span id="cb8-11">gseabase_files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"extdata"</span>, goslims_obo, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GSEABase"</span>)</span></code></pre></div>
</section>
<section id="read-in-genego-file" class="level3">
<h3 class="anchored" data-anchor-id="read-in-genego-file">1.1.3 Read in gene/GO file</h3>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">full.gene.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> input.file, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb9-2"></span>
<span id="cb9-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(full.gene.df)</span></code></pre></div>
<pre><code>'data.frame':   29145 obs. of  25 variables:
 $ X1                                : chr  "TRINITY_DN37046_c0_g1_i2" "TRINITY_DN37065_c0_g1_i1" "TRINITY_DN37015_c0_g1_i1" "TRINITY_DN45769_c0_g1_i1" ...
 $ X2                                : chr  "sp" "sp" "sp" "sp" ...
 $ X3                                : chr  "Q32NR4" "Q95NT6" "Q9Z0Z4" "Q09575" ...
 $ X4                                : chr  "TTC29_XENLA" "MTH2_DROYA" "HEPH_MOUSE" "YRD6_CAEEL" ...
 $ X5                                : num  36.4 26 47.5 37.2 51.7 ...
 $ X6                                : int  439 231 80 121 58 60 35 88 78 88 ...
 $ X7                                : int  269 155 42 75 28 35 17 59 42 45 ...
 $ X8                                : int  5 8 0 1 0 1 0 1 1 3 ...
 $ X9                                : int  502 688 2 361 12 217 55 86 274 266 ...
 $ X10                               : int  1818 29 241 2 185 38 159 349 41 12 ...
 $ X11                               : int  19 224 38 776 1146 445 297 456 437 34 ...
 $ X12                               : int  447 449 117 896 1203 503 331 542 512 113 ...
 $ X13                               : num  6.37e-79 2.22e-13 3.37e-21 4.39e-25 1.02e-14 ...
 $ X14                               : num  263 75.5 89 102 70.1 55.8 45.8 50.1 62.8 47.8 ...
 $ Reviewed                          : chr  NA NA "reviewed" NA ...
 $ Entry.Name                        : chr  NA NA "HEPH_MOUSE" NA ...
 $ Protein.names                     : chr  NA NA "Hephaestin (Hp) (EC 1.16.3.1)" NA ...
 $ Gene.Names                        : chr  NA NA "Heph Kiaa0698" NA ...
 $ Organism                          : chr  NA NA "Mus musculus (Mouse)" NA ...
 $ Length                            : int  NA NA 1157 NA 2812 NA NA NA 583 NA ...
 $ Gene.Ontology..biological.process.: chr  NA NA "intestinal iron absorption [GO:0160179]; iron ion transport [GO:0006826]; multicellular organismal-level iron i"| __truncated__ NA ...
 $ Gene.Ontology..cellular.component.: chr  NA NA "basolateral plasma membrane [GO:0016323]; extracellular region [GO:0005576]; perinuclear region of cytoplasm [G"| __truncated__ NA ...
 $ Gene.Ontology..GO.                : chr  NA NA "basolateral plasma membrane [GO:0016323]; extracellular region [GO:0005576]; perinuclear region of cytoplasm [G"| __truncated__ NA ...
 $ Gene.Ontology..molecular.function.: chr  NA NA "copper ion binding [GO:0005507]; ferrous iron binding [GO:0008198]; ferroxidase activity [GO:0004322]; oxidored"| __truncated__ NA ...
 $ Gene.Ontology.IDs                 : chr  NA NA "GO:0004322; GO:0005507; GO:0005576; GO:0005886; GO:0006826; GO:0008198; GO:0016323; GO:0016491; GO:0048471; GO:"| __truncated__ NA ...</code></pre>
</section>
<section id="remove-rows-with-na-remove-whitespace-in-go-ids-column-and-keep-just-genego-ids-columns" class="level3">
<h3 class="anchored" data-anchor-id="remove-rows-with-na-remove-whitespace-in-go-ids-column-and-keep-just-genego-ids-columns">1.1.4 Remove rows with NA, remove whitespace in GO IDs column and keep just gene/GO IDs columns</h3>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clean whitespace, filter NA/empty rows, select columns, and split GO terms using column name variables</span></span>
<span id="cb11-2">gene.GO.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> full.gene.df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GO.ID.column :=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(.data[[GO.ID.column]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">s*;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">s*"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clean up spaces around ";"</span></span>
<span id="cb11-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(.data[[gene.ID.column]]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(.data[[GO.ID.column]]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> .data[[GO.ID.column]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb11-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all_of</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(gene.ID.column, GO.ID.column)))</span>
<span id="cb11-6"></span>
<span id="cb11-7"></span>
<span id="cb11-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(gene.GO.df)</span></code></pre></div>
<pre><code>'data.frame':   19842 obs. of  2 variables:
 $ X1               : chr  "TRINITY_DN37015_c0_g1_i1" "TRINITY_DN45794_c0_g1_i1" "TRINITY_DN45764_c0_g1_i1" "TRINITY_DN48070_c0_g1_i1" ...
 $ Gene.Ontology.IDs: chr  "GO:0004322;GO:0005507;GO:0005576;GO:0005886;GO:0006826;GO:0008198;GO:0016323;GO:0016491;GO:0048471;GO:0060586;G"| __truncated__ "GO:0005615;GO:0005886;GO:0007339;GO:0031012;GO:0098609" "GO:0000139;GO:0001736;GO:0001737;GO:0004674;GO:0005615;GO:0005737;GO:0005886;GO:0006468;GO:0007219;GO:0007267;G"| __truncated__ "GO:0005102;GO:0005739;GO:0005777;GO:0005778;GO:0006633;GO:0019166;GO:0033306;GO:0043231" ...</code></pre>
</section>
<section id="flatten-gene-and-go-ids" class="level3">
<h3 class="anchored" data-anchor-id="flatten-gene-and-go-ids">1.1.5 â€œFlattenâ€ gene and GO IDs</h3>
<p>This flattens the file so all of the GO IDs per gene are separated into one GO ID per gene per row.</p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">flat.gene.GO.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene.GO.df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_rows</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sym</span>(GO.ID.column), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)</span>
<span id="cb13-2"></span>
<span id="cb13-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(flat.gene.GO.df)</span></code></pre></div>
<pre><code>tibble [319,980 Ã— 2] (S3: tbl_df/tbl/data.frame)
 $ X1               : chr [1:319980] "TRINITY_DN37015_c0_g1_i1" "TRINITY_DN37015_c0_g1_i1" "TRINITY_DN37015_c0_g1_i1" "TRINITY_DN37015_c0_g1_i1" ...
 $ Gene.Ontology.IDs: chr [1:319980] "GO:0004322" "GO:0005507" "GO:0005576" "GO:0005886" ...</code></pre>
</section>
<section id="group" class="level3">
<h3 class="anchored" data-anchor-id="group">1.1.6 Group</h3>
<p>Groups the genes by GO ID (i.e.&nbsp;lists all genes associated with each unique GO ID)</p>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">grouped.gene.GO.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> flat.gene.GO.df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb15-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sym</span>(GO.ID.column)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb15-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene.ID.column :=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(.data[[gene.ID.column]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>))</span>
<span id="cb15-4"></span>
<span id="cb15-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(grouped.gene.GO.df)</span></code></pre></div>
<pre><code>tibble [14,922 Ã— 2] (S3: tbl_df/tbl/data.frame)
 $ Gene.Ontology.IDs: chr [1:14922] "GO:0000002" "GO:0000009" "GO:0000011" "GO:0000012" ...
 $ X1               : chr [1:14922] "TRINITY_DN624_c0_g1_i1,TRINITY_DN624_c0_g1_i2,TRINITY_DN678_c0_g1_i1,TRINITY_DN678_c0_g1_i2,TRINITY_DN678_c0_g1"| __truncated__ "TRINITY_DN10071_c0_g4_i1" "TRINITY_DN628_c0_g2_i1,TRINITY_DN9588_c0_g1_i1,TRINITY_DN9588_c0_g1_i5" "TRINITY_DN3105_c1_g1_i3,TRINITY_DN4630_c0_g1_i2,TRINITY_DN4630_c0_g1_i4,TRINITY_DN4630_c0_g1_i5,TRINITY_DN8346_"| __truncated__ ...</code></pre>
</section>
<section id="map-go-ids-to-goslims" class="level3">
<h3 class="anchored" data-anchor-id="map-go-ids-to-goslims">1.1.7 Map GO IDs to GOslims</h3>
<p>The mapping steps were derived from this <a href="https://support.bioconductor.org/p/128407/#128408">bioconductor forum response</a></p>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Vector of GO IDs</span></span>
<span id="cb17-2">go_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> grouped.gene.GO.df[[GO.ID.column]]</span>
<span id="cb17-3"></span>
<span id="cb17-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(go_ids)</span></code></pre></div>
<pre><code> chr [1:14922] "GO:0000002" "GO:0000009" "GO:0000011" "GO:0000012" ...</code></pre>
</section>
<section id="extract-goslims-from-obo" class="level3">
<h3 class="anchored" data-anchor-id="extract-goslims-from-obo">1.1.8 Extract GOslims from OBO</h3>
<p>Creates new OBO Collection object of just GOslims, based on provided GO IDs.</p>
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create GSEAbase GOCollection using `go_ids`</span></span>
<span id="cb19-2">myCollection <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">GOCollection</span>(go_ids)</span>
<span id="cb19-3"></span>
<span id="cb19-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Retrieve GOslims from GO OBO file set</span></span>
<span id="cb19-5">slim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getOBOCollection</span>(gseabase_files)</span>
<span id="cb19-6"></span>
<span id="cb19-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(slim)</span></code></pre></div>
<pre><code>Formal class 'OBOCollection' [package "GSEABase"] with 7 slots
  ..@ .stanza     :'data.frame':    153 obs. of  1 variable:
  .. ..$ value: chr [1:153] "Root" "Term" "Term" "Term" ...
  ..@ .subset     :'data.frame':    22 obs. of  1 variable:
  .. ..$ value: chr [1:22] "Rhea list of ChEBI terms representing the major species at pH 7.3." "Term not to be used for direct annotation" "Terms planned for obsoletion" "AGR slim" ...
  ..@ .kv         :'data.frame':    2075 obs. of  3 variables:
  .. ..$ stanza_id: chr [1:2075] ".__Root__" ".__Root__" ".__Root__" ".__Root__" ...
  .. ..$ key      : chr [1:2075] "format-version" "data-version" "synonymtypedef" "synonymtypedef" ...
  .. ..$ value    : chr [1:2075] "1.2" "go/2024-09-08/subsets/goslim_generic.owl" "syngo_official_label \"label approved by the SynGO project\"" "systematic_synonym \"Systematic synonym\" EXACT" ...
  ..@ evidenceCode: chr [1:26] "EXP" "IDA" "IPI" "IMP" ...
  ..@ ontology    : chr NA
  ..@ ids         : chr [1:141] "GO:0000228" "GO:0000278" "GO:0000910" "GO:0001618" ...
  ..@ type        : chr "OBO"</code></pre>
</section>
<section id="get-biological-process-bp-goslims-associated-with-provided-go-ids." class="level3">
<h3 class="anchored" data-anchor-id="get-biological-process-bp-goslims-associated-with-provided-go-ids.">1.1.9 Get Biological Process (BP) GOslims associated with provided GO IDs.</h3>
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Retrieve Biological Process (BP) GOslims</span></span>
<span id="cb21-2">slimdf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">goSlim</span>(myCollection, slim, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BP"</span>, verbose)</span>
<span id="cb21-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(slimdf)</span></code></pre></div>
<pre><code>'data.frame':   72 obs. of  3 variables:
 $ Count  : int  102 23 17 533 83 107 28 5 96 60 ...
 $ Percent: num  1.016 0.229 0.169 5.308 0.827 ...
 $ Term   : chr  "mitotic cell cycle" "cytokinesis" "cytoplasmic translation" "immune system process" ...</code></pre>
</section>
<section id="map-go-to-goslims" class="level3">
<h3 class="anchored" data-anchor-id="map-go-to-goslims">1.1.10 Map GO to GOslims</h3>
<p>Performs mapping of of GOIDs to GOslims</p>
<p>Returns:</p>
<ul>
<li>GOslim IDs (as rownames)</li>
<li>GOslim terms</li>
<li>Counts of GO IDs matching to corresponding GOslim</li>
<li>Percentage of GO IDs matching to corresponding GOslim</li>
<li>GOIDs mapped to corresponding GOslim, in a semi-colon delimited format</li>
</ul>
<div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># List of GOslims and all GO IDs from `go_ids`</span></span>
<span id="cb23-2">gomap <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.list</span>(GOBPOFFSPRING[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(slimdf)])</span>
<span id="cb23-3"></span>
<span id="cb23-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Maps `go_ids` to matching GOslims</span></span>
<span id="cb23-5">mapped <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(gomap, intersect, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ids</span>(myCollection))</span>
<span id="cb23-6"></span>
<span id="cb23-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Append all mapped GO IDs to `slimdf`</span></span>
<span id="cb23-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># `sapply` needed to apply paste() to create semi-colon delimited values</span></span>
<span id="cb23-9">slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(gomap, intersect, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ids</span>(myCollection)), paste, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)</span>
<span id="cb23-10"></span>
<span id="cb23-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove "character(0) string from "GO.IDs" column</span></span>
<span id="cb23-12">slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs[slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"character(0)"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb23-13"></span>
<span id="cb23-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add self-matching GOIDs to "GO.IDs" column, if not present</span></span>
<span id="cb23-15"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (go_id <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> go_ids) {</span>
<span id="cb23-16">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the go_id is present in the row names</span></span>
<span id="cb23-17">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (go_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(slimdf)) {</span>
<span id="cb23-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the go_id is not present in the GO.IDs column</span></span>
<span id="cb23-19">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Also removes white space "trimws()" and converts all to upper case to handle</span></span>
<span id="cb23-20">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># any weird, "invisible" formatting issues.</span></span>
<span id="cb23-21">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>go_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">trimws</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">toupper</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">strsplit</span>(slimdf[go_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]))) {</span>
<span id="cb23-22">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Append the go_id to the GO.IDs column with a semi-colon separator</span></span>
<span id="cb23-23">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nchar</span>(slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(slimdf)]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb23-24">        slimdf[go_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(slimdf[go_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"; "</span>, go_id)</span>
<span id="cb23-25">      } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb23-26">        slimdf[go_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> go_id</span>
<span id="cb23-27">      }</span>
<span id="cb23-28">    }</span>
<span id="cb23-29">  }</span>
<span id="cb23-30">}</span>
<span id="cb23-31"></span>
<span id="cb23-32"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(slimdf)</span></code></pre></div>
<pre><code>'data.frame':   72 obs. of  4 variables:
 $ Count  : int  102 23 17 533 83 107 28 5 96 60 ...
 $ Percent: num  1.016 0.229 0.169 5.308 0.827 ...
 $ Term   : chr  "mitotic cell cycle" "cytokinesis" "cytoplasmic translation" "immune system process" ...
 $ GO.IDs : chr  "GO:0000022;GO:0000070;GO:0000082;GO:0000086;GO:0000132;GO:0000281;GO:0000282;GO:0001100;GO:0006977;GO:0007052;G"| __truncated__ "GO:0000281;GO:0000282;GO:0000911;GO:0000915;GO:0000917;GO:0007111;GO:0032465;GO:0032466;GO:0032467;GO:0032506;G"| __truncated__ "GO:0001731;GO:0001732;GO:0002182;GO:0002183;GO:0002190;GO:0002191;GO:0002192;GO:0140018;GO:0140708;GO:1903679;G"| __truncated__ "GO:0001771;GO:0001773;GO:0001774;GO:0001776;GO:0001777;GO:0001779;GO:0001780;GO:0001782;GO:0001805;GO:0001812;G"| __truncated__ ...</code></pre>
</section>
<section id="flatten-goslims" class="level3">
<h3 class="anchored" data-anchor-id="flatten-goslims">1.1.11 Flatten GOslims</h3>
<div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "Flatten" file so each row is single GO ID with corresponding GOslim</span></span>
<span id="cb25-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rownames_to_column needed to retain row name info</span></span>
<span id="cb25-3">slimdf_separated <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(slimdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames_to_column</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GOslim'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_rows</span>(GO.IDs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>))</span>
<span id="cb25-6"></span>
<span id="cb25-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Group by unique GO ID</span></span>
<span id="cb25-8">grouped_slimdf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> slimdf_separated <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(GO.IDs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> GO.IDs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(GO.IDs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GOslim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(GOslim, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>),</span>
<span id="cb25-12">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Term =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(Term, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>))</span>
<span id="cb25-13"></span>
<span id="cb25-14"></span>
<span id="cb25-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(grouped_slimdf)</span></code></pre></div>
<pre><code>tibble [6,903 Ã— 3] (S3: tbl_df/tbl/data.frame)
 $ GO.IDs: chr [1:6903] " GO:0000278" " GO:0002181" " GO:0002376" " GO:0003014" ...
 $ GOslim: chr [1:6903] "GO:0000278" "GO:0002181" "GO:0002376" "GO:0003014" ...
 $ Term  : chr [1:6903] "mitotic cell cycle" "cytoplasmic translation" "immune system process" "renal system process" ...</code></pre>
</section>
</section>
<section id="write-slimdf-to-file" class="level2">
<h2 class="anchored" data-anchor-id="write-slimdf-to-file">1.2 Write slimdf to file</h2>
<section id="sort-and-select-slmidf" class="level3">
<h3 class="anchored" data-anchor-id="sort-and-select-slmidf">1.2.1 Sort and select slmidf</h3>
<p>Sorts GOslims by <code>Count</code>, in descending order and then selects just the <code>Term</code> and <code>Count</code> columns.</p>
<div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1">slimdf.sorted <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> slimdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(Count))</span>
<span id="cb27-2"></span>
<span id="cb27-3">slim.count.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> slimdf.sorted <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb27-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(Term, Count)</span>
<span id="cb27-5"></span>
<span id="cb27-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(slim.count.df)</span></code></pre></div>
<pre><code>'data.frame':   72 obs. of  2 variables:
 $ Term : chr  "anatomical structure development" "cell differentiation" "signaling" "immune system process" ...
 $ Count: int  2120 941 925 533 331 316 268 267 253 244 ...</code></pre>
</section>
<section id="write-formatted-slim.count.df-to-file" class="level3">
<h3 class="anchored" data-anchor-id="write-formatted-slim.count.df-to-file">1.2.2 Write formatted slim.count.df to file</h3>
<div class="sourceCode" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_tsv</span>(slim.count.df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/01-GO-to-GOslim/counts.GOID-per-GOslim_term.tab"</span>)</span></code></pre></div>
</section>
</section>
<section id="count-unique-biological-process-go-ids" class="level2">
<h2 class="anchored" data-anchor-id="count-unique-biological-process-go-ids">1.3 Count unique Biological Process GO IDs</h2>
<div class="sourceCode" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Flatten the list and count total GO IDs</span></span>
<span id="cb30-2">total_go_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(gomap))</span>
<span id="cb30-3"></span>
<span id="cb30-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display the total count</span></span>
<span id="cb30-5">total_go_ids</span></code></pre></div>
<pre><code>[1] 26534</code></pre>
<div class="sourceCode" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Unlist to extract all GO IDs, then find unique ones and count them</span></span>
<span id="cb32-2">unique_go_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(gomap))</span>
<span id="cb32-3">total_unique_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(unique_go_ids)</span>
<span id="cb32-4"></span>
<span id="cb32-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display the total count of unique GO IDs</span></span>
<span id="cb32-6">total_unique_ids</span></code></pre></div>
<pre><code>[1] 17913</code></pre>
<p>Total starting BP GO IDs: 26534</p>
<p>Total unique BP GO IDs: 17913</p>
</section>
</section>
<section id="references" class="level1">
<h1>2 REFERENCES</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-thegene2023" class="csl-entry">
Aleksander, Suzi A, James Balhoff, Seth Carbon, J Michael Cherry, Harold J Drabkin, Dustin Ebert, Marc Feuermann, et al.&nbsp;2023. â€œThe Gene Ontology Knowledgebase in 2023.â€ Edited by A Baryshnikova. <em>GENETICS</em> 224 (1). <a href="https://doi.org/10.1093/genetics/iyad031" class="uri">https://doi.org/10.1093/genetics/iyad031</a>.
</div>
<div id="ref-ashburner2000" class="csl-entry">
Ashburner, Michael, Catherine A. Ball, Judith A. Blake, David Botstein, Heather Butler, J. Michael Cherry, Allan P. Davis, et al.&nbsp;2000. â€œGene Ontology: Tool for the Unification of Biology.â€ <em>Nature Genetics</em> 25 (1): 25â€“29. <a href="https://doi.org/10.1038/75556" class="uri">https://doi.org/10.1038/75556</a>.
</div>
<div id="ref-carlson2017" class="csl-entry">
Carlson, Marc. 2017. â€œGO.db.â€ <a href="https://doi.org/10.18129/B9.BIOC.GO.DB" class="uri">https://doi.org/10.18129/B9.BIOC.GO.DB</a>.
</div>
<div id="ref-martinmorgan2017" class="csl-entry">
Martin Morgan, Seth Falcon. 2017. â€œGSEABase.â€ <a href="https://doi.org/10.18129/B9.BIOC.GSEABASE" class="uri">https://doi.org/10.18129/B9.BIOC.GSEABASE</a>.
</div>
<div id="ref-wickham2019" class="csl-entry">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy McGowan, Romain FranÃ§ois, Garrett Grolemund, et al.&nbsp;2019. â€œWelcome to the Tidyverse.â€ <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686" class="uri">https://doi.org/10.21105/joss.01686</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2024</category>
  <category>GO</category>
  <category>gene ontology</category>
  <category>GOslim</category>
  <category>Pycnopodia helianthoides</category>
  <category>Trinity</category>
  <category>Sunflower sea star</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-06-Data-Wrangling---GO-to-GOslims-for-Pycnopodia-helianthoides-Project-from-Trinity-Assembly-Genes/</guid>
  <pubDate>Wed, 06 Nov 2024 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Sequencing Read Taxonomic Classification - Unmapped P.helanthoides RNA-seq Using DIAMOND-BLASTx and MEGAN6 on Mox</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-05-Sequencing-Read-Taxonomic-Classification---Unmapped-P.helanthoides-RNA-seq-Using-DIAMOND-BLASTx-and-MEGAN6-on-Mox/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>In preparation for a grant proposal involving sea star wasting disease, due in about two weeks, Steven <a href="https://github.com/RobertsLab/resources/issues/2009">asked that I perform taxonomic classification on unmapped P.helanthoides RNA-seq reads</a> (GitHub Issue). Due to time constraints, and a bit of luck, I opted to run this on Mox (Mox <em>should</em> have been decommissioned on 11/1/2024, but itâ€™s still running and being able to use Mox, which is already set up, instead of resorting to Klone, was much faster to get this going). Also, due to time constraints, Steven <a href="https://github.com/RobertsLab/resources/issues/2009#issuecomment-2457459109">suggested I run this on just a single set of reads</a> (GitHub Issue comment). I opted for the following, since this analysis had already been started and was already working on these:</p>
<ul>
<li><code>PSC-0519_unmapped_reads.[12].fastq</code></li>
</ul>
</section>
<section id="methods" class="level1">
<h1>METHODS</h1>
<section id="diamond-blastx-and-meganization" class="level2">
<h2 class="anchored" data-anchor-id="diamond-blastx-and-meganization">DIAMOND BLASTx and MEGANization</h2>
<p>Reads were <a href="https://github.com/bbuchfink/diamond"><code>DIAMOND</code></a> BLASTxâ€™d against a previously constructed DIAMON BLAST database. After <a href="https://github.com/bbuchfink/diamond"><code>DIAMOND</code></a> BLASTx, the resulting DAA files were â€œMEGANizedâ€ in preparation for use in <a href="https://software-ab.cs.uni-tuebingen.de/download/megan6/welcome.html">MEGAN6</a>. Both steps were run on Mox.</p>
<section id="sbatch-script" class="level3">
<h3 class="anchored" data-anchor-id="sbatch-script">SBATCH SCRIPT</h3>
<p>GitHub:</p>
<ul>
<li><a href="https://github.com/RobertsLab/sams-notebook/blob/master/sbatch_scripts/20241105-phel-diamond-meganizer.sh">20241105-phel-diamond-meganizer.sh</a></li>
</ul>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Job Name</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --job-name=20241105-phel-diamond-meganizer</span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Allocation Definition</span></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --account=srlab</span></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --partition=srlab</span></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Resources</span></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Nodes</span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --nodes=1</span></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Walltime (days-hours:minutes:seconds format)</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --time=7-00:00:00</span></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Memory per node</span></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mem=120G</span></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##turn on e-mail notification</span></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-type=ALL</span></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-user=samwhite@uw.edu</span></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Specify the working directory for this job</span></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --chdir=/gscratch/scrubbed/samwhite/outputs/20241105-phel-diamond-meganizer</span></span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Perform DIAMOND BLASTx on unmapped P.helanthoides RNA-seq files from Steven.</span></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Will be used to view taxonomic breakdown of sequencing reads.</span></span>
<span id="cb1-22"></span>
<span id="cb1-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Expects input FastQ files to be match this pattern: *reads.[12].fastq</span></span>
<span id="cb1-24"></span>
<span id="cb1-25"></span>
<span id="cb1-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################</span></span>
<span id="cb1-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># These variables need to be set by user</span></span>
<span id="cb1-28"></span>
<span id="cb1-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Assign Variables</span></span>
<span id="cb1-30"></span>
<span id="cb1-31"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_pattern</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'*reads.[12].fastq'</span></span>
<span id="cb1-32"></span>
<span id="cb1-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Program paths</span></span>
<span id="cb1-34"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">diamond</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/gscratch/srlab/programs/diamond-v2.1.1/diamond</span>
<span id="cb1-35"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">meganizer</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/gscratch/srlab/programs/MEGAN-6.22.0/tools/daa-meganizer</span>
<span id="cb1-36"></span>
<span id="cb1-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># DIAMOND NCBI nr database</span></span>
<span id="cb1-38"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dmnd_db</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/gscratch/srlab/blastdbs/20230215-ncbi-nr/20230215-ncbi-nr.dmnd</span>
<span id="cb1-39"></span>
<span id="cb1-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># MEGAN mapping files</span></span>
<span id="cb1-41"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">megan_mapping_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/gscratch/srlab/sam/data/databases/MEGAN</span>
<span id="cb1-42"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">megan_mapdb</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${megan_mapping_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/megan-map-Feb2022.db"</span></span>
<span id="cb1-43"></span>
<span id="cb1-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># FastQ files directory</span></span>
<span id="cb1-45"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/gscratch/scrubbed/samwhite/data/P_helianthoides/RNAseq</span>
<span id="cb1-46"></span>
<span id="cb1-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># CPU threads</span></span>
<span id="cb1-48"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">threads</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>40</span>
<span id="cb1-49"></span>
<span id="cb1-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># MEGAN memory limit</span></span>
<span id="cb1-51"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mem_limit</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>100G</span>
<span id="cb1-52"></span>
<span id="cb1-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Programs associative array</span></span>
<span id="cb1-54"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">declare</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span></span>
<span id="cb1-55"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb1-56"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>diamond<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${diamond}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-57"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">meganizer</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${meganizer}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-58"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-59"></span>
<span id="cb1-60"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################################</span></span>
<span id="cb1-61"></span>
<span id="cb1-62"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Exit script if any command fails</span></span>
<span id="cb1-63"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span></span>
<span id="cb1-64"></span>
<span id="cb1-65"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load Python Mox module for Python module availability</span></span>
<span id="cb1-66"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load intel-python3_2017</span>
<span id="cb1-67"></span>
<span id="cb1-68"></span>
<span id="cb1-69"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop through FastQ files, log filenames to fastq_list.txt.</span></span>
<span id="cb1-70"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run DIAMOND on each FastQ, followed by "MEGANization"</span></span>
<span id="cb1-71"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># DO NOT QUOTE ${fastq_pattern}</span></span>
<span id="cb1-72"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_pattern}</span></span>
<span id="cb1-73"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb1-74">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Log input FastQs</span></span>
<span id="cb1-75">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-76">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Generating MD5 checksum for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">..."</span></span>
<span id="cb1-77">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--append</span> input_fastqs-checksums.md5</span>
<span id="cb1-78">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-79"></span>
<span id="cb1-80">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Strip leading path ${fastq##*/} by eliminating all text up to and including last slash from the left side.</span></span>
<span id="cb1-81">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Strip extensions by eliminating ".fastq.gz" from the right side.</span></span>
<span id="cb1-82">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">no_path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-83">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">no_ext</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${no_path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>.fastq<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-84"></span>
<span id="cb1-85">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run DIAMOND with blastx</span></span>
<span id="cb1-86">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output format 100 produces a DAA binary file for use with MEGAN</span></span>
<span id="cb1-87">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Running DIAMOND BLASTx on </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">."</span></span>
<span id="cb1-88">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-89">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>diamond<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> blastx <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-90">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--db</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${dmnd_db}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--query</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--out</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${no_ext}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.blastx.meganized.daa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-93">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--outfmt</span> 100 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--top</span> 5 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-95">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--block-size</span> 15.0 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-96">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--index-chunks</span> 4 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-97">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--memory-limit</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${mem_limit}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-98">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--threads</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span></span>
<span id="cb1-99">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DIAMOND BLASTx on </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> complete: </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${no_ext}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.blastx.meganized.daa"</span></span>
<span id="cb1-100">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-101"></span>
<span id="cb1-102">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Meganize DAA files</span></span>
<span id="cb1-103">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Used for ability to import into MEGAN6</span></span>
<span id="cb1-104">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Now MEGANizing </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${no_ext}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.blastx.meganized.daa"</span></span>
<span id="cb1-105">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>meganizer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${no_ext}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.blastx.meganized.daa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-107">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--threads</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-108">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--mapDB</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${megan_mapdb}</span></span>
<span id="cb1-109">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MEGANization of </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${no_ext}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.blastx.meganized.daa completed."</span></span>
<span id="cb1-110">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-111"></span>
<span id="cb1-112"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb1-113"></span>
<span id="cb1-114"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate MD5 checksums</span></span>
<span id="cb1-115"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb1-116"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb1-117">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-118">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Generating MD5 checksums for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:"</span></span>
<span id="cb1-119">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--append</span> checksums.md5</span>
<span id="cb1-120">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-121"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb1-122"></span>
<span id="cb1-123"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate checksum for MEGAN database(s)</span></span>
<span id="cb1-124"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-125">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${megan_mapdb}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-126">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${dmnd_db}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-127"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> checksums.md5</span>
<span id="cb1-128"></span>
<span id="cb1-129"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#######################################################################################################</span></span>
<span id="cb1-130"></span>
<span id="cb1-131"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Capture program options</span></span>
<span id="cb1-132"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-gt</span> 0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb1-133">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Logging program options..."</span></span>
<span id="cb1-134">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> program <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-135">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb1-136">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-137">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Program options for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">: "</span></span>
<span id="cb1-138">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-139">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle samtools help menus</span></span>
<span id="cb1-140">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_index"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-141">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_sort"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-142">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_view"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]]</span></span>
<span id="cb1-143">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb1-144">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-145"></span>
<span id="cb1-146">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle DIAMOND BLAST menu</span></span>
<span id="cb1-147">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"diamond"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb1-148">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> help</span>
<span id="cb1-149"></span>
<span id="cb1-150">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle NCBI BLASTx menu</span></span>
<span id="cb1-151">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blastx"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb1-152">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-help</span></span>
<span id="cb1-153">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb1-154">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-h</span></span>
<span id="cb1-155">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-156">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-157">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"----------------------------------------------"</span></span>
<span id="cb1-158">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-159">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-160">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&gt;&gt;</span> program_options.log <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb1-161"></span>
<span id="cb1-162">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If MultiQC is in programs_array, copy the config file to this directory.</span></span>
<span id="cb1-163">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"multiqc"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb1-164">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cp</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--preserve</span> ~/.multiqc_config.yaml multiqc_config.yaml</span>
<span id="cb1-165">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb1-166">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb1-167">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Finished logging programs options."</span></span>
<span id="cb1-168">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-169"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb1-170"></span>
<span id="cb1-171"></span>
<span id="cb1-172"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Document programs in PATH (primarily for program version ID)</span></span>
<span id="cb1-173"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Logging system </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$PATH</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">..."</span></span>
<span id="cb1-174"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-175"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">date</span></span>
<span id="cb1-176"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-177"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"System PATH for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$SLURM_JOB_ID</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-178"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-179"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%0.s-"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">..</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-180"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${PATH}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tr</span> : <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\\</span>n</span>
<span id="cb1-181"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> system_path.log</span>
<span id="cb1-182"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Finished logging system </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$PATH</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">."</span></span></code></pre></div>
</section>
</section>
<section id="daa-to-rma-conversion" class="level2">
<h2 class="anchored" data-anchor-id="daa-to-rma-conversion">DAA to RMA Conversion</h2>
<p>Resulting DAA files were converted to RMA6 format for import and analysis in MEGAN6. Due to time constraints, this was performed on Raven without a script. Command used:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/megan-6.24.20/tools/daa2rma</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-2">--in ./PSC-0519_unmapped_reads.1.blastx.meganized.daa ./PSC-0519_unmapped_reads.2.blastx.meganized.daa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-3">--mapDB ~/data/databases/MEGAN/megan-map-Feb2022.db <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-4">--out ./PSC-0519_unmapped_reads.1.blastx.meganized.rma6 ./PSC-0519_unmapped_reads.2.blastx.meganized.rma6 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-5">--threads 40 <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--append</span> daa2rma_log.txt</span></code></pre></div>
</section>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<p>The Mox run took just under 16hrs to complete:</p>
<div id="fig-mox_runtime" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="Screencap showing Mox runtime of 15hrs 42mins and 41secs for DIAMOND BLASTx.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mox_runtime-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241105-phel-mox-runtime.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Screencap showing Mox runtime of 15hrs 42mins and 41secs for DIAMOND BLASTx."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-11-05-Sequencing-Read-Taxonomic-Classification---Unmapped-P.helanthoides-RNA-seq-Using-DIAMOND-BLASTx-and-MEGAN6-on-Mox/20241105-phel-mox-runtime.png" class="img-fluid figure-img" alt="Screencap showing Mox runtime of 15hrs 42mins and 41secs for DIAMOND BLASTx."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mox_runtime-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Screencap showing Mox runtime of 15hrs 42mins and 41secs for DIAMOND BLASTx.
</figcaption>
</figure>
</div>
</section>
<section id="discussion" class="level1">
<h1>DISCUSSION</h1>
<p>Looking at the entire taxonomies, down to the species level, most of the reads (&gt;1,500,000) get assigned to <a href="https://en.wikipedia.org/wiki/Common_starfish"><em>Asterias rubens</em></a> (Wikipedia), the common sea star. This is surprising, as Iâ€™m fairly certain these sequencing reads came from <a href="https://en.wikipedia.org/wiki/Sunflower_sea_star"><em>Pycnopodia helianthoides</em></a> (Wikipedia), the sunflower star. Of course, these results are also dependent upon how much sequence data in NCBI for any given species. However, with that said, reads are only assigned to a given taxonomic level based on the BLASTx results. Thus, even if a read comes from a sea star, it would (should?) <em>not</em> get assigned to a particular species unless the BLASTx confidence was <em>very</em> highâ€¦</p>
<p>Looking at the highest read assignments for non-eukaryotic species, we see that of the Bacteria (7,153 reads), <a href="https://link.springer.com/article/10.1007/s10482-019-01348-7"><em>Bacillus yapensis</em></a> (Journal article website), while in Archae (17,742 reads), <a href="https://en.wikipedia.org/wiki/Methanocaldococcus_jannaschii"><em>Methanocaldococcus jannaschii</em></a> (Wikipedia) had the most reads assigned.</p>
<div id="fig-mox_runtime" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="MEGAN6 taxonomic heat map of assignments down to species level. Darkest green box shows highest numbers of reads assigned to _Asterias rubens_.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mox_runtime-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://gannet.fish.washington.edu/Atumefaciens/20241105-phel-diamond-meganizer/PSC-0519_unmapped_reads.1.blastx.meganized-all-heatmap.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: MEGAN6 taxonomic heat map of assignments down to Species level. Darkest green box shows highest numbers of reads assigned to Asterias rubens."><img src="https://gannet.fish.washington.edu/Atumefaciens/20241105-phel-diamond-meganizer/PSC-0519_unmapped_reads.1.blastx.meganized-all-heatmap.jpg" class="img-fluid figure-img" alt="MEGAN6 taxonomic heat map of assignments down to species level. Darkest green box shows highest numbers of reads assigned to _Asterias rubens_."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mox_runtime-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: MEGAN6 taxonomic heat map of assignments down to Species level. Darkest green box shows highest numbers of reads assigned to <em>Asterias rubens</em>.
</figcaption>
</figure>
</div>
<div id="fig-mox_runtime" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="MEGAN6 taxonomic heat map of assignments down to Class level. Top Class in Eukaryotes (Astroides), Bacteria (Bacilli), and Archae (Methanococci) are highlighted in yellow.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mox_runtime-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://gannet.fish.washington.edu/Atumefaciens/20241105-phel-diamond-meganizer/PSC-0519_unmapped_reads.1.blastx.meganized-class-heatmap.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: MEGAN6 taxonomic heat map of assignments down to Class level. Top Class in Eukaryotes (Astroides), Bacteria (Bacilli), and Archae (Methanococci) are highlighted in yellow."><img src="https://gannet.fish.washington.edu/Atumefaciens/20241105-phel-diamond-meganizer/PSC-0519_unmapped_reads.1.blastx.meganized-class-heatmap.jpg" class="img-fluid figure-img" alt="MEGAN6 taxonomic heat map of assignments down to Class level. Top Class in Eukaryotes (Astroides), Bacteria (Bacilli), and Archae (Methanococci) are highlighted in yellow."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mox_runtime-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: MEGAN6 taxonomic heat map of assignments down to Class level. Top Class in Eukaryotes (Astroides), Bacteria (Bacilli), and Archae (Methanococci) are highlighted in yellow.
</figcaption>
</figure>
</div>
<section id="output-files" class="level2">
<h2 class="anchored" data-anchor-id="output-files">Output files</h2>
<p>Output directory:</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/20241105-phel-diamond-meganizer/">https://gannet.fish.washington.edu/Atumefaciens/20241105-phel-diamond-meganizer/</a></li>
</ul>
<section id="diamond-blastxmeganizer" class="level3">
<h3 class="anchored" data-anchor-id="diamond-blastxmeganizer">DIAMOND BLASTX/MEGANIZER</h3>
<p>Output files:</p>
<ul>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20241105-phel-diamond-meganizer/PSC-0519_unmapped_reads.1.blastx.meganized.daa"><code>PSC-0519_unmapped_reads.1.blastx.meganized.daa</code></a> (186GB)</p>
<ul>
<li>MD5: <code>1e7207fa8dc3ff15373f46c4e0c5bbb3</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20241105-phel-diamond-meganizer/PSC-0519_unmapped_reads.2.blastx.meganized.daa"><code>PSC-0519_unmapped_reads.2.blastx.meganized.daa</code></a> (179GB)</p>
<ul>
<li>MD5: <code>4e5514926056f0f3273b44da6c3ed7df</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20241105-phel-diamond-meganizer/checksums.md5"><code>checksums.md5</code></a></p></li>
</ul>
</section>
<section id="rma6" class="level3">
<h3 class="anchored" data-anchor-id="rma6">RMA6</h3>
<ul>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20241105-phel-diamond-meganizer/PSC-0519_unmapped_reads.1.blastx.meganized.rma6"><code>PSC-0519_unmapped_reads.1.blastx.meganized.rma6</code></a></p>
<ul>
<li>MD5: <code>b5f0118056d1b3481b5533e420146728</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20241105-phel-diamond-meganizer/PSC-0519_unmapped_reads.2.blastx.meganized.rma6"><code>PSC-0519_unmapped_reads.2.blastx.meganized.rma6</code></a></p>
<ul>
<li>MD5: <code>4e88764010274baccafffe58f67134d2</code></li>
</ul></li>
</ul>


</section>
</section>
</section>

 ]]></description>
  <category>2024</category>
  <category>MEGAN6</category>
  <category>RNAseq</category>
  <category>DIAMOND</category>
  <category>BLASTx</category>
  <category>Pycnopodia helianthoides</category>
  <category>sunflower sea star</category>
  <category>Mox</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-05-Sequencing-Read-Taxonomic-Classification---Unmapped-P.helanthoides-RNA-seq-Using-DIAMOND-BLASTx-and-MEGAN6-on-Mox/</guid>
  <pubDate>Tue, 05 Nov 2024 08:00:00 GMT</pubDate>
  <media:content url="https://robertslab.github.io/sams-notebook/posts/2024/2024-11-05-Sequencing-Read-Taxonomic-Classification---Unmapped-P.helanthoides-RNA-seq-Using-DIAMOND-BLASTx-and-MEGAN6-on-Mox/PSC-0519_unmapped_reads.1.blastx.meganized-all-heatmap.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Data Received - Manila clam Supplemental sRNA-seq Data from Azenta</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-01-Data-Received---Manila-clam-Supplemental-sRNA-seq-Data-from-Azenta/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>Received supplemental sRNA-seq data for Azenta Project 30-1035633055, since the <a href="../../../posts/2024/2024-10-01-Data-Received---R.philippinarum-(Manilla-clam)-sRNA-seq-Data-from-Azenta-Project-30-1035633055/index.html">previous data sent</a> (Notebook) didnâ€™t amount to the minimum expected read count for a number of samples. Azenta agreed to perform additional sequencing to reach that threshold.</p>
<p>Data was downloaded to:</p>
<p>https://owl.fish.washington.edu/nightingales/R_philippinarum/30-1035633055-TS01/</p>
<p>MD5 checksums were verified:</p>
<div id="fig-ladder" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="Screenshot showing successful MD5 checksum verifications.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241101-rphi-md5-checksums-screenshot.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Screenshot showing successful MD5 checksum verifications."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-11-01-Data-Received---Manila-clam-Supplemental-sRNA-seq-Data-from-Azenta/20241101-rphi-md5-checksums-screenshot.png" class="img-fluid figure-img" alt="Screenshot showing successful MD5 checksum verifications."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Screenshot showing successful MD5 checksum verifications.
</figcaption>
</figure>
</div>
<p>Since it appears that there is sequencing data for <em>all</em> samples, it probably make sense to concatenate this supplemental data to the initial run, but Iâ€™ll check with Steven before doing so.</p>


</section>

 ]]></description>
  <category>2024</category>
  <category>sRNA-seq</category>
  <category>Manila clam</category>
  <category>Ruditapes philippinarum</category>
  <category>30-1035633055</category>
  <category>30-1035633055-TS01</category>
  <category>Data Received</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-01-Data-Received---Manila-clam-Supplemental-sRNA-seq-Data-from-Azenta/</guid>
  <pubDate>Fri, 01 Nov 2024 07:00:00 GMT</pubDate>
  <media:content url="https://robertslab.github.io/sams-notebook/posts/2024/2024-11-01-Data-Received---Manila-clam-Supplemental-sRNA-seq-Data-from-Azenta/20241101-rphi-md5-checksums-screenshot.png" medium="image" type="image/png" height="118" width="144"/>
</item>
<item>
  <title>Data Received - Mytilus trossulus WGBS Data from Psomagen</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-01-Data-Received---Mytilus-trossulus-WGBS-Data-from-Psomagen/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>Received WGBS data for Chrisâ€™ Psomagen Project AN00021156.</p>
<p>Data was downloaded to:</p>
<p>https://owl.fish.washington.edu/nightingales/M_trossulus/</p>
<p>MD5 checksums were verified:</p>
<div id="fig-ladder" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="Screenshot showing successful MD5 checksum verifications.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241101-mtro-md5sum-check-screenshot.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Screenshot showing successful MD5 checksum verifications."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-11-01-Data-Received---Mytilus-trossulus-WGBS-Data-from-Psomagen/20241101-mtro-md5sum-check-screenshot.png" class="img-fluid figure-img" alt="Screenshot showing successful MD5 checksum verifications."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Screenshot showing successful MD5 checksum verifications.
</figcaption>
</figure>
</div>


</section>

 ]]></description>
  <category>2024</category>
  <category>Mytilus trossulus</category>
  <category>bay mussel</category>
  <category>WGBS</category>
  <category>Psomagen</category>
  <category>AN00021156</category>
  <category>BS-seq</category>
  <category>bisulfite sequencing</category>
  <category>Data Received</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-01-Data-Received---Mytilus-trossulus-WGBS-Data-from-Psomagen/</guid>
  <pubDate>Fri, 01 Nov 2024 07:00:00 GMT</pubDate>
</item>
<item>
  <title>Daily Bits - November 2024</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-01-Daily-Bits---November-2024/</link>
  <description><![CDATA[ 





<section id="section" class="level1">

<section id="miscellaneous" class="level2">

<ul>
<li><a href="https://github.com/RobertsLab/resources/issues/2002">Installed RepeatMasker on Raven</a> (GitHub Issue). Installed with <code>dfam38_full.0.h5</code> repeats partition/database. Deatils on the database here: https://github.com/Dfam-consortium/FamDB. This was a lengthy procees. Glad its done!</li>
</ul>
</section>
<section id="science-hour" class="level2">

<ul>
<li>Downloaded Chrisâ€™s <a href="https://en.wikipedia.org/wiki/Mytilus_trossulus"><em>Mytilus trossulus</em> (bay mussel)</a> WGBS data from Psomagen.</li>
</ul>


</section>
</section>

 ]]></description>
  <category>2024</category>
  <category>Daily Bits</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-11-01-Daily-Bits---November-2024/</guid>
  <pubDate>Fri, 01 Nov 2024 07:00:00 GMT</pubDate>
</item>
<item>
  <title>Data Wrangling - Get GOslims from GO IDs for Graces Pycnopodia helianthoides Project</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-30-Data-Wrangling---Get-GOslims-from-GO-IDs-for-Graces-Pycnopodia-helianthoides-Project/</link>
  <description><![CDATA[ 





<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This notebook consists of a markdown rendering of <a href="https://github.com/RobertsLab/code/blob/351b2ad5a31fac96f48da84c76955cab2c506d28/r_projects/sam/20241030-phel-GO-to-GOslim/code/01-GO-to-GOslim.Rmd">01-GO-to-GOslim.Rmd</a> (commit: <code>351b2ad</code>).</p>
</div>
</div>
<section id="intro" class="level1">
<h1>1 INTRO</h1>
<p>This notebook is setup to <a href="https://github.com/RobertsLab/resources/issues/1989">take GO IDs and categorize them into their corresponding GOslims</a> (GitHub Issue). Specifically, it will use the following tab-delimited input file:</p>
<ul>
<li><a href="https://raw.githubusercontent.com/grace-ac/paper-pycno-sswd-2021-2022/d1cdf13c36085868df4ef4b75d2b7de03ef08d1c/analyses/25-compare-2021-2022/DEGlist_same_2021-2022_forGOslim.tab">DEGlist_same_2021-2022_forGOslim.tab</a> (commit: <code>d1cdf13</code>)</li>
</ul>
<p><a href="https://github.com/RobertsLab/resources/issues/1989#issuecomment-2448757444">Desired output format</a> (GitHub Issue comment) is:</p>
<pre><code>Term                                                    Count
anatomical structure development                        1137
signaling                                               600
cell differentiation                                    533
immune system process                                   331
lipid metabolic process                                 212</code></pre>
<p>This was performed using R, with the following packages:</p>
<ul>
<li>GSEABase (Martin Morgan 2017)</li>
<li>GO.db (Carlson 2017)</li>
<li>tidyverse (Wickham et al.&nbsp;2019)</li>
</ul>
<p>It also relied on gene ontology (GO) information from the <a href="https://geneontology.org/">Gene Ontology Consortium</a> (Ashburner et al.&nbsp;2000; Aleksander et al.&nbsp;2023).</p>
<section id="code" class="level2">
<h2 class="anchored" data-anchor-id="code">1.1 CODE</h2>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(GSEABase)</span></code></pre></div>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(GO.db)</span></code></pre></div>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(knitr)</span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span></code></pre></div>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>opts_chunk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set</span>(</span>
<span id="cb5-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">echo =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display code chunks</span></span>
<span id="cb5-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">eval =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Evaluate code chunks</span></span>
<span id="cb5-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">warning =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hide warnings</span></span>
<span id="cb5-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">message =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hide messages</span></span>
<span id="cb5-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">comment =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prevents appending '##' to beginning of lines in code output</span></span>
<span id="cb5-7">)</span></code></pre></div>
<section id="variables" class="level3">
<h3 class="anchored" data-anchor-id="variables">1.1.1 Variables</h3>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Column names corresponding to gene name/ID and GO IDs</span></span>
<span id="cb6-2">GO.ID.column <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene.Ontology.IDs"</span></span>
<span id="cb6-3">gene.ID.column <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span></span>
<span id="cb6-4"></span>
<span id="cb6-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Relative path or URL to input file</span></span>
<span id="cb6-6">input.file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/grace-ac/paper-pycno-sswd-2021-2022/d1cdf13c36085868df4ef4b75d2b7de03ef08d1c/analyses/25-compare-2021-2022/DEGlist_same_2021-2022_forGOslim.tab"</span></span>
<span id="cb6-7"></span>
<span id="cb6-8"></span>
<span id="cb6-9"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##### Official GO info - no need to change #####</span></span>
<span id="cb6-10">goslims_obo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"goslim_generic.obo"</span></span>
<span id="cb6-11">goslims_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"http://current.geneontology.org/ontology/subsets/goslim_generic.obo"</span></span></code></pre></div>
</section>
<section id="set-gseabase-location-and-download-goslim_generic.obo" class="level3">
<h3 class="anchored" data-anchor-id="set-gseabase-location-and-download-goslim_generic.obo">1.1.2 Set GSEAbase location and download <code>goslim_generic.obo</code></h3>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Find GSEAbase installation location</span></span>
<span id="cb7-2">gseabase_location <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find.package</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GSEABase"</span>)</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load path to GOslim OBO file</span></span>
<span id="cb7-5">goslim_obo_destintation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(gseabase_location, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"extdata"</span>, goslims_obo, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fsep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/"</span>)</span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Download the GOslim OBO file</span></span>
<span id="cb7-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">download.file</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">url =</span> goslims_url, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">destfile =</span> goslim_obo_destintation)</span>
<span id="cb7-9"></span>
<span id="cb7-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loads package files</span></span>
<span id="cb7-11">gseabase_files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"extdata"</span>, goslims_obo, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GSEABase"</span>)</span></code></pre></div>
</section>
<section id="read-in-genego-file" class="level3">
<h3 class="anchored" data-anchor-id="read-in-genego-file">1.1.3 Read in gene/GO file</h3>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">full.gene.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> input.file, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb8-2"></span>
<span id="cb8-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(full.gene.df)</span></code></pre></div>
<pre><code>'data.frame':   4114 obs. of  3 variables:
 $ gene_id          : chr  "g21712" "g21713" "g15181" "g15182" ...
 $ uniprot_accession: chr  "P54985" "Q8TDM6" NA NA ...
 $ Gene.Ontology.IDs: chr  "GO:0003755; GO:0005737; GO:0006457; GO:0043231" "GO:0001837; GO:0005737; GO:0005886; GO:0005912; GO:0007165; GO:0008013; GO:0008092; GO:0008285; GO:0014069; GO:"| __truncated__ NA NA ...</code></pre>
</section>
<section id="remove-rows-with-na-remove-whitespace-in-go-ids-column-and-keep-just-genego-ids-columns" class="level3">
<h3 class="anchored" data-anchor-id="remove-rows-with-na-remove-whitespace-in-go-ids-column-and-keep-just-genego-ids-columns">1.1.4 Remove rows with NA, remove whitespace in GO IDs column and keep just gene/GO IDs columns</h3>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clean whitespace, filter NA/empty rows, select columns, and split GO terms using column name variables</span></span>
<span id="cb10-2">gene.GO.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> full.gene.df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GO.ID.column :=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(.data[[GO.ID.column]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">s*;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">s*"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clean up spaces around ";"</span></span>
<span id="cb10-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(.data[[gene.ID.column]]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(.data[[GO.ID.column]]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> .data[[GO.ID.column]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb10-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all_of</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(gene.ID.column, GO.ID.column)))</span>
<span id="cb10-6"></span>
<span id="cb10-7"></span>
<span id="cb10-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(gene.GO.df)</span></code></pre></div>
<pre><code>'data.frame':   3295 obs. of  2 variables:
 $ gene_id          : chr  "g21712" "g21713" "g15183" "g7651" ...
 $ Gene.Ontology.IDs: chr  "GO:0003755;GO:0005737;GO:0006457;GO:0043231" "GO:0001837;GO:0005737;GO:0005886;GO:0005912;GO:0007165;GO:0008013;GO:0008092;GO:0008285;GO:0014069;GO:0030011;G"| __truncated__ "GO:0000785;GO:0000978;GO:0000981;GO:0001228;GO:0001657;GO:0001701;GO:0001706;GO:0001707;GO:0003140;GO:0003180;G"| __truncated__ "GO:0005543;GO:0005737;GO:0005768;GO:0005829;GO:0005886;GO:0006897;GO:0007010;GO:0007015;GO:0030100;GO:0030659;G"| __truncated__ ...</code></pre>
</section>
<section id="flatten-gene-and-go-ids" class="level3">
<h3 class="anchored" data-anchor-id="flatten-gene-and-go-ids">1.1.5 â€œFlattenâ€ gene and GO IDs</h3>
<p>This flattens the file so all of the GO IDs per gene are separated into one GO ID per gene per row.</p>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">flat.gene.GO.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene.GO.df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_rows</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sym</span>(GO.ID.column), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)</span>
<span id="cb12-2"></span>
<span id="cb12-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(flat.gene.GO.df)</span></code></pre></div>
<pre><code>tibble [42,028 Ã— 2] (S3: tbl_df/tbl/data.frame)
 $ gene_id          : chr [1:42028] "g21712" "g21712" "g21712" "g21712" ...
 $ Gene.Ontology.IDs: chr [1:42028] "GO:0003755" "GO:0005737" "GO:0006457" "GO:0043231" ...</code></pre>
</section>
<section id="group" class="level3">
<h3 class="anchored" data-anchor-id="group">1.1.6 Group</h3>
<p>Groups the genes by GO ID (i.e.&nbsp;lists all genes associated with each unique GO ID)</p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">grouped.gene.GO.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> flat.gene.GO.df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sym</span>(GO.ID.column)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene.ID.column :=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(.data[[gene.ID.column]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>))</span>
<span id="cb14-4"></span>
<span id="cb14-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(grouped.gene.GO.df)</span></code></pre></div>
<pre><code>tibble [8,666 Ã— 2] (S3: tbl_df/tbl/data.frame)
 $ Gene.Ontology.IDs: chr [1:8666] "GO:0000012" "GO:0000014" "GO:0000015" "GO:0000025" ...
 $ gene_id          : chr [1:8666] "g22030,g22031,g16480,g4241" "g13422,g21327" "g12040" "g9214" ...</code></pre>
</section>
<section id="map-go-ids-to-goslims" class="level3">
<h3 class="anchored" data-anchor-id="map-go-ids-to-goslims">1.1.7 Map GO IDs to GOslims</h3>
<p>The mapping steps were derived from this <a href="https://support.bioconductor.org/p/128407/#128408">bioconductor forum response</a></p>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Vector of GO IDs</span></span>
<span id="cb16-2">go_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> grouped.gene.GO.df[[GO.ID.column]]</span>
<span id="cb16-3"></span>
<span id="cb16-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(go_ids)</span></code></pre></div>
<pre><code> chr [1:8666] "GO:0000012" "GO:0000014" "GO:0000015" "GO:0000025" ...</code></pre>
</section>
<section id="extract-goslims-from-obo" class="level3">
<h3 class="anchored" data-anchor-id="extract-goslims-from-obo">1.1.8 Extract GOslims from OBO</h3>
<p>Creates new OBO Collection object of just GOslims, based on provided GO IDs.</p>
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create GSEAbase GOCollection using `go_ids`</span></span>
<span id="cb18-2">myCollection <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">GOCollection</span>(go_ids)</span>
<span id="cb18-3"></span>
<span id="cb18-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Retrieve GOslims from GO OBO file set</span></span>
<span id="cb18-5">slim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getOBOCollection</span>(gseabase_files)</span>
<span id="cb18-6"></span>
<span id="cb18-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(slim)</span></code></pre></div>
<pre><code>Formal class 'OBOCollection' [package "GSEABase"] with 7 slots
  ..@ .stanza     :'data.frame':    153 obs. of  1 variable:
  .. ..$ value: chr [1:153] "Root" "Term" "Term" "Term" ...
  ..@ .subset     :'data.frame':    22 obs. of  1 variable:
  .. ..$ value: chr [1:22] "Rhea list of ChEBI terms representing the major species at pH 7.3." "Term not to be used for direct annotation" "Terms planned for obsoletion" "AGR slim" ...
  ..@ .kv         :'data.frame':    2075 obs. of  3 variables:
  .. ..$ stanza_id: chr [1:2075] ".__Root__" ".__Root__" ".__Root__" ".__Root__" ...
  .. ..$ key      : chr [1:2075] "format-version" "data-version" "synonymtypedef" "synonymtypedef" ...
  .. ..$ value    : chr [1:2075] "1.2" "go/2024-09-08/subsets/goslim_generic.owl" "syngo_official_label \"label approved by the SynGO project\"" "systematic_synonym \"Systematic synonym\" EXACT" ...
  ..@ evidenceCode: chr [1:26] "EXP" "IDA" "IPI" "IMP" ...
  ..@ ontology    : chr NA
  ..@ ids         : chr [1:141] "GO:0000228" "GO:0000278" "GO:0000910" "GO:0001618" ...
  ..@ type        : chr "OBO"</code></pre>
</section>
<section id="get-biological-process-bp-goslims-associated-with-provided-go-ids." class="level3">
<h3 class="anchored" data-anchor-id="get-biological-process-bp-goslims-associated-with-provided-go-ids.">1.1.9 Get Biological Process (BP) GOslims associated with provided GO IDs.</h3>
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Retrieve Biological Process (BP) GOslims</span></span>
<span id="cb20-2">slimdf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">goSlim</span>(myCollection, slim, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BP"</span>, verbose)</span>
<span id="cb20-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(slimdf)</span></code></pre></div>
<pre><code>'data.frame':   72 obs. of  3 variables:
 $ Count  : int  45 12 8 331 37 51 13 3 58 38 ...
 $ Percent: num  0.793 0.211 0.141 5.834 0.652 ...
 $ Term   : chr  "mitotic cell cycle" "cytokinesis" "cytoplasmic translation" "immune system process" ...</code></pre>
</section>
<section id="map-go-to-goslims" class="level3">
<h3 class="anchored" data-anchor-id="map-go-to-goslims">1.1.10 Map GO to GOslims</h3>
<p>Performs mapping of of GOIDs to GOslims</p>
<p>Returns:</p>
<ul>
<li>GOslim IDs (as rownames)</li>
<li>GOslim terms</li>
<li>Counts of GO IDs matching to corresponding GOslim</li>
<li>Percentage of GO IDs matching to corresponding GOslim</li>
<li>GOIDs mapped to corresponding GOslim, in a semi-colon delimited format</li>
</ul>
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># List of GOslims and all GO IDs from `go_ids`</span></span>
<span id="cb22-2">gomap <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.list</span>(GOBPOFFSPRING[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(slimdf)])</span>
<span id="cb22-3"></span>
<span id="cb22-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Maps `go_ids` to matching GOslims</span></span>
<span id="cb22-5">mapped <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(gomap, intersect, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ids</span>(myCollection))</span>
<span id="cb22-6"></span>
<span id="cb22-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Append all mapped GO IDs to `slimdf`</span></span>
<span id="cb22-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># `sapply` needed to apply paste() to create semi-colon delimited values</span></span>
<span id="cb22-9">slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(gomap, intersect, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ids</span>(myCollection)), paste, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)</span>
<span id="cb22-10"></span>
<span id="cb22-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove "character(0) string from "GO.IDs" column</span></span>
<span id="cb22-12">slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs[slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"character(0)"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb22-13"></span>
<span id="cb22-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add self-matching GOIDs to "GO.IDs" column, if not present</span></span>
<span id="cb22-15"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (go_id <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> go_ids) {</span>
<span id="cb22-16">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the go_id is present in the row names</span></span>
<span id="cb22-17">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (go_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(slimdf)) {</span>
<span id="cb22-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the go_id is not present in the GO.IDs column</span></span>
<span id="cb22-19">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Also removes white space "trimws()" and converts all to upper case to handle</span></span>
<span id="cb22-20">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># any weird, "invisible" formatting issues.</span></span>
<span id="cb22-21">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>go_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">trimws</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">toupper</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">strsplit</span>(slimdf[go_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]))) {</span>
<span id="cb22-22">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Append the go_id to the GO.IDs column with a semi-colon separator</span></span>
<span id="cb22-23">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nchar</span>(slimdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>GO.IDs[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(slimdf)]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb22-24">        slimdf[go_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(slimdf[go_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"; "</span>, go_id)</span>
<span id="cb22-25">      } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb22-26">        slimdf[go_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> go_id</span>
<span id="cb22-27">      }</span>
<span id="cb22-28">    }</span>
<span id="cb22-29">  }</span>
<span id="cb22-30">}</span>
<span id="cb22-31"></span>
<span id="cb22-32"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(slimdf)</span></code></pre></div>
<pre><code>'data.frame':   72 obs. of  4 variables:
 $ Count  : int  45 12 8 331 37 51 13 3 58 38 ...
 $ Percent: num  0.793 0.211 0.141 5.834 0.652 ...
 $ Term   : chr  "mitotic cell cycle" "cytokinesis" "cytoplasmic translation" "immune system process" ...
 $ GO.IDs : chr  "GO:0000070;GO:0000082;GO:0000086;GO:0000132;GO:0000281;GO:0006977;GO:0007052;GO:0007076;GO:0007079;GO:0007080;G"| __truncated__ "GO:0000281;GO:0000915;GO:0000917;GO:0031991;GO:0032465;GO:0032467;GO:0036089;GO:0040038;GO:0061640;GO:0061952;G"| __truncated__ "GO:0001731;GO:0001732;GO:0002183;GO:1901194;GO:1903679;GO:2000765;GO:2000767; GO:0002181" "GO:0001771;GO:0001774;GO:0001776;GO:0001779;GO:0001782;GO:0001865;GO:0001867;GO:0001913;GO:0001916;GO:0001922;G"| __truncated__ ...</code></pre>
</section>
<section id="flatten-goslims" class="level3">
<h3 class="anchored" data-anchor-id="flatten-goslims">1.1.11 Flatten GOslims</h3>
<div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "Flatten" file so each row is single GO ID with corresponding GOslim</span></span>
<span id="cb24-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rownames_to_column needed to retain row name info</span></span>
<span id="cb24-3">slimdf_separated <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(slimdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames_to_column</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GOslim'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_rows</span>(GO.IDs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>))</span>
<span id="cb24-6"></span>
<span id="cb24-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Group by unique GO ID</span></span>
<span id="cb24-8">grouped_slimdf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> slimdf_separated <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(GO.IDs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> GO.IDs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(GO.IDs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GOslim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(GOslim, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>),</span>
<span id="cb24-12">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Term =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(Term, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>))</span>
<span id="cb24-13"></span>
<span id="cb24-14"></span>
<span id="cb24-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(grouped_slimdf)</span></code></pre></div>
<pre><code>tibble [3,968 Ã— 3] (S3: tbl_df/tbl/data.frame)
 $ GO.IDs: chr [1:3968] " GO:0000278" " GO:0002181" " GO:0002376" " GO:0003014" ...
 $ GOslim: chr [1:3968] "GO:0000278" "GO:0002181" "GO:0002376" "GO:0003014" ...
 $ Term  : chr [1:3968] "mitotic cell cycle" "cytoplasmic translation" "immune system process" "renal system process" ...</code></pre>
</section>
</section>
<section id="write-slimdf-to-file" class="level2">
<h2 class="anchored" data-anchor-id="write-slimdf-to-file">1.2 Write slimdf to file</h2>
<section id="sort-and-select-slmidf" class="level3">
<h3 class="anchored" data-anchor-id="sort-and-select-slmidf">1.2.1 Sort and select slmidf</h3>
<p>Sorts GOslims by <code>Count</code>, in descending order and then selects just the <code>Term</code> and <code>Count</code> columns.</p>
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1">slimdf.sorted <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> slimdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(Count))</span>
<span id="cb26-2"></span>
<span id="cb26-3">slim.count.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> slimdf.sorted <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb26-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(Term, Count)</span>
<span id="cb26-5"></span>
<span id="cb26-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(slim.count.df)</span></code></pre></div>
<pre><code>'data.frame':   72 obs. of  2 variables:
 $ Term : chr  "anatomical structure development" "signaling" "cell differentiation" "immune system process" ...
 $ Count: int  1137 600 533 331 212 164 158 158 148 123 ...</code></pre>
</section>
<section id="write-formatted-slim.count.df-to-file" class="level3">
<h3 class="anchored" data-anchor-id="write-formatted-slim.count.df-to-file">1.2.2 Write formatted slim.count.df to file</h3>
<div class="sourceCode" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_tsv</span>(slim.count.df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/01-GO-to-GOslim/counts.GOID-per-GOslim_term.tab"</span>)</span></code></pre></div>
</section>
</section>
<section id="count-unique-biological-process-go-ids" class="level2">
<h2 class="anchored" data-anchor-id="count-unique-biological-process-go-ids">1.3 Count unique Biological Process GO IDs</h2>
<div class="sourceCode" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Flatten the list and count total GO IDs</span></span>
<span id="cb29-2">total_go_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(gomap))</span>
<span id="cb29-3"></span>
<span id="cb29-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display the total count</span></span>
<span id="cb29-5">total_go_ids</span></code></pre></div>
<pre><code>[1] 26534</code></pre>
<div class="sourceCode" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Unlist to extract all GO IDs, then find unique ones and count them</span></span>
<span id="cb31-2">unique_go_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(gomap))</span>
<span id="cb31-3">total_unique_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(unique_go_ids)</span>
<span id="cb31-4"></span>
<span id="cb31-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display the total count of unique GO IDs</span></span>
<span id="cb31-6">total_unique_ids</span></code></pre></div>
<pre><code>[1] 17913</code></pre>
<p>Total starting BP GO IDs: 26534</p>
<p>Total unique BP GO IDs: 17913</p>
</section>
</section>
<section id="references" class="level1">
<h1>2 REFERENCES</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-thegene2023" class="csl-entry">
Aleksander, Suzi A, James Balhoff, Seth Carbon, J Michael Cherry, Harold J Drabkin, Dustin Ebert, Marc Feuermann, et al.&nbsp;2023. â€œThe Gene Ontology Knowledgebase in 2023.â€ Edited by A Baryshnikova. <em>GENETICS</em> 224 (1). <a href="https://doi.org/10.1093/genetics/iyad031" class="uri">https://doi.org/10.1093/genetics/iyad031</a>.
</div>
<div id="ref-ashburner2000" class="csl-entry">
Ashburner, Michael, Catherine A. Ball, Judith A. Blake, David Botstein, Heather Butler, J. Michael Cherry, Allan P. Davis, et al.&nbsp;2000. â€œGene Ontology: Tool for the Unification of Biology.â€ <em>Nature Genetics</em> 25 (1): 25â€“29. <a href="https://doi.org/10.1038/75556" class="uri">https://doi.org/10.1038/75556</a>.
</div>
<div id="ref-carlson2017" class="csl-entry">
Carlson, Marc. 2017. â€œGO.db.â€ <a href="https://doi.org/10.18129/B9.BIOC.GO.DB" class="uri">https://doi.org/10.18129/B9.BIOC.GO.DB</a>.
</div>
<div id="ref-martinmorgan2017" class="csl-entry">
Martin Morgan, Seth Falcon. 2017. â€œGSEABase.â€ <a href="https://doi.org/10.18129/B9.BIOC.GSEABASE" class="uri">https://doi.org/10.18129/B9.BIOC.GSEABASE</a>.
</div>
<div id="ref-wickham2019" class="csl-entry">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy McGowan, Romain FranÃ§ois, Garrett Grolemund, et al.&nbsp;2019. â€œWelcome to the Tidyverse.â€ <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686" class="uri">https://doi.org/10.21105/joss.01686</a>.
</div>
</div>


</section>

 ]]></description>
  <category>2024</category>
  <category>Pycnopodia helianthoides</category>
  <category>sunflower sea star</category>
  <category>gene ontology</category>
  <category>GO</category>
  <category>GOslim</category>
  <category>data wrangling</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-30-Data-Wrangling---Get-GOslims-from-GO-IDs-for-Graces-Pycnopodia-helianthoides-Project/</guid>
  <pubDate>Wed, 30 Oct 2024 07:00:00 GMT</pubDate>
</item>
<item>
  <title>DNA Isolation Quantification and Gel - Lake Trout Liver Samples</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-25-DNA-Isolation-Quantification-and-Gel---Lake-Trout-Liver-Samples/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>Steven asked that I <a href="https://github.com/RobertsLab/resources/issues/1981">isolate gDNA from a subset of lake trout (<em>S.namaycush</em>) liver samples</a> (GitHub Issue).</p>
</section>
<section id="methods" class="level1">
<h1>METHODS</h1>
<section id="dna-isolation" class="level2">
<h2 class="anchored" data-anchor-id="dna-isolation">DNA Isolation</h2>
<p>DNA was isolated using the Quick-DNA Miniprep Kit (ZymoResearch), according to the manufacturerâ€™s protocol - including the recommended addition of beta-mercaptoethanol to the lysis buffer. Liver tissues had been stored @ -20<sup>o</sup>C in RNALater (Ambion). I thawed the tubes, transferred the entire liver tissue (which was very small) to a disposable mortar/pestle combo (1.5mL tube) and homogenized. DNA was eventually eluted with 50uL of Elution Buffer.</p>
<p>Subsequently, DNA was quantified using the 1x dsDNA Broad Range Qubit Assay (ThermoFisher). One microliter of sample was combined with 199uL of the dye/buffer mix and measured on a Qubit 3.0.</p>
<p>DNA was stored in a box labelled â€œLake Trout Liver gDNAâ€ in the FTR 209 -20<sup>o</sup>C freezer.</p>
</section>
<section id="agarose-gel" class="level2">
<h2 class="anchored" data-anchor-id="agarose-gel">Agarose gel</h2>
<p>Approximately 0.1uL of each sample was run an a 0.8% low-TAE agarose gel, stained with ethidium bromide. This was done just to spot check samples and I wasnâ€™t concerned about loading exact quantities of DNA (or equal quantities) across samples. Sample volumes were mixed with 10uL of H<sub>2</sub>O and 2uL of <a href="https://www.thermofisher.com/order/catalog/product/R0631">6x Orange DNA Loading Dye (Thermo Scientific)</a>.</p>
<p>The gel was run @ 107V for ~45mins and then imaged.</p>
<p><a href="https://www.fishersci.se/shop/products/fermentas-o-generuler-ready-to-use-dna-ladder-mix/11803983">Oâ€™GeneRuler DNA Ladder Mix, Ready-to-Use 100-10,00bp (Thermo Scientific)</a> was used (5uL) for size reference:</p>
<div id="fig-ladder" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="O'GeneRuler">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="../../../images/ogene-ruler.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Ladder"><img src="https://robertslab.github.io/sams-notebook/images/ogene-ruler.jpeg" class="img-fluid figure-img" alt="O'GeneRuler"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Ladder
</figcaption>
</figure>
</div>
</section>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<section id="qubit-data" class="level2">
<h2 class="anchored" data-anchor-id="qubit-data">Qubit data</h2>
<ul>
<li><a href="./20241025-snam-qubit-DNA.br-liver">20241025-snam-qubit-DNA.br-liver</a></li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th>sample_ID</th>
<th>Original sample conc. (ng/uL)</th>
<th>yield(ng)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>FA046</td>
<td>224</td>
<td>8960</td>
</tr>
<tr class="even">
<td>FA047</td>
<td>984</td>
<td>39360</td>
</tr>
<tr class="odd">
<td>FA048</td>
<td>1180</td>
<td>47200</td>
</tr>
<tr class="even">
<td>FA049</td>
<td>584</td>
<td>23360</td>
</tr>
<tr class="odd">
<td>FA050</td>
<td>185</td>
<td>7400</td>
</tr>
<tr class="even">
<td>FA051</td>
<td>990</td>
<td>39600</td>
</tr>
<tr class="odd">
<td>FA055</td>
<td>770</td>
<td>30800</td>
</tr>
<tr class="even">
<td>FA056</td>
<td>792</td>
<td>31680</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Yield calculation is based on a total sample volume of 40uL. This is likely a conservative volume estimation for each sample, so the total yield is likely a bit higher for each.</p>
</div>
</div>
</section>
<section id="agarose-gel-1" class="level2">
<h2 class="anchored" data-anchor-id="agarose-gel-1">Agarose Gel</h2>
<p>Samples were loaded in numerical order, left to right.</p>
<p>Samples FA47 and FA48 have the most prominent bands, but faint bands are visible in all the other lanes (you may need to squint, LOL). Low visibility of bands is most likely due to the inaccuracy involved with attempting to pipette 0.1uL using a P10 pipetteâ€¦ All bands are high molecular weight and donâ€™t show any evidence of degradation (smearing).</p>
<div id="fig-ladder" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="Agarose gel showing high molecular weight bands for most samples. Those lacking visible bands are likely due to the inaccuracy in pipetting 0.1uL.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241025-snam-liver-gDNA-gel.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Agarose gel showing high molecular weight bands for most samples. Those lacking visible bands are likely due to the inaccuracy in pipetting 0.1uL."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-10-25-DNA-Isolation-Quantification-and-Gel---Lake-Trout-Liver-Samples/20241025-snam-liver-gDNA-gel.jpg" class="img-fluid figure-img" alt="Agarose gel showing high molecular weight bands for most samples. Those lacking visible bands are likely due to the inaccuracy in pipetting 0.1uL."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Agarose gel showing high molecular weight bands for most samples. Those lacking visible bands are likely due to the inaccuracy in pipetting 0.1uL.
</figcaption>
</figure>
</div>


</section>
</section>

 ]]></description>
  <category>2024</category>
  <category>DNA isolation</category>
  <category>Qubit</category>
  <category>DNA quantification</category>
  <category>agarose gel</category>
  <category>lake trout</category>
  <category>Salvelinus namaycush</category>
  <category>liver</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-25-DNA-Isolation-Quantification-and-Gel---Lake-Trout-Liver-Samples/</guid>
  <pubDate>Fri, 25 Oct 2024 07:00:00 GMT</pubDate>
  <media:content url="https://robertslab.github.io/sams-notebook/posts/2024/2024-10-25-DNA-Isolation-Quantification-and-Gel---Lake-Trout-Liver-Samples/20241025-snam-liver-gDNA-gel.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Reverse Transcription - C.gigas Lifestage Carryover RNA</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-24-Reverse-Transcription---C.gigas-Lifestage-Carryover-RNA/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>Continuing with <a href="https://github.com/RobertsLab/resources/issues/1891">Arianaâ€™s request to extract RNA and run qPCRs</a> (GitHub Issue) for the <a href="https://github.com/RobertsLab/project-gigas-carryover/tree/main/lifestage_carryover"><code>lifestage_carryover</code> project</a> (GitHub repo), I performed reverse transcription on RNA I previously isolated:</p>
<ul>
<li><a href="../../../posts/2024/2024-06-17-RNA-Quantification---C.gigas-RNA-Lifestage-Carryover-from-20240615-and-20240617/index.html">20240615 and 20240617</a> (Notebook)</li>
<li><a href="../../../posts/2024/2024-06-18-RNA-Isolation-and-Quantification---C.gigas-Lifestage-Carryover-Seed-Juvenile-and-Adult/index.html">20240618</a> (Notebook)</li>
<li><a href="../../../posts/2024/2024-07-01-RNA-Isolation-and-Quantification---C.gigas-Lifestage-Carryover-Seed-Juvenile-and-Adult/index.html">20240701</a> (Notebook)</li>
</ul>
</section>
<section id="materials-methods" class="level1">
<h1>MATERIALS &amp; METHODS</h1>
<p>Reverse transcription was performed using the <a href="https://github.com/RobertsLab/resources/blob/master/protocols/Commercial_Protocols/Promega-goscript-reverse-transcription-system-protocol.pdf">GoScript Reverse Transcription System (Promega)</a> (PDF), using oligo dT primers and 1.5mM MgCl<sub>2</sub>. The reaction size was doubled, from 20uL to 40uL, to allow for sufficient cDNA for all the downstream qPCRs we plan to perform. The optional RNasin was also used. Reactions were set up in a 96-well, low profile qPCR plate. Plate was sealed with strip caps. The reverse transcriptase components were prepared as a master mix and then distributed to RNA/oligo dT mixtures.</p>
<p>I used 200ng of RNA in most reactions, but there were a number of samples which had insufficient RNA to accommodate that amount. In those instances, the maximum <em>volume</em> of RNA which fit into the reaction volume was used (i.e.&nbsp;9uL of RNA). Those samples, and the actual quantity of RNA used for each, are listed below:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>sample</th>
<th>RNA in RT Rxn (ng)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>213</td>
<td>43.2</td>
</tr>
<tr class="even">
<td>227</td>
<td>43.2</td>
</tr>
<tr class="odd">
<td>231</td>
<td>166.5</td>
</tr>
<tr class="even">
<td>238</td>
<td>171</td>
</tr>
<tr class="odd">
<td>287</td>
<td>139.5</td>
</tr>
<tr class="even">
<td>371</td>
<td>59.04</td>
</tr>
</tbody>
</table>
<p>Briefly, here is how the reactions were setup:</p>
<ol type="1">
<li>Combined RNA (200ng), oligo dT primers, and H<sub>2</sub>O to a final volume of 10uL.</li>
<li>Incubated plate at 70<sup>o</sup>C for 5mins and immediately chilled plate in ice water for 5mins.</li>
<li>Added 30uL of RT reaction master mix to each sample.</li>
<li>Incubated plate at 25<sup>o</sup>C for 5mins.</li>
<li>Incubated plate at 42<sup>o</sup>C for 5mins.</li>
<li>Incubated plate at 70<sup>o</sup>C for 15mins to deactivate reverse transcriptase.</li>
</ol>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Step 6 is <em>required</em> if using cDNA for downstream qPCR analyses.</p>
</div>
</div>
<section id="cdna-calcs-and-plate-layout" class="level2">
<h2 class="anchored" data-anchor-id="cdna-calcs-and-plate-layout">cDNA calcs and plate layout:</h2>
<ul>
<li><a href="https://docs.google.com/spreadsheets/d/1m7nn7cTXrRHMMGzz9npPGa04huvve6Xm0wofIGpzGws/edit?usp=sharing">cgig-lifestage-carryover-cDNA-calcs</a> (Google Sheet)</li>
</ul>
<p>Plate was stored at -20<sup>o</sup>C.</p>


</section>
</section>

 ]]></description>
  <category>2024</category>
  <category>reverse transcription</category>
  <category>cDNA</category>
  <category>GoScript</category>
  <category>Crassostrea gigas</category>
  <category>Pacific oyster</category>
  <category>RNA</category>
  <category>project-gigas-carryover</category>
  <category>lifestage_carryover</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-24-Reverse-Transcription---C.gigas-Lifestage-Carryover-RNA/</guid>
  <pubDate>Thu, 24 Oct 2024 07:00:00 GMT</pubDate>
  <media:content url="https://robertslab.github.io/sams-notebook/posts/2024/2024-10-24-Reverse-Transcription---C.gigas-Lifestage-Carryover-RNA/20241024-cgig-lifestage_carryover-RT-01.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Computer Management - Configure 16TB OWC ThunderBlade X8 External HDD on Raven</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-21-Computer-Management---Configure-16TB-OWC-ThunderBlade-X8-External-HDD-on-Raven/</link>
  <description><![CDATA[ 





<section id="intro" class="level1">
<h1>INTRO</h1>
<p>We recently purchased a 16TB OWC ThunderBlade X8 as additional storage for Raven (Ubuntu 18.04LTS), primarily to be used for Shelly and Emmaâ€™s project. Although I thought this would just be â€œplug and play,â€ when I plugged it in, Raven recognized each individual SSD as its own drive. Firstly, I didnâ€™t expect there to be mutliple drives (guess I shouldâ€™ve read the product description more closely) and thought it was just a single, massive SSD drive. Secondly, Raven didnâ€™t automount the drives.</p>
<p>So, I had to deal with both of those issues. Luckily, it turns out it wasnâ€™t particularly difficult or timeconsuming!</p>
<div id="fig-ladder" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="New external drive isn't listed (i.e. isn't automounted) after being plugged in.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241021-initial-df_output-01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: New external drive isnâ€™t listed (i.e.&nbsp;isnâ€™t automounted) after being plugged in."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-10-21-Computer-Management---Configure-16TB-OWC-ThunderBlade-X8-External-HDD-on-Raven/20241021-initial-df_output-01.png" class="img-fluid figure-img" alt="New external drive isn't listed (i.e. isn't automounted) after being plugged in."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: New external drive isnâ€™t listed (i.e.&nbsp;isnâ€™t automounted) after being plugged in.
</figcaption>
</figure>
</div>
<div id="fig-ladder" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="blkid command shows eight nvme drives, corresponding to the Thunderblad X8 SSD drivves.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241021-initial-blkid_output-01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: blkid command shows eight nvme drives, corresponding to the Thunderblad X8 SSD drives."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-10-21-Computer-Management---Configure-16TB-OWC-ThunderBlade-X8-External-HDD-on-Raven/20241021-initial-blkid_output-01.png" class="img-fluid figure-img" alt="blkid command shows eight nvme drives, corresponding to the Thunderblad X8 SSD drivves."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: blkid command shows eight nvme drives, corresponding to the Thunderblad X8 SSD drives.
</figcaption>
</figure>
</div>
</section>
<section id="procedure" class="level1">
<h1>PROCEDURE</h1>
<section id="combine-drives-into-raid0" class="level2">
<h2 class="anchored" data-anchor-id="combine-drives-into-raid0">Combine drives into RAID0</h2>
<p>RAID0 essentially treats all the SSDs of the Thunderblad X8 as a single volume (i.e.&nbsp;drive). This maximizes space, but sacrificies any data redundancy. This is fine, as we purchased this solely to function as additional storage and arenâ€™t concerned about data redundancy (data on Raven should be syncâ€™d to Gannet with regularity, as Gannet <em>does</em> have data redundancy in a RAID6 setup).</p>
<p>To do this, we use the <a href="https://en.wikipedia.org/wiki/Mdadm"><code>mdadm</code> command</a> (Wikipedia).</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> mdadm <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-2">--create <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-3">--verbose <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-4">/dev/md0 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-5">--level=0 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-6">--raid-devices=8 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-7">/dev/nvme0n1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-8">/dev/nvme1n1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-9">/dev/nvme2n1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-10">/dev/nvme3n1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-11">/dev/nvme4n1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-12">/dev/nvme5n1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-13">/dev/nvme6n1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-14">/dev/nvme7n1</span></code></pre></div>
<p>This assigns the combined drive to <code>/dev/md0</code> and then sets the RAID level to <code>0</code>. This is followed by the drive count and the locations of the drives you want to include in the RAID configuration.</p>
<div id="fig-ladder" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="Screenshot confirming mdadm command and confirming we'd like to proceed.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241021-mdadm-confirmation.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: Screenshot confirming mdadm command and confirming weâ€™d like to proceed."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-10-21-Computer-Management---Configure-16TB-OWC-ThunderBlade-X8-External-HDD-on-Raven/20241021-mdadm-confirmation.png" class="img-fluid figure-img" alt="Screenshot confirming mdadm command and confirming we'd like to proceed."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Screenshot confirming mdadm command and confirming weâ€™d like to proceed.
</figcaption>
</figure>
</div>
<p>After running the <code>mdadm --create</code> command, we can confirm the details of the commandâ€™s process and confirm that things look the way we expected:</p>
<div id="fig-ladder" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="Screenshot of mdadm --details command confirming the procedure worked as expected.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241021-mdadm-detail_output-01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;4: Screenshot of mdadm â€“details command confirming the procedure worked as expected."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-10-21-Computer-Management---Configure-16TB-OWC-ThunderBlade-X8-External-HDD-on-Raven/20241021-mdadm-detail_output-01.png" class="img-fluid figure-img" alt="Screenshot of mdadm --details command confirming the procedure worked as expected."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Screenshot of mdadm â€“details command confirming the procedure worked as expected.
</figcaption>
</figure>
</div>
<div id="fig-ladder" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="Screenshot of blkid now showing all nvme drives associated with md0">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241021-raid0-blkid_output-01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;5: Screenshot of blkid now showing all nvme drives associated with md0"><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-10-21-Computer-Management---Configure-16TB-OWC-ThunderBlade-X8-External-HDD-on-Raven/20241021-raid0-blkid_output-01.png" class="img-fluid figure-img" alt="Screenshot of blkid now showing all nvme drives associated with md0"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Screenshot of blkid now showing all nvme drives associated with md0
</figcaption>
</figure>
</div>
<p>Next, we need to format the new RAID0 drives with a file system. In this case, weâ€™ll go with <code>ext4</code>, which is a standard file system used in Linux/Ubuntu.</p>
</section>
<section id="format-hdds" class="level2">
<h2 class="anchored" data-anchor-id="format-hdds">Format HDDs</h2>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> mkfs.ext4 /dev/md0</span></code></pre></div>
<p>After thatâ€™s done, we need to create a mount point and mount the drive.</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> mkdir <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> /home/shared/16TB_HDD_01</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> mount /dev/md0 /home/shared/16TB_HDD_01</span></code></pre></div>
<p>Finally, we want this to automount any time the computer is rebooted, so we add it to <code>/etc/fstab</code>. Since that table contains the unique drive IDs, I think we donâ€™t want them displayed on the open internet. So, if you want to see how thatâ€™s set up, youâ€™ll need to look at <code>/etc/fstab</code> on your own.</p>
</section>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<p>Now, check to see that the newly RAIDâ€™d and formatted drive shows up.</p>
<div id="fig-ladder" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" alt="Screenshot of df -h now showing a single drive with 14TB of storage mounted at /dev/md0.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./20241021-final-df_output-01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;6: Screenshot of df -h now showing a single drive with 14TB of storage mounted at /dev/md0."><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-10-21-Computer-Management---Configure-16TB-OWC-ThunderBlade-X8-External-HDD-on-Raven/20241021-final-df_output-01.png" class="img-fluid figure-img" alt="Screenshot of df -h now showing a single drive with 14TB of storage mounted at /dev/md0."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Screenshot of df -h now showing a single drive with 14TB of storage mounted at /dev/md0.
</figcaption>
</figure>
</div>
<p>Alrighty, looks great! Easy, peasy!</p>


</section>

 ]]></description>
  <category>2024</category>
  <category>Computer Management</category>
  <category>HDD</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-10-21-Computer-Management---Configure-16TB-OWC-ThunderBlade-X8-External-HDD-on-Raven/</guid>
  <pubDate>Mon, 21 Oct 2024 07:00:00 GMT</pubDate>
</item>
</channel>
</rss>
