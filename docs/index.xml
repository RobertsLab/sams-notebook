<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Sam&#39;s Notebook</title>
<link>https://robertslab.github.io/sams-notebook/index.html</link>
<atom:link href="https://robertslab.github.io/sams-notebook/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.3.450</generator>
<lastBuildDate>Wed, 03 Jan 2024 08:00:00 GMT</lastBuildDate>
<item>
  <title>Data Exploration - CEABIGR Spurious Transcription Calculations and Plotting</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-01-03-Data-Exploration---CEABIGR-Spurious-Transcription-Calculations-and-Plotting/index.html</link>
  <description><![CDATA[ 




<section id="intro" class="level1">
<h1>Intro</h1>
<p>As part of the <a href="https://github.com/sr320/ceabigr">CEABIGR project</a> (GitHub repo) Steven performed some inital data wrangling to test out the basic calculations to determine the natural log of the fold change in exon expression, relative to Exon 1, for each gene in a single sample. The decision to perform the calculation in this manner was based on <span class="citation" data-cites="li2018">(Li et al. 2018)</span>. I took the next steps to perform this across all samples, as well as generate some comparison plots. After this, will explore how spurious transcription relates to methylation levels across genes.</p>
<p>See <a href="https://github.com/sr320/ceabigr/blob/585fb039e7d7b12295781f0a0141e84eee901631/code/65-exon-coverage.qmd"><code>65-exon-coverage.qmd</code></a> for code.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Code and plots link to commit <code>585fb03</code>.</p>
</div>
</div>
</section>
<section id="plots" class="level1">
<h1>Plots</h1>
<p>All plots are line plots of the mean natural log fold-change in exon expression (Exons 2-6), relative to Exon 1. Black bars represent standard error.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Plots are simply arranged side-by-side. Scales of axes are <em>not</em> intended to match.</p>
</div>
</div>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-01-03-Data-Exploration---CEABIGR-Spurious-Transcription-Calculations-and-Plotting/https:/raw.githubusercontent.com/sr320/ceabigr/585fb039e7d7b12295781f0a0141e84eee901631/output/65-exon-coverage/figures/control-females.v.control-males-line_plot.png" class="img-fluid" alt="Line plots of mean natural log fold-change of exon expression relative to Exon 1. Pink line is control females. Blue line is control males. Black bars represent standard error."></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-01-03-Data-Exploration---CEABIGR-Spurious-Transcription-Calculations-and-Plotting/https:/raw.githubusercontent.com/sr320/ceabigr/585fb039e7d7b12295781f0a0141e84eee901631/output/65-exon-coverage/figures/control-females.v.exposed-females-line_plot.png" class="img-fluid" alt="Line plots of mean natural log fold-change of exon expression relative to Exon 1. Pink line is control females. Blue line is exposed females. Black bars represent standard error."></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-01-03-Data-Exploration---CEABIGR-Spurious-Transcription-Calculations-and-Plotting/https:/raw.githubusercontent.com/sr320/ceabigr/585fb039e7d7b12295781f0a0141e84eee901631/output/65-exon-coverage/figures/control-males.v.exposed-males-line_plot.png" class="img-fluid" alt="Line plots of mean natural log fold-change of exon expression relative to Exon 1. Pink line is control males. Blue line is exposed males. Black bars represent standard error."></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-01-03-Data-Exploration---CEABIGR-Spurious-Transcription-Calculations-and-Plotting/https:/raw.githubusercontent.com/sr320/ceabigr/585fb039e7d7b12295781f0a0141e84eee901631/output/65-exon-coverage/figures/controls.v.exposed-line_plot.png" class="img-fluid" alt="Line plots of mean natural log fold-change of exon expression relative to Exon 1. Pink line is controls. Blue line is exposed. Black bars represent standard error."></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-01-03-Data-Exploration---CEABIGR-Spurious-Transcription-Calculations-and-Plotting/https:/raw.githubusercontent.com/sr320/ceabigr/585fb039e7d7b12295781f0a0141e84eee901631/output/65-exon-coverage/figures/exposed-females.v.exposed-males-line_plot.png" class="img-fluid" alt="Line plots of mean natural log fold-change of exon expression relative to Exon 1. Pink line is exposed females. Blue line is exposed males. Black bars represent standard error."></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-01-03-Data-Exploration---CEABIGR-Spurious-Transcription-Calculations-and-Plotting/https:/raw.githubusercontent.com/sr320/ceabigr/585fb039e7d7b12295781f0a0141e84eee901631/output/65-exon-coverage/figures/females.v.males-line_plot.png" class="img-fluid" alt="Line plots of mean natural log fold-change of exon expression relative to Exon 1. Pink line is females. Blue line is males. Black bars represent standard error."></p>
</div>
</div>
</div>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-li2018" class="csl-entry">
Li, Yong, Yi Jin Liew, Guoxin Cui, Maha J. Cziesielski, Noura Zahran, Craig T. Michell, Christian R. Voolstra, and Manuel Aranda. 2018. <span>“DNA Methylation Regulates Transcriptional Homeostasis of Algal Endosymbiosis in the Coral Model Aiptasia.”</span> <em>Science Advances</em> 4 (8). <a href="https://doi.org/10.1126/sciadv.aat2142">https://doi.org/10.1126/sciadv.aat2142</a>.
</div>
</div></section></div> ]]></description>
  <category>2024</category>
  <category>CEABIGR</category>
  <category>plot</category>
  <category>Eastern oyster</category>
  <category>Crassostrea virginica</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-01-03-Data-Exploration---CEABIGR-Spurious-Transcription-Calculations-and-Plotting/index.html</guid>
  <pubDate>Wed, 03 Jan 2024 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Daily Bits - January 2024</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-01-02-Daily-Bits---January-2024/index.html</link>
  <description><![CDATA[ 




<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section">20240109</h2>
<ul>
<li>Power outage all day…</li>
</ul>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1">20240108</h2>
<p>In lab:</p>
<ul>
<li><p>Sent <a href="https://github.com/RobertsLab/resources/issues/1764">replacement liver samples for Cod RNA-seq project</a> (GitHub Issue).</p></li>
<li><p>Helped Noah get mercuric chloride waste transferred to EH&amp;S carboys in FTR 228.</p></li>
<li><p>Had to do a fresh install of R on <code>swoose</code>. Took awhile…</p></li>
</ul>
</section>
<section id="section-2" class="level2">
<h2 class="anchored" data-anchor-id="section-2">20240105</h2>
<ul>
<li>Science Hour</li>
</ul>
<section id="ceabigr-github-repo" class="level3">
<h3 class="anchored" data-anchor-id="ceabigr-github-repo"><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo)</h3>
<ul>
<li>Started to look into where (if?) we have methylation data on a per gene basis to plot vs.&nbsp;exon fold-change data from 20240103</li>
</ul>
</section>
</section>
<section id="section-3" class="level2">
<h2 class="anchored" data-anchor-id="section-3">20240104</h2>
<ul>
<li><p>Disabled Sensaphone input #3 due to frequent calls. This is the sensor for the “middle” -80<sup>o</sup>C freezer. This is an older freezer from a former professor, so I’m not sure we have any info on how to set it up, but I will see if I can figure out how to change the freezer temp limits, instead of disabling the Sensaphone.</p></li>
<li><p>Investigated <a href="">a budget spending discrepancy issue</a> (GitHub Issue).</p></li>
<li><p>Added a <a href="https://github.com/RobertsLab/tusk/blob/main/modules/05-computers.qmd">page about RStudio Server access on Raven</a> on the <a href="https://robertslab.github.io/tusk/">tusk</a> website, per <a href="https://github.com/RobertsLab/resources/issues/1776">this GitHub Issue.</a></p></li>
</ul>
</section>
<section id="section-4" class="level2">
<h2 class="anchored" data-anchor-id="section-4">20240103</h2>
<section id="ceabigr-github-repo-1" class="level3">
<h3 class="anchored" data-anchor-id="ceabigr-github-repo-1"><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo)</h3>
<ul>
<li><p>Worked extensively on <a href="https://github.com/sr320/ceabigr/blob/main/code/65-exon-coverage.qmd">calculating mean, natural log fold change of Exons 2 - 6, relative to Exon 1 expression across all genes, in all samples</a>.</p></li>
<li><p>Generated line plots of the various possible comparisons.</p></li>
</ul>
</section>
</section>
<section id="section-5" class="level2">
<h2 class="anchored" data-anchor-id="section-5">20240102</h2>


</section>

 ]]></description>
  <category>2024</category>
  <category>Daily Bits</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-01-02-Daily-Bits---January-2024/index.html</guid>
  <pubDate>Tue, 02 Jan 2024 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Computer Management - Returned Failing HDDs from Gannet Expansion Unit</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-12-21-Computer-Management---Returned-Failing-HDDs-from-Gannet-Expansion-Unit/index.html</link>
  <description><![CDATA[ 




<p>After replacing the <a href="https://robertslab.github.io/sams-notebook/posts/2023/2023-12-07-Computer-Maintenance---Replace-Failing-HDDs-in-Synology-RX1217-Expansion-Unit-on-Gannet/">three failing HDDs in the Gannet (Synology) expansion unit</a>, I contacted the company (Maestro Technology LLC) via Amazon. They have been very responsive and very helpful, with no resistance whatsoever. They indicated the drives were new when I ordered them and they seemed surprised that the warranties for all three had already expired.</p>
<p>Regardless, they simply said they’ll replace the threee drives once they receive these three failing HDDs. They provided a return shipping lable for FedEx, so I packaged up the HDDs and sent them back. Hopefully we’ll hear back soon.</p>



 ]]></description>
  <category>computer management</category>
  <category>2023</category>
  <category>HDDs</category>
  <category>gannet</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-12-21-Computer-Management---Returned-Failing-HDDs-from-Gannet-Expansion-Unit/index.html</guid>
  <pubDate>Thu, 21 Dec 2023 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Samples Submitted - Gadus macrocephalus liver tissues to Azenta for RNA-seq</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-12-18-Samples-Submitted---Gadus-macrocephalus-liver-tissues-to-Azenta-for-RNA-seq/index.html</link>
  <description><![CDATA[ 




<p>Shipped box of 80 Pacific cod tissues selected by Steven (mostly liver, some blood, gills, and spleen) to Azenta overnight on dry ice for RNA-seq.</p>
<p>Sample sheet provided to Azenta:</p>
<table class="table">
<colgroup>
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>General Information</th>
<th></th>
<th></th>
<th></th>
<th>Amount of Material</th>
<th></th>
<th></th>
<th>Miscellaneous</th>
<th></th>
<th>QC Method Used By Customer</th>
<th></th>
<th></th>
<th>Special Comments</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Sample Name*</td>
<td>Sample Type*</td>
<td>Species/Strain*</td>
<td>Sample Buffer*</td>
<td>Total Amount*</td>
<td>Volume (µL)</td>
<td>Conc (ng/µL)</td>
<td>Purification Method*</td>
<td>Biosafety Level (BSL)</td>
<td>Method Used for Fluorescence</td>
<td>Method Used for Spectrophotometry</td>
<td>Method Used for Electrophoresis</td>
<td></td>
</tr>
<tr class="even">
<td>1</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>2</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>3</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>4</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>5</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>10</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>11</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>12</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>13</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>18</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>19</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>20</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>21</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>28</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>29</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>30</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>31</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>37</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>38</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>39</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>40</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>41</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>47</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>48</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>49</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>50</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>57</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>58</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>59</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>60</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>67</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>68</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>69</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>70</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>78</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>79</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>80</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>83</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>88</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>90</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>90-dup</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver - accidental duplicate of 90. No need to process second tube labelled “90”.</td>
</tr>
<tr class="odd">
<td>91</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>92</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>97</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>98</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>99</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>100</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>107</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>108</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>109</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>110</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>117</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>118</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>119</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>120</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>121</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>127</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>128</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>129</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>131</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>137</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>138</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>139</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>140</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>147</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>148</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>149</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>150</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>19-B</td>
<td>Cells in RNALater</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>10^8 cells</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>blood</td>
</tr>
<tr class="odd">
<td>20-B</td>
<td>Cells in RNALater</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>10^8 cells</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>blood</td>
</tr>
<tr class="even">
<td>57-B</td>
<td>Cells in RNALater</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>10^8 cells</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>blood</td>
</tr>
<tr class="odd">
<td>58-B</td>
<td>Cells in RNALater</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>10^8 cells</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>blood</td>
</tr>
<tr class="even">
<td>19-G</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>gill</td>
</tr>
<tr class="odd">
<td>20-G</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>gill</td>
</tr>
<tr class="even">
<td>57-G</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>gill</td>
</tr>
<tr class="odd">
<td>58-G</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>gill</td>
</tr>
<tr class="even">
<td>19-S</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>spleen</td>
</tr>
<tr class="odd">
<td>20-S</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>spleen</td>
</tr>
<tr class="even">
<td>57-S</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>spleen</td>
</tr>
<tr class="odd">
<td>58-S</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>spleen</td>
</tr>
</tbody>
</table>



 ]]></description>
  <category>2023</category>
  <category>Gadus macrocephalus</category>
  <category>Pacific cod</category>
  <category>Azenta</category>
  <category>RNA-seq</category>
  <category>Samples Submitted</category>
  <category>liver</category>
  <category>spleen</category>
  <category>gill</category>
  <category>blood</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-12-18-Samples-Submitted---Gadus-macrocephalus-liver-tissues-to-Azenta-for-RNA-seq/index.html</guid>
  <pubDate>Mon, 18 Dec 2023 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Computer Maintenance - Replace Failing HDDs in Synology RX1217 Expansion Unit on Gannet</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-12-07-Computer-Maintenance---Replace-Failing-HDDs-in-Synology-RX1217-Expansion-Unit-on-Gannet/index.html</link>
  <description><![CDATA[ 




<p>In mid-Novemeber, our Synology RX1217 expansion unit on Gannet generated erros for <em>three</em> drives. Considering this unit, and the corresponding HDDs, were installed in July, this is highly disappointing. Plus, these are 18TB HDDs and are not cheap to replace.</p>
<div id="fig-synology_table" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-12-07-Computer-Maintenance---Replace-Failing-HDDs-in-Synology-RX1217-Expansion-Unit-on-Gannet/20231207-syno-logs-HDD-failures.png" class="img-fluid figure-img" alt="Synology logs showing three drives failing S.M.A.R.T. tests"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Three drive failures</figcaption>
</figure>
</div>
<p>Ordered three replacement drives (Seagate Iron Wolf Pro; 16TB) and they finally arrived. I swapped two of the drives, following the Synology Storage Manager wizard, but had to wait for the drives to go through various checks before I could install the third (will do this this weekend).</p>
<p>However, when trying to investigate the drive failures using Seagate’s SeaTools, both drives passed the “generic short test”. However, neither drive could complete the “generic long test.” No errors were generated, just that the “generic long test” failed. When I registered the drives with Seagate, Seagate indicated that the drives’ warranties ended on 11/27/2023! These were brand new drives purchased in July 2023! The warranty should be significantly longer than 5 months.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-12-07-Computer-Maintenance---Replace-Failing-HDDs-in-Synology-RX1217-Expansion-Unit-on-Gannet/20231207-seagate-hdd-registration-expired.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Three HDDs registered with Seagate showing they’re out of warranty as of 20231127</figcaption>
</figure>
</div>
<p>Although, I did find some info suggesting that these failing drives are possibly linked to a Synology database error which is sometimes related to power outages (which just so happens to be when we started getting these errors…) here:</p>
<p>https://www.synoforum.com/threads/reset-drive-critical-state.8787/</p>
<p>I’m not going to pursue that route because these drives should still be under warranty.</p>
<p>Will reach out to the vendor via Amazon to see what can be done about this…</p>



 ]]></description>
  <category>gannet</category>
  <category>synology</category>
  <category>RX1217</category>
  <category>HDDs</category>
  <category>2023</category>
  <category>computer maintenance</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-12-07-Computer-Maintenance---Replace-Failing-HDDs-in-Synology-RX1217-Expansion-Unit-on-Gannet/index.html</guid>
  <pubDate>Thu, 07 Dec 2023 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Data Investigation - Mysterious Case of Excessive Exons in CEABIGR</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-12-06-Data-Investigation---Mysterious-Case-of-Excessive-Exons-in-CEABIGR/index.html</link>
  <description><![CDATA[ 




<p>After Steven <a href="https://github.com/sr320/ceabigr/issues/86#issuecomment-1816557386">ran through some prelimiary exon expression analyses</a> (GitHub Isse), he noticed that there were some genes with a seemingly excessive number of exons (like over 800!). Seeing that, I’ve decided to do some investigation to see if these gene feature annotations stem from the source (i.e.&nbsp;from NCBI GFF) or were introduced accidentally through some subsequent data analysis/manipulations.</p>
<p>First, let’s look at a file which appears to provide mappings of GeneIDs and exons:</p>
<section id="investigate-genome-featuresc_virginica-3.0_gnomon_exon-geneid.bed" class="level1">
<h1>Investigate <code>genome-features/C_virginica-3.0_Gnomon_exon-geneID.bed</code></h1>
<section id="inspect-exon-geneid-mapping-file" class="level2">
<h2 class="anchored" data-anchor-id="inspect-exon-geneid-mapping-file">Inspect exon-geneID mapping file</h2>
<p>This might be a poor place to start, as this file exists in a directory with no README. As such, I’m not certain of the source of this file…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> /home/sam/gitrepos/ceabigr/genome-features/C_virginica-3.0_Gnomon_exon-geneID.bed</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NC_035780.1 13578   13603   gene-LOC111116054
NC_035780.1 14237   14290   gene-LOC111116054
NC_035780.1 14557   14594   gene-LOC111116054
NC_035780.1 28961   29073   gene-LOC111126949
NC_035780.1 30524   31557   gene-LOC111126949
NC_035780.1 31736   31887   gene-LOC111126949
NC_035780.1 31977   32565   gene-LOC111126949
NC_035780.1 32959   33324   gene-LOC111126949
NC_035780.1 66869   66897   gene-LOC111110729
NC_035780.1 64123   64334   gene-LOC111110729</code></pre>
</div>
</div>
<p>This appears to have all exons start/stop locations for each gene. At least, that’s my assumption, based off of the filename.</p>
</section>
<section id="count-exons-per-gene-in-c_virginica-3.0_gnomon_exon-geneid.bed" class="level2">
<h2 class="anchored" data-anchor-id="count-exons-per-gene-in-c_virginica-3.0_gnomon_exon-geneid.bed">Count exons per gene in <code>C_virginica-3.0_Gnomon_exon-geneID.bed</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print $4}'</span> /home/sam/gitrepos/ceabigr/genome-features/C_virginica-3.0_Gnomon_exon-geneID.bed <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uniq</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--count</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--numeric-sort</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--reverse</span>  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-k1,1</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   2889 gene-LOC111108212
   2600 gene-LOC111125463
   2237 gene-LOC111125330
   1559 gene-LOC111130297
   1557 gene-LOC111112605
   1555 gene-LOC111128998
   1540 gene-LOC111122636
   1506 gene-LOC111107250
   1384 gene-LOC111125942
   1383 gene-LOC111133666</code></pre>
</div>
</div>
<p>Well, this shows us that this file indeed has many, many genes with <em>thousands</em> of exons! This is highly dubious, so let’s glance at the NCBI GFF to see if this is “real” or not.</p>
</section>
</section>
<section id="inspect-ncbi-gff" class="level1">
<h1>Inspect NCBI GFF</h1>
<section id="decompress-ncbi-gff" class="level2">
<h2 class="anchored" data-anchor-id="decompress-ncbi-gff">Decompress NCBI GFF</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gunzip</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--keep</span> /home/sam/gitrepos/ceabigr/genome-features/GCF_002022765.2_C_virginica-3.0_genomic.gff.gz</span></code></pre></div>
</div>
</section>
<section id="search-for-genes-with-high-number-of-exons" class="level2">
<h2 class="anchored" data-anchor-id="search-for-genes-with-high-number-of-exons">Search for gene(s) with high number of exons</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Exons in the GFF do <em>not</em> refer to the full parent gene ID!</p>
<p>Need to use truncated version. E.g. <code>LOC111108212</code></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\t"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$3 == "exon"'</span> /home/sam/gitrepos/ceabigr/genome-features/GCF_002022765.2_C_virginica-3.0_genomic.gff <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene=LOC111110729"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>5</code></pre>
</div>
</div>
<p>So, the exon counts in <code>genome-features/C_virginica-3.0_Gnomon_exon-geneID.bed</code> are indeed artificial!</p>
<p>Now that I’ve investigated that, I probably should’ve just started with the input files that Steven was using in the first place. However, this certainly identifies a problematic file that should likely be removed from the repo…</p>
<p>Let’s look at the data Steven was working with and see what we can figure out.</p>
</section>
</section>
<section id="inspect-output19-exon-expressions12m-exon_expression.tab" class="level1">
<h1>Inspect <code>output/19-exon-expression/S12M-exon_expression.tab</code></h1>
<section id="count-colums-in-output19-exon-expressions12m-exon_expression.tab" class="level2">
<h2 class="anchored" data-anchor-id="count-colums-in-output19-exon-expressions12m-exon_expression.tab">Count colums in <code>output/19-exon-expression/S12M-exon_expression.tab</code></h2>
<p>Due to the layout of this file (a column for each possible number of exons across <em>all</em> genes), the head command will produce an unwieldy output. Instead, we’ll just count the number of columns (fields) to get an idea of what we’re dealing with.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We subtract <code>1</code> to account for the first column</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">S12M.columns <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"awk '{print NF-1}' /home/sam/gitrepos/ceabigr/output/19-exon-expression/S12M-exon_expression.tab | sort --unique"</span>,</span>
<span id="cb8-2">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intern =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</div>
<p>Well, we’re seeing that there is a <em>maximum</em> number of exons across <em>all</em> genes: 462</p>
<p>Next let’s see if we can ID the gene with 462 exons.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb9-2"></span>
<span id="cb9-3">S12M.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/sam/gitrepos/ceabigr/output/19-exon-expression/S12M-exon_expression.tab"</span>,</span>
<span id="cb9-4">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb9-5"></span>
<span id="cb9-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(S12M.df)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   38838 obs. of  463 variables:
 $ gene_name: chr  "gene-LOC111116054" "gene-LOC111126949" "gene-LOC111110729" "gene-LOC111112434" ...
 $ exon_1   : int  130 22 282 24 69 416 193 23 23 3 ...
 $ exon_2   : int  103 180 63 40 39 NA 106 173 173 1 ...
 $ exon_3   : int  9 35 55 123 86 NA NA 3 NA 2 ...
 $ exon_4   : int  NA 110 11 NA 21 NA NA 1 NA 2 ...
 $ exon_5   : int  NA 47 NA NA 85 NA NA 2 NA NA ...
 $ exon_6   : int  NA NA NA NA NA NA NA 2 NA NA ...
 $ exon_7   : int  NA NA NA NA NA NA NA 75 NA NA ...
 $ exon_8   : int  NA NA NA NA NA NA NA 214 NA NA ...
 $ exon_9   : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_10  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_11  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_12  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_13  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_14  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_15  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_16  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_17  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_18  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_19  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_20  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_21  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_22  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_23  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_24  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_25  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_26  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_27  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_28  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_29  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_30  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_31  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_32  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_33  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_34  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_35  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_36  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_37  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_38  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_39  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_40  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_41  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_42  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_43  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_44  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_45  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_46  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_47  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_48  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_49  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_50  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_51  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_52  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_53  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_54  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_55  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_56  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_57  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_58  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_59  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_60  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_61  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_62  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_63  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_64  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_65  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_66  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_67  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_68  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_69  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_70  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_71  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_72  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_73  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_74  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_75  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_76  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_77  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_78  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_79  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_80  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_81  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_82  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_83  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_84  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_85  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_86  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_87  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_88  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_89  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_90  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_91  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_92  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_93  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_94  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_95  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_96  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_97  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_98  : int  NA NA NA NA NA NA NA NA NA NA ...
  [list output truncated]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">result <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> S12M.df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(exon_462) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[0-9]"</span>, exon_462))</span>
<span id="cb11-3"></span>
<span id="cb11-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(result<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gene_name)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "gene-LOC111119012"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">selected_gene_names <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> result<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gene_name</span></code></pre></div>
</div>
<p>Okay, we’ve identified gene-LOC111119012 as the gene which contains 462. Let’s see if this matches the original NCBI GFF.</p>
</section>
<section id="compare-number-of-exons-in-gene-loc111119012-between-s12m-exon_expression.tab-and-gcf_002022765.2_c_virginica-3.0_genomic.gff" class="level2">
<h2 class="anchored" data-anchor-id="compare-number-of-exons-in-gene-loc111119012-between-s12m-exon_expression.tab-and-gcf_002022765.2_c_virginica-3.0_genomic.gff">Compare number of exons in gene-LOC111119012 between <code>S12M-exon_expression.tab</code> and <code>GCF_002022765.2_C_virginica-3.0_genomic.gff</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\t"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$3 == "exon"'</span> /home/sam/gitrepos/ceabigr/genome-features/GCF_002022765.2_C_virginica-3.0_genomic.gff <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene=LOC111119012"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>268</code></pre>
</div>
</div>
<p>Okay, they do <em>not</em> match, which points to an issue with <code>S12M-exon_expression.tab</code>! I generated that file in <a href="https://github.com/sr320/ceabigr/blob/main/code/19-exon-expression.Rmd"><code>19-exon-expression.Rmd</code></a> using the Ballgown exon file (<code>e_data.ctab</code>) file as a source. Let’s check that first before I re-examine <a href="https://github.com/sr320/ceabigr/blob/main/code/19-exon-expression.Rmd"><code>19-exon-expression.Rmd</code></a>.</p>
</section>
</section>
<section id="compare-total-exons-in-e_data.ctab-and-gcf_002022765.2_c_virginica-3.0_genomic.gff" class="level1">
<h1>Compare total exons in <code>e_data.ctab</code> and <code>GCF_002022765.2_C_virginica-3.0_genomic.gff</code></h1>
<section id="count-exons-in-s12m-e_data.ctab." class="level2">
<h2 class="anchored" data-anchor-id="count-exons-in-s12m-e_data.ctab.">Count exons in S12M <code>e_data.ctab</code>.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">S12M.edata.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/sam/gitrepos/ceabigr/data/ballgown/S12M/e_data.ctab"</span>,</span>
<span id="cb16-2">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb16-3"></span>
<span id="cb16-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(S12M.edata.df)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   352757 obs. of  12 variables:
 $ e_id   : int  1 2 3 4 5 6 7 8 9 10 ...
 $ chr    : chr  "NC_007175.2" "NC_007175.2" "NC_007175.2" "NC_007175.2" ...
 $ strand : chr  "+" "+" "+" "+" ...
 $ start  : int  1 1710 8250 2645 3430 3499 3578 3647 4897 5673 ...
 $ end    : int  1623 2430 8997 3429 3495 3567 3646 4859 5589 5743 ...
 $ rcount : int  3406 26400 15868 1336 52 53 41 2586 1190 38 ...
 $ ucount : int  3406 26400 15868 1336 52 53 41 2585 1190 38 ...
 $ mrcount: num  3406 26400 15868 1336 52 ...
 $ cov    : num  232.4 4148.4 2338.9 181.2 68.7 ...
 $ cov_sd : num  159.7 3089.9 2148.5 67.5 3.4 ...
 $ mcov   : num  232.4 4148.4 2338.9 181.2 68.7 ...
 $ mcov_sd: num  159.7 3089.9 2148.5 67.5 3.4 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">exon.count.S12M.edata <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(S12M.edata.df)</span>
<span id="cb18-2"></span>
<span id="cb18-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(exon.count.S12M.edata)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 352757</code></pre>
</div>
</div>
</section>
<section id="count-exons-in-gcf_002022765.2_c_virginica-3.0_genomic.gff" class="level2">
<h2 class="anchored" data-anchor-id="count-exons-in-gcf_002022765.2_c_virginica-3.0_genomic.gff">Count exons in <code>GCF_002022765.2_C_virginica-3.0_genomic.gff</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">exon.count.ncbi.gff <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"awk -F '</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">' '$3 == </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">exon</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">' /home/sam/gitrepos/ceabigr/genome-features/GCF_002022765.2_C_virginica-3.0_genomic.gff | wc -l"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intern =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb20-2"></span>
<span id="cb20-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(exon.count.ncbi.gff)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "731916"</code></pre>
</div>
</div>
<p>Number of exons in <code>e_data.ctab</code>: 352757</p>
<p>Number of exons in NCBI GFF: 731916</p>
<p>So, we’re seeing that S12M <code>e_data.ctab</code> has ~50% of the total number of exons in the <a href="https://en.wikipedia.org/wiki/Eastern_oyster"><em>Crassostrea virginica</em> (Eastern oyster)</a> genome (as annotated by NCBI). This makes sense to me, as the data we’re using is RNAseq. So, not all genes are going to be expressed and, thus, we won’t have data for each gene/exon in the genome.</p>
<p>Regardless, based off of the difference in exon counts of gene-LOC111119012 in <code>GCF_002022765.2_C_virginica-3.0_genomic.gff</code> and <code>S12M-exon_expression.tab</code>, I will revisit <a href="https://github.com/sr320/ceabigr/blob/main/code/19-exon-expression.Rmd"><code>19-exon-expression.Rmd</code></a> to see where things might have gone wrong.</p>


</section>
</section>

 ]]></description>
  <category>CEABIGR</category>
  <category>Crassostrea viriginica</category>
  <category>Eastern oyster</category>
  <category>2023</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-12-06-Data-Investigation---Mysterious-Case-of-Excessive-Exons-in-CEABIGR/index.html</guid>
  <pubDate>Wed, 06 Dec 2023 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Daily Bits - December 2023</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-12-01-Daily-Bits---December-2023/index.html</link>
  <description><![CDATA[ 




<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section">20231219</h2>
<ul>
<li><p>Read Ch.3 of “Race After Technology: The New Jim Code”</p></li>
<li><p>Helped get Lindasy Alma set up for qPCRs and usage of the PCR Workstation in FTR 213.</p></li>
</ul>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1">20231218</h2>
<section id="in-lab" class="level3">
<h3 class="anchored" data-anchor-id="in-lab">In lab</h3>
<ul>
<li><p><a href="https://robertslab.github.io/sams-notebook/posts/2023/2023-12-18-Samples-Submitted---Gadus-macrocephalus-liver-tissues-to-Azenta-for-RNA-seq/">Shipped Pacific cod tissues to Azenta for RNA-seq</a> (notebook).</p></li>
<li><p>Tested out some broken URL GitHub action modifications to deal with my notebook.</p></li>
</ul>
</section>
</section>
<section id="section-2" class="level2">
<h2 class="anchored" data-anchor-id="section-2">20231215</h2>
<section id="coral-e5-github-repo" class="level3">
<h3 class="anchored" data-anchor-id="coral-e5-github-repo"><a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo)</h3>
<ul>
<li>Worked on manuscript</li>
</ul>
</section>
<section id="ceabigr-github-repo" class="level3">
<h3 class="anchored" data-anchor-id="ceabigr-github-repo"><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo)</h3>
<ul>
<li>Spent a bit more time looking into Ballgown exon counts and comparing with GFF.</li>
</ul>
</section>
</section>
<section id="section-3" class="level2">
<h2 class="anchored" data-anchor-id="section-3">20231214</h2>
<section id="hackweek" class="level3">
<h3 class="anchored" data-anchor-id="hackweek">Hackweek</h3>
<ul>
<li>Helped with Hisat2/Stringtie stuff.</li>
</ul>
</section>
</section>
<section id="section-4" class="level2">
<h2 class="anchored" data-anchor-id="section-4">20231213</h2>
<section id="hackweek-1" class="level3">
<h3 class="anchored" data-anchor-id="hackweek-1">Hackweek</h3>
<ul>
<li><p>Worked on broken URLs in notebook and lab website.</p></li>
<li><p>Helped with Grace Kallisto stuff.</p></li>
</ul>
</section>
</section>
<section id="section-5" class="level2">
<h2 class="anchored" data-anchor-id="section-5">20231211</h2>
<section id="hackweek-2" class="level3">
<h3 class="anchored" data-anchor-id="hackweek-2">Hackweek</h3>
<ul>
<li>Worked on broken URLs in notebook and lab website.</li>
</ul>
</section>
</section>
<section id="section-6" class="level2">
<h2 class="anchored" data-anchor-id="section-6">20231206</h2>
<section id="ceabigr-github-repo-1" class="level3">
<h3 class="anchored" data-anchor-id="ceabigr-github-repo-1"><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo)</h3>
<ul>
<li>Completed most of invstigation into exon count issues.</li>
</ul>
</section>
<section id="dei" class="level3">
<h3 class="anchored" data-anchor-id="dei">DEI</h3>
<ul>
<li>Read Ch.2 of “Race After Technology”</li>
</ul>
</section>
</section>
<section id="section-7" class="level2">
<h2 class="anchored" data-anchor-id="section-7">20231205</h2>
<p><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo)</p>
<ul>
<li>Started to investigate weird exon count issues identified last week.</li>
</ul>
<p><a href="https://github.com/laurahspencer/DuMOAR">DuMOAR</a> (GitHub repo)</p>
<ul>
<li>It was decided to have everyone begin writing their methods in the manuscript.</li>
</ul>
</section>
<section id="section-8" class="level2">
<h2 class="anchored" data-anchor-id="section-8">20231204</h2>
<p><a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo)</p>
<ul>
<li>Updated multiple README files</li>
</ul>
</section>
<section id="section-9" class="level2">
<h2 class="anchored" data-anchor-id="section-9">20231201</h2>
<p>-<a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo) Meeting</p>
<ul>
<li><p>Revisit trimming.</p>
<ul>
<li>Contact Azenta about trimming params.</li>
</ul></li>
<li><p>Science Hour</p>
<ul>
<li>Chatted with Kathleen about basics of NGS trimming.</li>
</ul></li>
</ul>


</section>

 ]]></description>
  <category>Daily Bits</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-12-01-Daily-Bits---December-2023/index.html</guid>
  <pubDate>Fri, 01 Dec 2023 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Plotting Fun - Lab Meeting Task</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-11-30-Plotting-Fun---Lab-Meeting-Task/index.html</link>
  <description><![CDATA[ 




<p>For today’s lab meeting, Steven tasked us with the following on Wednesday:</p>
<blockquote class="blockquote">
<p>For lab meeting Thursday the topic is “Plots”. Before the meeting make sure to create a notebook post where you show-off a plot of something you did in November, including showing the code used to generate the plot. :bar_chart: - Drop the url to the notebook post below.</p>
</blockquote>
<p>So, drawing a blank on what to plot, I opted to visualize commit history for the <a href="https://github.com/urol-e5/deep-dive">Coral E5 deep dive repo</a> (GitHub repo).</p>
<p>Let’s start with just trying to plot commits per day.</p>
<section id="initial-setup" class="level1">
<h1>Initial setup</h1>
<section id="load-libraries" class="level2">
<h2 class="anchored" data-anchor-id="load-libraries">Load libraries</h2>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
</div>
</section>
<section id="set-git-repo-path" class="level2">
<h2 class="anchored" data-anchor-id="set-git-repo-path">Set Git Repo Path</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">repo_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/sam/gitrepos/deep-dive/"</span></span></code></pre></div>
</div>
</section>
<section id="set-date-range" class="level2">
<h2 class="anchored" data-anchor-id="set-date-range">Set date range</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set date range</span></span>
<span id="cb5-2">start_date <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2023-11-01"</span>)</span>
<span id="cb5-3">end_date <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2023-11-30"</span>)</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Catpures all days in range</span></span>
<span id="cb5-6">all_days <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Date =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(start_date, end_date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"day"</span>))</span>
<span id="cb5-7"></span>
<span id="cb5-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(all_days)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Date
1 2023-11-01
2 2023-11-02
3 2023-11-03
4 2023-11-04
5 2023-11-05
6 2023-11-06</code></pre>
</div>
</div>
</section>
<section id="define-the-git-command-to-get-commit-dates-using-system" class="level2">
<h2 class="anchored" data-anchor-id="define-the-git-command-to-get-commit-dates-using-system">Define the Git command to get commit dates using <code>system()</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">git_command <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"git --git-dir="</span>,</span>
<span id="cb7-2">                     repo_path, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".git log --pretty=format:%ad --date=short --after="</span>,</span>
<span id="cb7-3">                     start_date,</span>
<span id="cb7-4">                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" --before="</span>,</span>
<span id="cb7-5">                     end_date,</span>
<span id="cb7-6">                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" --all"</span>,</span>
<span id="cb7-7">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb7-8"></span>
<span id="cb7-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(git_command)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "git --git-dir=/home/sam/gitrepos/deep-dive/.git log --pretty=format:%ad --date=short --after=2023-11-01 --before=2023-11-30 --all"</code></pre>
</div>
</div>
</section>
</section>
<section id="data-manipulation" class="level1">
<h1>Data manipulation</h1>
<section id="excecute-git-command" class="level2">
<h2 class="anchored" data-anchor-id="excecute-git-command">Excecute git command</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">commit_info <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>(git_command, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intern =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb9-2"></span>
<span id="cb9-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(commit_info)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> chr [1:228] "2023-11-30" "2023-11-30" "2023-11-30" "2023-11-30" ...</code></pre>
</div>
</div>
</section>
<section id="convert-to-dates-structure" class="level2">
<h2 class="anchored" data-anchor-id="convert-to-dates-structure">Convert to Dates structure</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">commit_dates <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"'"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, commit_info))</span>
<span id="cb11-2"></span>
<span id="cb11-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(commit_dates)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Date[1:228], format: "2023-11-30" "2023-11-30" "2023-11-30" "2023-11-30" "2023-11-30" ...</code></pre>
</div>
</div>
</section>
<section id="count-number-of-commits" class="level2">
<h2 class="anchored" data-anchor-id="count-number-of-commits">Count number of commits</h2>
<p>This will create a two-column dataframe (Date, Commits) and replace dates with 0 commits (NAs) with <code>0</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This counts number of commits on each date.</span></span>
<span id="cb13-2">commit_table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">table</span>(commit_dates)</span>
<span id="cb13-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(commit_table)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 'table' int [1:14(1d)] 8 17 19 6 7 21 13 5 4 16 ...
 - attr(*, "dimnames")=List of 1
  ..$ commit_dates: chr [1:14] "2023-11-01" "2023-11-02" "2023-11-03" "2023-11-04" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">all_days <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">merge</span>(</span>
<span id="cb15-2">  all_days,</span>
<span id="cb15-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb15-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Date =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(</span>
<span id="cb15-5">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(commit_table)</span>
<span id="cb15-6">      ),</span>
<span id="cb15-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Commits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(</span>
<span id="cb15-8">      commit_table)</span>
<span id="cb15-9">    ),</span>
<span id="cb15-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">all.x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb15-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Date"</span>)</span>
<span id="cb15-12"></span>
<span id="cb15-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Assigns value of `0` to all NAs</span></span>
<span id="cb15-14">all_days<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Commits[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(all_days<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Commits)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb15-15"></span>
<span id="cb15-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(all_days)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Date Commits
1 2023-11-01       8
2 2023-11-02      17
3 2023-11-03      19
4 2023-11-04       6
5 2023-11-05       7
6 2023-11-06      21</code></pre>
</div>
</div>
</section>
</section>
<section id="plot-all-commits-per-day" class="level1">
<h1>Plot all commits per day</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(all_days, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Commits)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"steelblue"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Commits per Day in Nov 2023"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Date"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of Commits"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-11-30-Plotting-Fun---Lab-Meeting-Task/index_files/figure-html/bar-plot-all-commits-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Bar plot of all November 2023 commits</figcaption>
</figure>
</div>
</div>
</div>
<p>Now, let’s try to look at commits per day by author…</p>
</section>
<section id="commits-per-day-per-author" class="level1">
<h1>Commits per day per author</h1>
<section id="create-a-data-frame-with-all-days-in-november" class="level2">
<h2 class="anchored" data-anchor-id="create-a-data-frame-with-all-days-in-november">Create a data frame with all days in November</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">all_days <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Date =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(start_date, end_date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"day"</span>))</span></code></pre></div>
</div>
</section>
<section id="new-git-command" class="level2">
<h2 class="anchored" data-anchor-id="new-git-command">New git command</h2>
<p>This adds author to format output</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">git_command <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"git --git-dir="</span>,repo_path, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".git log --date=short --all --format='%ad %an'"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb19-2"></span>
<span id="cb19-3">commit_info <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>(git_command, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intern =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</div>
</section>
<section id="split-the-commit-information-into-date-and-author" class="level2">
<h2 class="anchored" data-anchor-id="split-the-commit-information-into-date-and-author">Split the commit information into date and author</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">commit_info_split <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">strsplit</span>(commit_info, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>)</span>
<span id="cb20-2">commit_dates <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(commit_info_split, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[["</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb20-3">commit_authors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(commit_info_split, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[["</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb20-4"></span>
<span id="cb20-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(commit_dates)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Date[1:407], format: "2023-11-30" "2023-11-30" "2023-11-30" "2023-11-30" "2023-11-30" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(commit_authors)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> chr [1:407] "shedurkin" "shedurkin" "shedurkin" "shedurkin" "shedurkin" ...</code></pre>
</div>
</div>
</section>
<section id="create-data-frame-with-commits-and-authors" class="level2">
<h2 class="anchored" data-anchor-id="create-data-frame-with-commits-and-authors">Create data frame with commits and authors</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a data frame with commit information</span></span>
<span id="cb24-2">commit_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Date =</span> commit_dates, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Author =</span> commit_authors)</span>
<span id="cb24-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(commit_data)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Date    Author
1 2023-11-30 shedurkin
2 2023-11-30 shedurkin
3 2023-11-30 shedurkin
4 2023-11-30 shedurkin
5 2023-11-30 shedurkin
6 2023-11-17 shedurkin</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(commit_data)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   407 obs. of  2 variables:
 $ Date  : Date, format: "2023-11-30" "2023-11-30" ...
 $ Author: chr  "shedurkin" "shedurkin" "shedurkin" "shedurkin" ...</code></pre>
</div>
</div>
<section id="update-dataframe-to-include-all-days-in-november" class="level3">
<h3 class="anchored" data-anchor-id="update-dataframe-to-include-all-days-in-november">Update dataframe to include all days in November</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1">all_days <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">merge</span>(all_days, commit_data, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">all.x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Date"</span>)</span>
<span id="cb28-2"></span>
<span id="cb28-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(all_days)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   249 obs. of  2 variables:
 $ Date  : Date, format: "2023-11-01" "2023-11-01" ...
 $ Author: chr  "kubu4" "kubu4" "kubu4" "kubu4" ...</code></pre>
</div>
</div>
</section>
<section id="update-dataframe-with-commit-counts-per-author" class="level3">
<h3 class="anchored" data-anchor-id="update-dataframe-with-commit-counts-per-author">Update dataframe with commit counts per author</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1">all_days <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> all_days <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb30-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Date, Author) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb30-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Commits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>())</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Date'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(all_days)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>gropd_df [45 × 3] (S3: grouped_df/tbl_df/tbl/data.frame)
 $ Date   : Date[1:45], format: "2023-11-01" "2023-11-01" ...
 $ Author : chr [1:45] "Steven" "kubu4" "Steven" "kubu4" ...
 $ Commits: int [1:45] 1 12 4 10 3 5 14 2 4 4 ...
 - attr(*, "groups")= tibble [30 × 2] (S3: tbl_df/tbl/data.frame)
  ..$ Date : Date[1:30], format: "2023-11-01" "2023-11-02" ...
  ..$ .rows: list&lt;int&gt; [1:30] 
  .. ..$ : int [1:2] 1 2
  .. ..$ : int [1:3] 3 4 5
  .. ..$ : int [1:2] 6 7
  .. ..$ : int [1:2] 8 9
  .. ..$ : int [1:2] 10 11
  .. ..$ : int [1:2] 12 13
  .. ..$ : int [1:2] 14 15
  .. ..$ : int 16
  .. ..$ : int 17
  .. ..$ : int 18
  .. ..$ : int 19
  .. ..$ : int 20
  .. ..$ : int 21
  .. ..$ : int [1:2] 22 23
  .. ..$ : int [1:3] 24 25 26
  .. ..$ : int [1:3] 27 28 29
  .. ..$ : int [1:3] 30 31 32
  .. ..$ : int 33
  .. ..$ : int 34
  .. ..$ : int 35
  .. ..$ : int 36
  .. ..$ : int 37
  .. ..$ : int 38
  .. ..$ : int 39
  .. ..$ : int 40
  .. ..$ : int 41
  .. ..$ : int 42
  .. ..$ : int 43
  .. ..$ : int 44
  .. ..$ : int 45
  .. ..@ ptype: int(0) 
  ..- attr(*, ".drop")= logi TRUE</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="plot-commits-per-day-per-author" class="level1">
<h1>Plot commits per day per author</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(all_days, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Commits, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Author)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb34-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb34-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Commits by Author per Day in Nov 2023"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Date"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of Commits"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb34-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb34-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Set2"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-11-30-Plotting-Fun---Lab-Meeting-Task/index_files/figure-html/stacked-bar-plot-commits-by-author-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Stacked bar plot of November 2023 commits per day per author</figcaption>
</figure>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>plotting</category>
  <category>R</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-11-30-Plotting-Fun---Lab-Meeting-Task/index.html</guid>
  <pubDate>Thu, 30 Nov 2023 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Transcriptome Annotation - M.magister De Novo Transcriptome Assembly Using Trinotate on Mox</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-11-09-Transcriptome-Annotation---M.magister-De-Novo-Transcriptome-Assembly-Using-Trinotate-on-Mox/index.html</link>
  <description><![CDATA[ 




<section id="intro" class="level1">
<h1>Intro</h1>
<p>As part of <a href="https://github.com/laurahspencer/DuMOAR/issues/44">transcriptome annotation</a> (GitHub issue) for <a href="https://github.com/laurahspencer/DuMOAR">DuMOAR</a> (GitHub repo), I’ve already run <a href="https://https://github.com/TransDecoder/TransDecoder/wiki.com/Trinotate/Trinotate/wiki"><code>TransDecoder</code></a> ( run on <a href="../../../posts/2023/2023-11-07-Transcriptome-Annotation---M.magister-De-Novo-Transcriptome-Assembly-for-DuMOAR-Project-Using-TransDecoder-on-Mox/index.html">20231107</a>), as well as <a href="https://github.com/bbuchfink/diamond"><code>DIAMOND</code></a> BLASTx (run <a href="../../../posts/2023/2023-11-09-Transcriptome-Annotation---M.magister-De-Novo-Transcriptome-Assembly-for-DuMOAR-Project-Using-DIAMOND-BLASTx-on-Mox/index.html">earlier today</a>). The final part of getting the transcriptome annotated was to run <a href="https://github.com/Trinotate/Trinotate/wiki"><code>Trinotate</code></a>. <a href="https://github.com/Trinotate/Trinotate/wiki"><code>Trinotate</code></a> uses a combination of tools to generate a pretty thorough annotation of transcriptomes. This was run on Mox.</p>
<section id="slurm-script" class="level2">
<h2 class="anchored" data-anchor-id="slurm-script">SLURM script</h2>
<ul>
<li><a href="https://github.com/RobertsLab/sams-notebook/blob/master/sbatch_scripts/20231109-mmag-trinotate-transcriptome.sh">20231109-mmag-trinotate-transcriptome.sh</a> (GitHub)</li>
</ul>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Job Name</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --job-name=20231109-mmag-trinotate-transcriptome</span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Allocation Definition</span></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --account=srlab</span></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --partition=srlab</span></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Resources</span></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Nodes</span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --nodes=1</span></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Walltime (days-hours:minutes:seconds format)</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --time=4-00:00:00</span></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Memory per node</span></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mem=120G</span></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##turn on e-mail notification</span></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-type=ALL</span></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-user=samwhite@uw.edu</span></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Specify the working directory for this job</span></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --chdir=/gscratch/scrubbed/samwhite/outputs/20231109-mmag-trinotate-transcriptome</span></span>
<span id="cb1-19"></span>
<span id="cb1-20"></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Script to run Trinotate on M.magister transcriptome.</span></span>
<span id="cb1-22"></span>
<span id="cb1-23"></span>
<span id="cb1-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################</span></span>
<span id="cb1-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># These variables need to be set by user</span></span>
<span id="cb1-26"></span>
<span id="cb1-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Input files</span></span>
<span id="cb1-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## BLASTx</span></span>
<span id="cb1-29"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">blastx_out</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/scrubbed/samwhite/outputs/20231109-mmag-transcriptome-diamond-blastx/trinity_denovo.Trinity.blastx.outfmt6"</span></span>
<span id="cb1-30"></span>
<span id="cb1-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## TransDecoder</span></span>
<span id="cb1-32"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">transdecoder_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/scrubbed/samwhite/outputs/20231107-mmag-transdecoder-transcriptome"</span></span>
<span id="cb1-33"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">blastp_out</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${transdecoder_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/blastp_out/blastp.outfmt6"</span></span>
<span id="cb1-34"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pfam_out</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${transdecoder_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/pfam_out/pfam.domtblout"</span></span>
<span id="cb1-35"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">lORFs_pep</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${transdecoder_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/trinity_denovo.Trinity.fasta.transdecoder_dir/longest_orfs.pep"</span></span>
<span id="cb1-36"></span>
<span id="cb1-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Transcriptomics</span></span>
<span id="cb1-38"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">transcriptomes_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/sam/data/M_magister/transcriptomes"</span></span>
<span id="cb1-39"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trinity_fasta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${transcriptomes_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/trinity_denovo.Trinity.fasta"</span></span>
<span id="cb1-40"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trinity_gene_map</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${transcriptomes_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/trinity_denovo.Trinity.fasta.gene_trans_map"</span></span>
<span id="cb1-41"></span>
<span id="cb1-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################</span></span>
<span id="cb1-43"></span>
<span id="cb1-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Exit script if any command fails</span></span>
<span id="cb1-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span></span>
<span id="cb1-46"></span>
<span id="cb1-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load Python Mox module for Python module availability</span></span>
<span id="cb1-48"></span>
<span id="cb1-49"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load intel-python3_2017</span>
<span id="cb1-50"></span>
<span id="cb1-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># SegFault fix?</span></span>
<span id="cb1-52"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">THREADS_DAEMON_MODEL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb1-53"></span>
<span id="cb1-54"></span>
<span id="cb1-55"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">wd</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-56"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">timestamp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">date</span> +%Y%m%d<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-57"></span>
<span id="cb1-58"></span>
<span id="cb1-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Paths to input/output files</span></span>
<span id="cb1-60"></span>
<span id="cb1-61"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## New folders for working directory</span></span>
<span id="cb1-62"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rnammer_out_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${wd}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/RNAmmer_out"</span></span>
<span id="cb1-63"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">signalp_out_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${wd}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/signalp_out"</span></span>
<span id="cb1-64"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tmhmm_out_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${wd}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/tmhmm_out"</span></span>
<span id="cb1-65"></span>
<span id="cb1-66"></span>
<span id="cb1-67"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rnammer_prefix</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinity_fasta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-68"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">prefix</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${timestamp}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${rnammer_prefix}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.trinotate"</span></span>
<span id="cb1-69"></span>
<span id="cb1-70"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output files</span></span>
<span id="cb1-71"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rnammer_out</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${rnammer_out_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${rnammer_prefix}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.rnammer.gff"</span></span>
<span id="cb1-72"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">signalp_out</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${signalp_out_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${prefix}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.signalp.out"</span></span>
<span id="cb1-73"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tmhmm_out</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${tmhmm_out_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${prefix}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.tmhmm.out"</span></span>
<span id="cb1-74"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trinotate_report</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${wd}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${prefix}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_annotation_report.txt"</span></span>
<span id="cb1-75"></span>
<span id="cb1-76"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Paths to programs</span></span>
<span id="cb1-77"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rnammer_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/programs/RNAMMER-1.2"</span></span>
<span id="cb1-78"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rnammer</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${rnammer_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/rnammer"</span></span>
<span id="cb1-79"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">signalp_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/programs/signalp-4.1"</span></span>
<span id="cb1-80"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">signalp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${signalp_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/signalp"</span></span>
<span id="cb1-81"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tmhmm_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/programs/tmhmm-2.0c/bin"</span></span>
<span id="cb1-82"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tmhmm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${tmhmm_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/tmhmm"</span></span>
<span id="cb1-83"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trinotate_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/programs/Trinotate-v3.1.1"</span></span>
<span id="cb1-84"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trinotate</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/Trinotate"</span></span>
<span id="cb1-85"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trinotate_rnammer</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/util/rnammer_support/RnammerTranscriptome.pl"</span></span>
<span id="cb1-86"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trinotate_GO</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/util/extract_GO_assignments_from_Trinotate_xls.pl"</span></span>
<span id="cb1-87"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trinotate_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/util/Trinotate_get_feature_name_encoding_attributes.pl"</span></span>
<span id="cb1-88"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trinotate_sqlite_db</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Trinotate.sqlite"</span></span>
<span id="cb1-89"></span>
<span id="cb1-90"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate FastA checksum, for reference if needed.</span></span>
<span id="cb1-91"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinity_fasta}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> fasta.checksum.md5</span>
<span id="cb1-92"></span>
<span id="cb1-93"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directories</span></span>
<span id="cb1-94"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${rnammer_out_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${signalp_out_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${tmhmm_out_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-95"></span>
<span id="cb1-96"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Copy sqlite database template</span></span>
<span id="cb1-97"></span>
<span id="cb1-98"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cp</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_dir}</span>/admin/Trinotate.sqlite .</span>
<span id="cb1-99"></span>
<span id="cb1-100"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run signalp</span></span>
<span id="cb1-101"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${signalp}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-102">-f short <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-103">-n <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${signalp_out}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-104"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${lORFs_pep}</span></span>
<span id="cb1-105"></span>
<span id="cb1-106"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run tmHMM</span></span>
<span id="cb1-107"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${tmhmm}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-108">--short <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-109"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${lORFs_pep}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-110"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${tmhmm_out}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-111"></span>
<span id="cb1-112"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run RNAmmer</span></span>
<span id="cb1-113"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Has "||" operator due to previous lack of matches</span></span>
<span id="cb1-114"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Need "||" to continue with annotation.</span></span>
<span id="cb1-115"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${rnammer_out_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">exit</span></span>
<span id="cb1-116"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_rnammer}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-117">--transcriptome <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinity_fasta}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-118">--path_to_rnammer <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${rnammer}</span></span>
<span id="cb1-119"></span>
<span id="cb1-120"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${wd}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">exit</span></span>
<span id="cb1-121"></span>
<span id="cb1-122"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run Trinotate</span></span>
<span id="cb1-123"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Load transcripts and coding regions into database</span></span>
<span id="cb1-124"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-125"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_sqlite_db}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-126">init <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-127">--gene_trans_map <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinity_gene_map}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-128">--transcript_fasta <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinity_fasta}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-129">--transdecoder_pep <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${lORFs_pep}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-130"></span>
<span id="cb1-131"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Load BLAST homologies</span></span>
<span id="cb1-132"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-133"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_sqlite_db}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-134">LOAD_swissprot_blastp <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-135"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${blastp_out}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-136"></span>
<span id="cb1-137"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-138"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_sqlite_db}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-139">LOAD_swissprot_blastx <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-140"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${blastx_out}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-141"></span>
<span id="cb1-142"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Load Pfam</span></span>
<span id="cb1-143"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-144"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_sqlite_db}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-145">LOAD_pfam <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-146"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${pfam_out}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-147"></span>
<span id="cb1-148"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Load transmembrane domains</span></span>
<span id="cb1-149"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-150"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_sqlite_db}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-151">LOAD_tmhmm <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-152"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${tmhmm_out}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-153"></span>
<span id="cb1-154"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Load signal peptides</span></span>
<span id="cb1-155"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-156"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_sqlite_db}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-157">LOAD_signalp <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-158"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${signalp_out}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-159"></span>
<span id="cb1-160"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Load RNAmmer</span></span>
<span id="cb1-161"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-162"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_sqlite_db}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-163">LOAD_rnammer <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-164"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${rnammer_out}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-165"></span>
<span id="cb1-166"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Creat annotation report</span></span>
<span id="cb1-167"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-168"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_sqlite_db}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-169">report <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-170"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_report}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-171"></span>
<span id="cb1-172"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract GO terms from annotation report</span></span>
<span id="cb1-173"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-174">--Trinotate_xls <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_report}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-175">-G <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-176">--include_ancestral_terms <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-177"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${prefix}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.go_annotations.txt</span>
<span id="cb1-178"></span>
<span id="cb1-179"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make transcript features annotation map</span></span>
<span id="cb1-180"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_features}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-181"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_report}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-182"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${prefix}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.annotation_feature_map.txt</span>
<span id="cb1-183"></span>
<span id="cb1-184"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">####################################################################</span></span>
<span id="cb1-185"></span>
<span id="cb1-186"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Capture program options</span></span>
<span id="cb1-187"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-gt</span> 0 <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-188">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Logging program options..."</span></span>
<span id="cb1-189">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> program <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-190">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span>
<span id="cb1-191">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-192">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Program options for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">: "</span></span>
<span id="cb1-193">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-194">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle samtools help menus</span></span>
<span id="cb1-195">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_index"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-196">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_sort"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-197">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_view"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span></span>
<span id="cb1-198">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-199">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-200"></span>
<span id="cb1-201">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle DIAMOND BLAST menu</span></span>
<span id="cb1-202">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"diamond"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-203">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> help</span>
<span id="cb1-204"></span>
<span id="cb1-205">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle NCBI BLASTx menu</span></span>
<span id="cb1-206">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blastx"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-207">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-help</span></span>
<span id="cb1-208"></span>
<span id="cb1-209">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle StringTie prepDE script</span></span>
<span id="cb1-210">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"prepDE"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-211">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-h</span></span>
<span id="cb1-212">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb1-213">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-h</span></span>
<span id="cb1-214">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-215">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-216">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"----------------------------------------------"</span></span>
<span id="cb1-217">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-218">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-219">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&gt;&gt;</span> program_options.log <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb1-220"></span>
<span id="cb1-221">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If MultiQC is in programs_array, copy the config file to this directory.</span></span>
<span id="cb1-222">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"multiqc"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-223">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cp</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--preserve</span> ~/.multiqc_config.yaml multiqc_config.yaml</span>
<span id="cb1-224">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb1-225">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span>
<span id="cb1-226">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Finished logging programs options."</span></span>
<span id="cb1-227">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-228"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb1-229"></span>
<span id="cb1-230"></span>
<span id="cb1-231"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Document programs in PATH (primarily for program version ID)</span></span>
<span id="cb1-232"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Logging system </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$PATH</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">..."</span></span>
<span id="cb1-233"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-234"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">date</span></span>
<span id="cb1-235"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-236"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"System PATH for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$SLURM_JOB_ID</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-237"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-238"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%0.s-"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">..</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-239"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${PATH}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tr</span> : <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\\</span>n</span>
<span id="cb1-240"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> system_path.log</span>
<span id="cb1-241"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Finished logging system </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$PATH</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">."</span></span></code></pre></div>
<p>/———-</p>
</section>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<section id="runtime" class="level2">
<h2 class="anchored" data-anchor-id="runtime">Runtime</h2>
<p>Runtime was just under 3.5hrs:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-11-09-Transcriptome-Annotation---M.magister-De-Novo-Transcriptome-Assembly-Using-Trinotate-on-Mox/20231109-mmag-trinotate-transcriptome-runtime.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Screencap showing Trinotate runtime on Mox of 3hrs, 21mins, 10secs</figcaption>
</figure>
</div>
</section>
<section id="files" class="level2">
<h2 class="anchored" data-anchor-id="files">Files</h2>
<p>Output directory:</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/20231109-mmag-trinotate-transcriptome/">20231109-mmag-trinotate-transcriptome/</a></li>
</ul>
<section id="annotation-feature-map" class="level3">
<h3 class="anchored" data-anchor-id="annotation-feature-map">Annotation Feature Map</h3>
<p>Annotation feature map (10MB; TXT):</p>
<ul>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20231109-mmag-trinotate-transcriptome/20231109.trinity_denovo.Trinity.fasta.trinotate.annotation_feature_map.txt">20231109.trinity_denovo.Trinity.fasta.trinotate.annotation_feature_map.txt</a></p>
<ul>
<li><p><a href="https://github.com/trinityrnaseq/trinityrnaseq/wiki/Functional-Annotation-of-Transcripts">This can be used to update Trinity-based gene expression matrices like so</a>:</p>
<ul>
<li><code>${TRINITY_HOME}/Analysis/DifferentialExpression/rename_matrix_feature_identifiers.pl Trinity_trans.counts.matrix annot_feature_map.txt &gt; Trinity_trans.counts.wAnnot.matrix</code></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="gene-ontology-go-annotations" class="level3">
<h3 class="anchored" data-anchor-id="gene-ontology-go-annotations">Gene Ontology (GO) Annotations</h3>
<p>Gene ontology (GO) annotations (26MB; TXT):</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/20231109-mmag-trinotate-transcriptome/20231109.trinity_denovo.Trinity.fasta.trinotate.go_annotations.txt">20231109.trinity_denovo.Trinity.fasta.trinotate.go_annotations.txt</a></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(kableExtra)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read in data frame</span></span>
<span id="cb2-5">go.annotations.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/Atumefaciens/20231109-mmag-trinotate-transcriptome/20231109.trinity_denovo.Trinity.fasta.trinotate.go_annotations.txt"</span>,</span>
<span id="cb2-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb2-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Provide column names</span></span>
<span id="cb2-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(go.annotations.df)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene.ID"</span></span>
<span id="cb2-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(go.annotations.df)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span></span>
<span id="cb2-12"></span>
<span id="cb2-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create nice HTML table</span></span>
<span id="cb2-14">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(go.annotations.df))</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-GO-annotations" class="anchored">
<table data-quarto-postprocess="true" data-tbl-colwidths="[60,40]" class="table table-sm table-striped small">
<caption>Table&nbsp;1: Gene Ontology annotations</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Gene.ID</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">GO.IDs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">TRINITY_DN0_c7_g1</td>
<td style="text-align: left;">GO:0000166,GO:0001678,GO:0001882,GO:0001883,GO:0003674,GO:0003824,GO:0004611,GO:0004613,GO:0005488,GO:0005525,GO:0005575,GO:0005739,GO:0005759,GO:0005829,GO:0005975,GO:0005996,GO:0006006,GO:0006066,GO:0006071,GO:0006082,GO:0006090,GO:0006094,GO:0006114,GO:0006629,GO:0006631,GO:0006950,GO:0008150,GO:0008152,GO:0009056,GO:0009058,GO:0009062,GO:0009605,GO:0009719,GO:0009725,GO:0009743,GO:0009746,GO:0009749,GO:0009987,GO:0009991,GO:0010033,GO:0010243,GO:0014070,GO:0016042,GO:0016051,GO:0016054,GO:0016829,GO:0016830,GO:0016831,GO:0017076,GO:0019001,GO:0019318,GO:0019319,GO:0019400,GO:0019401,GO:0019541,GO:0019543,GO:0019626,GO:0019725,GO:0019751,GO:0019752,GO:0030145,GO:0030154,GO:0030855,GO:0031667,GO:0031960,GO:0031974,GO:0032502,GO:0032549,GO:0032550,GO:0032553,GO:0032555,GO:0032561,GO:0032787,GO:0032868,GO:0032869,GO:0032870,GO:0033500,GO:0033993,GO:0034284,GO:0034637,GO:0035639,GO:0036094,GO:0042221,GO:0042592,GO:0042593,GO:0042594,GO:0043167,GO:0043168,GO:0043169,GO:0043226,GO:0043227,GO:0043229,GO:0043231,GO:0043233,GO:0043434,GO:0043436,GO:0044237,GO:0044238,GO:0044242,GO:0044248,GO:0044249,GO:0044255,GO:0044262,GO:0044281,GO:0044282,GO:0044283,GO:0044422,GO:0044424,GO:0044429,GO:0044444,GO:0044446,GO:0044464,GO:0044699,GO:0044710,GO:0044711,GO:0044712,GO:0044723,GO:0044763,GO:0044767,GO:0046165,GO:0046173,GO:0046327,GO:0046364,GO:0046395,GO:0046459,GO:0046872,GO:0046914,GO:0048545,GO:0048869,GO:0048878,GO:0050896,GO:0051384,GO:0051716,GO:0055082,GO:0065007,GO:0065008,GO:0070013,GO:0070365,GO:0070887,GO:0071310,GO:0071322,GO:0071326,GO:0071331,GO:0071333,GO:0071375,GO:0071383,GO:0071384,GO:0071385,GO:0071396,GO:0071407,GO:0071417,GO:0071495,GO:0071548,GO:0071549,GO:0071704,GO:0072329,GO:0097159,GO:0097367,GO:1901265,GO:1901363,GO:1901575,GO:1901576,GO:1901615,GO:1901617,GO:1901652,GO:1901653,GO:1901654,GO:1901655,GO:1901698,GO:1901699,GO:1901700,GO:1901701</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRINITY_DN100001_c0_g1</td>
<td style="text-align: left;">GO:0003674,GO:0003824,GO:0005575,GO:0005634,GO:0006629,GO:0007165,GO:0008081,GO:0008150,GO:0008152,GO:0009056,GO:0009987,GO:0016042,GO:0016787,GO:0016788,GO:0042578,GO:0043226,GO:0043227,GO:0043229,GO:0043231,GO:0044238,GO:0044424,GO:0044464,GO:0044699,GO:0044710,GO:0044712,GO:0050789,GO:0050794,GO:0065007,GO:0071704,GO:1901575</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TRINITY_DN100003_c0_g1</td>
<td style="text-align: left;">GO:0000166,GO:0000932,GO:0000975,GO:0000976,GO:0000977,GO:0000978,GO:0000987,GO:0001012,GO:0001067,GO:0001159,GO:0001650,GO:0003674,GO:0003676,GO:0003677,GO:0003682,GO:0003690,GO:0003697,GO:0003723,GO:0003824,GO:0003916,GO:0003917,GO:0004672,GO:0004674,GO:0005488,GO:0005515,GO:0005524,GO:0005575,GO:0005634,GO:0005654,GO:0005730,GO:0006139,GO:0006259,GO:0006260,GO:0006265,GO:0006325,GO:0006338,GO:0006464,GO:0006468,GO:0006725,GO:0006793,GO:0006796,GO:0006807,GO:0006996,GO:0007059,GO:0007623,GO:0008150,GO:0008152,GO:0008219,GO:0009058,GO:0009059,GO:0009330,GO:0009987,GO:0010468,GO:0012501,GO:0016032,GO:0016043,GO:0016301,GO:0016310,GO:0016740,GO:0016772,GO:0016773,GO:0016853,GO:0017076,GO:0018105,GO:0018193,GO:0018209,GO:0019222,GO:0019538,GO:0019904,GO:0030529,GO:0030554,GO:0031298,GO:0032501,GO:0032553,GO:0032555,GO:0032559,GO:0032922,GO:0032991,GO:0032993,GO:0034641,GO:0034645,GO:0035639,GO:0035770,GO:0036094,GO:0036211,GO:0036464,GO:0040016,GO:0042221,GO:0042493,GO:0043167,GO:0043168,GO:0043170,GO:0043204,GO:0043226,GO:0043227,GO:0043228,GO:0043229,GO:0043231,GO:0043232,GO:0043234,GO:0043412,GO:0043565,GO:0044212,GO:0044237,GO:0044238,GO:0044249,GO:0044260,GO:0044267,GO:0044403,GO:0044419,GO:0044422,GO:0044424,GO:0044427,GO:0044428,GO:0044444,GO:0044446,GO:0044452,GO:0044454,GO:0044464,GO:0044699,GO:0044707,GO:0044763,GO:0044764,GO:0046483,GO:0048511,GO:0050789,GO:0050896,GO:0051276,GO:0051301,GO:0051704,GO:0060255,GO:0065007,GO:0071103,GO:0071704,GO:0071840,GO:0090304,GO:0097100,GO:0097159,GO:0097367,GO:0097458,GO:1901265,GO:1901360,GO:1901363,GO:1901564,GO:1901576,GO:1990837,GO:1990904</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRINITY_DN100006_c0_g1</td>
<td style="text-align: left;">GO:0003674,GO:0003824,GO:0008150,GO:0008152,GO:0016491,GO:0044699,GO:0044710,GO:0055114</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TRINITY_DN100007_c0_g1</td>
<td style="text-align: left;">GO:0000166,GO:0003674,GO:0003824,GO:0004854,GO:0004855,GO:0005488,GO:0005506,GO:0005575,GO:0005777,GO:0005829,GO:0006082,GO:0006139,GO:0006144,GO:0006145,GO:0006725,GO:0006807,GO:0008150,GO:0008152,GO:0009055,GO:0009056,GO:0009058,GO:0009112,GO:0009115,GO:0009987,GO:0016491,GO:0016725,GO:0016726,GO:0016727,GO:0018130,GO:0019438,GO:0019439,GO:0030151,GO:0034418,GO:0034641,GO:0036094,GO:0042579,GO:0043167,GO:0043168,GO:0043169,GO:0043226,GO:0043227,GO:0043229,GO:0043231,GO:0043546,GO:0044237,GO:0044238,GO:0044248,GO:0044249,GO:0044270,GO:0044271,GO:0044281,GO:0044283,GO:0044424,GO:0044444,GO:0044464,GO:0044699,GO:0044710,GO:0044711,GO:0044712,GO:0044763,GO:0046110,GO:0046113,GO:0046415,GO:0046483,GO:0046700,GO:0046872,GO:0046914,GO:0048037,GO:0050660,GO:0050662,GO:0051536,GO:0051537,GO:0051540,GO:0055086,GO:0055114,GO:0070674,GO:0071704,GO:0071949,GO:0072521,GO:0072522,GO:0072523,GO:0097159,GO:1901265,GO:1901360,GO:1901361,GO:1901362,GO:1901363,GO:1901564,GO:1901565,GO:1901566,GO:1901575,GO:1901576</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRINITY_DN10000_c0_g1</td>
<td style="text-align: left;">GO:0000149,GO:0000281,GO:0000910,GO:0001505,GO:0001671,GO:0001745,GO:0003674,GO:0005483,GO:0005488,GO:0005515,GO:0005575,GO:0005737,GO:0005774,GO:0005886,GO:0006461,GO:0006810,GO:0006836,GO:0006886,GO:0006891,GO:0006906,GO:0006996,GO:0007154,GO:0007267,GO:0007268,GO:0007269,GO:0007270,GO:0007274,GO:0007420,GO:0008047,GO:0008104,GO:0008105,GO:0008150,GO:0009653,GO:0009887,GO:0009987,GO:0010646,GO:0010807,GO:0015031,GO:0015833,GO:0016020,GO:0016043,GO:0016050,GO:0016082,GO:0016192,GO:0017157,GO:0017158,GO:0019905,GO:0022402,GO:0022411,GO:0022607,GO:0023051,GO:0023052,GO:0023061,GO:0030154,GO:0030182,GO:0030234,GO:0031090,GO:0031201,GO:0031410,GO:0031629,GO:0031982,GO:0032386,GO:0032502,GO:0032781,GO:0032879,GO:0032940,GO:0032984,GO:0032991,GO:0033036,GO:0033267,GO:0034214,GO:0034622,GO:0035249,GO:0035494,GO:0040007,GO:0042886,GO:0043085,GO:0043195,GO:0043226,GO:0043227,GO:0043229,GO:0043234,GO:0043241,GO:0043254,GO:0043462,GO:0043623,GO:0043624,GO:0043679,GO:0043933,GO:0044087,GO:0044093,GO:0044306,GO:0044422,GO:0044424,GO:0044425,GO:0044437,GO:0044444,GO:0044446,GO:0044456,GO:0044463,GO:0044464,GO:0044699,GO:0044700,GO:0044763,GO:0044765,GO:0044767,GO:0044801,GO:0044802,GO:0044877,GO:0045026,GO:0045176,GO:0045184,GO:0045202,GO:0046903,GO:0046907,GO:0046928,GO:0048193,GO:0048284,GO:0048513,GO:0048526,GO:0048589,GO:0048592,GO:0048856,GO:0048869,GO:0050789,GO:0050790,GO:0050794,GO:0050804,GO:0051046,GO:0051049,GO:0051128,GO:0051179,GO:0051234,GO:0051259,GO:0051260,GO:0051336,GO:0051345,GO:0051588,GO:0051641,GO:0051649,GO:0060341,GO:0060560,GO:0060589,GO:0060590,GO:0060627,GO:0061024,GO:0061025,GO:0061640,GO:0065003,GO:0065007,GO:0065008,GO:0065009,GO:0070044,GO:0071702,GO:0071705,GO:0071822,GO:0071840,GO:0090174,GO:0090596,GO:0097458,GO:0097708,GO:0098588,GO:0098693,GO:0098772,GO:0098793,GO:0098794,GO:0098796,GO:0098805,GO:0098916,GO:0098978,GO:0099500,GO:0099531,GO:0099536,GO:0099537,GO:0099643,GO:1902578,GO:1902589,GO:1902803,GO:1903047,GO:1903305,GO:1903530,GO:2000300</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</section>
<section id="full-annotations" class="level3">
<h3 class="anchored" data-anchor-id="full-annotations">Full Annotations</h3>
<p>Annotation report (107MB; CSV):</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/20231109-mmag-trinotate-transcriptome/20231109.trinity_denovo.Trinity.fasta.trinotate_annotation_report.txt">20231109.trinity_denovo.Trinity.fasta.trinotate_annotation_report.txt</a></li>
</ul>
<p>This table is tab-delimited, but uses <code>^</code> for intra-field delimitation:</p>
<div class="cell" data-hash="index_cache/html/tbl-annotation-report_c7037e429e58ec83c7c6c701f1b7953a">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(kableExtra)</span>
<span id="cb3-2"></span>
<span id="cb3-3">annotations.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/Atumefaciens/20231109-mmag-trinotate-transcriptome/20231109.trinity_denovo.Trinity.fasta.trinotate_annotation_report.txt"</span>,</span>
<span id="cb3-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb3-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb3-6"></span>
<span id="cb3-7">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(annotations.df))</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-annotation-report" class="anchored">
<table data-quarto-postprocess="true" data-tbl-colwidths="[60,40]" class="table table-sm table-striped small">
<caption>Table&nbsp;2: Full annotations</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">X.gene_id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">transcript_id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">sprot_Top_BLASTX_hit</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RNAMMER</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">prot_id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">prot_coords</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">sprot_Top_BLASTP_hit</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Pfam</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">SignalP</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">TmHMM</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">eggnog</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Kegg</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">gene_ontology_blast</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">gene_ontology_pfam</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">transcript</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">peptide</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">TRINITY_DN8_c0_g1</td>
<td style="text-align: left;">TRINITY_DN8_c0_g1_i1</td>
<td style="text-align: left;">sp|Q63089|S22A1_RAT^sp|Q63089|S22A1_RAT^Q:905-18,H:87-381^36.2%ID^E:1.09e-38^.^.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">TRINITY_DN8_c0_g1_i1.p1</td>
<td style="text-align: left;">908-3[-]</td>
<td style="text-align: left;">S22A1_RAT^S22A1_RAT^Q:2-297,H:87-381^36.156%ID^E:5.87e-43^RecName: Full=Solute carrier family 22 member 1;^Eukaryota; Metazoa; Chordata; Craniata; Vertebrata; Euteleostomi; Mammalia; Eutheria; Euarchontoglires; Glires; Rodentia; Myomorpha; Muroidea; Muridae; Murinae; Rattus</td>
<td style="text-align: left;">PF00083.24^Sugar_tr^Sugar (and other) transporter^57-276^E:4.5e-21`PF07690.16^MFS_1^Major Facilitator Superfamily^61-278^E:7e-18</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">ExpAA=119.03^PredHel=5^Topology=i59-81o91-109i116-138o148-170i177-196o</td>
<td style="text-align: left;">ENOG410XR5P^Major facilitator superfamily MFS_1</td>
<td style="text-align: left;">KEGG:rno:24904`KO:K08198</td>
<td style="text-align: left;">GO:0016323^cellular_component^basolateral plasma membrane`GO:0005887^cellular_component^integral component of plasma membrane`GO:0005277^molecular_function^acetylcholine transmembrane transporter activity`GO:0005330^molecular_function^dopamine:sodium symporter activity`GO:0042802^molecular_function^identical protein binding`GO:0008504^molecular_function^monoamine transmembrane transporter activity`GO:0005334^molecular_function^norepinephrine:sodium symporter activity`GO:0015101^molecular_function^organic cation transmembrane transporter activity`GO:0042803^molecular_function^protein homodimerization activity`GO:0015651^molecular_function^quaternary ammonium group transmembrane transporter activity`GO:0008513^molecular_function^secondary active organic cation transmembrane transporter activity`GO:0015872^biological_process^dopamine transport`GO:0006855^biological_process^drug transmembrane transport`GO:0048241^biological_process^epinephrine transport`GO:0010248^biological_process^establishment or maintenance of transmembrane electrochemical gradient`GO:0015844^biological_process^monoamine transport`GO:0015874^biological_process^norepinephrine transport`GO:0015695^biological_process^organic cation transport`GO:0051260^biological_process^protein homooligomerization`GO:0015697^biological_process^quaternary ammonium group transport</td>
<td style="text-align: left;">GO:0022857^molecular_function^transmembrane transporter activity`GO:0055085^biological_process^transmembrane transport`GO:0016021^cellular_component^integral component of membrane</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRINITY_DN8_c0_g1</td>
<td style="text-align: left;">TRINITY_DN8_c0_g1_i1</td>
<td style="text-align: left;">sp|Q63089|S22A1_RAT^sp|Q63089|S22A1_RAT^Q:905-18,H:87-381^36.2%ID^E:1.09e-38^.^.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">TRINITY_DN8_c0_g1_i1.p2</td>
<td style="text-align: left;">810-1[-]</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TRINITY_DN8_c0_g1</td>
<td style="text-align: left;">TRINITY_DN8_c0_g1_i4</td>
<td style="text-align: left;">sp|Q9VIK2|CART_DROME^sp|Q9VIK2|CART_DROME^Q:1209-529,H:114-344^33.8%ID^E:2.21e-27^.^.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">TRINITY_DN8_c0_g1_i4.p1</td>
<td style="text-align: left;">1212-475[-]</td>
<td style="text-align: left;">CART_DROME^CART_DROME^Q:2-242,H:114-358^32.661%ID^E:6.98e-33^RecName: Full=Carcinine transporter {ECO:0000303|PubMed:26653853, ECO:0000303|PubMed:26713872};^Eukaryota; Metazoa; Ecdysozoa; Arthropoda; Hexapoda; Insecta; Pterygota; Neoptera; Holometabola; Diptera; Brachycera; Muscomorpha; Ephydroidea; Drosophilidae; Drosophila; Sophophora</td>
<td style="text-align: left;">PF00083.24^Sugar_tr^Sugar (and other) transporter^56-219^E:7.4e-19`PF07690.16^MFS_1^Major Facilitator Superfamily^61-209^E:1e-15</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">ExpAA=106.03^PredHel=5^Topology=i59-81o91-109i116-138o148-170i177-196o</td>
<td style="text-align: left;">ENOG410XSRI^solute carrier family 22</td>
<td style="text-align: left;">KEGG:dme:Dmel_CG9317</td>
<td style="text-align: left;">GO:0043679^cellular_component^axon terminus`GO:0016021^cellular_component^integral component of membrane`GO:0005886^cellular_component^plasma membrane`GO:1905131^molecular_function^carcinine transmembrane transporter activity`GO:0005326^molecular_function^neurotransmitter transporter activity`GO:1905130^biological_process^carcinine import across plasma membrane`GO:0050908^biological_process^detection of light stimulus involved in visual perception`GO:0001504^biological_process^neurotransmitter uptake`GO:0046956^biological_process^positive phototaxis`GO:0007601^biological_process^visual perception</td>
<td style="text-align: left;">GO:0022857^molecular_function^transmembrane transporter activity`GO:0055085^biological_process^transmembrane transport`GO:0016021^cellular_component^integral component of membrane</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRINITY_DN8_c0_g1</td>
<td style="text-align: left;">TRINITY_DN8_c0_g1_i4</td>
<td style="text-align: left;">sp|Q9VIK2|CART_DROME^sp|Q9VIK2|CART_DROME^Q:1209-529,H:114-344^33.8%ID^E:2.21e-27^.^.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">TRINITY_DN8_c0_g1_i4.p2</td>
<td style="text-align: left;">1114-494[-]</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TRINITY_DN8_c0_g1</td>
<td style="text-align: left;">TRINITY_DN8_c0_g1_i4</td>
<td style="text-align: left;">sp|Q9VIK2|CART_DROME^sp|Q9VIK2|CART_DROME^Q:1209-529,H:114-344^33.8%ID^E:2.21e-27^.^.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">TRINITY_DN8_c0_g1_i4.p3</td>
<td style="text-align: left;">497-126[-]</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">ExpAA=41.12^PredHel=2^Topology=i13-35o104-122i</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRINITY_DN8_c0_g2</td>
<td style="text-align: left;">TRINITY_DN8_c0_g2_i1</td>
<td style="text-align: left;">sp|Q6NY98|MCE1_DANRE^sp|Q6NY98|MCE1_DANRE^Q:665-84,H:7-198^57.7%ID^E:2.12e-77^.^.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">TRINITY_DN8_c0_g2_i1.p1</td>
<td style="text-align: left;">707-3[-]</td>
<td style="text-align: left;">MCE1_MOUSE^MCE1_MOUSE^Q:14-203,H:6-193^56.842%ID^E:4.77e-75^RecName: Full=mRNA-capping enzyme;^Eukaryota; Metazoa; Chordata; Craniata; Vertebrata; Euteleostomi; Mammalia; Eutheria; Euarchontoglires; Glires; Rodentia; Myomorpha; Muroidea; Muridae; Murinae; Mus; Mus</td>
<td style="text-align: left;">PF00782.20^DSPc^Dual specificity phosphatase, catalytic domain^65-182^E:5.3e-10</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">COG5226^Second step of mRNA capping. Transfer of the GMP moiety of GTP to the 5'-end of RNA via an enzyme-GMP covalent reaction intermediate (By similarity)</td>
<td style="text-align: left;">KEGG:mmu:24018`KO:K13917</td>
<td style="text-align: left;">GO:0005634^cellular_component^nucleus`GO:0005525^molecular_function^GTP binding`GO:0004484^molecular_function^mRNA guanylyltransferase activity`GO:0004651^molecular_function^polynucleotide 5'-phosphatase activity`GO:0004725^molecular_function^protein tyrosine phosphatase activity`GO:0008138^molecular_function^protein tyrosine/serine/threonine phosphatase activity`GO:0008192^molecular_function^RNA guanylyltransferase activity`GO:0050355^molecular_function^triphosphatase activity`GO:0006370^biological_process^7-methylguanosine mRNA capping`GO:0006396^biological_process^RNA processing</td>
<td style="text-align: left;">GO:0008138^molecular_function^protein tyrosine/serine/threonine phosphatase activity`GO:0016311^biological_process^dephosphorylation</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<div class="cell" data-hash="index_cache/html/annotation-counts_b8c38a99ee3ed3706329435f365333f8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">number_of_annotations <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n_distinct</span>(annotations.df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>X.gene_id)</span></code></pre></div>
</details>
</div>
<p>Number of Trinity genes with annotations: 142402</p>
</section>
<section id="sqlite-database" class="level3">
<h3 class="anchored" data-anchor-id="sqlite-database">SQlite Database</h3>
<p>SQlite database (797MB; SQLITE):</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/20231109-mmag-trinotate-transcriptome/Trinotate.sqlite">Trinotate.sqlite</a></li>
</ul>


</section>
</section>
</section>

 ]]></description>
  <category>mox</category>
  <category>2023</category>
  <category>Metacarcinus magister</category>
  <category>Dungenss crab</category>
  <category>Trinotate</category>
  <category>transcriptome</category>
  <category>annotation</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-11-09-Transcriptome-Annotation---M.magister-De-Novo-Transcriptome-Assembly-Using-Trinotate-on-Mox/index.html</guid>
  <pubDate>Thu, 09 Nov 2023 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Transcriptome Annotation - M.magister De Novo Transcriptome Assembly for DuMOAR Project Using DIAMOND BLASTx on Mox</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-11-09-Transcriptome-Annotation---M.magister-De-Novo-Transcriptome-Assembly-for-DuMOAR-Project-Using-DIAMOND-BLASTx-on-Mox/index.html</link>
  <description><![CDATA[ 




<section id="intro" class="level1">
<h1>Intro</h1>
<p>As part of the process for using <a href="https://github.com/Trinotate/Trinotate/wiki"><code>Trinotate</code></a> for <a href="https://github.com/laurahspencer/DuMOAR/issues/44">transcriptome annotation</a> (GitHub Issue), I previously ran <a href="../../../posts/2023/2023-11-07-Transcriptome-Annotation---M.magister-De-Novo-Transcriptome-Assembly-for-DuMOAR-Project-Using-TransDecoder-on-Mox/index.html">TransDecoder on 20231107</a>. Next, I needed to run BLASTx. As usual, I opted for <a href="https://github.com/bbuchfink/diamond"><code>DIAMOND</code></a> BLASTx, as it is insanely faster than <a href="https://www.ncbi.nlm.nih.gov/books/NBK279690/">NCBI <code>BLASTx</code></a>. This was run on Mox.</p>
<section id="slurm-script" class="level2">
<h2 class="anchored" data-anchor-id="slurm-script">SLURM script</h2>
<ul>
<li><a href="https://github.com/RobertsLab/sams-notebook/blob/master/sbatch_scripts/20231109-mmag-transcriptome-diamond-blastx.sh">20231109-mmag-transcriptome-diamond-blastx.sh</a> (GitHub)</li>
</ul>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Job Name</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --job-name=20231109-mmag-transcriptome-diamond-blastx</span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Allocation Definition</span></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --account=srlab</span></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --partition=srlab</span></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Resources</span></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Nodes</span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --nodes=1</span></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Walltime (days-hours:minutes:seconds format)</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --time=3-00:00:00</span></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Memory per node</span></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mem=500G</span></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##turn on e-mail notification</span></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-type=ALL</span></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-user=samwhite@uw.edu</span></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Specify the working directory for this job</span></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --chdir=/gscratch/scrubbed/samwhite/outputs/20231109-mmag-transcriptome-diamond-blastx</span></span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### DIAMOND BLASTx of M.magister de novo transcriptome.</span></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### For use in DuMOAR transcript annotation.</span></span>
<span id="cb1-22"></span>
<span id="cb1-23"></span>
<span id="cb1-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################</span></span>
<span id="cb1-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># These variables need to be set by user</span></span>
<span id="cb1-26"></span>
<span id="cb1-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Exit script if any command fails</span></span>
<span id="cb1-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span></span>
<span id="cb1-29"></span>
<span id="cb1-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load Python Mox module for Python module availability</span></span>
<span id="cb1-31"></span>
<span id="cb1-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load intel-python3_2017</span>
<span id="cb1-33"></span>
<span id="cb1-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># SegFault fix?</span></span>
<span id="cb1-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">THREADS_DAEMON_MODEL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb1-36"></span>
<span id="cb1-37"></span>
<span id="cb1-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Programs array</span></span>
<span id="cb1-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">declare</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span></span>
<span id="cb1-40"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb1-41"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>diamond<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/programs/diamond-v2.1.1/diamond"</span></span>
<span id="cb1-42"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-43"></span>
<span id="cb1-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># DIAMOND UniProt database</span></span>
<span id="cb1-45"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dmnd_db</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/blastdbs/20230727-uniprot-swissprot-reviewed/uniprot_sprot.dmnd"</span></span>
<span id="cb1-46"></span>
<span id="cb1-47"></span>
<span id="cb1-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Genome (FastA)</span></span>
<span id="cb1-49"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fasta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/sam/data/M_magister/transcriptomes/trinity_denovo.Trinity.fasta"</span></span>
<span id="cb1-50"></span>
<span id="cb1-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################</span></span>
<span id="cb1-52"></span>
<span id="cb1-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Strip leading pat and extensions</span></span>
<span id="cb1-54"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">no_path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fasta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-55"></span>
<span id="cb1-56"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Strip extension</span></span>
<span id="cb1-57"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">no_ext</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${no_path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>.<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-58"></span>
<span id="cb1-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run DIAMOND with blastx</span></span>
<span id="cb1-60"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>diamond<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> blastx <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-61">--db <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${dmnd_db}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-62">--query <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fasta}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-63">--out <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${no_ext}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.blastx.outfmt6 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-64">--outfmt 6 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-65">--sensitive <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-66">--evalue 1e-25 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-67">--max-target-seqs 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-68">--block-size 15.0 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-69">--index-chunks 4</span>
<span id="cb1-70"></span>
<span id="cb1-71"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate checksums for future reference</span></span>
<span id="cb1-72"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb1-73"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span>
<span id="cb1-74">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-75">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Generating checksum for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">."</span></span>
<span id="cb1-76">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-77"></span>
<span id="cb1-78">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--append</span> checksums.md5</span>
<span id="cb1-79">  </span>
<span id="cb1-80">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-81"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span>
<span id="cb1-82"></span>
<span id="cb1-83"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Generating checksum for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fasta}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">."</span></span>
<span id="cb1-84"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-85"></span>
<span id="cb1-86"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fasta}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--append</span> checksums.md5</span>
<span id="cb1-87"></span>
<span id="cb1-88"></span>
<span id="cb1-89"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################</span></span>
<span id="cb1-90"></span>
<span id="cb1-91"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Disable exit on error</span></span>
<span id="cb1-92"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> +e</span>
<span id="cb1-93"></span>
<span id="cb1-94"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Capture program options</span></span>
<span id="cb1-95"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-gt</span> 0 <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-96">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Logging program options..."</span></span>
<span id="cb1-97">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> program <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-98">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span>
<span id="cb1-99">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-100">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Program options for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">: "</span></span>
<span id="cb1-101">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-102">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle samtools help menus</span></span>
<span id="cb1-103">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_index"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-104">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_sort"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-105">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_view"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span></span>
<span id="cb1-106">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-107">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-108"></span>
<span id="cb1-109">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle DIAMOND BLAST menu</span></span>
<span id="cb1-110">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"diamond"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-111">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> help</span>
<span id="cb1-112"></span>
<span id="cb1-113">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle NCBI BLASTx menu</span></span>
<span id="cb1-114">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blastx"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-115">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-help</span></span>
<span id="cb1-116">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb1-117">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-h</span></span>
<span id="cb1-118">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-119">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-120">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"----------------------------------------------"</span></span>
<span id="cb1-121">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-122">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-123">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&gt;&gt;</span> program_options.log <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb1-124"></span>
<span id="cb1-125">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If MultiQC is in programs_array, copy the config file to this directory.</span></span>
<span id="cb1-126">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"multiqc"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-127">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cp</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--preserve</span> ~/.multiqc_config.yaml multiqc_config.yaml</span>
<span id="cb1-128">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb1-129">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span>
<span id="cb1-130"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb1-131"></span>
<span id="cb1-132"></span>
<span id="cb1-133"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Document programs in PATH (primarily for program version ID)</span></span>
<span id="cb1-134"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-135"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">date</span></span>
<span id="cb1-136"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-137"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"System PATH for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$SLURM_JOB_ID</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-138"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-139"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%0.s-"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">..</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-140"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${PATH}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tr</span> : <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\\</span>n</span>
<span id="cb1-141"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> system_path.log</span></code></pre></div>
<p>/———-</p>
</section>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<section id="runtime" class="level2">
<h2 class="anchored" data-anchor-id="runtime">Runtime</h2>
<p>As usual, <a href="https://github.com/bbuchfink/diamond"><code>DIAMOND</code></a> BLASTx was ridiculously fast; 1m and 17secs!</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-11-09-Transcriptome-Annotation---M.magister-De-Novo-Transcriptome-Assembly-for-DuMOAR-Project-Using-DIAMOND-BLASTx-on-Mox/20231109-mmag-transcriptome-diamond-blastx-runtime.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Screencap showing Mox DIAMOND BLASTx run time of 1min and 17secs</figcaption>
</figure>
</div>
</section>
<section id="files" class="level2">
<h2 class="anchored" data-anchor-id="files">FILES</h2>
<p>Output directory:</p>
<ul>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20231109-mmag-transcriptome-diamond-blastx/">20231109-mmag-transcriptome-diamond-blastx/</a></p>
<h3 id="blastx-txt-output-format-6" class="anchored">BLASTx (txt; output format 6)</h3>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/20231109-mmag-transcriptome-diamond-blastx/trinity_denovo.Trinity.blastx.outfmt6">trinity_denovo.Trinity.blastx.outfmt6</a></li>
</ul></li>
</ul>


</section>
</section>

 ]]></description>
  <category>mox</category>
  <category>DIAMOND</category>
  <category>BLASTx</category>
  <category>transcriptome</category>
  <category>2023</category>
  <category>DuMOAR</category>
  <category>Dungeness crab</category>
  <category>Metacarcinus magister</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-11-09-Transcriptome-Annotation---M.magister-De-Novo-Transcriptome-Assembly-for-DuMOAR-Project-Using-DIAMOND-BLASTx-on-Mox/index.html</guid>
  <pubDate>Thu, 09 Nov 2023 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Daily Bits - November 2023</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-11-05-Daily-Bits---November-2023/index.html</link>
  <description><![CDATA[ 




<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section">20231130</h2>
<ul>
<li><p>Lab meeting.</p>
<ul>
<li>Finished <a href="https://robertslab.github.io/sams-notebook/posts/2023/2023-11-30-Plotting-Fun---Lab-Meeting-Task/">plotting task</a> from yesterday.</li>
</ul></li>
<li><p><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo) meeting.</p>
<ul>
<li>Identified definition of spurious transcription and how to calculate.</li>
</ul></li>
</ul>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1">20231129</h2>
<ul>
<li><p>ProCard reconciliation.</p></li>
<li><p>Worked on task for tomorrow’s lab meeting.</p></li>
<li><p>Meeting with Daniell. Made a couple of suggestsions for her to work on:</p>
<ul>
<li><p>Develop/teach Apptainers (Singularity).</p></li>
<li><p>Develop BLAST/UniProt/GO annotation pipeline.</p></li>
</ul></li>
</ul>
</section>
<section id="section-2" class="level2">
<h2 class="anchored" data-anchor-id="section-2">20231117</h2>
<p><a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo)</p>
<ul>
<li><p>Finished adding numbers to presentation.</p></li>
<li><p>E5 molecular meeting</p>
<ul>
<li>Decided to re-evaluate trimming, due to lack of matches in R2 reads.</li>
</ul></li>
</ul>
</section>
<section id="section-3" class="level2">
<h2 class="anchored" data-anchor-id="section-3">20231116</h2>
<ul>
<li><p><a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo):</p>
<ul>
<li><p>Continued <em>P.evermanni</em> sRNAseq analysis.</p></li>
<li><p>Work on presentation for tomorrow.</p></li>
</ul></li>
<li><p><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo)</p>
<ul>
<li><p>Discussed spurious transcription:</p>
<ul>
<li><a href="https://github.com/sr320/ceabigr/issues/86">Decided to calculate exon expression regression</a> (GitHub Issue)</li>
</ul></li>
</ul></li>
<li><p>Helped Grace L. with a git/GitHub issue on Raven (committed files which were too big for GitHub).</p></li>
</ul>
</section>
<section id="section-4" class="level2">
<h2 class="anchored" data-anchor-id="section-4">20231115</h2>
<ul>
<li><p><a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo):</p>
<ul>
<li>Started <em>P.evermanni</em> sRNAseq analysis.</li>
</ul></li>
</ul>
</section>
<section id="section-5" class="level2">
<h2 class="anchored" data-anchor-id="section-5">20231114</h2>
<p>-<a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo):</p>
<ul>
<li>Knitted <a href="https://github.com/rajewsky-lab/mirdeep2"><code>miRDeep2</code></a> analysis to markdown and HTML.</li>
</ul>
</section>
<section id="section-6" class="level2">
<h2 class="anchored" data-anchor-id="section-6">20231113</h2>
<p>-<a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo):</p>
<ul>
<li><p><a href="https://github.com/rajewsky-lab/mirdeep2"><code>miRDeep2</code></a> analysis finally completed after 72hrs (!).</p></li>
<li><p>Started teasing out some of the results from the MiRDeep2 analysis.</p></li>
</ul>
</section>
<section id="section-7" class="level2">
<h2 class="anchored" data-anchor-id="section-7">20231109</h2>
<ul>
<li><p><a href="https://github.com/laurahspencer/DuMOAR">DuMOAR</a></p>
<ul>
<li><p>Ran <a href="https://github.com/bbuchfink/diamond">DIAMOND BLASTx</a> to use for <a href="https://github.com/Trinotate/Trinotate/wiki">Trinotate</a>.</p></li>
<li><p>Ran <a href="https://github.com/Trinotate/Trinotate/wiki">Trinotate</a>.</p></li>
</ul></li>
</ul>
</section>
<section id="section-8" class="level2">
<h2 class="anchored" data-anchor-id="section-8">20231108</h2>
<ul>
<li><p>Coral E5</p>
<ul>
<li>Dealt with the trials and tribulations of getting <a href="https://github.com/rajewsky-lab/mirdeep2">miRDeep2</a> to run. There are a lot of “hidden” file formatting requirements which aren’t documented until a job fails. Even then, the error messages don’t provide any advice. However, finally got it running!</li>
</ul></li>
<li><p>Read Ch. 1 of “Race After Technology: The New Jim Code” by Ruha Benjamin for DEI bookclub discussion at tomorrow’s lab meeting.</p></li>
</ul>
</section>
<section id="section-9" class="level2">
<h2 class="anchored" data-anchor-id="section-9">20231107</h2>
<ul>
<li><p>Coral E5</p>
<ul>
<li>Ran NCBI BLASTn on <em>A.pulcha</em> sRNAseq.</li>
</ul></li>
<li><p><a href="https://github.com/laurahspencer/DuMOAR">DuMOAR</a></p>
<ul>
<li>Began <a href="https://github.com/laurahspencer/DuMOAR/issues/44">transcriptome annotation</a> (GitHub) issue with <a href="https://github.com/TransDecoder/TransDecoder/wiki">TransDecoder</a>.</li>
</ul></li>
</ul>
</section>
<section id="section-10" class="level2">
<h2 class="anchored" data-anchor-id="section-10">20231106</h2>
<ul>
<li><p>ProCard reconciliation.</p></li>
<li><p>Scan/upload packing slips for purchases to Workday.</p></li>
<li><p>Coral E5</p>
<ul>
<li><p>non-coding RNA meeting.</p></li>
<li><p>Begin miRNA BLASTn.</p></li>
</ul></li>
</ul>
</section>
<section id="section-11" class="level2">
<h2 class="anchored" data-anchor-id="section-11">20231103</h2>
<ul>
<li><p>Coral E5</p>
<ul>
<li><p>Ran <a href="https://github.com/MikeAxtell/ShortStack">ShortStack</a> on <em>A.pulchra</em> (uses <em>A.millepora</em> genome though, since no <em>A.pulchra</em> genome exists) sRNAseq reads to identify potential miRNAs.</p>
<ul>
<li><p><a href="https://github.com/urol-e5/deep-dive/blob/main/D-Apul/code/13-Apul-sRNAseq-ShortStack.Rmd">13-Apul-sRNAseq-ShortStack.Rmd</a></p></li>
<li><p>Wasted a <em>lot</em> time messing around/learning how to Knit documements in R Markdown.</p></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="section-12" class="level2">
<h2 class="anchored" data-anchor-id="section-12">20231102</h2>
<ul>
<li><p>In lab.</p></li>
<li><p>E5 lncRNA meeting.</p></li>
<li><p>Lab meeting.</p></li>
<li><p>CEABIGR meeting.</p></li>
<li><p>Coral E5</p>
<ul>
<li><p>Ran <a href="https://github.com/sinanugur/MirMachine">MirMachine</a> to identify miRNAs in <em>A.pulchra</em>.</p>
<ul>
<li><a href="https://github.com/urol-e5/deep-dive/blob/main/D-Apul/code/12-Apul-sRNAseq-MirMachine.Rmd">12-Apul-sRNAseq-MirMachine.Rmd</a></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="section-13" class="level2">
<h2 class="anchored" data-anchor-id="section-13">20231101</h2>
<ul>
<li><p>Read intro to “Race After Technology: Abolisitionist for the new Jim Code”.</p></li>
<li><p>Coral E5</p>
<ul>
<li><p>Ran <a href="https://github.com/friedlanderlab/mirtrace">miRTrace</a> on <em>A.pulcrha</em> sRNAseq data to identify potential taxonomic origins of miRNAs.</p>
<ul>
<li><a href="https://github.com/urol-e5/deep-dive/blob/main/D-Apul/code/09-Apul-sRNAseq-miRTrace.Rmd">09-Apul-sRNAseq-miRTrace.Rmd</a></li>
</ul></li>
</ul></li>
</ul>


</section>

 ]]></description>
  <category>Daily Bits</category>
  <category>2023</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-11-05-Daily-Bits---November-2023/index.html</guid>
  <pubDate>Sun, 05 Nov 2023 07:00:00 GMT</pubDate>
</item>
<item>
  <title>qPCR Analysis - C.gigas Matt George Poly:IC Diploids</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-08-22-qPCR-Analysis---C.gigas-Matt-George-Poly:IC-Diploids/index.html</link>
  <description><![CDATA[ 




<p>Ran a “quick and dirty” qPCR analysis for the qPCR’s I’d previously run:</p>
<ul>
<li><p><a href="https://robertslab.github.io/sams-notebook/posts/2023/2023-07-26-qPCR---C.gigas-polyIC/">20230726</a></p></li>
<li><p><a href="https://robertslab.github.io/sams-notebook/posts/2023/2023-08-17-qPCR---C.gigas-PolyIC-Diploid-MgCl2/">20230817</a></p></li>
</ul>
<p>All analyses are documented in the following R Project:</p>
<ul>
<li><a href="https://github.com/RobertsLab/code/tree/master/r_projects/sam/20230822-cgig-polyIC-qPCR">20230822-cgig-polyIC-qPCR</a> (GitHub)</li>
</ul>
<p>Here’s a brief overview of what was done:</p>
<ol type="1">
<li>Select only diploid samples (currently, only have control/injected groups for diploids - not triploids)</li>
<li>Normalize to actin by calculating delta Cq.</li>
</ol>
<ul>
<li>This was done for the sake of time. Actin and GAPDH (the other normalizing gene run) shows evidence of a treatment effect. Actin was selected over GAPDH due to smaller range between mean Cqs of Control/Injected.</li>
</ul>
<ol start="3" type="1">
<li>Run t-test to determine p-values between control/injected withing each actin-normalized gene.</li>
<li>Box plot all delta Cq values.</li>
<li>Calculate 2^<sup>(-delta delta Cq)</sup> (subtract Control delta Cq from Injected delta Cq) to determine fold change in expression for each gene.</li>
<li>Plot fold change in expression as bar plots. Values &gt;1 indicate increase in relative expression. Values &lt;1 indicate decrease in relative expression.</li>
</ol>
<hr>
<section id="results" class="level1">
<h1>RESULTS</h1>
<section id="box-plots-delta-cq" class="level2">
<h2 class="anchored" data-anchor-id="box-plots-delta-cq">Box Plots (delta Cq)</h2>
<p>Box plots of delta Cq (i.e.&nbsp;normalize to Actin). T-test identified only a single gene (marked with orange asterisk) as significantly different between Control/Injected: DICER</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-08-22-qPCR-Analysis---C.gigas-Matt-George-Poly:IC-Diploids/https:/github.com/RobertsLab/code/blob/master/r_projects/sam/20230822-cgig-polyIC-qPCR/output/01-qPCR-analysis/figures/diploid.delta-Cq.boxplots.jpg?raw=true" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">boxplots comparing 6 different genes - orange asterisk above Cg_DICER indicates statistically different between Control and Injected</figcaption>
</figure>
</div>
<hr>
</section>
<section id="fold-change-2-ddcq" class="level2">
<h2 class="anchored" data-anchor-id="fold-change-2-ddcq">Fold Change (2<sup>-(ddCq)</sup>)</h2>
<p>Fold change in gene expression of Injected individuals, relative to control samples.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-08-22-qPCR-Analysis---C.gigas-Matt-George-Poly:IC-Diploids/https:/github.com/RobertsLab/code/blob/master/r_projects/sam/20230822-cgig-polyIC-qPCR/output/01-qPCR-analysis/figures/diploid.delta-delta-Cq.fold-change.barplots.jpg?raw=true" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Bar plots showing fold change for each gene. Value &gt; 1 means “upregulated”; value &lt; 1 means “downregulated”.</figcaption>
</figure>
</div>


</section>
</section>

 ]]></description>
  <category>2023</category>
  <category>Miscellaneous</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-08-22-qPCR-Analysis---C.gigas-Matt-George-Poly:IC-Diploids/index.html</guid>
  <pubDate>Wed, 23 Aug 2023 01:56:00 GMT</pubDate>
</item>
<item>
  <title>Transcript Identification and Alignments - C.virginica RNAseq with NCBI Genome GCF_002022765.2 Using Hisat2 and Stringtie on Mox Again</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-08-21-Transcript-Identification-and-Alignments---C.virginica-RNAseq-with-NCBI-Genome-GCF_002022765.2-Using-Hisat2-and-Stringtie-on-Mox-Again/index.html</link>
  <description><![CDATA[ 




<p>In the process of generating expression matrices for <a href="https://github.com/sr320/ceabigr/tree/main/data">CEABIGR</a> (GitHub repo), and in turn distance matrices for these samples, I realized a couple of things:</p>
<ol type="1">
<li><p><a href="https://bioconductor.org/packages/release/bioc/vignettes/DESeq2/inst/doc/DESeq2.html">DESeq2</a> has a function (<code>assay()</code>) that will automatically calculate/produce the distance matrices I want.</p></li>
<li><p><a href="https://ccb.jhu.edu/software/stringtie/"><code>StringTie</code></a> comes with a script (<code>prepDE.py3</code>) which will spit out expression matrices formatted for import into <a href="https://bioconductor.org/packages/release/bioc/vignettes/DESeq2/inst/doc/DESeq2.html">DESeq2</a>.</p></li>
</ol>
<p>So, this should be easy, right? Of course not. LOL. When trying to run the <a href="https://ccb.jhu.edu/software/stringtie/"><code>StringTie</code></a> <code>prepDE.py3</code> script on the <a href="https://robertslab.github.io/sams-notebook/posts/2022/2022-02-25-Transcript-Identification-and-Alignments---C.virginica-RNAseq-with-NCBI-Genome-GCF_002022765.2-Using-Hisat2-and-Stringtie-on-Mox/">original output from Stringtie on 20220225</a> (notebook), I encountered a parsing error for the very first GTF file it encountered. Considering the GTF file(s) was/are generated by <a href="https://ccb.jhu.edu/software/stringtie/"><code>StringTie</code></a>, it seemed odd that it wouldn’t be able to parse the GTF. Doing some investigating, I came across a number of <a href="https://github.com/gpertea/stringtie/issues">issues in the Stringtie GitHub repo</a> indicating that using a version of Stringtie (e.g.&nbsp;&lt;<code>v2.2.0</code>), with a certain combination of arguments (specifically, the <code>-e</code> argument seemed potentially problematic) could create various errors if using that output with an updated version of <a href="https://ccb.jhu.edu/software/stringtie/"><code>StringTie</code></a>. Well, I was doing just that! Was it causing the parsing error I was experiencing? Don’t know, but I’d also like to avoid the other downstream errors potentially associated with the output(s) from the older version of Stringtie, so I’ve decided to re-run the analysis using a the most current version of <a href="https://ccb.jhu.edu/software/stringtie/"><code>StringTie</code></a>.</p>
<p>I used the <a href="https://robertslab.github.io/sams-notebook/posts/2022/2022-02-24-Trimming-Additional-20bp-from-C.virginica-Gonad-RNAseq-with-fastp-on-Mox/">trimmed RNAseq reads from 20220224</a> (notebook). I also needed to identify alternative transcripts in the <a href="https://en.wikipedia.org/wiki/Eastern_oyster"><em>Crassostrea virginica</em> (Eastern oyster)</a> gonad RNAseq data we have. I previously used <a href="https://daehwankimlab.github.io/hisat2/"><code>HISAT2</code></a> to index the NCBI <a href="https://en.wikipedia.org/wiki/Eastern_oyster"><em>Crassostrea virginica</em> (Eastern oyster)</a> genome and identify exon/splice sites <a href="https://robertslab.github.io/sams-notebook/2021/07/20/Genome-Annotations-Splice-Site-and-Exon-Extractions-for-C.virginica-GCF_002022765.2-Genome-Using-Hisat2-on-Mox/">on 20210720</a>. Then, I used this genome index to run <a href="https://ccb.jhu.edu/software/stringtie/"><code>StringTie</code></a> on Mox in order to map sequencing reads to the genome/alternative isoforms.</p>
<p>Job was run on Mox.</p>
<p>Skip to RESULTS section.</p>
<p>SLURM Script (GitHub):</p>
<ul>
<li><a href="https://github.com/RobertsLab/sams-notebook/blob/master/sbatch_scripts/20230821-cvir-stringtie-GCF_002022765.2-isoforms.sh">20230821-cvir-stringtie-GCF_002022765.2-isoforms.sh</a></li>
</ul>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Job Name</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --job-name=20230821-cvir-stringtie-GCF_002022765.2-isoforms</span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Allocation Definition</span></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --account=srlab</span></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --partition=srlab</span></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Resources</span></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Nodes</span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --nodes=1</span></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Walltime (days-hours:minutes:seconds format)</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --time=3-12:00:00</span></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Memory per node</span></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mem=500G</span></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##turn on e-mail notification</span></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-type=ALL</span></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-user=samwhite@uw.edu</span></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Specify the working directory for this job</span></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --chdir=/gscratch/scrubbed/samwhite/outputs/20230821-cvir-stringtie-GCF_002022765.2-isoforms</span></span>
<span id="cb1-19"></span>
<span id="cb1-20"></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Script using Stringtie with NCBI C.virginica genome assembly</span></span>
<span id="cb1-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## and HiSat2 index generated on 20210714.</span></span>
<span id="cb1-23"></span>
<span id="cb1-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Expects FastQ input filenames to match &lt;sample name&gt;_R[12].fastp-trim.20bp-5prime.20220224.fq.gz</span></span>
<span id="cb1-25"></span>
<span id="cb1-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## This is an updated run of 20230821-cvir-stringtie-GCF_002022765.2-isoforms. The previous run used an</span></span>
<span id="cb1-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## outdated version of StringTie, which may have led to some downstream issues.</span></span>
<span id="cb1-28"></span>
<span id="cb1-29"></span>
<span id="cb1-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################</span></span>
<span id="cb1-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># These variables need to be set by user</span></span>
<span id="cb1-32"></span>
<span id="cb1-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Assign Variables</span></span>
<span id="cb1-34"></span>
<span id="cb1-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set number of CPUs to use</span></span>
<span id="cb1-36"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">threads</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>28</span>
<span id="cb1-37"></span>
<span id="cb1-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Index name for Hisat2 use</span></span>
<span id="cb1-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Needs to match index naem used in previous Hisat2 indexing step</span></span>
<span id="cb1-40"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">genome_index_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cvir_GCF_002022765.2"</span></span>
<span id="cb1-41"></span>
<span id="cb1-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Location of Hisat2 index files</span></span>
<span id="cb1-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Must keep variable name formatting, as it's used by HiSat2</span></span>
<span id="cb1-44"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">HISAT2_INDEXES</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">HISAT2_INDEXES</span></span>
<span id="cb1-46"></span>
<span id="cb1-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Paths to programs</span></span>
<span id="cb1-48"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">hisat2_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/programs/hisat2-2.1.0"</span></span>
<span id="cb1-49"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">hisat2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${hisat2_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/hisat2"</span></span>
<span id="cb1-50"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samtools</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/programs/samtools-1.10/samtools"</span></span>
<span id="cb1-51"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">stringtie</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/programs/stringtie-2.2.1.Linux_x86_64/stringtie"</span></span>
<span id="cb1-52"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">prepDE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/programs/stringtie-2.2.1.Linux_x86_64/prepDE.py3"</span></span>
<span id="cb1-53"></span>
<span id="cb1-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Input/output files</span></span>
<span id="cb1-55"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">genome_index_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/sam/data/C_virginica/genomes"</span></span>
<span id="cb1-56"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">genome_gff</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_index_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/GCF_002022765.2_C_virginica-3.0_genomic.gff"</span></span>
<span id="cb1-57"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/sam/data/C_virginica/RNAseq/"</span></span>
<span id="cb1-58"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gtf_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gtf_list.txt"</span></span>
<span id="cb1-59"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">merged_bam</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"20230821_cvir_stringtie_GCF_002022765-sorted-bams-merged.bam"</span></span>
<span id="cb1-60"></span>
<span id="cb1-61"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Declare associative array of sample names and metadata</span></span>
<span id="cb1-62"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">declare</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samples_associative_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb1-63"></span>
<span id="cb1-64"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set total number of samples (NOT number of FastQ files)</span></span>
<span id="cb1-65"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_samples</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>26</span>
<span id="cb1-66"></span>
<span id="cb1-67"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Programs associative array</span></span>
<span id="cb1-68"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">declare</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span></span>
<span id="cb1-69"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb1-70"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>hisat2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${hisat2}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-71"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">prepDE</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${prepDE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-72"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">samtools_index</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samtools}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> index"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-73"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">samtools_merge</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samtools}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> merge"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-74"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">samtools_sort</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samtools}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> sort"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-75"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">samtools_view</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samtools}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> view"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-76"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">stringtie</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stringtie}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-77"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-78"></span>
<span id="cb1-79"></span>
<span id="cb1-80"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################################</span></span>
<span id="cb1-81"></span>
<span id="cb1-82"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Exit script if any command fails</span></span>
<span id="cb1-83"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span></span>
<span id="cb1-84"></span>
<span id="cb1-85"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load Python Mox module for Python module availability</span></span>
<span id="cb1-86"></span>
<span id="cb1-87"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load intel-python3_2017</span>
<span id="cb1-88"></span>
<span id="cb1-89"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Load associative array</span></span>
<span id="cb1-90"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Only need to use one set of reads to capture sample name</span></span>
<span id="cb1-91"></span>
<span id="cb1-92"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set sample counter for array verification</span></span>
<span id="cb1-93"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_counter</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb1-94"></span>
<span id="cb1-95"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load array</span></span>
<span id="cb1-96"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_R1.fastp-trim.20bp-5prime.20220224.fq.gz</span>
<span id="cb1-97"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span>
<span id="cb1-98">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Increment counter</span></span>
<span id="cb1-99">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">((</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_counter</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">))</span></span>
<span id="cb1-100"></span>
<span id="cb1-101">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove path</span></span>
<span id="cb1-102">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-103"></span>
<span id="cb1-104">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get sample name from first _-delimited field</span></span>
<span id="cb1-105">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print $1}'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-106">  </span>
<span id="cb1-107">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set treatment condition for each sample</span></span>
<span id="cb1-108">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S12M"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-109">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S22F"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-110">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S23M"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-111">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S29F"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-112">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S31M"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-113">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S35F"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-114">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S36F"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-115">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S3F"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-116">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S41F"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-117">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S48F"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-118">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S50F"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-119">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S59M"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-120">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S77F"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-121">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S9M"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span></span>
<span id="cb1-122">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-123">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">treatment</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"exposed"</span></span>
<span id="cb1-124">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span></span>
<span id="cb1-125">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">treatment</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"control"</span></span>
<span id="cb1-126">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb1-127"></span>
<span id="cb1-128">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Append to associative array</span></span>
<span id="cb1-129">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samples_associative_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${treatment}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-130"></span>
<span id="cb1-131"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span>
<span id="cb1-132"></span>
<span id="cb1-133"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check array size to confirm it has all expected samples</span></span>
<span id="cb1-134"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Exit if mismatch</span></span>
<span id="cb1-135"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samples_associative_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_counter}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-136"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samples_associative_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${total_samples}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span></span>
<span id="cb1-137">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-138">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samples_associative_array doesn't have all 26 samples."</span></span>
<span id="cb1-139">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-140">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samples_associative_array contents:"</span></span>
<span id="cb1-141">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-142">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> item <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samples_associative_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-143">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span>
<span id="cb1-144">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%s\t%s\n"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${item}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samples_associative_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${item}</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-145">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span>
<span id="cb1-146"></span>
<span id="cb1-147">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">exit</span></span>
<span id="cb1-148"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb1-149"></span>
<span id="cb1-150"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Copy Hisat2 genome index files</span></span>
<span id="cb1-151"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rsync</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-av</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_index_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_index_name}</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.ht2 .</span>
<span id="cb1-152"></span>
<span id="cb1-153"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> sample <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samples_associative_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-154"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span>
<span id="cb1-155"></span>
<span id="cb1-156">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Inititalize arrays</span></span>
<span id="cb1-157">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb1-158">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb1-159"></span>
<span id="cb1-160">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of fastq R1 files</span></span>
<span id="cb1-161">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># and generated MD5 checksums file.</span></span>
<span id="cb1-162">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_R1.fastp-trim.20bp-5prime.20220224.fq.gz</span>
<span id="cb1-163">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span>
<span id="cb1-164">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-165">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Generating checksum for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">..."</span></span>
<span id="cb1-166">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> input_fastqs_checksums.md5</span>
<span id="cb1-167">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Checksum for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> completed."</span></span>
<span id="cb1-168">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-169">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span>
<span id="cb1-170"></span>
<span id="cb1-171">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of fastq R2 files</span></span>
<span id="cb1-172">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_R2.fastp-trim.20bp-5prime.20220224.fq.gz</span>
<span id="cb1-173">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span>
<span id="cb1-174">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-175">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Generating checksum for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">..."</span></span>
<span id="cb1-176">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> input_fastqs_checksums.md5</span>
<span id="cb1-177">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Checksum for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> completed."</span></span>
<span id="cb1-178">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-179">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span>
<span id="cb1-180"></span>
<span id="cb1-181">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create comma-separated lists of FastQs for Hisat2</span></span>
<span id="cb1-182">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-v</span> joined_R1 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'%s,'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-183">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_list_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${joined_R1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-184"></span>
<span id="cb1-185">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-v</span> joined_R2 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'%s,'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-186">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_list_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${joined_R2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-187"></span>
<span id="cb1-188">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create and switch to dedicated sample directory</span></span>
<span id="cb1-189">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$_</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-190"></span>
<span id="cb1-191">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hisat2 alignments</span></span>
<span id="cb1-192">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sets read group info (RG) using samples array</span></span>
<span id="cb1-193">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>hisat2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-194">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-x</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_index_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-195">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_list_R1}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-196">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-2</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_list_R2}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-197">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-S</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.sam <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-198">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--rg-id</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-199">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--rg</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SM:""</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samples_associative_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-200">  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_hisat2.err</span>
<span id="cb1-201"></span>
<span id="cb1-202">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sort SAM files, convert to BAM, and index</span></span>
<span id="cb1-203">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>samtools_view<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-204">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-@</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-205">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Su</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.sam <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-206">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>samtools_sort<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-207">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-@</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-208">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.sorted.bam</span>
<span id="cb1-209">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Index BAM</span></span>
<span id="cb1-210">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>samtools_index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.sorted.bam</span>
<span id="cb1-211"></span>
<span id="cb1-212"></span>
<span id="cb1-213">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run stringtie on alignments</span></span>
<span id="cb1-214">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Uses "-B" option to output tables intended for use in Ballgown</span></span>
<span id="cb1-215">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Uses "-e" option; recommended when using "-B" option.</span></span>
<span id="cb1-216">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Limits analysis to only reads alignments matching reference.</span></span>
<span id="cb1-217">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>stringtie<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.sorted.bam <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-218">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-219">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-220">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-G</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_gff}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-221">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-C</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.cov_refs.gtf"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-222">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-B</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-223">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span></span>
<span id="cb1-224"></span>
<span id="cb1-225"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add GTFs to list file, only if non-empty</span></span>
<span id="cb1-226"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Identifies GTF files that only have header</span></span>
<span id="cb1-227">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gtf_lines</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.gtf <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-228">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${gtf_lines}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-gt</span> 2 <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-229">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.gtf"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> ../<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${gtf_list}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-230">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb1-231"></span>
<span id="cb1-232">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Delete unneeded SAM files</span></span>
<span id="cb1-233">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> ./<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.sam</span>
<span id="cb1-234"></span>
<span id="cb1-235">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate checksums</span></span>
<span id="cb1-236">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb1-237">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span>
<span id="cb1-238">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span>_checksums.md5</span>
<span id="cb1-239">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span>
<span id="cb1-240"></span>
<span id="cb1-241">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Move up to orig. working directory</span></span>
<span id="cb1-242">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ..</span>
<span id="cb1-243"></span>
<span id="cb1-244"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span>
<span id="cb1-245"></span>
<span id="cb1-246"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Merge all BAMs to singular BAM for use in transcriptome assembly later</span></span>
<span id="cb1-247"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Create list of sorted BAMs for merging</span></span>
<span id="cb1-248"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> . <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-name</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*sorted.bam"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> sorted_bams.list</span>
<span id="cb1-249"></span>
<span id="cb1-250"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Merge sorted BAMs</span></span>
<span id="cb1-251"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>samtools_merge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-252">-b sorted_bams.list <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-253"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${merged_bam}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-254">--threads <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span></span>
<span id="cb1-255"></span>
<span id="cb1-256"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Index merged BAM</span></span>
<span id="cb1-257"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>samtools_index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${merged_bam}</span></span>
<span id="cb1-258"></span>
<span id="cb1-259"></span>
<span id="cb1-260"></span>
<span id="cb1-261"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create singular transcript file, using GTF list file</span></span>
<span id="cb1-262"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>stringtie<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--merge</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-263"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${gtf_list}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-264">-p <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-265">-G <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_gff}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-266">-o <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_index_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.stringtie.gtf</span>
<span id="cb1-267"></span>
<span id="cb1-268"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create file list for prepDE.py</span></span>
<span id="cb1-269"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">while</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">read</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">line</span></span>
<span id="cb1-270"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span>
<span id="cb1-271">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line}</span></span>
<span id="cb1-272"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> gtf_list.txt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> prepDE-sample_list.txt</span>
<span id="cb1-273"></span>
<span id="cb1-274"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create count matrices for genes and transcripts</span></span>
<span id="cb1-275"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compatible with import to DESeq2</span></span>
<span id="cb1-276"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>prepDE<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--input</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>prepDE-sample_list.txt</span>
<span id="cb1-277"></span>
<span id="cb1-278"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Delete unneccessary index files</span></span>
<span id="cb1-279"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_index_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.ht2</span>
<span id="cb1-280"></span>
<span id="cb1-281"></span>
<span id="cb1-282"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate checksums</span></span>
<span id="cb1-283"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Uses find command to avoid passing</span></span>
<span id="cb1-284"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># directory names to the md5sum command.</span></span>
<span id="cb1-285"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> . <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-maxdepth</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-type</span> f <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-exec</span> md5sum {} + <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-286"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--append</span> checksums.md5</span>
<span id="cb1-287"></span>
<span id="cb1-288"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#######################################################################################################</span></span>
<span id="cb1-289"></span>
<span id="cb1-290"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Capture program options</span></span>
<span id="cb1-291"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-gt</span> 0 <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-292">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Logging program options..."</span></span>
<span id="cb1-293">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> program <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-294">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span>
<span id="cb1-295">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-296">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Program options for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">: "</span></span>
<span id="cb1-297">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-298">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle samtools help menus</span></span>
<span id="cb1-299">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_index"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-300">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_sort"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-301">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_view"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span></span>
<span id="cb1-302">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-303">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-304"></span>
<span id="cb1-305">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle DIAMOND BLAST menu</span></span>
<span id="cb1-306">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"diamond"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-307">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> help</span>
<span id="cb1-308"></span>
<span id="cb1-309">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle NCBI BLASTx menu</span></span>
<span id="cb1-310">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blastx"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-311">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-help</span></span>
<span id="cb1-312"></span>
<span id="cb1-313">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle StringTie prepDE script</span></span>
<span id="cb1-314">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"prepDE"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-315">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-h</span></span>
<span id="cb1-316">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb1-317">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-h</span></span>
<span id="cb1-318">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-319">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-320">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"----------------------------------------------"</span></span>
<span id="cb1-321">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-322">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-323">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&gt;&gt;</span> program_options.log <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb1-324"></span>
<span id="cb1-325">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If MultiQC is in programs_array, copy the config file to this directory.</span></span>
<span id="cb1-326">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"multiqc"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-327">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cp</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--preserve</span> ~/.multiqc_config.yaml multiqc_config.yaml</span>
<span id="cb1-328">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb1-329">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span>
<span id="cb1-330">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Finished logging programs options."</span></span>
<span id="cb1-331">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-332"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb1-333"></span>
<span id="cb1-334"></span>
<span id="cb1-335"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Document programs in PATH (primarily for program version ID)</span></span>
<span id="cb1-336"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Logging system </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$PATH</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">..."</span></span>
<span id="cb1-337"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-338"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">date</span></span>
<span id="cb1-339"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-340"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"System PATH for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$SLURM_JOB_ID</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-341"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-342"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%0.s-"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">..</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-343"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${PATH}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tr</span> : <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\\</span>n</span>
<span id="cb1-344"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> system_path.log</span>
<span id="cb1-345"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Finished logging system </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$PATH</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">."</span></span></code></pre></div>
<hr>
<section id="results" class="level1">
<h1>RESULTS</h1>
<p>Took about 2.5 days to run.</p>
<p>Output folder:</p>
<ul>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230821-cvir-stringtie-GCF_002022765.2-isoforms/">20230821-cvir-stringtie-GCF_002022765.2-isoforms/</a></p>
<ul>
<li><p>List of input FastQs and checksums (text):</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/20230821-cvir-stringtie-GCF_002022765.2-isoforms/input_fastqs_checksums.md5">20230821-cvir-stringtie-GCF_002022765.2-isoforms/input_fastqs_checksums.md5</a></li>
</ul></li>
<li><p>Full GTF file (GTF; 143MB):</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/20230821-cvir-stringtie-GCF_002022765.2-isoforms/cvir_GCF_002022765.2.stringtie.gtf">20230821-cvir-stringtie-GCF_002022765.2-isoforms/cvir_GCF_002022765.2.stringtie.gtf</a></li>
</ul></li>
<li><p>Merged BAM file (79GB):</p>
<ul>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230821-cvir-stringtie-GCF_002022765.2-isoforms/20230821_cvir_stringtie_GCF_002022765-sorted-bams-merged.bam">20230821-cvir-stringtie-GCF_002022765.2-isoforms/20230821_cvir_stringtie_GCF_002022765-sorted-bams-merged.bam</a></p>
<ul>
<li><p>MD5 checksum:</p>
<ul>
<li><code>466815fe9fa3f559b500ea8aff2de5b1</code></li>
</ul></li>
</ul></li>
<li><p>Merged BAM index file (useful for IGV):</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/20230821-cvir-stringtie-GCF_002022765.2-isoforms/20230821_cvir_stringtie_GCF_002022765-sorted-bams-merged.bam.bai">20230821-cvir-stringtie-GCF_002022765.2-isoforms/20230821_cvir_stringtie_GCF_002022765-sorted-bams-merged.bam.bai</a></li>
</ul></li>
</ul></li>
<li><p>Gene counts matrix (CSV; 4.5MB)</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/20230821-cvir-stringtie-GCF_002022765.2-isoforms/gene_count_matrix.csv">gene_count_matrix.csv</a></li>
</ul></li>
<li><p>Transcript counts matrix (CSV; 6.3MB)</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/20230821-cvir-stringtie-GCF_002022765.2-isoforms/transcript_count_matrix.csv">transcript_count_matrix.csv</a></li>
</ul></li>
</ul></li>
</ul>
<p>Since there are a large number of folders/files, the resulting directory structure for all of the <a href="https://ccb.jhu.edu/software/stringtie/"><code>StringTie</code></a> output is shown at the end of this post. Here’s a description of all the file types found in each directory:</p>
<ul>
<li><p><code>*.ctab</code>: See <a href="https://github.com/alyssafrazee/ballgown"><code>ballgown</code> documentation</a> for description of these.</p></li>
<li><p><code>*.checksums.md5</code>: MD5 checksums for all files in each directory.</p></li>
<li><p><code>*.cov_refs.gtf</code>: Coverage GTF generate by <a href="https://ccb.jhu.edu/software/stringtie/"><code>StringTie</code></a> and used to generate final GTF for each sample.</p></li>
<li><p><code>*.gtf</code>: Final GTF file produced by <a href="https://ccb.jhu.edu/software/stringtie/"><code>StringTie</code></a> for each sample.</p></li>
<li><p><code>*_hisat2.err</code>: Standard error output from <a href="https://daehwankimlab.github.io/hisat2/"><code>HISAT2</code></a>. Contains alignment info.</p></li>
<li><p><code>*.sorted.bam</code>: Sorted BAM alignments file produced by <a href="https://daehwankimlab.github.io/hisat2/"><code>HISAT2</code></a>.</p></li>
<li><p><code>*.sorted.bam.bai</code>: BAM index file.</p></li>
</ul>
<p>The <a href="https://robertslab.github.io/sams-notebook/posts/2021/2021-07-26-Transcript-Identification-and-Quantification---C.virginia-RNAseq-With-NCBI-Genome-GCF_002022765.2-Using-StringTie-on-Mox/">initial alignments from 20210726</a> which accidentally used untrimmed sequencing reads had some truly abysmal alignment rates (males were ~30% and females were around 45%). This round is a <em>marked</em> improvement. The females exhibit alignment rates around what one would expect (&gt; 80%), while the males, even though relatively low (around 57%), it is drasticalliy better than the 30% seen when using the untrimmed reads. Still, the alignment rates are consistently low/lower in males, compared to the females. Not sure of what this means, but exploring some additional avenues to investigate (e.g.&nbsp;possible residual rRNA, possible contamination with other organismal RNA)</p>
<p>Here’s a table. The letter <code>M</code> or <code>F</code> in the sample name column indicates sex.</p>
<table class="table">
<thead>
<tr class="header">
<th>Sample</th>
<th>Alignment Rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>S12M</td>
<td>58.09%</td>
</tr>
<tr class="even">
<td>S13M</td>
<td>58.44%</td>
</tr>
<tr class="odd">
<td>S16F</td>
<td>81.08%</td>
</tr>
<tr class="even">
<td>S19F</td>
<td>82.05%</td>
</tr>
<tr class="odd">
<td>S22F</td>
<td>82.16%</td>
</tr>
<tr class="even">
<td>S23M</td>
<td>57.06%</td>
</tr>
<tr class="odd">
<td>S29F</td>
<td>75.92%</td>
</tr>
<tr class="even">
<td>S31M</td>
<td>61.12%</td>
</tr>
<tr class="odd">
<td>S35F</td>
<td>81.95%</td>
</tr>
<tr class="even">
<td>S36F</td>
<td>80.60%</td>
</tr>
<tr class="odd">
<td>S39F</td>
<td>82.52%</td>
</tr>
<tr class="even">
<td>S3F</td>
<td>82.31%</td>
</tr>
<tr class="odd">
<td>S41F</td>
<td>78.38%</td>
</tr>
<tr class="even">
<td>S44F</td>
<td>78.70%</td>
</tr>
<tr class="odd">
<td>S48M</td>
<td>57.60%</td>
</tr>
<tr class="even">
<td>S50F</td>
<td>82.96%</td>
</tr>
<tr class="odd">
<td>S52F</td>
<td>73.20%</td>
</tr>
<tr class="even">
<td>S53F</td>
<td>81.48%</td>
</tr>
<tr class="odd">
<td>S54F</td>
<td>77.75%</td>
</tr>
<tr class="even">
<td>S59M</td>
<td>65.81%</td>
</tr>
<tr class="odd">
<td>S64M</td>
<td>71.53%</td>
</tr>
<tr class="even">
<td>S6M</td>
<td>57.82%</td>
</tr>
<tr class="odd">
<td>S76F</td>
<td>82.82%</td>
</tr>
<tr class="even">
<td>S77F</td>
<td>84.37%</td>
</tr>
<tr class="odd">
<td>S7M</td>
<td>58.74%</td>
</tr>
<tr class="even">
<td>S9M</td>
<td>57.95%</td>
</tr>
</tbody>
</table>
<p>As hoped/expected, these alignment rates are identical to <a href="https://robertslab.github.io/sams-notebook/posts/2022/2022-02-25-Transcript-Identification-and-Alignments---C.virginica-RNAseq-with-NCBI-Genome-GCF_002022765.2-Using-Hisat2-and-Stringtie-on-Mox/">the previous run using an old version of Stringtie from 20220225</a> (notebook).</p>
<p>Now, need to send this data back through Ballgown…</p>
<hr>
<section id="directory-tree" class="level3">
<h3 class="anchored" data-anchor-id="directory-tree">Directory tree</h3>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> 20230821-cvir-stringtie-GCF_002022765.2-isoforms.sh</span>
<span id="cb2-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> 20230821_cvir_stringtie_GCF_002022765-sorted-bams-merged.bam</span>
<span id="cb2-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> 20230821_cvir_stringtie_GCF_002022765-sorted-bams-merged.bam.bai</span>
<span id="cb2-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> checksums.md5</span>
<span id="cb2-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> cvir_GCF_002022765.2.stringtie.gtf</span>
<span id="cb2-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> gene_count_matrix.csv</span>
<span id="cb2-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> gtf_list.txt</span>
<span id="cb2-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> input_fastqs_checksums.md5</span>
<span id="cb2-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> prepDE-sample_list.txt</span>
<span id="cb2-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> program_options.log</span>
<span id="cb2-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S12M</span>
<span id="cb2-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S12M_checksums.md5</span>
<span id="cb2-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S12M.cov_refs.gtf</span>
<span id="cb2-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S12M.gtf</span>
<span id="cb2-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S12M_hisat2.err</span>
<span id="cb2-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S12M.sorted.bam</span>
<span id="cb2-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S12M.sorted.bam.bai</span>
<span id="cb2-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S13M</span>
<span id="cb2-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-26"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-28"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S13M_checksums.md5</span>
<span id="cb2-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S13M.cov_refs.gtf</span>
<span id="cb2-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S13M.gtf</span>
<span id="cb2-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S13M_hisat2.err</span>
<span id="cb2-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S13M.sorted.bam</span>
<span id="cb2-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S13M.sorted.bam.bai</span>
<span id="cb2-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S16F</span>
<span id="cb2-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-37"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-40"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S16F_checksums.md5</span>
<span id="cb2-41"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S16F.cov_refs.gtf</span>
<span id="cb2-42"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S16F.gtf</span>
<span id="cb2-43"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S16F_hisat2.err</span>
<span id="cb2-44"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S16F.sorted.bam</span>
<span id="cb2-45"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S16F.sorted.bam.bai</span>
<span id="cb2-46"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-47"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S19F</span>
<span id="cb2-48"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-49"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-50"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-51"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-52"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S19F_checksums.md5</span>
<span id="cb2-53"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S19F.cov_refs.gtf</span>
<span id="cb2-54"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S19F.gtf</span>
<span id="cb2-55"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S19F_hisat2.err</span>
<span id="cb2-56"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S19F.sorted.bam</span>
<span id="cb2-57"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S19F.sorted.bam.bai</span>
<span id="cb2-58"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-59"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S22F</span>
<span id="cb2-60"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-61"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-62"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-63"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-64"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S22F_checksums.md5</span>
<span id="cb2-65"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S22F.cov_refs.gtf</span>
<span id="cb2-66"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S22F.gtf</span>
<span id="cb2-67"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S22F_hisat2.err</span>
<span id="cb2-68"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S22F.sorted.bam</span>
<span id="cb2-69"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S22F.sorted.bam.bai</span>
<span id="cb2-70"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-71"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S23M</span>
<span id="cb2-72"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-73"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-74"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-75"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-76"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S23M_checksums.md5</span>
<span id="cb2-77"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S23M.cov_refs.gtf</span>
<span id="cb2-78"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S23M.gtf</span>
<span id="cb2-79"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S23M_hisat2.err</span>
<span id="cb2-80"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S23M.sorted.bam</span>
<span id="cb2-81"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S23M.sorted.bam.bai</span>
<span id="cb2-82"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-83"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S29F</span>
<span id="cb2-84"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-85"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-86"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-87"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-88"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S29F_checksums.md5</span>
<span id="cb2-89"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S29F.cov_refs.gtf</span>
<span id="cb2-90"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S29F.gtf</span>
<span id="cb2-91"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S29F_hisat2.err</span>
<span id="cb2-92"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S29F.sorted.bam</span>
<span id="cb2-93"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S29F.sorted.bam.bai</span>
<span id="cb2-94"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-95"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S31M</span>
<span id="cb2-96"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-97"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-98"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-99"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-100"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S31M_checksums.md5</span>
<span id="cb2-101"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S31M.cov_refs.gtf</span>
<span id="cb2-102"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S31M.gtf</span>
<span id="cb2-103"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S31M_hisat2.err</span>
<span id="cb2-104"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S31M.sorted.bam</span>
<span id="cb2-105"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S31M.sorted.bam.bai</span>
<span id="cb2-106"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-107"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S35F</span>
<span id="cb2-108"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-109"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-110"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-111"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-112"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S35F_checksums.md5</span>
<span id="cb2-113"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S35F.cov_refs.gtf</span>
<span id="cb2-114"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S35F.gtf</span>
<span id="cb2-115"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S35F_hisat2.err</span>
<span id="cb2-116"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S35F.sorted.bam</span>
<span id="cb2-117"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S35F.sorted.bam.bai</span>
<span id="cb2-118"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-119"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S36F</span>
<span id="cb2-120"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-121"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-122"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-123"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-124"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S36F_checksums.md5</span>
<span id="cb2-125"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S36F.cov_refs.gtf</span>
<span id="cb2-126"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S36F.gtf</span>
<span id="cb2-127"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S36F_hisat2.err</span>
<span id="cb2-128"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S36F.sorted.bam</span>
<span id="cb2-129"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S36F.sorted.bam.bai</span>
<span id="cb2-130"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-131"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S39F</span>
<span id="cb2-132"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-133"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-134"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-135"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-136"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S39F_checksums.md5</span>
<span id="cb2-137"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S39F.cov_refs.gtf</span>
<span id="cb2-138"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S39F.gtf</span>
<span id="cb2-139"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S39F_hisat2.err</span>
<span id="cb2-140"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S39F.sorted.bam</span>
<span id="cb2-141"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S39F.sorted.bam.bai</span>
<span id="cb2-142"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-143"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S3F</span>
<span id="cb2-144"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-145"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-146"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-147"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-148"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S3F_checksums.md5</span>
<span id="cb2-149"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S3F.cov_refs.gtf</span>
<span id="cb2-150"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S3F.gtf</span>
<span id="cb2-151"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S3F_hisat2.err</span>
<span id="cb2-152"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S3F.sorted.bam</span>
<span id="cb2-153"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S3F.sorted.bam.bai</span>
<span id="cb2-154"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-155"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S41F</span>
<span id="cb2-156"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-157"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-158"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-159"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-160"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S41F_checksums.md5</span>
<span id="cb2-161"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S41F.cov_refs.gtf</span>
<span id="cb2-162"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S41F.gtf</span>
<span id="cb2-163"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S41F_hisat2.err</span>
<span id="cb2-164"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S41F.sorted.bam</span>
<span id="cb2-165"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S41F.sorted.bam.bai</span>
<span id="cb2-166"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-167"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S44F</span>
<span id="cb2-168"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-169"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-170"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-171"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-172"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S44F_checksums.md5</span>
<span id="cb2-173"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S44F.cov_refs.gtf</span>
<span id="cb2-174"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S44F.gtf</span>
<span id="cb2-175"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S44F_hisat2.err</span>
<span id="cb2-176"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S44F.sorted.bam</span>
<span id="cb2-177"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S44F.sorted.bam.bai</span>
<span id="cb2-178"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-179"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S48M</span>
<span id="cb2-180"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-181"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-182"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-183"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-184"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S48M_checksums.md5</span>
<span id="cb2-185"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S48M.cov_refs.gtf</span>
<span id="cb2-186"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S48M.gtf</span>
<span id="cb2-187"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S48M_hisat2.err</span>
<span id="cb2-188"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S48M.sorted.bam</span>
<span id="cb2-189"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S48M.sorted.bam.bai</span>
<span id="cb2-190"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-191"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S50F</span>
<span id="cb2-192"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-193"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-194"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-195"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-196"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S50F_checksums.md5</span>
<span id="cb2-197"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S50F.cov_refs.gtf</span>
<span id="cb2-198"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S50F.gtf</span>
<span id="cb2-199"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S50F_hisat2.err</span>
<span id="cb2-200"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S50F.sorted.bam</span>
<span id="cb2-201"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S50F.sorted.bam.bai</span>
<span id="cb2-202"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-203"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S52F</span>
<span id="cb2-204"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-205"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-206"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-207"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-208"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S52F_checksums.md5</span>
<span id="cb2-209"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S52F.cov_refs.gtf</span>
<span id="cb2-210"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S52F.gtf</span>
<span id="cb2-211"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S52F_hisat2.err</span>
<span id="cb2-212"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S52F.sorted.bam</span>
<span id="cb2-213"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S52F.sorted.bam.bai</span>
<span id="cb2-214"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-215"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S53F</span>
<span id="cb2-216"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-217"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-218"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-219"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-220"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S53F_checksums.md5</span>
<span id="cb2-221"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S53F.cov_refs.gtf</span>
<span id="cb2-222"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S53F.gtf</span>
<span id="cb2-223"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S53F_hisat2.err</span>
<span id="cb2-224"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S53F.sorted.bam</span>
<span id="cb2-225"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S53F.sorted.bam.bai</span>
<span id="cb2-226"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-227"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S54F</span>
<span id="cb2-228"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-229"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-230"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-231"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-232"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S54F_checksums.md5</span>
<span id="cb2-233"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S54F.cov_refs.gtf</span>
<span id="cb2-234"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S54F.gtf</span>
<span id="cb2-235"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S54F_hisat2.err</span>
<span id="cb2-236"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S54F.sorted.bam</span>
<span id="cb2-237"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S54F.sorted.bam.bai</span>
<span id="cb2-238"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-239"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S59M</span>
<span id="cb2-240"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-241"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-242"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-243"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-244"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S59M_checksums.md5</span>
<span id="cb2-245"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S59M.cov_refs.gtf</span>
<span id="cb2-246"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S59M.gtf</span>
<span id="cb2-247"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S59M_hisat2.err</span>
<span id="cb2-248"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S59M.sorted.bam</span>
<span id="cb2-249"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S59M.sorted.bam.bai</span>
<span id="cb2-250"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-251"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S64M</span>
<span id="cb2-252"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-253"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-254"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-255"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-256"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S64M_checksums.md5</span>
<span id="cb2-257"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S64M.cov_refs.gtf</span>
<span id="cb2-258"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S64M.gtf</span>
<span id="cb2-259"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S64M_hisat2.err</span>
<span id="cb2-260"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S64M.sorted.bam</span>
<span id="cb2-261"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S64M.sorted.bam.bai</span>
<span id="cb2-262"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-263"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S6M</span>
<span id="cb2-264"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-265"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-266"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-267"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-268"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S6M_checksums.md5</span>
<span id="cb2-269"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S6M.cov_refs.gtf</span>
<span id="cb2-270"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S6M.gtf</span>
<span id="cb2-271"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S6M_hisat2.err</span>
<span id="cb2-272"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S6M.sorted.bam</span>
<span id="cb2-273"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S6M.sorted.bam.bai</span>
<span id="cb2-274"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-275"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S76F</span>
<span id="cb2-276"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-277"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-278"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-279"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-280"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S76F_checksums.md5</span>
<span id="cb2-281"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S76F.cov_refs.gtf</span>
<span id="cb2-282"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S76F.gtf</span>
<span id="cb2-283"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S76F_hisat2.err</span>
<span id="cb2-284"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S76F.sorted.bam</span>
<span id="cb2-285"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S76F.sorted.bam.bai</span>
<span id="cb2-286"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-287"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S77F</span>
<span id="cb2-288"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-289"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-290"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-291"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-292"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S77F_checksums.md5</span>
<span id="cb2-293"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S77F.cov_refs.gtf</span>
<span id="cb2-294"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S77F.gtf</span>
<span id="cb2-295"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S77F_hisat2.err</span>
<span id="cb2-296"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S77F.sorted.bam</span>
<span id="cb2-297"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S77F.sorted.bam.bai</span>
<span id="cb2-298"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-299"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S7M</span>
<span id="cb2-300"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-301"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-302"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-303"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-304"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S7M_checksums.md5</span>
<span id="cb2-305"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S7M.cov_refs.gtf</span>
<span id="cb2-306"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S7M.gtf</span>
<span id="cb2-307"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S7M_hisat2.err</span>
<span id="cb2-308"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S7M.sorted.bam</span>
<span id="cb2-309"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S7M.sorted.bam.bai</span>
<span id="cb2-310"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-311"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> S9M</span>
<span id="cb2-312"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e2t.ctab</span>
<span id="cb2-313"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── e_data.ctab</span>
<span id="cb2-314"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i2t.ctab</span>
<span id="cb2-315"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── i_data.ctab</span>
<span id="cb2-316"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S9M_checksums.md5</span>
<span id="cb2-317"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S9M.cov_refs.gtf</span>
<span id="cb2-318"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S9M.gtf</span>
<span id="cb2-319"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S9M_hisat2.err</span>
<span id="cb2-320"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S9M.sorted.bam</span>
<span id="cb2-321"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> ├── S9M.sorted.bam.bai</span>
<span id="cb2-322"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│&nbsp;&nbsp;</span> └── t_data.ctab</span>
<span id="cb2-323"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> slurm-4778731.out</span>
<span id="cb2-324"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> slurm-4800642.out</span>
<span id="cb2-325"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> slurm-4800644.out</span>
<span id="cb2-326"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> sorted_bams.list</span>
<span id="cb2-327"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> system_path.log</span>
<span id="cb2-328"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">└──</span> transcript_count_matrix.csv</span>
<span id="cb2-329"></span>
<span id="cb2-330"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">27</span> directories, 302 files</span></code></pre></div>


</section>
</section>

 ]]></description>
  <category>2023</category>
  <category>Miscellaneous</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-08-21-Transcript-Identification-and-Alignments---C.virginica-RNAseq-with-NCBI-Genome-GCF_002022765.2-Using-Hisat2-and-Stringtie-on-Mox-Again/index.html</guid>
  <pubDate>Mon, 21 Aug 2023 21:41:00 GMT</pubDate>
</item>
<item>
  <title>qPCR - C.gigas PolyIC Diploid MgCl2</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-08-17-qPCR---C.gigas-PolyIC-Diploid-MgCl2/index.html</link>
  <description><![CDATA[ 




<p>Using <a href="https://robertslab.github.io/sams-notebook/posts/2023/2023-08-16-Reverse-Transcription---C.gigas-PolyIC-Diploid-MgCl2/">diploid MgCl<sub>2</sub> control cDNA from 20230816</a>, performed qPCR on the following <a href="https://github.com/RobertsLab/resources/issues/1686">primer sets selected by Steven</a> (GitHub Issue), along with <code>Cg_Actin</code> as a potential normalizing gene:</p>
<table class="table">
<thead>
<tr class="header">
<th>SRID</th>
<th>Primer</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1170/1</td>
<td>Cg_Actin</td>
</tr>
<tr class="even">
<td>1830/1</td>
<td>Cg_DICER</td>
</tr>
<tr class="odd">
<td>1172/3</td>
<td>Cg_GAPDH</td>
</tr>
<tr class="even">
<td>1832/3</td>
<td>Cg_IRF2</td>
</tr>
<tr class="odd">
<td>1834/5</td>
<td>Cg_SACSIN</td>
</tr>
<tr class="even">
<td>1828/9</td>
<td>Cg_VIPERIN</td>
</tr>
<tr class="odd">
<td>1826/7</td>
<td>Cg_cGAS</td>
</tr>
<tr class="even">
<td>1383/4</td>
<td>Cg_citrate_synthase</td>
</tr>
</tbody>
</table>
<p>qPCR calcs:</p>
<ul>
<li><a href="https://docs.google.com/spreadsheets/d/1z5UOomTMgyO6ZKArKC1tP6kAum7OXgc2JT2YwXZF56M/edit?usp=sharing">20230817 - qPCR Calcs polyIC gigas cDNA</a> (Google Sheet)</li>
</ul>
<p>Reactions were run on white, low-profile, 96-well qPCR plates (USA Scientific). A total of two plates were run. One was run on a CFC Connect (BioRad) and the other on a CFX96 (BioRad). See the qPCR Report in the RESULTS section below for cycling params, plate layouts, etc.</p>
<p>Due to time and sample constraints, samples were just run in <em>singular</em>. No template controls were run in duplicate.</p>
<hr>
<section id="results" class="level1">
<h1>RESULTS</h1>
<p>Brief note(s) on results:</p>
<ul>
<li><p>Sample D14 comes up later than the other three samples in all of the primer sets.</p></li>
<li><p>Have not compared to <a href="https://robertslab.github.io/sams-notebook/posts/2023/2023-07-26-qPCR---C.gigas-polyIC/">the diploid poly:IC-inject qPCRs results</a> (Notebook) yet.</p></li>
</ul>
<p>qPCR Results file (CSV)</p>
<ul>
<li><a href="sam_2023-08-17_11-58-46_Connect-Quantification-Cq-Results.csv">sam_2023-07-26_13-06-28_Connect-Quantification%20-Cq-Results.csv</a></li>
</ul>
<p>qPCR Data file (QPCRD - CFX Maestro required)</p>
<ul>
<li><a href="https://owl.fish.washington.edu/scaphapoda/qPCR_data/cfx_connect_data/sam_2023-08-17_11-58-46_Connect.pcrd">sam_2023-07-26_13-06-28_Connect.pcrd</a></li>
</ul>
<p>qPCR Report (PDF)</p>
<ul>
<li><a href="https://owl.fish.washington.edu/Athaliana/qPCR_data/qPCR_reports/sam_2023-08-17_11-58-46_Connect.pdf">sam_2023-07-26_13-06-28_Connect.pdf</a></li>
</ul>
<hr>
<section id="plots" class="level4">
<h4 class="anchored" data-anchor-id="plots">PLOTS</h4>
<table class="table">
<colgroup>
<col style="width: 2%">
<col style="width: 5%">
<col style="width: 45%">
<col style="width: 46%">
</colgroup>
<thead>
<tr class="header">
<th>SR ID</th>
<th>Primer</th>
<th>Amplification Plot</th>
<th>Melt Curve</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1830/1</td>
<td>Cg_DICER</td>
<td><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-08-17-qPCR---C.gigas-PolyIC-Diploid-MgCl2/https:/owl.fish.washington.edu/Athaliana/qPCR_data/sam_2023-08-17_11-58-46_Connect-Cg_DICER-amp-plots.png" class="img-fluid" alt="Cg_DICER amplification plot"></td>
<td><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-08-17-qPCR---C.gigas-PolyIC-Diploid-MgCl2/https:/owl.fish.washington.edu/Athaliana/qPCR_data/sam_2023-08-17_11-58-46_Connect-Cg_DICER-melt-plots.png" class="img-fluid" alt="Cg_DICER melt plot"></td>
</tr>
<tr class="even">
<td>1172/3</td>
<td>Cg_GAPDH</td>
<td><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-08-17-qPCR---C.gigas-PolyIC-Diploid-MgCl2/https:/owl.fish.washington.edu/Athaliana/qPCR_data/sam_2023-08-17_11-58-46_Connect-Cg_GAPDH-amp-plots.png" class="img-fluid" alt="Cg_GAPDH amplification plot"></td>
<td><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-08-17-qPCR---C.gigas-PolyIC-Diploid-MgCl2/https:/owl.fish.washington.edu/Athaliana/qPCR_data/sam_2023-08-17_11-58-46_Connect-Cg_GAPDH-melt-plots.png" class="img-fluid" alt="Cg_GAPDH melt plot"></td>
</tr>
<tr class="odd">
<td>1832/3</td>
<td>Cg_IRF2</td>
<td><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-08-17-qPCR---C.gigas-PolyIC-Diploid-MgCl2/https:/owl.fish.washington.edu/Athaliana/qPCR_data/sam_2023-08-17_11-58-46_Connect-Cg_IRF2-amp-plots.png" class="img-fluid" alt="Cg_IRF2 amplification plot"></td>
<td><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-08-17-qPCR---C.gigas-PolyIC-Diploid-MgCl2/https:/owl.fish.washington.edu/Athaliana/qPCR_data/sam_2023-08-17_11-58-46_Connect-Cg_IRF2-melt-plots.png" class="img-fluid" alt="Cg_IRF2 melt plot"></td>
</tr>
<tr class="even">
<td>1834/5</td>
<td>Cg_SACSIN</td>
<td><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-08-17-qPCR---C.gigas-PolyIC-Diploid-MgCl2/https:/owl.fish.washington.edu/Athaliana/qPCR_data/sam_2023-08-17_11-58-46_Connect-Cg_SACSIN-amp-plots.png" class="img-fluid" alt="Cg_SACSIN amplification plot"></td>
<td><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-08-17-qPCR---C.gigas-PolyIC-Diploid-MgCl2/https:/owl.fish.washington.edu/Athaliana/qPCR_data/sam_2023-08-17_11-58-46_Connect-Cg_SACSIN-melt-plots.png" class="img-fluid" alt="Cg_SACSIN melt plot"></td>
</tr>
<tr class="odd">
<td>1828/9</td>
<td>Cg_VIPERIN</td>
<td><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-08-17-qPCR---C.gigas-PolyIC-Diploid-MgCl2/https:/owl.fish.washington.edu/Athaliana/qPCR_data/sam_2023-08-17_11-58-46_Connect-Cg_VIPERIN-amp-plots.png" class="img-fluid" alt="Cg_VIPERIN amplification plot"></td>
<td><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-08-17-qPCR---C.gigas-PolyIC-Diploid-MgCl2/https:/owl.fish.washington.edu/Athaliana/qPCR_data/sam_2023-08-17_11-58-46_Connect-Cg_VIPERIN-melt-plots.png" class="img-fluid" alt="Cg_VIPERIN melt plot"></td>
</tr>
<tr class="even">
<td>1170/1</td>
<td>Cg_actin</td>
<td><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-08-17-qPCR---C.gigas-PolyIC-Diploid-MgCl2/https:/owl.fish.washington.edu/Athaliana/qPCR_data/sam_2023-08-17_11-58-46_Connect-Cg_actin-amp-plots.png" class="img-fluid" alt="Cg_actin amplification plot"></td>
<td><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-08-17-qPCR---C.gigas-PolyIC-Diploid-MgCl2/https:/owl.fish.washington.edu/Athaliana/qPCR_data/sam_2023-08-17_11-58-46_Connect-Cg_actin-melt-plots.png" class="img-fluid" alt="Cg_actin amplification plot"></td>
</tr>
<tr class="odd">
<td>1826/7</td>
<td>Cg_cGAS</td>
<td><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-08-17-qPCR---C.gigas-PolyIC-Diploid-MgCl2/https:/owl.fish.washington.edu/Athaliana/qPCR_data/sam_2023-08-17_11-58-46_Connect-Cg_cGAS-amp-plots.png" class="img-fluid" alt="Cg_cGAS amplification plot"></td>
<td><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-08-17-qPCR---C.gigas-PolyIC-Diploid-MgCl2/https:/owl.fish.washington.edu/Athaliana/qPCR_data/sam_2023-08-17_11-58-46_Connect-Cg_cGAS-melt-plots.png" class="img-fluid" alt="Cg_cGAS amplification plot"></td>
</tr>
<tr class="even">
<td>1383/4</td>
<td>Cg_citrate_synthase</td>
<td><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-08-17-qPCR---C.gigas-PolyIC-Diploid-MgCl2/https:/owl.fish.washington.edu/Athaliana/qPCR_data/sam_2023-08-17_11-58-46_Connect-Cg_citrate_synthase-amp-plots.png" class="img-fluid" alt="Cg_citrate_synthase amplification plot"></td>
<td><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-08-17-qPCR---C.gigas-PolyIC-Diploid-MgCl2/https:/owl.fish.washington.edu/Athaliana/qPCR_data/sam_2023-08-17_11-58-46_Connect-Cg_citrate_synthase-melt-plots.png" class="img-fluid" alt="Cg_citrate_synthase amplification plot"></td>
</tr>
</tbody>
</table>


</section>
</section>

 ]]></description>
  <category>2023</category>
  <category>Miscellaneous</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-08-17-qPCR---C.gigas-PolyIC-Diploid-MgCl2/index.html</guid>
  <pubDate>Thu, 17 Aug 2023 13:38:00 GMT</pubDate>
</item>
<item>
  <title>Reverse Transcription - C.gigas PolyIC Diploid MgCl2</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-08-16-Reverse-Transcription---C.gigas-PolyIC-Diploid-MgCl2/index.html</link>
  <description><![CDATA[ 




<p>After <a href="https://robertslab.github.io/sams-notebook/posts/2023/2023-08-16-RNA-Quantification---C.gigas-PolyIC-Diploid-MgCl2/">quantifying diploid MgCl<sub>2</sub></a> (Notebook) earlier today and proceeded to make cDNA. Reverse transcription was performed using oligo dT primers using M-MLV RT (Promega), per the manufacturer’s recommendations. Used 400ng of RNA in each reaction. I used 400ng (instead of the usual 100ng) to simplify pipetting for high concentration samples, without the need/time to dilute samples. All reactions were done on ice in 0.5uL PCR tubes.</p>
<p>cDNA was stored in the same -80<sup>o</sup>C box as the original RNA.</p>
<ul>
<li><a href="https://docs.google.com/spreadsheets/d/15PVvlGGn4xLsmH6uERtCHugk4R9EDMVyMk_VHR109LM/edit?usp=sharing">202300816-cgig-polyIC-cDNA-calcs</a> (Google Sheet)</li>
</ul>



 ]]></description>
  <category>2023</category>
  <category>Miscellaneous</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-08-16-Reverse-Transcription---C.gigas-PolyIC-Diploid-MgCl2/index.html</guid>
  <pubDate>Wed, 16 Aug 2023 13:37:00 GMT</pubDate>
</item>
<item>
  <title>RNA Quantification - C.gigas PolyIC Diploid MgCl2</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-08-16-RNA-Quantification---C.gigas-PolyIC-Diploid-MgCl2/index.html</link>
  <description><![CDATA[ 




<p>Steven <a href="https://github.com/RobertsLab/resources/issues/1675">asked me to generate cDNA</a> (GitHub Issue) from <a href="http://en.wikipedia.org/wiki/Pacific_oyster"><em>Crassostrea gigas</em> (Pacific oyster)</a> RNA, as part of Matt George’s polyIC project. I had <a href="https://robertslab.github.io/sams-notebook/posts/2023/2023-07-21-RNA-Quantification-C.gigas-PolyIC/">previously quantified RNA from five diploid and five triploid samples</a> (Notebook), but the <a href="https://robertslab.github.io/sams-notebook/2023/07/26/qPCR-C.gigas-polyIC/">qPCR results</a> (Notebook) didn’t reveal much. Plus, the diploids and triploids weren’t the same treatment types (i.e.&nbsp;the diploids were poly:IC-injected, whereas the triploids were controls - so they weren’t really comparable). So, Steven asked that I find comparable set of samples so that we’d have either diploid controls or triploids which were poly:IC-injected. Looking in <a href="https://docs.google.com/spreadsheets/d/1VKN9vogT6q5IpOo-PoB9WNeFUT3k_BCQ8_P7_DY81oM/edit#gid=0">the freezer box for samples</a> (Google sheet), I found four diploid MgCl<sub>2</sub> control RNA samples. Before starting reverse transcription, I felt it would be best to quantify the RNA using the Qubit 3.0 using the Broad Range Assay. Steven and I discussed which samples to use earlier this week.</p>
<p>Used 1uL of each sample.</p>
<p>See Results section below for sample/tube labels.</p>
<hr>
<section id="results" class="level1">
<h1>RESULTS</h1>
<ul>
<li><a href="https://docs.google.com/spreadsheets/d/1AoHltNOTup5GoOJ2ef8mE5u_Q9ARAfetgTJ5d7M05Og/edit?usp=sharing">20230816-qubit-cgig-polyIC-RNA</a> (Google Sheet)</li>
</ul>
<p>All samples had ample amount of RNA. Will proceed with reverse transcription.</p>


</section>

 ]]></description>
  <category>2023</category>
  <category>Miscellaneous</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-08-16-RNA-Quantification---C.gigas-PolyIC-Diploid-MgCl2/index.html</guid>
  <pubDate>Wed, 16 Aug 2023 13:35:00 GMT</pubDate>
</item>
<item>
  <title>Daily Bits - August 2023</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-08-01-Daily-Bits---August-2023/index.html</link>
  <description><![CDATA[ 




<p>20230830</p>
<ul>
<li><p>Finished <a href="https://github.com/sr320/ceabigr">CEABIGR</a> gene counts and relatedness matrix stuff.</p></li>
<li><p>ProCard transaction verification.</p></li>
</ul>
<p>20230829</p>
<ul>
<li><p>Worked heavily on <a href="https://github.com/sr320/ceabigr">CEABIGR</a> gene counts and relatedness matrix.</p></li>
<li><p>Worked on lab safety inspection deficiencies.</p></li>
</ul>
<p>20230828</p>
<ul>
<li>Worked on lab safety inspection deficiencies.</li>
</ul>
<p>20230825</p>
<ul>
<li><p>Coral E5 Meeting</p></li>
<li><p>Science hour</p></li>
<li><p>Updated CEABIGR data using updated Stringtie/Ballgown analysis.</p></li>
</ul>
<p>20230824</p>
<ul>
<li><p>Pub-a-thon</p></li>
<li><p>Lab meeting</p></li>
<li><p>Updated CEABIGR data using updated Stringtie/Ballgown analysis.</p></li>
</ul>
<p>20230823</p>
<ul>
<li><p>In lab:</p>
<ul>
<li><p>Discovered issue with Bioanalyzer priming station.</p></li>
<li><p>Submitted mercuric chloride waste pickup request to EH&amp;S for all 250mL bottles in FTR 228.</p></li>
</ul></li>
</ul>
<p>20230822</p>
<ul>
<li><a href="https://robertslab.github.io/sams-notebook/posts/2023/2023-08-22-qPCR-Analysis---C.gigas-Matt-George-Poly:IC-Diploids/">Analysis of initial <em>C.gigas</em> diploids qPCR data for Matt George’s poly:IC experiment</a></li>
</ul>
<p>20230821</p>
<ul>
<li><p>CEABIGR meeting</p>
<ul>
<li>Generate gene/transcript matrices.</li>
<li>Use matrices to compute distance matrix between samples.</li>
</ul></li>
<li><p>Had constant computer issues most of the day (primarily, VMWare Workstation locking up, due to high CPU usage).</p></li>
<li><p>Discovered potential incompatibility between StringTie versions, possibly affecting some downstream operations (namely, running the <a href="https://ccb.jhu.edu/software/stringtie/"><code>StringTie</code></a> <code>prepDE.py3</code> script), so re-ran the CEABIGR <a href="https://en.wikipedia.org/wiki/Eastern_oyster"><em>Crassostrea virginica</em> (Eastern oyster)</a> StringTie analysis using the current version of StringTie.</p></li>
</ul>
<p>20230818</p>
<ul>
<li><p>Caught up on notebook entries</p></li>
<li><p>Science Hour</p></li>
</ul>
<p>20230817</p>
<ul>
<li><p>In lab</p>
<ul>
<li>qPCRs of <em>C.gigas</em> diploid poly:IC MgCl<sub>2</sub> control</li>
</ul></li>
<li><p><a href="https://github.com/RobertsLab/resources/issues/1697#issuecomment-1682380890">Helped Shelly get into Raven</a> (GitHub Issue)</p></li>
<li><p>sRNA analysis</p>
<ul>
<li><p>Concatenate all R1 FastAs</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> /home/shared/8TB_HDD_01/sam/data/A_pulchra/sRNAseq/collapsed/sRNA-ACR-140-145-150-173-178-S1-TP2.flexbar_trim.20230621_1.fastq-collapsed.fasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-2">/home/shared/8TB_HDD_01/sam/data/P_evermanni/sRNAseq/collapsed/sRNA-POR-73-79-82-S1-TP2.flexbar_trim.20230621_1.fastq-collapsed.fasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-3">/home/shared/8TB_HDD_01/sam/data/P_meandrina/sRNAseq/collapsed/sRNA-POC-47-48-50-53-57-S1-TP2.flexbar_trim.20230621_1.fastq-collapsed.fasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-4"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> sRNA-apul-peve-pmea-flexbar_trim.20230621_1-concatenated.fasta</span></code></pre></div></li>
<li><p>Collapse concatenated FastA to keep only unique sequences:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/fastx_toolkit_0.0.13_binaries_Linux_2.6_amd64/bin/fastx_collapser</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-2">-Q 30 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-3">-i sRNA-apul-peve-pmea-flexbar_trim.20230621_1-concatenated.fasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-4">-o sRNA-apul-peve-pmea-flexbar_trim.20230621_1-concatenated.collapsed.fasta</span></code></pre></div></li>
</ul></li>
</ul>
<p>20230816</p>
<ul>
<li><p>In lab</p>
<ul>
<li><p><em>C.gigas</em> Poly:IC</p>
<ul>
<li>Reverse transcribed diploid MgCl<sub>2</sub> control RNA to match previous diploid injected samples.</li>
</ul></li>
<li><p>Set up Synology RX1217 expansion for Gannet.</p></li>
</ul></li>
</ul>
<p>20230815</p>
<ul>
<li><p>E5 coral sRNA-seq analyses</p>
<ul>
<li><p>Collapse trimmed R1 FastQs to non-redundant reads with <code>fastx_collapser</code> to use for cross-wise BLAST-ing:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>flexbar<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_1.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-2">do</span>
<span id="cb3-3">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">filename</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>.<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb3-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">zcat</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-5">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/fastx_toolkit_0.0.13_binaries_Linux_2.6_amd64/bin/fastx_collapser</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Q30</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> collapsed/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${filename}</span>-collapsed.fasta</span>
<span id="cb3-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span></code></pre></div></li>
</ul></li>
</ul>
<p>20230809</p>
<ul>
<li><p><a href="https://github.com/urol-e5/deep-dive/issues/27"><em>P.evermanni</em> sRNA analyses</a> (GitHub Issue)</p>
<ul>
<li><p>NCBI BLASTn against <a href="https://www.mirbase.org/download/">miRBase</a> and <a href="https://www.mirgenedb.org/download">MirGeneDB</a>, mature and all species, respectively.</p>
<ul>
<li><p>Use Perl scripts in <a href="https://github.com/TF-Chan-Lab/miRDeep-P2_pipeline">miRDeep-P2-pipeline</a> (GitHub repo) to convert/condense FastAs to unique sequnces and <code>T</code> instead of <code>U</code>.</p></li>
<li><p>Make NCBI BLAST databases from each.</p></li>
<li><p>Concatenate sRNA-seq FastAs (from <a href="https://github.com/friedlanderlab/mirtrace">miRTrace</a> - GitHub Repo) for each sample.</p></li>
<li><p>Run NCBI BLASTn</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> fasta <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> /home/shared/8TB_HDD_01/sam/data/P_evermanni/sRNAseq/mirtrace.config.output/qc_passed_reads.all.collapsed/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>cat.fasta</span>
<span id="cb4-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span>
<span id="cb4-3">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">filename</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fasta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-4">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/ncbi-blast-2.11.0+/bin/blastn</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-db</span> /home/shared/8TB_HDD_01/sam/data/blastdbs/mature_wo_U_uniq.fa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-query</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fasta}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-out</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"20230809-peve-miRBase-BLASTn-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${filename}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.outfmt6"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-max_hsps</span> 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-max_target_seqs</span> 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-outfmt</span> 6 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-num_threads</span> 40</span>
<span id="cb4-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span></code></pre></div>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> fasta <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> /home/shared/8TB_HDD_01/sam/data/P_evermanni/sRNAseq/mirtrace.config.output/qc_passed_reads.all.collapsed/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>cat.fasta</span>
<span id="cb5-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span> </span>
<span id="cb5-3">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">filename</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fasta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-4">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/ncbi-blast-2.11.0+/bin/blastn</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-db</span> /home/shared/8TB_HDD_01/sam/data/blastdbs/ALL_wo_U_uniq.fas <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-query</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fasta}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-out</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"20230809-peve-miRGene-BLASTn-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${filename}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.outfmt6"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-max_hsps</span> 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-max_target_seqs</span> 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-outfmt</span> 6 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-num_threads</span> 40</span>
<span id="cb5-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span></code></pre></div>
<ul>
<li>NO MATCHES FOR EITHER!</li>
</ul></li>
</ul></li>
<li><p>Run <a href="https://github.com/rajewsky-lab/mirdeep2">mirdeep2</a> (GitHub repo- &gt; “About Discovering known and novel miRNAs from small RNA sequencing data”)</p>
<ul>
<li>First, map reads to genome (<code>*.arf</code>)</li>
</ul>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> fasta <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> /home/shared/8TB_HDD_01/sam/data/P_evermanni/sRNAseq/mirtrace.config.output/qc_passed_reads.all.collapsed/no_spaces<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.fasta<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-2">  do</span>
<span id="cb6-3">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">filename</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fasta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-4">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/mirdeep2/bin/mapper.pl</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fasta}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> /home/shared/8TB_HDD_01/sam/data/P_evermanni/genomes/Porites_evermanni_v1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"20230809-peve-miRNA-mirdeep2-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${filename}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.arf"</span></span>
<span id="cb6-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span></code></pre></div>
<ul>
<li><p>Reformat miRTrace collapsed FastAs to have compatible description lines</p>
<p><code>for fasta in sRNA*20230621_[12].fasta; do sed '/^&gt;/ s/ /_/g' ${fasta} | sed 's/_rnatype.*$//g' &gt; "no_spaces-${fasta}"; done</code></p></li>
<li><p>Run <a href="https://github.com/rajewsky-lab/mirdeep2">mirdeep2</a> on sequencing reads (was having problems with loop, so ran individually)</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/mirdeep2/bin/miRDeep2.pl</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-2">/home/shared/8TB_HDD_01/sam/data/P_evermanni/sRNAseq/mirtrace.config.output/qc_passed_reads.all.collapsed/no_spaces-sRNA-POR-73-S1-TP2.flexbar_trim.20230621_1.fasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-3">/home/shared/8TB_HDD_01/sam/data/P_evermanni/genomes/Porites_evermanni_v1.fa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-4">20230809-peve-miRNA-mirdeep2-no_spaces-sRNA-POR-73-S1-TP2.flexbar_trim.20230621_1.fasta.arf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-5">none none none <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-6">2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>20230809-peve-miRNA-mirdeep2-no_spaces-sRNA-POR-73-S1-TP2.flexbar_trim.20230621_1.fasta.log</span></code></pre></div>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/mirdeep2/bin/miRDeep2.pl</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-2">/home/shared/8TB_HDD_01/sam/data/P_evermanni/sRNAseq/mirtrace.config.output/qc_passed_reads.all.collapsed/no_spaces-sRNA-POR-79-S1-TP2.flexbar_trim.20230621_1.fasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-3">/home/shared/8TB_HDD_01/sam/data/P_evermanni/genomes/Porites_evermanni_v1.fa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-4">20230809-peve-miRNA-mirdeep2-no_spaces-sRNA-POR-79-S1-TP2.flexbar_trim.20230621_1.fasta.arf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-5">none none none <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-6">2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>20230809-peve-miRNA-mirdeep2-no_spaces-sRNA-POR-79-S1-TP2.flexbar_trim.20230621_1.fasta.log</span></code></pre></div>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/mirdeep2/bin/miRDeep2.pl</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-2">/home/shared/8TB_HDD_01/sam/data/P_evermanni/sRNAseq/mirtrace.config.output/qc_passed_reads.all.collapsed/no_spaces-sRNA-POR-82-S1-TP2.flexbar_trim.20230621_1.fasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-3">/home/shared/8TB_HDD_01/sam/data/P_evermanni/genomes/Porites_evermanni_v1.fa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-4">20230809-peve-miRNA-mirdeep2-no_spaces-sRNA-POR-82-S1-TP2.flexbar_trim.20230621_1.fasta.arf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-5">none none none <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-6">2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>20230809-peve-miRNA-mirdeep2-no_spaces-sRNA-POR-82-S1-TP2.flexbar_trim.20230621_1.fasta.log</span></code></pre></div></li>
</ul></li>
</ul></li>
</ul>
<p>20230808</p>
<ul>
<li><p><a href="https://github.com/urol-e5/deep-dive/issues/27"><em>P.evermanni</em> sRNA analyses</a> (GitHub Issue)</p>
<ul>
<li><p><a href="https://github.com/sinanugur/MirMachine"><code>MirMachine</code></a>:</p>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MirMachine.py</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-2">--node Metazoa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-3">--species 20230808-peve-MirMachine <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-4">--genome /home/shared/8TB_HDD_01/sam/data/P_evermanni/genomes/Porites_evermanni_v1.fa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-5">--cpu 40 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-6">--add-all-nodes</span></code></pre></div>
<ul>
<li><p>83 loci identified (<code>grep -c "^[^#]" 20230808-peve-MirMachine.PRE.gff</code>)</p></li>
<li><p>15 unique miRNA families (<code>grep "^[^#]" 20230808-peve-MirMachine.PRE.gff | awk -F"[\t=;]" '{print $10}'| sort -u | wc -l</code>)</p></li>
</ul></li>
</ul></li>
</ul>
<p>20230804</p>
<ul>
<li><p>In lab.</p>
<ul>
<li><p>Fresh install of Ubuntu on <code>swoose</code>. Ugh… Replaced internal HDD (1TB) with 8TB HDD.</p></li>
<li><p>Cleaning for lab safety inspection.</p></li>
<li><p>Lab safety inspection.</p></li>
<li><p>Tried troubleshooting dual boot situation for Jackie’s Linux/Windows computer. Some progress (GRUB menu now shows again), but booting into Windows just hangs at a black screen.</p></li>
</ul></li>
</ul>
<p>20230803</p>
<ul>
<li><p>CEABIGR</p>
<ul>
<li><p>Worked on transcript annotation by exploring differences in DIAMOND/NCBI BLASTx.</p></li>
<li><p>Gathered some prelinary sRNA-seq stats for Steven’s grant update.</p></li>
</ul></li>
</ul>
<p>20230801</p>



 ]]></description>
  <category>2023</category>
  <category>Daily Bits</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-08-01-Daily-Bits---August-2023/index.html</guid>
  <pubDate>Tue, 01 Aug 2023 14:25:00 GMT</pubDate>
</item>
<item>
  <title>sRNA-seq Alignments - E5 Coral P.evermanni Using ShortStack on Mox</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-07-31-sRNA-seq-Alignments---E5-Coral-P.evermanni-Using-ShortStack-on-Mox/index.html</link>
  <description><![CDATA[ 




<p><a href="https://github.com/urol-e5/deep-dive/issues/19#issuecomment-1656494994">Steven asked that I run ShortStack on the E5 <em>P.evermanni</em> sRNA-seq</a> (GitHub Issue) data we had. I used <a href="https://robertslab.github.io/sams-notebook/posts/2023/2023-06-20-Trimming-and-QC-E5-Coral-sRNA-seq-Data-fro-A.pulchra-P.evermanni-and-P.meandrina-Using-FastQC-flexbar-and-MultiQC-on-Mox.html">trimmed sRNA-seq reads from 20230620</a> (notebook entry) and the <em>P.evermanni</em> genome (<code>Porites_evermanni_v1.fa</code>) from <a href="https://www.genoscope.cns.fr/corals/genomes/">https://www.genoscope.cns.fr/corals/genomes/</a>, along with the known, mature miRNAs FastA from <a href="https://www.mirbase.org/download/">https://www.mirbase.org/download/</a> (downloaded 20230628). The job was run on Mox.</p>
<p>SLURM script (GitHub):</p>
<ul>
<li><a href="https://github.com/RobertsLab/sams-notebook/blob/master/sbatch_scripts/20230731-peve-E5_coral-ShortStack-sRNAseq.sh">20230731-peve-E5_coral-ShortStack-sRNAseq.sh</a></li>
</ul>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Job Name</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --job-name=20230731-peve-E5_coral-ShortStack-sRNAseq</span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Allocation Definition</span></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --account=srlab</span></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --partition=srlab</span></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Resources</span></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Nodes</span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --nodes=1</span></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Walltime (days-hours:minutes:seconds format)</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --time=5-00:00:00</span></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Memory per node</span></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mem=500G</span></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##turn on e-mail notification</span></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-type=ALL</span></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-user=samwhite@uw.edu</span></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Specify the working directory for this job</span></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --chdir=/gscratch/scrubbed/samwhite/outputs/20230731-peve-E5_coral-ShortStack-sRNAseq</span></span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### E5 sRNA-seq alignments using trimmed reads from 20230620 with ShortStack.</span></span>
<span id="cb1-21"></span>
<span id="cb1-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### Expects FastQ read directory paths to be formatted like:</span></span>
<span id="cb1-23"></span>
<span id="cb1-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># /gscratch/srlab/sam/data/P_evermanni/sRNAseq/trimmed</span></span>
<span id="cb1-25"></span>
<span id="cb1-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### Uses trimmed reads from 20230620. Expect FastQ filename format like:</span></span>
<span id="cb1-27"></span>
<span id="cb1-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># *flexbar_trim.20230621_[12]*.fastq.gz</span></span>
<span id="cb1-29"></span>
<span id="cb1-30"></span>
<span id="cb1-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################</span></span>
<span id="cb1-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># These variables need to be set by user</span></span>
<span id="cb1-33"></span>
<span id="cb1-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Assign Variables</span></span>
<span id="cb1-35"></span>
<span id="cb1-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set FastQ filename patterns</span></span>
<span id="cb1-37"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_pattern</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'*flexbar_trim.20230621*.fastq.gz'</span></span>
<span id="cb1-38"></span>
<span id="cb1-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set number of CPUs to use</span></span>
<span id="cb1-40"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">threads</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>40</span>
<span id="cb1-41"></span>
<span id="cb1-42"></span>
<span id="cb1-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Input/output files</span></span>
<span id="cb1-44"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_checksums</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>input_fastq_checksums.md5</span>
<span id="cb1-45"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sRNA_FastA</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/sam/data/miRBase/20230628-miRBase-mature.fa"</span></span>
<span id="cb1-46"></span>
<span id="cb1-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data directories</span></span>
<span id="cb1-48"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">reads_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/gscratch/srlab/sam/data</span>
<span id="cb1-49"></span>
<span id="cb1-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Inititalize arrays</span></span>
<span id="cb1-51"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trimmed_fastq_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb1-52"></span>
<span id="cb1-53"></span>
<span id="cb1-54"></span>
<span id="cb1-55"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Species array (must match directory name usage)</span></span>
<span id="cb1-56"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">species_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P_evermanni"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-57"></span>
<span id="cb1-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Programs associative array</span></span>
<span id="cb1-59"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">declare</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span></span>
<span id="cb1-60"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb1-61">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>ShortStack<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ShortStack"</span></span>
<span id="cb1-62">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-63"></span>
<span id="cb1-64"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Genomes associative array</span></span>
<span id="cb1-65"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">declare</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">genomes_array</span></span>
<span id="cb1-66"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">genomes_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb1-67">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>P_evermanni<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/sam/data/P_evermanni/genomes/Porites_evermanni_v1.fa"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-68">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-69"></span>
<span id="cb1-70"></span>
<span id="cb1-71"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################</span></span>
<span id="cb1-72"></span>
<span id="cb1-73"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Exit script if any command fails</span></span>
<span id="cb1-74"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span></span>
<span id="cb1-75"></span>
<span id="cb1-76"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load Anaconda</span></span>
<span id="cb1-77"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Uknown why this is needed, but Anaconda will not run if this line is not included.</span></span>
<span id="cb1-78"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/programs/anaconda3/etc/profile.d/conda.sh"</span></span>
<span id="cb1-79"></span>
<span id="cb1-80"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Activate flexbar environment</span></span>
<span id="cb1-81"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> activate ShortStack4_env</span>
<span id="cb1-82"></span>
<span id="cb1-83"></span>
<span id="cb1-84"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set working directory</span></span>
<span id="cb1-85"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">working_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-86"></span>
<span id="cb1-87"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> species <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${species_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-88"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span>
<span id="cb1-89">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Inititalize arrays</span></span>
<span id="cb1-90">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trimmed_fastq_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb1-91"></span>
<span id="cb1-92"></span>
<span id="cb1-93">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Creating </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${species}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> directory ..."</span> </span>
<span id="cb1-94"></span>
<span id="cb1-95">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${species}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-96"></span>
<span id="cb1-97">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change to species directory</span></span>
<span id="cb1-98">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${species}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-99"></span>
<span id="cb1-100"></span>
<span id="cb1-101">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ShortStack output directory</span></span>
<span id="cb1-102">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-103"></span>
<span id="cb1-104">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Now in </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${PWD}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">."</span></span>
<span id="cb1-105"></span>
<span id="cb1-106">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sync raw FastQ files to working directory</span></span>
<span id="cb1-107">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-108">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Transferring files via rsync..."</span></span>
<span id="cb1-109"></span>
<span id="cb1-110">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rsync</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--archive</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-111">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads_dir}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${species}</span>/sRNAseq/trimmed/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_pattern}</span> .</span>
<span id="cb1-112"></span>
<span id="cb1-113">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-114">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"File transfer complete."</span></span>
<span id="cb1-115">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-116"></span>
<span id="cb1-117">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### Run ShortStack </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">###</span></span>
<span id="cb1-118"></span>
<span id="cb1-119">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Do NOT quote trimmed_fastq_list</span></span>
<span id="cb1-120">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create array of trimmed FastQs</span></span>
<span id="cb1-121">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trimmed_fastq_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(${fastq_pattern})</span></span>
<span id="cb1-122"></span>
<span id="cb1-123">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pass array contents to new variable as space-delimited list</span></span>
<span id="cb1-124">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trimmed_fastq_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastq_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[*]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-125"></span>
<span id="cb1-126">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beginning ShortStack on </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${species}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> sRNAseq using genome FastA:"</span></span>
<span id="cb1-127">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genomes_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${species}</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-128">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-129"></span>
<span id="cb1-130">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Run ShortStack ##</span></span>
<span id="cb1-131">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>ShortStack<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-132">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--genomefile</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genomes_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${species}</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-133">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--readfile</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastq_list}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-134">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--known_miRNAs</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sRNA_FastA}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-135">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--dn_mirna</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-136">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--threads</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-137">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--outdir</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span>/ShortStack_out</span>
<span id="cb1-138"></span>
<span id="cb1-139">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ShortStack on </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${species}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> complete!"</span></span>
<span id="cb1-140">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-141"></span>
<span id="cb1-142"></span>
<span id="cb1-143">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">######## Create MD5 checksums for raw FastQs ########</span></span>
<span id="cb1-144"></span>
<span id="cb1-145">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> fastq <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_pattern}</span></span>
<span id="cb1-146">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span>
<span id="cb1-147">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Generating checksum for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-148">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--append</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_checksums}</span></span>
<span id="cb1-149">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-150">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span>
<span id="cb1-151"></span>
<span id="cb1-152">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">######## </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> MD5 CHECKSUMS ########</span></span>
<span id="cb1-153"></span>
<span id="cb1-154">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">######## REMOVE INPUT FASTQS ########</span></span>
<span id="cb1-155">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Removing input FastQs."</span></span>
<span id="cb1-156">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-157">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_pattern}</span></span>
<span id="cb1-158">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Input FastQs removed."</span></span>
<span id="cb1-159">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">echo</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-160"></span>
<span id="cb1-161">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Now moving back to </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${working_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">."</span></span>
<span id="cb1-162">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${working_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-163">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-164"></span>
<span id="cb1-165"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span>
<span id="cb1-166"></span>
<span id="cb1-167"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">####################################################################</span></span>
<span id="cb1-168"></span>
<span id="cb1-169"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Capture program options</span></span>
<span id="cb1-170"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-gt</span> 0 <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-171">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Logging program options..."</span></span>
<span id="cb1-172">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> program <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-173">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span>
<span id="cb1-174">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-175">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Program options for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">: "</span></span>
<span id="cb1-176">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-177">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle samtools help menus</span></span>
<span id="cb1-178">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_index"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-179">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_sort"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-180">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_view"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span></span>
<span id="cb1-181">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-182">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-183"></span>
<span id="cb1-184">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle DIAMOND BLAST menu</span></span>
<span id="cb1-185">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"diamond"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-186">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> help</span>
<span id="cb1-187"></span>
<span id="cb1-188">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle NCBI BLASTx menu</span></span>
<span id="cb1-189">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blastx"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-190">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-help</span></span>
<span id="cb1-191"></span>
<span id="cb1-192">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle fastp menu</span></span>
<span id="cb1-193">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastp"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-194">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--help</span></span>
<span id="cb1-195">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span></span>
<span id="cb1-196">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-h</span></span>
<span id="cb1-197">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb1-198">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-199">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-200">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"----------------------------------------------"</span></span>
<span id="cb1-201">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-202">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-203">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&gt;&gt;</span> program_options.log <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb1-204"></span>
<span id="cb1-205">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If MultiQC is in programs_array, copy the config file to this directory.</span></span>
<span id="cb1-206">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"multiqc"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-207">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cp</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--preserve</span> ~/.multiqc_config.yaml multiqc_config.yaml</span>
<span id="cb1-208">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb1-209">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span>
<span id="cb1-210"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb1-211"></span>
<span id="cb1-212"></span>
<span id="cb1-213"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Document programs in PATH (primarily for program version ID)</span></span>
<span id="cb1-214"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-215"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">date</span></span>
<span id="cb1-216"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-217"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"System PATH for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$SLURM_JOB_ID</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-218"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-219"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%0.s-"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">..</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-220"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${PATH}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tr</span> : <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\\</span>n</span>
<span id="cb1-221"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> system_path.log</span></code></pre></div>
<hr>
<section id="results" class="level1">
<h1>RESULTS</h1>
<p>Job took just under two hours to run:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-07-31-sRNA-seq-Alignments---E5-Coral-P.evermanni-Using-ShortStack-on-Mox/https:/github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20230731-peve-E5_coral-ShortStack-sRNAseq-runtime.png?raw=true" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Screencap showing Mox job runtime of 1hr 10mins and 54secs</figcaption>
</figure>
</div>
<p>Output folder:</p>
<ul>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230731-peve-E5_coral-ShortStack-sRNAseq/">20230731-peve-E5_coral-ShortStack-sRNAseq/</a></p>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/20230731-peve-E5_coral-ShortStack-sRNAseq/P_evermanni/ShortStack_out/">20230731-peve-E5_coral-ShortStack-sRNAseq/P_evermanni/ShortStack_out/</a></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230731-peve-E5_coral-ShortStack-sRNAseq/P_evermanni/ShortStack_out/alignment_details.tsv">alignment_details.tsv</a> (32K)</p>
<ul>
<li>MD5: <code>12e0c5eee19a1909734db85ec4512536</code></li>
</ul>
<pre><code>readfile                                                                                                                                                 mapping_type  read_length  count
/gscratch/scrubbed/samwhite/outputs/20230731-peve-E5_coral-ShortStack-sRNAseq/P_evermanni/ShortStack_out/sRNA-POR-73-S1-TP2.flexbar_trim.20230621_1.bam  U             &lt;21          566073
/gscratch/scrubbed/samwhite/outputs/20230731-peve-E5_coral-ShortStack-sRNAseq/P_evermanni/ShortStack_out/sRNA-POR-73-S1-TP2.flexbar_trim.20230621_1.bam  U             21           169195
/gscratch/scrubbed/samwhite/outputs/20230731-peve-E5_coral-ShortStack-sRNAseq/P_evermanni/ShortStack_out/sRNA-POR-73-S1-TP2.flexbar_trim.20230621_1.bam  U             22           208380
/gscratch/scrubbed/samwhite/outputs/20230731-peve-E5_coral-ShortStack-sRNAseq/P_evermanni/ShortStack_out/sRNA-POR-73-S1-TP2.flexbar_trim.20230621_1.bam  U             23           173305
/gscratch/scrubbed/samwhite/outputs/20230731-peve-E5_coral-ShortStack-sRNAseq/P_evermanni/ShortStack_out/sRNA-POR-73-S1-TP2.flexbar_trim.20230621_1.bam  U             24           168110
/gscratch/scrubbed/samwhite/outputs/20230731-peve-E5_coral-ShortStack-sRNAseq/P_evermanni/ShortStack_out/sRNA-POR-73-S1-TP2.flexbar_trim.20230621_1.bam  U             &gt;24          3403975
/gscratch/scrubbed/samwhite/outputs/20230731-peve-E5_coral-ShortStack-sRNAseq/P_evermanni/ShortStack_out/sRNA-POR-73-S1-TP2.flexbar_trim.20230621_1.bam  P             &lt;21          369674
/gscratch/scrubbed/samwhite/outputs/20230731-peve-E5_coral-ShortStack-sRNAseq/P_evermanni/ShortStack_out/sRNA-POR-73-S1-TP2.flexbar_trim.20230621_1.bam  P             21           137171
/gscratch/scrubbed/samwhite/outputs/20230731-peve-E5_coral-ShortStack-sRNAseq/P_evermanni/ShortStack_out/sRNA-POR-73-S1-TP2.flexbar_trim.20230621_1.bam  P             22           108728</code></pre></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230731-peve-E5_coral-ShortStack-sRNAseq/P_evermanni/ShortStack_out/Counts.txt">Counts.txt</a> (1.2M)</p>
<ul>
<li>MD5: <code>3f98fd9f50c5eaa7b70f40b552303538</code></li>
</ul>
<pre><code>Coords                                     Name       MIRNA  sRNA-POR-73-S1-TP2.flexbar_trim.20230621_1  sRNA-POR-73-S1-TP2.flexbar_trim.20230621_2  sRNA-POR-79-S1-TP2.flexbar_trim.20230621_1  sRNA-POR-79-S1-TP2.flexbar_trim.20230621_2  sRNA-POR-82-S1-TP2.flexbar_trim.20230621_1  sRNA-POR-82-S1-TP2.flexbar_trim.20230621_2
Porites_evermani_scaffold_1:45716-46131    Cluster_1  N      0                                           0                                           78                                          78                                          18                                          17
Porites_evermani_scaffold_1:406306-406734  Cluster_2  N      157                                         169                                         24                                          26                                          11                                          12
Porites_evermani_scaffold_1:409840-410269  Cluster_3  N      121                                         100                                         30                                          39                                          24                                          21
Porites_evermani_scaffold_1:465246-465668  Cluster_4  N      12                                          12                                          35                                          33                                          137                                         137
Porites_evermani_scaffold_1:468473-468950  Cluster_5  N      55442                                       55280                                       31667                                       31535                                       28192                                       28143
Porites_evermani_scaffold_1:476827-477250  Cluster_6  N      27                                          27                                          22                                          22                                          68                                          68
Porites_evermani_scaffold_1:486441-486868  Cluster_7  N      16                                          16                                          6                                           6                                           36                                          35
Porites_evermani_scaffold_1:534424-534866  Cluster_8  N      158                                         157                                         117                                         116                                         352                                         348
Porites_evermani_scaffold_1:729097-729587  Cluster_9  N      2122                                        2115                                        1684                                        1663                                        2840                                        2833</code></pre></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230731-peve-E5_coral-ShortStack-sRNAseq/P_evermanni/ShortStack_out/Results.txt">Results.txt</a> (2.7M)</p>
<ul>
<li>MD5: <code>11ade4844fc32dfe52b9d1544353740d</code></li>
</ul>
<pre><code>Locus                                      Name       Chrom                        Start   End     Length  Reads   UniqueReads  FracTop              Strand  MajorRNA                           MajorRNAReads  Short  Long    21   22   23   24    DicerCall  MIRNA  known_miRNAs
Porites_evermani_scaffold_1:45716-46131    Cluster_1  Porites_evermani_scaffold_1  45716   46131   416     191     91           0.5026178010471204   .       CCAAGGAGCUGUUAAAAC                 8              45     72      18   16   18   22    N          N      NA
Porites_evermani_scaffold_1:406306-406734  Cluster_2  Porites_evermani_scaffold_1  406306  406734  429     399     124          0.5162907268170426   .       UGAGUGUAUUCUUGAACUGUUUUCCAAC       47             9      367     3    1    5    14    N          N      NA
Porites_evermani_scaffold_1:409840-410269  Cluster_3  Porites_evermani_scaffold_1  409840  410269  430     335     82           0.48656716417910445  .       UGGAACUCCGAUUUAGAACUUGCAAACUUU     56             0      326     1    2    0    6     N          N      NA
Porites_evermani_scaffold_1:465246-465668  Cluster_4  Porites_evermani_scaffold_1  465246  465668  423     366     115          0.4972677595628415   .       AAGUUGCUCUGAAGAUUAUGU              39             66     135     96   15   40   14    N          N      NA
Porites_evermani_scaffold_1:468473-468950  Cluster_5  Porites_evermani_scaffold_1  468473  468950  478     230259  2291         0.49925518655079715  .       AGCACUGAUGACUGUUCAGUUUUUCUGAAUU    68303          3892   223407  229  276  305  2150  N          N      NA
Porites_evermani_scaffold_1:476827-477250  Cluster_6  Porites_evermani_scaffold_1  476827  477250  424     234     76           0.5                  .       GUACGAGACGAUUACGAAGACACG           14             66     78      0    24   30   36    N          N      NA
Porites_evermani_scaffold_1:486441-486868  Cluster_7  Porites_evermani_scaffold_1  486441  486868  428     115     22           0.4956521739130435   .       AUAUUGACGAAUCCUGGCCUAGUGAACC       27             0      107     0    0    8    0     N          N      NA
Porites_evermani_scaffold_1:534424-534866  Cluster_8  Porites_evermani_scaffold_1  534424  534866  443     1248    232          0.49759615384615385  .       GAGACGUAAACUUAUAGCUUUGGCU          205            62     888     120  28   70   80    N          N      NA
Porites_evermani_scaffold_1:729097-729587  Cluster_9  Porites_evermani_scaffold_1  729097  729587  491     13257   889          0.49867994267179605  .       CACUUAGUGACAAGCCAGAACUGUCUGACCACA  3000           409    11622   262  478  244  242   N          N      NA</code></pre></li>
</ul>
<section id="bams" class="level4">
<h4 class="anchored" data-anchor-id="bams">BAMs</h4>
<ul>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230731-peve-E5_coral-ShortStack-sRNAseq/P_evermanni/ShortStack_out/merged_alignments.bam">merged_alignments.bam</a> (1.5G)</p>
<ul>
<li>MD5: <code>cbebc137669b7499b2fce8e75be0099f</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230731-peve-E5_coral-ShortStack-sRNAseq/P_evermanni/ShortStack_out/sRNA-POR-73-S1-TP2.flexbar_trim.20230621_1.bam">sRNA-POR-73-S1-TP2.flexbar_trim.20230621_1.bam</a> (225M)</p>
<ul>
<li>MD5: <code>b4186554eb1d3b5716ef4de298d2487b</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230731-peve-E5_coral-ShortStack-sRNAseq/P_evermanni/ShortStack_out/sRNA-POR-73-S1-TP2.flexbar_trim.20230621_2.bam">sRNA-POR-73-S1-TP2.flexbar_trim.20230621_2.bam</a> (227M)</p>
<ul>
<li>MD5: <code>65f842c98ced9f818f93aae051a89d7f</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230731-peve-E5_coral-ShortStack-sRNAseq/P_evermanni/ShortStack_out/sRNA-POR-79-S1-TP2.flexbar_trim.20230621_1.bam">sRNA-POR-79-S1-TP2.flexbar_trim.20230621_1.bam</a> (254M)</p>
<ul>
<li>MD5: <code>f36efde12eaa25e035e3b8f999f9f866</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230731-peve-E5_coral-ShortStack-sRNAseq/P_evermanni/ShortStack_out/sRNA-POR-79-S1-TP2.flexbar_trim.20230621_2.bam">sRNA-POR-79-S1-TP2.flexbar_trim.20230621_2.bam</a> (256M)</p>
<ul>
<li>MD5: <code>faf18e5de4c946c8c9129aa203d2a8eb</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230731-peve-E5_coral-ShortStack-sRNAseq/P_evermanni/ShortStack_out/sRNA-POR-82-S1-TP2.flexbar_trim.20230621_1.bam">sRNA-POR-82-S1-TP2.flexbar_trim.20230621_1.bam</a> (280M)</p>
<ul>
<li>MD5: <code>bbc58e1486202c3b02caa3a8e4220765</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230731-peve-E5_coral-ShortStack-sRNAseq/P_evermanni/ShortStack_out/sRNA-POR-82-S1-TP2.flexbar_trim.20230621_2.bam">sRNA-POR-82-S1-TP2.flexbar_trim.20230621_2.bam</a> (281M)</p>
<ul>
<li>MD5: <code>7d75154b4b2b7132f5a89a2a00c84bd7</code></li>
</ul></li>
</ul>
</section>
<section id="gffs" class="level4">
<h4 class="anchored" data-anchor-id="gffs">GFFs</h4>
<ul>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230731-peve-E5_coral-ShortStack-sRNAseq/P_evermanni/ShortStack_out/Results.gff3">Results.gff3</a> (1.7M)</p>
<ul>
<li>MD5: <code>087bba3ed90b43f3c663a61bdbabbf82</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230731-peve-E5_coral-ShortStack-sRNAseq/P_evermanni/ShortStack_out/known_miRNAs.gff3">known_miRNAs.gff3</a> (204K)</p>
<ul>
<li>MD5: <code>5df2467b645659472bc23d041756e94e</code></li>
</ul></li>
</ul>


</section>
</section>

 ]]></description>
  <category>2023</category>
  <category>E5</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-07-31-sRNA-seq-Alignments---E5-Coral-P.evermanni-Using-ShortStack-on-Mox/index.html</guid>
  <pubDate>Mon, 31 Jul 2023 13:02:00 GMT</pubDate>
</item>
<item>
  <title>Read Extractions - M.magister MEGAN FastA to FastQ Arthropoda and Unassigned Reads</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-07-30-Read-Extractions---M.magister-MEGAN-FastA-to-FastQ-Arthropoda-and-Unassigned-Reads/index.html</link>
  <description><![CDATA[ 




<p>After <a href="https://robertslab.github.io/sams-notebook/posts/2023/2023-07-26-Read-Extractions-M.magister-MEGAN-Arthropoda-and-Unassigned-Reads-to-FastA/">getting <code>Arthropoda</code> and <code>Unassigned</code> reads extracted to FastA format</a> (notebook entry) using <a href="https://software-ab.cs.uni-tuebingen.de/download/megan6/welcome/">MEGAN6 Community Edition</a>, the next step was to use the FastA files to extract reads in FastQ format. I used <a href="https://github.com/lh3/seqtk"><code>seqtk</code></a> to do this. The process is documented in the Jupyter Notebook below.</p>
<p>Jupyter Notebook:</p>
<ul>
<li><p>GitHub:</p>
<ul>
<li><a href="https://github.com/RobertsLab/code/blob/master/notebooks/sam/20230730-mmag-megan-fasta_to_fastq.ipynb">20230730-mmag-megan-fasta_to_fastq.ipynb</a></li>
</ul></li>
<li><p>NB Viewer:</p>
<ul>
<li><a href="https://nbviewer.org/github/RobertsLab/code/blob/master/notebooks/sam/20230730-mmag-megan-fasta_to_fastq.ipynb">20230730-mmag-megan-fasta_to_fastq.ipynb</a></li>
</ul></li>
</ul>
<iframe src="https://nbviewer.org/github/RobertsLab/code/blob/master/notebooks/sam/20230730-mmag-megan-fasta_to_fastq.ipynb" width="100%" height="2000" scrolling="yes">
</iframe>
<hr>
<section id="results" class="level1">
<h1>RESULTS</h1>
<p>Output folder:</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads/">20230730.mmag-megan_reads/</a></li>
</ul>
<section id="fastq-files" class="level4">
<h4 class="anchored" data-anchor-id="fastq-files">FastQ Files</h4>
<ul>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH01-06.trimmed.megan_R1.fq.gz">20230730.mmag.CH01-06.trimmed.megan_R1.fq.gz</a> (218M)</p>
<ul>
<li>MD5: <code>e6047623dc885392b3ae816f094552b4</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH01-06.trimmed.megan_R2.fq.gz">20230730.mmag.CH01-06.trimmed.megan_R2.fq.gz</a> (224M)</p>
<ul>
<li>MD5: <code>40b096dc26066a0d715d05e4bde36806</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH01-14.trimmed.megan_R1.fq.gz">20230730.mmag.CH01-14.trimmed.megan_R1.fq.gz</a> (405M)</p>
<ul>
<li>MD5: <code>401d6206dcd62c8b682536eef19ee4cc</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH01-14.trimmed.megan_R2.fq.gz">20230730.mmag.CH01-14.trimmed.megan_R2.fq.gz</a> (412M)</p>
<ul>
<li>MD5: <code>dcfe7a42861fa7406e1cc16522584045</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH01-22.trimmed.megan_R1.fq.gz">20230730.mmag.CH01-22.trimmed.megan_R1.fq.gz</a> (238M)</p>
<ul>
<li>MD5: <code>e9c1b9a7d3afb9bdd4beaff2c6ddb0fa</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH01-22.trimmed.megan_R2.fq.gz">20230730.mmag.CH01-22.trimmed.megan_R2.fq.gz</a> (242M)</p>
<ul>
<li>MD5: <code>7491813d90b50e08e3cefca8e1a1d7fc</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH01-38.trimmed.megan_R1.fq.gz">20230730.mmag.CH01-38.trimmed.megan_R1.fq.gz</a> (405M)</p>
<ul>
<li>MD5: <code>99bf9577b46bf2dfca8b8ac042e179ed</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH01-38.trimmed.megan_R2.fq.gz">20230730.mmag.CH01-38.trimmed.megan_R2.fq.gz</a> (410M)</p>
<ul>
<li>MD5: <code>4be920ddd78862fe25a46e66235faad4</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH03-04.trimmed.megan_R1.fq.gz">20230730.mmag.CH03-04.trimmed.megan_R1.fq.gz</a> (214M)</p>
<ul>
<li>MD5: <code>2f85cd2b10061b89011123d3bfa58d4f</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH03-04.trimmed.megan_R2.fq.gz">20230730.mmag.CH03-04.trimmed.megan_R2.fq.gz</a> (218M)</p>
<ul>
<li>MD5: <code>d220a8d18d8a67bfba19410879464f43</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH03-15.trimmed.megan_R1.fq.gz">20230730.mmag.CH03-15.trimmed.megan_R1.fq.gz</a> (260M)</p>
<ul>
<li>MD5: <code>a20b5ac49bdf3e17f18d0dbc1b60d6d2</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH03-15.trimmed.megan_R2.fq.gz">20230730.mmag.CH03-15.trimmed.megan_R2.fq.gz</a> (265M)</p>
<ul>
<li>MD5: <code>7cf21ab8f759a50183d31584aac1d1e3</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH03-33.trimmed.megan_R1.fq.gz">20230730.mmag.CH03-33.trimmed.megan_R1.fq.gz</a> (235M)</p>
<ul>
<li>MD5: <code>be8e50bf2c6747671ab4c2f2c3cbc5fd</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH03-33.trimmed.megan_R2.fq.gz">20230730.mmag.CH03-33.trimmed.megan_R2.fq.gz</a> (235M)</p>
<ul>
<li>MD5: <code>a5edfe0babb198adb29d1a19784f678b</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH05-01.trimmed.megan_R1.fq.gz">20230730.mmag.CH05-01.trimmed.megan_R1.fq.gz</a> (248M)</p>
<ul>
<li>MD5: <code>53ef62108920c3957954ac443418ca92</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH05-01.trimmed.megan_R2.fq.gz">20230730.mmag.CH05-01.trimmed.megan_R2.fq.gz</a> (254M)</p>
<ul>
<li>MD5: <code>0c22a7ca75b5c5adb646794115f112c7</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH05-06.trimmed.megan_R1.fq.gz">20230730.mmag.CH05-06.trimmed.megan_R1.fq.gz</a> (219M)</p>
<ul>
<li>MD5: <code>f5abf6a6f57473c7a8aed7b37472a4d2</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH05-06.trimmed.megan_R2.fq.gz">20230730.mmag.CH05-06.trimmed.megan_R2.fq.gz</a> (223M)</p>
<ul>
<li>MD5: <code>3f17e210323b66673b87682e18c65756</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH05-07.trimmed.megan_R1.fq.gz">20230730.mmag.CH05-07.trimmed.megan_R1.fq.gz</a> (241M)</p>
<ul>
<li>MD5: <code>3e3823bbf19ec39bca8d5544640a4211</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH05-07.trimmed.megan_R2.fq.gz">20230730.mmag.CH05-07.trimmed.megan_R2.fq.gz</a> (243M)</p>
<ul>
<li>MD5: <code>58189bc49bee52fa10aca82274657ce3</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH05-09.trimmed.megan_R1.fq.gz">20230730.mmag.CH05-09.trimmed.megan_R1.fq.gz</a> (335M)</p>
<ul>
<li>MD5: <code>c6900bf83ffbf843216fb67fce1c7df2</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH05-09.trimmed.megan_R2.fq.gz">20230730.mmag.CH05-09.trimmed.megan_R2.fq.gz</a> (339M)</p>
<ul>
<li>MD5: <code>02f9adfa7438fb42b4dca917aa4763fb</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH05-14.trimmed.megan_R1.fq.gz">20230730.mmag.CH05-14.trimmed.megan_R1.fq.gz</a> (336M)</p>
<ul>
<li>MD5: <code>fa31a570dc375a9fd2764b4723fad235</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH05-14.trimmed.megan_R2.fq.gz">20230730.mmag.CH05-14.trimmed.megan_R2.fq.gz</a> (341M)</p>
<ul>
<li>MD5: <code>99e636f1a2ebdd870d6f822901ceed61</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH05-21.trimmed.megan_R1.fq.gz">20230730.mmag.CH05-21.trimmed.megan_R1.fq.gz</a> (319M)</p>
<ul>
<li>MD5: <code>753d18733a2d9c041660d3b8c14c8f6e</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH05-21.trimmed.megan_R2.fq.gz">20230730.mmag.CH05-21.trimmed.megan_R2.fq.gz</a> (324M)</p>
<ul>
<li>MD5: <code>f5d38ef3d32b2e11a23ca6a46098b8e6</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH05-29.trimmed.megan_R1.fq.gz">20230730.mmag.CH05-29.trimmed.megan_R1.fq.gz</a> (350M)</p>
<ul>
<li>MD5: <code>383b33f41b1412d9dbf0dcc9457a305c</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH05-29.trimmed.megan_R2.fq.gz">20230730.mmag.CH05-29.trimmed.megan_R2.fq.gz</a> (360M)</p>
<ul>
<li>MD5: <code>9a910e7748d1aa92c8035df26c1cc42b</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH07-04.trimmed.megan_R1.fq.gz">20230730.mmag.CH07-04.trimmed.megan_R1.fq.gz</a> (193M)</p>
<ul>
<li>MD5: <code>370c7b651ff1cc7c1406123d831e7d64</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH07-04.trimmed.megan_R2.fq.gz">20230730.mmag.CH07-04.trimmed.megan_R2.fq.gz</a> (196M)</p>
<ul>
<li>MD5: <code>1574c16f21475c91aa21ae9f81426768</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH07-06.trimmed.megan_R1.fq.gz">20230730.mmag.CH07-06.trimmed.megan_R1.fq.gz</a> (262M)</p>
<ul>
<li>MD5: <code>9d44fc4c9f7a7c7df0125b6174613627</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH07-06.trimmed.megan_R2.fq.gz">20230730.mmag.CH07-06.trimmed.megan_R2.fq.gz</a> (265M)</p>
<ul>
<li>MD5: <code>ac41ebdd06208c728e1146839153b29e</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH07-08.trimmed.megan_R1.fq.gz">20230730.mmag.CH07-08.trimmed.megan_R1.fq.gz</a> (503M)</p>
<ul>
<li>MD5: <code>d8f891faeead968fa5b4fdb6a9c26d21</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH07-08.trimmed.megan_R2.fq.gz">20230730.mmag.CH07-08.trimmed.megan_R2.fq.gz</a> (513M)</p>
<ul>
<li>MD5: <code>98340e3ca008cf97fe240469b5c0f6f5</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH07-11.trimmed.megan_R1.fq.gz">20230730.mmag.CH07-11.trimmed.megan_R1.fq.gz</a> (349M)</p>
<ul>
<li>MD5: <code>8ffcad6e64dd7d1b12c1739767425ec1</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH07-11.trimmed.megan_R2.fq.gz">20230730.mmag.CH07-11.trimmed.megan_R2.fq.gz</a> (350M)</p>
<ul>
<li>MD5: <code>4b2673c0f02e48db0acbb847a4fb6dab</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH07-24.trimmed.megan_R1.fq.gz">20230730.mmag.CH07-24.trimmed.megan_R1.fq.gz</a> (378M)</p>
<ul>
<li>MD5: <code>cdd6d93b54fd40b135f4545474d9f837</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH07-24.trimmed.megan_R2.fq.gz">20230730.mmag.CH07-24.trimmed.megan_R2.fq.gz</a> (384M)</p>
<ul>
<li>MD5: <code>3229af42be57da29f13cad72f1f99523</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH09-02.trimmed.megan_R1.fq.gz">20230730.mmag.CH09-02.trimmed.megan_R1.fq.gz</a> (215M)</p>
<ul>
<li>MD5: <code>4328a6e6194fb6417dcc9cb61d3f0a72</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH09-02.trimmed.megan_R2.fq.gz">20230730.mmag.CH09-02.trimmed.megan_R2.fq.gz</a> (219M)</p>
<ul>
<li>MD5: <code>74c58ba1072a61ea3e75b83342589830</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH09-13.trimmed.megan_R1.fq.gz">20230730.mmag.CH09-13.trimmed.megan_R1.fq.gz</a> (263M)</p>
<ul>
<li>MD5: <code>a748a887a31a327d90bb80550c4e2e40</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH09-13.trimmed.megan_R2.fq.gz">20230730.mmag.CH09-13.trimmed.megan_R2.fq.gz</a> (265M)</p>
<ul>
<li>MD5: <code>7d81df73ba6dc5bbe3457bf973ede371</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH09-28.trimmed.megan_R1.fq.gz">20230730.mmag.CH09-28.trimmed.megan_R1.fq.gz</a> (191M)</p>
<ul>
<li>MD5: <code>67d2237f163289bc2b962e52c21562cc</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH09-28.trimmed.megan_R2.fq.gz">20230730.mmag.CH09-28.trimmed.megan_R2.fq.gz</a> (190M)</p>
<ul>
<li>MD5: <code>088a69aaf3371a0a6e16ab63e67146e2</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH10-08.trimmed.megan_R1.fq.gz">20230730.mmag.CH10-08.trimmed.megan_R1.fq.gz</a> (305M)</p>
<ul>
<li>MD5: <code>e61fb563e027256c0d45144bb3c89b78</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH10-08.trimmed.megan_R2.fq.gz">20230730.mmag.CH10-08.trimmed.megan_R2.fq.gz</a> (312M)</p>
<ul>
<li>MD5: <code>426403c8c8cb8275c84bdca3635b3186</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH10-11.trimmed.megan_R1.fq.gz">20230730.mmag.CH10-11.trimmed.megan_R1.fq.gz</a> (259M)</p>
<ul>
<li>MD5: <code>8e5dc9bc9d058b23cefec0e4d03f2cde</code></li>
</ul></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20230730.mmag-megan_reads20230730.mmag.CH10-11.trimmed.megan_R2.fq.gz">20230730.mmag.CH10-11.trimmed.megan_R2.fq.gz</a> (260M)</p>
<ul>
<li>MD5: <code>e894988fd6467f8263f40e5946e3fe88</code></li>
</ul></li>
</ul>


</section>
</section>

 ]]></description>
  <category>2023</category>
  <category>DuMOAR</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-07-30-Read-Extractions---M.magister-MEGAN-FastA-to-FastQ-Arthropoda-and-Unassigned-Reads/index.html</guid>
  <pubDate>Sun, 30 Jul 2023 22:25:00 GMT</pubDate>
</item>
<item>
  <title>DIAMOND BLASTx - C.virginica Genes on Mox</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-07-27-DIAMOND-BLASTx---C.virginica-Genes-on-Mox/index.html</link>
  <description><![CDATA[ 




<p>As part of annotating Ballgown transcripts for this project, <a href="https://robertslab.github.io/sams-notebook/posts/2023/2023-07-26-Data-Wrangling---C.virginica-Genes-Only-FastA-from-Genes-BED-File-Using-gffread-on-Raven/">I generated a genes FastA file on 20230726</a> (notebook entry). The next aspect of the annotation process was to BLASTx the genes to get SwissProt IDs, and, eventually gene ontology (GO) terms/IDs. To get SwissProt IDs, the genes were <a href="https://github.com/bbuchfink/diamond"><code>DIAMOND</code></a> BLASTx’d against a Swiss/UniProt database of reviewed proteins (downloaded 20230727). The job was run on Mox.</p>
<p>SLURM script (GitHub):</p>
<ul>
<li><a href="https://github.com/RobertsLab/sams-notebook/blob/master/sbatch_scripts/20230727-cvir-diamond-blastx-GCF_002022765.2_C_virginica-3.0-genes.sh">20230727-cvir-diamond-blastx-GCF_002022765.2_C_virginica-3.0-genes.sh</a></li>
</ul>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Job Name</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --job-name=20230727-cvir-diamond-blastx-GCF_002022765.2_C_virginica-3.0-genes</span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Allocation Definition</span></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --account=srlab</span></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --partition=srlab</span></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Resources</span></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Nodes</span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --nodes=1</span></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Walltime (days-hours:minutes:seconds format)</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --time=10-00:00:00</span></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Memory per node</span></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mem=500G</span></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##turn on e-mail notification</span></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-type=ALL</span></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-user=samwhite@uw.edu</span></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Specify the working directory for this job</span></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --chdir=/gscratch/scrubbed/samwhite/outputs/20230727-cvir-diamond-blastx-GCF_002022765.2_C_virginica-3.0-genes</span></span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### DIAMOND BLASTx of C.virginica GCF_002022765.2_C_virginica-3.0-genes.fasta.</span></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### For use in CEABIGR transcript annotation.</span></span>
<span id="cb1-22"></span>
<span id="cb1-23"></span>
<span id="cb1-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################</span></span>
<span id="cb1-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># These variables need to be set by user</span></span>
<span id="cb1-26"></span>
<span id="cb1-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Exit script if any command fails</span></span>
<span id="cb1-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span></span>
<span id="cb1-29"></span>
<span id="cb1-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load Python Mox module for Python module availability</span></span>
<span id="cb1-31"></span>
<span id="cb1-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load intel-python3_2017</span>
<span id="cb1-33"></span>
<span id="cb1-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># SegFault fix?</span></span>
<span id="cb1-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">THREADS_DAEMON_MODEL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb1-36"></span>
<span id="cb1-37"></span>
<span id="cb1-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Programs array</span></span>
<span id="cb1-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">declare</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span></span>
<span id="cb1-40"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb1-41"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>diamond<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/programs/diamond-v2.1.1/diamond"</span></span>
<span id="cb1-42"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-43"></span>
<span id="cb1-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># DIAMOND UniProt database</span></span>
<span id="cb1-45"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dmnd_db</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/blastdbs/20230727-uniprot-swissprot-reviewed/uniprot_sprot.dmnd"</span></span>
<span id="cb1-46"></span>
<span id="cb1-47"></span>
<span id="cb1-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Genome (FastA)</span></span>
<span id="cb1-49"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fasta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/sam/data/C_virginica/genomes/GCF_002022765.2_C_virginica-3.0-genes.fasta"</span></span>
<span id="cb1-50"></span>
<span id="cb1-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################</span></span>
<span id="cb1-52"></span>
<span id="cb1-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Strip leading pat and extensions</span></span>
<span id="cb1-54"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">no_path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fasta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-55"></span>
<span id="cb1-56"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Strip extension</span></span>
<span id="cb1-57"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">no_ext</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${no_path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>.<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-58"></span>
<span id="cb1-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run DIAMOND with blastx</span></span>
<span id="cb1-60"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>diamond<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> blastx <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-61">--db <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${dmnd_db}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-62">--query <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fasta}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-63">--out <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${no_ext}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.blastx.outfmt6 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-64">--outfmt 6 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-65">--sensitive <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-66">--evalue 1e-25 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-67">--max-target-seqs 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-68">--block-size 15.0 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-69">--index-chunks 4</span>
<span id="cb1-70"></span>
<span id="cb1-71"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate checksums for future reference</span></span>
<span id="cb1-72"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb1-73"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span>
<span id="cb1-74">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-75">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Generating checksum for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">."</span></span>
<span id="cb1-76">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-77"></span>
<span id="cb1-78">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--append</span> checksums.md5</span>
<span id="cb1-79">  </span>
<span id="cb1-80">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-81"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span>
<span id="cb1-82"></span>
<span id="cb1-83"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Generating checksum for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fasta}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">."</span></span>
<span id="cb1-84"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-85"></span>
<span id="cb1-86"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fasta}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--append</span> checksums.md5</span>
<span id="cb1-87"></span>
<span id="cb1-88"></span>
<span id="cb1-89"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################</span></span>
<span id="cb1-90"></span>
<span id="cb1-91"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Disable exit on error</span></span>
<span id="cb1-92"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> +e</span>
<span id="cb1-93"></span>
<span id="cb1-94"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Capture program options</span></span>
<span id="cb1-95"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-gt</span> 0 <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-96">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Logging program options..."</span></span>
<span id="cb1-97">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> program <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-98">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span>
<span id="cb1-99">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-100">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Program options for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">: "</span></span>
<span id="cb1-101">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-102">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle samtools help menus</span></span>
<span id="cb1-103">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_index"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-104">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_sort"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-105">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_view"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span></span>
<span id="cb1-106">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-107">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-108"></span>
<span id="cb1-109">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle DIAMOND BLAST menu</span></span>
<span id="cb1-110">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"diamond"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-111">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> help</span>
<span id="cb1-112"></span>
<span id="cb1-113">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle NCBI BLASTx menu</span></span>
<span id="cb1-114">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blastx"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-115">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-help</span></span>
<span id="cb1-116">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb1-117">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-h</span></span>
<span id="cb1-118">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-119">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-120">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"----------------------------------------------"</span></span>
<span id="cb1-121">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-122">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-123">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&gt;&gt;</span> program_options.log <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb1-124"></span>
<span id="cb1-125">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If MultiQC is in programs_array, copy the config file to this directory.</span></span>
<span id="cb1-126">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"multiqc"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-127">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cp</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--preserve</span> ~/.multiqc_config.yaml multiqc_config.yaml</span>
<span id="cb1-128">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb1-129">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span>
<span id="cb1-130"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb1-131"></span>
<span id="cb1-132"></span>
<span id="cb1-133"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Document programs in PATH (primarily for program version ID)</span></span>
<span id="cb1-134"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-135"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">date</span></span>
<span id="cb1-136"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-137"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"System PATH for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$SLURM_JOB_ID</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-138"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-139"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%0.s-"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">..</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-140"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${PATH}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tr</span> : <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\\</span>n</span>
<span id="cb1-141"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> system_path.log</span></code></pre></div>
<hr>
<section id="results" class="level1">
<h1>RESULTS</h1>
<p>Run time was ridiculously fast (1min 30secs):</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-07-27-DIAMOND-BLASTx---C.virginica-Genes-on-Mox/https:/github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20230727-cvir-diamond-blastx-GCF_002022765.2_C_virginica-3.0-genes-runtime.png?raw=true" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Screencap of Mox job runtime showing a duration of 1min 30secs</figcaption>
</figure>
</div>
<p>Of note, out of 38,838 sequences, only 5,869 resulted in matches.</p>
<p>Output folder:</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/20230727-cvir-diamond-blastx-GCF_002022765.2_C_virginica-3.0-genes/">20230727-cvir-diamond-blastx-GCF_002022765.2_C_virginica-3.0-genes/</a></li>
</ul>
<section id="diamond-blastx-output-text-blast-output-format-6" class="level4">
<h4 class="anchored" data-anchor-id="diamond-blastx-output-text-blast-output-format-6">DIAMOND BLASTx Output (text; BLAST output format 6)</h4>
<ul>
<li><p>[GCF_002022765.2_C_virginica-3.0-genes.blastx.outfmt6](- <a href="https://gannet.fish.washington.edu/Atumefaciens/20230727-cvir-diamond-blastx-GCF_002022765.2_C_virginica-3.0-genes/GCF_002022765.2_C_virginica-3.0-genes.blastx.outfmt6">GCF_002022765.2_C_virginica-3.0-genes.blastx.outfmt6</a> (488K)</p>
<ul>
<li>MD5: <code>408f80aad2b4b9872418c4ebbdc0006d</code>)</li>
</ul></li>
</ul>


</section>
</section>

 ]]></description>
  <category>2023</category>
  <category>CEABIGR</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-07-27-DIAMOND-BLASTx---C.virginica-Genes-on-Mox/index.html</guid>
  <pubDate>Fri, 28 Jul 2023 04:00:00 GMT</pubDate>
</item>
</channel>
</rss>
