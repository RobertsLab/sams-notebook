<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Sam&#39;s Notebook</title>
<link>https://robertslab.github.io/sams-notebook/index.html</link>
<atom:link href="https://robertslab.github.io/sams-notebook/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.3.450</generator>
<lastBuildDate>Tue, 19 Mar 2024 07:00:00 GMT</lastBuildDate>
<item>
  <title>Reverse Transcription - C.gigas Lifestage Carryover Seed and Spat</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-03-19-Reverse-Transcription---C.gigas-Lifestage-Carryover-Seed-and-Spat/index.html</link>
  <description><![CDATA[ 




<section id="intro" class="level1">
<h1>INTRO</h1>
<p>After isolating RNA <a href="../../../posts/2024/2024-03-19-RNA-Isolation---C.gigas-Lifestage-Carryover-Seed-and-Spat/index.html">earlier today</a> (Notebook) for the <a href="../../../../project-gigas-carryover/lifestage_carryover/"><code>project-gigas-carryover/lifestage_carryover</code></a> (GitHub repo), I proceeded with reverse transcription for those samples with sufficient yields of RNA.</p>
</section>
<section id="materials-methods" class="level1">
<h1>MATERIALS &amp; METHODS</h1>
<p>Reverse transcription was run using 100ng of each sample, using M-MLV reverse transcriptase (Promega) and oligo dT primers (Promega), according to the <a href="../../../../resources/protocols/Commercial_Protocols/Promega_MMLV_RT.pdf">manufacturer’s protocol</a> (PDF). Oligo dT primers and M-MLV reverse transcriptase amounts were adjusted to maintain the proper ratio, relative to the amount of input RNA.</p>
<section id="calculations" class="level2">
<h2 class="anchored" data-anchor-id="calculations">Calculations:</h2>
<ul>
<li><a href="https://docs.google.com/spreadsheets/d/1b8Dh9winK2Q_3SVx-E1EnYkeyjDga3tWWNRCE_nEPmQ/edit?usp=sharing">20240319-cgig-carryover-spat-seed-cDNA-calcs</a> (Google Sheet)</li>
</ul>
</section>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<p>cDNA was stored in the -20<sup>o</sup>C freezer in FTR 213.</p>
<p>Box layout:</p>
<ul>
<li><a href="https://docs.google.com/spreadsheets/d/1dH1nrwITQwoYXUFSNx0-dHIjquq_Pde11pJ3Hz7K1Xc/edit#gid=1927399671">Lifestage Carryover C.gigas cDNA Box 1</a></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-03-19-Reverse-Transcription---C.gigas-Lifestage-Carryover-Seed-and-Spat/20240319-cDNA-box.jpg" class="img-fluid figure-img" alt="Box with blue label: Lifestage Carryover, C.gigas cDNA Box #1"></p>
<figcaption class="figure-caption">Box with blue label: “Lifestage Carryover, C.gigas cDNA Box #1”</figcaption>
</figure>
</div>


</section>

 ]]></description>
  <category>reverse transcription</category>
  <category>Lifestage carryover</category>
  <category>Crassostrea gigas</category>
  <category>Pacific oyster</category>
  <category>cDNA</category>
  <category>M-MLV</category>
  <category>2024</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-03-19-Reverse-Transcription---C.gigas-Lifestage-Carryover-Seed-and-Spat/index.html</guid>
  <pubDate>Tue, 19 Mar 2024 07:00:00 GMT</pubDate>
</item>
<item>
  <title>RNA Isolation - C.gigas Lifestage Carryover Seed and Spat</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-03-19-RNA-Isolation---C.gigas-Lifestage-Carryover-Seed-and-Spat/index.html</link>
  <description><![CDATA[ 




<section id="intro" class="level1">
<h1>INTRO</h1>
<p>I was <a href="https://github.com/RobertsLab/resources/issues/1844#issuecomment-1998021805">asked to isolate RNA from a list of samples</a> (GitHub Issue) from a number of <a href="http://en.wikipedia.org/wiki/Pacific_oyster"><em>Crassostrea gigas</em> (Pacific oyster)</a> spat and seed that had been collected as part of the <a href="https://github.com/RobertsLab/project-gigas-carryover/tree/main/lifestage_carryover"><code>project-gigas-carryover</code></a> (GitHub repo).</p>
</section>
<section id="materials-methods" class="level1">
<h1>MATERIALS &amp; METHODS</h1>
<p>Oysters had been previously preserved in RNAlater (Ambion), supernatant removed, and then frozen @ -80<sup>o</sup>C. All samples were treated in the following fashion (12 spat were processed, followed by 12 seed samples.). Here’s the full <a href="https://github.com/RobertsLab/project-gigas-carryover/blob/82f1a4bcd5e2ce80cea9916f271bf1d54f740bd1/lifestage_carryover/data/sampling_metadata/20240314_rna_extractions.csv">list of samples</a> (GitHub; commit <code>82f1a4b</code>).</p>
<section id="rna-isolation" class="level2">
<h2 class="anchored" data-anchor-id="rna-isolation">RNA Isolation</h2>
<p>RNA isolations were conducted using the Directzol RNA Miniprep Kit (ZymoResearch).</p>
<ul>
<li><p>Added 350uL of TriReagent (ZymoResearch) to existing 1.5mL tubes containing the sample.</p></li>
<li><p>Homogenized using disposble pestles.</p></li>
<li><p>Centrigured at 21,000g to pellet insoluble material.</p></li>
<li><p>Transferred 325uL of homogenate to a 1.5mL tube.</p></li>
<li><p>Added 325uL (i.e.&nbsp;equal volume) of 100% ethanol to homogenate and vortexed.</p></li>
<li><p>Transferred solution to spin columns.</p></li>
<li><p>Followed kit protocol, including DNase step.</p></li>
<li><p>Elutions:</p>
<ul>
<li>Spat: 50uL of H<sub>2</sub>.</li>
<li>Seed: 100uL of H<sub>2</sub>.</li>
</ul></li>
</ul>
<p>Samples were temporarily stored on ice for quantificaiton and reverse transcription.</p>
</section>
<section id="rna-quantification" class="level2">
<h2 class="anchored" data-anchor-id="rna-quantification">RNA Quantification</h2>
<p>RNA was quantified with the Roberts Lab Qubit 3.0 fluorometer (Invitrogen). Samples were quantified with either the Qubit RNA Broad Range (BR) asssay (Invitrogen) or, if a sample had insufficient concentrations of RNA to be detected, with the High Sensitivity (HS) assay (Invitrogen). 1uL of sample was used for the assay(s).</p>
</section>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<p>Raw Qubit data is here:</p>
<ul>
<li><a href="../../../../project-gigas-carryover/lifestage_carryover/data/qubit/20240319-cgig-qubit-carryover-spat-seed.csv"><code>20240319-cgig-qubit-carryover-spat-seed.csv</code></a></li>
</ul>
<p>The following spat samples didn’t yield any RNA:</p>
<ul>
<li>262</li>
<li>274</li>
</ul>
<p>The following seed samples didn’t yield any RNA:</p>
<ul>
<li>211</li>
<li>234</li>
<li>256</li>
<li>264</li>
<li>266</li>
</ul>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>The seed samples consisted of large quantities of tissue, which I think caused issues with the TriReagent extraction. This resulted in some strange results after homogenization and centfiguation. Many of them appeared to separate into phases (a dark red top phase and a clear bottom phase). Additionally, after combining with ethanol, there were large quantities of precipitate in most of the samples; these precipitates were <em>not</em> transferred to columns. The red phase still contained a lot of insoluble material, which possibly clogged columns and inhibited RNA binding.</p>
</div>
</div>
<p>Overall, it would seem that going forward, a significantly large quantity of TriReagent should be used and/or taking a section of the sample (instead of the entire sample) might be warranted. In regards to the latter, I’m not sure if this is desirable, as these are whole oysters and I’m not certain what the implications for comparative transcriptomics would be if using only a portion of the oyster.</p>
<p>Next up, create some cDNA…</p>


</section>

 ]]></description>
  <category>RNA isolation</category>
  <category>Crassostrea gigas</category>
  <category>Lifestage carryover</category>
  <category>Pacific oyster</category>
  <category>2024</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-03-19-RNA-Isolation---C.gigas-Lifestage-Carryover-Seed-and-Spat/index.html</guid>
  <pubDate>Tue, 19 Mar 2024 07:00:00 GMT</pubDate>
</item>
<item>
  <title>SRA Submission - CEABIGR WGBS and RNA-seq</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-03-18-SRA-Submission---CEABIGR-WGBS-and-RNA-seq/index.html</link>
  <description><![CDATA[ 







 ]]></description>
  <category>SRA</category>
  <category>CEABIGR</category>
  <category>Crassostrea virginica</category>
  <category>Eastern oyster</category>
  <category>RNAseq</category>
  <category>WGBS</category>
  <category>2024</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-03-18-SRA-Submission---CEABIGR-WGBS-and-RNA-seq/index.html</guid>
  <pubDate>Mon, 18 Mar 2024 07:00:00 GMT</pubDate>
</item>
<item>
  <title>Resazurin - C.gigas Second Trial</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-03-12-Resazurin---C.gigas-Second-Trial/index.html</link>
  <description><![CDATA[ 




<section id="intro" class="level1">
<h1>INTRO</h1>
<p><a href="../../../posts/2024/2024-03-08-Resazurin---Preliminary-Respiration-Test-Using-C.gigas/index.html">After running the initial resazuring test on 20240308</a> (Notebook), Steven/Ariana <a href="https://github.com/RobertsLab/resources/issues/1842">asked that I run another trial</a> (GitHub Issue). This second trial was designed to get some baseline respiration from a set of oysters, followed by a heat stress at 35<sup>o</sup>C.</p>
<p>For this initial test, I followed the <a href="https://github.com/RobertsLab/project-gigas-carryover/blob/27441a713dfe68578758103bb82dd4dca4b4c091/protocols/Resazurin-assay.md">resazurin assay</a> (commit 27441a7) shared by Steven, with the following modifications:</p>
<ul>
<li><p>Non-sterile water/sea water was used.</p></li>
<li><p>No penn/strep/Fungizone used.</p></li>
</ul>
<section id="procedure" class="level2">
<h2 class="anchored" data-anchor-id="procedure">Procedure</h2>
<section id="pre-stress" class="level3">
<h3 class="anchored" data-anchor-id="pre-stress">Pre-stress</h3>
<p>A total of nine small oysters were weighed, measured (using analog calipers). Two larger oyters were also weighed/measured and placed in their own glass Petri dishes. Fresh resazuring assay media was prepared. Two milliliters was added to 11 wells of the 12-well plate - the final position (<code>C04</code>) was left empty. Twenty milliliters was added to each Petri dish. These volumes ensured that the oysters would be submerged when added.</p>
<p>Fluorescence was measured on a Victor<sup>3</sup> plate reader immediatley after adding resazurin assay media to the plate and dishes. The oysters were then distributed/added to the 12-well plate and dishes. Fluorescence was measured again after 0.5 and 1.0hrs. To measure the dishes, 2mL of assay media was transferred to wells <code>A01</code> and <code>A02</code> of a clean 12-well plate (the smaller of the two oysters in <code>A01</code>).</p>
</section>
<section id="heat-stress-35oc." class="level3">
<h3 class="anchored" data-anchor-id="heat-stress-35oc.">Heat stress @ 35<sup>o</sup>C.</h3>
<p>As before, a fresh batch of resazurin assay media was made and distributed in a 12-well plate and two glass Petri dishes. The plate and the dishes were warmed at 35<sup>o</sup>C in a warm air incubator (Barnstead) for 45mins. The 12-well plate was covered; the Petri dishes were not. Fluorescence was measured on a Victor<sup>3</sup> plate reader immediately before transferring oysters to the plate and dishes.</p>
<p>Oysters were transferred from the pre-stress plate/dishes to the pre-warmed plate/dishes. Fluorescence was measured again after 0.5 and 1.0hrs. To measure the dishes, 2mL of assay media was transferred to wells <code>A01</code> and <code>A02</code> of a clean 12-well plate (the smaller of the two oysters in <code>A01</code>).</p>
</section>
<section id="plate-layout" class="level3">
<h3 class="anchored" data-anchor-id="plate-layout">Plate layout</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-03-12-Resazurin---C.gigas-Second-Trial/20240312-cgig-12_well-dishes-with_ruler.jpg" class="img-fluid figure-img" alt="Oysters in 12-well plate, a ruler, and oysters in two glass Petri dishes."></p>
<figcaption class="figure-caption">Oysters in 12-well plate, a ruler, and oysters in two glass Petri dishes.</figcaption>
</figure>
</div>
</section>
</section>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<section id="output-files" class="level2">
<h2 class="anchored" data-anchor-id="output-files">Output files</h2>
<p>All files have been deposited in the <a href="https://github.com/RobertsLab/project-gigas-carryover/tree/main/lifestage_carryover/data/resazurin_trial_02"><code>project-gigas-carryover</code> repo</a>. Please visit that link to obtain files, as well as view the <a href="https://github.com/RobertsLab/project-gigas-carryover/tree/main/lifestage_carryover/data/resazurin_trial_02/REAMDE.md"><code>REAMDE.md</code> file</a> for descriptions of each file.</p>
<p>All measurements were compiled in the following file:</p>
<ul>
<li><a href="https://github.com/RobertsLab/project-gigas-carryover/blob/04a64e3bd45487b5cd631f5817937d3cd4318e70/lifestage_carryover/data/resazurin_trial_02/20240312-cgig-resazurin-trial-02.csv"><code>20240312-cgig-resazurin-trial-02.csv</code></a> (CSV; commit <code>a2398b0</code>)</li>
</ul>
</section>
<section id="analysis" class="level2">
<h2 class="anchored" data-anchor-id="analysis">Analysis</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Data frame links to commit <code>a2398b0</code>.</p>
</div>
</div>
<section id="read-in-20240312-cgig-resazurin-trial-02.csv" class="level3">
<h3 class="anchored" data-anchor-id="read-in-20240312-cgig-resazurin-trial-02.csv">Read in <code>20240312-cgig-resazurin-trial-02.csv</code></h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">resazurin.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/RobertsLab/project-gigas-carryover/a2398b08c839035df3c8924b12de55e2d91d8824/lifestage_carryover/data/resazurin_trial_02/20240312-cgig-resazurin-trial-02.csv"</span>,</span>
<span id="cb1-2"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb1-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>)</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(resazurin.df)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   28 obs. of  10 variables:
 $ well     : chr  "A01" "A02" "A03" "A04" ...
 $ sample   : chr  "oyster-01" "oyster-02" "oyster-03" "oyster-04" ...
 $ weight.mg: num  403.2 235.6 112.4 34.9 21.6 ...
 $ length.mm: num  17.71 11.51 10.46 7.35 5.25 ...
 $ width.mm : num  12.51 10.46 7.35 4.21 5.27 ...
 $ depth.mm : num  5.24 3.18 3.16 2.14 1.12 2.12 3.15 4.21 2.15 NA ...
 $ treatment: chr  "pre-stress" "pre-stress" "pre-stress" "pre-stress" ...
 $ t0       : int  10932 10328 10841 11549 10812 11027 11106 11347 11430 11549 ...
 $ t0.5     : int  17076 16051 11742 11349 10475 12125 11819 14929 12076 11478 ...
 $ t1.0     : int  22549 19028 13454 12211 11330 13679 12397 17741 12320 11666 ...</code></pre>
</div>
</div>
</section>
<section id="reshape-the-data-from-wide-to-long-format" class="level3">
<h3 class="anchored" data-anchor-id="reshape-the-data-from-wide-to-long-format">Reshape the data from wide to long format</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">resazurin_data_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> resazurin.df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(t0, t0<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>, t1<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.0</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time_point"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A590"</span>)</span></code></pre></div>
</details>
</div>
<section id="pre-stress-1" class="level4">
<h4 class="anchored" data-anchor-id="pre-stress-1">Pre-stress</h4>
<section id="plot-pre-stress-raw-flourescence" class="level5">
<h5 class="anchored" data-anchor-id="plot-pre-stress-raw-flourescence">Plot pre-stress raw flourescence</h5>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter the data for treatment == "pre-stress"</span></span>
<span id="cb4-2">pre_stress_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">subset</span>(resazurin_data_long, treatment <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pre-stress"</span>)</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get unique sample names</span></span>
<span id="cb4-5">unique_samples <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(pre_stress_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>sample)</span>
<span id="cb4-6"></span>
<span id="cb4-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define colors for unique samples</span></span>
<span id="cb4-8">sample_colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^neg-control"</span>, unique_samples), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rainbow</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(unique_samples)))</span>
<span id="cb4-9"></span>
<span id="cb4-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a named vector for color mapping</span></span>
<span id="cb4-11">sample_color_mapping <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setNames</span>(sample_colors, unique_samples)</span>
<span id="cb4-12"></span>
<span id="cb4-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the dot plot</span></span>
<span id="cb4-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(pre_stress_data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> time_point, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> A590, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> sample)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> sample), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set linetype to solid</span></span>
<span id="cb4-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> sample_color_mapping) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time Point"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A590"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-03-12-Resazurin---C.gigas-Second-Trial/index_files/figure-html/plot-pre-stress-raw-fluorescence-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="plot-pre-stress-control-subtracted-fluorescence" class="level5">
<h5 class="anchored" data-anchor-id="plot-pre-stress-control-subtracted-fluorescence">Plot pre-stress control-subtracted fluorescence</h5>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 1: Calculate the mean of A590 for each time point for "pre-stress" samples beginning with "neg-control"</span></span>
<span id="cb5-2">neg_control_means <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pre_stress_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^neg-control"</span>, sample)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(time_point) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_A590 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(A590))</span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 2: Subtract the mean calculated in step 1 from each corresponding time point for other samples</span></span>
<span id="cb5-8">adjusted_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pre_stress_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(neg_control_means, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time_point"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">adjusted_A590 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(mean_A590), A590 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> mean_A590, A590))</span>
<span id="cb5-11"></span>
<span id="cb5-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 3: Filter out values from samples "empty" and samples beginning with "neg-control"</span></span>
<span id="cb5-13">adjusted_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> adjusted_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^empty|^neg-control"</span>, sample))</span>
<span id="cb5-15"></span>
<span id="cb5-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 4: Create a dot plot using the adjusted values</span></span>
<span id="cb5-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(adjusted_data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> time_point, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> adjusted_A590, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> sample)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> sample), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time Point"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Adjusted A590"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-03-12-Resazurin---C.gigas-Second-Trial/index_files/figure-html/prestress-control-adjusted-fluorescence-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="heat-stress-35oc" class="level3">
<h3 class="anchored" data-anchor-id="heat-stress-35oc">Heat stress @ 35<sup>o</sup>C</h3>
<section id="plot-heat-stress-raw-flourescence" class="level5">
<h5 class="anchored" data-anchor-id="plot-heat-stress-raw-flourescence">Plot heat stress raw flourescence</h5>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter the data for treatment == "pre-stress"</span></span>
<span id="cb6-2">heat_stress_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">subset</span>(resazurin_data_long, treatment <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"heat_stress"</span>)</span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get unique sample names</span></span>
<span id="cb6-5">unique_samples <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(heat_stress_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>sample)</span>
<span id="cb6-6"></span>
<span id="cb6-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define colors for unique samples</span></span>
<span id="cb6-8">sample_colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^neg-control"</span>, unique_samples), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rainbow</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(unique_samples)))</span>
<span id="cb6-9"></span>
<span id="cb6-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a named vector for color mapping</span></span>
<span id="cb6-11">sample_color_mapping <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setNames</span>(sample_colors, unique_samples)</span>
<span id="cb6-12"></span>
<span id="cb6-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the dot plot</span></span>
<span id="cb6-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(heat_stress_data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> time_point, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> A590, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> sample)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> sample), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set linetype to solid</span></span>
<span id="cb6-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> sample_color_mapping) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time Point"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A590"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-03-12-Resazurin---C.gigas-Second-Trial/index_files/figure-html/plot-heat-stress-raw-fluorescence-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="plot-heat-stress-control-subtracted-fluorescence" class="level5">
<h5 class="anchored" data-anchor-id="plot-heat-stress-control-subtracted-fluorescence">Plot heat stress control-subtracted fluorescence</h5>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 1: Calculate the mean of A590 for each time point for "pre-stress" samples beginning with "neg-control"</span></span>
<span id="cb7-2">neg_control_means <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> heat_stress_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^neg-control"</span>, sample)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(time_point) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_A590 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(A590))</span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 2: Subtract the mean calculated in step 1 from each corresponding time point for other samples</span></span>
<span id="cb7-8">adjusted_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> heat_stress_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(neg_control_means, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time_point"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">adjusted_A590 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(mean_A590), A590 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> mean_A590, A590))</span>
<span id="cb7-11"></span>
<span id="cb7-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 3: Filter out values from samples "empty" and samples beginning with "neg-control"</span></span>
<span id="cb7-13">adjusted_data_filtered <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> adjusted_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^empty|^neg-control"</span>, sample))</span>
<span id="cb7-15"></span>
<span id="cb7-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 4: Create a dot plot using the adjusted values</span></span>
<span id="cb7-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(adjusted_data_filtered, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> time_point, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> adjusted_A590, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> sample)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> sample), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time Point"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Adjusted A590"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-03-12-Resazurin---C.gigas-Second-Trial/index_files/figure-html/plot-heat-stress-control-adjusted-fluorescence-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="combined-bar-plot" class="level3">
<h3 class="anchored" data-anchor-id="combined-bar-plot">Combined bar plot</h3>
<section id="calculate-the-mean-of-a590-for-each-time-point-for-pre-stress-samples-beginning-with-neg-control" class="level4">
<h4 class="anchored" data-anchor-id="calculate-the-mean-of-a590-for-each-time-point-for-pre-stress-samples-beginning-with-neg-control">Calculate the mean of A590 for each time point for “pre-stress” samples beginning with “neg-control”</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 1: Calculate the mean of A590 for each time point for "pre-stress" samples beginning with "neg-control"</span></span>
<span id="cb8-2">neg_control_means <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> resazurin_data_long <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^neg-control"</span>, sample)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(time_point) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_A590 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(A590))</span>
<span id="cb8-6"></span>
<span id="cb8-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(neg_control_means)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [3 × 2] (S3: tbl_df/tbl/data.frame)
 $ time_point: chr [1:3] "t0" "t0.5" "t1.0"
 $ mean_A590 : num [1:3] 11096 11306 11566</code></pre>
</div>
</div>
</section>
<section id="subtract-negative-controls" class="level4">
<h4 class="anchored" data-anchor-id="subtract-negative-controls">Subtract negative controls</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Subtract the mean calculated in step 1 from each corresponding time point for other samples</span></span>
<span id="cb10-2">adjusted_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> resazurin_data_long <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(neg_control_means, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time_point"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">adjusted_A590 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(mean_A590), A590 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> mean_A590, A590))</span>
<span id="cb10-5"></span>
<span id="cb10-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(adjusted_data)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [84 × 11] (S3: tbl_df/tbl/data.frame)
 $ well         : chr [1:84] "A01" "A01" "A01" "A02" ...
 $ sample       : chr [1:84] "oyster-01" "oyster-01" "oyster-01" "oyster-02" ...
 $ weight.mg    : num [1:84] 403 403 403 236 236 ...
 $ length.mm    : num [1:84] 17.7 17.7 17.7 11.5 11.5 ...
 $ width.mm     : num [1:84] 12.5 12.5 12.5 10.5 10.5 ...
 $ depth.mm     : num [1:84] 5.24 5.24 5.24 3.18 3.18 3.18 3.16 3.16 3.16 2.14 ...
 $ treatment    : chr [1:84] "pre-stress" "pre-stress" "pre-stress" "pre-stress" ...
 $ time_point   : chr [1:84] "t0" "t0.5" "t1.0" "t0" ...
 $ A590         : int [1:84] 10932 17076 22549 10328 16051 19028 10841 11742 13454 11549 ...
 $ mean_A590    : num [1:84] 11096 11306 11566 11096 11306 ...
 $ adjusted_A590: num [1:84] -164 5770 10983 -768 4745 ...</code></pre>
</div>
</div>
</section>
<section id="filter-for-desired-data" class="level4">
<h4 class="anchored" data-anchor-id="filter-for-desired-data">Filter for desired data</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter out values from samples "empty" and samples beginning with "neg-control"</span></span>
<span id="cb12-2">adjusted_data_filtered <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> adjusted_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^empty|^neg-control"</span>, sample))</span>
<span id="cb12-4"></span>
<span id="cb12-5"></span>
<span id="cb12-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter data for "pre-stress" and "heat_stress" treatments</span></span>
<span id="cb12-7">filtered_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> adjusted_data_filtered <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(treatment <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pre-stress"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"heat_stress"</span>))</span>
<span id="cb12-9"></span>
<span id="cb12-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(filtered_data)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [66 × 11] (S3: tbl_df/tbl/data.frame)
 $ well         : chr [1:66] "A01" "A01" "A01" "A02" ...
 $ sample       : chr [1:66] "oyster-01" "oyster-01" "oyster-01" "oyster-02" ...
 $ weight.mg    : num [1:66] 403 403 403 236 236 ...
 $ length.mm    : num [1:66] 17.7 17.7 17.7 11.5 11.5 ...
 $ width.mm     : num [1:66] 12.5 12.5 12.5 10.5 10.5 ...
 $ depth.mm     : num [1:66] 5.24 5.24 5.24 3.18 3.18 3.18 3.16 3.16 3.16 2.14 ...
 $ treatment    : chr [1:66] "pre-stress" "pre-stress" "pre-stress" "pre-stress" ...
 $ time_point   : chr [1:66] "t0" "t0.5" "t1.0" "t0" ...
 $ A590         : int [1:66] 10932 17076 22549 10328 16051 19028 10841 11742 13454 11549 ...
 $ mean_A590    : num [1:66] 11096 11306 11566 11096 11306 ...
 $ adjusted_A590: num [1:66] -164 5770 10983 -768 4745 ...</code></pre>
</div>
</div>
</section>
<section id="pivot-the-data-to-have-separate-columns-for-t0-and-t1.0" class="level4">
<h4 class="anchored" data-anchor-id="pivot-the-data-to-have-separate-columns-for-t0-and-t1.0">Pivot the data to have separate columns for “t0” and “t1.0”</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">pivoted_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> filtered_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(time_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t0"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t1.0"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(sample, time_point, treatment) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">adjusted_A590 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">first</span>(adjusted_A590)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> time_point, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> adjusted_A590)</span>
<span id="cb14-6"></span>
<span id="cb14-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(pivoted_data)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>gropd_df [22 × 4] (S3: grouped_df/tbl_df/tbl/data.frame)
 $ sample   : chr [1:22] "big-oyster" "big-oyster" "bigger-oyster" "bigger-oyster" ...
 $ treatment: chr [1:22] "heat_stress" "pre-stress" "heat_stress" "pre-stress" ...
 $ t0       : num [1:22] -462 454 -440 450 -4180 ...
 $ t1.0     : num [1:22] 14629 10739 5085 4876 4092 ...
 - attr(*, "groups")= tibble [11 × 2] (S3: tbl_df/tbl/data.frame)
  ..$ sample: chr [1:11] "big-oyster" "bigger-oyster" "oyster-01" "oyster-02" ...
  ..$ .rows : list&lt;int&gt; [1:11] 
  .. ..$ : int [1:2] 1 2
  .. ..$ : int [1:2] 3 4
  .. ..$ : int [1:2] 5 6
  .. ..$ : int [1:2] 7 8
  .. ..$ : int [1:2] 9 10
  .. ..$ : int [1:2] 11 12
  .. ..$ : int [1:2] 13 14
  .. ..$ : int [1:2] 15 16
  .. ..$ : int [1:2] 17 18
  .. ..$ : int [1:2] 19 20
  .. ..$ : int [1:2] 21 22
  .. ..@ ptype: int(0) 
  ..- attr(*, ".drop")= logi TRUE</code></pre>
</div>
</div>
</section>
<section id="calculate-the-difference-in-a590-between-t0-and-t1.0-normalized-by-weight" class="level4">
<h4 class="anchored" data-anchor-id="calculate-the-difference-in-a590-between-t0-and-t1.0-normalized-by-weight">Calculate the difference in A590 between “t0” and “t1.0” normalized by weight</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">difference_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pivoted_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb16-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(filtered_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb16-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(sample, weight.mg, treatment), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sample"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"treatment"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb16-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">difference =</span> (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t1.0</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t0</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> weight.mg)</span>
<span id="cb16-5"></span>
<span id="cb16-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(difference_data)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>gropd_df [66 × 6] (S3: grouped_df/tbl_df/tbl/data.frame)
 $ sample    : chr [1:66] "big-oyster" "big-oyster" "big-oyster" "big-oyster" ...
 $ treatment : chr [1:66] "heat_stress" "heat_stress" "heat_stress" "pre-stress" ...
 $ t0        : num [1:66] -462 -462 -462 454 454 ...
 $ t1.0      : num [1:66] 14629 14629 14629 10739 10739 ...
 $ weight.mg : num [1:66] 2400 2400 2400 2400 2400 ...
 $ difference: num [1:66] 6.29 6.29 6.29 4.29 4.29 ...
 - attr(*, "groups")= tibble [11 × 2] (S3: tbl_df/tbl/data.frame)
  ..$ sample: chr [1:11] "big-oyster" "bigger-oyster" "oyster-01" "oyster-02" ...
  ..$ .rows : list&lt;int&gt; [1:11] 
  .. ..$ : int [1:6] 1 2 3 4 5 6
  .. ..$ : int [1:6] 7 8 9 10 11 12
  .. ..$ : int [1:6] 13 14 15 16 17 18
  .. ..$ : int [1:6] 19 20 21 22 23 24
  .. ..$ : int [1:6] 25 26 27 28 29 30
  .. ..$ : int [1:6] 31 32 33 34 35 36
  .. ..$ : int [1:6] 37 38 39 40 41 42
  .. ..$ : int [1:6] 43 44 45 46 47 48
  .. ..$ : int [1:6] 49 50 51 52 53 54
  .. ..$ : int [1:6] 55 56 57 58 59 60
  .. ..$ : int [1:6] 61 62 63 64 65 66
  .. ..@ ptype: int(0) 
  ..- attr(*, ".drop")= logi TRUE</code></pre>
</div>
</div>
</section>
<section id="grouped-bar-plot" class="level4">
<h4 class="anchored" data-anchor-id="grouped-bar-plot">Grouped bar plot</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reorder treatment levels</span></span>
<span id="cb18-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Makes pre-stress on left and heat-stress on right</span></span>
<span id="cb18-3">difference_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>treatment <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(difference_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>treatment, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pre-stress"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"heat_stress"</span>))</span>
<span id="cb18-4"></span>
<span id="cb18-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get default ggplot2 colors</span></span>
<span id="cb18-6">default_colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hue_pal</span>()(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb18-7"></span>
<span id="cb18-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define custom fill colors with swapped treatments</span></span>
<span id="cb18-9">custom_colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pre-stress"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> default_colors[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"heat_stress"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> default_colors[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb18-10"></span>
<span id="cb18-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot grouped bar plot with swapped treatments and default colors</span></span>
<span id="cb18-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(difference_data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reorder</span>(sample, weight.mg), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> difference, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> treatment)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">position_dodge</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\u0394 A590 per mg"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Unicode for capital delta is \u0394</span></span>
<span id="cb18-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> custom_colors) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Assign default ggplot2 colors to custom treatments</span></span>
<span id="cb18-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(difference_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>sample))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"open"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inches"</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># adds arrow along X-axis</span></span>
<span id="cb18-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8.0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Smaller"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(difference_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>sample))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8.0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Larger"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-03-12-Resazurin---C.gigas-Second-Trial/index_files/figure-html/grouped-bar-plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">DISCUSSION</h2>
<p>Glancing at the grouped bar plots, it appears that the smaller oysters have a greater change in respiration during heat stress. Additionally, the two largest oysters, possibly unintutively, exhibit the lowest changes in respiration. However, my guess is that these larger oysters have the ability to remain closed for longer durations than the smaller oysters. As such, they remained closed after being handled and placed in the resazurin assay media. This would explain low respiration rates <em>and</em> minimal response to heat stress.</p>
<p>This idea is further supported by the fact that we see that as oysters get larger, their respiration rates are <em>lower</em> than when unstressed. It’s possible that the heat stress triggered a response for them to keep closed and, in turn, reducing respiration. While the smallest oysters are unable to keep their shells closed for lengthy periods of time, requiring them to open and respire at higher rates during heat stress.</p>


</section>
</section>

 ]]></description>
  <category>Crassostrea gigas</category>
  <category>Pacific oyster</category>
  <category>2024</category>
  <category>resazurin</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-03-12-Resazurin---C.gigas-Second-Trial/index.html</guid>
  <pubDate>Tue, 12 Mar 2024 07:00:00 GMT</pubDate>
</item>
<item>
  <title>Resazurin - Preliminary Respiration Test Using C.gigas</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-03-08-Resazurin---Preliminary-Respiration-Test-Using-C.gigas/index.html</link>
  <description><![CDATA[ 




<section id="intro" class="level1">
<h1>INTRO</h1>
<p>We’re beginning to gather some preliminary data for a project examining the effects of “stress priming” on _<a href="http://en.wikipedia.org/wiki/Pacific_oyster"><em>Crassostrea gigas</em> (Pacific oyster)</a>. GitHub repo is <a href="https://github.com/RobertsLab/project-gigas-carryover">here</a>. As part of that, Steven recently found out about a protocol to easily evaluate respiration in oysters using <a href="https://en.wikipedia.org/wiki/Resazurin">resazurin</a> (Wikipedia). According to <span class="citation" data-cites="gonzález-pinzón2012">(González-Pinzón, Haggerty, and Myrold 2012)</span>, the reduction of resazurin to resorufin is almost perfectly correlated with respiration in aerobic bacteria and, thus, can be used as a proxy to measure respiration. Offhand, I have not looked at literature detailing its use with eukaryotic cells - I just glanced at the literature cited by Wikipedia. :)</p>
<p>Ideally, using this method would provide a quick, cheap, and wasy way for us and hatcheries to monitor respiration in live oysters, with the potential to use the method as a means to detect stress-inducing events.</p>
<p>For this initial test, I followed the <a href="https://github.com/RobertsLab/project-gigas-carryover/blob/27441a713dfe68578758103bb82dd4dca4b4c091/protocols/Resazurin-assay.md">resazurin assay</a> (commit 27441a7) shared by Steven, with the following modifications:</p>
<ul>
<li><p>Non-sterile water/sea water was used.</p></li>
<li><p>No penn/strep/Fungizone used.</p></li>
</ul>
<p>Small oysters were distributed by Steven in two, 12-well (3x4) plates, and covered completely with 2mL of resazurin Assay Media:</p>
<ul>
<li><p>unstressed</p>
<ul>
<li>Oysters were in all 12 wells.</li>
</ul></li>
<li><p>heat stressed (not sure what the temp or duration was)</p>
<ul>
<li>Well C4 (bottom right) contained no oysters.</li>
</ul></li>
</ul>
<p>Two larger oyster which would not fit in the 12-well plates were each placed in a glass Petri dish and covered with 20mL of resazurin Assay Media.</p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-03-08-Resazurin---Preliminary-Respiration-Test-Using-C.gigas/20240307-unstressed-oysters-plate_01.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">unstressed oysters in 12-well plate</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-03-08-Resazurin---Preliminary-Respiration-Test-Using-C.gigas/20240307-unstressed-oysters-plate_01-resazurin_2mL.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">unstressed oysters in 12-well plate submerged in 2mL resazurin Assay Media</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-03-08-Resazurin---Preliminary-Respiration-Test-Using-C.gigas/20240307-hs-oysters-plate_01.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">heat stressed oysters in 12-well plate</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-03-08-Resazurin---Preliminary-Respiration-Test-Using-C.gigas/20240307-hs-oysters-plate_01-resazurin_2mL.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">heat stressed oysters in 12-well plate submerged in 2mL resazurin Assay Media</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-03-08-Resazurin---Preliminary-Respiration-Test-Using-C.gigas/20240307-unstressed-oysters-dish_01.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">unstressed oysters in glass Petri dishes</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-03-08-Resazurin---Preliminary-Respiration-Test-Using-C.gigas/20240307-dish_01-resazurin_20mL.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">unstressed oysters in glass Petri dishes submerged in 20mL resazurin Assay Media</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Fluorescence was mesasured on a Victor 1420 (Perkin Elmer) plate reader. Plates were read directly, with the oysters in them. For the Petri dishes, 2mL were transferred from each into wells of a new 12-well plate and measured.</p>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<p>Overall, it seems like there was a difference in fluorescence between resazurin control wells (i.e.&nbsp;resazurin assay media only) and wells which contained oysters. So, it appears that the assay is working. Admittedly, I’m a bit surprised by how dark the assay media is. I’d definitely like to play around with the amount resazurin being used, as I think less resazurin might allow us to visually identify differences, in addition to collecting fluorescence readings.</p>
<section id="output-files" class="level2">
<h2 class="anchored" data-anchor-id="output-files">Output files</h2>
<p>All files have been added to <a href="https://github.com/RobertsLab/project-gigas-carryover/blob/main/lifestage_carryover/data/resazurin_trial_01/">https://github.com/RobertsLab/project-gigas-carryover/blob/main/lifestage_carryover/data/resazurin_trial_01/</a>.</p>
<ul>
<li><p><a href="https://github.com/RobertsLab/project-gigas-carryover/edit/main/lifestage_carryover/data/resazurin_trial_01/20240307-cgig-resazurin-control-bigs-and-two-controls-t2.0.xlsx"><code>20240307-cgig-resazurin-control-bigs-and-two-controls-t2.0.xlsx</code></a>: Raw data file (Excel workbook) from Victor (Perkin Elmer) Wallac plate reader of fluorescence measurements of 2mL resazurin assay media from <a href="full.png">oysters in glass petri dishes after two hours</a> (Image). See <code>Notes</code> column in first sheet for plate layout.</p></li>
<li><p><a href="https://github.com/RobertsLab/project-gigas-carryover/edit/main/lifestage_carryover/data/resazurin_trial_01/20240307-cgig-resazurin-control-t2.0.xlsx"><code>20240307-cgig-resazurin-control-t2.0.xlsx</code></a>: Raw data file (Excel workbook) from Victor (Perkin Elmer) Wallac plate reader of fluorescence measurements from <a href="control_p1.png">oysters in 12-well after two hours</a> (Image). See <code>Notes</code> column in first sheet for plate layout.</p></li>
<li><p><a href="https://github.com/RobertsLab/project-gigas-carryover/edit/main/lifestage_carryover/data/resazurin_trial_01/20240307-cgig-resazurin-stress-t1.5.xlsx"><code>20240307-cgig-resazurin-stress-t1.5.xlsx</code></a>: Raw data file (Excel workbook) from Victor (Perkin Elmer) Wallac plate reader of fluorescence measurements from <a href="stress.png">oysters in 12-well 1.5hrs after an unkown heat stress temp/duration</a> (Image). See <code>Notes</code> column in first sheet for plate layout.</p></li>
</ul>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-gonzález-pinzón2012" class="csl-entry">
González-Pinzón, Ricardo, Roy Haggerty, and David D. Myrold. 2012. <span>“Measuring Aerobic Respiration in Stream Ecosystems Using the Resazurin<span>-</span>Resorufin System.”</span> <em>Journal of Geophysical Research: Biogeosciences</em> 117 (G3). <a href="https://doi.org/10.1029/2012jg001965">https://doi.org/10.1029/2012jg001965</a>.
</div>
</div></section></div> ]]></description>
  <category>resazurin</category>
  <category>Crassostrea gigas</category>
  <category>Pacific oyster</category>
  <category>2024</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-03-08-Resazurin---Preliminary-Respiration-Test-Using-C.gigas/index.html</guid>
  <pubDate>Fri, 08 Mar 2024 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Daily Bits - March 2024</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-03-01-Daily-Bits---March-2024/index.html</link>
  <description><![CDATA[ 




<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section">20240305</h2>
<ul>
<li>Dealt with a bunch of annoying ProCard reconciliation stuff.</li>
</ul>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1">20240304</h2>
<section id="miscellaneous" class="level3">
<h3 class="anchored" data-anchor-id="miscellaneous">Miscellaneous</h3>
<ul>
<li><p>Read the rest of “Tending Sweetgrass” section in “Braiding Sweetgrass”.</p></li>
<li><p>Dealt with certificate issues for Eagle and Gannet. Despite “renewing” them, the renewal “broke” <code>wget</code> (can no longer download <em>without</em> the use of <code>--no-check-certificate</code> flag). Remembered that I’d had this issue before and tracked down a <a href="../../../posts/2022/2022-04-02-Server-Maintenance---Fix-Server-Certificate-Authentication-Issues/index.html">notebook entry</a> that dealt with this issue. Needed to install intermediate certificates and that resolved the problem!</p></li>
</ul>
</section>
</section>
<section id="section-2" class="level2">
<h2 class="anchored" data-anchor-id="section-2">20240301</h2>
<section id="miscellaneous-1" class="level3">
<h3 class="anchored" data-anchor-id="miscellaneous-1">Miscellaneous</h3>
<ul>
<li><p>Renewed Eagle server SSL certificate.</p></li>
<li><p>Renewed Gannet server SSL certificate.</p></li>
<li><p>Science Hour</p>
<ul>
<li>Steven out of town, no show by anyone else.</li>
</ul></li>
</ul>
</section>
<section id="ceabigr-github-repo" class="level3">
<h3 class="anchored" data-anchor-id="ceabigr-github-repo"><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo)</h3>
<ul>
<li>Updated README files.</li>
</ul>


</section>
</section>

 ]]></description>
  <category>2024</category>
  <category>Daily Bits</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-03-01-Daily-Bits---March-2024/index.html</guid>
  <pubDate>Fri, 01 Mar 2024 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Data Received - Pacific cod RNA-seq Azenta Project 30-943133806</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-02-21-Data-Received---Pacific-cod-RNA-seq-Azenta-Project-30-943133806/index.html</link>
  <description><![CDATA[ 




<section id="intro" class="level1">
<h1>INTRO</h1>
<p>Received Pacific cod liver/gill/spleen RNA-seq data back from Azenta today (project 30-943133806). Files were downloaded to Owl and MD5 checksums were verified. The <a href="https://b.link/nightingales"><code>Nightingales</code></a> (Google Sheet) spreadsheet has been updated with sample info.</p>
<p>Next steps are to run initial <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/"><code>FastQC</code></a>, as well as get them submitted to NCBI.</p>
</section>
<section id="md5-checksum-verification" class="level1">
<h1>MD5 CHECKSUM VERIFICATION</h1>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-02-21-Data-Received---Pacific-cod-RNA-seq-Azenta-Project-30-943133806/md5-checksum-verification-01.png" class="img-fluid" alt="Screenshot showing MD5 checksum verification of FastQ files."></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-02-21-Data-Received---Pacific-cod-RNA-seq-Azenta-Project-30-943133806/md5-checksum-verification-02.png" class="img-fluid" alt="Screenshot showing MD5 checksum verification of FastQ files."></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-02-21-Data-Received---Pacific-cod-RNA-seq-Azenta-Project-30-943133806/md5-checksum-verification-03.png" class="img-fluid" alt="Screenshot showing MD5 checksum verification of FastQ files."></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-02-21-Data-Received---Pacific-cod-RNA-seq-Azenta-Project-30-943133806/md5-checksum-verification-04.png" class="img-fluid" alt="Screenshot showing MD5 checksum verification of FastQ files."></p>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>Azenta</category>
  <category>RNA-seq</category>
  <category>2024</category>
  <category>Pacific cod</category>
  <category>Gadus macrocephalus</category>
  <category>30-943133806</category>
  <category>Data Received</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-02-21-Data-Received---Pacific-cod-RNA-seq-Azenta-Project-30-943133806/index.html</guid>
  <pubDate>Wed, 21 Feb 2024 08:00:00 GMT</pubDate>
</item>
<item>
  <title>sRNA-seq Paired Read Merging Exploratios - Coral E5 Deep Dive</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-02-02-sRNA-seq-Paired-Read-Merging-Exploratios---Coral-E5-Deep-Dive/index.html</link>
  <description><![CDATA[ 




<section id="intro" class="level1">
<h1>INTRO</h1>
<p>Our previous sRNA-seq data analysis for this project revealed that the R2 reads didn’t seem to match with anything (specifically, no clade assignments when using <a href="https://github.com/friedlanderlab/mirtrace">miRTrace</a>), which seemed odd. Since the insert sizes should be small for these libraries and the read lengths kind of long (150bp PE), we’d expect the resulting reads to overlap. And, in turn, R2 reads should be reverse complements of R1 reads (and vice versa). After discussing things with Azenta (company which performed library construction and sequencing), they indicated that their in-house pipeline discards the R2 reads because they come from the opposite strand and most miRNAs are found on the R1 strand.</p>
<p>It seemed like a bit of waste to discard all the data that exists in the R2 reads, so I wanted to explore merging the reads to see if we could preserve the R2 data. Additionally, I came across <a href="https://github.com/HCGB-IGTP/XICRA">XICRA</a> (GitHub repo) <span class="citation" data-cites="sanchezherrero2021">(Sanchez Herrero et al. 2021)</span> which describes using paired-end sequence data to identify miRNA isoforms (isomiRs), suggesting that we should try to retain the R2 reads to improve our miRNA analyses.</p>
<p>I decided to explore merging/trimming using two different sets of software:</p>
<ul>
<li><p><a href="https://jgi.doe.gov/data-and-tools/software-tools/bbtools/bb-tools-user-guide/bbmerge-guide/">BBMerge</a> <span class="citation" data-cites="bushnell2017">(Bushnell, Rood, and Singer 2017)</span></p></li>
<li><p><a href="https://github.com/OpenGene/fastp"><code>fastp</code></a><span class="citation" data-cites="chen2023 chen2018">(Chen 2023; Chen et al. 2018)</span></p></li>
</ul>
<p><a href="https://jgi.doe.gov/data-and-tools/software-tools/bbtools/bb-tools-user-guide/bbmerge-guide/">BBMerge</a> seemed like a good tool, as it’s specifically designed to handle merging of Illumina PE sequencing reads. Plus, it’s part of the <a href="https://sourceforge.net/projects/bbmap/">BBTols suite</a>, which has a number of other tools, and packages like this usually have nice cross-compatibility between the different tools.</p>
<p><a href="https://github.com/OpenGene/fastp"><code>fastp</code></a> has both trimming <em>and</em> merging built into the tools itself, which I hadn’t previously realized (but, had never explored, since this isn’t how we usually work with PE sequencing data). I was simply going to use <a href="https://github.com/OpenGene/fastp"><code>fastp</code></a> for trimming, as it’s the trimmer thta I’m most familiar with. I honestly thought I’d trim with <a href="https://github.com/OpenGene/fastp"><code>fastp</code></a>, and then merge with <a href="https://jgi.doe.gov/data-and-tools/software-tools/bbtools/bb-tools-user-guide/bbmerge-guide/">BBMerge</a>, but the fact that <a href="https://github.com/OpenGene/fastp"><code>fastp</code></a> had it built-in could make my life easier.</p>
<p>So, with all of that out of the way, let’s start the analysis. This will only use a single set of PE sequencing reads, as an initial exploration. We’ll decide on the best approach and then use that approach to run all the sequencing data through the chosen “pipeline.”</p>
</section>
<section id="setup" class="level1">
<h1>SETUP</h1>
<section id="create-a-bash-variables-file" class="level2">
<h2 class="anchored" data-anchor-id="create-a-bash-variables-file">Create a Bash variables file</h2>
<p>This allows usage of Bash variables across R Markdown chunks.</p>
<div class="cell" data-hash="index_cache/html/save-bash-variables-to-rvars-file_557b88741e34c3413b8b7eb0591112be">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#### Assign Variables ####"</span></span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"## Data URL"</span></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_url="https://owl.fish.washington.edu/nightingales/P_evermanni/30-852430235/"'</span></span>
<span id="cb1-7"></span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Data directories"</span></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastqc_out_dir="./fastqc"'</span></span>
<span id="cb1-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export raw_reads_dir="./raw"'</span></span>
<span id="cb1-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export trimmed_fastqs_dir="./trimmed-reads"'</span></span>
<span id="cb1-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-13"></span>
<span id="cb1-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"## NEB nebnext-small-rna-library-prep-set-for-illumina adapters"</span></span>
<span id="cb1-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export first_adapter="AGATCGGAAGAGCACACGTCTGAACTCCAGTCAC"'</span></span>
<span id="cb1-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export second_adapter="GATCGTCGGACTGTAGAACTCTGAACGTGTAGATCTCGGTGGTCGCCGTATCATT"'</span></span>
<span id="cb1-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-18"></span>
<span id="cb1-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Input/output files"</span></span>
<span id="cb1-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export NEB_adapters_fasta=NEB-adapters.fasta'</span></span>
<span id="cb1-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-22"></span>
<span id="cb1-23"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Paths to programs"</span></span>
<span id="cb1-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export programs_dir="/home/shared"'</span></span>
<span id="cb1-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export bbmerge="${programs_dir}/bbmap-39.06/bbmerge.sh"'</span></span>
<span id="cb1-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastp="${programs_dir}/fastp"'</span></span>
<span id="cb1-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export fastqc="${programs_dir}/FastQC-0.12.1/fastqc"'</span></span>
<span id="cb1-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export multiqc=/home/sam/programs/mambaforge/bin/multiqc'</span></span>
<span id="cb1-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-30"></span>
<span id="cb1-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Set number of CPUs to use"</span></span>
<span id="cb1-32"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export threads=46'</span></span>
<span id="cb1-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-34"></span>
<span id="cb1-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# Initialize arrays"</span></span>
<span id="cb1-36"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export trimmed_fastqs_array=()'</span></span>
<span id="cb1-37"></span>
<span id="cb1-38"></span>
<span id="cb1-39"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .bashvars</span>
<span id="cb1-40"></span>
<span id="cb1-41"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .bashvars</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#### Assign Variables ####

## Data URL
export raw_reads_url="https://owl.fish.washington.edu/nightingales/P_evermanni/30-852430235/"
# Data directories
export fastqc_out_dir="./fastqc"
export raw_reads_dir="./raw"
export trimmed_fastqs_dir="./trimmed-reads"

## NEB nebnext-small-rna-library-prep-set-for-illumina adapters
export first_adapter="AGATCGGAAGAGCACACGTCTGAACTCCAGTCAC"
export second_adapter="GATCGTCGGACTGTAGAACTCTGAACGTGTAGATCTCGGTGGTCGCCGTATCATT"

# Input/output files
export NEB_adapters_fasta=NEB-adapters.fasta

# Paths to programs
export programs_dir="/home/shared"
export bbmerge="${programs_dir}/bbmap-39.06/bbmerge.sh"
export fastp="${programs_dir}/fastp"
export fastqc="${programs_dir}/FastQC-0.12.1/fastqc"
export multiqc=/home/sam/programs/mambaforge/bin/multiqc

# Set number of CPUs to use
export threads=46

# Initialize arrays
export trimmed_fastqs_array=()</code></pre>
</div>
</div>
</section>
<section id="download-raw-srnaseq-reads" class="level2">
<h2 class="anchored" data-anchor-id="download-raw-srnaseq-reads">Download raw sRNAseq reads</h2>
<p>Reads are downloaded from <a href="https://owl.fish.washington.edu/nightingales/P_evermanni/30-852430235/" class="uri">https://owl.fish.washington.edu/nightingales/P_evermanni/30-852430235/</a></p>
<p>The <code>--cut-dirs 3</code> command cuts the preceding directory structure (i.e.&nbsp;<code>nightingales/P_evermanni/30-852430235/</code>) so that we just end up with the reads.</p>
<div class="cell" data-hash="index_cache/html/download-raw-reads_3e8a57c57afc3ca48307a2222adbc5a2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmed_fastqs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-5"></span>
<span id="cb3-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-7">--directory-prefix <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-8">--recursive <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-9">--no-check-certificate <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-10">--continue <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-11">--cut-dirs 3 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-12">--no-host-directories <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-13">--no-parent <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-14">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-15">--accept <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sRNA-POR-79*,checksums.md5"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_url}</span></span>
<span id="cb3-16"></span>
<span id="cb3-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lh</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>total 1.8G
-rw-r--r-- 1 sam sam  798 May 17  2023 checksums.md5
-rw-r--r-- 1 sam sam 899M May 17  2023 sRNA-POR-79-S1-TP2_R1_001.fastq.gz
-rw-r--r-- 1 sam sam 916M May 17  2023 sRNA-POR-79-S1-TP2_R2_001.fastq.gz</code></pre>
</div>
</div>
<section id="verify-raw-read-checksums" class="level3">
<h3 class="anchored" data-anchor-id="verify-raw-read-checksums">Verify raw read checksums</h3>
<div class="cell" data-hash="index_cache/html/verify-raw-read-checksums_d549d489877cd51c5d3007bc08c11f50">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${raw_reads_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-5"></span>
<span id="cb5-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Checksums file contains other files, so this just looks for the sRNAseq files.</span></span>
<span id="cb5-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sRNA-POR-79"</span> checksums.md5 <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--check</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>sRNA-POR-79-S1-TP2_R1_001.fastq.gz: OK
sRNA-POR-79-S1-TP2_R2_001.fastq.gz: OK</code></pre>
</div>
</div>
</section>
</section>
<section id="create-adapters-fasta" class="level2">
<h2 class="anchored" data-anchor-id="create-adapters-fasta">Create adapters FastA</h2>
<div class="cell" data-hash="index_cache/html/create-FastA-of-adapters_489b156eafb839837fb44595e8b673b8">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb7-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Creating adapters FastA."</span></span>
<span id="cb7-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb7-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">adapter_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb7-7"></span>
<span id="cb7-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check for adapters file first</span></span>
<span id="cb7-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Then create adapters file if doesn't exist</span></span>
<span id="cb7-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-f</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${NEB_adapters_fasta}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb7-11">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${NEB_adapters_fasta}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> already exists. Nothing to do."</span></span>
<span id="cb7-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span></span>
<span id="cb7-13">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> adapter <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${first_adapter}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${second_adapter}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-14">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span>
<span id="cb7-15">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">adapter_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$((adapter_count</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">))</span></span>
<span id="cb7-16">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt;%s\n%s\n"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"adapter_</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${adapter_count}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${adapter}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-17">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${NEB_adapters_fasta}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-18"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb7-19"></span>
<span id="cb7-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb7-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Adapters FastA:"</span></span>
<span id="cb7-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb7-23"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${NEB_adapters_fasta}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Creating adapters FastA.

NEB-adapters.fasta already exists. Nothing to do.

Adapters FastA:

&gt;adapter_1
AGATCGGAAGAGCACACGTCTGAACTCCAGTCAC
&gt;adapter_2
GATCGTCGGACTGTAGAACTCTGAACGTGTAGATCTCGGTGGTCGCCGTATCATT</code></pre>
</div>
</div>
</section>
<section id="fastp" class="level2">
<h2 class="anchored" data-anchor-id="fastp"><a href="https://github.com/OpenGene/fastp"><code>fastp</code></a></h2>
<p><a href="https://github.com/OpenGene/fastp"><code>fastp</code></a> has many built-in functions, including before/after trimming plots, and read 1 and read 2 merging.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Setting <code>--overlap_len_require 17</code> forces <a href="https://github.com/OpenGene/fastp"><code>fastp</code></a> to look at reads starting at base 17, instead of the default 30 and results in more accurate analyses, since these are sRNA-seq libraries where the expected/desired read lengths will be 17 - 30bp in length.</p>
</div>
</div>
<section id="paired-end-trimming" class="level3">
<h3 class="anchored" data-anchor-id="paired-end-trimming">Paired-end Trimming</h3>
<p>The paired end trimming will examine how some of the trimming options impact sequencing read lengths, quality, and subsequent merging.</p>
<section id="polyg-trimming-only" class="level4">
<h4 class="anchored" data-anchor-id="polyg-trimming-only">PolyG Trimming Only</h4>
<div class="cell" data-hash="index_cache/html/fastp-polyG-only_e3d0709080057180a4c049d895f25282">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb9-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb9-3"></span>
<span id="cb9-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastp}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-5">--in1 ./raw/sRNA-POR-79-S1-TP2_R1_001.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-6">--in2 ./raw/sRNA-POR-79-S1-TP2_R2_001.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-7">--out1 ./trimmed-reads/fastp-polyG_only.R1.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-8">--out2 ./trimmed-reads/fastp-polyG_only.R2.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-9">--disable_adapter_trimming <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-10">--trim_poly_g <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-11">--overlap_len_require 17 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-12">--thread <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-13">--html <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastp-polyG-only.html"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-14">--json <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastp-polyG-only.json"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-15">--report_title <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastp-polyG-only"</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: fastp uses up to 16 threads although you specified 46
Read1 before filtering:
total reads: 19762559
total bases: 2964383850
Q20 bases: 2604771220(87.8689%)
Q30 bases: 2427856243(81.9009%)

Read2 before filtering:
total reads: 19762559
total bases: 2964383850
Q20 bases: 2619314070(88.3595%)
Q30 bases: 2408732242(81.2557%)

Read1 after filtering:
total reads: 19450041
total bases: 1698288792
Q20 bases: 1478970498(87.0859%)
Q30 bases: 1370182460(80.6802%)

Read2 after filtering:
total reads: 19450041
total bases: 1849068926
Q20 bases: 1690862447(91.444%)
Q30 bases: 1596965342(86.3659%)

Filtering result:
reads passed filter: 38900082
reads failed due to low quality: 595592
reads failed due to too many N: 40
reads failed due to too short: 29404

Duplication rate: 10.4184%

Insert size peak (evaluated by paired-end reads): 29

JSON report: fastp-polyG-only.json
HTML report: fastp-polyG-only.html

/home/shared/fastp --in1 ./raw/sRNA-POR-79-S1-TP2_R1_001.fastq.gz --in2 ./raw/sRNA-POR-79-S1-TP2_R2_001.fastq.gz --out1 ./trimmed-reads/fastp-polyG_only.R1.fq.gz --out2 ./trimmed-reads/fastp-polyG_only.R2.fq.gz --disable_adapter_trimming --trim_poly_g --overlap_len_require 17 --thread 46 --html fastp-polyG-only.html --json fastp-polyG-only.json --report_title fastp-polyG-only 
fastp v0.23.2, time used: 45 seconds</code></pre>
</div>
</div>
</section>
<section id="adapters-polyg-trimming" class="level4">
<h4 class="anchored" data-anchor-id="adapters-polyg-trimming">Adapters &amp; PolyG Trimming</h4>
<div class="cell" data-hash="index_cache/html/fastp-adapters-and-polyg_1d41e267fb16dfaae5634127558d3d83">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb11-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb11-3"></span>
<span id="cb11-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastp}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-5">--in1 ./raw/sRNA-POR-79-S1-TP2_R1_001.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-6">--in2 ./raw/sRNA-POR-79-S1-TP2_R2_001.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-7">--out1 ./trimmed-reads/fastp-adapters-polyG.R1.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-8">--out2 ./trimmed-reads/fastp-adapters-polyG.R2.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-9">--adapter_fasta NEB-adapters.fasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-10">--trim_poly_g <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-11">--overlap_len_require 17 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-12">--thread <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-13">--html <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastp-adapters-polyG.html"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-14">--json <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastp-adapters-polyG.json"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-15">--report_title <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastp-adapters-polyG-only"</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: fastp uses up to 16 threads although you specified 46
Read1 before filtering:
total reads: 19762559
total bases: 2964383850
Q20 bases: 2604771220(87.8689%)
Q30 bases: 2427856243(81.9009%)

Read2 before filtering:
total reads: 19762559
total bases: 2964383850
Q20 bases: 2619314070(88.3595%)
Q30 bases: 2408732242(81.2557%)

Read1 after filtering:
total reads: 16734573
total bases: 489646406
Q20 bases: 480139354(98.0584%)
Q30 bases: 466862298(95.3468%)

Read2 after filtering:
total reads: 16734573
total bases: 492483642
Q20 bases: 484765577(98.4328%)
Q30 bases: 469308001(95.2941%)

Filtering result:
reads passed filter: 33469146
reads failed due to low quality: 232788
reads failed due to too many N: 0
reads failed due to too short: 5823184
reads with adapter trimmed: 30461598
bases trimmed due to adapters: 2013836548

Duplication rate: 10.4184%

Insert size peak (evaluated by paired-end reads): 29

JSON report: fastp-adapters-polyG.json
HTML report: fastp-adapters-polyG.html

/home/shared/fastp --in1 ./raw/sRNA-POR-79-S1-TP2_R1_001.fastq.gz --in2 ./raw/sRNA-POR-79-S1-TP2_R2_001.fastq.gz --out1 ./trimmed-reads/fastp-adapters-polyG.R1.fq.gz --out2 ./trimmed-reads/fastp-adapters-polyG.R2.fq.gz --adapter_fasta NEB-adapters.fasta --trim_poly_g --overlap_len_require 17 --thread 46 --html fastp-adapters-polyG.html --json fastp-adapters-polyG.json --report_title fastp-adapters-polyG-only 
fastp v0.23.2, time used: 33 seconds</code></pre>
</div>
</div>
</section>
<section id="polyg-trimming-max-length-31" class="level4">
<h4 class="anchored" data-anchor-id="polyg-trimming-max-length-31">PolyG Trimming Max Length 31</h4>
<p>This can’t be run because we know from the polyG only trimming, that most read lengths are &gt;89bp. As such, it will end up discarding all the reads…</p>
</section>
<section id="adapters-polyg-trimming-max-length-31" class="level4">
<h4 class="anchored" data-anchor-id="adapters-polyg-trimming-max-length-31">Adapters &amp; PolyG Trimming Max Length 31</h4>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The max length is based on the <code>fastp</code> insert peak size from the adapter and polyG trimming results, and previous evaluation of mean read lengths via <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/"><code>FastQC</code></a> and <a href="https://multiqc.info/"><code>MultiQC</code></a>.</p>
</div>
</div>
<div class="cell" data-hash="index_cache/html/fastp-adapters-polyG-31bp_3774163ceb4ea5d1e7c6c0b51e795699">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb13-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb13-3"></span>
<span id="cb13-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastp}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-5">--in1 ./raw/sRNA-POR-79-S1-TP2_R1_001.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-6">--in2 ./raw/sRNA-POR-79-S1-TP2_R2_001.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-7">--out1 ./trimmed-reads/fastp-adapters-polyG-31bp.R1.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-8">--out2 ./trimmed-reads/fastp-adapters-polyG-31bp.R2.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-9">--adapter_fasta NEB-adapters.fasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-10">--trim_poly_g <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-11">--overlap_len_require 17 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-12">--length_limit 31 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-13">--thread <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-14">--html <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastp-adapters-polyG-31bp.html"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-15">--json <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastp-adapters-polyG-31bp.json"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-16">--report_title <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastp-adapters-polyG-31bp"</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: fastp uses up to 16 threads although you specified 46
Read1 before filtering:
total reads: 19762559
total bases: 2964383850
Q20 bases: 2604771220(87.8689%)
Q30 bases: 2427856243(81.9009%)

Read2 before filtering:
total reads: 19762559
total bases: 2964383850
Q20 bases: 2619314070(88.3595%)
Q30 bases: 2408732242(81.2557%)

Read1 after filtering:
total reads: 13190855
total bases: 339210880
Q20 bases: 335529961(98.9149%)
Q30 bases: 327446980(96.532%)

Read2 after filtering:
total reads: 13190855
total bases: 338558013
Q20 bases: 335504115(99.098%)
Q30 bases: 325352134(96.0994%)

Filtering result:
reads passed filter: 26381710
reads failed due to low quality: 232788
reads failed due to too many N: 0
reads failed due to too short: 5354066
reads failed due to too long: 7556554
reads with adapter trimmed: 30461598
bases trimmed due to adapters: 2013836548

Duplication rate: 10.4184%

Insert size peak (evaluated by paired-end reads): 29

JSON report: fastp-adapters-polyG-31bp.json
HTML report: fastp-adapters-polyG-31bp.html

/home/shared/fastp --in1 ./raw/sRNA-POR-79-S1-TP2_R1_001.fastq.gz --in2 ./raw/sRNA-POR-79-S1-TP2_R2_001.fastq.gz --out1 ./trimmed-reads/fastp-adapters-polyG-31bp.R1.fq.gz --out2 ./trimmed-reads/fastp-adapters-polyG-31bp.R2.fq.gz --adapter_fasta NEB-adapters.fasta --trim_poly_g --overlap_len_require 17 --length_limit 31 --thread 46 --html fastp-adapters-polyG-31bp.html --json fastp-adapters-polyG-31bp.json --report_title fastp-adapters-polyG-31bp 
fastp v0.23.2, time used: 33 seconds</code></pre>
</div>
</div>
</section>
<section id="adapters-polyg-trimming-max-length-31-with-merge" class="level4">
<h4 class="anchored" data-anchor-id="adapters-polyg-trimming-max-length-31-with-merge">Adapters &amp; PolyG Trimming Max Length 31 With Merge</h4>
<p>This will attempt to merge the R1 and R2 reads.</p>
<div class="cell" data-hash="index_cache/html/fastp-adapters-polyG-31bp-merged_f9ef660e3d321f7629c01c0e408d30b8">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb15-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb15-3"></span>
<span id="cb15-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastp}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-5">--in1 ./raw/sRNA-POR-79-S1-TP2_R1_001.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-6">--in2 ./raw/sRNA-POR-79-S1-TP2_R2_001.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-7">--adapter_fasta NEB-adapters.fasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-8">--trim_poly_g <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-9">--overlap_len_require 17 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-10">--length_limit 31 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-11">--merge <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-12">--merged_out ./trimmed-reads/fastp-adapters-polyG-31bp-merged.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-13">--thread <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-14">--html <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastp-adapters-polyG-31bp-merged.html"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-15">--json <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastp-adapters-polyG-31bp-merged.json"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-16">--report_title <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastp-adapters-polyG-31bp-merged"</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: fastp uses up to 16 threads although you specified 46
Read1 before filtering:
total reads: 19762559
total bases: 2964383850
Q20 bases: 2604771220(87.8689%)
Q30 bases: 2427856243(81.9009%)

Read2 before filtering:
total reads: 19762559
total bases: 2964383850
Q20 bases: 2619314070(88.3595%)
Q30 bases: 2408732242(81.2557%)

Merged and filtered:
total reads: 12259576
total bases: 324356716
Q20 bases: 320917135(98.9396%)
Q30 bases: 313148708(96.5445%)

Filtering result:
reads passed filter: 26506174
reads failed due to low quality: 179320
reads failed due to too many N: 0
reads failed due to too short: 5774946
reads failed due to too long: 7064678
reads with adapter trimmed: 30461598
bases trimmed due to adapters: 2013836548
reads corrected by overlap analysis: 484376
bases corrected by overlap analysis: 766038

Duplication rate: 10.4184%

Insert size peak (evaluated by paired-end reads): 29

Read pairs merged: 12259576
% of original read pairs: 62.0344%
% in reads after filtering: 100%


JSON report: fastp-adapters-polyG-31bp-merged.json
HTML report: fastp-adapters-polyG-31bp-merged.html

/home/shared/fastp --in1 ./raw/sRNA-POR-79-S1-TP2_R1_001.fastq.gz --in2 ./raw/sRNA-POR-79-S1-TP2_R2_001.fastq.gz --adapter_fasta NEB-adapters.fasta --trim_poly_g --overlap_len_require 17 --length_limit 31 --merge --merged_out ./trimmed-reads/fastp-adapters-polyG-31bp-merged.fq.gz --thread 46 --html fastp-adapters-polyG-31bp-merged.html --json fastp-adapters-polyG-31bp-merged.json --report_title fastp-adapters-polyG-31bp-merged 
fastp v0.23.2, time used: 43 seconds</code></pre>
</div>
</div>
</section>
</section>
<section id="single-end-trimming---r1-reads-only" class="level3">
<h3 class="anchored" data-anchor-id="single-end-trimming---r1-reads-only">Single-end Trimming - R1 Reads Only</h3>
<p>Using just the R1 reads, per Azenta’s recommendation.</p>
<section id="auto-adapters-polyg-trimming" class="level4">
<h4 class="anchored" data-anchor-id="auto-adapters-polyg-trimming">Auto-adapters &amp; PolyG Trimming</h4>
<div class="cell" data-hash="index_cache/html/fastp-R1-auto_adapters-and-polyg_65d982c936153a2e57fde4c6ec2b62db">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb17-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb17-3"></span>
<span id="cb17-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastp}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb17-5">--in1 ./raw/sRNA-POR-79-S1-TP2_R1_001.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb17-6">--out1 ./trimmed-reads/fastp-R1-auto_adapters-polyG.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb17-7">--trim_poly_g <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb17-8">--thread <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb17-9">--html <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastp-R1-auto_adapters-polyG.html"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb17-10">--json <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastp-R1-auto_adapters-polyG.json"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb17-11">--report_title <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastp-R1-auto_adapters-polyG"</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Detecting adapter sequence for read1...
&gt;Illumina TruSeq Adapter Read 1
AGATCGGAAGAGCACACGTCTGAACTCCAGTCA

WARNING: fastp uses up to 16 threads although you specified 46
Read1 before filtering:
total reads: 19762559
total bases: 2964383850
Q20 bases: 2604771220(87.8689%)
Q30 bases: 2427856243(81.9009%)

Read1 after filtering:
total reads: 16984592
total bases: 540469705
Q20 bases: 522006375(96.5838%)
Q30 bases: 504657126(93.3738%)

Filtering result:
reads passed filter: 16984592
reads failed due to low quality: 30923
reads failed due to too many N: 1
reads failed due to too short: 2747043
reads with adapter trimmed: 18545632
bases trimmed due to adapters: 1166285709

Duplication rate (may be overestimated since this is SE data): 29.621%

JSON report: fastp-R1-auto_adapters-polyG.json
HTML report: fastp-R1-auto_adapters-polyG.html

/home/shared/fastp --in1 ./raw/sRNA-POR-79-S1-TP2_R1_001.fastq.gz --out1 ./trimmed-reads/fastp-R1-auto_adapters-polyG.fq.gz --trim_poly_g --thread 46 --html fastp-R1-auto_adapters-polyG.html --json fastp-R1-auto_adapters-polyG.json --report_title fastp-R1-auto_adapters-polyG 
fastp v0.23.2, time used: 31 seconds</code></pre>
</div>
</div>
</section>
<section id="auto-adapters-polyg-trimming-max-length-31" class="level4">
<h4 class="anchored" data-anchor-id="auto-adapters-polyg-trimming-max-length-31">Auto-adapters &amp; PolyG Trimming Max Length 31</h4>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The max length is based on the <code>fastp</code> insert peak size from the adapter and polyG trimming results, and previous evaluation of mean read lengths via <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/"><code>FastQC</code></a> and <a href="https://multiqc.info/"><code>MultiQC</code></a>.</p>
</div>
</div>
<div class="cell" data-hash="index_cache/html/fastp-R1-auto_adapters-polyG-31bp_401b37635e6eb99791df83312ce5b1be">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb19-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb19-3"></span>
<span id="cb19-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastp}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-5">--in1 ./raw/sRNA-POR-79-S1-TP2_R1_001.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-6">--out1 ./trimmed-reads/fastp-R1-31bp-auto_adapters-polyG.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-7">--trim_poly_g <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-8">--length_limit 31 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-9">--thread <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-10">--html <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastp-R1-auto_adapters-polyG-31bp.html"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-11">--json <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastp-R1-auto_adapters-polyG-31bp.json"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-12">--report_title <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastp-R1-auto_adapters-polyG-31bp"</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Detecting adapter sequence for read1...
&gt;Illumina TruSeq Adapter Read 1
AGATCGGAAGAGCACACGTCTGAACTCCAGTCA

WARNING: fastp uses up to 16 threads although you specified 46
Read1 before filtering:
total reads: 19762559
total bases: 2964383850
Q20 bases: 2604771220(87.8689%)
Q30 bases: 2427856243(81.9009%)

Read1 after filtering:
total reads: 12801426
total bases: 328647991
Q20 bases: 325069951(98.9113%)
Q30 bases: 317201339(96.517%)

Filtering result:
reads passed filter: 12801426
reads failed due to low quality: 30923
reads failed due to too many N: 1
reads failed due to too short: 2747043
reads failed due to too long: 4183166
reads with adapter trimmed: 18545632
bases trimmed due to adapters: 1166285709

Duplication rate (may be overestimated since this is SE data): 29.621%

JSON report: fastp-R1-auto_adapters-polyG-31bp.json
HTML report: fastp-R1-auto_adapters-polyG-31bp.html

/home/shared/fastp --in1 ./raw/sRNA-POR-79-S1-TP2_R1_001.fastq.gz --out1 ./trimmed-reads/fastp-R1-31bp-auto_adapters-polyG.fq.gz --trim_poly_g --length_limit 31 --thread 46 --html fastp-R1-auto_adapters-polyG-31bp.html --json fastp-R1-auto_adapters-polyG-31bp.json --report_title fastp-R1-auto_adapters-polyG-31bp 
fastp v0.23.2, time used: 31 seconds</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="bbmerge" class="level2">
<h2 class="anchored" data-anchor-id="bbmerge">BBMerge</h2>
<section id="raw-reads" class="level3">
<h3 class="anchored" data-anchor-id="raw-reads">Raw reads</h3>
<p><a href="https://jgi.doe.gov/data-and-tools/software-tools/bbtools/bb-tools-user-guide/bbmerge-guide/">BBMerge</a> documentations actually indicates that merging performs best using <em>raw</em>, untrimmed reads, so we’ll try that out first…</p>
<div class="cell" data-hash="index_cache/html/bbmerge-raw-reads_d23f7707316a90fd7aed3c6296c882a6">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb21-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb21-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bbmerge}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb21-4">in1=./raw/sRNA-POR-79-S1-TP2_R1_001.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb21-5">in2=./raw/sRNA-POR-79-S1-TP2_R2_001.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb21-6">adapters=./NEB-adapters.fasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb21-7">mininsert=17 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb21-8">out=./trimmed-reads/sRNA-POR-79-S1-TP2-raw-bbmerge.fq.gz</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>java -ea -Xmx1000m -Xms1000m -Djava.library.path=/home/shared/bbmap-39.06/jni/ -cp /home/shared/bbmap-39.06/current/ jgi.BBMerge in1=./raw/sRNA-POR-79-S1-TP2_R1_001.fastq.gz in2=./raw/sRNA-POR-79-S1-TP2_R2_001.fastq.gz adapters=./NEB-adapters.fasta mininsert=17 out=./trimmed-reads/sRNA-POR-79-S1-TP2-raw-bbmerge.fq.gz
Executing jgi.BBMerge [in1=./raw/sRNA-POR-79-S1-TP2_R1_001.fastq.gz, in2=./raw/sRNA-POR-79-S1-TP2_R2_001.fastq.gz, adapters=./NEB-adapters.fasta, mininsert=17, out=./trimmed-reads/sRNA-POR-79-S1-TP2-raw-bbmerge.fq.gz]
Version 39.06

Writing mergable reads merged.
Started output threads.
Total time: 54.191 seconds.

Pairs:                  19762559
Joined:                 151908      0.769%
Ambiguous:              0           0.000%
No Solution:            19610645    99.231%
Too Short:              6           0.000%
Adapters Expected:      60129       0.152%
Adapters Found:         58428       0.148%

Avg Insert:             131.5
Standard Deviation:     62.2
Mode:                   156

Insert range:           17 - 289
90th percentile:        203
75th percentile:        156
50th percentile:        156
25th percentile:        72
10th percentile:        32</code></pre>
</div>
</div>
</section>
<section id="trimmed-polyg-only" class="level3">
<h3 class="anchored" data-anchor-id="trimmed-polyg-only">Trimmed PolyG Only</h3>
<p>Running <a href="https://jgi.doe.gov/data-and-tools/software-tools/bbtools/bb-tools-user-guide/bbmerge-guide/">BBMerge</a> on just raw reads yielded poor results (&gt;99% of reads could <em>not</em> be merged). Additionally, the average insert size was determined to be 131.5bp, which is not going to be useful for sRNA-seq.</p>
<p>I know that there’s a very large stretch of polyG sequence in the reads (likely due to the small insert size and “long” read length - Gs get added as a “placeholder” base each cycle that exceeds the insert size), so let’s try merging reads <em>after</em> polyG sequence has been trimmed.</p>
<div class="cell" data-hash="index_cache/html/bbmerge-trimmed-polyg-only_972e3057523dbee3d6a501616a440705">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb23-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb23-3"></span>
<span id="cb23-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bbmerge}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb23-5">in1=./trimmed-reads/fastp-polyG_only.R1.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb23-6">in2=./trimmed-reads/fastp-polyG_only.R2.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb23-7">adapters=./NEB-adapters.fasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb23-8">mininsert=17 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb23-9">out=./trimmed-reads/sRNA-POR-79-S1-TP2-fastp-polyG_only-bbmerge.fq.gz</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>java -ea -Xmx1000m -Xms1000m -Djava.library.path=/home/shared/bbmap-39.06/jni/ -cp /home/shared/bbmap-39.06/current/ jgi.BBMerge in1=./trimmed-reads/fastp-polyG_only.R1.fq.gz in2=./trimmed-reads/fastp-polyG_only.R2.fq.gz adapters=./NEB-adapters.fasta mininsert=17 out=./trimmed-reads/sRNA-POR-79-S1-TP2-fastp-polyG_only-bbmerge.fq.gz
Executing jgi.BBMerge [in1=./trimmed-reads/fastp-polyG_only.R1.fq.gz, in2=./trimmed-reads/fastp-polyG_only.R2.fq.gz, adapters=./NEB-adapters.fasta, mininsert=17, out=./trimmed-reads/sRNA-POR-79-S1-TP2-fastp-polyG_only-bbmerge.fq.gz]
Version 39.06

Writing mergable reads merged.
Started output threads.
Total time: 54.074 seconds.

Pairs:                  19450041
Joined:                 12649853    65.038%
Ambiguous:              0           0.000%
No Solution:            5981377     30.753%
Too Short:              818811      4.210%
Adapters Expected:      12781441    32.857%
Adapters Found:         12553911    32.272%

Avg Insert:             30.0
Standard Deviation:     14.6
Mode:                   29

Insert range:           17 - 289
90th percentile:        37
75th percentile:        31
50th percentile:        29
25th percentile:        25
10th percentile:        21</code></pre>
</div>
</div>
<p>The results from using polyG-trimmed reads are certainly much better than just merging raw reads (12,649,853 reads could be joined this time). Mean insert size is now determined to be 30bp, which is what we might expect. However, the insert range (17 - 289) is still concerning, as reads &gt;30bp likely aren’t usable. Adapter sequences are still present, which are certainly contributing to some of the inability to merge, as well as the large read lengths. So, let’s try merging reads that have been trimmed of both polyG and adapter sequences.</p>
</section>
<section id="trimmed-adapters-polyg" class="level3">
<h3 class="anchored" data-anchor-id="trimmed-adapters-polyg">Trimmed Adapters &amp; PolyG</h3>
<div class="cell" data-hash="index_cache/html/bbmerge-trimmed-adapters-and-polyG_381ff3a3fcb3e3217f97721d06cd8dcf">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb25-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb25-3"></span>
<span id="cb25-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bbmerge}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb25-5">in1=./trimmed-reads/fastp-adapters-polyG.R1.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb25-6">in2=./trimmed-reads/fastp-adapters-polyG.R2.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb25-7">adapters=./NEB-adapters.fasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb25-8">mininsert=17 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb25-9">out=./trimmed-reads/sRNA-POR-79-S1-TP2-fastp-adapters-polyG-bbmerge.fq.gz</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>java -ea -Xmx1000m -Xms1000m -Djava.library.path=/home/shared/bbmap-39.06/jni/ -cp /home/shared/bbmap-39.06/current/ jgi.BBMerge in1=./trimmed-reads/fastp-adapters-polyG.R1.fq.gz in2=./trimmed-reads/fastp-adapters-polyG.R2.fq.gz adapters=./NEB-adapters.fasta mininsert=17 out=./trimmed-reads/sRNA-POR-79-S1-TP2-fastp-adapters-polyG-bbmerge.fq.gz
Executing jgi.BBMerge [in1=./trimmed-reads/fastp-adapters-polyG.R1.fq.gz, in2=./trimmed-reads/fastp-adapters-polyG.R2.fq.gz, adapters=./NEB-adapters.fasta, mininsert=17, out=./trimmed-reads/sRNA-POR-79-S1-TP2-fastp-adapters-polyG-bbmerge.fq.gz]
Version 39.06

Writing mergable reads merged.
Started output threads.
Total time: 29.011 seconds.

Pairs:                  16734573
Joined:                 15533284    92.822%
Ambiguous:              0           0.000%
No Solution:            603776      3.608%
Too Short:              597513      3.571%
Adapters Expected:      28222       0.084%
Adapters Found:         18307       0.055%

Avg Insert:             29.4
Standard Deviation:     13.2
Mode:                   29

Insert range:           17 - 289
90th percentile:        36
75th percentile:        31
50th percentile:        29
25th percentile:        25
10th percentile:        21</code></pre>
</div>
</div>
<p>Well, trimming adapters certainly made a difference, as well! Now, 15,533,284 reads get joined (as opposed to 12,649,853 when using just polyG-trimmed reads). The average insert size changes very little, but, oddly, the insert range remains the same (17 - 289).</p>
<p>For kicks, let’s throw the reads that have been trimmed to 31bp into <a href="https://jgi.doe.gov/data-and-tools/software-tools/bbtools/bb-tools-user-guide/bbmerge-guide/">BBMerge</a> and see what happens.</p>
</section>
<section id="trimmed-adapters-polyg-max-length-31bp" class="level3">
<h3 class="anchored" data-anchor-id="trimmed-adapters-polyg-max-length-31bp">Trimmed Adapters &amp; PolyG Max Length 31bp</h3>
<div class="cell" data-hash="index_cache/html/bbmerge-trimmed-adapters-polyG-31bp_4b955ad3b7717bc7716eae0dfb10ad38">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb27-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb27-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb27-3"></span>
<span id="cb27-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bbmerge}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb27-5">in1=./trimmed-reads/fastp-adapters-polyG-31bp.R1.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb27-6">in2=./trimmed-reads/fastp-adapters-polyG-31bp.R2.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb27-7">adapters=./NEB-adapters.fasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb27-8">mininsert=17 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb27-9">out=./trimmed-reads/sRNA-POR-79-S1-TP2-fastp-adapters-polyG-31bp-bbmerge.fq.gz</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>java -ea -Xmx1000m -Xms1000m -Djava.library.path=/home/shared/bbmap-39.06/jni/ -cp /home/shared/bbmap-39.06/current/ jgi.BBMerge in1=./trimmed-reads/fastp-adapters-polyG-31bp.R1.fq.gz in2=./trimmed-reads/fastp-adapters-polyG-31bp.R2.fq.gz adapters=./NEB-adapters.fasta mininsert=17 out=./trimmed-reads/sRNA-POR-79-S1-TP2-fastp-adapters-polyG-31bp-bbmerge.fq.gz
Executing jgi.BBMerge [in1=./trimmed-reads/fastp-adapters-polyG-31bp.R1.fq.gz, in2=./trimmed-reads/fastp-adapters-polyG-31bp.R2.fq.gz, adapters=./NEB-adapters.fasta, mininsert=17, out=./trimmed-reads/sRNA-POR-79-S1-TP2-fastp-adapters-polyG-31bp-bbmerge.fq.gz]
Version 39.06

Writing mergable reads merged.
Started output threads.
Total time: 22.245 seconds.

Pairs:                  13190855
Joined:                 12346728    93.601%
Ambiguous:              0           0.000%
No Solution:            281891      2.137%
Too Short:              562236      4.262%
Adapters Expected:      4           0.000%
Adapters Found:         4           0.000%

Avg Insert:             26.3
Standard Deviation:     4.0
Mode:                   29

Insert range:           17 - 35
90th percentile:        31
75th percentile:        29
50th percentile:        28
25th percentile:        24
10th percentile:        20</code></pre>
</div>
</div>
<p>This resulted in 12,346,728 reads being joined. This is on par with the 12,649,853 reads joined when using just polyG-trimmed reads. Additionally, we see the average insert size is 26.3bp, which is even more inline with what we’d expect for miRNAs (22-24bp), and the insert range is also inline with what we’d expect for these libraries (17 - 35bp). However, this is about 20% fewer reads than the 15,533,284 reads when using polyG- and adapter-trimmed reads.</p>
<p>Maybe I’ll test out the subsequent downstream analyses using these different merging results…</p>
</section>
</section>
<section id="fastqc" class="level2">
<h2 class="anchored" data-anchor-id="fastqc">FastQC</h2>
<div class="cell" data-hash="index_cache/html/fastqc_b252c5a3c872f7262a2bbe5d7685a929">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb29-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb29-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb29-3"></span>
<span id="cb29-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Populate array with FastQ files</span></span>
<span id="cb29-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastq_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span>./trimmed-reads/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.fq.gz<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb29-6"></span>
<span id="cb29-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pass array contents to new variable</span></span>
<span id="cb29-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastqc_list</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastq_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[*]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb29-9"></span>
<span id="cb29-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run FastQC</span></span>
<span id="cb29-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Do NOT quote ${fastqc_list}</span></span>
<span id="cb29-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastqc}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb29-13">--threads <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb29-14">--quiet <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb29-15">--outdir ./ <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb29-16"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastqc_list}</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip
application/gzip</code></pre>
</div>
</div>
</section>
<section id="multiqc" class="level2">
<h2 class="anchored" data-anchor-id="multiqc">MultiQC</h2>
<div class="cell" data-hash="index_cache/html/multiqc_a153be364a759e97ef37e060b6107f9c">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb31-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load bash variables into memory</span></span>
<span id="cb31-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .bashvars</span>
<span id="cb31-3"></span>
<span id="cb31-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${multiqc}</span> .</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  /// MultiQC 🔍 | v1.14

|           multiqc | MultiQC Version v1.20 now available!
|           multiqc | Search path : /home/shared/8TB_HDD_01/sam/gitrepos/RobertsLab/sams-notebook/posts/2024/2024-02-02-sRNA-seq-Paired-Read-Merging-Exploratios---Coral-E5-Deep-Dive
|         searching | ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 111/111  
|            fastqc | Found 13 reports
|           multiqc | Compressing plot data
|           multiqc | Report      : multiqc_report.html
|           multiqc | Data        : multiqc_data
|           multiqc | MultiQC complete</code></pre>
</div>
</div>
<p>Check out the <a href="https://multiqc.info/"><code>MultiQC</code></a> results here (HTML):</p>
<ul>
<li><a href="./multiqc_report.html">MultiQC Report</a></li>
</ul>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-bushnell2017" class="csl-entry">
Bushnell, Brian, Jonathan Rood, and Esther Singer. 2017. <span>“BBMerge <span></span> Accurate Paired Shotgun Read Merging via Overlap.”</span> Edited by Patrick Jon Biggs. <em>PLOS ONE</em> 12 (10): e0185056. <a href="https://doi.org/10.1371/journal.pone.0185056">https://doi.org/10.1371/journal.pone.0185056</a>.
</div>
<div id="ref-chen2023" class="csl-entry">
Chen, Shifu. 2023. <span>“Ultrafast One<span>-</span>Pass FASTQ Data Preprocessing, Quality Control, and Deduplication Using Fastp.”</span> <em>iMeta</em> 2 (2). <a href="https://doi.org/10.1002/imt2.107">https://doi.org/10.1002/imt2.107</a>.
</div>
<div id="ref-chen2018" class="csl-entry">
Chen, Shifu, Yanqing Zhou, Yaru Chen, and Jia Gu. 2018. <span>“Fastp: An Ultra-Fast All-in-One FASTQ Preprocessor.”</span> <em>Bioinformatics</em> 34 (17): i884–90. <a href="https://doi.org/10.1093/bioinformatics/bty560">https://doi.org/10.1093/bioinformatics/bty560</a>.
</div>
<div id="ref-sanchezherrero2021" class="csl-entry">
Sanchez Herrero, Jose Francisco, Raquel Pluvinet, Antonio Luna de Haro, and Lauro Sumoy. 2021. <span>“Paired-End Small RNA Sequencing Reveals a Possible Overestimation in the isomiR Sequence Repertoire Previously Reported from Conventional Single Read Data Analysis.”</span> <em>BMC Bioinformatics</em> 22 (1). <a href="https://doi.org/10.1186/s12859-021-04128-1">https://doi.org/10.1186/s12859-021-04128-1</a>.
</div>
</div></section></div> ]]></description>
  <category>2024</category>
  <category>E5</category>
  <category>sRNA-seq</category>
  <category>merge</category>
  <category>bbmerge</category>
  <category>fastp</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-02-02-sRNA-seq-Paired-Read-Merging-Exploratios---Coral-E5-Deep-Dive/index.html</guid>
  <pubDate>Fri, 02 Feb 2024 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Daily Bits - February 2024</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-02-01-Daily-Bits---February-2024/index.html</link>
  <description><![CDATA[ 




<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section">20240222</h2>
<section id="lab-meeting" class="level3">
<h3 class="anchored" data-anchor-id="lab-meeting">Lab Meeting</h3>
<ul>
<li>Discussed Pub-a-thon 2024</li>
</ul>
</section>
<section id="ceabigr-github-repo" class="level3">
<h3 class="anchored" data-anchor-id="ceabigr-github-repo"><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo)</h3>
<ul>
<li><p>Reviewed recent GitHub Issues</p></li>
<li><p>Worked on creating canonical gene/transcript counts table.</p></li>
</ul>
</section>
<section id="miscellaneous" class="level3">
<h3 class="anchored" data-anchor-id="miscellaneous">Miscellaneous</h3>
<ul>
<li><p>Updated <a href="https://b.link/nightingales"><code>Nightingales</code></a> (Google Sheet) spreadsheet with Cod RNA-seq info.</p></li>
<li><p>Raven was bogged down by some weird rogue <code>git</code> command, so had to reboot.</p></li>
</ul>
</section>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1">20240221</h2>
<section id="miscellaneous-1" class="level3">
<h3 class="anchored" data-anchor-id="miscellaneous-1">Miscellaneous</h3>
<ul>
<li><p><a href="https://github.com/RobertsLab/resources/issues/1806">Set Ariana up with Gannet access</a> (GitHub Issue)</p></li>
<li><p>Received <a href="../../../posts/2024/2024-02-21-Data-Received---Pacific-cod-RNA-seq-Azenta-Project-30-943133806/index.html">Pacific cod RNA-seq data</a></p></li>
</ul>
</section>
<section id="ceabigr-github-repo-1" class="level3">
<h3 class="anchored" data-anchor-id="ceabigr-github-repo-1"><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo)</h3>
<ul>
<li>Generated volcano plots</li>
</ul>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-02-01-Daily-Bits---February-2024/https:/raw.githubusercontent.com/sr320/ceabigr/main/output/18-differential-gene-expression-ballgown/figures/volcano_plot-DEGs-females-CvE.png" class="img-fluid figure-img" alt="Volcano plot of gene expression in females. No genes are differentially expressed. Grey points are genes with p-values <=0.05. Black points are genes with p/q-values > 0.05."></p>
<figcaption class="figure-caption">Volcano plot of gene expression in females. No genes are differentially expressed. Grey points are genes with p-values &lt;=0.05. Black points are genes with p/q-values &gt; 0.05.</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-02-01-Daily-Bits---February-2024/https:/raw.githubusercontent.com/sr320/ceabigr/main/output/18-differential-gene-expression-ballgown/figures/volcano_plot-DETs-females-CvE.png" class="img-fluid figure-img" alt="Volcano plot of transcript expression in females. A single transcript is differentially expressed and is rendered as a blue point and labelled with its associated geneID. Grey points are transcripts with p-values <=0.05. Black points are transcripts with p/q-values > 0.05."></p>
<figcaption class="figure-caption">Volcano plot of transcript expression in females. A single transcript is differentially expressed and is rendered as a blue point and labelled with its associated geneID. Grey points are transcripts with p-values &lt;=0.05. Black points are transcripts with p/q-values &gt; 0.05.</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-02-01-Daily-Bits---February-2024/https:/raw.githubusercontent.com/sr320/ceabigr/main/output/18-differential-gene-expression-ballgown/figures/volcano_plot-DEGs-males-CvE.png" class="img-fluid figure-img" alt="Volcano plot of gene expression in males. No genes are differentially expressed. Grey points are genes with p-values <=0.05. Black points are genes with p/q-values > 0.05."></p>
<figcaption class="figure-caption">Volcano plot of gene expression in males. No genes are differentially expressed. Grey points are genes with p-values &lt;=0.05. Black points are genes with p/q-values &gt; 0.05.</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-02-01-Daily-Bits---February-2024/https:/raw.githubusercontent.com/sr320/ceabigr/main/output/18-differential-gene-expression-ballgown/figures/volcano_plot-DETs-males-CvE.png" class="img-fluid figure-img" alt="Volcano plot of transcript expression in males. No transcripts are differentially expressed. Grey points are transcripts with p-values <=0.05. Black points are transcripts with p/q-values > 0.05."></p>
<figcaption class="figure-caption">Volcano plot of transcript expression in males. No transcripts are differentially expressed. Grey points are transcripts with p-values &lt;=0.05. Black points are transcripts with p/q-values &gt; 0.05</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="section-2" class="level2">
<h2 class="anchored" data-anchor-id="section-2">20240220</h2>
<section id="ceabigr-github-repo-2" class="level3">
<h3 class="anchored" data-anchor-id="ceabigr-github-repo-2"><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo)</h3>
<ul>
<li>Started working on generating volcano plots.</li>
</ul>
</section>
</section>
<section id="section-3" class="level2">
<h2 class="anchored" data-anchor-id="section-3">20240216</h2>
<section id="coral-e5-github-repo" class="level3">
<h3 class="anchored" data-anchor-id="coral-e5-github-repo"><a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo)</h3>
<ul>
<li>Finished running <a href="https://github.com/MikeAxtell/ShortStack"><code>ShortStack</code></a> variations with newly trimmed <em>P.meandrina</em> sRNA-seq.</li>
</ul>
</section>
</section>
<section id="section-4" class="level2">
<h2 class="anchored" data-anchor-id="section-4">20240215</h2>
<section id="coral-e5-github-repo-1" class="level3">
<h3 class="anchored" data-anchor-id="coral-e5-github-repo-1"><a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo)</h3>
<ul>
<li>Ran <a href="https://github.com/MikeAxtell/ShortStack"><code>ShortStack</code></a> variations with newly trimmed <em>P.meandrina</em> sRNA-seq.</li>
</ul>
</section>
</section>
<section id="section-5" class="level2">
<h2 class="anchored" data-anchor-id="section-5">20240214</h2>
<section id="coral-e5-github-repo-2" class="level3">
<h3 class="anchored" data-anchor-id="coral-e5-github-repo-2"><a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo)</h3>
<ul>
<li>Ran <a href="https://github.com/MikeAxtell/ShortStack"><code>ShortStack</code></a> variations with newly trimmed <a href="http://www.coralsoftheworld.org/species_factsheets/species_factsheet_summary/acropora-pulchra/"><em>Acropora pulchra</em></a> sRNA-seq.</li>
</ul>
</section>
</section>
<section id="section-6" class="level2">
<h2 class="anchored" data-anchor-id="section-6">20240213</h2>
<section id="coral-e5-github-repo-3" class="level3">
<h3 class="anchored" data-anchor-id="coral-e5-github-repo-3"><a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo)</h3>
<ul>
<li>Cranked out new trimming on <em>P.meandrina</em> sRNA-seq samples.</li>
</ul>
</section>
</section>
<section id="section-7" class="level2">
<h2 class="anchored" data-anchor-id="section-7">20240212</h2>
</section>
<section id="in-lab" class="level2">
<h2 class="anchored" data-anchor-id="in-lab">In lab</h2>
<ul>
<li>Reviewed reverse transcription and qPCR with Eric.</li>
</ul>
<section id="coral-e5-github-repo-4" class="level3">
<h3 class="anchored" data-anchor-id="coral-e5-github-repo-4"><a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo)</h3>
<ul>
<li>Started running new trimming on <em>A.pulchra</em> sRNA-seq samples (preivously, had just tried with <em>P.evermanni</em>).</li>
</ul>
</section>
</section>
<section id="section-8" class="level2">
<h2 class="anchored" data-anchor-id="section-8">20240209</h2>
</section>
<section id="science-hour" class="level2">
<h2 class="anchored" data-anchor-id="science-hour">Science Hour</h2>
<ul>
<li>Steven and I looked at and discussed the exon expression patterns of individual genes and compared those patterns to the WGCNA outputs which Ariana generated at yesterday’s meeting. Definitely a few individuals whose exon usage seems to deviate a great deal from that WGCNA module assignment…</li>
</ul>
<section id="coral-e5-github-repo-5" class="level3">
<h3 class="anchored" data-anchor-id="coral-e5-github-repo-5"><a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo)</h3>
<ul>
<li>Continued to work on implementing new trimming/merging parameters, but <a href="https://github.com/MikeAxtell/ShortStack/tree/master">ShortStack</a> keeps encountering an <a href="https://github.com/MikeAxtell/ShortStack/issues/146">error</a> (GitHub Issue). I’m hoping the developer can lend some insight. This is weird, because these samples, albeit trimmed with a different program and used as paired-end reads (only trying R1 or merged reads at this point), were successfully analyzed previously…</li>
</ul>
</section>
</section>
<section id="section-9" class="level2">
<h2 class="anchored" data-anchor-id="section-9">20240208</h2>
<section id="lab-meeting-1" class="level3">
<h3 class="anchored" data-anchor-id="lab-meeting-1">Lab meeting</h3>
</section>
<section id="ceabigr-github-repo-3" class="level3">
<h3 class="anchored" data-anchor-id="ceabigr-github-repo-3"><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo)</h3>
<ul>
<li>Special, extended session with Arianna in attendance. She ran some <a href="https://cran.r-project.org/web/packages/WGCNA/WGCNA.pdf">WGCNA</a> (PDF) analysis to try to see how exon expression patterns varied between control/exposed samples. Very cool!</li>
</ul>
</section>
</section>
<section id="section-10" class="level2">
<h2 class="anchored" data-anchor-id="section-10">20240207</h2>
<section id="coral-e5-github-repo-6" class="level3">
<h3 class="anchored" data-anchor-id="coral-e5-github-repo-6"><a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo)</h3>
<ul>
<li><p>Finished messing around with trimming/merging stuff. Here’s the <a href="https://robertslab.github.io/sams-notebook/posts/2024/2024-02-02-sRNA-seq-Paired-Read-Merging-Exploratios---Coral-E5-Deep-Dive/">notebook entry</a>.</p></li>
<li><p>Began implementing new trimming/merging.</p></li>
</ul>
</section>
</section>
<section id="section-11" class="level2">
<h2 class="anchored" data-anchor-id="section-11">20240206</h2>
<section id="coral-e5-github-repo-7" class="level3">
<h3 class="anchored" data-anchor-id="coral-e5-github-repo-7"><a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo)</h3>
<ul>
<li>Continued to explore trimming and merging strategies for sRNA-seq data, using <a href="https://github.com/OpenGene/fastp"><code>fastp</code></a> alone, BBMerge alone, and/or combining the two approaches.</li>
</ul>
</section>
<section id="ceabigr-github-repo-4" class="level3">
<h3 class="anchored" data-anchor-id="ceabigr-github-repo-4"><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo)</h3>
<ul>
<li>Spent a few hours on a video chat with Steven and Yaamini going through exon fold-change code/analysis.</li>
</ul>
</section>
</section>
<section id="section-12" class="level2">
<h2 class="anchored" data-anchor-id="section-12">20240205</h2>
<section id="coral-e5-github-repo-8" class="level3">
<h3 class="anchored" data-anchor-id="coral-e5-github-repo-8"><a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo)</h3>
<ul>
<li>Continued to explore trimming and merging strategies for sRNA-seq data, using <a href="https://github.com/OpenGene/fastp"><code>fastp</code></a> alone, BBMerge alone, and/or combining the two approaches.</li>
</ul>
</section>
</section>
<section id="section-13" class="level2">
<h2 class="anchored" data-anchor-id="section-13">20240202</h2>
<section id="coral-e5-github-repo-9" class="level3">
<h3 class="anchored" data-anchor-id="coral-e5-github-repo-9"><a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo)</h3>
</section>
<section id="science-hour-1" class="level3">
<h3 class="anchored" data-anchor-id="science-hour-1">Science Hour</h3>
<ul>
<li>Steven and I played around with exon fold-change data.</li>
</ul>
</section>
</section>
<section id="section-14" class="level2">
<h2 class="anchored" data-anchor-id="section-14">20240201</h2>
<section id="in-lab-1" class="level3">
<h3 class="anchored" data-anchor-id="in-lab-1">In Lab</h3>
<ul>
<li><p>Lab meeting.</p></li>
<li><p>Helped Eric get started with RNA quantification using Qubit.</p></li>
</ul>
</section>
<section id="coral-e5-github-repo-10" class="level3">
<h3 class="anchored" data-anchor-id="coral-e5-github-repo-10"><a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo)</h3>
<ul>
<li><p>Tested out more R1/R2 merging/trimming using <a href="https://github.com/OpenGene/fastp"><code>fastp</code></a>.</p>
<ul>
<li>Merging is similar to BBMerge results - i.e.&nbsp;a (relatively) small number of reads are actually merging, despite the fact that these should be short insert sizes and R1/R2 reads should overlap…</li>
</ul></li>
<li><p>Installed <a href="https://github.com/HCGB-IGTP/XICRA">XICRA</a> <span class="citation" data-cites="sanchezherrero2021">(Sanchez Herrero et al. 2021)</span> on Raven to identify isomiRs in sRNA-seq data. Possibly to get around the merging “issues” experienced with BBMerge and <a href="https://github.com/OpenGene/fastp"><code>fastp</code></a>.</p>
<ul>
<li><p>Installation was a bit bumpy, due to some weird Conda/Mamba “flexible solve” problem, but got that straightened out with <code>conda config --set channel_priority flexible</code>.</p></li>
<li><p>Installation test(s) had issues. I created the following GitHub Issues on the developer’s site in hopes of getting help:</p></li>
<li><p><a href="https://github.com/HCGB-IGTP/XICRA/issues/47"><code>installer.sh error</code></a></p></li>
<li><p><a href="https://github.com/HCGB-IGTP/XICRA/issues/42">“No samples were retrieved” in test data</a></p></li>
</ul></li>
</ul>
</section>
<section id="ceabigr-github-repo-5" class="level3">
<h3 class="anchored" data-anchor-id="ceabigr-github-repo-5"><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo)</h3>
<ul>
<li>Need to generate R<sup>2</sup> values and slope of exon expression for all genes, Exons 1 - 6.</li>
</ul>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-sanchezherrero2021" class="csl-entry">
Sanchez Herrero, Jose Francisco, Raquel Pluvinet, Antonio Luna de Haro, and Lauro Sumoy. 2021. <span>“Paired-End Small RNA Sequencing Reveals a Possible Overestimation in the isomiR Sequence Repertoire Previously Reported from Conventional Single Read Data Analysis.”</span> <em>BMC Bioinformatics</em> 22 (1). <a href="https://doi.org/10.1186/s12859-021-04128-1">https://doi.org/10.1186/s12859-021-04128-1</a>.
</div>
</div></section></div> ]]></description>
  <category>2024</category>
  <category>Daily Bits</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-02-01-Daily-Bits---February-2024/index.html</guid>
  <pubDate>Thu, 01 Feb 2024 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Figure Updates - CEABIGR Spurious Transcription Calcs and Plotting Using Exon Sum Threshold</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-01-24-Figure-Updates---CEABIGR-Spurious-Transcription-Calcs-and-Plotting-Using-Exon-Sum-Threshold/index.html</link>
  <description><![CDATA[ 




<section id="intro" class="level1">
<h1>Intro</h1>
<p>As part of the <a href="https://github.com/sr320/ceabigr">CEABIGR project</a> (GitHub repo) Steven performed some inital data wrangling to test out the basic calculations to determine the natural log of the fold change in exon expression, relative to Exon 1, for each gene in a single sample. The decision to perform the calculation in this manner was based on <span class="citation" data-cites="li2018">(Li et al. 2018)</span>. <a href="https://robertslab.github.io/sams-notebook/posts/2024/2024-01-03-Data-Exploration---CEABIGR-Spurious-Transcription-Calculations-and-Plotting/">I plotted the results previously (on 20240103)</a>, but that did not include any sort of “normalization” across samples. Further <a href="https://github.com/sr320/ceabigr/issues/88#issuecomment-1908563777">discussion</a> (GitHub Issue) decided to set a threshold based on the sum of reads for Exons 1 -6 per gene, per sample. The value decided on was a minimum sum of 10 reads for Exons 1-6, per gene, across all samples. E.g. If <code>S13M</code> has a sum of 15 reads for Exons 1-6 for a given gene, but <code>S9M</code> only has a sum of 8 reads for Exons 1-6 for that same gene, then that <em>gene</em> is discarded from the fold chane calculations.</p>
<p>This threshold filtering retained 23,101 genes (out of 38,264; 60.4% of genes)</p>
<p>After this, will explore how spurious transcription relates to methylation levels across genes, using this new exon sum threshold.</p>
<p>See <a href="https://github.com/sr320/ceabigr/blob/0b9a89aee179b26bb38b3de401af60cebe8c447b/code/65-exon-coverage.qmd"><code>65-exon-coverage.qmd</code></a> for code.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Code and plots link to commit <code>0b9a89a</code>.</p>
</div>
</div>
</section>
<section id="plots" class="level1">
<h1>Plots</h1>
<p>All plots are line plots of the mean natural log fold-change in exon expression (Exons 2-6), relative to Exon 1. All genes used in the analysis had to Black bars represent standard error.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Plots are simply arranged side-by-side. Scales of axes are <em>not</em> intended to match.</p>
</div>
</div>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-01-24-Figure-Updates---CEABIGR-Spurious-Transcription-Calcs-and-Plotting-Using-Exon-Sum-Threshold/https:/raw.githubusercontent.com/sr320/ceabigr/0b9a89aee179b26bb38b3de401af60cebe8c447b/output/65-exon-coverage/figures/control-females.v.control-males-line_plot.png" class="img-fluid" alt="Line plots of mean natural log fold-change of exon expression relative to Exon 1. Pink line is control females. Blue line is control males. Black bars represent standard error."></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-01-24-Figure-Updates---CEABIGR-Spurious-Transcription-Calcs-and-Plotting-Using-Exon-Sum-Threshold/https:/raw.githubusercontent.com/sr320/ceabigr/0b9a89aee179b26bb38b3de401af60cebe8c447b/output/65-exon-coverage/figures/control-females.v.exposed-females-line_plot.png" class="img-fluid" alt="Line plots of mean natural log fold-change of exon expression relative to Exon 1. Pink line is control females. Blue line is exposed females. Black bars represent standard error."></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-01-24-Figure-Updates---CEABIGR-Spurious-Transcription-Calcs-and-Plotting-Using-Exon-Sum-Threshold/https:/raw.githubusercontent.com/sr320/ceabigr/0b9a89aee179b26bb38b3de401af60cebe8c447b/output/65-exon-coverage/figures/control-males.v.exposed-males-line_plot.png" class="img-fluid" alt="Line plots of mean natural log fold-change of exon expression relative to Exon 1. Pink line is control males. Blue line is exposed males. Black bars represent standard error."></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-01-24-Figure-Updates---CEABIGR-Spurious-Transcription-Calcs-and-Plotting-Using-Exon-Sum-Threshold/https:/raw.githubusercontent.com/sr320/ceabigr/0b9a89aee179b26bb38b3de401af60cebe8c447b/output/65-exon-coverage/figures/controls.v.exposed-line_plot.png" class="img-fluid" alt="Line plots of mean natural log fold-change of exon expression relative to Exon 1. Pink line is controls. Blue line is exposed. Black bars represent standard error."></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-01-24-Figure-Updates---CEABIGR-Spurious-Transcription-Calcs-and-Plotting-Using-Exon-Sum-Threshold/https:/raw.githubusercontent.com/sr320/ceabigr/0b9a89aee179b26bb38b3de401af60cebe8c447b/output/65-exon-coverage/figures/exposed-females.v.exposed-males-line_plot.png" class="img-fluid" alt="Line plots of mean natural log fold-change of exon expression relative to Exon 1. Pink line is exposed females. Blue line is exposed males. Black bars represent standard error."></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-01-24-Figure-Updates---CEABIGR-Spurious-Transcription-Calcs-and-Plotting-Using-Exon-Sum-Threshold/https:/raw.githubusercontent.com/sr320/ceabigr/0b9a89aee179b26bb38b3de401af60cebe8c447b/output/65-exon-coverage/figures/females.v.males-line_plot.png" class="img-fluid" alt="Line plots of mean natural log fold-change of exon expression relative to Exon 1. Pink line is females. Blue line is males. Black bars represent standard error."></p>
</div>
</div>
</div>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-li2018" class="csl-entry">
Li, Yong, Yi Jin Liew, Guoxin Cui, Maha J. Cziesielski, Noura Zahran, Craig T. Michell, Christian R. Voolstra, and Manuel Aranda. 2018. <span>“DNA Methylation Regulates Transcriptional Homeostasis of Algal Endosymbiosis in the Coral Model Aiptasia.”</span> <em>Science Advances</em> 4 (8). <a href="https://doi.org/10.1126/sciadv.aat2142">https://doi.org/10.1126/sciadv.aat2142</a>.
</div>
</div></section></div> ]]></description>
  <category>CEABIGR</category>
  <category>2024</category>
  <category>plot</category>
  <category>Eastern oyster</category>
  <category>Crassostrea virginica</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-01-24-Figure-Updates---CEABIGR-Spurious-Transcription-Calcs-and-Plotting-Using-Exon-Sum-Threshold/index.html</guid>
  <pubDate>Wed, 24 Jan 2024 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Data Exploration - CEABIGR Spurious Transcription Calculations and Plotting</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-01-03-Data-Exploration---CEABIGR-Spurious-Transcription-Calculations-and-Plotting/index.html</link>
  <description><![CDATA[ 




<section id="intro" class="level1">
<h1>Intro</h1>
<p>As part of the <a href="https://github.com/sr320/ceabigr">CEABIGR project</a> (GitHub repo) Steven performed some inital data wrangling to test out the basic calculations to determine the natural log of the fold change in exon expression, relative to Exon 1, for each gene in a single sample. The decision to perform the calculation in this manner was based on <span class="citation" data-cites="li2018">(Li et al. 2018)</span>. I took the next steps to perform this across all samples, as well as generate some comparison plots. After this, will explore how spurious transcription relates to methylation levels across genes.</p>
<p>See <a href="https://github.com/sr320/ceabigr/blob/585fb039e7d7b12295781f0a0141e84eee901631/code/65-exon-coverage.qmd"><code>65-exon-coverage.qmd</code></a> for code.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Code and plots link to commit <code>585fb03</code>.</p>
</div>
</div>
</section>
<section id="plots" class="level1">
<h1>Plots</h1>
<p>All plots are line plots of the mean natural log fold-change in exon expression (Exons 2-6), relative to Exon 1. Black bars represent standard error.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Plots are simply arranged side-by-side. Scales of axes are <em>not</em> intended to match.</p>
</div>
</div>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-01-03-Data-Exploration---CEABIGR-Spurious-Transcription-Calculations-and-Plotting/https:/raw.githubusercontent.com/sr320/ceabigr/585fb039e7d7b12295781f0a0141e84eee901631/output/65-exon-coverage/figures/control-females.v.control-males-line_plot.png" class="img-fluid" alt="Line plots of mean natural log fold-change of exon expression relative to Exon 1. Pink line is control females. Blue line is control males. Black bars represent standard error."></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-01-03-Data-Exploration---CEABIGR-Spurious-Transcription-Calculations-and-Plotting/https:/raw.githubusercontent.com/sr320/ceabigr/585fb039e7d7b12295781f0a0141e84eee901631/output/65-exon-coverage/figures/control-females.v.exposed-females-line_plot.png" class="img-fluid" alt="Line plots of mean natural log fold-change of exon expression relative to Exon 1. Pink line is control females. Blue line is exposed females. Black bars represent standard error."></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-01-03-Data-Exploration---CEABIGR-Spurious-Transcription-Calculations-and-Plotting/https:/raw.githubusercontent.com/sr320/ceabigr/585fb039e7d7b12295781f0a0141e84eee901631/output/65-exon-coverage/figures/control-males.v.exposed-males-line_plot.png" class="img-fluid" alt="Line plots of mean natural log fold-change of exon expression relative to Exon 1. Pink line is control males. Blue line is exposed males. Black bars represent standard error."></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-01-03-Data-Exploration---CEABIGR-Spurious-Transcription-Calculations-and-Plotting/https:/raw.githubusercontent.com/sr320/ceabigr/585fb039e7d7b12295781f0a0141e84eee901631/output/65-exon-coverage/figures/controls.v.exposed-line_plot.png" class="img-fluid" alt="Line plots of mean natural log fold-change of exon expression relative to Exon 1. Pink line is controls. Blue line is exposed. Black bars represent standard error."></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-01-03-Data-Exploration---CEABIGR-Spurious-Transcription-Calculations-and-Plotting/https:/raw.githubusercontent.com/sr320/ceabigr/585fb039e7d7b12295781f0a0141e84eee901631/output/65-exon-coverage/figures/exposed-females.v.exposed-males-line_plot.png" class="img-fluid" alt="Line plots of mean natural log fold-change of exon expression relative to Exon 1. Pink line is exposed females. Blue line is exposed males. Black bars represent standard error."></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2024/2024-01-03-Data-Exploration---CEABIGR-Spurious-Transcription-Calculations-and-Plotting/https:/raw.githubusercontent.com/sr320/ceabigr/585fb039e7d7b12295781f0a0141e84eee901631/output/65-exon-coverage/figures/females.v.males-line_plot.png" class="img-fluid" alt="Line plots of mean natural log fold-change of exon expression relative to Exon 1. Pink line is females. Blue line is males. Black bars represent standard error."></p>
</div>
</div>
</div>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-li2018" class="csl-entry">
Li, Yong, Yi Jin Liew, Guoxin Cui, Maha J. Cziesielski, Noura Zahran, Craig T. Michell, Christian R. Voolstra, and Manuel Aranda. 2018. <span>“DNA Methylation Regulates Transcriptional Homeostasis of Algal Endosymbiosis in the Coral Model Aiptasia.”</span> <em>Science Advances</em> 4 (8). <a href="https://doi.org/10.1126/sciadv.aat2142">https://doi.org/10.1126/sciadv.aat2142</a>.
</div>
</div></section></div> ]]></description>
  <category>2024</category>
  <category>CEABIGR</category>
  <category>plot</category>
  <category>Eastern oyster</category>
  <category>Crassostrea virginica</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-01-03-Data-Exploration---CEABIGR-Spurious-Transcription-Calculations-and-Plotting/index.html</guid>
  <pubDate>Wed, 03 Jan 2024 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Daily Bits - January 2024</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2024/2024-01-02-Daily-Bits---January-2024/index.html</link>
  <description><![CDATA[ 




<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section">20240131</h2>
<section id="coral-e5-github-repo" class="level3">
<h3 class="anchored" data-anchor-id="coral-e5-github-repo"><a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo)</h3>
<ul>
<li>Messed around with BBtools for merging and/or trimming paired sRNA-seq reads. Seems like this won’t work, on either front!</li>
</ul>
</section>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1">20240130</h2>
<section id="miscellaneous-lab-stuff" class="level3">
<h3 class="anchored" data-anchor-id="miscellaneous-lab-stuff">Miscellaneous Lab Stuff</h3>
<ul>
<li><p>Helped Chris troubleshoot her SOD assay standard curve. She felt like her samples SOD activity was too low and falling outside of the standard curve.</p>
<ul>
<li><p>Tried to evaluate BCA results - no raw data, though.</p></li>
<li><p>Looked through the SOD protocol.</p></li>
<li><p>Confirmed that her samples fell within the standard curve of the SOD assay and that everything was A-OK!</p></li>
</ul></li>
<li><p>Went to eye doctor, eyes dilated, and couldn’t see/read anything for the rest of the day!</p></li>
</ul>
</section>
<section id="coral-e5-github-repo-1" class="level3">
<h3 class="anchored" data-anchor-id="coral-e5-github-repo-1"><a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo)</h3>
<ul>
<li>Continued to explore sRNA-seq read trimming options.</li>
</ul>
</section>
</section>
<section id="section-2" class="level2">
<h2 class="anchored" data-anchor-id="section-2">20240129</h2>
<section id="ceabigr-github-repo" class="level3">
<h3 class="anchored" data-anchor-id="ceabigr-github-repo"><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo)</h3>
<ul>
<li>Did more work on exon stuff.</li>
</ul>
</section>
<section id="coral-e5-github-repo-2" class="level3">
<h3 class="anchored" data-anchor-id="coral-e5-github-repo-2"><a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo)</h3>
<ul>
<li>Read through a few papers about sRNA-seq trimming/analyses.</li>
</ul>
</section>
</section>
<section id="section-3" class="level2">
<h2 class="anchored" data-anchor-id="section-3">20240126</h2>
<section id="science-hour" class="level3">
<h3 class="anchored" data-anchor-id="science-hour">Science Hour</h3>
<ul>
<li>Worked on more <a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo) exon stuff with Steven.</li>
</ul>
</section>
</section>
<section id="section-4" class="level2">
<h2 class="anchored" data-anchor-id="section-4">20240125</h2>
<section id="lab-meeting" class="level3">
<h3 class="anchored" data-anchor-id="lab-meeting">Lab Meeting</h3>
<ul>
<li>Read Ch.5 of “Race After Technology”</li>
</ul>
</section>
<section id="ceabigr-github-repo-1" class="level3">
<h3 class="anchored" data-anchor-id="ceabigr-github-repo-1"><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo)</h3>
<ul>
<li><p>Weekly meeting.</p></li>
<li><p>Explored exon coverage with Steven.</p></li>
</ul>
</section>
</section>
<section id="section-5" class="level2">
<h2 class="anchored" data-anchor-id="section-5">20240124</h2>
<section id="ceabigr-github-repo-2" class="level3">
<h3 class="anchored" data-anchor-id="ceabigr-github-repo-2"><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo)</h3>
<ul>
<li>Implemented exon sum threshold <a href="../../../posts/2024/2024-01-24-Figure-Updates---CEABIGR-Spurious-Transcription-Calcs-and-Plotting-Using-Exon-Sum-Threshold/index.html">to update ln(fold change vs Exon 1) determinations</a> (Notebook).</li>
</ul>
</section>
</section>
<section id="section-6" class="level2">
<h2 class="anchored" data-anchor-id="section-6">20240123</h2>
<section id="miscellaneous-lab-stuff-1" class="level3">
<h3 class="anchored" data-anchor-id="miscellaneous-lab-stuff-1">Miscellaneous lab stuff</h3>
<ul>
<li>Helped answer some questions Eric had regarding RNA isolation.</li>
</ul>
</section>
<section id="ceabigr-github-repo-3" class="level3">
<h3 class="anchored" data-anchor-id="ceabigr-github-repo-3"><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo)</h3>
<ul>
<li>Worked extensively on <a href="https://github.com/sr320/ceabigr/blob/6b4bf89801a50180993331a927830d820b42e5e3/code/65-exon-coverage.qmd#L437-L486">exon sum threshold</a>.</li>
</ul>
</section>
<section id="coral-e5-github-repo-3" class="level3">
<h3 class="anchored" data-anchor-id="coral-e5-github-repo-3"><a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo)</h3>
<ul>
<li>Answered some questions Danielle Becker had regarding Zymo’s RiboFree rRNA depletion and whether or not it works for marine organisms (does not work for marine molluscs…).</li>
</ul>
</section>
</section>
<section id="section-7" class="level2">
<h2 class="anchored" data-anchor-id="section-7">20240122</h2>
<section id="ceabigr-github-repo-4" class="level3">
<h3 class="anchored" data-anchor-id="ceabigr-github-repo-4"><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo)</h3>
<ul>
<li><p><a href="https://github.com/sr320/ceabigr/issues/88#issuecomment-1904556525">Steven decided on exon coverage threshold of 100 reads</a> (GitHub Issue).</p></li>
<li><p>Fleshed out more of the exon coverage threshold code.</p></li>
</ul>
</section>
<section id="miscellaneous-lab-stuff-2" class="level3">
<h3 class="anchored" data-anchor-id="miscellaneous-lab-stuff-2">Miscellaneous lab stuff</h3>
<ul>
<li>Got <a href="https://github.com/RobertsLab/resources/issues/1732#issuecomment-1904854424">updated quote for Cod WGBS</a> (GitHub Issue).</li>
</ul>
</section>
</section>
<section id="section-8" class="level2">
<h2 class="anchored" data-anchor-id="section-8">20240119</h2>
<ul>
<li><p>Science Hour</p></li>
<li><p>Helped walk Eric (virtually) through lab to get ready for RNA isolations.</p></li>
</ul>
<section id="ceabigr-github-repo-5" class="level3">
<h3 class="anchored" data-anchor-id="ceabigr-github-repo-5"><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo)</h3>
<ul>
<li>Continued work I started on setting exon coverage threshold.</li>
</ul>
</section>
</section>
<section id="section-9" class="level2">
<h2 class="anchored" data-anchor-id="section-9">20240111</h2>
<ul>
<li>Started getting students Raven access for Steven’s course in Chile.</li>
</ul>
<section id="coral-e5-github-repo-4" class="level3">
<h3 class="anchored" data-anchor-id="coral-e5-github-repo-4"><a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo)</h3>
<ul>
<li><p>Need to test out Azenta recommended trimming parameters.</p></li>
<li><p>Worked briefly on manuscript.</p></li>
</ul>
</section>
</section>
<section id="section-10" class="level2">
<h2 class="anchored" data-anchor-id="section-10">2024010</h2>
<section id="lab-meeting-1" class="level3">
<h3 class="anchored" data-anchor-id="lab-meeting-1">Lab meeting</h3>
</section>
<section id="ceabigr-github-repo-6" class="level3">
<h3 class="anchored" data-anchor-id="ceabigr-github-repo-6"><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo)</h3>
<ul>
<li><p>Yaamini and I reviewed spurious transcription data and determined some next steps:</p>
<ul>
<li><p>Spurious transcription calcs associated with different levels of gene methylation.</p></li>
<li><p>Determine the slope of the ln(fold-change exon expression) per gene.</p></li>
</ul></li>
</ul>
</section>
</section>
<section id="section-11" class="level2">
<h2 class="anchored" data-anchor-id="section-11">20240109</h2>
<ul>
<li>Power outage all day…</li>
</ul>
</section>
<section id="section-12" class="level2">
<h2 class="anchored" data-anchor-id="section-12">20240108</h2>
<p>In lab:</p>
<ul>
<li><p>Sent <a href="https://github.com/RobertsLab/resources/issues/1764">replacement liver samples for Cod RNA-seq project</a> (GitHub Issue).</p></li>
<li><p>Helped Noah get mercuric chloride waste transferred to EH&amp;S carboys in FTR 228.</p></li>
<li><p>Had to do a fresh install of R on <code>swoose</code>. Took awhile…</p></li>
</ul>
</section>
<section id="section-13" class="level2">
<h2 class="anchored" data-anchor-id="section-13">20240105</h2>
<ul>
<li>Science Hour</li>
</ul>
<section id="ceabigr-github-repo-7" class="level3">
<h3 class="anchored" data-anchor-id="ceabigr-github-repo-7"><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo)</h3>
<ul>
<li>Started to look into where (if?) we have methylation data on a per gene basis to plot vs.&nbsp;exon fold-change data from 20240103</li>
</ul>
</section>
</section>
<section id="section-14" class="level2">
<h2 class="anchored" data-anchor-id="section-14">20240104</h2>
<ul>
<li><p>Disabled Sensaphone input #3 due to frequent calls. This is the sensor for the “middle” -80<sup>o</sup>C freezer. This is an older freezer from a former professor, so I’m not sure we have any info on how to set it up, but I will see if I can figure out how to change the freezer temp limits, instead of disabling the Sensaphone.</p></li>
<li><p>Investigated <a href="">a budget spending discrepancy issue</a> (GitHub Issue).</p></li>
<li><p>Added a <a href="https://github.com/RobertsLab/tusk/blob/main/modules/05-computers.qmd">page about RStudio Server access on Raven</a> on the <a href="https://robertslab.github.io/tusk/">tusk</a> website, per <a href="https://github.com/RobertsLab/resources/issues/1776">this GitHub Issue.</a></p></li>
</ul>
</section>
<section id="section-15" class="level2">
<h2 class="anchored" data-anchor-id="section-15">20240103</h2>
<section id="ceabigr-github-repo-8" class="level3">
<h3 class="anchored" data-anchor-id="ceabigr-github-repo-8"><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo)</h3>
<ul>
<li><p>Worked extensively on <a href="https://github.com/sr320/ceabigr/blob/main/code/65-exon-coverage.qmd">calculating mean, natural log fold change of Exons 2 - 6, relative to Exon 1 expression across all genes, in all samples</a>.</p></li>
<li><p>Generated line plots of the various possible comparisons.</p></li>
</ul>
</section>
</section>
<section id="section-16" class="level2">
<h2 class="anchored" data-anchor-id="section-16">20240102</h2>


</section>

 ]]></description>
  <category>2024</category>
  <category>Daily Bits</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2024/2024-01-02-Daily-Bits---January-2024/index.html</guid>
  <pubDate>Tue, 02 Jan 2024 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Computer Management - Returned Failing HDDs from Gannet Expansion Unit</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-12-21-Computer-Management---Returned-Failing-HDDs-from-Gannet-Expansion-Unit/index.html</link>
  <description><![CDATA[ 




<p>After replacing the <a href="https://robertslab.github.io/sams-notebook/posts/2023/2023-12-07-Computer-Maintenance---Replace-Failing-HDDs-in-Synology-RX1217-Expansion-Unit-on-Gannet/">three failing HDDs in the Gannet (Synology) expansion unit</a>, I contacted the company (Maestro Technology LLC) via Amazon. They have been very responsive and very helpful, with no resistance whatsoever. They indicated the drives were new when I ordered them and they seemed surprised that the warranties for all three had already expired.</p>
<p>Regardless, they simply said they’ll replace the threee drives once they receive these three failing HDDs. They provided a return shipping lable for FedEx, so I packaged up the HDDs and sent them back. Hopefully we’ll hear back soon.</p>



 ]]></description>
  <category>computer management</category>
  <category>2023</category>
  <category>HDDs</category>
  <category>gannet</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-12-21-Computer-Management---Returned-Failing-HDDs-from-Gannet-Expansion-Unit/index.html</guid>
  <pubDate>Thu, 21 Dec 2023 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Samples Submitted - Gadus macrocephalus liver tissues to Azenta for RNA-seq</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-12-18-Samples-Submitted---Gadus-macrocephalus-liver-tissues-to-Azenta-for-RNA-seq/index.html</link>
  <description><![CDATA[ 




<p>Shipped box of 80 Pacific cod tissues selected by Steven (mostly liver, some blood, gills, and spleen) to Azenta overnight on dry ice for RNA-seq.</p>
<p>Sample sheet provided to Azenta:</p>
<table class="table">
<colgroup>
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>General Information</th>
<th></th>
<th></th>
<th></th>
<th>Amount of Material</th>
<th></th>
<th></th>
<th>Miscellaneous</th>
<th></th>
<th>QC Method Used By Customer</th>
<th></th>
<th></th>
<th>Special Comments</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Sample Name*</td>
<td>Sample Type*</td>
<td>Species/Strain*</td>
<td>Sample Buffer*</td>
<td>Total Amount*</td>
<td>Volume (µL)</td>
<td>Conc (ng/µL)</td>
<td>Purification Method*</td>
<td>Biosafety Level (BSL)</td>
<td>Method Used for Fluorescence</td>
<td>Method Used for Spectrophotometry</td>
<td>Method Used for Electrophoresis</td>
<td></td>
</tr>
<tr class="even">
<td>1</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>2</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>3</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>4</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>5</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>10</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>11</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>12</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>13</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>18</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>19</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>20</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>21</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>28</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>29</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>30</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>31</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>37</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>38</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>39</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>40</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>41</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>47</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>48</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>49</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>50</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>57</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>58</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>59</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>60</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>67</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>68</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>69</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>70</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>78</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>79</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>80</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>83</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>88</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>90</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>90-dup</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver - accidental duplicate of 90. No need to process second tube labelled “90”.</td>
</tr>
<tr class="odd">
<td>91</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>92</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>97</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>98</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>99</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>100</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>107</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>108</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>109</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>110</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>117</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>118</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>119</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>120</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>121</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>127</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>128</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>129</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>131</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>137</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>138</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>139</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>140</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>147</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>148</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>149</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="odd">
<td>150</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>liver</td>
</tr>
<tr class="even">
<td>19-B</td>
<td>Cells in RNALater</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>10^8 cells</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>blood</td>
</tr>
<tr class="odd">
<td>20-B</td>
<td>Cells in RNALater</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>10^8 cells</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>blood</td>
</tr>
<tr class="even">
<td>57-B</td>
<td>Cells in RNALater</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>10^8 cells</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>blood</td>
</tr>
<tr class="odd">
<td>58-B</td>
<td>Cells in RNALater</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>10^8 cells</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>blood</td>
</tr>
<tr class="even">
<td>19-G</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>gill</td>
</tr>
<tr class="odd">
<td>20-G</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>gill</td>
</tr>
<tr class="even">
<td>57-G</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>gill</td>
</tr>
<tr class="odd">
<td>58-G</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>gill</td>
</tr>
<tr class="even">
<td>19-S</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>spleen</td>
</tr>
<tr class="odd">
<td>20-S</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>spleen</td>
</tr>
<tr class="even">
<td>57-S</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>spleen</td>
</tr>
<tr class="odd">
<td>58-S</td>
<td>Fresh Frozen Tissue</td>
<td>Gadus macrocephalus</td>
<td>NA</td>
<td>30mg</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>spleen</td>
</tr>
</tbody>
</table>



 ]]></description>
  <category>2023</category>
  <category>Gadus macrocephalus</category>
  <category>Pacific cod</category>
  <category>Azenta</category>
  <category>RNA-seq</category>
  <category>Samples Submitted</category>
  <category>liver</category>
  <category>spleen</category>
  <category>gill</category>
  <category>blood</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-12-18-Samples-Submitted---Gadus-macrocephalus-liver-tissues-to-Azenta-for-RNA-seq/index.html</guid>
  <pubDate>Mon, 18 Dec 2023 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Computer Maintenance - Replace Failing HDDs in Synology RX1217 Expansion Unit on Gannet</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-12-07-Computer-Maintenance---Replace-Failing-HDDs-in-Synology-RX1217-Expansion-Unit-on-Gannet/index.html</link>
  <description><![CDATA[ 




<p>In mid-Novemeber, our Synology RX1217 expansion unit on Gannet generated erros for <em>three</em> drives. Considering this unit, and the corresponding HDDs, were installed in July, this is highly disappointing. Plus, these are 18TB HDDs and are not cheap to replace.</p>
<div id="fig-synology_table" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-12-07-Computer-Maintenance---Replace-Failing-HDDs-in-Synology-RX1217-Expansion-Unit-on-Gannet/20231207-syno-logs-HDD-failures.png" class="img-fluid figure-img" alt="Synology logs showing three drives failing S.M.A.R.T. tests"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Three drive failures</figcaption>
</figure>
</div>
<p>Ordered three replacement drives (Seagate Iron Wolf Pro; 16TB) and they finally arrived. I swapped two of the drives, following the Synology Storage Manager wizard, but had to wait for the drives to go through various checks before I could install the third (will do this this weekend).</p>
<p>However, when trying to investigate the drive failures using Seagate’s SeaTools, both drives passed the “generic short test”. However, neither drive could complete the “generic long test.” No errors were generated, just that the “generic long test” failed. When I registered the drives with Seagate, Seagate indicated that the drives’ warranties ended on 11/27/2023! These were brand new drives purchased in July 2023! The warranty should be significantly longer than 5 months.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-12-07-Computer-Maintenance---Replace-Failing-HDDs-in-Synology-RX1217-Expansion-Unit-on-Gannet/20231207-seagate-hdd-registration-expired.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Three HDDs registered with Seagate showing they’re out of warranty as of 20231127</figcaption>
</figure>
</div>
<p>Although, I did find some info suggesting that these failing drives are possibly linked to a Synology database error which is sometimes related to power outages (which just so happens to be when we started getting these errors…) here:</p>
<p>https://www.synoforum.com/threads/reset-drive-critical-state.8787/</p>
<p>I’m not going to pursue that route because these drives should still be under warranty.</p>
<p>Will reach out to the vendor via Amazon to see what can be done about this…</p>



 ]]></description>
  <category>gannet</category>
  <category>synology</category>
  <category>RX1217</category>
  <category>HDDs</category>
  <category>2023</category>
  <category>computer maintenance</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-12-07-Computer-Maintenance---Replace-Failing-HDDs-in-Synology-RX1217-Expansion-Unit-on-Gannet/index.html</guid>
  <pubDate>Thu, 07 Dec 2023 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Data Investigation - Mysterious Case of Excessive Exons in CEABIGR</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-12-06-Data-Investigation---Mysterious-Case-of-Excessive-Exons-in-CEABIGR/index.html</link>
  <description><![CDATA[ 




<p>After Steven <a href="https://github.com/sr320/ceabigr/issues/86#issuecomment-1816557386">ran through some prelimiary exon expression analyses</a> (GitHub Isse), he noticed that there were some genes with a seemingly excessive number of exons (like over 800!). Seeing that, I’ve decided to do some investigation to see if these gene feature annotations stem from the source (i.e.&nbsp;from NCBI GFF) or were introduced accidentally through some subsequent data analysis/manipulations.</p>
<p>First, let’s look at a file which appears to provide mappings of GeneIDs and exons:</p>
<section id="investigate-genome-featuresc_virginica-3.0_gnomon_exon-geneid.bed" class="level1">
<h1>Investigate <code>genome-features/C_virginica-3.0_Gnomon_exon-geneID.bed</code></h1>
<section id="inspect-exon-geneid-mapping-file" class="level2">
<h2 class="anchored" data-anchor-id="inspect-exon-geneid-mapping-file">Inspect exon-geneID mapping file</h2>
<p>This might be a poor place to start, as this file exists in a directory with no README. As such, I’m not certain of the source of this file…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> /home/sam/gitrepos/ceabigr/genome-features/C_virginica-3.0_Gnomon_exon-geneID.bed</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NC_035780.1 13578   13603   gene-LOC111116054
NC_035780.1 14237   14290   gene-LOC111116054
NC_035780.1 14557   14594   gene-LOC111116054
NC_035780.1 28961   29073   gene-LOC111126949
NC_035780.1 30524   31557   gene-LOC111126949
NC_035780.1 31736   31887   gene-LOC111126949
NC_035780.1 31977   32565   gene-LOC111126949
NC_035780.1 32959   33324   gene-LOC111126949
NC_035780.1 66869   66897   gene-LOC111110729
NC_035780.1 64123   64334   gene-LOC111110729</code></pre>
</div>
</div>
<p>This appears to have all exons start/stop locations for each gene. At least, that’s my assumption, based off of the filename.</p>
</section>
<section id="count-exons-per-gene-in-c_virginica-3.0_gnomon_exon-geneid.bed" class="level2">
<h2 class="anchored" data-anchor-id="count-exons-per-gene-in-c_virginica-3.0_gnomon_exon-geneid.bed">Count exons per gene in <code>C_virginica-3.0_Gnomon_exon-geneID.bed</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print $4}'</span> /home/sam/gitrepos/ceabigr/genome-features/C_virginica-3.0_Gnomon_exon-geneID.bed <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uniq</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--count</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--numeric-sort</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--reverse</span>  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-k1,1</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   2889 gene-LOC111108212
   2600 gene-LOC111125463
   2237 gene-LOC111125330
   1559 gene-LOC111130297
   1557 gene-LOC111112605
   1555 gene-LOC111128998
   1540 gene-LOC111122636
   1506 gene-LOC111107250
   1384 gene-LOC111125942
   1383 gene-LOC111133666</code></pre>
</div>
</div>
<p>Well, this shows us that this file indeed has many, many genes with <em>thousands</em> of exons! This is highly dubious, so let’s glance at the NCBI GFF to see if this is “real” or not.</p>
</section>
</section>
<section id="inspect-ncbi-gff" class="level1">
<h1>Inspect NCBI GFF</h1>
<section id="decompress-ncbi-gff" class="level2">
<h2 class="anchored" data-anchor-id="decompress-ncbi-gff">Decompress NCBI GFF</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gunzip</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--keep</span> /home/sam/gitrepos/ceabigr/genome-features/GCF_002022765.2_C_virginica-3.0_genomic.gff.gz</span></code></pre></div>
</div>
</section>
<section id="search-for-genes-with-high-number-of-exons" class="level2">
<h2 class="anchored" data-anchor-id="search-for-genes-with-high-number-of-exons">Search for gene(s) with high number of exons</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Exons in the GFF do <em>not</em> refer to the full parent gene ID!</p>
<p>Need to use truncated version. E.g. <code>LOC111108212</code></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\t"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$3 == "exon"'</span> /home/sam/gitrepos/ceabigr/genome-features/GCF_002022765.2_C_virginica-3.0_genomic.gff <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene=LOC111110729"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>5</code></pre>
</div>
</div>
<p>So, the exon counts in <code>genome-features/C_virginica-3.0_Gnomon_exon-geneID.bed</code> are indeed artificial!</p>
<p>Now that I’ve investigated that, I probably should’ve just started with the input files that Steven was using in the first place. However, this certainly identifies a problematic file that should likely be removed from the repo…</p>
<p>Let’s look at the data Steven was working with and see what we can figure out.</p>
</section>
</section>
<section id="inspect-output19-exon-expressions12m-exon_expression.tab" class="level1">
<h1>Inspect <code>output/19-exon-expression/S12M-exon_expression.tab</code></h1>
<section id="count-colums-in-output19-exon-expressions12m-exon_expression.tab" class="level2">
<h2 class="anchored" data-anchor-id="count-colums-in-output19-exon-expressions12m-exon_expression.tab">Count colums in <code>output/19-exon-expression/S12M-exon_expression.tab</code></h2>
<p>Due to the layout of this file (a column for each possible number of exons across <em>all</em> genes), the head command will produce an unwieldy output. Instead, we’ll just count the number of columns (fields) to get an idea of what we’re dealing with.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We subtract <code>1</code> to account for the first column</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">S12M.columns <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"awk '{print NF-1}' /home/sam/gitrepos/ceabigr/output/19-exon-expression/S12M-exon_expression.tab | sort --unique"</span>,</span>
<span id="cb8-2">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intern =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</div>
<p>Well, we’re seeing that there is a <em>maximum</em> number of exons across <em>all</em> genes: 462</p>
<p>Next let’s see if we can ID the gene with 462 exons.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb9-2"></span>
<span id="cb9-3">S12M.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/sam/gitrepos/ceabigr/output/19-exon-expression/S12M-exon_expression.tab"</span>,</span>
<span id="cb9-4">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb9-5"></span>
<span id="cb9-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(S12M.df)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   38838 obs. of  463 variables:
 $ gene_name: chr  "gene-LOC111116054" "gene-LOC111126949" "gene-LOC111110729" "gene-LOC111112434" ...
 $ exon_1   : int  130 22 282 24 69 416 193 23 23 3 ...
 $ exon_2   : int  103 180 63 40 39 NA 106 173 173 1 ...
 $ exon_3   : int  9 35 55 123 86 NA NA 3 NA 2 ...
 $ exon_4   : int  NA 110 11 NA 21 NA NA 1 NA 2 ...
 $ exon_5   : int  NA 47 NA NA 85 NA NA 2 NA NA ...
 $ exon_6   : int  NA NA NA NA NA NA NA 2 NA NA ...
 $ exon_7   : int  NA NA NA NA NA NA NA 75 NA NA ...
 $ exon_8   : int  NA NA NA NA NA NA NA 214 NA NA ...
 $ exon_9   : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_10  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_11  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_12  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_13  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_14  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_15  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_16  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_17  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_18  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_19  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_20  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_21  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_22  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_23  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_24  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_25  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_26  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_27  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_28  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_29  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_30  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_31  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_32  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_33  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_34  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_35  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_36  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_37  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_38  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_39  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_40  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_41  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_42  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_43  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_44  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_45  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_46  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_47  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_48  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_49  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_50  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_51  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_52  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_53  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_54  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_55  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_56  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_57  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_58  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_59  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_60  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_61  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_62  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_63  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_64  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_65  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_66  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_67  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_68  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_69  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_70  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_71  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_72  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_73  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_74  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_75  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_76  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_77  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_78  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_79  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_80  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_81  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_82  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_83  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_84  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_85  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_86  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_87  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_88  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_89  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_90  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_91  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_92  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_93  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_94  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_95  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_96  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_97  : int  NA NA NA NA NA NA NA NA NA NA ...
 $ exon_98  : int  NA NA NA NA NA NA NA NA NA NA ...
  [list output truncated]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">result <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> S12M.df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(exon_462) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[0-9]"</span>, exon_462))</span>
<span id="cb11-3"></span>
<span id="cb11-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(result<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gene_name)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "gene-LOC111119012"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">selected_gene_names <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> result<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gene_name</span></code></pre></div>
</div>
<p>Okay, we’ve identified gene-LOC111119012 as the gene which contains 462. Let’s see if this matches the original NCBI GFF.</p>
</section>
<section id="compare-number-of-exons-in-gene-loc111119012-between-s12m-exon_expression.tab-and-gcf_002022765.2_c_virginica-3.0_genomic.gff" class="level2">
<h2 class="anchored" data-anchor-id="compare-number-of-exons-in-gene-loc111119012-between-s12m-exon_expression.tab-and-gcf_002022765.2_c_virginica-3.0_genomic.gff">Compare number of exons in gene-LOC111119012 between <code>S12M-exon_expression.tab</code> and <code>GCF_002022765.2_C_virginica-3.0_genomic.gff</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\t"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$3 == "exon"'</span> /home/sam/gitrepos/ceabigr/genome-features/GCF_002022765.2_C_virginica-3.0_genomic.gff <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene=LOC111119012"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>268</code></pre>
</div>
</div>
<p>Okay, they do <em>not</em> match, which points to an issue with <code>S12M-exon_expression.tab</code>! I generated that file in <a href="https://github.com/sr320/ceabigr/blob/main/code/19-exon-expression.Rmd"><code>19-exon-expression.Rmd</code></a> using the Ballgown exon file (<code>e_data.ctab</code>) file as a source. Let’s check that first before I re-examine <a href="https://github.com/sr320/ceabigr/blob/main/code/19-exon-expression.Rmd"><code>19-exon-expression.Rmd</code></a>.</p>
</section>
</section>
<section id="compare-total-exons-in-e_data.ctab-and-gcf_002022765.2_c_virginica-3.0_genomic.gff" class="level1">
<h1>Compare total exons in <code>e_data.ctab</code> and <code>GCF_002022765.2_C_virginica-3.0_genomic.gff</code></h1>
<section id="count-exons-in-s12m-e_data.ctab." class="level2">
<h2 class="anchored" data-anchor-id="count-exons-in-s12m-e_data.ctab.">Count exons in S12M <code>e_data.ctab</code>.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">S12M.edata.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/sam/gitrepos/ceabigr/data/ballgown/S12M/e_data.ctab"</span>,</span>
<span id="cb16-2">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb16-3"></span>
<span id="cb16-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(S12M.edata.df)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   352757 obs. of  12 variables:
 $ e_id   : int  1 2 3 4 5 6 7 8 9 10 ...
 $ chr    : chr  "NC_007175.2" "NC_007175.2" "NC_007175.2" "NC_007175.2" ...
 $ strand : chr  "+" "+" "+" "+" ...
 $ start  : int  1 1710 8250 2645 3430 3499 3578 3647 4897 5673 ...
 $ end    : int  1623 2430 8997 3429 3495 3567 3646 4859 5589 5743 ...
 $ rcount : int  3406 26400 15868 1336 52 53 41 2586 1190 38 ...
 $ ucount : int  3406 26400 15868 1336 52 53 41 2585 1190 38 ...
 $ mrcount: num  3406 26400 15868 1336 52 ...
 $ cov    : num  232.4 4148.4 2338.9 181.2 68.7 ...
 $ cov_sd : num  159.7 3089.9 2148.5 67.5 3.4 ...
 $ mcov   : num  232.4 4148.4 2338.9 181.2 68.7 ...
 $ mcov_sd: num  159.7 3089.9 2148.5 67.5 3.4 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">exon.count.S12M.edata <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(S12M.edata.df)</span>
<span id="cb18-2"></span>
<span id="cb18-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(exon.count.S12M.edata)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 352757</code></pre>
</div>
</div>
</section>
<section id="count-exons-in-gcf_002022765.2_c_virginica-3.0_genomic.gff" class="level2">
<h2 class="anchored" data-anchor-id="count-exons-in-gcf_002022765.2_c_virginica-3.0_genomic.gff">Count exons in <code>GCF_002022765.2_C_virginica-3.0_genomic.gff</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">exon.count.ncbi.gff <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"awk -F '</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">' '$3 == </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">exon</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">' /home/sam/gitrepos/ceabigr/genome-features/GCF_002022765.2_C_virginica-3.0_genomic.gff | wc -l"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intern =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb20-2"></span>
<span id="cb20-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(exon.count.ncbi.gff)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "731916"</code></pre>
</div>
</div>
<p>Number of exons in <code>e_data.ctab</code>: 352757</p>
<p>Number of exons in NCBI GFF: 731916</p>
<p>So, we’re seeing that S12M <code>e_data.ctab</code> has ~50% of the total number of exons in the <a href="https://en.wikipedia.org/wiki/Eastern_oyster"><em>Crassostrea virginica</em> (Eastern oyster)</a> genome (as annotated by NCBI). This makes sense to me, as the data we’re using is RNAseq. So, not all genes are going to be expressed and, thus, we won’t have data for each gene/exon in the genome.</p>
<p>Regardless, based off of the difference in exon counts of gene-LOC111119012 in <code>GCF_002022765.2_C_virginica-3.0_genomic.gff</code> and <code>S12M-exon_expression.tab</code>, I will revisit <a href="https://github.com/sr320/ceabigr/blob/main/code/19-exon-expression.Rmd"><code>19-exon-expression.Rmd</code></a> to see where things might have gone wrong.</p>


</section>
</section>

 ]]></description>
  <category>CEABIGR</category>
  <category>Crassostrea viriginica</category>
  <category>Eastern oyster</category>
  <category>2023</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-12-06-Data-Investigation---Mysterious-Case-of-Excessive-Exons-in-CEABIGR/index.html</guid>
  <pubDate>Wed, 06 Dec 2023 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Daily Bits - December 2023</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-12-01-Daily-Bits---December-2023/index.html</link>
  <description><![CDATA[ 




<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section">20231219</h2>
<ul>
<li><p>Read Ch.3 of “Race After Technology: The New Jim Code”</p></li>
<li><p>Helped get Lindasy Alma set up for qPCRs and usage of the PCR Workstation in FTR 213.</p></li>
</ul>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1">20231218</h2>
<section id="in-lab" class="level3">
<h3 class="anchored" data-anchor-id="in-lab">In lab</h3>
<ul>
<li><p><a href="https://robertslab.github.io/sams-notebook/posts/2023/2023-12-18-Samples-Submitted---Gadus-macrocephalus-liver-tissues-to-Azenta-for-RNA-seq/">Shipped Pacific cod tissues to Azenta for RNA-seq</a> (notebook).</p></li>
<li><p>Tested out some broken URL GitHub action modifications to deal with my notebook.</p></li>
</ul>
</section>
</section>
<section id="section-2" class="level2">
<h2 class="anchored" data-anchor-id="section-2">20231215</h2>
<section id="coral-e5-github-repo" class="level3">
<h3 class="anchored" data-anchor-id="coral-e5-github-repo"><a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo)</h3>
<ul>
<li>Worked on manuscript</li>
</ul>
</section>
<section id="ceabigr-github-repo" class="level3">
<h3 class="anchored" data-anchor-id="ceabigr-github-repo"><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo)</h3>
<ul>
<li>Spent a bit more time looking into Ballgown exon counts and comparing with GFF.</li>
</ul>
</section>
</section>
<section id="section-3" class="level2">
<h2 class="anchored" data-anchor-id="section-3">20231214</h2>
<section id="hackweek" class="level3">
<h3 class="anchored" data-anchor-id="hackweek">Hackweek</h3>
<ul>
<li>Helped with Hisat2/Stringtie stuff.</li>
</ul>
</section>
</section>
<section id="section-4" class="level2">
<h2 class="anchored" data-anchor-id="section-4">20231213</h2>
<section id="hackweek-1" class="level3">
<h3 class="anchored" data-anchor-id="hackweek-1">Hackweek</h3>
<ul>
<li><p>Worked on broken URLs in notebook and lab website.</p></li>
<li><p>Helped with Grace Kallisto stuff.</p></li>
</ul>
</section>
</section>
<section id="section-5" class="level2">
<h2 class="anchored" data-anchor-id="section-5">20231211</h2>
<section id="hackweek-2" class="level3">
<h3 class="anchored" data-anchor-id="hackweek-2">Hackweek</h3>
<ul>
<li>Worked on broken URLs in notebook and lab website.</li>
</ul>
</section>
</section>
<section id="section-6" class="level2">
<h2 class="anchored" data-anchor-id="section-6">20231206</h2>
<section id="ceabigr-github-repo-1" class="level3">
<h3 class="anchored" data-anchor-id="ceabigr-github-repo-1"><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo)</h3>
<ul>
<li>Completed most of invstigation into exon count issues.</li>
</ul>
</section>
<section id="dei" class="level3">
<h3 class="anchored" data-anchor-id="dei">DEI</h3>
<ul>
<li>Read Ch.2 of “Race After Technology”</li>
</ul>
</section>
</section>
<section id="section-7" class="level2">
<h2 class="anchored" data-anchor-id="section-7">20231205</h2>
<p><a href="https://github.com/sr320/ceabigr">CEABIGR</a> (GitHub repo)</p>
<ul>
<li>Started to investigate weird exon count issues identified last week.</li>
</ul>
<p><a href="https://github.com/laurahspencer/DuMOAR">DuMOAR</a> (GitHub repo)</p>
<ul>
<li>It was decided to have everyone begin writing their methods in the manuscript.</li>
</ul>
</section>
<section id="section-8" class="level2">
<h2 class="anchored" data-anchor-id="section-8">20231204</h2>
<p><a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo)</p>
<ul>
<li>Updated multiple README files</li>
</ul>
</section>
<section id="section-9" class="level2">
<h2 class="anchored" data-anchor-id="section-9">20231201</h2>
<p>-<a href="https://github.com/urol-e5/deep-dive">Coral E5</a> (GitHub repo) Meeting</p>
<ul>
<li><p>Revisit trimming.</p>
<ul>
<li>Contact Azenta about trimming params.</li>
</ul></li>
<li><p>Science Hour</p>
<ul>
<li>Chatted with Kathleen about basics of NGS trimming.</li>
</ul></li>
</ul>


</section>

 ]]></description>
  <category>Daily Bits</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-12-01-Daily-Bits---December-2023/index.html</guid>
  <pubDate>Fri, 01 Dec 2023 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Plotting Fun - Lab Meeting Task</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-11-30-Plotting-Fun---Lab-Meeting-Task/index.html</link>
  <description><![CDATA[ 




<p>For today’s lab meeting, Steven tasked us with the following on Wednesday:</p>
<blockquote class="blockquote">
<p>For lab meeting Thursday the topic is “Plots”. Before the meeting make sure to create a notebook post where you show-off a plot of something you did in November, including showing the code used to generate the plot. :bar_chart: - Drop the url to the notebook post below.</p>
</blockquote>
<p>So, drawing a blank on what to plot, I opted to visualize commit history for the <a href="https://github.com/urol-e5/deep-dive">Coral E5 deep dive repo</a> (GitHub repo).</p>
<p>Let’s start with just trying to plot commits per day.</p>
<section id="initial-setup" class="level1">
<h1>Initial setup</h1>
<section id="load-libraries" class="level2">
<h2 class="anchored" data-anchor-id="load-libraries">Load libraries</h2>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
</div>
</section>
<section id="set-git-repo-path" class="level2">
<h2 class="anchored" data-anchor-id="set-git-repo-path">Set Git Repo Path</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">repo_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/sam/gitrepos/deep-dive/"</span></span></code></pre></div>
</div>
</section>
<section id="set-date-range" class="level2">
<h2 class="anchored" data-anchor-id="set-date-range">Set date range</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set date range</span></span>
<span id="cb5-2">start_date <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2023-11-01"</span>)</span>
<span id="cb5-3">end_date <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2023-11-30"</span>)</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Catpures all days in range</span></span>
<span id="cb5-6">all_days <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Date =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(start_date, end_date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"day"</span>))</span>
<span id="cb5-7"></span>
<span id="cb5-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(all_days)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Date
1 2023-11-01
2 2023-11-02
3 2023-11-03
4 2023-11-04
5 2023-11-05
6 2023-11-06</code></pre>
</div>
</div>
</section>
<section id="define-the-git-command-to-get-commit-dates-using-system" class="level2">
<h2 class="anchored" data-anchor-id="define-the-git-command-to-get-commit-dates-using-system">Define the Git command to get commit dates using <code>system()</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">git_command <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"git --git-dir="</span>,</span>
<span id="cb7-2">                     repo_path, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".git log --pretty=format:%ad --date=short --after="</span>,</span>
<span id="cb7-3">                     start_date,</span>
<span id="cb7-4">                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" --before="</span>,</span>
<span id="cb7-5">                     end_date,</span>
<span id="cb7-6">                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" --all"</span>,</span>
<span id="cb7-7">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb7-8"></span>
<span id="cb7-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(git_command)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "git --git-dir=/home/sam/gitrepos/deep-dive/.git log --pretty=format:%ad --date=short --after=2023-11-01 --before=2023-11-30 --all"</code></pre>
</div>
</div>
</section>
</section>
<section id="data-manipulation" class="level1">
<h1>Data manipulation</h1>
<section id="excecute-git-command" class="level2">
<h2 class="anchored" data-anchor-id="excecute-git-command">Excecute git command</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">commit_info <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>(git_command, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intern =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb9-2"></span>
<span id="cb9-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(commit_info)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> chr [1:230] "2023-11-30" "2023-11-30" "2023-11-30" "2023-11-30" ...</code></pre>
</div>
</div>
</section>
<section id="convert-to-dates-structure" class="level2">
<h2 class="anchored" data-anchor-id="convert-to-dates-structure">Convert to Dates structure</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">commit_dates <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"'"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, commit_info))</span>
<span id="cb11-2"></span>
<span id="cb11-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(commit_dates)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Date[1:230], format: "2023-11-30" "2023-11-30" "2023-11-30" "2023-11-30" "2023-11-30" ...</code></pre>
</div>
</div>
</section>
<section id="count-number-of-commits" class="level2">
<h2 class="anchored" data-anchor-id="count-number-of-commits">Count number of commits</h2>
<p>This will create a two-column dataframe (Date, Commits) and replace dates with 0 commits (NAs) with <code>0</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This counts number of commits on each date.</span></span>
<span id="cb13-2">commit_table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">table</span>(commit_dates)</span>
<span id="cb13-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(commit_table)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 'table' int [1:14(1d)] 5 17 19 6 7 21 13 5 4 16 ...
 - attr(*, "dimnames")=List of 1
  ..$ commit_dates: chr [1:14] "2023-11-01" "2023-11-02" "2023-11-03" "2023-11-04" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">all_days <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">merge</span>(</span>
<span id="cb15-2">  all_days,</span>
<span id="cb15-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb15-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Date =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(</span>
<span id="cb15-5">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(commit_table)</span>
<span id="cb15-6">      ),</span>
<span id="cb15-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Commits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(</span>
<span id="cb15-8">      commit_table)</span>
<span id="cb15-9">    ),</span>
<span id="cb15-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">all.x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb15-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Date"</span>)</span>
<span id="cb15-12"></span>
<span id="cb15-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Assigns value of `0` to all NAs</span></span>
<span id="cb15-14">all_days<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Commits[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(all_days<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Commits)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb15-15"></span>
<span id="cb15-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(all_days)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Date Commits
1 2023-11-01       5
2 2023-11-02      17
3 2023-11-03      19
4 2023-11-04       6
5 2023-11-05       7
6 2023-11-06      21</code></pre>
</div>
</div>
</section>
</section>
<section id="plot-all-commits-per-day" class="level1">
<h1>Plot all commits per day</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(all_days, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Commits)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"steelblue"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Commits per Day in Nov 2023"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Date"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of Commits"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-11-30-Plotting-Fun---Lab-Meeting-Task/index_files/figure-html/bar-plot-all-commits-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Bar plot of all November 2023 commits</figcaption>
</figure>
</div>
</div>
</div>
<p>Now, let’s try to look at commits per day by author…</p>
</section>
<section id="commits-per-day-per-author" class="level1">
<h1>Commits per day per author</h1>
<section id="create-a-data-frame-with-all-days-in-november" class="level2">
<h2 class="anchored" data-anchor-id="create-a-data-frame-with-all-days-in-november">Create a data frame with all days in November</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">all_days <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Date =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(start_date, end_date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"day"</span>))</span></code></pre></div>
</div>
</section>
<section id="new-git-command" class="level2">
<h2 class="anchored" data-anchor-id="new-git-command">New git command</h2>
<p>This adds author to format output</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">git_command <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"git --git-dir="</span>,repo_path, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".git log --date=short --all --format='%ad %an'"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb19-2"></span>
<span id="cb19-3">commit_info <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>(git_command, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intern =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</div>
</section>
<section id="split-the-commit-information-into-date-and-author" class="level2">
<h2 class="anchored" data-anchor-id="split-the-commit-information-into-date-and-author">Split the commit information into date and author</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">commit_info_split <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">strsplit</span>(commit_info, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>)</span>
<span id="cb20-2">commit_dates <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(commit_info_split, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[["</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb20-3">commit_authors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(commit_info_split, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[["</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb20-4"></span>
<span id="cb20-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(commit_dates)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Date[1:558], format: "2024-02-16" "2024-02-16" "2024-02-16" "2024-02-16" "2024-02-16" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(commit_authors)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> chr [1:558] "kubu4" "kubu4" "kubu4" "kubu4" "kubu4" "kubu4" "kubu4" ...</code></pre>
</div>
</div>
</section>
<section id="create-data-frame-with-commits-and-authors" class="level2">
<h2 class="anchored" data-anchor-id="create-data-frame-with-commits-and-authors">Create data frame with commits and authors</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a data frame with commit information</span></span>
<span id="cb24-2">commit_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Date =</span> commit_dates, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Author =</span> commit_authors)</span>
<span id="cb24-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(commit_data)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Date Author
1 2024-02-16  kubu4
2 2024-02-16  kubu4
3 2024-02-16  kubu4
4 2024-02-16  kubu4
5 2024-02-16  kubu4
6 2024-02-16  kubu4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(commit_data)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   558 obs. of  2 variables:
 $ Date  : Date, format: "2024-02-16" "2024-02-16" ...
 $ Author: chr  "kubu4" "kubu4" "kubu4" "kubu4" ...</code></pre>
</div>
</div>
<section id="update-dataframe-to-include-all-days-in-november" class="level3">
<h3 class="anchored" data-anchor-id="update-dataframe-to-include-all-days-in-november">Update dataframe to include all days in November</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1">all_days <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">merge</span>(all_days, commit_data, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">all.x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Date"</span>)</span>
<span id="cb28-2"></span>
<span id="cb28-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(all_days)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   254 obs. of  2 variables:
 $ Date  : Date, format: "2023-11-01" "2023-11-01" ...
 $ Author: chr  "kubu4" "kubu4" "Steven" "kubu4" ...</code></pre>
</div>
</div>
</section>
<section id="update-dataframe-with-commit-counts-per-author" class="level3">
<h3 class="anchored" data-anchor-id="update-dataframe-with-commit-counts-per-author">Update dataframe with commit counts per author</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1">all_days <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> all_days <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb30-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Date, Author) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb30-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Commits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>())</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Date'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(all_days)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>gropd_df [45 × 3] (S3: grouped_df/tbl_df/tbl/data.frame)
 $ Date   : Date[1:45], format: "2023-11-01" "2023-11-01" ...
 $ Author : chr [1:45] "Steven" "kubu4" "Steven" "kubu4" ...
 $ Commits: int [1:45] 1 12 4 10 3 5 14 2 4 4 ...
 - attr(*, "groups")= tibble [30 × 2] (S3: tbl_df/tbl/data.frame)
  ..$ Date : Date[1:30], format: "2023-11-01" "2023-11-02" ...
  ..$ .rows: list&lt;int&gt; [1:30] 
  .. ..$ : int [1:2] 1 2
  .. ..$ : int [1:3] 3 4 5
  .. ..$ : int [1:2] 6 7
  .. ..$ : int [1:2] 8 9
  .. ..$ : int [1:2] 10 11
  .. ..$ : int [1:2] 12 13
  .. ..$ : int [1:2] 14 15
  .. ..$ : int 16
  .. ..$ : int 17
  .. ..$ : int 18
  .. ..$ : int 19
  .. ..$ : int 20
  .. ..$ : int 21
  .. ..$ : int [1:2] 22 23
  .. ..$ : int [1:3] 24 25 26
  .. ..$ : int [1:3] 27 28 29
  .. ..$ : int [1:3] 30 31 32
  .. ..$ : int 33
  .. ..$ : int 34
  .. ..$ : int 35
  .. ..$ : int 36
  .. ..$ : int 37
  .. ..$ : int 38
  .. ..$ : int 39
  .. ..$ : int 40
  .. ..$ : int 41
  .. ..$ : int 42
  .. ..$ : int 43
  .. ..$ : int 44
  .. ..$ : int 45
  .. ..@ ptype: int(0) 
  ..- attr(*, ".drop")= logi TRUE</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="plot-commits-per-day-per-author" class="level1">
<h1>Plot commits per day per author</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(all_days, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Commits, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Author)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb34-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb34-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Commits by Author per Day in Nov 2023"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Date"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of Commits"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb34-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb34-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Set2"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-11-30-Plotting-Fun---Lab-Meeting-Task/index_files/figure-html/stacked-bar-plot-commits-by-author-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Stacked bar plot of November 2023 commits per day per author</figcaption>
</figure>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>plotting</category>
  <category>R</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-11-30-Plotting-Fun---Lab-Meeting-Task/index.html</guid>
  <pubDate>Thu, 30 Nov 2023 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Transcriptome Annotation - M.magister De Novo Transcriptome Assembly Using Trinotate on Mox</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-11-09-Transcriptome-Annotation---M.magister-De-Novo-Transcriptome-Assembly-Using-Trinotate-on-Mox/index.html</link>
  <description><![CDATA[ 




<section id="intro" class="level1">
<h1>Intro</h1>
<p>As part of <a href="https://github.com/laurahspencer/DuMOAR/issues/44">transcriptome annotation</a> (GitHub issue) for <a href="https://github.com/laurahspencer/DuMOAR">DuMOAR</a> (GitHub repo), I’ve already run <a href="https://https://github.com/TransDecoder/TransDecoder/wiki.com/Trinotate/Trinotate/wiki"><code>TransDecoder</code></a> ( run on <a href="../../../posts/2023/2023-11-07-Transcriptome-Annotation---M.magister-De-Novo-Transcriptome-Assembly-for-DuMOAR-Project-Using-TransDecoder-on-Mox/index.html">20231107</a>), as well as <a href="https://github.com/bbuchfink/diamond"><code>DIAMOND</code></a> BLASTx (run <a href="../../../posts/2023/2023-11-09-Transcriptome-Annotation---M.magister-De-Novo-Transcriptome-Assembly-for-DuMOAR-Project-Using-DIAMOND-BLASTx-on-Mox/index.html">earlier today</a>). The final part of getting the transcriptome annotated was to run <a href="https://github.com/Trinotate/Trinotate/wiki"><code>Trinotate</code></a>. <a href="https://github.com/Trinotate/Trinotate/wiki"><code>Trinotate</code></a> uses a combination of tools to generate a pretty thorough annotation of transcriptomes. This was run on Mox.</p>
<section id="slurm-script" class="level2">
<h2 class="anchored" data-anchor-id="slurm-script">SLURM script</h2>
<ul>
<li><a href="https://github.com/RobertsLab/sams-notebook/blob/master/sbatch_scripts/20231109-mmag-trinotate-transcriptome.sh">20231109-mmag-trinotate-transcriptome.sh</a> (GitHub)</li>
</ul>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Job Name</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --job-name=20231109-mmag-trinotate-transcriptome</span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Allocation Definition</span></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --account=srlab</span></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --partition=srlab</span></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Resources</span></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Nodes</span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --nodes=1</span></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Walltime (days-hours:minutes:seconds format)</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --time=4-00:00:00</span></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Memory per node</span></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mem=120G</span></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##turn on e-mail notification</span></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-type=ALL</span></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-user=samwhite@uw.edu</span></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Specify the working directory for this job</span></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --chdir=/gscratch/scrubbed/samwhite/outputs/20231109-mmag-trinotate-transcriptome</span></span>
<span id="cb1-19"></span>
<span id="cb1-20"></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Script to run Trinotate on M.magister transcriptome.</span></span>
<span id="cb1-22"></span>
<span id="cb1-23"></span>
<span id="cb1-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################</span></span>
<span id="cb1-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># These variables need to be set by user</span></span>
<span id="cb1-26"></span>
<span id="cb1-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Input files</span></span>
<span id="cb1-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## BLASTx</span></span>
<span id="cb1-29"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">blastx_out</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/scrubbed/samwhite/outputs/20231109-mmag-transcriptome-diamond-blastx/trinity_denovo.Trinity.blastx.outfmt6"</span></span>
<span id="cb1-30"></span>
<span id="cb1-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## TransDecoder</span></span>
<span id="cb1-32"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">transdecoder_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/scrubbed/samwhite/outputs/20231107-mmag-transdecoder-transcriptome"</span></span>
<span id="cb1-33"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">blastp_out</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${transdecoder_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/blastp_out/blastp.outfmt6"</span></span>
<span id="cb1-34"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pfam_out</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${transdecoder_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/pfam_out/pfam.domtblout"</span></span>
<span id="cb1-35"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">lORFs_pep</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${transdecoder_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/trinity_denovo.Trinity.fasta.transdecoder_dir/longest_orfs.pep"</span></span>
<span id="cb1-36"></span>
<span id="cb1-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Transcriptomics</span></span>
<span id="cb1-38"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">transcriptomes_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/sam/data/M_magister/transcriptomes"</span></span>
<span id="cb1-39"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trinity_fasta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${transcriptomes_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/trinity_denovo.Trinity.fasta"</span></span>
<span id="cb1-40"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trinity_gene_map</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${transcriptomes_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/trinity_denovo.Trinity.fasta.gene_trans_map"</span></span>
<span id="cb1-41"></span>
<span id="cb1-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################</span></span>
<span id="cb1-43"></span>
<span id="cb1-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Exit script if any command fails</span></span>
<span id="cb1-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span></span>
<span id="cb1-46"></span>
<span id="cb1-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load Python Mox module for Python module availability</span></span>
<span id="cb1-48"></span>
<span id="cb1-49"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load intel-python3_2017</span>
<span id="cb1-50"></span>
<span id="cb1-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># SegFault fix?</span></span>
<span id="cb1-52"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">THREADS_DAEMON_MODEL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb1-53"></span>
<span id="cb1-54"></span>
<span id="cb1-55"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">wd</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-56"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">timestamp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">date</span> +%Y%m%d<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-57"></span>
<span id="cb1-58"></span>
<span id="cb1-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Paths to input/output files</span></span>
<span id="cb1-60"></span>
<span id="cb1-61"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## New folders for working directory</span></span>
<span id="cb1-62"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rnammer_out_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${wd}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/RNAmmer_out"</span></span>
<span id="cb1-63"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">signalp_out_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${wd}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/signalp_out"</span></span>
<span id="cb1-64"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tmhmm_out_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${wd}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/tmhmm_out"</span></span>
<span id="cb1-65"></span>
<span id="cb1-66"></span>
<span id="cb1-67"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rnammer_prefix</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinity_fasta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-68"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">prefix</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${timestamp}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${rnammer_prefix}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.trinotate"</span></span>
<span id="cb1-69"></span>
<span id="cb1-70"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output files</span></span>
<span id="cb1-71"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rnammer_out</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${rnammer_out_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${rnammer_prefix}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.rnammer.gff"</span></span>
<span id="cb1-72"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">signalp_out</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${signalp_out_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${prefix}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.signalp.out"</span></span>
<span id="cb1-73"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tmhmm_out</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${tmhmm_out_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${prefix}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.tmhmm.out"</span></span>
<span id="cb1-74"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trinotate_report</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${wd}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${prefix}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_annotation_report.txt"</span></span>
<span id="cb1-75"></span>
<span id="cb1-76"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Paths to programs</span></span>
<span id="cb1-77"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rnammer_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/programs/RNAMMER-1.2"</span></span>
<span id="cb1-78"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rnammer</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${rnammer_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/rnammer"</span></span>
<span id="cb1-79"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">signalp_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/programs/signalp-4.1"</span></span>
<span id="cb1-80"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">signalp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${signalp_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/signalp"</span></span>
<span id="cb1-81"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tmhmm_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/programs/tmhmm-2.0c/bin"</span></span>
<span id="cb1-82"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tmhmm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${tmhmm_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/tmhmm"</span></span>
<span id="cb1-83"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trinotate_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/programs/Trinotate-v3.1.1"</span></span>
<span id="cb1-84"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trinotate</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/Trinotate"</span></span>
<span id="cb1-85"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trinotate_rnammer</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/util/rnammer_support/RnammerTranscriptome.pl"</span></span>
<span id="cb1-86"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trinotate_GO</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/util/extract_GO_assignments_from_Trinotate_xls.pl"</span></span>
<span id="cb1-87"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trinotate_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/util/Trinotate_get_feature_name_encoding_attributes.pl"</span></span>
<span id="cb1-88"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trinotate_sqlite_db</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Trinotate.sqlite"</span></span>
<span id="cb1-89"></span>
<span id="cb1-90"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate FastA checksum, for reference if needed.</span></span>
<span id="cb1-91"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinity_fasta}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> fasta.checksum.md5</span>
<span id="cb1-92"></span>
<span id="cb1-93"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make output directories</span></span>
<span id="cb1-94"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${rnammer_out_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${signalp_out_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${tmhmm_out_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-95"></span>
<span id="cb1-96"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Copy sqlite database template</span></span>
<span id="cb1-97"></span>
<span id="cb1-98"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cp</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_dir}</span>/admin/Trinotate.sqlite .</span>
<span id="cb1-99"></span>
<span id="cb1-100"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run signalp</span></span>
<span id="cb1-101"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${signalp}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-102">-f short <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-103">-n <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${signalp_out}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-104"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${lORFs_pep}</span></span>
<span id="cb1-105"></span>
<span id="cb1-106"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run tmHMM</span></span>
<span id="cb1-107"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${tmhmm}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-108">--short <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-109"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${lORFs_pep}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-110"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${tmhmm_out}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-111"></span>
<span id="cb1-112"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run RNAmmer</span></span>
<span id="cb1-113"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Has "||" operator due to previous lack of matches</span></span>
<span id="cb1-114"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Need "||" to continue with annotation.</span></span>
<span id="cb1-115"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${rnammer_out_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">exit</span></span>
<span id="cb1-116"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_rnammer}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-117">--transcriptome <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinity_fasta}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-118">--path_to_rnammer <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${rnammer}</span></span>
<span id="cb1-119"></span>
<span id="cb1-120"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${wd}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">exit</span></span>
<span id="cb1-121"></span>
<span id="cb1-122"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run Trinotate</span></span>
<span id="cb1-123"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Load transcripts and coding regions into database</span></span>
<span id="cb1-124"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-125"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_sqlite_db}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-126">init <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-127">--gene_trans_map <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinity_gene_map}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-128">--transcript_fasta <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinity_fasta}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-129">--transdecoder_pep <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${lORFs_pep}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-130"></span>
<span id="cb1-131"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Load BLAST homologies</span></span>
<span id="cb1-132"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-133"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_sqlite_db}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-134">LOAD_swissprot_blastp <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-135"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${blastp_out}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-136"></span>
<span id="cb1-137"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-138"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_sqlite_db}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-139">LOAD_swissprot_blastx <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-140"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${blastx_out}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-141"></span>
<span id="cb1-142"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Load Pfam</span></span>
<span id="cb1-143"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-144"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_sqlite_db}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-145">LOAD_pfam <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-146"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${pfam_out}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-147"></span>
<span id="cb1-148"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Load transmembrane domains</span></span>
<span id="cb1-149"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-150"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_sqlite_db}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-151">LOAD_tmhmm <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-152"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${tmhmm_out}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-153"></span>
<span id="cb1-154"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Load signal peptides</span></span>
<span id="cb1-155"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-156"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_sqlite_db}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-157">LOAD_signalp <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-158"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${signalp_out}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-159"></span>
<span id="cb1-160"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Load RNAmmer</span></span>
<span id="cb1-161"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-162"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_sqlite_db}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-163">LOAD_rnammer <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-164"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${rnammer_out}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-165"></span>
<span id="cb1-166"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Creat annotation report</span></span>
<span id="cb1-167"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-168"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_sqlite_db}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-169">report <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-170"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_report}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-171"></span>
<span id="cb1-172"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract GO terms from annotation report</span></span>
<span id="cb1-173"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-174">--Trinotate_xls <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_report}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-175">-G <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-176">--include_ancestral_terms <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-177"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${prefix}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.go_annotations.txt</span>
<span id="cb1-178"></span>
<span id="cb1-179"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make transcript features annotation map</span></span>
<span id="cb1-180"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_features}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-181"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trinotate_report}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-182"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${prefix}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.annotation_feature_map.txt</span>
<span id="cb1-183"></span>
<span id="cb1-184"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">####################################################################</span></span>
<span id="cb1-185"></span>
<span id="cb1-186"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Capture program options</span></span>
<span id="cb1-187"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-gt</span> 0 <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-188">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Logging program options..."</span></span>
<span id="cb1-189">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> program <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-190">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span>
<span id="cb1-191">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-192">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Program options for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">: "</span></span>
<span id="cb1-193">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-194">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle samtools help menus</span></span>
<span id="cb1-195">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_index"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-196">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_sort"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-197">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_view"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span></span>
<span id="cb1-198">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-199">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-200"></span>
<span id="cb1-201">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle DIAMOND BLAST menu</span></span>
<span id="cb1-202">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"diamond"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-203">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> help</span>
<span id="cb1-204"></span>
<span id="cb1-205">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle NCBI BLASTx menu</span></span>
<span id="cb1-206">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blastx"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-207">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-help</span></span>
<span id="cb1-208"></span>
<span id="cb1-209">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle StringTie prepDE script</span></span>
<span id="cb1-210">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"prepDE"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-211">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-h</span></span>
<span id="cb1-212">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb1-213">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-h</span></span>
<span id="cb1-214">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-215">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-216">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"----------------------------------------------"</span></span>
<span id="cb1-217">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-218">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-219">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&gt;&gt;</span> program_options.log <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb1-220"></span>
<span id="cb1-221">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If MultiQC is in programs_array, copy the config file to this directory.</span></span>
<span id="cb1-222">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"multiqc"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-223">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cp</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--preserve</span> ~/.multiqc_config.yaml multiqc_config.yaml</span>
<span id="cb1-224">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb1-225">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span>
<span id="cb1-226">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Finished logging programs options."</span></span>
<span id="cb1-227">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-228"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb1-229"></span>
<span id="cb1-230"></span>
<span id="cb1-231"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Document programs in PATH (primarily for program version ID)</span></span>
<span id="cb1-232"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Logging system </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$PATH</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">..."</span></span>
<span id="cb1-233"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-234"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">date</span></span>
<span id="cb1-235"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-236"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"System PATH for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$SLURM_JOB_ID</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-237"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-238"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%0.s-"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">..</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-239"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${PATH}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tr</span> : <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\\</span>n</span>
<span id="cb1-240"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> system_path.log</span>
<span id="cb1-241"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Finished logging system </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$PATH</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">."</span></span></code></pre></div>
<p>/———-</p>
</section>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<section id="runtime" class="level2">
<h2 class="anchored" data-anchor-id="runtime">Runtime</h2>
<p>Runtime was just under 3.5hrs:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-11-09-Transcriptome-Annotation---M.magister-De-Novo-Transcriptome-Assembly-Using-Trinotate-on-Mox/20231109-mmag-trinotate-transcriptome-runtime.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Screencap showing Trinotate runtime on Mox of 3hrs, 21mins, 10secs</figcaption>
</figure>
</div>
</section>
<section id="files" class="level2">
<h2 class="anchored" data-anchor-id="files">Files</h2>
<p>Output directory:</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/20231109-mmag-trinotate-transcriptome/">20231109-mmag-trinotate-transcriptome/</a></li>
</ul>
<section id="annotation-feature-map" class="level3">
<h3 class="anchored" data-anchor-id="annotation-feature-map">Annotation Feature Map</h3>
<p>Annotation feature map (10MB; TXT):</p>
<ul>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20231109-mmag-trinotate-transcriptome/20231109.trinity_denovo.Trinity.fasta.trinotate.annotation_feature_map.txt">20231109.trinity_denovo.Trinity.fasta.trinotate.annotation_feature_map.txt</a></p>
<ul>
<li><p><a href="https://github.com/trinityrnaseq/trinityrnaseq/wiki/Functional-Annotation-of-Transcripts">This can be used to update Trinity-based gene expression matrices like so</a>:</p>
<ul>
<li><code>${TRINITY_HOME}/Analysis/DifferentialExpression/rename_matrix_feature_identifiers.pl Trinity_trans.counts.matrix annot_feature_map.txt &gt; Trinity_trans.counts.wAnnot.matrix</code></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="gene-ontology-go-annotations" class="level3">
<h3 class="anchored" data-anchor-id="gene-ontology-go-annotations">Gene Ontology (GO) Annotations</h3>
<p>Gene ontology (GO) annotations (26MB; TXT):</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/20231109-mmag-trinotate-transcriptome/20231109.trinity_denovo.Trinity.fasta.trinotate.go_annotations.txt">20231109.trinity_denovo.Trinity.fasta.trinotate.go_annotations.txt</a></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(kableExtra)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read in data frame</span></span>
<span id="cb2-5">go.annotations.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/Atumefaciens/20231109-mmag-trinotate-transcriptome/20231109.trinity_denovo.Trinity.fasta.trinotate.go_annotations.txt"</span>,</span>
<span id="cb2-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb2-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Provide column names</span></span>
<span id="cb2-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(go.annotations.df)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene.ID"</span></span>
<span id="cb2-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(go.annotations.df)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.IDs"</span></span>
<span id="cb2-12"></span>
<span id="cb2-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create nice HTML table</span></span>
<span id="cb2-14">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(go.annotations.df))</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-GO-annotations" class="anchored">
<table data-quarto-postprocess="true" data-tbl-colwidths="[60,40]" class="table table-sm table-striped small">
<caption>Table&nbsp;1: Gene Ontology annotations</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Gene.ID</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">GO.IDs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">TRINITY_DN0_c7_g1</td>
<td style="text-align: left;">GO:0000166,GO:0001678,GO:0001882,GO:0001883,GO:0003674,GO:0003824,GO:0004611,GO:0004613,GO:0005488,GO:0005525,GO:0005575,GO:0005739,GO:0005759,GO:0005829,GO:0005975,GO:0005996,GO:0006006,GO:0006066,GO:0006071,GO:0006082,GO:0006090,GO:0006094,GO:0006114,GO:0006629,GO:0006631,GO:0006950,GO:0008150,GO:0008152,GO:0009056,GO:0009058,GO:0009062,GO:0009605,GO:0009719,GO:0009725,GO:0009743,GO:0009746,GO:0009749,GO:0009987,GO:0009991,GO:0010033,GO:0010243,GO:0014070,GO:0016042,GO:0016051,GO:0016054,GO:0016829,GO:0016830,GO:0016831,GO:0017076,GO:0019001,GO:0019318,GO:0019319,GO:0019400,GO:0019401,GO:0019541,GO:0019543,GO:0019626,GO:0019725,GO:0019751,GO:0019752,GO:0030145,GO:0030154,GO:0030855,GO:0031667,GO:0031960,GO:0031974,GO:0032502,GO:0032549,GO:0032550,GO:0032553,GO:0032555,GO:0032561,GO:0032787,GO:0032868,GO:0032869,GO:0032870,GO:0033500,GO:0033993,GO:0034284,GO:0034637,GO:0035639,GO:0036094,GO:0042221,GO:0042592,GO:0042593,GO:0042594,GO:0043167,GO:0043168,GO:0043169,GO:0043226,GO:0043227,GO:0043229,GO:0043231,GO:0043233,GO:0043434,GO:0043436,GO:0044237,GO:0044238,GO:0044242,GO:0044248,GO:0044249,GO:0044255,GO:0044262,GO:0044281,GO:0044282,GO:0044283,GO:0044422,GO:0044424,GO:0044429,GO:0044444,GO:0044446,GO:0044464,GO:0044699,GO:0044710,GO:0044711,GO:0044712,GO:0044723,GO:0044763,GO:0044767,GO:0046165,GO:0046173,GO:0046327,GO:0046364,GO:0046395,GO:0046459,GO:0046872,GO:0046914,GO:0048545,GO:0048869,GO:0048878,GO:0050896,GO:0051384,GO:0051716,GO:0055082,GO:0065007,GO:0065008,GO:0070013,GO:0070365,GO:0070887,GO:0071310,GO:0071322,GO:0071326,GO:0071331,GO:0071333,GO:0071375,GO:0071383,GO:0071384,GO:0071385,GO:0071396,GO:0071407,GO:0071417,GO:0071495,GO:0071548,GO:0071549,GO:0071704,GO:0072329,GO:0097159,GO:0097367,GO:1901265,GO:1901363,GO:1901575,GO:1901576,GO:1901615,GO:1901617,GO:1901652,GO:1901653,GO:1901654,GO:1901655,GO:1901698,GO:1901699,GO:1901700,GO:1901701</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRINITY_DN100001_c0_g1</td>
<td style="text-align: left;">GO:0003674,GO:0003824,GO:0005575,GO:0005634,GO:0006629,GO:0007165,GO:0008081,GO:0008150,GO:0008152,GO:0009056,GO:0009987,GO:0016042,GO:0016787,GO:0016788,GO:0042578,GO:0043226,GO:0043227,GO:0043229,GO:0043231,GO:0044238,GO:0044424,GO:0044464,GO:0044699,GO:0044710,GO:0044712,GO:0050789,GO:0050794,GO:0065007,GO:0071704,GO:1901575</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TRINITY_DN100003_c0_g1</td>
<td style="text-align: left;">GO:0000166,GO:0000932,GO:0000975,GO:0000976,GO:0000977,GO:0000978,GO:0000987,GO:0001012,GO:0001067,GO:0001159,GO:0001650,GO:0003674,GO:0003676,GO:0003677,GO:0003682,GO:0003690,GO:0003697,GO:0003723,GO:0003824,GO:0003916,GO:0003917,GO:0004672,GO:0004674,GO:0005488,GO:0005515,GO:0005524,GO:0005575,GO:0005634,GO:0005654,GO:0005730,GO:0006139,GO:0006259,GO:0006260,GO:0006265,GO:0006325,GO:0006338,GO:0006464,GO:0006468,GO:0006725,GO:0006793,GO:0006796,GO:0006807,GO:0006996,GO:0007059,GO:0007623,GO:0008150,GO:0008152,GO:0008219,GO:0009058,GO:0009059,GO:0009330,GO:0009987,GO:0010468,GO:0012501,GO:0016032,GO:0016043,GO:0016301,GO:0016310,GO:0016740,GO:0016772,GO:0016773,GO:0016853,GO:0017076,GO:0018105,GO:0018193,GO:0018209,GO:0019222,GO:0019538,GO:0019904,GO:0030529,GO:0030554,GO:0031298,GO:0032501,GO:0032553,GO:0032555,GO:0032559,GO:0032922,GO:0032991,GO:0032993,GO:0034641,GO:0034645,GO:0035639,GO:0035770,GO:0036094,GO:0036211,GO:0036464,GO:0040016,GO:0042221,GO:0042493,GO:0043167,GO:0043168,GO:0043170,GO:0043204,GO:0043226,GO:0043227,GO:0043228,GO:0043229,GO:0043231,GO:0043232,GO:0043234,GO:0043412,GO:0043565,GO:0044212,GO:0044237,GO:0044238,GO:0044249,GO:0044260,GO:0044267,GO:0044403,GO:0044419,GO:0044422,GO:0044424,GO:0044427,GO:0044428,GO:0044444,GO:0044446,GO:0044452,GO:0044454,GO:0044464,GO:0044699,GO:0044707,GO:0044763,GO:0044764,GO:0046483,GO:0048511,GO:0050789,GO:0050896,GO:0051276,GO:0051301,GO:0051704,GO:0060255,GO:0065007,GO:0071103,GO:0071704,GO:0071840,GO:0090304,GO:0097100,GO:0097159,GO:0097367,GO:0097458,GO:1901265,GO:1901360,GO:1901363,GO:1901564,GO:1901576,GO:1990837,GO:1990904</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRINITY_DN100006_c0_g1</td>
<td style="text-align: left;">GO:0003674,GO:0003824,GO:0008150,GO:0008152,GO:0016491,GO:0044699,GO:0044710,GO:0055114</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TRINITY_DN100007_c0_g1</td>
<td style="text-align: left;">GO:0000166,GO:0003674,GO:0003824,GO:0004854,GO:0004855,GO:0005488,GO:0005506,GO:0005575,GO:0005777,GO:0005829,GO:0006082,GO:0006139,GO:0006144,GO:0006145,GO:0006725,GO:0006807,GO:0008150,GO:0008152,GO:0009055,GO:0009056,GO:0009058,GO:0009112,GO:0009115,GO:0009987,GO:0016491,GO:0016725,GO:0016726,GO:0016727,GO:0018130,GO:0019438,GO:0019439,GO:0030151,GO:0034418,GO:0034641,GO:0036094,GO:0042579,GO:0043167,GO:0043168,GO:0043169,GO:0043226,GO:0043227,GO:0043229,GO:0043231,GO:0043546,GO:0044237,GO:0044238,GO:0044248,GO:0044249,GO:0044270,GO:0044271,GO:0044281,GO:0044283,GO:0044424,GO:0044444,GO:0044464,GO:0044699,GO:0044710,GO:0044711,GO:0044712,GO:0044763,GO:0046110,GO:0046113,GO:0046415,GO:0046483,GO:0046700,GO:0046872,GO:0046914,GO:0048037,GO:0050660,GO:0050662,GO:0051536,GO:0051537,GO:0051540,GO:0055086,GO:0055114,GO:0070674,GO:0071704,GO:0071949,GO:0072521,GO:0072522,GO:0072523,GO:0097159,GO:1901265,GO:1901360,GO:1901361,GO:1901362,GO:1901363,GO:1901564,GO:1901565,GO:1901566,GO:1901575,GO:1901576</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRINITY_DN10000_c0_g1</td>
<td style="text-align: left;">GO:0000149,GO:0000281,GO:0000910,GO:0001505,GO:0001671,GO:0001745,GO:0003674,GO:0005483,GO:0005488,GO:0005515,GO:0005575,GO:0005737,GO:0005774,GO:0005886,GO:0006461,GO:0006810,GO:0006836,GO:0006886,GO:0006891,GO:0006906,GO:0006996,GO:0007154,GO:0007267,GO:0007268,GO:0007269,GO:0007270,GO:0007274,GO:0007420,GO:0008047,GO:0008104,GO:0008105,GO:0008150,GO:0009653,GO:0009887,GO:0009987,GO:0010646,GO:0010807,GO:0015031,GO:0015833,GO:0016020,GO:0016043,GO:0016050,GO:0016082,GO:0016192,GO:0017157,GO:0017158,GO:0019905,GO:0022402,GO:0022411,GO:0022607,GO:0023051,GO:0023052,GO:0023061,GO:0030154,GO:0030182,GO:0030234,GO:0031090,GO:0031201,GO:0031410,GO:0031629,GO:0031982,GO:0032386,GO:0032502,GO:0032781,GO:0032879,GO:0032940,GO:0032984,GO:0032991,GO:0033036,GO:0033267,GO:0034214,GO:0034622,GO:0035249,GO:0035494,GO:0040007,GO:0042886,GO:0043085,GO:0043195,GO:0043226,GO:0043227,GO:0043229,GO:0043234,GO:0043241,GO:0043254,GO:0043462,GO:0043623,GO:0043624,GO:0043679,GO:0043933,GO:0044087,GO:0044093,GO:0044306,GO:0044422,GO:0044424,GO:0044425,GO:0044437,GO:0044444,GO:0044446,GO:0044456,GO:0044463,GO:0044464,GO:0044699,GO:0044700,GO:0044763,GO:0044765,GO:0044767,GO:0044801,GO:0044802,GO:0044877,GO:0045026,GO:0045176,GO:0045184,GO:0045202,GO:0046903,GO:0046907,GO:0046928,GO:0048193,GO:0048284,GO:0048513,GO:0048526,GO:0048589,GO:0048592,GO:0048856,GO:0048869,GO:0050789,GO:0050790,GO:0050794,GO:0050804,GO:0051046,GO:0051049,GO:0051128,GO:0051179,GO:0051234,GO:0051259,GO:0051260,GO:0051336,GO:0051345,GO:0051588,GO:0051641,GO:0051649,GO:0060341,GO:0060560,GO:0060589,GO:0060590,GO:0060627,GO:0061024,GO:0061025,GO:0061640,GO:0065003,GO:0065007,GO:0065008,GO:0065009,GO:0070044,GO:0071702,GO:0071705,GO:0071822,GO:0071840,GO:0090174,GO:0090596,GO:0097458,GO:0097708,GO:0098588,GO:0098693,GO:0098772,GO:0098793,GO:0098794,GO:0098796,GO:0098805,GO:0098916,GO:0098978,GO:0099500,GO:0099531,GO:0099536,GO:0099537,GO:0099643,GO:1902578,GO:1902589,GO:1902803,GO:1903047,GO:1903305,GO:1903530,GO:2000300</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</section>
<section id="full-annotations" class="level3">
<h3 class="anchored" data-anchor-id="full-annotations">Full Annotations</h3>
<p>Annotation report (107MB; CSV):</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/20231109-mmag-trinotate-transcriptome/20231109.trinity_denovo.Trinity.fasta.trinotate_annotation_report.txt">20231109.trinity_denovo.Trinity.fasta.trinotate_annotation_report.txt</a></li>
</ul>
<p>This table is tab-delimited, but uses <code>^</code> for intra-field delimitation:</p>
<div class="cell" data-hash="index_cache/html/tbl-annotation-report_c7037e429e58ec83c7c6c701f1b7953a">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(kableExtra)</span>
<span id="cb3-2"></span>
<span id="cb3-3">annotations.df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/Atumefaciens/20231109-mmag-trinotate-transcriptome/20231109.trinity_denovo.Trinity.fasta.trinotate_annotation_report.txt"</span>,</span>
<span id="cb3-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb3-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb3-6"></span>
<span id="cb3-7">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(annotations.df))</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-annotation-report" class="anchored">
<table data-quarto-postprocess="true" data-tbl-colwidths="[60,40]" class="table table-sm table-striped small">
<caption>Table&nbsp;2: Full annotations</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">X.gene_id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">transcript_id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">sprot_Top_BLASTX_hit</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RNAMMER</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">prot_id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">prot_coords</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">sprot_Top_BLASTP_hit</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Pfam</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">SignalP</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">TmHMM</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">eggnog</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Kegg</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">gene_ontology_blast</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">gene_ontology_pfam</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">transcript</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">peptide</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">TRINITY_DN8_c0_g1</td>
<td style="text-align: left;">TRINITY_DN8_c0_g1_i1</td>
<td style="text-align: left;">sp|Q63089|S22A1_RAT^sp|Q63089|S22A1_RAT^Q:905-18,H:87-381^36.2%ID^E:1.09e-38^.^.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">TRINITY_DN8_c0_g1_i1.p1</td>
<td style="text-align: left;">908-3[-]</td>
<td style="text-align: left;">S22A1_RAT^S22A1_RAT^Q:2-297,H:87-381^36.156%ID^E:5.87e-43^RecName: Full=Solute carrier family 22 member 1;^Eukaryota; Metazoa; Chordata; Craniata; Vertebrata; Euteleostomi; Mammalia; Eutheria; Euarchontoglires; Glires; Rodentia; Myomorpha; Muroidea; Muridae; Murinae; Rattus</td>
<td style="text-align: left;">PF00083.24^Sugar_tr^Sugar (and other) transporter^57-276^E:4.5e-21`PF07690.16^MFS_1^Major Facilitator Superfamily^61-278^E:7e-18</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">ExpAA=119.03^PredHel=5^Topology=i59-81o91-109i116-138o148-170i177-196o</td>
<td style="text-align: left;">ENOG410XR5P^Major facilitator superfamily MFS_1</td>
<td style="text-align: left;">KEGG:rno:24904`KO:K08198</td>
<td style="text-align: left;">GO:0016323^cellular_component^basolateral plasma membrane`GO:0005887^cellular_component^integral component of plasma membrane`GO:0005277^molecular_function^acetylcholine transmembrane transporter activity`GO:0005330^molecular_function^dopamine:sodium symporter activity`GO:0042802^molecular_function^identical protein binding`GO:0008504^molecular_function^monoamine transmembrane transporter activity`GO:0005334^molecular_function^norepinephrine:sodium symporter activity`GO:0015101^molecular_function^organic cation transmembrane transporter activity`GO:0042803^molecular_function^protein homodimerization activity`GO:0015651^molecular_function^quaternary ammonium group transmembrane transporter activity`GO:0008513^molecular_function^secondary active organic cation transmembrane transporter activity`GO:0015872^biological_process^dopamine transport`GO:0006855^biological_process^drug transmembrane transport`GO:0048241^biological_process^epinephrine transport`GO:0010248^biological_process^establishment or maintenance of transmembrane electrochemical gradient`GO:0015844^biological_process^monoamine transport`GO:0015874^biological_process^norepinephrine transport`GO:0015695^biological_process^organic cation transport`GO:0051260^biological_process^protein homooligomerization`GO:0015697^biological_process^quaternary ammonium group transport</td>
<td style="text-align: left;">GO:0022857^molecular_function^transmembrane transporter activity`GO:0055085^biological_process^transmembrane transport`GO:0016021^cellular_component^integral component of membrane</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRINITY_DN8_c0_g1</td>
<td style="text-align: left;">TRINITY_DN8_c0_g1_i1</td>
<td style="text-align: left;">sp|Q63089|S22A1_RAT^sp|Q63089|S22A1_RAT^Q:905-18,H:87-381^36.2%ID^E:1.09e-38^.^.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">TRINITY_DN8_c0_g1_i1.p2</td>
<td style="text-align: left;">810-1[-]</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TRINITY_DN8_c0_g1</td>
<td style="text-align: left;">TRINITY_DN8_c0_g1_i4</td>
<td style="text-align: left;">sp|Q9VIK2|CART_DROME^sp|Q9VIK2|CART_DROME^Q:1209-529,H:114-344^33.8%ID^E:2.21e-27^.^.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">TRINITY_DN8_c0_g1_i4.p1</td>
<td style="text-align: left;">1212-475[-]</td>
<td style="text-align: left;">CART_DROME^CART_DROME^Q:2-242,H:114-358^32.661%ID^E:6.98e-33^RecName: Full=Carcinine transporter {ECO:0000303|PubMed:26653853, ECO:0000303|PubMed:26713872};^Eukaryota; Metazoa; Ecdysozoa; Arthropoda; Hexapoda; Insecta; Pterygota; Neoptera; Holometabola; Diptera; Brachycera; Muscomorpha; Ephydroidea; Drosophilidae; Drosophila; Sophophora</td>
<td style="text-align: left;">PF00083.24^Sugar_tr^Sugar (and other) transporter^56-219^E:7.4e-19`PF07690.16^MFS_1^Major Facilitator Superfamily^61-209^E:1e-15</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">ExpAA=106.03^PredHel=5^Topology=i59-81o91-109i116-138o148-170i177-196o</td>
<td style="text-align: left;">ENOG410XSRI^solute carrier family 22</td>
<td style="text-align: left;">KEGG:dme:Dmel_CG9317</td>
<td style="text-align: left;">GO:0043679^cellular_component^axon terminus`GO:0016021^cellular_component^integral component of membrane`GO:0005886^cellular_component^plasma membrane`GO:1905131^molecular_function^carcinine transmembrane transporter activity`GO:0005326^molecular_function^neurotransmitter transporter activity`GO:1905130^biological_process^carcinine import across plasma membrane`GO:0050908^biological_process^detection of light stimulus involved in visual perception`GO:0001504^biological_process^neurotransmitter uptake`GO:0046956^biological_process^positive phototaxis`GO:0007601^biological_process^visual perception</td>
<td style="text-align: left;">GO:0022857^molecular_function^transmembrane transporter activity`GO:0055085^biological_process^transmembrane transport`GO:0016021^cellular_component^integral component of membrane</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRINITY_DN8_c0_g1</td>
<td style="text-align: left;">TRINITY_DN8_c0_g1_i4</td>
<td style="text-align: left;">sp|Q9VIK2|CART_DROME^sp|Q9VIK2|CART_DROME^Q:1209-529,H:114-344^33.8%ID^E:2.21e-27^.^.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">TRINITY_DN8_c0_g1_i4.p2</td>
<td style="text-align: left;">1114-494[-]</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TRINITY_DN8_c0_g1</td>
<td style="text-align: left;">TRINITY_DN8_c0_g1_i4</td>
<td style="text-align: left;">sp|Q9VIK2|CART_DROME^sp|Q9VIK2|CART_DROME^Q:1209-529,H:114-344^33.8%ID^E:2.21e-27^.^.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">TRINITY_DN8_c0_g1_i4.p3</td>
<td style="text-align: left;">497-126[-]</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">ExpAA=41.12^PredHel=2^Topology=i13-35o104-122i</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRINITY_DN8_c0_g2</td>
<td style="text-align: left;">TRINITY_DN8_c0_g2_i1</td>
<td style="text-align: left;">sp|Q6NY98|MCE1_DANRE^sp|Q6NY98|MCE1_DANRE^Q:665-84,H:7-198^57.7%ID^E:2.12e-77^.^.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">TRINITY_DN8_c0_g2_i1.p1</td>
<td style="text-align: left;">707-3[-]</td>
<td style="text-align: left;">MCE1_MOUSE^MCE1_MOUSE^Q:14-203,H:6-193^56.842%ID^E:4.77e-75^RecName: Full=mRNA-capping enzyme;^Eukaryota; Metazoa; Chordata; Craniata; Vertebrata; Euteleostomi; Mammalia; Eutheria; Euarchontoglires; Glires; Rodentia; Myomorpha; Muroidea; Muridae; Murinae; Mus; Mus</td>
<td style="text-align: left;">PF00782.20^DSPc^Dual specificity phosphatase, catalytic domain^65-182^E:5.3e-10</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">COG5226^Second step of mRNA capping. Transfer of the GMP moiety of GTP to the 5'-end of RNA via an enzyme-GMP covalent reaction intermediate (By similarity)</td>
<td style="text-align: left;">KEGG:mmu:24018`KO:K13917</td>
<td style="text-align: left;">GO:0005634^cellular_component^nucleus`GO:0005525^molecular_function^GTP binding`GO:0004484^molecular_function^mRNA guanylyltransferase activity`GO:0004651^molecular_function^polynucleotide 5'-phosphatase activity`GO:0004725^molecular_function^protein tyrosine phosphatase activity`GO:0008138^molecular_function^protein tyrosine/serine/threonine phosphatase activity`GO:0008192^molecular_function^RNA guanylyltransferase activity`GO:0050355^molecular_function^triphosphatase activity`GO:0006370^biological_process^7-methylguanosine mRNA capping`GO:0006396^biological_process^RNA processing</td>
<td style="text-align: left;">GO:0008138^molecular_function^protein tyrosine/serine/threonine phosphatase activity`GO:0016311^biological_process^dephosphorylation</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">.</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<div class="cell" data-hash="index_cache/html/annotation-counts_b8c38a99ee3ed3706329435f365333f8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">number_of_annotations <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n_distinct</span>(annotations.df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>X.gene_id)</span></code></pre></div>
</details>
</div>
<p>Number of Trinity genes with annotations: 142402</p>
</section>
<section id="sqlite-database" class="level3">
<h3 class="anchored" data-anchor-id="sqlite-database">SQlite Database</h3>
<p>SQlite database (797MB; SQLITE):</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/20231109-mmag-trinotate-transcriptome/Trinotate.sqlite">Trinotate.sqlite</a></li>
</ul>


</section>
</section>
</section>

 ]]></description>
  <category>mox</category>
  <category>2023</category>
  <category>Metacarcinus magister</category>
  <category>Dungenss crab</category>
  <category>Trinotate</category>
  <category>transcriptome</category>
  <category>annotation</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-11-09-Transcriptome-Annotation---M.magister-De-Novo-Transcriptome-Assembly-Using-Trinotate-on-Mox/index.html</guid>
  <pubDate>Thu, 09 Nov 2023 08:00:00 GMT</pubDate>
</item>
<item>
  <title>Transcriptome Annotation - M.magister De Novo Transcriptome Assembly for DuMOAR Project Using DIAMOND BLASTx on Mox</title>
  <dc:creator>Sam White</dc:creator>
  <link>https://robertslab.github.io/sams-notebook/posts/2023/2023-11-09-Transcriptome-Annotation---M.magister-De-Novo-Transcriptome-Assembly-for-DuMOAR-Project-Using-DIAMOND-BLASTx-on-Mox/index.html</link>
  <description><![CDATA[ 




<section id="intro" class="level1">
<h1>Intro</h1>
<p>As part of the process for using <a href="https://github.com/Trinotate/Trinotate/wiki"><code>Trinotate</code></a> for <a href="https://github.com/laurahspencer/DuMOAR/issues/44">transcriptome annotation</a> (GitHub Issue), I previously ran <a href="../../../posts/2023/2023-11-07-Transcriptome-Annotation---M.magister-De-Novo-Transcriptome-Assembly-for-DuMOAR-Project-Using-TransDecoder-on-Mox/index.html">TransDecoder on 20231107</a>. Next, I needed to run BLASTx. As usual, I opted for <a href="https://github.com/bbuchfink/diamond"><code>DIAMOND</code></a> BLASTx, as it is insanely faster than <a href="https://www.ncbi.nlm.nih.gov/books/NBK279690/">NCBI <code>BLASTx</code></a>. This was run on Mox.</p>
<section id="slurm-script" class="level2">
<h2 class="anchored" data-anchor-id="slurm-script">SLURM script</h2>
<ul>
<li><a href="https://github.com/RobertsLab/sams-notebook/blob/master/sbatch_scripts/20231109-mmag-transcriptome-diamond-blastx.sh">20231109-mmag-transcriptome-diamond-blastx.sh</a> (GitHub)</li>
</ul>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Job Name</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --job-name=20231109-mmag-transcriptome-diamond-blastx</span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Allocation Definition</span></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --account=srlab</span></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --partition=srlab</span></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Resources</span></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Nodes</span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --nodes=1</span></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Walltime (days-hours:minutes:seconds format)</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --time=3-00:00:00</span></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Memory per node</span></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mem=500G</span></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##turn on e-mail notification</span></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-type=ALL</span></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-user=samwhite@uw.edu</span></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Specify the working directory for this job</span></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --chdir=/gscratch/scrubbed/samwhite/outputs/20231109-mmag-transcriptome-diamond-blastx</span></span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### DIAMOND BLASTx of M.magister de novo transcriptome.</span></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### For use in DuMOAR transcript annotation.</span></span>
<span id="cb1-22"></span>
<span id="cb1-23"></span>
<span id="cb1-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################</span></span>
<span id="cb1-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># These variables need to be set by user</span></span>
<span id="cb1-26"></span>
<span id="cb1-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Exit script if any command fails</span></span>
<span id="cb1-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span></span>
<span id="cb1-29"></span>
<span id="cb1-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load Python Mox module for Python module availability</span></span>
<span id="cb1-31"></span>
<span id="cb1-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load intel-python3_2017</span>
<span id="cb1-33"></span>
<span id="cb1-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># SegFault fix?</span></span>
<span id="cb1-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">THREADS_DAEMON_MODEL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb1-36"></span>
<span id="cb1-37"></span>
<span id="cb1-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Programs array</span></span>
<span id="cb1-39"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">declare</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span></span>
<span id="cb1-40"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb1-41"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>diamond<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/programs/diamond-v2.1.1/diamond"</span></span>
<span id="cb1-42"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-43"></span>
<span id="cb1-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># DIAMOND UniProt database</span></span>
<span id="cb1-45"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dmnd_db</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/blastdbs/20230727-uniprot-swissprot-reviewed/uniprot_sprot.dmnd"</span></span>
<span id="cb1-46"></span>
<span id="cb1-47"></span>
<span id="cb1-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Genome (FastA)</span></span>
<span id="cb1-49"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fasta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/sam/data/M_magister/transcriptomes/trinity_denovo.Trinity.fasta"</span></span>
<span id="cb1-50"></span>
<span id="cb1-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################</span></span>
<span id="cb1-52"></span>
<span id="cb1-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Strip leading pat and extensions</span></span>
<span id="cb1-54"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">no_path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fasta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-55"></span>
<span id="cb1-56"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Strip extension</span></span>
<span id="cb1-57"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">no_ext</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${no_path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>.<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-58"></span>
<span id="cb1-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run DIAMOND with blastx</span></span>
<span id="cb1-60"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>diamond<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> blastx <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-61">--db <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${dmnd_db}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-62">--query <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fasta}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-63">--out <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${no_ext}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.blastx.outfmt6 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-64">--outfmt 6 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-65">--sensitive <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-66">--evalue 1e-25 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-67">--max-target-seqs 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-68">--block-size 15.0 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-69">--index-chunks 4</span>
<span id="cb1-70"></span>
<span id="cb1-71"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate checksums for future reference</span></span>
<span id="cb1-72"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb1-73"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span>
<span id="cb1-74">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-75">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Generating checksum for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">."</span></span>
<span id="cb1-76">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-77"></span>
<span id="cb1-78">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--append</span> checksums.md5</span>
<span id="cb1-79">  </span>
<span id="cb1-80">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-81"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span>
<span id="cb1-82"></span>
<span id="cb1-83"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Generating checksum for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fasta}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">."</span></span>
<span id="cb1-84"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-85"></span>
<span id="cb1-86"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md5sum</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fasta}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--append</span> checksums.md5</span>
<span id="cb1-87"></span>
<span id="cb1-88"></span>
<span id="cb1-89"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###################################################################################</span></span>
<span id="cb1-90"></span>
<span id="cb1-91"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Disable exit on error</span></span>
<span id="cb1-92"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> +e</span>
<span id="cb1-93"></span>
<span id="cb1-94"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Capture program options</span></span>
<span id="cb1-95"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-gt</span> 0 <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-96">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Logging program options..."</span></span>
<span id="cb1-97">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> program <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-98">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span>
<span id="cb1-99">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-100">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Program options for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">: "</span></span>
<span id="cb1-101">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-102">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle samtools help menus</span></span>
<span id="cb1-103">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_index"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-104">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_sort"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-105">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools_view"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]]</span></span>
<span id="cb1-106">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-107">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-108"></span>
<span id="cb1-109">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle DIAMOND BLAST menu</span></span>
<span id="cb1-110">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"diamond"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-111">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> help</span>
<span id="cb1-112"></span>
<span id="cb1-113">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle NCBI BLASTx menu</span></span>
<span id="cb1-114">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blastx"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-115">      <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-help</span></span>
<span id="cb1-116">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb1-117">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_array</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$program</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-h</span></span>
<span id="cb1-118">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-119">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-120">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"----------------------------------------------"</span></span>
<span id="cb1-121">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-122">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-123">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&gt;&gt;</span> program_options.log <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb1-124"></span>
<span id="cb1-125">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If MultiQC is in programs_array, copy the config file to this directory.</span></span>
<span id="cb1-126">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${program}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"multiqc"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb1-127">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cp</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--preserve</span> ~/.multiqc_config.yaml multiqc_config.yaml</span>
<span id="cb1-128">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb1-129">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span>
<span id="cb1-130"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb1-131"></span>
<span id="cb1-132"></span>
<span id="cb1-133"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Document programs in PATH (primarily for program version ID)</span></span>
<span id="cb1-134"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-135"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">date</span></span>
<span id="cb1-136"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-137"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"System PATH for </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$SLURM_JOB_ID</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-138"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-139"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%0.s-"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">..</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-140"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${PATH}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tr</span> : <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\\</span>n</span>
<span id="cb1-141"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> system_path.log</span></code></pre></div>
<p>/———-</p>
</section>
</section>
<section id="results" class="level1">
<h1>RESULTS</h1>
<section id="runtime" class="level2">
<h2 class="anchored" data-anchor-id="runtime">Runtime</h2>
<p>As usual, <a href="https://github.com/bbuchfink/diamond"><code>DIAMOND</code></a> BLASTx was ridiculously fast; 1m and 17secs!</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://robertslab.github.io/sams-notebook/posts/2023/2023-11-09-Transcriptome-Annotation---M.magister-De-Novo-Transcriptome-Assembly-for-DuMOAR-Project-Using-DIAMOND-BLASTx-on-Mox/20231109-mmag-transcriptome-diamond-blastx-runtime.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Screencap showing Mox DIAMOND BLASTx run time of 1min and 17secs</figcaption>
</figure>
</div>
</section>
<section id="files" class="level2">
<h2 class="anchored" data-anchor-id="files">FILES</h2>
<p>Output directory:</p>
<ul>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20231109-mmag-transcriptome-diamond-blastx/">20231109-mmag-transcriptome-diamond-blastx/</a></p>
<h3 id="blastx-txt-output-format-6" class="anchored">BLASTx (txt; output format 6)</h3>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/20231109-mmag-transcriptome-diamond-blastx/trinity_denovo.Trinity.blastx.outfmt6">trinity_denovo.Trinity.blastx.outfmt6</a></li>
</ul></li>
</ul>


</section>
</section>

 ]]></description>
  <category>mox</category>
  <category>DIAMOND</category>
  <category>BLASTx</category>
  <category>transcriptome</category>
  <category>2023</category>
  <category>DuMOAR</category>
  <category>Dungeness crab</category>
  <category>Metacarcinus magister</category>
  <guid>https://robertslab.github.io/sams-notebook/posts/2023/2023-11-09-Transcriptome-Annotation---M.magister-De-Novo-Transcriptome-Assembly-for-DuMOAR-Project-Using-DIAMOND-BLASTx-on-Mox/index.html</guid>
  <pubDate>Thu, 09 Nov 2023 08:00:00 GMT</pubDate>
</item>
</channel>
</rss>
