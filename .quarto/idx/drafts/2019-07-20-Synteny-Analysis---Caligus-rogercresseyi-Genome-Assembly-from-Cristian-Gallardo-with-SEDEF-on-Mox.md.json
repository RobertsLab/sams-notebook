{"title":"Synteny Analysis - Caligus rogercresseyi Genome Assembly from Cristian Gallardo with SEDEF on Mox","markdown":{"yaml":{"layout":"post","title":"Synteny Analysis - Caligus rogercresseyi Genome Assembly from Cristian Gallardo with SEDEF on Mox","date":"2019-07-20 11:20","tags":["Caligus rogercresseyi","synteny","SEDEF","emu","mox"],"categories":["Miscellaneous"]},"headingText":"Script to subset top 21 scaffolds of C_rogercresseyi genome assembly,","containsRefs":false,"markdown":"\nWe received a _Caligus rogercresseyi_ genome assembly from Cristian Gallardo (see this [GitHub Issue](https://github.com/RobertsLab/resources/issues/710)) to try to run Sibelia on our computers. I tried on Emu and on Mox and couldn't get the program to complete. On Emu, the primary issue was insufficient memory. I tried on Mox with the 128GB node and that also died due to insufficient memory. Both of those jobs ran for weeks before dying. I followed with two attempts on Mox with the 512GB node. These two attempts ran for 16 and 20 days, but timed out. Since the maximum amount of time we generally have for a job on Mox is 30 days (due to regular maintenance shutdowns), we can't use Sibelia for synteny analysis.\n\nSo, I'm trying another piece of software (using Mox) that Cristian had mentioned: [SEDEF](https://github.com/vpc-ccg/sedef).\n\nBefore I can SEDEF, all repeat regions need to be soft-masked (i.e. identified and replaced with lowercase letters). To do so, I ran RepeatMasker (v0.4.0) on Emu.\n\n Bash script (GitHub):\n\n - [20191015_crog_repeatmasker.sh](https://github.com/RobertsLab/sams-notebook/blob/master/bash_scripts/20191015_crog_repeatmasker.sh)\n\n```shell\n#!/usr/bin/bash\n\n# and create a soft-masked (lowercase repeats) FastA for use with SEDEF.\n# Assembly provided by Cristian Gallardo.\n# Run on Emu.\n\n# Exit if any command fails\nset -e\n\n# Set CPUs\ncpus=16\n\n# Input/output files\nassembly_fasta=\"Caligus_rogercresseyi_Genome.fa\"\nassembly_index=\"Caligus_rogercresseyi_Genome.fa.fai\"\nassembly_subset=\"C_rogercresseyi_top_21_scaffold.fa\"\nsystem_specs=\"system_info.txt\"\nsubset_list=\"top_21_scaffold_list.txt\"\n\n# Program paths\nsamtools=\"/home/shared/samtools-1.8/samtools\"\nrepeatmasker=\"/home/shared/RepeatMasker-4.0.7/RepeatMasker\"\n\n\n# Record system info\n{\necho \"TODAY'S DATE:\"\ndate\necho \"------------\"\necho \"\"\nlsb_release -a\necho \"\"\necho \"------------\"\necho \"HOSTNAME: \" hostname\necho \"\"\necho \"------------\"\necho \"Computer Specs:\"\necho \"\"\nlscpu\necho \"\"\necho \"------------\"\necho \"\"\necho \"Memory Specs\"\necho \"\"\nfree -mh\n} >> \"${system_specs}\"\n\n\n# Index assembly FastA file\n\"${samtools}\" faidx \\\n\"${assembly_fasta}\"\n\n# Extract list of top 21 longest scaffolds\nsort \\\n--numeric-sort \\\n--reverse \\\n--field-separator $'\\t' \\\n--key 2,2 \\\n\"${assembly_index}\" \\\n| head -n 21 \\\n| awk -F'\\t' '{print $1}' \\\n> \"${subset_list}\"\n\n# Create FastA of longest 21 scaffolds\nxargs \\\n\"${samtools}\" faidx \\\n\"${assembly_fasta}\" \\\n< \"${subset_list}\" \\\n> \"${assembly_subset}\"\n\n# Run RepeatMasker on longest 21 scaffolds\n# -xsmall option generates lowercase, soft-masked repeats (instead of replacing with Xs)\ntime \\\n${repeatmasker} \\\n${assembly_subset} \\\n-species \"all\" \\\n-pa ${cpus} \\\n-excln \\\n-xsmall \\\n1> stdout.out \\\n2> stderr.err\n\n# Email me when finished\nsed '/^Subject:/ s/ / repeatmasker_C_rog_all JOB COMPLETE/' ~/.default-subject.mail | msmtp \"$EMAIL\"\n```\n\n---\n\n#### RESULTS\n\nOutput folder:\n\n- []()\n","srcMarkdownNoYaml":"\nWe received a _Caligus rogercresseyi_ genome assembly from Cristian Gallardo (see this [GitHub Issue](https://github.com/RobertsLab/resources/issues/710)) to try to run Sibelia on our computers. I tried on Emu and on Mox and couldn't get the program to complete. On Emu, the primary issue was insufficient memory. I tried on Mox with the 128GB node and that also died due to insufficient memory. Both of those jobs ran for weeks before dying. I followed with two attempts on Mox with the 512GB node. These two attempts ran for 16 and 20 days, but timed out. Since the maximum amount of time we generally have for a job on Mox is 30 days (due to regular maintenance shutdowns), we can't use Sibelia for synteny analysis.\n\nSo, I'm trying another piece of software (using Mox) that Cristian had mentioned: [SEDEF](https://github.com/vpc-ccg/sedef).\n\nBefore I can SEDEF, all repeat regions need to be soft-masked (i.e. identified and replaced with lowercase letters). To do so, I ran RepeatMasker (v0.4.0) on Emu.\n\n Bash script (GitHub):\n\n - [20191015_crog_repeatmasker.sh](https://github.com/RobertsLab/sams-notebook/blob/master/bash_scripts/20191015_crog_repeatmasker.sh)\n\n```shell\n#!/usr/bin/bash\n\n# Script to subset top 21 scaffolds of C_rogercresseyi genome assembly,\n# and create a soft-masked (lowercase repeats) FastA for use with SEDEF.\n# Assembly provided by Cristian Gallardo.\n# Run on Emu.\n\n# Exit if any command fails\nset -e\n\n# Set CPUs\ncpus=16\n\n# Input/output files\nassembly_fasta=\"Caligus_rogercresseyi_Genome.fa\"\nassembly_index=\"Caligus_rogercresseyi_Genome.fa.fai\"\nassembly_subset=\"C_rogercresseyi_top_21_scaffold.fa\"\nsystem_specs=\"system_info.txt\"\nsubset_list=\"top_21_scaffold_list.txt\"\n\n# Program paths\nsamtools=\"/home/shared/samtools-1.8/samtools\"\nrepeatmasker=\"/home/shared/RepeatMasker-4.0.7/RepeatMasker\"\n\n\n# Record system info\n{\necho \"TODAY'S DATE:\"\ndate\necho \"------------\"\necho \"\"\nlsb_release -a\necho \"\"\necho \"------------\"\necho \"HOSTNAME: \" hostname\necho \"\"\necho \"------------\"\necho \"Computer Specs:\"\necho \"\"\nlscpu\necho \"\"\necho \"------------\"\necho \"\"\necho \"Memory Specs\"\necho \"\"\nfree -mh\n} >> \"${system_specs}\"\n\n\n# Index assembly FastA file\n\"${samtools}\" faidx \\\n\"${assembly_fasta}\"\n\n# Extract list of top 21 longest scaffolds\nsort \\\n--numeric-sort \\\n--reverse \\\n--field-separator $'\\t' \\\n--key 2,2 \\\n\"${assembly_index}\" \\\n| head -n 21 \\\n| awk -F'\\t' '{print $1}' \\\n> \"${subset_list}\"\n\n# Create FastA of longest 21 scaffolds\nxargs \\\n\"${samtools}\" faidx \\\n\"${assembly_fasta}\" \\\n< \"${subset_list}\" \\\n> \"${assembly_subset}\"\n\n# Run RepeatMasker on longest 21 scaffolds\n# -xsmall option generates lowercase, soft-masked repeats (instead of replacing with Xs)\ntime \\\n${repeatmasker} \\\n${assembly_subset} \\\n-species \"all\" \\\n-pa ${cpus} \\\n-excln \\\n-xsmall \\\n1> stdout.out \\\n2> stderr.err\n\n# Email me when finished\nsed '/^Subject:/ s/ / repeatmasker_C_rog_all JOB COMPLETE/' ~/.default-subject.mail | msmtp \"$EMAIL\"\n```\n\n---\n\n#### RESULTS\n\nOutput folder:\n\n- []()\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"output-file":"2019-07-20-Synteny-Analysis---Caligus-rogercresseyi-Genome-Assembly-from-Cristian-Gallardo-with-SEDEF-on-Mox.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","editor":"source","theme":"darkly","page-layout":"full","code-background":true,"code-copy":true,"layout":"post","title":"Synteny Analysis - Caligus rogercresseyi Genome Assembly from Cristian Gallardo with SEDEF on Mox","date":"2019-07-20 11:20","tags":["Caligus rogercresseyi","synteny","SEDEF","emu","mox"],"categories":["Miscellaneous"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}