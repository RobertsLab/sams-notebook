{"title":"Data Analysis - C.virginica BSseq Unmapped Reads Using MEGAN6","markdown":{"yaml":{"author":"Sam White","toc-title":"Contents","toc-depth":5,"toc-location":"left","layout":"post","title":"Data Analysis - C.virginica BSseq Unmapped Reads Using MEGAN6","date":"2022-03-09 13:22","tags":["MEGAN","Crassostrea virginica","Eastern oyster","taxonomy"],"categories":["2022","Miscellaneous"]},"headingText":"RESULTS","containsRefs":false,"markdown":"\nAfter [performing DIAMOND BLASTx and DAA \"meganization\" on 20220302](https://robertslab.github.io/sams-notebook/posts/2022/2022-03-02-Taxonomic-Assignment---C.virginica-BSseq-Unmapped-Reads-Using-DIAMOND-BLASTx-and-MEGAN6-on-Mox/), the next step was to import the DAA files into MEGAN6 for analyzing the resulting taxonomic assignments of the [_Crassostrea virginica_ (Eastern oyster)](https://en.wikipedia.org/wiki/Eastern_oyster) unmapped BSseq reads that Steven generated.\n\n\"Meganized\" DAA files were imported into MEGAN6 (v.6.21.5), via the \"Import from BLAST\" dialog menu. All paired read DAA files were imported together (but _not_ using the \"paired reads\" option, since I didn't provide the corresponding FastQ files for this - no real reason; just didn't think it necessary for this particulary analysis) using the `megan-map-Jan2021.db` for Taxonomy. This importation generated a single corresponding RMA6 (i.e one RMA6 file for each pair of DAA files). In retrospect, I should have just converted the DAA files to RMA6 during the [DIAMOND BLASTx and DAA \"meganization\" on 20220302](https://robertslab.github.io/sams-notebook/posts/2022/2022-03-02-Taxonomic-Assignment---C.virginica-BSseq-Unmapped-Reads-Using-DIAMOND-BLASTx-and-MEGAN6-on-Mox/). It would've saved a lot of memory-related issues when trying to import many DAA files in a single MEGAN6 session...\n\nAfter conversion to RMA6, a new \"Comparison\" was created, which allows visualization of taxonomic assignments across all samples, simultaneously.\n\n\n---\n\n\nOutput folder:\n\n- [20220309-cvir-unmapped_bsseq-megan/](https://gannet.fish.washington.edu/Atumefaciens/20220309-cvir-unmapped_bsseq-megan/)\n\n  - MEGAN6 Comparison file (2.3MB):\n\n    - [20220309-cvir-unmapped_bsseq-megan/20220309-cvir-unmapped-bsseq-comparison.megan](https://gannet.fish.washington.edu/Atumefaciens/20220309-cvir-unmapped_bsseq-megan/20220309-cvir-unmapped-bsseq-comparison.megan)\n\nIt looked like the bulk of reads in all samples (i.e. > 75%) get assigned to the genus _Crassostrea_ (see images at bottom of post).\n\n\n---\n\nWordcloud of taxonomic assignments of reads for each sample (Genus level):\n\n![Wordcloud of taxonomic assignments for all unmapped BSseq reads in each sample at the \"Genus\" level generated using MEGAN6 software, with the Genus \"Crassostrea\" as the most prominent of all the words present. In fact, all other words so small as to be illegible.](https://github.com/RobertsLab/sams-notebook/blob/master/images/20220309-cvir-unmapped_bsseq-megan-wordcloud-genus.png?raw=true)\n\n---\n\nPhylogenetic tree of taxonomic assignments of reads for each sample (Genus level):\n\n![Phylogenetic tree of unmapped BSseq reads generated by MEGN6 software showing that most reads in all samples examined are assigned to the Genus \"Crassostrea\"](https://github.com/RobertsLab/sams-notebook/blob/master/images/20220309-cvir-unmapped_bsseq-megan-tree-assignments-genus.png?raw=true)\n\n---\n\nAnd, here's the tree at the species level to help confirm that there's not a bunch of _C.gigas_ contamination and that it's primarily [_Crassostrea virginica_ (Eastern oyster)](https://en.wikipedia.org/wiki/Eastern_oyster):\n\n![Phylogenetic tree of unmapped BSseq reads generated by MEGN6 software showing that most reads in all samples examined are assigned to the Species\"Crassostrea virginica\"](https://github.com/RobertsLab/sams-notebook/blob/master/images/20220309-cvir-unmapped_bsseq-megan-tree-assignments-species.png?raw=true)\n\n---\n\nSo, not sure why they're not getting mapped originally.\n\nI'm assuming these came from Bismark? If yes, the manual provides a bit of insight into capturing unmapped reads. Additionally, a comparison of unmapped reads and ambiguous reads might allow a better grasp of what's happening:\n\n>\n> `--un`\n>\n> Write all reads that could not be aligned to the file _unmapped_reads.fq.gz in the output directory. Written reads will appear as they did in the input, without any translation of quality values that may have taken place within Bowtie or Bismark. Paired-end reads will be written to two parallel files with _1 and _2 inserted in their filenames, i.e. `unmapped_reads_1.fq.gz` and `unmapped_reads_2.fq.gz`. Reads with more than one valid alignment with the same number of lowest mismatches (ambiguous mapping) are also written to unmapped_reads.fq.gz unless `--ambiguous` is also specified.\n>\n> `--ambiguous`\n>\n> Write all reads which produce more than one valid alignment with the same number of lowest mismatches or other reads that fail to align uniquely to _ambiguous_reads.fq. Written reads will appear as they did in the input, without any of the translation of quality values that may have taken place within Bowtie or Bismark. Paired-end reads will be written to two parallel files with _1 and _2 inserted in their filenames, i.e. `_ambiguous_reads_1.fq` and `_ambiguous_reads_2.fq`. These reads are not written to the file specified with `--un`.\n","srcMarkdownNoYaml":"\nAfter [performing DIAMOND BLASTx and DAA \"meganization\" on 20220302](https://robertslab.github.io/sams-notebook/posts/2022/2022-03-02-Taxonomic-Assignment---C.virginica-BSseq-Unmapped-Reads-Using-DIAMOND-BLASTx-and-MEGAN6-on-Mox/), the next step was to import the DAA files into MEGAN6 for analyzing the resulting taxonomic assignments of the [_Crassostrea virginica_ (Eastern oyster)](https://en.wikipedia.org/wiki/Eastern_oyster) unmapped BSseq reads that Steven generated.\n\n\"Meganized\" DAA files were imported into MEGAN6 (v.6.21.5), via the \"Import from BLAST\" dialog menu. All paired read DAA files were imported together (but _not_ using the \"paired reads\" option, since I didn't provide the corresponding FastQ files for this - no real reason; just didn't think it necessary for this particulary analysis) using the `megan-map-Jan2021.db` for Taxonomy. This importation generated a single corresponding RMA6 (i.e one RMA6 file for each pair of DAA files). In retrospect, I should have just converted the DAA files to RMA6 during the [DIAMOND BLASTx and DAA \"meganization\" on 20220302](https://robertslab.github.io/sams-notebook/posts/2022/2022-03-02-Taxonomic-Assignment---C.virginica-BSseq-Unmapped-Reads-Using-DIAMOND-BLASTx-and-MEGAN6-on-Mox/). It would've saved a lot of memory-related issues when trying to import many DAA files in a single MEGAN6 session...\n\nAfter conversion to RMA6, a new \"Comparison\" was created, which allows visualization of taxonomic assignments across all samples, simultaneously.\n\n\n---\n\n# RESULTS\n\nOutput folder:\n\n- [20220309-cvir-unmapped_bsseq-megan/](https://gannet.fish.washington.edu/Atumefaciens/20220309-cvir-unmapped_bsseq-megan/)\n\n  - MEGAN6 Comparison file (2.3MB):\n\n    - [20220309-cvir-unmapped_bsseq-megan/20220309-cvir-unmapped-bsseq-comparison.megan](https://gannet.fish.washington.edu/Atumefaciens/20220309-cvir-unmapped_bsseq-megan/20220309-cvir-unmapped-bsseq-comparison.megan)\n\nIt looked like the bulk of reads in all samples (i.e. > 75%) get assigned to the genus _Crassostrea_ (see images at bottom of post).\n\n\n---\n\nWordcloud of taxonomic assignments of reads for each sample (Genus level):\n\n![Wordcloud of taxonomic assignments for all unmapped BSseq reads in each sample at the \"Genus\" level generated using MEGAN6 software, with the Genus \"Crassostrea\" as the most prominent of all the words present. In fact, all other words so small as to be illegible.](https://github.com/RobertsLab/sams-notebook/blob/master/images/20220309-cvir-unmapped_bsseq-megan-wordcloud-genus.png?raw=true)\n\n---\n\nPhylogenetic tree of taxonomic assignments of reads for each sample (Genus level):\n\n![Phylogenetic tree of unmapped BSseq reads generated by MEGN6 software showing that most reads in all samples examined are assigned to the Genus \"Crassostrea\"](https://github.com/RobertsLab/sams-notebook/blob/master/images/20220309-cvir-unmapped_bsseq-megan-tree-assignments-genus.png?raw=true)\n\n---\n\nAnd, here's the tree at the species level to help confirm that there's not a bunch of _C.gigas_ contamination and that it's primarily [_Crassostrea virginica_ (Eastern oyster)](https://en.wikipedia.org/wiki/Eastern_oyster):\n\n![Phylogenetic tree of unmapped BSseq reads generated by MEGN6 software showing that most reads in all samples examined are assigned to the Species\"Crassostrea virginica\"](https://github.com/RobertsLab/sams-notebook/blob/master/images/20220309-cvir-unmapped_bsseq-megan-tree-assignments-species.png?raw=true)\n\n---\n\nSo, not sure why they're not getting mapped originally.\n\nI'm assuming these came from Bismark? If yes, the manual provides a bit of insight into capturing unmapped reads. Additionally, a comparison of unmapped reads and ambiguous reads might allow a better grasp of what's happening:\n\n>\n> `--un`\n>\n> Write all reads that could not be aligned to the file _unmapped_reads.fq.gz in the output directory. Written reads will appear as they did in the input, without any translation of quality values that may have taken place within Bowtie or Bismark. Paired-end reads will be written to two parallel files with _1 and _2 inserted in their filenames, i.e. `unmapped_reads_1.fq.gz` and `unmapped_reads_2.fq.gz`. Reads with more than one valid alignment with the same number of lowest mismatches (ambiguous mapping) are also written to unmapped_reads.fq.gz unless `--ambiguous` is also specified.\n>\n> `--ambiguous`\n>\n> Write all reads which produce more than one valid alignment with the same number of lowest mismatches or other reads that fail to align uniquely to _ambiguous_reads.fq. Written reads will appear as they did in the input, without any of the translation of quality values that may have taken place within Bowtie or Bismark. Paired-end reads will be written to two parallel files with _1 and _2 inserted in their filenames, i.e. `_ambiguous_reads_1.fq` and `_ambiguous_reads_2.fq`. These reads are not written to the file specified with `--un`.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../../styles.css"],"toc":true,"toc-depth":5,"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","editor":"source","theme":"darkly","page-layout":"full","code-background":true,"code-copy":true,"title-block-banner":true,"author":"Sam White","toc-title":"Contents","toc-location":"left","layout":"post","title":"Data Analysis - C.virginica BSseq Unmapped Reads Using MEGAN6","date":"2022-03-09 13:22","tags":["MEGAN","Crassostrea virginica","Eastern oyster","taxonomy"],"categories":["2022","Miscellaneous"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}