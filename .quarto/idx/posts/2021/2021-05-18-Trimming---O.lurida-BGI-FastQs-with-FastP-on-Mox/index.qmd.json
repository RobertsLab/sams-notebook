{"title":"Trimming - O.lurida BGI FastQs with FastP on Mox","markdown":{"yaml":{"author":"Sam White","toc-title":"Contents","toc-depth":5,"toc-location":"left","layout":"post","title":"Trimming - O.lurida BGI FastQs with FastP on Mox","date":"2021-05-18 10:48","categories":["fastp","mox","Ostrea lurida","Olympia oyster","trimming","2021","Olympia Oyster Genome Sequencing"]},"headingText":"Job Name","containsRefs":false,"markdown":"\n[After attempting to submit our _Ostrea lurida_ (Olympia oyster) genome assembly annotations (via GFF) to NCBI](../2021-05-13-Genome-Submission---Validation-of-Olurida_v081.fa-and-Annotated-GFFs-Prior-to-Submission-to-NCBI/index.qmd), the submission process also highlighted some short comings of the `Olurida_v081` assembly. When getting ready to submit the genome annotations to NCBI, I was required to calculate the genome coverage we had. NCBI suggested to calculate this simply by counting the number of bases sequenced and divide it by the genome size. Doing this resulted in an estimated coverage of ~55X coverage, yet we have significant stretches of Ns throughout the assembly. I understand why this is still technically possible, but it's just sticking in my craw. So, I've decided to set up a quick assembly to see what I can come up with. Of note, the [canonical assembly we've been using relied on the scaffolded assembly provided by BGI](../../2017/2017-11-30-genome-assembly-olympia-oyster-illumina-pacbio-using-pb-jelly-wbgi-scaffold-assembly-2/index.qmd); we never attempted our own assembly from the raw data.\n\nTo start, I needed to trim the data. I ran the BGI Illumina sequencing data through [`fastp`](https://github.com/OpenGene/fastp) on Mox.\n\nSBATCH script (GitHub):\n\n- [0210518_olur_fastp_bgi.sh](https://github.com/RobertsLab/sams-notebook/blob/master/sbatch_scripts/20210518_olur_fastp_bgi.sh)\n\n```shell\n#!/bin/bash\n#SBATCH --job-name=20210518_olur_fastp_bgi\n## Allocation Definition\n#SBATCH --account=coenv\n#SBATCH --partition=coenv\n## Resources\n## Nodes\n#SBATCH --nodes=1\n## Walltime (days-hours:minutes:seconds format)\n#SBATCH --time=10-00:00:00\n## Memory per node\n#SBATCH --mem=120G\n##turn on e-mail notification\n#SBATCH --mail-type=ALL\n#SBATCH --mail-user=samwhite@uw.edu\n## Specify the working directory for this job\n#SBATCH --chdir=/gscratch/scrubbed/samwhite/outputs/20210518_olur_fastp_bgi\n\n\n### Fastp 10x Genomics data used for P.generosa genome assembly by Phase Genomics.\n### In preparation for use in BlobToolKit\n\n### Expects input filenames to be in format: *.fastq.gz\n\n\n###################################################################################\n# These variables need to be set by user\n\n## Assign Variables\n\n# Set number of CPUs to use\nthreads=40\n\n# Input/output files\ntrimmed_checksums=trimmed_fastq_checksums.md5\nraw_reads_dir=/gscratch/srlab/sam/data/O_lurida/DNAseq\nfastq_checksums=raw_fastq_checksums.md5\n\n# Paths to programs\nfastp=/gscratch/srlab/programs/fastp-0.20.0/fastp\nmultiqc=/gscratch/srlab/programs/anaconda3/bin/multiqc\n\n## Inititalize arrays\nfastq_array_R1=()\nfastq_array_R2=()\n\n\n# Programs associative array\ndeclare -A programs_array\nprograms_array=(\n[fastp]=\"${fastp}\" \\\n[multiqc]=\"${multiqc}\"\n)\n\n\n###################################################################################\n\n# Exit script if any command fails\nset -e\n\n# Load Python Mox module for Python module availability\nmodule load intel-python3_2017\n\n# Capture date\ntimestamp=$(date +%Y%m%d)\n\n# Sync raw FastQ files to working directory\nrsync --archive --verbose \\\n\"${raw_reads_dir}\"/1*.fq.gz .\n\n# Create arrays of fastq R1 files and sample names\nfor fastq in 1*_1*.fq.gz\ndo\n  fastq_array_R1+=(\"${fastq}\")\ndone\n\n# Create array of fastq R2 files\nfor fastq in 1*_2*.fq.gz\ndo\n  fastq_array_R2+=(\"${fastq}\")\ndone\n\n\n# Run fastp on files\n# Trim 10bp from 5' from each read\n# Adds JSON report output for downstream usage by MultiQC\nfor index in \"${!fastq_array_R1[@]}\"\ndo\n  # Remove .fastq.gz from end of file names\n  R1_sample_name=$(echo \"${fastq_array_R1[index]}\" | sed 's/.fq.gz//')\n  R2_sample_name=$(echo \"${fastq_array_R2[index]}\" | sed 's/.fq.gz//')\n\n  # Get sample name without R1/R2 labels\n  sample_name=$(echo \"${fastq_array_R1[index]}\" | sed 's/_[12].*//')\n\n  echo \"\"\n  echo \"fastp started on ${sample_name} FastQs.\"\n\n  # Run fastp\n  # Specifies reports in HTML and JSON formats\n  ${fastp} \\\n  --in1 ${fastq_array_R1[index]} \\\n  --in2 ${fastq_array_R2[index]} \\\n  --detect_adapter_for_pe \\\n  --thread ${threads} \\\n  --html \"${sample_name}\".fastp-trim.\"${timestamp}\".report.html \\\n  --json \"${sample_name}\".fastp-trim.\"${timestamp}\".report.json \\\n  --out1 \"${R1_sample_name}\".fastp-trim.\"${timestamp}\".fq.gz \\\n  --out2 \"${R2_sample_name}\".fastp-trim.\"${timestamp}\".fq.gz\n\n  echo \"fastp completed on ${sample_name} FastQs\"\n  echo \"\"\n\n  # Generate md5 checksums for newly trimmed files\n  {\n  md5sum \"${R1_sample_name}\".fastp-trim.\"${timestamp}\".fq.gz\n  md5sum \"${R2_sample_name}\".fastp-trim.\"${timestamp}\".fq.gz\n  } >> \"${trimmed_checksums}\"\n\n\n  # Create MD5 checksum for reference\n  {\n    md5sum \"${fastq_array_R1[index]}\"\n    md5sum \"${fastq_array_R2[index]}\"\n  }  >> ${fastq_checksums}\n\n  # Remove original FastQ files\n  rm \"${fastq_array_R1[index]}\" \"${fastq_array_R2[index]}\"\ndone\n\n# Run MultiQC\n${programs_array[multiqc]} .\n\n###################################################################################\n\n# Capture program options\necho \"Logging program options...\"\nfor program in \"${!programs_array[@]}\"\ndo\n\t{\n  echo \"Program options for ${program}: \"\n\techo \"\"\n  # Handle samtools help menus\n  if [[ \"${program}\" == \"samtools_index\" ]] \\\n  || [[ \"${program}\" == \"samtools_sort\" ]] \\\n  || [[ \"${program}\" == \"samtools_view\" ]]\n  then\n    ${programs_array[$program]}\n\n  # Handle DIAMOND BLAST menu\n  elif [[ \"${program}\" == \"diamond\" ]]; then\n    ${programs_array[$program]} help\n\n  # Handle NCBI BLASTx menu\n  elif [[ \"${program}\" == \"blastx\" ]]; then\n    ${programs_array[$program]} -help\n  fi\n\t${programs_array[$program]} -h\n\techo \"\"\n\techo \"\"\n\techo \"----------------------------------------------\"\n\techo \"\"\n\techo \"\"\n} &>> program_options.log || true\n\n  # If MultiQC is in programs_array, copy the config file to this directory.\n  if [[ \"${program}\" == \"multiqc\" ]]; then\n  \tcp --preserve ~/.multiqc_config.yaml multiqc_config.yaml\n  fi\ndone\n\n# Document programs in PATH (primarily for program version ID)\n{\n  date\n  echo \"\"\n  echo \"System PATH for $SLURM_JOB_ID\"\n  echo \"\"\n  printf \"%0.s-\" {1..10}\n  echo \"${PATH}\" | tr : \\\\n\n} >> system_path.log\n\necho \"Finished logging system PATH\"\n```\n\n\n---\n\n# RESULTS\n\nNo runtime for this, as UW email system was down.\n\nNext up, use the hybrid assembler [wengan](https://github.com/adigenova/wengan) to generate a new assembly!\n\nOutput folder:\n\n- [20210518_olur_fastp_bgi/](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/)\n\n#### HTML Reports\n\n- [`MultiQC`](https://multiqc.info/) Report:\n\n  - [multiqc_report.html](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/multiqc_report.html)\n\n- [`fastp`](https://github.com/OpenGene/fastp) Reports:\n\n  - [151114_I191_FCH3Y35BCXX_L1_wHAIPI023992-37.fastp-trim.20210518.report.html](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/151114_I191_FCH3Y35BCXX_L1_wHAIPI023992-37.fastp-trim.20210518.report.html)\n\n  - [151114_I191_FCH3Y35BCXX_L2_wHAMPI023991-66.fastp-trim.20210518.report.html](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/151114_I191_FCH3Y35BCXX_L2_wHAMPI023991-66.fastp-trim.20210518.report.html)\n\n  - [151118_I137_FCH3KNJBBXX_L5_wHAXPI023905-96.fastp-trim.20210518.report.html](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/151118_I137_FCH3KNJBBXX_L5_wHAXPI023905-96.fastp-trim.20210518.report.html)\n\n  - [160103_I137_FCH3V5YBBXX_L3_WHOSTibkDCABDLAAPEI-62.fastp-trim.20210518.report.html](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L3_WHOSTibkDCABDLAAPEI-62.fastp-trim.20210518.report.html)\n\n  - [160103_I137_FCH3V5YBBXX_L3_WHOSTibkDCACDTAAPEI-75.fastp-trim.20210518.report.html](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L3_WHOSTibkDCACDTAAPEI-75.fastp-trim.20210518.report.html)\n\n  - [160103_I137_FCH3V5YBBXX_L4_WHOSTibkDCABDLAAPEI-62.fastp-trim.20210518.report.html](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L4_WHOSTibkDCABDLAAPEI-62.fastp-trim.20210518.report.html)\n\n  - [160103_I137_FCH3V5YBBXX_L4_WHOSTibkDCACDTAAPEI-75.fastp-trim.20210518.report.html](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L4_WHOSTibkDCACDTAAPEI-75.fastp-trim.20210518.report.html)\n\n  - [160103_I137_FCH3V5YBBXX_L5_WHOSTibkDCAADWAAPEI-74.fastp-trim.20210518.report.html](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L5_WHOSTibkDCAADWAAPEI-74.fastp-trim.20210518.report.html)\n\n  - [160103_I137_FCH3V5YBBXX_L6_WHOSTibkDCAADWAAPEI-74.fastp-trim.20210518.report.html](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L6_WHOSTibkDCAADWAAPEI-74.fastp-trim.20210518.report.html)\n\n#### Trimmed FastQs\n\n- [151114_I191_FCH3Y35BCXX_L1_wHAIPI023992-37_1.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/151114_I191_FCH3Y35BCXX_L1_wHAIPI023992-37_1.fastp-trim.20210518.fq.gz) (6.9G)\n\n  - MD5: `b59cfc6267f1ab18d46363de4c8478ca`\n\n- [151114_I191_FCH3Y35BCXX_L1_wHAIPI023992-37_2.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/151114_I191_FCH3Y35BCXX_L1_wHAIPI023992-37_2.fastp-trim.20210518.fq.gz) (7.2G)\n\n  - MD5: `5622f0ba614b2fd243b9fb3361c632ff`\n\n- [151114_I191_FCH3Y35BCXX_L2_wHAMPI023991-66_1.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/151114_I191_FCH3Y35BCXX_L2_wHAMPI023991-66_1.fastp-trim.20210518.fq.gz) (6.8G)\n\n  - MD5: `b5ca846f985d4371320fb880cdb2aefe`\n\n- [151114_I191_FCH3Y35BCXX_L2_wHAMPI023991-66_2.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/151114_I191_FCH3Y35BCXX_L2_wHAMPI023991-66_2.fastp-trim.20210518.fq.gz) (7.1G)\n\n  - MD5: `21bd1320eaa436849b3ba8d2bde1a91f`\n\n- [151118_I137_FCH3KNJBBXX_L5_wHAXPI023905-96_1.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/151118_I137_FCH3KNJBBXX_L5_wHAXPI023905-96_1.fastp-trim.20210518.fq.gz) (4.0G)\n\n  - MD5: `3e7e27d331c6cb7a131f07e0190a9906`\n\n- [151118_I137_FCH3KNJBBXX_L5_wHAXPI023905-96_2.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/151118_I137_FCH3KNJBBXX_L5_wHAXPI023905-96_2.fastp-trim.20210518.fq.gz) (4.2G)\n\n  - MD5: `7a0b51fb7cc94948fe65f0e9779fde9f`\n\n- [160103_I137_FCH3V5YBBXX_L3_WHOSTibkDCABDLAAPEI-62_1.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L3_WHOSTibkDCABDLAAPEI-62_1.fastp-trim.20210518.fq.gz) (2.7G)\n\n  - MD5: `9041d909cc4650677273fe313d923e9f`\n\n- [160103_I137_FCH3V5YBBXX_L3_WHOSTibkDCABDLAAPEI-62_2.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L3_WHOSTibkDCABDLAAPEI-62_2.fastp-trim.20210518.fq.gz) (3.0G)\n\n  - MD5: `c44165a404f9d2eab99d352d34918ebb`\n\n- [160103_I137_FCH3V5YBBXX_L3_WHOSTibkDCACDTAAPEI-75_1.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L3_WHOSTibkDCACDTAAPEI-75_1.fastp-trim.20210518.fq.gz) (1.4G)\n\n  - MD5: `6e2070b91d3872817ffe1600f8098cc7`\n\n- [160103_I137_FCH3V5YBBXX_L3_WHOSTibkDCACDTAAPEI-75_2.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L3_WHOSTibkDCACDTAAPEI-75_2.fastp-trim.20210518.fq.gz) (1.6G)\n\n  - MD5: `8acc523663ceebb40c793c21a29554f9`\n\n- [160103_I137_FCH3V5YBBXX_L4_WHOSTibkDCABDLAAPEI-62_1.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L4_WHOSTibkDCABDLAAPEI-62_1.fastp-trim.20210518.fq.gz) (2.7G)\n\n  - MD5: `65c924c07b3a67fcf73cf2dfbfb5385c`\n\n- [160103_I137_FCH3V5YBBXX_L4_WHOSTibkDCABDLAAPEI-62_2.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L4_WHOSTibkDCABDLAAPEI-62_2.fastp-trim.20210518.fq.gz) (3.0G)\n\n  - MD5: `83a8d688bb2ed8b1f2b20a409894f291`\n\n- [160103_I137_FCH3V5YBBXX_L4_WHOSTibkDCACDTAAPEI-75_1.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L4_WHOSTibkDCACDTAAPEI-75_1.fastp-trim.20210518.fq.gz) (1.4G)\n\n  - MD5: `aa21c7a4661f9a609d48f0c1838a4227`\n\n- [160103_I137_FCH3V5YBBXX_L4_WHOSTibkDCACDTAAPEI-75_2.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L4_WHOSTibkDCACDTAAPEI-75_2.fastp-trim.20210518.fq.gz) (1.6G)\n\n  - MD5: `7378a4889fe9387731a4763fef89dcbd`\n\n- [160103_I137_FCH3V5YBBXX_L5_WHOSTibkDCAADWAAPEI-74_1.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L5_WHOSTibkDCAADWAAPEI-74_1.fastp-trim.20210518.fq.gz) (3.0G)\n\n  - MD5: `cac2ae3705c0ee9050803eb33b7c2c2f`\n\n- [160103_I137_FCH3V5YBBXX_L5_WHOSTibkDCAADWAAPEI-74_2.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L5_WHOSTibkDCAADWAAPEI-74_2.fastp-trim.20210518.fq.gz) (3.3G)\n\n  - MD5: `4604149dad5455d2700a5026ea53e275`\n\n- [160103_I137_FCH3V5YBBXX_L6_WHOSTibkDCAADWAAPEI-74_1.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L6_WHOSTibkDCAADWAAPEI-74_1.fastp-trim.20210518.fq.gz) (2.8G)\n\n  - MD5: `544761c0318393021b1f45eb00bfcf3b`\n\n- [160103_I137_FCH3V5YBBXX_L6_WHOSTibkDCAADWAAPEI-74_2.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L6_WHOSTibkDCAADWAAPEI-74_2.fastp-trim.20210518.fq.gz) (3.2G)\n\n  - MD5: `349d7a9d5e250ddbd89f159485b5c904`\n","srcMarkdownNoYaml":"\n[After attempting to submit our _Ostrea lurida_ (Olympia oyster) genome assembly annotations (via GFF) to NCBI](../2021-05-13-Genome-Submission---Validation-of-Olurida_v081.fa-and-Annotated-GFFs-Prior-to-Submission-to-NCBI/index.qmd), the submission process also highlighted some short comings of the `Olurida_v081` assembly. When getting ready to submit the genome annotations to NCBI, I was required to calculate the genome coverage we had. NCBI suggested to calculate this simply by counting the number of bases sequenced and divide it by the genome size. Doing this resulted in an estimated coverage of ~55X coverage, yet we have significant stretches of Ns throughout the assembly. I understand why this is still technically possible, but it's just sticking in my craw. So, I've decided to set up a quick assembly to see what I can come up with. Of note, the [canonical assembly we've been using relied on the scaffolded assembly provided by BGI](../../2017/2017-11-30-genome-assembly-olympia-oyster-illumina-pacbio-using-pb-jelly-wbgi-scaffold-assembly-2/index.qmd); we never attempted our own assembly from the raw data.\n\nTo start, I needed to trim the data. I ran the BGI Illumina sequencing data through [`fastp`](https://github.com/OpenGene/fastp) on Mox.\n\nSBATCH script (GitHub):\n\n- [0210518_olur_fastp_bgi.sh](https://github.com/RobertsLab/sams-notebook/blob/master/sbatch_scripts/20210518_olur_fastp_bgi.sh)\n\n```shell\n#!/bin/bash\n## Job Name\n#SBATCH --job-name=20210518_olur_fastp_bgi\n## Allocation Definition\n#SBATCH --account=coenv\n#SBATCH --partition=coenv\n## Resources\n## Nodes\n#SBATCH --nodes=1\n## Walltime (days-hours:minutes:seconds format)\n#SBATCH --time=10-00:00:00\n## Memory per node\n#SBATCH --mem=120G\n##turn on e-mail notification\n#SBATCH --mail-type=ALL\n#SBATCH --mail-user=samwhite@uw.edu\n## Specify the working directory for this job\n#SBATCH --chdir=/gscratch/scrubbed/samwhite/outputs/20210518_olur_fastp_bgi\n\n\n### Fastp 10x Genomics data used for P.generosa genome assembly by Phase Genomics.\n### In preparation for use in BlobToolKit\n\n### Expects input filenames to be in format: *.fastq.gz\n\n\n###################################################################################\n# These variables need to be set by user\n\n## Assign Variables\n\n# Set number of CPUs to use\nthreads=40\n\n# Input/output files\ntrimmed_checksums=trimmed_fastq_checksums.md5\nraw_reads_dir=/gscratch/srlab/sam/data/O_lurida/DNAseq\nfastq_checksums=raw_fastq_checksums.md5\n\n# Paths to programs\nfastp=/gscratch/srlab/programs/fastp-0.20.0/fastp\nmultiqc=/gscratch/srlab/programs/anaconda3/bin/multiqc\n\n## Inititalize arrays\nfastq_array_R1=()\nfastq_array_R2=()\n\n\n# Programs associative array\ndeclare -A programs_array\nprograms_array=(\n[fastp]=\"${fastp}\" \\\n[multiqc]=\"${multiqc}\"\n)\n\n\n###################################################################################\n\n# Exit script if any command fails\nset -e\n\n# Load Python Mox module for Python module availability\nmodule load intel-python3_2017\n\n# Capture date\ntimestamp=$(date +%Y%m%d)\n\n# Sync raw FastQ files to working directory\nrsync --archive --verbose \\\n\"${raw_reads_dir}\"/1*.fq.gz .\n\n# Create arrays of fastq R1 files and sample names\nfor fastq in 1*_1*.fq.gz\ndo\n  fastq_array_R1+=(\"${fastq}\")\ndone\n\n# Create array of fastq R2 files\nfor fastq in 1*_2*.fq.gz\ndo\n  fastq_array_R2+=(\"${fastq}\")\ndone\n\n\n# Run fastp on files\n# Trim 10bp from 5' from each read\n# Adds JSON report output for downstream usage by MultiQC\nfor index in \"${!fastq_array_R1[@]}\"\ndo\n  # Remove .fastq.gz from end of file names\n  R1_sample_name=$(echo \"${fastq_array_R1[index]}\" | sed 's/.fq.gz//')\n  R2_sample_name=$(echo \"${fastq_array_R2[index]}\" | sed 's/.fq.gz//')\n\n  # Get sample name without R1/R2 labels\n  sample_name=$(echo \"${fastq_array_R1[index]}\" | sed 's/_[12].*//')\n\n  echo \"\"\n  echo \"fastp started on ${sample_name} FastQs.\"\n\n  # Run fastp\n  # Specifies reports in HTML and JSON formats\n  ${fastp} \\\n  --in1 ${fastq_array_R1[index]} \\\n  --in2 ${fastq_array_R2[index]} \\\n  --detect_adapter_for_pe \\\n  --thread ${threads} \\\n  --html \"${sample_name}\".fastp-trim.\"${timestamp}\".report.html \\\n  --json \"${sample_name}\".fastp-trim.\"${timestamp}\".report.json \\\n  --out1 \"${R1_sample_name}\".fastp-trim.\"${timestamp}\".fq.gz \\\n  --out2 \"${R2_sample_name}\".fastp-trim.\"${timestamp}\".fq.gz\n\n  echo \"fastp completed on ${sample_name} FastQs\"\n  echo \"\"\n\n  # Generate md5 checksums for newly trimmed files\n  {\n  md5sum \"${R1_sample_name}\".fastp-trim.\"${timestamp}\".fq.gz\n  md5sum \"${R2_sample_name}\".fastp-trim.\"${timestamp}\".fq.gz\n  } >> \"${trimmed_checksums}\"\n\n\n  # Create MD5 checksum for reference\n  {\n    md5sum \"${fastq_array_R1[index]}\"\n    md5sum \"${fastq_array_R2[index]}\"\n  }  >> ${fastq_checksums}\n\n  # Remove original FastQ files\n  rm \"${fastq_array_R1[index]}\" \"${fastq_array_R2[index]}\"\ndone\n\n# Run MultiQC\n${programs_array[multiqc]} .\n\n###################################################################################\n\n# Capture program options\necho \"Logging program options...\"\nfor program in \"${!programs_array[@]}\"\ndo\n\t{\n  echo \"Program options for ${program}: \"\n\techo \"\"\n  # Handle samtools help menus\n  if [[ \"${program}\" == \"samtools_index\" ]] \\\n  || [[ \"${program}\" == \"samtools_sort\" ]] \\\n  || [[ \"${program}\" == \"samtools_view\" ]]\n  then\n    ${programs_array[$program]}\n\n  # Handle DIAMOND BLAST menu\n  elif [[ \"${program}\" == \"diamond\" ]]; then\n    ${programs_array[$program]} help\n\n  # Handle NCBI BLASTx menu\n  elif [[ \"${program}\" == \"blastx\" ]]; then\n    ${programs_array[$program]} -help\n  fi\n\t${programs_array[$program]} -h\n\techo \"\"\n\techo \"\"\n\techo \"----------------------------------------------\"\n\techo \"\"\n\techo \"\"\n} &>> program_options.log || true\n\n  # If MultiQC is in programs_array, copy the config file to this directory.\n  if [[ \"${program}\" == \"multiqc\" ]]; then\n  \tcp --preserve ~/.multiqc_config.yaml multiqc_config.yaml\n  fi\ndone\n\n# Document programs in PATH (primarily for program version ID)\n{\n  date\n  echo \"\"\n  echo \"System PATH for $SLURM_JOB_ID\"\n  echo \"\"\n  printf \"%0.s-\" {1..10}\n  echo \"${PATH}\" | tr : \\\\n\n} >> system_path.log\n\necho \"Finished logging system PATH\"\n```\n\n\n---\n\n# RESULTS\n\nNo runtime for this, as UW email system was down.\n\nNext up, use the hybrid assembler [wengan](https://github.com/adigenova/wengan) to generate a new assembly!\n\nOutput folder:\n\n- [20210518_olur_fastp_bgi/](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/)\n\n#### HTML Reports\n\n- [`MultiQC`](https://multiqc.info/) Report:\n\n  - [multiqc_report.html](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/multiqc_report.html)\n\n- [`fastp`](https://github.com/OpenGene/fastp) Reports:\n\n  - [151114_I191_FCH3Y35BCXX_L1_wHAIPI023992-37.fastp-trim.20210518.report.html](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/151114_I191_FCH3Y35BCXX_L1_wHAIPI023992-37.fastp-trim.20210518.report.html)\n\n  - [151114_I191_FCH3Y35BCXX_L2_wHAMPI023991-66.fastp-trim.20210518.report.html](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/151114_I191_FCH3Y35BCXX_L2_wHAMPI023991-66.fastp-trim.20210518.report.html)\n\n  - [151118_I137_FCH3KNJBBXX_L5_wHAXPI023905-96.fastp-trim.20210518.report.html](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/151118_I137_FCH3KNJBBXX_L5_wHAXPI023905-96.fastp-trim.20210518.report.html)\n\n  - [160103_I137_FCH3V5YBBXX_L3_WHOSTibkDCABDLAAPEI-62.fastp-trim.20210518.report.html](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L3_WHOSTibkDCABDLAAPEI-62.fastp-trim.20210518.report.html)\n\n  - [160103_I137_FCH3V5YBBXX_L3_WHOSTibkDCACDTAAPEI-75.fastp-trim.20210518.report.html](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L3_WHOSTibkDCACDTAAPEI-75.fastp-trim.20210518.report.html)\n\n  - [160103_I137_FCH3V5YBBXX_L4_WHOSTibkDCABDLAAPEI-62.fastp-trim.20210518.report.html](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L4_WHOSTibkDCABDLAAPEI-62.fastp-trim.20210518.report.html)\n\n  - [160103_I137_FCH3V5YBBXX_L4_WHOSTibkDCACDTAAPEI-75.fastp-trim.20210518.report.html](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L4_WHOSTibkDCACDTAAPEI-75.fastp-trim.20210518.report.html)\n\n  - [160103_I137_FCH3V5YBBXX_L5_WHOSTibkDCAADWAAPEI-74.fastp-trim.20210518.report.html](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L5_WHOSTibkDCAADWAAPEI-74.fastp-trim.20210518.report.html)\n\n  - [160103_I137_FCH3V5YBBXX_L6_WHOSTibkDCAADWAAPEI-74.fastp-trim.20210518.report.html](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L6_WHOSTibkDCAADWAAPEI-74.fastp-trim.20210518.report.html)\n\n#### Trimmed FastQs\n\n- [151114_I191_FCH3Y35BCXX_L1_wHAIPI023992-37_1.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/151114_I191_FCH3Y35BCXX_L1_wHAIPI023992-37_1.fastp-trim.20210518.fq.gz) (6.9G)\n\n  - MD5: `b59cfc6267f1ab18d46363de4c8478ca`\n\n- [151114_I191_FCH3Y35BCXX_L1_wHAIPI023992-37_2.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/151114_I191_FCH3Y35BCXX_L1_wHAIPI023992-37_2.fastp-trim.20210518.fq.gz) (7.2G)\n\n  - MD5: `5622f0ba614b2fd243b9fb3361c632ff`\n\n- [151114_I191_FCH3Y35BCXX_L2_wHAMPI023991-66_1.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/151114_I191_FCH3Y35BCXX_L2_wHAMPI023991-66_1.fastp-trim.20210518.fq.gz) (6.8G)\n\n  - MD5: `b5ca846f985d4371320fb880cdb2aefe`\n\n- [151114_I191_FCH3Y35BCXX_L2_wHAMPI023991-66_2.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/151114_I191_FCH3Y35BCXX_L2_wHAMPI023991-66_2.fastp-trim.20210518.fq.gz) (7.1G)\n\n  - MD5: `21bd1320eaa436849b3ba8d2bde1a91f`\n\n- [151118_I137_FCH3KNJBBXX_L5_wHAXPI023905-96_1.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/151118_I137_FCH3KNJBBXX_L5_wHAXPI023905-96_1.fastp-trim.20210518.fq.gz) (4.0G)\n\n  - MD5: `3e7e27d331c6cb7a131f07e0190a9906`\n\n- [151118_I137_FCH3KNJBBXX_L5_wHAXPI023905-96_2.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/151118_I137_FCH3KNJBBXX_L5_wHAXPI023905-96_2.fastp-trim.20210518.fq.gz) (4.2G)\n\n  - MD5: `7a0b51fb7cc94948fe65f0e9779fde9f`\n\n- [160103_I137_FCH3V5YBBXX_L3_WHOSTibkDCABDLAAPEI-62_1.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L3_WHOSTibkDCABDLAAPEI-62_1.fastp-trim.20210518.fq.gz) (2.7G)\n\n  - MD5: `9041d909cc4650677273fe313d923e9f`\n\n- [160103_I137_FCH3V5YBBXX_L3_WHOSTibkDCABDLAAPEI-62_2.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L3_WHOSTibkDCABDLAAPEI-62_2.fastp-trim.20210518.fq.gz) (3.0G)\n\n  - MD5: `c44165a404f9d2eab99d352d34918ebb`\n\n- [160103_I137_FCH3V5YBBXX_L3_WHOSTibkDCACDTAAPEI-75_1.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L3_WHOSTibkDCACDTAAPEI-75_1.fastp-trim.20210518.fq.gz) (1.4G)\n\n  - MD5: `6e2070b91d3872817ffe1600f8098cc7`\n\n- [160103_I137_FCH3V5YBBXX_L3_WHOSTibkDCACDTAAPEI-75_2.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L3_WHOSTibkDCACDTAAPEI-75_2.fastp-trim.20210518.fq.gz) (1.6G)\n\n  - MD5: `8acc523663ceebb40c793c21a29554f9`\n\n- [160103_I137_FCH3V5YBBXX_L4_WHOSTibkDCABDLAAPEI-62_1.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L4_WHOSTibkDCABDLAAPEI-62_1.fastp-trim.20210518.fq.gz) (2.7G)\n\n  - MD5: `65c924c07b3a67fcf73cf2dfbfb5385c`\n\n- [160103_I137_FCH3V5YBBXX_L4_WHOSTibkDCABDLAAPEI-62_2.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L4_WHOSTibkDCABDLAAPEI-62_2.fastp-trim.20210518.fq.gz) (3.0G)\n\n  - MD5: `83a8d688bb2ed8b1f2b20a409894f291`\n\n- [160103_I137_FCH3V5YBBXX_L4_WHOSTibkDCACDTAAPEI-75_1.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L4_WHOSTibkDCACDTAAPEI-75_1.fastp-trim.20210518.fq.gz) (1.4G)\n\n  - MD5: `aa21c7a4661f9a609d48f0c1838a4227`\n\n- [160103_I137_FCH3V5YBBXX_L4_WHOSTibkDCACDTAAPEI-75_2.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L4_WHOSTibkDCACDTAAPEI-75_2.fastp-trim.20210518.fq.gz) (1.6G)\n\n  - MD5: `7378a4889fe9387731a4763fef89dcbd`\n\n- [160103_I137_FCH3V5YBBXX_L5_WHOSTibkDCAADWAAPEI-74_1.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L5_WHOSTibkDCAADWAAPEI-74_1.fastp-trim.20210518.fq.gz) (3.0G)\n\n  - MD5: `cac2ae3705c0ee9050803eb33b7c2c2f`\n\n- [160103_I137_FCH3V5YBBXX_L5_WHOSTibkDCAADWAAPEI-74_2.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L5_WHOSTibkDCAADWAAPEI-74_2.fastp-trim.20210518.fq.gz) (3.3G)\n\n  - MD5: `4604149dad5455d2700a5026ea53e275`\n\n- [160103_I137_FCH3V5YBBXX_L6_WHOSTibkDCAADWAAPEI-74_1.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L6_WHOSTibkDCAADWAAPEI-74_1.fastp-trim.20210518.fq.gz) (2.8G)\n\n  - MD5: `544761c0318393021b1f45eb00bfcf3b`\n\n- [160103_I137_FCH3V5YBBXX_L6_WHOSTibkDCAADWAAPEI-74_2.fastp-trim.20210518.fq.gz](https://gannet.fish.washington.edu/Atumefaciens/20210518_olur_fastp_bgi/160103_I137_FCH3V5YBBXX_L6_WHOSTibkDCAADWAAPEI-74_2.fastp-trim.20210518.fq.gz) (3.2G)\n\n  - MD5: `349d7a9d5e250ddbd89f159485b5c904`\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../../styles.css"],"toc":true,"toc-depth":5,"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","editor":"source","theme":"darkly","page-layout":"full","code-background":true,"code-copy":true,"title-block-banner":true,"author":"Sam White","toc-title":"Contents","toc-location":"left","layout":"post","title":"Trimming - O.lurida BGI FastQs with FastP on Mox","date":"2021-05-18 10:48","categories":["fastp","mox","Ostrea lurida","Olympia oyster","trimming","2021","Olympia Oyster Genome Sequencing"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}