{"title":"Genome Submission - Validation of Olurida_v081.fa and Annotated GFFs Prior to Submission to NCBI","markdown":{"yaml":{"author":"Sam White","toc-title":"Contents","toc-depth":5,"toc-location":"left","layout":"post","title":"Genome Submission - Validation of Olurida_v081.fa and Annotated GFFs Prior to Submission to NCBI","date":"2021-05-13 13:34","tags":["NCBI","Ostrea lurida","Olympia oyster","jupyter notebook"],"categories":["2021","Olympia Oyster Genome Assembly"]},"headingText":"RESULTS","containsRefs":false,"markdown":"\n[Per this GitHub Issue](https://github.com/RobertsLab/resources/issues/1159), Steven has asked to get our [_Ostrea lurida_ (Olympia oyster)](http://en.wikipedia.org/wiki/Pacific_oyster) genome assembly (`Olurida_v081.fa`) submitted to NCBI with annotations. The first step in the submission process is to use the NCBI `table2asn_GFF` software to validate the FastA assembly, as well as the GFF annotations file. Once the software has been run, it will point out any errors which need to be corrected prior to submission.\n\nThe validation was run on my local computer in the following Jupyter Notebook:\n\n\nJupyter Notebook (GitHub):\n\n- [20210513_olur_NCBI_genome-submission-prep.ipynb](https://github.com/RobertsLab/code/blob/master/notebooks/sam/20210513_olur_NCBI_genome-submission-prep.ipynb)\n\nJupyter Notebook (NBviewer):\n\n- [20210513_olur_NCBI_genome-submission-prep.ipynb](https://nbviewer.jupyter.org/github/RobertsLab/code/blob/master/notebooks/sam/20210513_olur_NCBI_genome-submission-prep.ipynb)\n\n\n<iframe src=\"https://nbviewer.jupyter.org/github/RobertsLab/code/blob/master/notebooks/sam/20210513_olur_NCBI_genome-submission-prep.ipynb\" width=\"100%\" height=\"2000\" scrolling=\"yes\"></iframe>\n\n\n---\n\n\nOutput folder:\n\n- [20210513_olur_NCBI_genome-submission-prep/](https://gannet.fish.washington.edu/Atumefaciens/20210513_olur_NCBI_genome-submission-prep/)\n\n  - Discrepancy Report (text; 46MB)\n\n    - [20210513_olur_NCBI_genome-submission-prep/20210513_Olurida-v081.dr](https://gannet.fish.washington.edu/Atumefaciens/20210513_olur_NCBI_genome-submission-prep/20210513_Olurida-v081.dr)\n\n \n\n  - Validation Report (text; 867B)\n\n    - [20210513_olur_NCBI_genome-submission-prep/20210513_Olurida-v081.stats](https://gannet.fish.washington.edu/Atumefaciens/20210513_olur_NCBI_genome-submission-prep/20210513_Olurida-v081.stats)\n\n\n\nAlrighty, let's take a look at the results.\n\n---\n\n### Discrepancy report:\n\n```\nDiscrepancy Report Results\n\nSummary\nCOUNT_NUCLEOTIDES: 159429 nucleotide Bioseqs are present\nLONG_NO_ANNOTATION: 46845 bioseqs are longer than 5000nt and have no features\nNO_ANNOTATION: 133211 bioseqs have no features\nGAPS: 114914 sequences contain gaps\nLOW_QUALITY_REGION: 809 sequences contain low quality region\nFEATURE_COUNT: CDS: 32210 present\nFEATURE_COUNT: gene: 32210 present\nFEATURE_COUNT: mRNA: 32210 present\nPROTEIN_NAMES: All proteins have same name \"hypothetical protein\"\nBAD_GENE_STRAND: 3 feature locations conflict with gene location strands\nFATAL: CONTAINED_CDS: 10 coding regions are completely contained in another coding region, but on the opposite strand.\nFEATURE_LOCATION_CONFLICT: 16978 features have inconsistent gene locations.\nFATAL: BACTERIAL_JOINED_FEATURES_NO_EXCEPTION: 29207 coding regions with joined locations have no exceptions\nSHORT_INTRON: 726 introns are shorter than 10 nt\nFEATURE_LIST: Feature List\n\nDetailed Report\n```\n\n[Here's the NCBI resource guide to the understanding the Discrepancy Report.](https://www.ncbi.nlm.nih.gov/genbank/asndisc/#evaluating_the_output) as well as a [guide to common errors](https://www.ncbi.nlm.nih.gov/genbank/new_asndisc_examples/).\n\nWe see that there are two lines beginning with `FATAL`, but they're actually not a big deal:\n\n- `FATAL: BACTERIAL_JOINED_FEATURES_NO_EXCEPTION`: This can be ignored, as it only applies to prokaryotes.\n\n- `FATAL: CONTAINED_CDS`: These will require inspection and confirmation that the annotations are indeed correct and/or fixed.\n\nHere are other problems which will need to be addressed:\n\n- `LOW_QUALITY_REGION`: Indicates stretches of N's. Will need to remove N's and replace with gap \"feature\".\n\n- `BAD_GENE_STRAND`: Not sure whether or not this is critical, as it's not documented in either of those links above. I'll have to contact NCBI regarding this.\n\n- `FEATURE_LOCATION_CONFLICT`: Not sure whether or not this is critical, as it's not documented in either of those links above. I'll have to contact NCBI regarding this.\n\n- `SHORT_INTRON`: Not sure whether or not this is critical, as it's not documented in either of those links above. I'll have to contact NCBI regarding this.\n\n---\n\n### Validation report\n\n```\nTotal messages:\t\t293302\n\n=================================================================\n35926 WARNING-level messages exist\n\nSEQ_INST.TerminalGap:\t2\nSEQ_INST.LeadingX:\t1\nSEQ_FEAT.NotSpliceConsensusDonor:\t12488\nSEQ_FEAT.NotSpliceConsensusAcceptor:\t10811\nSEQ_FEAT.IntervalBeginsOrEndsInGap:\t72\nSEQ_FEAT.ShortExon:\t1182\nSEQ_FEAT.PartialProblemNotSpliceConsensus3Prime:\t6154\nSEQ_FEAT.PartialProblemNotSpliceConsensus5Prime:\t5214\nSEQ_FEAT.PartialProblem5Prime:\t2\n\n=================================================================\n257376 ERROR-level messages exist\n\nSEQ_INST.ShortSeq:\t2\nSEQ_DESCR.BioSourceMissing:\t26218\nSEQ_DESCR.NoPubFound:\t1\nSEQ_DESCR.NoSourceDescriptor:\t1\nGENERIC.MissingPubRequirement:\t1\nSEQ_FEAT.IllegalDbXref:\t230426\nSEQ_FEAT.FeatureBeginsOrEndsInGap:\t1\nSEQ_FEAT.ShortIntron:\t726\n\n=================================================================\n```\n\n[Here's the NCBI guide to validation errors](https://www.ncbi.nlm.nih.gov/genbank/genome_validation/). All errors will need to be resolved prior to submission.\n\n- `SEQ_INST.ShortSeq`: This is not documented in the link above. I'll have to contact NCBI regarding this.\n\n- `SEQ_DESCR.BioSourceMissing`: \"Suggestion: Provide an organism name for each sequence in your submission.\" Not sure if this needs to be done in the FastA, GFF, or both. Or, maybe it needs to be supllied when running the `table2asn_GFF` command, using the `-j` option? Will investigate both files and see which sequences this crops up on, as well as a modified run of the `table2asn_GFF`.\n\n- `SEQ_DESCR.NoPubFound`: \"Suggestion: Include the template when you create the .sqn submission file. You can create a template here: https://submit.ncbi.nlm.nih.gov/genbank/template/submission/ .\" I'll create a template file.\n\n- `SEQ_DESCR.NoSourceDescriptor`: This is not documented in the link above. I'll have to contact NCBI regarding this. However, I have a sneaking suspicion that this is related to the need for a template file.\n\n- `GENERIC.MissingPubRequirement`: This is not documented in the link above. I'll have to contact NCBI regarding this. However, I have a sneaking suspicion that this is related to the need for a template file.\n\n- `SEQ_FEAT.IllegalDbXref`: This is not documented in the link above. I'll have to contact NCBI regarding this. However, it's likely due to incorrect formatting or invalid database cross reference, according to [this NCBI DbXref guide](https://www.ncbi.nlm.nih.gov/genbank/collab/db_xref/%20).\n\n- `SEQ_FEAT.FeatureBeginsOrEndsInGap`: This is not documented in the link above. I'll have to contact NCBI regarding this. However, it seems obvious that the problem is that a feature is beginning/ending in a stretch of N's. Will look at GFF to see what's happening.\n\n- `SEQ_FEAT.ShortIntron`: This is not documented in the link above. I'll have to contact NCBI regarding this. However, it's clear that some introns are considered too short. This was identified in the Discrepancy Report above, but the documentation for that suggests that this might not need to be corrected. But, documentation indicates that all errors in the validation need to be eliminated...\n","srcMarkdownNoYaml":"\n[Per this GitHub Issue](https://github.com/RobertsLab/resources/issues/1159), Steven has asked to get our [_Ostrea lurida_ (Olympia oyster)](http://en.wikipedia.org/wiki/Pacific_oyster) genome assembly (`Olurida_v081.fa`) submitted to NCBI with annotations. The first step in the submission process is to use the NCBI `table2asn_GFF` software to validate the FastA assembly, as well as the GFF annotations file. Once the software has been run, it will point out any errors which need to be corrected prior to submission.\n\nThe validation was run on my local computer in the following Jupyter Notebook:\n\n\nJupyter Notebook (GitHub):\n\n- [20210513_olur_NCBI_genome-submission-prep.ipynb](https://github.com/RobertsLab/code/blob/master/notebooks/sam/20210513_olur_NCBI_genome-submission-prep.ipynb)\n\nJupyter Notebook (NBviewer):\n\n- [20210513_olur_NCBI_genome-submission-prep.ipynb](https://nbviewer.jupyter.org/github/RobertsLab/code/blob/master/notebooks/sam/20210513_olur_NCBI_genome-submission-prep.ipynb)\n\n\n<iframe src=\"https://nbviewer.jupyter.org/github/RobertsLab/code/blob/master/notebooks/sam/20210513_olur_NCBI_genome-submission-prep.ipynb\" width=\"100%\" height=\"2000\" scrolling=\"yes\"></iframe>\n\n\n---\n\n# RESULTS\n\nOutput folder:\n\n- [20210513_olur_NCBI_genome-submission-prep/](https://gannet.fish.washington.edu/Atumefaciens/20210513_olur_NCBI_genome-submission-prep/)\n\n  - Discrepancy Report (text; 46MB)\n\n    - [20210513_olur_NCBI_genome-submission-prep/20210513_Olurida-v081.dr](https://gannet.fish.washington.edu/Atumefaciens/20210513_olur_NCBI_genome-submission-prep/20210513_Olurida-v081.dr)\n\n \n\n  - Validation Report (text; 867B)\n\n    - [20210513_olur_NCBI_genome-submission-prep/20210513_Olurida-v081.stats](https://gannet.fish.washington.edu/Atumefaciens/20210513_olur_NCBI_genome-submission-prep/20210513_Olurida-v081.stats)\n\n\n\nAlrighty, let's take a look at the results.\n\n---\n\n### Discrepancy report:\n\n```\nDiscrepancy Report Results\n\nSummary\nCOUNT_NUCLEOTIDES: 159429 nucleotide Bioseqs are present\nLONG_NO_ANNOTATION: 46845 bioseqs are longer than 5000nt and have no features\nNO_ANNOTATION: 133211 bioseqs have no features\nGAPS: 114914 sequences contain gaps\nLOW_QUALITY_REGION: 809 sequences contain low quality region\nFEATURE_COUNT: CDS: 32210 present\nFEATURE_COUNT: gene: 32210 present\nFEATURE_COUNT: mRNA: 32210 present\nPROTEIN_NAMES: All proteins have same name \"hypothetical protein\"\nBAD_GENE_STRAND: 3 feature locations conflict with gene location strands\nFATAL: CONTAINED_CDS: 10 coding regions are completely contained in another coding region, but on the opposite strand.\nFEATURE_LOCATION_CONFLICT: 16978 features have inconsistent gene locations.\nFATAL: BACTERIAL_JOINED_FEATURES_NO_EXCEPTION: 29207 coding regions with joined locations have no exceptions\nSHORT_INTRON: 726 introns are shorter than 10 nt\nFEATURE_LIST: Feature List\n\nDetailed Report\n```\n\n[Here's the NCBI resource guide to the understanding the Discrepancy Report.](https://www.ncbi.nlm.nih.gov/genbank/asndisc/#evaluating_the_output) as well as a [guide to common errors](https://www.ncbi.nlm.nih.gov/genbank/new_asndisc_examples/).\n\nWe see that there are two lines beginning with `FATAL`, but they're actually not a big deal:\n\n- `FATAL: BACTERIAL_JOINED_FEATURES_NO_EXCEPTION`: This can be ignored, as it only applies to prokaryotes.\n\n- `FATAL: CONTAINED_CDS`: These will require inspection and confirmation that the annotations are indeed correct and/or fixed.\n\nHere are other problems which will need to be addressed:\n\n- `LOW_QUALITY_REGION`: Indicates stretches of N's. Will need to remove N's and replace with gap \"feature\".\n\n- `BAD_GENE_STRAND`: Not sure whether or not this is critical, as it's not documented in either of those links above. I'll have to contact NCBI regarding this.\n\n- `FEATURE_LOCATION_CONFLICT`: Not sure whether or not this is critical, as it's not documented in either of those links above. I'll have to contact NCBI regarding this.\n\n- `SHORT_INTRON`: Not sure whether or not this is critical, as it's not documented in either of those links above. I'll have to contact NCBI regarding this.\n\n---\n\n### Validation report\n\n```\nTotal messages:\t\t293302\n\n=================================================================\n35926 WARNING-level messages exist\n\nSEQ_INST.TerminalGap:\t2\nSEQ_INST.LeadingX:\t1\nSEQ_FEAT.NotSpliceConsensusDonor:\t12488\nSEQ_FEAT.NotSpliceConsensusAcceptor:\t10811\nSEQ_FEAT.IntervalBeginsOrEndsInGap:\t72\nSEQ_FEAT.ShortExon:\t1182\nSEQ_FEAT.PartialProblemNotSpliceConsensus3Prime:\t6154\nSEQ_FEAT.PartialProblemNotSpliceConsensus5Prime:\t5214\nSEQ_FEAT.PartialProblem5Prime:\t2\n\n=================================================================\n257376 ERROR-level messages exist\n\nSEQ_INST.ShortSeq:\t2\nSEQ_DESCR.BioSourceMissing:\t26218\nSEQ_DESCR.NoPubFound:\t1\nSEQ_DESCR.NoSourceDescriptor:\t1\nGENERIC.MissingPubRequirement:\t1\nSEQ_FEAT.IllegalDbXref:\t230426\nSEQ_FEAT.FeatureBeginsOrEndsInGap:\t1\nSEQ_FEAT.ShortIntron:\t726\n\n=================================================================\n```\n\n[Here's the NCBI guide to validation errors](https://www.ncbi.nlm.nih.gov/genbank/genome_validation/). All errors will need to be resolved prior to submission.\n\n- `SEQ_INST.ShortSeq`: This is not documented in the link above. I'll have to contact NCBI regarding this.\n\n- `SEQ_DESCR.BioSourceMissing`: \"Suggestion: Provide an organism name for each sequence in your submission.\" Not sure if this needs to be done in the FastA, GFF, or both. Or, maybe it needs to be supllied when running the `table2asn_GFF` command, using the `-j` option? Will investigate both files and see which sequences this crops up on, as well as a modified run of the `table2asn_GFF`.\n\n- `SEQ_DESCR.NoPubFound`: \"Suggestion: Include the template when you create the .sqn submission file. You can create a template here: https://submit.ncbi.nlm.nih.gov/genbank/template/submission/ .\" I'll create a template file.\n\n- `SEQ_DESCR.NoSourceDescriptor`: This is not documented in the link above. I'll have to contact NCBI regarding this. However, I have a sneaking suspicion that this is related to the need for a template file.\n\n- `GENERIC.MissingPubRequirement`: This is not documented in the link above. I'll have to contact NCBI regarding this. However, I have a sneaking suspicion that this is related to the need for a template file.\n\n- `SEQ_FEAT.IllegalDbXref`: This is not documented in the link above. I'll have to contact NCBI regarding this. However, it's likely due to incorrect formatting or invalid database cross reference, according to [this NCBI DbXref guide](https://www.ncbi.nlm.nih.gov/genbank/collab/db_xref/%20).\n\n- `SEQ_FEAT.FeatureBeginsOrEndsInGap`: This is not documented in the link above. I'll have to contact NCBI regarding this. However, it seems obvious that the problem is that a feature is beginning/ending in a stretch of N's. Will look at GFF to see what's happening.\n\n- `SEQ_FEAT.ShortIntron`: This is not documented in the link above. I'll have to contact NCBI regarding this. However, it's clear that some introns are considered too short. This was identified in the Discrepancy Report above, but the documentation for that suggests that this might not need to be corrected. But, documentation indicates that all errors in the validation need to be eliminated...\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../../styles.css"],"toc":true,"toc-depth":5,"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","editor":"source","theme":"darkly","page-layout":"full","code-background":true,"code-copy":true,"title-block-banner":true,"author":"Sam White","toc-title":"Contents","toc-location":"left","layout":"post","title":"Genome Submission - Validation of Olurida_v081.fa and Annotated GFFs Prior to Submission to NCBI","date":"2021-05-13 13:34","tags":["NCBI","Ostrea lurida","Olympia oyster","jupyter notebook"],"categories":["2021","Olympia Oyster Genome Assembly"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}