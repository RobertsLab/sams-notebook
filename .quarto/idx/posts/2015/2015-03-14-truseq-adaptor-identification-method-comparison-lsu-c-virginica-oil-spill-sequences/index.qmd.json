{"title":"TruSeq Adaptor Identification Method Comparison - LSU C.virginica Oil Spill Sequences","markdown":{"yaml":{"author":"Sam White","toc-title":"Contents","toc-depth":5,"toc-location":"left","date":"2015-03-14 16:58:00+00:00","layout":"post","slug":"truseq-adaptor-identification-method-comparison-lsu-c-virginica-oil-spill-sequences","title":"TruSeq Adaptor Identification Method Comparison - LSU C.virginica Oil Spill Sequences","categories":["2015","LSU C.virginica Oil Spill MBD BS Sequencing","barcodes","Crassostrea virginica","Eastern oyster","FASTQ","FASTQC","fastx_barcode_splitter","grep","index sequences","ipython notebook","jupyter notebook","TruSeq"]},"headingText":"grep","containsRefs":false,"markdown":"\n\nWe recently received [Illumina HiSeq2500 data back from this project](../2015-02-09-sequencing-data-lsu-c-virginica-mbd-bs-seq/index.qmd). Initially looking at the data, something seems off.  Using FASTQC, the quality drops of drastically towards the last 20 bases of the reads. We also see a high degree of Illumina TruSeq adaptor/index sequences present in our data.\n\nSince this sequencing run was multiplexed (i.e. multiple libraries were pooled and run together on the HiSeq), we need to demultiplex our sequences before performing any trimming. Otherwise, the trimming could remove the index (barcodes) sequences from the data and prevent us from separating out the different libraries from each other.\n\nHowever, it turns out, demultiplexing is not a simple, straightforward task. There are a variety of programs available and they all have different options. I decided to compare TruSeq index identification using two programs:\n\n-grep (grep is a built-in command line (bash) program that searches through files to find matches to user-provided information.)\n-fastx_barcode_splitter.pl (fastx_barcode_splitter.pl is a component of the fastx_tookit that searches through FASTQ files to identify matches to user-provided index/barcode sequences.)\n\nThe advantage(s) of using grep is that it's extremely fast, easy to use, and already exists on most Unix-based computers (Linux, OS X), thus not requiring any software installation. The disadvantage(s) of using grep for a situation like this is that it is not amenable to allowing for mismatches and/or partial matches to the user-provided information.\n\nThe advantage(s) of using fastx_barcode_splitter.pl is that it can accept a user-defined number of mismatches and/or partial matches to the user-defined index/barcode sequences. The disadvantage(s) of using fastx_barcode_splitter.pl is that it requires the user to specify the expected location of the index/barcode sequence in the target sequence: either the beginning of the line or the end of the line. It will not search beyond the length(s) of the provided index/barcode sequences. That means if you index/barcode exists in the middle of your sequences, this program will not find it. Additionally, since this program doesn't exist natively on Unix-based machines, it must be downloaded and installed by the user.\n\nSo, I tested both of these programs to see how they compared at matching both long (the TruSeq adaptor/index sequences identified with FASTQC) and \"short\" (the actual 6bp index sequence) barcodes.\n\nTo simplify testing, only a single sequence file was used from the data set.\n\nAll analysis was done in a Jupyter (IPython) notebook.\n\n[NBViewer version of embedded notebook below](https://nbviewer.ipython.org/url/eagle.fish.washington.edu/Arabidopsis/iPythonNotebooks/20150313_LSU_Oil_Spill_IndexID_Comparisons.ipynb).\n\n<iframe src=\"https://nbviewer.ipython.org/url/eagle.fish.washington.edu/Arabidopsis/iPythonNotebooks/20150313_LSU_Oil_Spill_IndexID_Comparisons.ipynb\" width=\"100%\" height=\"1000\" scrolling=\"yes\"></iframe>\n\n\n\nResult:\n\n\n\n\n\n\nlong barcodes: Found in ~12% of all reads\n\nshort barcodes: Found in ~25% of all reads\n\n\n\n\n\n#### fastx_barcode_splitter\n\n\n\nlong barcodes, beginning of line: Found in ~15% of all reads\n\nlong barcodes, end of line: Found in < 0.008% of all reads (yes, that is actually percentage)\n\n\n\nshort barcodes, beginning of line: Found in ~1.3% of all reads\n\nshort barcodes, end of line: Found in ~2.7% of all reads\n\n\n\nOverall, the comparison is interesting, however, the important take home from this is that in the best-case scenario (grep, short barcodes), we're only able to identify 25% of the reads in our sequences!\n\nIt should also be noted that my analysis only used sequences in one orientation. It would be a good idea to also do this analysis by searching with the reverse and reverse complements of these sequences.\n","srcMarkdownNoYaml":"\n\nWe recently received [Illumina HiSeq2500 data back from this project](../2015-02-09-sequencing-data-lsu-c-virginica-mbd-bs-seq/index.qmd). Initially looking at the data, something seems off.  Using FASTQC, the quality drops of drastically towards the last 20 bases of the reads. We also see a high degree of Illumina TruSeq adaptor/index sequences present in our data.\n\nSince this sequencing run was multiplexed (i.e. multiple libraries were pooled and run together on the HiSeq), we need to demultiplex our sequences before performing any trimming. Otherwise, the trimming could remove the index (barcodes) sequences from the data and prevent us from separating out the different libraries from each other.\n\nHowever, it turns out, demultiplexing is not a simple, straightforward task. There are a variety of programs available and they all have different options. I decided to compare TruSeq index identification using two programs:\n\n-grep (grep is a built-in command line (bash) program that searches through files to find matches to user-provided information.)\n-fastx_barcode_splitter.pl (fastx_barcode_splitter.pl is a component of the fastx_tookit that searches through FASTQ files to identify matches to user-provided index/barcode sequences.)\n\nThe advantage(s) of using grep is that it's extremely fast, easy to use, and already exists on most Unix-based computers (Linux, OS X), thus not requiring any software installation. The disadvantage(s) of using grep for a situation like this is that it is not amenable to allowing for mismatches and/or partial matches to the user-provided information.\n\nThe advantage(s) of using fastx_barcode_splitter.pl is that it can accept a user-defined number of mismatches and/or partial matches to the user-defined index/barcode sequences. The disadvantage(s) of using fastx_barcode_splitter.pl is that it requires the user to specify the expected location of the index/barcode sequence in the target sequence: either the beginning of the line or the end of the line. It will not search beyond the length(s) of the provided index/barcode sequences. That means if you index/barcode exists in the middle of your sequences, this program will not find it. Additionally, since this program doesn't exist natively on Unix-based machines, it must be downloaded and installed by the user.\n\nSo, I tested both of these programs to see how they compared at matching both long (the TruSeq adaptor/index sequences identified with FASTQC) and \"short\" (the actual 6bp index sequence) barcodes.\n\nTo simplify testing, only a single sequence file was used from the data set.\n\nAll analysis was done in a Jupyter (IPython) notebook.\n\n[NBViewer version of embedded notebook below](https://nbviewer.ipython.org/url/eagle.fish.washington.edu/Arabidopsis/iPythonNotebooks/20150313_LSU_Oil_Spill_IndexID_Comparisons.ipynb).\n\n<iframe src=\"https://nbviewer.ipython.org/url/eagle.fish.washington.edu/Arabidopsis/iPythonNotebooks/20150313_LSU_Oil_Spill_IndexID_Comparisons.ipynb\" width=\"100%\" height=\"1000\" scrolling=\"yes\"></iframe>\n\n\n\nResult:\n\n\n\n#### grep\n\n\n\nlong barcodes: Found in ~12% of all reads\n\nshort barcodes: Found in ~25% of all reads\n\n\n\n\n\n#### fastx_barcode_splitter\n\n\n\nlong barcodes, beginning of line: Found in ~15% of all reads\n\nlong barcodes, end of line: Found in < 0.008% of all reads (yes, that is actually percentage)\n\n\n\nshort barcodes, beginning of line: Found in ~1.3% of all reads\n\nshort barcodes, end of line: Found in ~2.7% of all reads\n\n\n\nOverall, the comparison is interesting, however, the important take home from this is that in the best-case scenario (grep, short barcodes), we're only able to identify 25% of the reads in our sequences!\n\nIt should also be noted that my analysis only used sequences in one orientation. It would be a good idea to also do this analysis by searching with the reverse and reverse complements of these sequences.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../../styles.css"],"toc":true,"toc-depth":5,"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","editor":"source","theme":"darkly","page-layout":"full","code-background":true,"code-copy":true,"title-block-banner":true,"author":"Sam White","toc-title":"Contents","toc-location":"left","date":"2015-03-14 16:58:00+00:00","layout":"post","slug":"truseq-adaptor-identification-method-comparison-lsu-c-virginica-oil-spill-sequences","title":"TruSeq Adaptor Identification Method Comparison - LSU C.virginica Oil Spill Sequences","categories":["2015","LSU C.virginica Oil Spill MBD BS Sequencing","barcodes","Crassostrea virginica","Eastern oyster","FASTQ","FASTQC","fastx_barcode_splitter","grep","index sequences","ipython notebook","jupyter notebook","TruSeq"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}