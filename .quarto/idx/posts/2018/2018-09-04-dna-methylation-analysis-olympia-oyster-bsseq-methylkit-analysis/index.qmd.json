{"title":"DNA Methylation Analysis - Olympia oyster BSseq MethylKit Analysis","markdown":{"yaml":{"author":"Sam White","toc-title":"Contents","toc-depth":5,"toc-location":"left","date":"2018-09-04 20:49:56+00:00","layout":"post","slug":"dna-methylation-analysis-olympia-oyster-bsseq-methylkit-analysis","title":"DNA Methylation Analysis - Olympia oyster BSseq MethylKit Analysis","categories":["2018","bismark","BSseq","methylation","methylkit","Olympia oyster","Ostrea lurida"]},"headingText":"NOTE: IMPORTANT CAVEATS - READ POST BEFORE USING DATA.","containsRefs":false,"markdown":"\n\n\n\n\n\n\n##### I'm posting this for posterity and to provide an overview of what (and whatnot) to do. Plus, this has a good R script for using MethylKit that can be used for subsequent analyses.\n\n\n\nThe goal of this analysis was to compare the methylation profiles of Olympia oysters originating from a common population (Fidalgo Bay) that were raised in two different locations (Fidalgo Bay & Oyster Bay).\n\nAn overview of the experiment can be viewed here:\n\n\n\n\n\n  * [GitHub Wiki: Whole-genome-BSseq-December-2015](https://github.com/RobertsLab/project-olympia.oyster-genomic/wiki/Whole-genome-BSseq-December-2015)\n\n\n\nI [previously ran all of Olympia oyster DNA methylation sequencing data through the Bismark pipeline](../2018-08-16-dna-methylation-analysis-bismark-pipeline-on-all-olympia-oyster-bsseq-datasets/index.qmd), and then processed them using the MethylKit R library.\n\nFirst mistake (Bismark):\n\n\n\n\n\n  * Trimmed FastQ files \"incorrectly\".\n\n\n\n[Bismark provides an excellent user guide and provides a handy table on how to decide on trimming parameters](https://felixkrueger.github.io/Bismark/), but I mistakenly trimmed these according to the recommendations for a different library preparation technique. I trimmed based on the Zymo Pico-Methyl Kit (which _was_ used for the other group of data that I processed simultaneously), instead of the TruSeq library prep.\n\nSo, \"incorrectly\" isn't necessarily the proper term here. The analysis can still be used, however, it's likely that the excessive trimming results in reducing sequencing coverage, and, in turn, making the downstream analysis result in a highly conservative output. Thus, the data isn't wrong or bad, it is just very limited.\n\nAnd, this leads to the second mistake (Bismark):\n\n\n\n\n\n  * Bowtie alignment score too strict\n\n\n\nThere's a bit of a weird \"battle\" between Bismark and bowtie2. Bismark uses bowtie2 for generating alignments, but bowtie2's default cutoff score overrides Bismark's. So, to adjust the score value, you have to explicitly add the scoring parameters to your Bismark parameters during the alignment step. I did not do this.\n\nAgain, it's not wrong, per se, but leads to a significantly limited set of data in the final analysis.\n\nThe data were analyzed based on a minimum of:\n\n\n\n  * 3x coverage\n\n\n\n  * 25% difference in methylation\n\n\n\n\n\n\n* * *\n\n\n\n\n\n# RESULTS:\n\n\n\n\n\nMethylkit analysis (R project; GitHub):\n\n\n\n\n\n  * [20180827_oly_methylkit](https://github.com/RobertsLab/code/tree/master/r_projects/sam/20180827_oly_methylkit)\n\n\n\nBedGraph file (BED):\n\n\n\n  * [OlyFbOb_3xCov_25percentDiff.bed](https://github.com/RobertsLab/code/raw/master/r_projects/sam/20180827_oly_methylkit/analyses/OlyFbOb_3xCov_25percentDiff.bed)\n\n\n\nThe analysis resulted in a total of seven (yes, 7) differentially methylated loci (DML) between the two groups. It was this result that made Steven and me revisit the initial Bismark analysis. He has done this previously (but differently) and gotten significantly greater numbers of DML.\n\nKnowing all of this, I will re-trim the data and adjust Bismark alignment score thresholds and then re-analyze with MethylKit.\n\nRegardless here're some plots to add some visual flair to this notebook entry (these, and more, are available in the GitHub repo):\n\n\n\n##### CLUSTERING DENDROGRAM\n\n\n\n![](https://raw.githubusercontent.com/RobertsLab/code/master/r_projects/sam/20180827_oly_methylkit/analyses/clustering_dendrogram.png)\n\n\n\n* * *\n\n\n\n\n\n##### PCA PLOT\n\n\n\n![](https://raw.githubusercontent.com/RobertsLab/code/master/r_projects/sam/20180827_oly_methylkit/analyses/pca.png)\n","srcMarkdownNoYaml":"\n\n##### NOTE: IMPORTANT CAVEATS - READ POST BEFORE USING DATA.\n\n\n\n\n\n##### I'm posting this for posterity and to provide an overview of what (and whatnot) to do. Plus, this has a good R script for using MethylKit that can be used for subsequent analyses.\n\n\n\nThe goal of this analysis was to compare the methylation profiles of Olympia oysters originating from a common population (Fidalgo Bay) that were raised in two different locations (Fidalgo Bay & Oyster Bay).\n\nAn overview of the experiment can be viewed here:\n\n\n\n\n\n  * [GitHub Wiki: Whole-genome-BSseq-December-2015](https://github.com/RobertsLab/project-olympia.oyster-genomic/wiki/Whole-genome-BSseq-December-2015)\n\n\n\nI [previously ran all of Olympia oyster DNA methylation sequencing data through the Bismark pipeline](../2018-08-16-dna-methylation-analysis-bismark-pipeline-on-all-olympia-oyster-bsseq-datasets/index.qmd), and then processed them using the MethylKit R library.\n\nFirst mistake (Bismark):\n\n\n\n\n\n  * Trimmed FastQ files \"incorrectly\".\n\n\n\n[Bismark provides an excellent user guide and provides a handy table on how to decide on trimming parameters](https://felixkrueger.github.io/Bismark/), but I mistakenly trimmed these according to the recommendations for a different library preparation technique. I trimmed based on the Zymo Pico-Methyl Kit (which _was_ used for the other group of data that I processed simultaneously), instead of the TruSeq library prep.\n\nSo, \"incorrectly\" isn't necessarily the proper term here. The analysis can still be used, however, it's likely that the excessive trimming results in reducing sequencing coverage, and, in turn, making the downstream analysis result in a highly conservative output. Thus, the data isn't wrong or bad, it is just very limited.\n\nAnd, this leads to the second mistake (Bismark):\n\n\n\n\n\n  * Bowtie alignment score too strict\n\n\n\nThere's a bit of a weird \"battle\" between Bismark and bowtie2. Bismark uses bowtie2 for generating alignments, but bowtie2's default cutoff score overrides Bismark's. So, to adjust the score value, you have to explicitly add the scoring parameters to your Bismark parameters during the alignment step. I did not do this.\n\nAgain, it's not wrong, per se, but leads to a significantly limited set of data in the final analysis.\n\nThe data were analyzed based on a minimum of:\n\n\n\n  * 3x coverage\n\n\n\n  * 25% difference in methylation\n\n\n\n\n\n\n* * *\n\n\n\n\n\n# RESULTS:\n\n\n\n\n\nMethylkit analysis (R project; GitHub):\n\n\n\n\n\n  * [20180827_oly_methylkit](https://github.com/RobertsLab/code/tree/master/r_projects/sam/20180827_oly_methylkit)\n\n\n\nBedGraph file (BED):\n\n\n\n  * [OlyFbOb_3xCov_25percentDiff.bed](https://github.com/RobertsLab/code/raw/master/r_projects/sam/20180827_oly_methylkit/analyses/OlyFbOb_3xCov_25percentDiff.bed)\n\n\n\nThe analysis resulted in a total of seven (yes, 7) differentially methylated loci (DML) between the two groups. It was this result that made Steven and me revisit the initial Bismark analysis. He has done this previously (but differently) and gotten significantly greater numbers of DML.\n\nKnowing all of this, I will re-trim the data and adjust Bismark alignment score thresholds and then re-analyze with MethylKit.\n\nRegardless here're some plots to add some visual flair to this notebook entry (these, and more, are available in the GitHub repo):\n\n\n\n##### CLUSTERING DENDROGRAM\n\n\n\n![](https://raw.githubusercontent.com/RobertsLab/code/master/r_projects/sam/20180827_oly_methylkit/analyses/clustering_dendrogram.png)\n\n\n\n* * *\n\n\n\n\n\n##### PCA PLOT\n\n\n\n![](https://raw.githubusercontent.com/RobertsLab/code/master/r_projects/sam/20180827_oly_methylkit/analyses/pca.png)\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../../styles.css"],"toc":true,"toc-depth":5,"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","editor":"source","theme":"darkly","page-layout":"full","code-background":true,"code-copy":true,"title-block-banner":true,"author":"Sam White","toc-title":"Contents","toc-location":"left","date":"2018-09-04 20:49:56+00:00","layout":"post","slug":"dna-methylation-analysis-olympia-oyster-bsseq-methylkit-analysis","title":"DNA Methylation Analysis - Olympia oyster BSseq MethylKit Analysis","categories":["2018","bismark","BSseq","methylation","methylkit","Olympia oyster","Ostrea lurida"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}