{"title":"Annotation - Olurida_v081 MAKER on Mox","markdown":{"yaml":{"author":"Sam White","toc-title":"Contents","toc-depth":5,"toc-location":"left","layout":"post","title":"Annotation - Olurida_v081 MAKER on Mox","date":"2018-11-27 14:40","categories":["Ostrea lurida","Olympia oyster","mox","MAKER","genome annotation","Olurida_v081","2018","Olympia Oyster Genome Sequencing"]},"headingText":"ROUND 1 (Initial MAKER run)","containsRefs":false,"markdown":"\nRemarkably, I managed to burn through our [Xsede computing resources](../2018-08-07-genome-annotation-olympia-oyster-genome-using-wq-maker-instance-on-jetstream/index.qmd) and don't have terribly much to show for it. Ooof! This is a major bummer, as it \"only\" takes ~8hrs for a WQ-MAKER job to run there, as opposed to [_months_ the last time I tried running it on Mox](../2018-07-11-mox-olympia-oyster-genome-annotation-progress-using-maker-2-31-10/index.qmd). Although we have used up our Xsede allocation, all is not lost! The experience of setting up/running WQ-MAKER has enlightened me on how it all works and how to run it on Mox so it will (hopefully) take far, far less time than the last Mox attempt. With that said, here we go...\n\nFirstly, I re-installed MAKER (v2.31.10) and configured for OpenMPI support. This is computing jargon that basically allows MAKER to work on a computer cluster efficiently. Now that we have two Mox nodes, I think this will help accelerate the process.\n\nWith that out of the way, here's a _very_ brief overview of the entire MAKER annotation process. Be aware, despite it's \"brevity\", this is still a lengthy read:\n\n1. Create custom repeat library for your organism ([did this with RepeatModeler on 20181022](../2018-10-22-Repeat-Library-Construction---O.lurida-RepeatModeler-v1.0.11/index.qmd))\n\n2. Provide RNAseq data ([transcriptome v3](http://eagle.fish.washington.edu/cnidarian/Olurida_transcriptome_v3.fasta))\n\n3. Provide species-specific and/or related proteomic data (used publicly available proteomes from NCBI for _C.gigas_ [GCA_000297895.1_oyster_v9](ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/000/297/895/GCA_000297895.1_oyster_v9/)) and _C.virginica_ ([GCF_002022765.2_C_virginica-3.0](ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/002/022/765/GCF_002022765.2_C_virginica-3.0/))\n\n4. Run MAKER to produce initial gene models.\n\n5. Merge all the hundred thousands (seriously) of individual GFFs and FastAs in to a singular file of each file type. MAKER has built-in scripts to do this.\n\n6. Generate _ab initio_ gene prediction using [SNAP](https://github.com/KorfLab/SNAP). This is integrated in to MAKER.\n\n7. Run MAKER again, using the SNAP gene models.\n\n8. Merge the new set of GFFs.\n\n9. Run SNAP a second time.\n\n10. Run MAKER a _third_ time using the second set of SNAP gene models.\n\n11. Merge the final set of GFFs.\n\n12. Done???\n\nSo, that's how it's done! Easy!\n\nWith each round of MAKER, a \"control\" file needs to be generated and modified appropriately. Modifications consist of telling MAKER locations of files and whether or not to use certain types of files when producing a new model (e.g. RNAseq data, SNAP HMM file, etc.). Here are the three control files that were used to run MAKER. The links are simply text files, despite their extension, so they can be downloaded and viewed in any text editor, if desired, but I've pasted their contents below for easier review:\n\n\n\n\n- [20181127_oly_maker_genome_annotation/maker_opts.ctl](http://gannet.fish.washington.edu/Atumefaciens/20181127_oly_maker_genome_annotation/maker_opts.ctl)\n\n<pre><code>\n#-----Genome (these are always required)\ngenome=/gscratch/srlab/sam/data/O_lurida/oly_genome_assemblies/Olurida_v081/Olurida_v081.fa #genome sequence (fasta file or fasta embeded in GFF3 file)\norganism_type=eukaryotic #eukaryotic or prokaryotic. Default is eukaryotic\n\n#-----Re-annotation Using MAKER Derived GFF3\nmaker_gff= #MAKER derived GFF3 file\nest_pass=0 #use ESTs in maker_gff: 1 = yes, 0 = no\naltest_pass=0 #use alternate organism ESTs in maker_gff: 1 = yes, 0 = no\nprotein_pass=0 #use protein alignments in maker_gff: 1 = yes, 0 = no\nrm_pass=0 #use repeats in maker_gff: 1 = yes, 0 = no\nmodel_pass=0 #use gene models in maker_gff: 1 = yes, 0 = no\npred_pass=0 #use ab-initio predictions in maker_gff: 1 = yes, 0 = no\nother_pass=0 #passthrough anyything else in maker_gff: 1 = yes, 0 = no\n\n#-----EST Evidence (for best results provide a file for at least one)\nest=/gscratch/srlab/sam/data/O_lurida/oly_transcriptome_assemblies/Olurida_transcriptome_v3.fasta #set of ESTs or assembled mRNA-seq in fasta format\naltest= #EST/cDNA sequence file in fasta format from an alternate organism\nest_gff= #aligned ESTs or mRNA-seq from an external GFF3 file\naltest_gff= #aligned ESTs from a closly relate species in GFF3 format\n\n#-----Protein Homology Evidence (for best results provide a file for at least one)\nprotein=/gscratch/scrubbed/samwhite/outputs/20181127_oly_maker_genome_annotation/gigas_virginica_ncbi_proteomes.fasta  #protein sequence file in fasta format (i.e. from mutiple oransisms)\nprotein_gff=  #aligned protein homology evidence from an external GFF3 file\n\n#-----Repeat Masking (leave values blank to skip repeat masking)\nmodel_org=all #select a model organism for RepBase masking in RepeatMasker\nrmlib=/gscratch/srlab/sam/data/O_lurida/Ostrea_lurida_v081-families.fa #provide an organism specific repeat library in fasta format for RepeatMasker\nrepeat_protein=/gscratch/srlab/programs/maker-2.31.10/data/te_proteins.fasta #provide a fasta file of transposable element proteins for RepeatRunner\nrm_gff= #pre-identified repeat elements from an external GFF3 file\nprok_rm=0 #forces MAKER to repeatmask prokaryotes (no reason to change this), 1 = yes, 0 = no\nsoftmask=1 #use soft-masking rather than hard-masking in BLAST (i.e. seg and dust filtering)\n\n#-----Gene Prediction\nsnaphmm= #SNAP HMM file\ngmhmm= #GeneMark HMM file\naugustus_species= #Augustus gene prediction species model\nfgenesh_par_file= #FGENESH parameter file\npred_gff= #ab-initio predictions from an external GFF3 file\nmodel_gff= #annotated gene models from an external GFF3 file (annotation pass-through)\nest2genome=1 #infer gene predictions directly from ESTs, 1 = yes, 0 = no\nprotein2genome=1 #infer predictions from protein homology, 1 = yes, 0 = no\ntrna=0 #find tRNAs with tRNAscan, 1 = yes, 0 = no\nsnoscan_rrna= #rRNA file to have Snoscan find snoRNAs\nunmask=0 #also run ab-initio prediction programs on unmasked sequence, 1 = yes, 0 = no\n\n#-----Other Annotation Feature Types (features MAKER doesn't recognize)\nother_gff= #extra features to pass-through to final MAKER generated GFF3 file\n\n#-----External Application Behavior Options\nalt_peptide=C #amino acid used to replace non-standard amino acids in BLAST databases\ncpus=1 #max number of cpus to use in BLAST and RepeatMasker (not for MPI, leave 1 when using MPI)\n\n#-----MAKER Behavior Options\nmax_dna_len=100000 #length for dividing up contigs into chunks (increases/decreases memory usage)\nmin_contig=1 #skip genome contigs below this length (under 10kb are often useless)\n\npred_flank=200 #flank for extending evidence clusters sent to gene predictors\npred_stats=0 #report AED and QI statistics for all predictions as well as models\nAED_threshold=1 #Maximum Annotation Edit Distance allowed (bound by 0 and 1)\nmin_protein=0 #require at least this many amino acids in predicted proteins\nalt_splice=0 #Take extra steps to try and find alternative splicing, 1 = yes, 0 = no\nalways_complete=0 #extra steps to force start and stop codons, 1 = yes, 0 = no\nmap_forward=0 #map names and attributes forward from old GFF3 genes, 1 = yes, 0 = no\nkeep_preds=0 #Concordance threshold to add unsupported gene prediction (bound by 0 and 1)\n\nsplit_hit=10000 #length for the splitting of hits (expected max intron size for evidence alignments)\nsingle_exon=0 #consider single exon EST evidence when generating annotations, 1 = yes, 0 = no\nsingle_length=250 #min length required for single exon ESTs if 'single_exon is enabled'\ncorrect_est_fusion=0 #limits use of ESTs in annotation to avoid fusion genes\n\ntries=2 #number of times to try a contig if there is a failure for some reason\nclean_try=0 #remove all data from previous run before retrying, 1 = yes, 0 = no\nclean_up=0 #removes theVoid directory with individual analysis files, 1 = yes, 0 = no\nTMP= #specify a directory other than the system default temporary directory for temporary files\n</code></pre>\n\n\n\n##### ROUND 2 (After initial SNAP run)\n\n- [20181127_oly_maker_genome_annotation/snap01/maker_opts.ctl](http://gannet.fish.washington.edu/Atumefaciens/20181127_oly_maker_genome_annotation/snap01/maker_opts.ctl)\n\n<pre><code>\n#-----Genome (these are always required)\ngenome=/gscratch/srlab/sam/data/O_lurida/oly_genome_assemblies/Olurida_v081/Olurida_v081.fa #genome sequence (fasta file or fasta embeded in GFF3 file)\norganism_type=eukaryotic #eukaryotic or prokaryotic. Default is eukaryotic\n\n#-----Re-annotation Using MAKER Derived GFF3\nmaker_gff= #MAKER derived GFF3 file\nest_pass=0 #use ESTs in maker_gff: 1 = yes, 0 = no\naltest_pass=0 #use alternate organism ESTs in maker_gff: 1 = yes, 0 = no\nprotein_pass=0 #use protein alignments in maker_gff: 1 = yes, 0 = no\nrm_pass=0 #use repeats in maker_gff: 1 = yes, 0 = no\nmodel_pass=0 #use gene models in maker_gff: 1 = yes, 0 = no\npred_pass=0 #use ab-initio predictions in maker_gff: 1 = yes, 0 = no\nother_pass=0 #passthrough anyything else in maker_gff: 1 = yes, 0 = no\n\n#-----EST Evidence (for best results provide a file for at least one)\nest=/gscratch/srlab/sam/data/O_lurida/oly_transcriptome_assemblies/Olurida_transcriptome_v3.fasta #set of ESTs or assembled mRNA-seq in fasta format\naltest= #EST/cDNA sequence file in fasta format from an alternate organism\nest_gff= #aligned ESTs or mRNA-seq from an external GFF3 file\naltest_gff= #aligned ESTs from a closly relate species in GFF3 format\n\n#-----Protein Homology Evidence (for best results provide a file for at least one)\nprotein=/gscratch/scrubbed/samwhite/outputs/20181127_oly_maker_genome_annotation/gigas_virginica_ncbi_proteomes.fasta  #protein sequence file in fasta format (i.e. from mutiple oransisms)\nprotein_gff=  #aligned protein homology evidence from an external GFF3 file\n\n#-----Repeat Masking (leave values blank to skip repeat masking)\nmodel_org=all #select a model organism for RepBase masking in RepeatMasker\nrmlib=/gscratch/srlab/sam/data/O_lurida/Ostrea_lurida_v081-families.fa #provide an organism specific repeat library in fasta format for RepeatMasker\nrepeat_protein=/gscratch/srlab/programs/maker-2.31.10/data/te_proteins.fasta #provide a fasta file of transposable element proteins for RepeatRunner\nrm_gff= #pre-identified repeat elements from an external GFF3 file\nprok_rm=0 #forces MAKER to repeatmask prokaryotes (no reason to change this), 1 = yes, 0 = no\nsoftmask=1 #use soft-masking rather than hard-masking in BLAST (i.e. seg and dust filtering)\n\n#-----Gene Prediction\nsnaphmm=20181127__oly_snap01.hmm #SNAP HMM file\ngmhmm= #GeneMark HMM file\naugustus_species= #Augustus gene prediction species model\nfgenesh_par_file= #FGENESH parameter file\npred_gff= #ab-initio predictions from an external GFF3 file\nmodel_gff= #annotated gene models from an external GFF3 file (annotation pass-through)\nest2genome=0 #infer gene predictions directly from ESTs, 1 = yes, 0 = no\nprotein2genome=0 #infer predictions from protein homology, 1 = yes, 0 = no\ntrna=0 #find tRNAs with tRNAscan, 1 = yes, 0 = no\nsnoscan_rrna= #rRNA file to have Snoscan find snoRNAs\nunmask=0 #also run ab-initio prediction programs on unmasked sequence, 1 = yes, 0 = no\n\n#-----Other Annotation Feature Types (features MAKER doesn't recognize)\nother_gff= #extra features to pass-through to final MAKER generated GFF3 file\n\n#-----External Application Behavior Options\nalt_peptide=C #amino acid used to replace non-standard amino acids in BLAST databases\ncpus=1 #max number of cpus to use in BLAST and RepeatMasker (not for MPI, leave 1 when using MPI)\n\n#-----MAKER Behavior Options\nmax_dna_len=100000 #length for dividing up contigs into chunks (increases/decreases memory usage)\nmin_contig=1 #skip genome contigs below this length (under 10kb are often useless)\n\npred_flank=200 #flank for extending evidence clusters sent to gene predictors\npred_stats=0 #report AED and QI statistics for all predictions as well as models\nAED_threshold=1 #Maximum Annotation Edit Distance allowed (bound by 0 and 1)\nmin_protein=0 #require at least this many amino acids in predicted proteins\nalt_splice=0 #Take extra steps to try and find alternative splicing, 1 = yes, 0 = no\nalways_complete=0 #extra steps to force start and stop codons, 1 = yes, 0 = no\nmap_forward=0 #map names and attributes forward from old GFF3 genes, 1 = yes, 0 = no\nkeep_preds=0 #Concordance threshold to add unsupported gene prediction (bound by 0 and 1)\n\nsplit_hit=10000 #length for the splitting of hits (expected max intron size for evidence alignments)\nsingle_exon=0 #consider single exon EST evidence when generating annotations, 1 = yes, 0 = no\nsingle_length=250 #min length required for single exon ESTs if 'single_exon is enabled'\ncorrect_est_fusion=0 #limits use of ESTs in annotation to avoid fusion genes\n\ntries=2 #number of times to try a contig if there is a failure for some reason\nclean_try=0 #remove all data from previous run before retrying, 1 = yes, 0 = no\nclean_up=0 #removes theVoid directory with individual analysis files, 1 = yes, 0 = no\nTMP= #specify a directory other than the system default temporary directory for temporary files\n</code></pre>\n\n\n\n##### ROUND 3 (After second SNAP run)\n\n- [20181127_oly_maker_genome_annotation/snap02/maker_opts.ctl](http://gannet.fish.washington.edu/Atumefaciens/20181127_oly_maker_genome_annotation/snap02/maker_opts.ctl)\n\n<pre><code>\n#-----Genome (these are always required)\ngenome=/gscratch/srlab/sam/data/O_lurida/oly_genome_assemblies/Olurida_v081/Olurida_v081.fa #genome sequence (fasta file or fasta embeded in GFF3 file)\norganism_type=eukaryotic #eukaryotic or prokaryotic. Default is eukaryotic\n\n#-----Re-annotation Using MAKER Derived GFF3\nmaker_gff= #MAKER derived GFF3 file\nest_pass=0 #use ESTs in maker_gff: 1 = yes, 0 = no\naltest_pass=0 #use alternate organism ESTs in maker_gff: 1 = yes, 0 = no\nprotein_pass=0 #use protein alignments in maker_gff: 1 = yes, 0 = no\nrm_pass=0 #use repeats in maker_gff: 1 = yes, 0 = no\nmodel_pass=0 #use gene models in maker_gff: 1 = yes, 0 = no\npred_pass=0 #use ab-initio predictions in maker_gff: 1 = yes, 0 = no\nother_pass=0 #passthrough anyything else in maker_gff: 1 = yes, 0 = no\n\n#-----EST Evidence (for best results provide a file for at least one)\nest=/gscratch/srlab/sam/data/O_lurida/oly_transcriptome_assemblies/Olurida_transcriptome_v3.fasta #set of ESTs or assembled mRNA-seq in fasta format\naltest= #EST/cDNA sequence file in fasta format from an alternate organism\nest_gff= #aligned ESTs or mRNA-seq from an external GFF3 file\naltest_gff= #aligned ESTs from a closly relate species in GFF3 format\n\n#-----Protein Homology Evidence (for best results provide a file for at least one)\nprotein=/gscratch/scrubbed/samwhite/outputs/20181127_oly_maker_genome_annotation/gigas_virginica_ncbi_proteomes.fasta  #protein sequence file in fasta format (i.e. from mutiple oransisms)\nprotein_gff=  #aligned protein homology evidence from an external GFF3 file\n\n#-----Repeat Masking (leave values blank to skip repeat masking)\nmodel_org=all #select a model organism for RepBase masking in RepeatMasker\nrmlib=/gscratch/srlab/sam/data/O_lurida/Ostrea_lurida_v081-families.fa #provide an organism specific repeat library in fasta format for RepeatMasker\nrepeat_protein=/gscratch/srlab/programs/maker-2.31.10/data/te_proteins.fasta #provide a fasta file of transposable element proteins for RepeatRunner\nrm_gff= #pre-identified repeat elements from an external GFF3 file\nprok_rm=0 #forces MAKER to repeatmask prokaryotes (no reason to change this), 1 = yes, 0 = no\nsoftmask=1 #use soft-masking rather than hard-masking in BLAST (i.e. seg and dust filtering)\n\n#-----Gene Prediction\nsnaphmm=20181127__oly_snap01.hmm #SNAP HMM file\ngmhmm= #GeneMark HMM file\naugustus_species= #Augustus gene prediction species model\nfgenesh_par_file= #FGENESH parameter file\npred_gff= #ab-initio predictions from an external GFF3 file\nmodel_gff= #annotated gene models from an external GFF3 file (annotation pass-through)\nest2genome=0 #infer gene predictions directly from ESTs, 1 = yes, 0 = no\nprotein2genome=0 #infer predictions from protein homology, 1 = yes, 0 = no\ntrna=0 #find tRNAs with tRNAscan, 1 = yes, 0 = no\nsnoscan_rrna= #rRNA file to have Snoscan find snoRNAs\nunmask=0 #also run ab-initio prediction programs on unmasked sequence, 1 = yes, 0 = no\n\n#-----Other Annotation Feature Types (features MAKER doesn't recognize)\nother_gff= #extra features to pass-through to final MAKER generated GFF3 file\n\n#-----External Application Behavior Options\nalt_peptide=C #amino acid used to replace non-standard amino acids in BLAST databases\ncpus=1 #max number of cpus to use in BLAST and RepeatMasker (not for MPI, leave 1 when using MPI)\n\n#-----MAKER Behavior Options\nmax_dna_len=100000 #length for dividing up contigs into chunks (increases/decreases memory usage)\nmin_contig=1 #skip genome contigs below this length (under 10kb are often useless)\n\npred_flank=200 #flank for extending evidence clusters sent to gene predictors\npred_stats=0 #report AED and QI statistics for all predictions as well as models\nAED_threshold=1 #Maximum Annotation Edit Distance allowed (bound by 0 and 1)\nmin_protein=0 #require at least this many amino acids in predicted proteins\nalt_splice=0 #Take extra steps to try and find alternative splicing, 1 = yes, 0 = no\nalways_complete=0 #extra steps to force start and stop codons, 1 = yes, 0 = no\nmap_forward=0 #map names and attributes forward from old GFF3 genes, 1 = yes, 0 = no\nkeep_preds=0 #Concordance threshold to add unsupported gene prediction (bound by 0 and 1)\n\nsplit_hit=10000 #length for the splitting of hits (expected max intron size for evidence alignments)\nsingle_exon=0 #consider single exon EST evidence when generating annotations, 1 = yes, 0 = no\nsingle_length=250 #min length required for single exon ESTs if 'single_exon is enabled'\ncorrect_est_fusion=0 #limits use of ESTs in annotation to avoid fusion genes\n\ntries=2 #number of times to try a contig if there is a failure for some reason\nclean_try=0 #remove all data from previous run before retrying, 1 = yes, 0 = no\nclean_up=0 #removes theVoid directory with individual analysis files, 1 = yes, 0 = no\nTMP= #specify a directory other than the system default temporary directory for temporary files\n[samwhite@mox1 snap01]$ cd ../snap02\n[samwhite@mox1 snap02]$ cat maker_opts.ctl\n#-----Genome (these are always required)\ngenome=/gscratch/srlab/sam/data/O_lurida/oly_genome_assemblies/Olurida_v081/Olurida_v081.fa #genome sequence (fasta file or fasta embeded in GFF3 file)\norganism_type=eukaryotic #eukaryotic or prokaryotic. Default is eukaryotic\n\n#-----Re-annotation Using MAKER Derived GFF3\nmaker_gff= #MAKER derived GFF3 file\nest_pass=0 #use ESTs in maker_gff: 1 = yes, 0 = no\naltest_pass=0 #use alternate organism ESTs in maker_gff: 1 = yes, 0 = no\nprotein_pass=0 #use protein alignments in maker_gff: 1 = yes, 0 = no\nrm_pass=0 #use repeats in maker_gff: 1 = yes, 0 = no\nmodel_pass=0 #use gene models in maker_gff: 1 = yes, 0 = no\npred_pass=0 #use ab-initio predictions in maker_gff: 1 = yes, 0 = no\nother_pass=0 #passthrough anyything else in maker_gff: 1 = yes, 0 = no\n\n#-----EST Evidence (for best results provide a file for at least one)\nest=/gscratch/srlab/sam/data/O_lurida/oly_transcriptome_assemblies/Olurida_transcriptome_v3.fasta #set of ESTs or assembled mRNA-seq in fasta format\naltest= #EST/cDNA sequence file in fasta format from an alternate organism\nest_gff= #aligned ESTs or mRNA-seq from an external GFF3 file\naltest_gff= #aligned ESTs from a closly relate species in GFF3 format\n\n#-----Protein Homology Evidence (for best results provide a file for at least one)\nprotein=/gscratch/scrubbed/samwhite/outputs/20181127_oly_maker_genome_annotation/gigas_virginica_ncbi_proteomes.fasta  #protein sequence file in fasta format (i.e. from mutiple oransisms)\nprotein_gff=  #aligned protein homology evidence from an external GFF3 file\n\n#-----Repeat Masking (leave values blank to skip repeat masking)\nmodel_org=all #select a model organism for RepBase masking in RepeatMasker\nrmlib=/gscratch/srlab/sam/data/O_lurida/Ostrea_lurida_v081-families.fa #provide an organism specific repeat library in fasta format for RepeatMasker\nrepeat_protein=/gscratch/srlab/programs/maker-2.31.10/data/te_proteins.fasta #provide a fasta file of transposable element proteins for RepeatRunner\nrm_gff= #pre-identified repeat elements from an external GFF3 file\nprok_rm=0 #forces MAKER to repeatmask prokaryotes (no reason to change this), 1 = yes, 0 = no\nsoftmask=1 #use soft-masking rather than hard-masking in BLAST (i.e. seg and dust filtering)\n\n#-----Gene Prediction\nsnaphmm=20181127__oly_snap02.hmm #SNAP HMM file\ngmhmm= #GeneMark HMM file\naugustus_species= #Augustus gene prediction species model\nfgenesh_par_file= #FGENESH parameter file\npred_gff= #ab-initio predictions from an external GFF3 file\nmodel_gff= #annotated gene models from an external GFF3 file (annotation pass-through)\nest2genome=0 #infer gene predictions directly from ESTs, 1 = yes, 0 = no\nprotein2genome=0 #infer predictions from protein homology, 1 = yes, 0 = no\ntrna=0 #find tRNAs with tRNAscan, 1 = yes, 0 = no\nsnoscan_rrna= #rRNA file to have Snoscan find snoRNAs\nunmask=0 #also run ab-initio prediction programs on unmasked sequence, 1 = yes, 0 = no\n\n#-----Other Annotation Feature Types (features MAKER doesn't recognize)\nother_gff= #extra features to pass-through to final MAKER generated GFF3 file\n\n#-----External Application Behavior Options\nalt_peptide=C #amino acid used to replace non-standard amino acids in BLAST databases\ncpus=1 #max number of cpus to use in BLAST and RepeatMasker (not for MPI, leave 1 when using MPI)\n\n#-----MAKER Behavior Options\nmax_dna_len=100000 #length for dividing up contigs into chunks (increases/decreases memory usage)\nmin_contig=1 #skip genome contigs below this length (under 10kb are often useless)\n\npred_flank=200 #flank for extending evidence clusters sent to gene predictors\npred_stats=0 #report AED and QI statistics for all predictions as well as models\nAED_threshold=1 #Maximum Annotation Edit Distance allowed (bound by 0 and 1)\nmin_protein=0 #require at least this many amino acids in predicted proteins\nalt_splice=0 #Take extra steps to try and find alternative splicing, 1 = yes, 0 = no\nalways_complete=0 #extra steps to force start and stop codons, 1 = yes, 0 = no\nmap_forward=0 #map names and attributes forward from old GFF3 genes, 1 = yes, 0 = no\nkeep_preds=0 #Concordance threshold to add unsupported gene prediction (bound by 0 and 1)\n\nsplit_hit=10000 #length for the splitting of hits (expected max intron size for evidence alignments)\nsingle_exon=0 #consider single exon EST evidence when generating annotations, 1 = yes, 0 = no\nsingle_length=250 #min length required for single exon ESTs if 'single_exon is enabled'\ncorrect_est_fusion=0 #limits use of ESTs in annotation to avoid fusion genes\n\ntries=2 #number of times to try a contig if there is a failure for some reason\nclean_try=0 #remove all data from previous run before retrying, 1 = yes, 0 = no\nclean_up=0 #removes theVoid directory with individual analysis files, 1 = yes, 0 = no\nTMP= #specify a directory other than the system default temporary directory for temporary files\n</code></pre>\n\n\n\n\n\nHere's the SBATCH script (plain text file) used to actually run this job:\n\n- [20181127_oly_maker_genome_annotation/20181127_oly_maker_genome_annotation.sh](http://gannet.fish.washington.edu/Atumefaciens/20181127_oly_maker_genome_annotation/20181127_oly_maker_genome_annotation.sh)\n\n<pre><code>\n#!/bin/bash\n## Job Name\n#SBATCH --job-name=20181127_oly_maker_genome_annotation\n## Allocation Definition\n#SBATCH --account=srlab\n#SBATCH --partition=srlab\n## Resources\n## Nodes\n#SBATCH --nodes=2\n## Walltime (days-hours:minutes:seconds format)\n#SBATCH --time=15-00:00:00\n## Memory per node\n#SBATCH --mem=120G\n##turn on e-mail notification\n#SBATCH --mail-type=ALL\n#SBATCH --mail-user=samwhite@uw.edu\n## Specify the working directory for this job\n#SBATCH --workdir=/gscratch/scrubbed/samwhite/outputs/20181127_oly_maker_genome_annotation\n\n# Load Python Mox module for Python module availability\n\nmodule load intel-python3_2017\n\n# Load Open MPI module for parallel, multi-node processing\n\nmodule load icc_19-ompi_3.1.2\n\n# SegFault fix?\nexport THREADS_DAEMON_MODEL=1\n\n# Document programs in PATH (primarily for program version ID)\n\ndate >> system_path.log\necho \"\" >> system_path.log\necho \"System PATH for $SLURM_JOB_ID\" >> system_path.log\necho \"\" >> system_path.log\nprintf \"%0.s-\" {1..10} >> system_path.log\necho ${PATH} | tr : \\\\n >> system_path.log\n\n## Establish variables for more readable code\n\n### Paths to Maker binaries\nmaker=/gscratch/srlab/programs/maker-2.31.10/bin/maker\ngff3_merge=/gscratch/srlab/programs/maker-2.31.10/bin/gff3_merge\nfasta_merge=/gscratch/srlab/programs/maker-2.31.10/bin/fasta_merge\nmaker2zff=/gscratch/srlab/programs/maker-2.31.10/bin/maker2zff\nfathom=/gscratch/srlab/programs/maker-2.31.10/exe/snap/fathom\nforge=/gscratch/srlab/programs/maker-2.31.10/exe/snap/forge\nhmmassembler=/gscratch/srlab/programs/maker-2.31.10/exe/snap/hmm-assembler.pl\n\n### Path to Olympia oyster genome FastA file\noly_genome=/gscratch/srlab/sam/data/O_lurida/oly_genome_assemblies/Olurida_v081/Olurida_v081.fa\n\n### Path to Olympia oyster transcriptome FastA file\noly_transcriptome=/gscratch/srlab/sam/data/O_lurida/oly_transcriptome_assemblies/Olurida_transcriptome_v3.fasta\n\n### Path to Crassotrea gigas NCBI protein FastA\ngigas_proteome=/gscratch/srlab/sam/data/C_gigas/gigas_ncbi_protein/GCA_000297895.1_oyster_v9_protein.faa\n\n### Path to Crassostrea virginica NCBI protein FastA\nvirginica_proteome=/gscratch/srlab/sam/data/C_virginica/virginica_ncbi_protein/GCF_002022765.2_C_virginica-3.0_protein.faa\n\n### Path to concatenated NCBI prteins FastA\ngigas_virginica_ncbi_proteomes=/gscratch/scrubbed/samwhite/outputs/20181127_oly_maker_genome_annotation/gigas_virginica_ncbi_proteomes.fasta\n\n### Path to O.lurida-specific repeat library\noly_repeat_library=/gscratch/srlab/sam/data/O_lurida/Ostrea_lurida_v081-families.fa\n\n## Create Maker control files needed for running Maker\n$maker -CTL\n\n## Store path to options control file\nmaker_opts_file=./maker_opts.ctl\n\n## Create combined proteome FastA file, only if it doesn't already exist.\nif [ ! -e gigas_virginica_ncbi_proteomes.fasta ]; then\n    touch gigas_virginica_ncbi_proteomes.fasta\n    cat \"$gigas_proteome\" >> gigas_virginica_ncbi_proteomes.fasta\n    cat \"$virginica_proteome\" >> gigas_virginica_ncbi_proteomes.fasta\nfi\n\n## Edit options file\n\n### Set paths to O.lurida genome and transcriptome.\n### Set path to combined C. gigas and C.virginica proteomes.\n## The use of the % symbol sets the delimiter sed uses for arguments.\n## Normally, the delimiter that most examples use is a slash \"/\".\n## But, we need to expand the variables into a full path with slashes, which screws up sed.\n## Thus, the use of % symbol instead (it could be any character that is NOT present in the expanded variable; doesn't have to be \"%\").\nsed -i \"/^genome=/ s% %$oly_genome %\" \"$maker_opts_file\"\nsed -i \"/^est=/ s% %$oly_transcriptome %\" \"$maker_opts_file\"\nsed -i \"/^protein=/ s% %$gigas_virginica_ncbi_proteomes %\" \"$maker_opts_file\"\nsed -i \"/^rmlib=/ s% %$oly_repeat_library %\" \"$maker_opts_file\"\nsed -i \"/^est2genome=0/ s/est2genome=0/est2genome=1/\" \"$maker_opts_file\"\nsed -i \"/^protein2genome=0/ s/protein2genome=0/protein2genome=1/\" \"$maker_opts_file\"\n\n## Run Maker\n### Specify number of nodes to use.\nmpiexec -n 56 $maker\n\n## Merge gffs\n${gff3_merge} -d Olurida_v081.maker.output/Olurida_v081_master_datastore_index.log\n\n## GFF with no FastA in footer\n${gff3_merge} -n -s -d Olurida_v081.maker.output/Olurida_v081_master_datastore_index.log > Olurida_v081.maker.all.noseqs.gff\n\n## Merge all FastAs\n${fasta_merge} -d Olurida_v081.maker.output/Olurida_v081_master_datastore_index.log\n\n## Run SNAP training, round 1\nmkdir snap01 && cd snap01\n${maker2zff} ../Olurida_v081.all.gff\n${fathom} -categorize 1000 genome.ann genome.dna\n${fathom} -export 1000 -plus uni.ann uni.dna\n${forge} export.ann export.dna\n${hmmassembler} test_snap1 . > 20181127__oly_snap01.hmm\n\n## Initiate second Maker run.\n### Copy initial maker control files and\n### - change gene prediction settings to 0 (i.e. don't generate Maker gene predictions)\n### - set location of snaphmm file to use for gene prediction\ncp ../maker_* .\nsed -i \"/^est2genome=1/ s/est2genome=1/est2genome=0/\" maker_opts.ctl\nsed -i \"/^protein2genome=1/ s/protein2genome=1/protein2genome=0/\" maker_opts.ctl\nsed -i \"/^snaphmm=/ s% %20181127__oly_snap01.hmm %\" maker_opts.ctl\n\n## Run Maker\n### Set basename of files and specify number of CPUs to use\nmpiexec -n 56 $maker \\\n-base 20181127_oly_genome_snap01\n\n## Merge gffs\n${gff3_merge} -d 20181127_oly_genome_snap01.maker.output/20181127_oly_genome_snap01_master_datastore_index.log\n\n### GFF with no FastA in footer\n${gff3_merge} -n -s -d 20181127_oly_genome_snap01.maker.output/20181127_oly_genome_snap01_master_datastore_index.log > 20181127_oly_genome_snap01.all.noseqs.gff\n\n### Merge all FastAs\n${fasta_merge} -d 20181127_oly_genome_snap01.maker.output/20181127_oly_genome_snap01_master_datastore_index.log\n\n## Run SNAP training, round 2\ncd ..\nmkdir snap02 && cd snap02\n${maker2zff} ../snap01/20181127_oly_genome_snap01.all.gff\n${fathom} -categorize 1000 genome.ann genome.dna\n${fathom} -export 1000 -plus uni.ann uni.dna\n${forge} export.ann export.dna\n${hmmassembler} test_snap1 . > 20181127__oly_snap02.hmm\n\n## Initiate third and final Maker run.\n### Copy initial maker control files and:\n### - change gene prediction settings to 0 (i.e. don't generate Maker gene predictions)\n### - set location of snaphmm file to use for gene prediction\ncp ../maker_* .\nsed -i \"/^est2genome=1/ s/est2genome=1/est2genome=0/\" maker_opts.ctl\nsed -i \"/^protein2genome=1/ s/protein2genome=1/protein2genome=0/\" maker_opts.ctl\nsed -i \"/^snaphmm=/ s% %20181127__oly_snap02.hmm %\" maker_opts.ctl\n\n## Run Maker\n### Set basename of files and specify number of CPUs to use\nmpiexec -n 56 $maker \\\n-base 20181127_oly_genome_snap02\n\n## Merge gffs\n${gff3_merge} \\\n-d 20181127_oly_genome_snap02.maker.output/20181127_oly_genome_snap02_master_datastore_index.log\n\n### GFF with no FastA in footer\n{gff3_merge} -n -s -d 20181127_oly_genome_snap02.maker.output/20181127_oly_genome_snap02_master_datastore_index.log > 20181127_oly_genome_snap02.all.noseqs.gff\n\n### Merge all FastAs\n${fasta_merge} -d 20181127_oly_genome_snap02.maker.output/20181127_oly_genome_snap02_master_datastore_index.log\n</code></pre>\n\n\nWe'll see how this goes...\n\n---\n\n# RESULTS\n\nThis actually completed, and in a reasonable (relatively) amount of time (2 weeks)!\n\n![](https://gannet.fish.washington.edu/Atumefaciens/images/20181210_mox_maker_complete.png)\n\nAll files were ```rsync```'d to my folder on Gannet.\n\nOutput directory:\n\n- [20181127_oly_maker_genome_annotation/](https://gannet.fish.washington.edu/Atumefaciens/20181127_oly_maker_genome_annotation/)\n\nHere are some of the key output files:\n\n##### MAKER Protein FastA\n- [20181127_oly_maker_genome_annotation/Olurida_v081.all.maker.proteins.fasta(9.3MB)](https://gannet.fish.washington.edu/Atumefaciens/20181127_oly_maker_genome_annotation/Olurida_v081.all.maker.proteins.fasta)\n\n##### MAKER Transcripts FastAs\n- [20181127_oly_maker_genome_annotation/Olurida_v081.all.maker.transcripts.fasta (28MB)](https://gannet.fish.washington.edu/Atumefaciens/20181127_oly_maker_genome_annotation/Olurida_v081.all.maker.transcripts.fasta)\n\n##### Initial MAKER Run GFF3\n\n- [20181127_oly_maker_genome_annotation/Olurida_v081.maker.all.noseqs.gff  (1.1GB)](https://gannet.fish.washington.edu/Atumefaciens/20181127_oly_maker_genome_annotation/Olurida_v081.maker.all.noseqs.gff)\n\n\n##### 2<sup>nd</sup> MAKER Run GFF (after 1<sup>st</sup> SNAP)\n\n- [20181127_oly_maker_genome_annotation/snap01/20181127_oly_genome_snap01.all.noseqs.gff (1.2GB)](https://gannet.fish.washington.edu/Atumefaciens/20181127_oly_maker_genome_annotation/snap01/20181127_oly_genome_snap01.all.noseqs.gff)\n\n##### 3<sup>rd</sup> MAKER Run GFF (after 2<sup>nd</sup> SNAP)\n\n- [20181127_oly_maker_genome_annotation/snap02/20181127_oly_genome_snap02.all.noseqs.gff](https://gannet.fish.washington.edu/Atumefaciens/20181127_oly_maker_genome_annotation/snap02/20181127_oly_genome_snap02.all.noseqs.gff)\n\n\nSo, what to do with all of this?\n\nFirstly, I've learned a lot about how all of this should work and recently discovered this remarkably informative GitHub Gist that walks through the process of annotating a snake genome:\n\n- [In-depth description of running MAKER for genome annotation.](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=29&cad=rja&uact=8&ved=2ahUKEwjph4b1ibLfAhUMFnwKHRofDboQFjAcegQICxAB&url=https%3A%2F%2Fgist.github.com%2Fdarencard%2Fbb1001ac1532dd4225b030cf0cd61ce2&usg=AOvVaw152zgECy_-2g7bjqS0vTaa)\n\nThe post above provides details on how to speed the process up (hint: use GFFs for subsequent MAKER rounds to avoid repeated BLAST-ing. BLAST-ing is one of the slowest parts of the process.) and provides some explanations of how to evaluate the process, as well as how to run BUSCO/Augustus.\n\nThe 3<sup>rd</sup> MAKER Run GFF should contain the most refined gene models. This GFF has individual genes, coding sequences (CDS), mRNAs, and proteins. However, it's a good idea to load all three GFFs in a genome browser and see how they compare.\n\nA run through BUSCO/Augustus gene prediction should refine these models even further and seems to be the standard practice when annotating genomes.\n\nAdditionally, the protein FastA file needs to be subject to BLASTp, as well as run through InterProScan to actually assign functions to the genome.\n\nFinally, MAKER can put all this together and create better sequence ID info in the FastA files _and_ the GFFs (will create NCBI-standardized sequence IDs).\n","srcMarkdownNoYaml":"\nRemarkably, I managed to burn through our [Xsede computing resources](../2018-08-07-genome-annotation-olympia-oyster-genome-using-wq-maker-instance-on-jetstream/index.qmd) and don't have terribly much to show for it. Ooof! This is a major bummer, as it \"only\" takes ~8hrs for a WQ-MAKER job to run there, as opposed to [_months_ the last time I tried running it on Mox](../2018-07-11-mox-olympia-oyster-genome-annotation-progress-using-maker-2-31-10/index.qmd). Although we have used up our Xsede allocation, all is not lost! The experience of setting up/running WQ-MAKER has enlightened me on how it all works and how to run it on Mox so it will (hopefully) take far, far less time than the last Mox attempt. With that said, here we go...\n\nFirstly, I re-installed MAKER (v2.31.10) and configured for OpenMPI support. This is computing jargon that basically allows MAKER to work on a computer cluster efficiently. Now that we have two Mox nodes, I think this will help accelerate the process.\n\nWith that out of the way, here's a _very_ brief overview of the entire MAKER annotation process. Be aware, despite it's \"brevity\", this is still a lengthy read:\n\n1. Create custom repeat library for your organism ([did this with RepeatModeler on 20181022](../2018-10-22-Repeat-Library-Construction---O.lurida-RepeatModeler-v1.0.11/index.qmd))\n\n2. Provide RNAseq data ([transcriptome v3](http://eagle.fish.washington.edu/cnidarian/Olurida_transcriptome_v3.fasta))\n\n3. Provide species-specific and/or related proteomic data (used publicly available proteomes from NCBI for _C.gigas_ [GCA_000297895.1_oyster_v9](ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/000/297/895/GCA_000297895.1_oyster_v9/)) and _C.virginica_ ([GCF_002022765.2_C_virginica-3.0](ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/002/022/765/GCF_002022765.2_C_virginica-3.0/))\n\n4. Run MAKER to produce initial gene models.\n\n5. Merge all the hundred thousands (seriously) of individual GFFs and FastAs in to a singular file of each file type. MAKER has built-in scripts to do this.\n\n6. Generate _ab initio_ gene prediction using [SNAP](https://github.com/KorfLab/SNAP). This is integrated in to MAKER.\n\n7. Run MAKER again, using the SNAP gene models.\n\n8. Merge the new set of GFFs.\n\n9. Run SNAP a second time.\n\n10. Run MAKER a _third_ time using the second set of SNAP gene models.\n\n11. Merge the final set of GFFs.\n\n12. Done???\n\nSo, that's how it's done! Easy!\n\nWith each round of MAKER, a \"control\" file needs to be generated and modified appropriately. Modifications consist of telling MAKER locations of files and whether or not to use certain types of files when producing a new model (e.g. RNAseq data, SNAP HMM file, etc.). Here are the three control files that were used to run MAKER. The links are simply text files, despite their extension, so they can be downloaded and viewed in any text editor, if desired, but I've pasted their contents below for easier review:\n\n\n\n##### ROUND 1 (Initial MAKER run)\n\n- [20181127_oly_maker_genome_annotation/maker_opts.ctl](http://gannet.fish.washington.edu/Atumefaciens/20181127_oly_maker_genome_annotation/maker_opts.ctl)\n\n<pre><code>\n#-----Genome (these are always required)\ngenome=/gscratch/srlab/sam/data/O_lurida/oly_genome_assemblies/Olurida_v081/Olurida_v081.fa #genome sequence (fasta file or fasta embeded in GFF3 file)\norganism_type=eukaryotic #eukaryotic or prokaryotic. Default is eukaryotic\n\n#-----Re-annotation Using MAKER Derived GFF3\nmaker_gff= #MAKER derived GFF3 file\nest_pass=0 #use ESTs in maker_gff: 1 = yes, 0 = no\naltest_pass=0 #use alternate organism ESTs in maker_gff: 1 = yes, 0 = no\nprotein_pass=0 #use protein alignments in maker_gff: 1 = yes, 0 = no\nrm_pass=0 #use repeats in maker_gff: 1 = yes, 0 = no\nmodel_pass=0 #use gene models in maker_gff: 1 = yes, 0 = no\npred_pass=0 #use ab-initio predictions in maker_gff: 1 = yes, 0 = no\nother_pass=0 #passthrough anyything else in maker_gff: 1 = yes, 0 = no\n\n#-----EST Evidence (for best results provide a file for at least one)\nest=/gscratch/srlab/sam/data/O_lurida/oly_transcriptome_assemblies/Olurida_transcriptome_v3.fasta #set of ESTs or assembled mRNA-seq in fasta format\naltest= #EST/cDNA sequence file in fasta format from an alternate organism\nest_gff= #aligned ESTs or mRNA-seq from an external GFF3 file\naltest_gff= #aligned ESTs from a closly relate species in GFF3 format\n\n#-----Protein Homology Evidence (for best results provide a file for at least one)\nprotein=/gscratch/scrubbed/samwhite/outputs/20181127_oly_maker_genome_annotation/gigas_virginica_ncbi_proteomes.fasta  #protein sequence file in fasta format (i.e. from mutiple oransisms)\nprotein_gff=  #aligned protein homology evidence from an external GFF3 file\n\n#-----Repeat Masking (leave values blank to skip repeat masking)\nmodel_org=all #select a model organism for RepBase masking in RepeatMasker\nrmlib=/gscratch/srlab/sam/data/O_lurida/Ostrea_lurida_v081-families.fa #provide an organism specific repeat library in fasta format for RepeatMasker\nrepeat_protein=/gscratch/srlab/programs/maker-2.31.10/data/te_proteins.fasta #provide a fasta file of transposable element proteins for RepeatRunner\nrm_gff= #pre-identified repeat elements from an external GFF3 file\nprok_rm=0 #forces MAKER to repeatmask prokaryotes (no reason to change this), 1 = yes, 0 = no\nsoftmask=1 #use soft-masking rather than hard-masking in BLAST (i.e. seg and dust filtering)\n\n#-----Gene Prediction\nsnaphmm= #SNAP HMM file\ngmhmm= #GeneMark HMM file\naugustus_species= #Augustus gene prediction species model\nfgenesh_par_file= #FGENESH parameter file\npred_gff= #ab-initio predictions from an external GFF3 file\nmodel_gff= #annotated gene models from an external GFF3 file (annotation pass-through)\nest2genome=1 #infer gene predictions directly from ESTs, 1 = yes, 0 = no\nprotein2genome=1 #infer predictions from protein homology, 1 = yes, 0 = no\ntrna=0 #find tRNAs with tRNAscan, 1 = yes, 0 = no\nsnoscan_rrna= #rRNA file to have Snoscan find snoRNAs\nunmask=0 #also run ab-initio prediction programs on unmasked sequence, 1 = yes, 0 = no\n\n#-----Other Annotation Feature Types (features MAKER doesn't recognize)\nother_gff= #extra features to pass-through to final MAKER generated GFF3 file\n\n#-----External Application Behavior Options\nalt_peptide=C #amino acid used to replace non-standard amino acids in BLAST databases\ncpus=1 #max number of cpus to use in BLAST and RepeatMasker (not for MPI, leave 1 when using MPI)\n\n#-----MAKER Behavior Options\nmax_dna_len=100000 #length for dividing up contigs into chunks (increases/decreases memory usage)\nmin_contig=1 #skip genome contigs below this length (under 10kb are often useless)\n\npred_flank=200 #flank for extending evidence clusters sent to gene predictors\npred_stats=0 #report AED and QI statistics for all predictions as well as models\nAED_threshold=1 #Maximum Annotation Edit Distance allowed (bound by 0 and 1)\nmin_protein=0 #require at least this many amino acids in predicted proteins\nalt_splice=0 #Take extra steps to try and find alternative splicing, 1 = yes, 0 = no\nalways_complete=0 #extra steps to force start and stop codons, 1 = yes, 0 = no\nmap_forward=0 #map names and attributes forward from old GFF3 genes, 1 = yes, 0 = no\nkeep_preds=0 #Concordance threshold to add unsupported gene prediction (bound by 0 and 1)\n\nsplit_hit=10000 #length for the splitting of hits (expected max intron size for evidence alignments)\nsingle_exon=0 #consider single exon EST evidence when generating annotations, 1 = yes, 0 = no\nsingle_length=250 #min length required for single exon ESTs if 'single_exon is enabled'\ncorrect_est_fusion=0 #limits use of ESTs in annotation to avoid fusion genes\n\ntries=2 #number of times to try a contig if there is a failure for some reason\nclean_try=0 #remove all data from previous run before retrying, 1 = yes, 0 = no\nclean_up=0 #removes theVoid directory with individual analysis files, 1 = yes, 0 = no\nTMP= #specify a directory other than the system default temporary directory for temporary files\n</code></pre>\n\n\n\n##### ROUND 2 (After initial SNAP run)\n\n- [20181127_oly_maker_genome_annotation/snap01/maker_opts.ctl](http://gannet.fish.washington.edu/Atumefaciens/20181127_oly_maker_genome_annotation/snap01/maker_opts.ctl)\n\n<pre><code>\n#-----Genome (these are always required)\ngenome=/gscratch/srlab/sam/data/O_lurida/oly_genome_assemblies/Olurida_v081/Olurida_v081.fa #genome sequence (fasta file or fasta embeded in GFF3 file)\norganism_type=eukaryotic #eukaryotic or prokaryotic. Default is eukaryotic\n\n#-----Re-annotation Using MAKER Derived GFF3\nmaker_gff= #MAKER derived GFF3 file\nest_pass=0 #use ESTs in maker_gff: 1 = yes, 0 = no\naltest_pass=0 #use alternate organism ESTs in maker_gff: 1 = yes, 0 = no\nprotein_pass=0 #use protein alignments in maker_gff: 1 = yes, 0 = no\nrm_pass=0 #use repeats in maker_gff: 1 = yes, 0 = no\nmodel_pass=0 #use gene models in maker_gff: 1 = yes, 0 = no\npred_pass=0 #use ab-initio predictions in maker_gff: 1 = yes, 0 = no\nother_pass=0 #passthrough anyything else in maker_gff: 1 = yes, 0 = no\n\n#-----EST Evidence (for best results provide a file for at least one)\nest=/gscratch/srlab/sam/data/O_lurida/oly_transcriptome_assemblies/Olurida_transcriptome_v3.fasta #set of ESTs or assembled mRNA-seq in fasta format\naltest= #EST/cDNA sequence file in fasta format from an alternate organism\nest_gff= #aligned ESTs or mRNA-seq from an external GFF3 file\naltest_gff= #aligned ESTs from a closly relate species in GFF3 format\n\n#-----Protein Homology Evidence (for best results provide a file for at least one)\nprotein=/gscratch/scrubbed/samwhite/outputs/20181127_oly_maker_genome_annotation/gigas_virginica_ncbi_proteomes.fasta  #protein sequence file in fasta format (i.e. from mutiple oransisms)\nprotein_gff=  #aligned protein homology evidence from an external GFF3 file\n\n#-----Repeat Masking (leave values blank to skip repeat masking)\nmodel_org=all #select a model organism for RepBase masking in RepeatMasker\nrmlib=/gscratch/srlab/sam/data/O_lurida/Ostrea_lurida_v081-families.fa #provide an organism specific repeat library in fasta format for RepeatMasker\nrepeat_protein=/gscratch/srlab/programs/maker-2.31.10/data/te_proteins.fasta #provide a fasta file of transposable element proteins for RepeatRunner\nrm_gff= #pre-identified repeat elements from an external GFF3 file\nprok_rm=0 #forces MAKER to repeatmask prokaryotes (no reason to change this), 1 = yes, 0 = no\nsoftmask=1 #use soft-masking rather than hard-masking in BLAST (i.e. seg and dust filtering)\n\n#-----Gene Prediction\nsnaphmm=20181127__oly_snap01.hmm #SNAP HMM file\ngmhmm= #GeneMark HMM file\naugustus_species= #Augustus gene prediction species model\nfgenesh_par_file= #FGENESH parameter file\npred_gff= #ab-initio predictions from an external GFF3 file\nmodel_gff= #annotated gene models from an external GFF3 file (annotation pass-through)\nest2genome=0 #infer gene predictions directly from ESTs, 1 = yes, 0 = no\nprotein2genome=0 #infer predictions from protein homology, 1 = yes, 0 = no\ntrna=0 #find tRNAs with tRNAscan, 1 = yes, 0 = no\nsnoscan_rrna= #rRNA file to have Snoscan find snoRNAs\nunmask=0 #also run ab-initio prediction programs on unmasked sequence, 1 = yes, 0 = no\n\n#-----Other Annotation Feature Types (features MAKER doesn't recognize)\nother_gff= #extra features to pass-through to final MAKER generated GFF3 file\n\n#-----External Application Behavior Options\nalt_peptide=C #amino acid used to replace non-standard amino acids in BLAST databases\ncpus=1 #max number of cpus to use in BLAST and RepeatMasker (not for MPI, leave 1 when using MPI)\n\n#-----MAKER Behavior Options\nmax_dna_len=100000 #length for dividing up contigs into chunks (increases/decreases memory usage)\nmin_contig=1 #skip genome contigs below this length (under 10kb are often useless)\n\npred_flank=200 #flank for extending evidence clusters sent to gene predictors\npred_stats=0 #report AED and QI statistics for all predictions as well as models\nAED_threshold=1 #Maximum Annotation Edit Distance allowed (bound by 0 and 1)\nmin_protein=0 #require at least this many amino acids in predicted proteins\nalt_splice=0 #Take extra steps to try and find alternative splicing, 1 = yes, 0 = no\nalways_complete=0 #extra steps to force start and stop codons, 1 = yes, 0 = no\nmap_forward=0 #map names and attributes forward from old GFF3 genes, 1 = yes, 0 = no\nkeep_preds=0 #Concordance threshold to add unsupported gene prediction (bound by 0 and 1)\n\nsplit_hit=10000 #length for the splitting of hits (expected max intron size for evidence alignments)\nsingle_exon=0 #consider single exon EST evidence when generating annotations, 1 = yes, 0 = no\nsingle_length=250 #min length required for single exon ESTs if 'single_exon is enabled'\ncorrect_est_fusion=0 #limits use of ESTs in annotation to avoid fusion genes\n\ntries=2 #number of times to try a contig if there is a failure for some reason\nclean_try=0 #remove all data from previous run before retrying, 1 = yes, 0 = no\nclean_up=0 #removes theVoid directory with individual analysis files, 1 = yes, 0 = no\nTMP= #specify a directory other than the system default temporary directory for temporary files\n</code></pre>\n\n\n\n##### ROUND 3 (After second SNAP run)\n\n- [20181127_oly_maker_genome_annotation/snap02/maker_opts.ctl](http://gannet.fish.washington.edu/Atumefaciens/20181127_oly_maker_genome_annotation/snap02/maker_opts.ctl)\n\n<pre><code>\n#-----Genome (these are always required)\ngenome=/gscratch/srlab/sam/data/O_lurida/oly_genome_assemblies/Olurida_v081/Olurida_v081.fa #genome sequence (fasta file or fasta embeded in GFF3 file)\norganism_type=eukaryotic #eukaryotic or prokaryotic. Default is eukaryotic\n\n#-----Re-annotation Using MAKER Derived GFF3\nmaker_gff= #MAKER derived GFF3 file\nest_pass=0 #use ESTs in maker_gff: 1 = yes, 0 = no\naltest_pass=0 #use alternate organism ESTs in maker_gff: 1 = yes, 0 = no\nprotein_pass=0 #use protein alignments in maker_gff: 1 = yes, 0 = no\nrm_pass=0 #use repeats in maker_gff: 1 = yes, 0 = no\nmodel_pass=0 #use gene models in maker_gff: 1 = yes, 0 = no\npred_pass=0 #use ab-initio predictions in maker_gff: 1 = yes, 0 = no\nother_pass=0 #passthrough anyything else in maker_gff: 1 = yes, 0 = no\n\n#-----EST Evidence (for best results provide a file for at least one)\nest=/gscratch/srlab/sam/data/O_lurida/oly_transcriptome_assemblies/Olurida_transcriptome_v3.fasta #set of ESTs or assembled mRNA-seq in fasta format\naltest= #EST/cDNA sequence file in fasta format from an alternate organism\nest_gff= #aligned ESTs or mRNA-seq from an external GFF3 file\naltest_gff= #aligned ESTs from a closly relate species in GFF3 format\n\n#-----Protein Homology Evidence (for best results provide a file for at least one)\nprotein=/gscratch/scrubbed/samwhite/outputs/20181127_oly_maker_genome_annotation/gigas_virginica_ncbi_proteomes.fasta  #protein sequence file in fasta format (i.e. from mutiple oransisms)\nprotein_gff=  #aligned protein homology evidence from an external GFF3 file\n\n#-----Repeat Masking (leave values blank to skip repeat masking)\nmodel_org=all #select a model organism for RepBase masking in RepeatMasker\nrmlib=/gscratch/srlab/sam/data/O_lurida/Ostrea_lurida_v081-families.fa #provide an organism specific repeat library in fasta format for RepeatMasker\nrepeat_protein=/gscratch/srlab/programs/maker-2.31.10/data/te_proteins.fasta #provide a fasta file of transposable element proteins for RepeatRunner\nrm_gff= #pre-identified repeat elements from an external GFF3 file\nprok_rm=0 #forces MAKER to repeatmask prokaryotes (no reason to change this), 1 = yes, 0 = no\nsoftmask=1 #use soft-masking rather than hard-masking in BLAST (i.e. seg and dust filtering)\n\n#-----Gene Prediction\nsnaphmm=20181127__oly_snap01.hmm #SNAP HMM file\ngmhmm= #GeneMark HMM file\naugustus_species= #Augustus gene prediction species model\nfgenesh_par_file= #FGENESH parameter file\npred_gff= #ab-initio predictions from an external GFF3 file\nmodel_gff= #annotated gene models from an external GFF3 file (annotation pass-through)\nest2genome=0 #infer gene predictions directly from ESTs, 1 = yes, 0 = no\nprotein2genome=0 #infer predictions from protein homology, 1 = yes, 0 = no\ntrna=0 #find tRNAs with tRNAscan, 1 = yes, 0 = no\nsnoscan_rrna= #rRNA file to have Snoscan find snoRNAs\nunmask=0 #also run ab-initio prediction programs on unmasked sequence, 1 = yes, 0 = no\n\n#-----Other Annotation Feature Types (features MAKER doesn't recognize)\nother_gff= #extra features to pass-through to final MAKER generated GFF3 file\n\n#-----External Application Behavior Options\nalt_peptide=C #amino acid used to replace non-standard amino acids in BLAST databases\ncpus=1 #max number of cpus to use in BLAST and RepeatMasker (not for MPI, leave 1 when using MPI)\n\n#-----MAKER Behavior Options\nmax_dna_len=100000 #length for dividing up contigs into chunks (increases/decreases memory usage)\nmin_contig=1 #skip genome contigs below this length (under 10kb are often useless)\n\npred_flank=200 #flank for extending evidence clusters sent to gene predictors\npred_stats=0 #report AED and QI statistics for all predictions as well as models\nAED_threshold=1 #Maximum Annotation Edit Distance allowed (bound by 0 and 1)\nmin_protein=0 #require at least this many amino acids in predicted proteins\nalt_splice=0 #Take extra steps to try and find alternative splicing, 1 = yes, 0 = no\nalways_complete=0 #extra steps to force start and stop codons, 1 = yes, 0 = no\nmap_forward=0 #map names and attributes forward from old GFF3 genes, 1 = yes, 0 = no\nkeep_preds=0 #Concordance threshold to add unsupported gene prediction (bound by 0 and 1)\n\nsplit_hit=10000 #length for the splitting of hits (expected max intron size for evidence alignments)\nsingle_exon=0 #consider single exon EST evidence when generating annotations, 1 = yes, 0 = no\nsingle_length=250 #min length required for single exon ESTs if 'single_exon is enabled'\ncorrect_est_fusion=0 #limits use of ESTs in annotation to avoid fusion genes\n\ntries=2 #number of times to try a contig if there is a failure for some reason\nclean_try=0 #remove all data from previous run before retrying, 1 = yes, 0 = no\nclean_up=0 #removes theVoid directory with individual analysis files, 1 = yes, 0 = no\nTMP= #specify a directory other than the system default temporary directory for temporary files\n[samwhite@mox1 snap01]$ cd ../snap02\n[samwhite@mox1 snap02]$ cat maker_opts.ctl\n#-----Genome (these are always required)\ngenome=/gscratch/srlab/sam/data/O_lurida/oly_genome_assemblies/Olurida_v081/Olurida_v081.fa #genome sequence (fasta file or fasta embeded in GFF3 file)\norganism_type=eukaryotic #eukaryotic or prokaryotic. Default is eukaryotic\n\n#-----Re-annotation Using MAKER Derived GFF3\nmaker_gff= #MAKER derived GFF3 file\nest_pass=0 #use ESTs in maker_gff: 1 = yes, 0 = no\naltest_pass=0 #use alternate organism ESTs in maker_gff: 1 = yes, 0 = no\nprotein_pass=0 #use protein alignments in maker_gff: 1 = yes, 0 = no\nrm_pass=0 #use repeats in maker_gff: 1 = yes, 0 = no\nmodel_pass=0 #use gene models in maker_gff: 1 = yes, 0 = no\npred_pass=0 #use ab-initio predictions in maker_gff: 1 = yes, 0 = no\nother_pass=0 #passthrough anyything else in maker_gff: 1 = yes, 0 = no\n\n#-----EST Evidence (for best results provide a file for at least one)\nest=/gscratch/srlab/sam/data/O_lurida/oly_transcriptome_assemblies/Olurida_transcriptome_v3.fasta #set of ESTs or assembled mRNA-seq in fasta format\naltest= #EST/cDNA sequence file in fasta format from an alternate organism\nest_gff= #aligned ESTs or mRNA-seq from an external GFF3 file\naltest_gff= #aligned ESTs from a closly relate species in GFF3 format\n\n#-----Protein Homology Evidence (for best results provide a file for at least one)\nprotein=/gscratch/scrubbed/samwhite/outputs/20181127_oly_maker_genome_annotation/gigas_virginica_ncbi_proteomes.fasta  #protein sequence file in fasta format (i.e. from mutiple oransisms)\nprotein_gff=  #aligned protein homology evidence from an external GFF3 file\n\n#-----Repeat Masking (leave values blank to skip repeat masking)\nmodel_org=all #select a model organism for RepBase masking in RepeatMasker\nrmlib=/gscratch/srlab/sam/data/O_lurida/Ostrea_lurida_v081-families.fa #provide an organism specific repeat library in fasta format for RepeatMasker\nrepeat_protein=/gscratch/srlab/programs/maker-2.31.10/data/te_proteins.fasta #provide a fasta file of transposable element proteins for RepeatRunner\nrm_gff= #pre-identified repeat elements from an external GFF3 file\nprok_rm=0 #forces MAKER to repeatmask prokaryotes (no reason to change this), 1 = yes, 0 = no\nsoftmask=1 #use soft-masking rather than hard-masking in BLAST (i.e. seg and dust filtering)\n\n#-----Gene Prediction\nsnaphmm=20181127__oly_snap02.hmm #SNAP HMM file\ngmhmm= #GeneMark HMM file\naugustus_species= #Augustus gene prediction species model\nfgenesh_par_file= #FGENESH parameter file\npred_gff= #ab-initio predictions from an external GFF3 file\nmodel_gff= #annotated gene models from an external GFF3 file (annotation pass-through)\nest2genome=0 #infer gene predictions directly from ESTs, 1 = yes, 0 = no\nprotein2genome=0 #infer predictions from protein homology, 1 = yes, 0 = no\ntrna=0 #find tRNAs with tRNAscan, 1 = yes, 0 = no\nsnoscan_rrna= #rRNA file to have Snoscan find snoRNAs\nunmask=0 #also run ab-initio prediction programs on unmasked sequence, 1 = yes, 0 = no\n\n#-----Other Annotation Feature Types (features MAKER doesn't recognize)\nother_gff= #extra features to pass-through to final MAKER generated GFF3 file\n\n#-----External Application Behavior Options\nalt_peptide=C #amino acid used to replace non-standard amino acids in BLAST databases\ncpus=1 #max number of cpus to use in BLAST and RepeatMasker (not for MPI, leave 1 when using MPI)\n\n#-----MAKER Behavior Options\nmax_dna_len=100000 #length for dividing up contigs into chunks (increases/decreases memory usage)\nmin_contig=1 #skip genome contigs below this length (under 10kb are often useless)\n\npred_flank=200 #flank for extending evidence clusters sent to gene predictors\npred_stats=0 #report AED and QI statistics for all predictions as well as models\nAED_threshold=1 #Maximum Annotation Edit Distance allowed (bound by 0 and 1)\nmin_protein=0 #require at least this many amino acids in predicted proteins\nalt_splice=0 #Take extra steps to try and find alternative splicing, 1 = yes, 0 = no\nalways_complete=0 #extra steps to force start and stop codons, 1 = yes, 0 = no\nmap_forward=0 #map names and attributes forward from old GFF3 genes, 1 = yes, 0 = no\nkeep_preds=0 #Concordance threshold to add unsupported gene prediction (bound by 0 and 1)\n\nsplit_hit=10000 #length for the splitting of hits (expected max intron size for evidence alignments)\nsingle_exon=0 #consider single exon EST evidence when generating annotations, 1 = yes, 0 = no\nsingle_length=250 #min length required for single exon ESTs if 'single_exon is enabled'\ncorrect_est_fusion=0 #limits use of ESTs in annotation to avoid fusion genes\n\ntries=2 #number of times to try a contig if there is a failure for some reason\nclean_try=0 #remove all data from previous run before retrying, 1 = yes, 0 = no\nclean_up=0 #removes theVoid directory with individual analysis files, 1 = yes, 0 = no\nTMP= #specify a directory other than the system default temporary directory for temporary files\n</code></pre>\n\n\n\n\n\nHere's the SBATCH script (plain text file) used to actually run this job:\n\n- [20181127_oly_maker_genome_annotation/20181127_oly_maker_genome_annotation.sh](http://gannet.fish.washington.edu/Atumefaciens/20181127_oly_maker_genome_annotation/20181127_oly_maker_genome_annotation.sh)\n\n<pre><code>\n#!/bin/bash\n## Job Name\n#SBATCH --job-name=20181127_oly_maker_genome_annotation\n## Allocation Definition\n#SBATCH --account=srlab\n#SBATCH --partition=srlab\n## Resources\n## Nodes\n#SBATCH --nodes=2\n## Walltime (days-hours:minutes:seconds format)\n#SBATCH --time=15-00:00:00\n## Memory per node\n#SBATCH --mem=120G\n##turn on e-mail notification\n#SBATCH --mail-type=ALL\n#SBATCH --mail-user=samwhite@uw.edu\n## Specify the working directory for this job\n#SBATCH --workdir=/gscratch/scrubbed/samwhite/outputs/20181127_oly_maker_genome_annotation\n\n# Load Python Mox module for Python module availability\n\nmodule load intel-python3_2017\n\n# Load Open MPI module for parallel, multi-node processing\n\nmodule load icc_19-ompi_3.1.2\n\n# SegFault fix?\nexport THREADS_DAEMON_MODEL=1\n\n# Document programs in PATH (primarily for program version ID)\n\ndate >> system_path.log\necho \"\" >> system_path.log\necho \"System PATH for $SLURM_JOB_ID\" >> system_path.log\necho \"\" >> system_path.log\nprintf \"%0.s-\" {1..10} >> system_path.log\necho ${PATH} | tr : \\\\n >> system_path.log\n\n## Establish variables for more readable code\n\n### Paths to Maker binaries\nmaker=/gscratch/srlab/programs/maker-2.31.10/bin/maker\ngff3_merge=/gscratch/srlab/programs/maker-2.31.10/bin/gff3_merge\nfasta_merge=/gscratch/srlab/programs/maker-2.31.10/bin/fasta_merge\nmaker2zff=/gscratch/srlab/programs/maker-2.31.10/bin/maker2zff\nfathom=/gscratch/srlab/programs/maker-2.31.10/exe/snap/fathom\nforge=/gscratch/srlab/programs/maker-2.31.10/exe/snap/forge\nhmmassembler=/gscratch/srlab/programs/maker-2.31.10/exe/snap/hmm-assembler.pl\n\n### Path to Olympia oyster genome FastA file\noly_genome=/gscratch/srlab/sam/data/O_lurida/oly_genome_assemblies/Olurida_v081/Olurida_v081.fa\n\n### Path to Olympia oyster transcriptome FastA file\noly_transcriptome=/gscratch/srlab/sam/data/O_lurida/oly_transcriptome_assemblies/Olurida_transcriptome_v3.fasta\n\n### Path to Crassotrea gigas NCBI protein FastA\ngigas_proteome=/gscratch/srlab/sam/data/C_gigas/gigas_ncbi_protein/GCA_000297895.1_oyster_v9_protein.faa\n\n### Path to Crassostrea virginica NCBI protein FastA\nvirginica_proteome=/gscratch/srlab/sam/data/C_virginica/virginica_ncbi_protein/GCF_002022765.2_C_virginica-3.0_protein.faa\n\n### Path to concatenated NCBI prteins FastA\ngigas_virginica_ncbi_proteomes=/gscratch/scrubbed/samwhite/outputs/20181127_oly_maker_genome_annotation/gigas_virginica_ncbi_proteomes.fasta\n\n### Path to O.lurida-specific repeat library\noly_repeat_library=/gscratch/srlab/sam/data/O_lurida/Ostrea_lurida_v081-families.fa\n\n## Create Maker control files needed for running Maker\n$maker -CTL\n\n## Store path to options control file\nmaker_opts_file=./maker_opts.ctl\n\n## Create combined proteome FastA file, only if it doesn't already exist.\nif [ ! -e gigas_virginica_ncbi_proteomes.fasta ]; then\n    touch gigas_virginica_ncbi_proteomes.fasta\n    cat \"$gigas_proteome\" >> gigas_virginica_ncbi_proteomes.fasta\n    cat \"$virginica_proteome\" >> gigas_virginica_ncbi_proteomes.fasta\nfi\n\n## Edit options file\n\n### Set paths to O.lurida genome and transcriptome.\n### Set path to combined C. gigas and C.virginica proteomes.\n## The use of the % symbol sets the delimiter sed uses for arguments.\n## Normally, the delimiter that most examples use is a slash \"/\".\n## But, we need to expand the variables into a full path with slashes, which screws up sed.\n## Thus, the use of % symbol instead (it could be any character that is NOT present in the expanded variable; doesn't have to be \"%\").\nsed -i \"/^genome=/ s% %$oly_genome %\" \"$maker_opts_file\"\nsed -i \"/^est=/ s% %$oly_transcriptome %\" \"$maker_opts_file\"\nsed -i \"/^protein=/ s% %$gigas_virginica_ncbi_proteomes %\" \"$maker_opts_file\"\nsed -i \"/^rmlib=/ s% %$oly_repeat_library %\" \"$maker_opts_file\"\nsed -i \"/^est2genome=0/ s/est2genome=0/est2genome=1/\" \"$maker_opts_file\"\nsed -i \"/^protein2genome=0/ s/protein2genome=0/protein2genome=1/\" \"$maker_opts_file\"\n\n## Run Maker\n### Specify number of nodes to use.\nmpiexec -n 56 $maker\n\n## Merge gffs\n${gff3_merge} -d Olurida_v081.maker.output/Olurida_v081_master_datastore_index.log\n\n## GFF with no FastA in footer\n${gff3_merge} -n -s -d Olurida_v081.maker.output/Olurida_v081_master_datastore_index.log > Olurida_v081.maker.all.noseqs.gff\n\n## Merge all FastAs\n${fasta_merge} -d Olurida_v081.maker.output/Olurida_v081_master_datastore_index.log\n\n## Run SNAP training, round 1\nmkdir snap01 && cd snap01\n${maker2zff} ../Olurida_v081.all.gff\n${fathom} -categorize 1000 genome.ann genome.dna\n${fathom} -export 1000 -plus uni.ann uni.dna\n${forge} export.ann export.dna\n${hmmassembler} test_snap1 . > 20181127__oly_snap01.hmm\n\n## Initiate second Maker run.\n### Copy initial maker control files and\n### - change gene prediction settings to 0 (i.e. don't generate Maker gene predictions)\n### - set location of snaphmm file to use for gene prediction\ncp ../maker_* .\nsed -i \"/^est2genome=1/ s/est2genome=1/est2genome=0/\" maker_opts.ctl\nsed -i \"/^protein2genome=1/ s/protein2genome=1/protein2genome=0/\" maker_opts.ctl\nsed -i \"/^snaphmm=/ s% %20181127__oly_snap01.hmm %\" maker_opts.ctl\n\n## Run Maker\n### Set basename of files and specify number of CPUs to use\nmpiexec -n 56 $maker \\\n-base 20181127_oly_genome_snap01\n\n## Merge gffs\n${gff3_merge} -d 20181127_oly_genome_snap01.maker.output/20181127_oly_genome_snap01_master_datastore_index.log\n\n### GFF with no FastA in footer\n${gff3_merge} -n -s -d 20181127_oly_genome_snap01.maker.output/20181127_oly_genome_snap01_master_datastore_index.log > 20181127_oly_genome_snap01.all.noseqs.gff\n\n### Merge all FastAs\n${fasta_merge} -d 20181127_oly_genome_snap01.maker.output/20181127_oly_genome_snap01_master_datastore_index.log\n\n## Run SNAP training, round 2\ncd ..\nmkdir snap02 && cd snap02\n${maker2zff} ../snap01/20181127_oly_genome_snap01.all.gff\n${fathom} -categorize 1000 genome.ann genome.dna\n${fathom} -export 1000 -plus uni.ann uni.dna\n${forge} export.ann export.dna\n${hmmassembler} test_snap1 . > 20181127__oly_snap02.hmm\n\n## Initiate third and final Maker run.\n### Copy initial maker control files and:\n### - change gene prediction settings to 0 (i.e. don't generate Maker gene predictions)\n### - set location of snaphmm file to use for gene prediction\ncp ../maker_* .\nsed -i \"/^est2genome=1/ s/est2genome=1/est2genome=0/\" maker_opts.ctl\nsed -i \"/^protein2genome=1/ s/protein2genome=1/protein2genome=0/\" maker_opts.ctl\nsed -i \"/^snaphmm=/ s% %20181127__oly_snap02.hmm %\" maker_opts.ctl\n\n## Run Maker\n### Set basename of files and specify number of CPUs to use\nmpiexec -n 56 $maker \\\n-base 20181127_oly_genome_snap02\n\n## Merge gffs\n${gff3_merge} \\\n-d 20181127_oly_genome_snap02.maker.output/20181127_oly_genome_snap02_master_datastore_index.log\n\n### GFF with no FastA in footer\n{gff3_merge} -n -s -d 20181127_oly_genome_snap02.maker.output/20181127_oly_genome_snap02_master_datastore_index.log > 20181127_oly_genome_snap02.all.noseqs.gff\n\n### Merge all FastAs\n${fasta_merge} -d 20181127_oly_genome_snap02.maker.output/20181127_oly_genome_snap02_master_datastore_index.log\n</code></pre>\n\n\nWe'll see how this goes...\n\n---\n\n# RESULTS\n\nThis actually completed, and in a reasonable (relatively) amount of time (2 weeks)!\n\n![](https://gannet.fish.washington.edu/Atumefaciens/images/20181210_mox_maker_complete.png)\n\nAll files were ```rsync```'d to my folder on Gannet.\n\nOutput directory:\n\n- [20181127_oly_maker_genome_annotation/](https://gannet.fish.washington.edu/Atumefaciens/20181127_oly_maker_genome_annotation/)\n\nHere are some of the key output files:\n\n##### MAKER Protein FastA\n- [20181127_oly_maker_genome_annotation/Olurida_v081.all.maker.proteins.fasta(9.3MB)](https://gannet.fish.washington.edu/Atumefaciens/20181127_oly_maker_genome_annotation/Olurida_v081.all.maker.proteins.fasta)\n\n##### MAKER Transcripts FastAs\n- [20181127_oly_maker_genome_annotation/Olurida_v081.all.maker.transcripts.fasta (28MB)](https://gannet.fish.washington.edu/Atumefaciens/20181127_oly_maker_genome_annotation/Olurida_v081.all.maker.transcripts.fasta)\n\n##### Initial MAKER Run GFF3\n\n- [20181127_oly_maker_genome_annotation/Olurida_v081.maker.all.noseqs.gff  (1.1GB)](https://gannet.fish.washington.edu/Atumefaciens/20181127_oly_maker_genome_annotation/Olurida_v081.maker.all.noseqs.gff)\n\n\n##### 2<sup>nd</sup> MAKER Run GFF (after 1<sup>st</sup> SNAP)\n\n- [20181127_oly_maker_genome_annotation/snap01/20181127_oly_genome_snap01.all.noseqs.gff (1.2GB)](https://gannet.fish.washington.edu/Atumefaciens/20181127_oly_maker_genome_annotation/snap01/20181127_oly_genome_snap01.all.noseqs.gff)\n\n##### 3<sup>rd</sup> MAKER Run GFF (after 2<sup>nd</sup> SNAP)\n\n- [20181127_oly_maker_genome_annotation/snap02/20181127_oly_genome_snap02.all.noseqs.gff](https://gannet.fish.washington.edu/Atumefaciens/20181127_oly_maker_genome_annotation/snap02/20181127_oly_genome_snap02.all.noseqs.gff)\n\n\nSo, what to do with all of this?\n\nFirstly, I've learned a lot about how all of this should work and recently discovered this remarkably informative GitHub Gist that walks through the process of annotating a snake genome:\n\n- [In-depth description of running MAKER for genome annotation.](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=29&cad=rja&uact=8&ved=2ahUKEwjph4b1ibLfAhUMFnwKHRofDboQFjAcegQICxAB&url=https%3A%2F%2Fgist.github.com%2Fdarencard%2Fbb1001ac1532dd4225b030cf0cd61ce2&usg=AOvVaw152zgECy_-2g7bjqS0vTaa)\n\nThe post above provides details on how to speed the process up (hint: use GFFs for subsequent MAKER rounds to avoid repeated BLAST-ing. BLAST-ing is one of the slowest parts of the process.) and provides some explanations of how to evaluate the process, as well as how to run BUSCO/Augustus.\n\nThe 3<sup>rd</sup> MAKER Run GFF should contain the most refined gene models. This GFF has individual genes, coding sequences (CDS), mRNAs, and proteins. However, it's a good idea to load all three GFFs in a genome browser and see how they compare.\n\nA run through BUSCO/Augustus gene prediction should refine these models even further and seems to be the standard practice when annotating genomes.\n\nAdditionally, the protein FastA file needs to be subject to BLASTp, as well as run through InterProScan to actually assign functions to the genome.\n\nFinally, MAKER can put all this together and create better sequence ID info in the FastA files _and_ the GFFs (will create NCBI-standardized sequence IDs).\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../../styles.css"],"toc":true,"toc-depth":5,"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","editor":"source","theme":"darkly","page-layout":"full","code-background":true,"code-copy":true,"title-block-banner":true,"author":"Sam White","toc-title":"Contents","toc-location":"left","layout":"post","title":"Annotation - Olurida_v081 MAKER on Mox","date":"2018-11-27 14:40","categories":["Ostrea lurida","Olympia oyster","mox","MAKER","genome annotation","Olurida_v081","2018","Olympia Oyster Genome Sequencing"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}