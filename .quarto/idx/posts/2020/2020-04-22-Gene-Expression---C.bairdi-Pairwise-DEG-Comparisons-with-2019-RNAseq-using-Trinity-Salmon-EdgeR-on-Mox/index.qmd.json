{"title":"Gene Expression - C.bairdi Pairwise DEG Comparisons with 2019 RNAseq using Trinity-Salmon-EdgeR on Mox","markdown":{"yaml":{"author":"Sam White","toc-title":"Contents","toc-depth":5,"toc-location":"left","layout":"post","title":"Gene Expression - C.bairdi Pairwise DEG Comparisons with 2019 RNAseq using Trinity-Salmon-EdgeR on Mox","date":"2020-04-22 16:55","tags":["Chionoecetes bairdi","Tanner crab","GO","gene ontology","enrichment","EdgeR","Trinity","Salmon","mox","RNAseq"],"categories":["2020","Miscellaneous"]},"headingText":"Job Name","containsRefs":false,"markdown":"\nPer [a Slack request](https://genefish.slack.com/archives/D02MJDL5Y/p1587393166000200), Steven asked me to take the [Genewize RNAseq data (received 2020318)](https://robertslab.github.io/sams-notebook/posts/2020/2020-03-18-Data-Received-C.bairdi-RNAseq-Data-from-Genewiz/) through [edgeR](https://bioconductor.org/packages/release/bioc/html/edgeR/). Ran the analysis using the Trinity differential expression pipeline:\n\n- [Salmon alignment-free transcript quantification](https://github.com/trinityrnaseq/trinityrnaseq/wiki/Trinity-Transcript-Quantification)\n\n- [edgeR differential expression](https://github.com/trinityrnaseq/trinityrnaseq/wiki/Trinity-Differential-Expression)\n\nHere're the core input files used for this analysis:\n\n- Transcriptome: [cbai_transcriptome_v1.5.fasta](https://owl.fish.washington.edu/halfshell/genomic-databank/cbai_transcriptome_v1.5.fasta)\n\n- MEGAN6 _Arthropoda_ taxonomic reads: [20200413_C_bairdi_megan_reads/](https://gannet.fish.washington.edu/Atumefaciens/20200413_C_bairdi_megan_reads/)\n\nThe analyses will perform the following pairwise comparisons:\n\n- infected-uninfected\n\n- D9-D12\n\n- D9-D26\n\n- D12-D26\n\n- ambient-cold\n\n- ambient-warm\n\n- cold-warm\n\nIt will identify differentially expressed genes with >=2-fold log change in expression and a false discovery rate of <=0.05. Additionally, it will perform gene ontology (GO) enrichment analysis using GOseq.\n\nAs a brief aside, I'm pretty stoked about the SBATCH script below! It automates FastQ file selection for each comparison, creates appropriately named subdirectories and creates proper Trinity samples list file needed.\n\nAfter running the DEG analysis, I \"flattened\" the enriched GO terms files for later use in R to map these GO terms to GOslims. That was run separately and the script is after the SBATCH script.\n\nSBATCH script (GitHub):\n\n- [20200422_cbai_DEG_basic_comparisons.sh](https://github.com/RobertsLab/sams-notebook/blob/master/sbatch_scripts/20200422_cbai_DEG_basic_comparisons.sh)\n\n\n```shell\n#!/bin/bash\n#SBATCH --job-name=cbai_DEG_basic\n## Allocation Definition\n#SBATCH --account=coenv\n#SBATCH --partition=coenv\n## Resources\n## Nodes\n#SBATCH --nodes=1\n## Walltime (days-hours:minutes:seconds format)\n#SBATCH --time=10-00:00:00\n## Memory per node\n#SBATCH --mem=120G\n##turn on e-mail notification\n#SBATCH --mail-type=ALL\n#SBATCH --mail-user=samwhite@uw.edu\n## Specify the working directory for this job\n#SBATCH --chdir=/gscratch/scrubbed/samwhite/outputs/20200422_cbai_DEG_basic_comparisons\n\n# This is a script to identify differentially expressed genes (DEGs) in C.bairdi\n# using pairwise comparisions of from just the \"2020-GW\" (i.e. just Genewiz) RNAseq data\n# which has been taxonomically selected for all Arthropoda reads. See Sam's notebook from 20200419\n# https://robertslab.github.io/sams-notebook\n\n# Script will run Trinity's builtin differential gene expression analysis using:\n# - Salmon alignment-free transcript abundance estimation\n# - edgeR\n# Cutoffs of 2-fold difference in expression and FDR of <=0.05.\n\n###################################################################################\n# These variables need to be set by user\nfastq_dir=\"/gscratch/srlab/sam/data/C_bairdi/RNAseq/\"\nfasta_prefix=\"20200408.C_bairdi.megan.Trinity\"\ntranscriptome_dir=\"/gscratch/srlab/sam/data/C_bairdi/transcriptomes\"\ntrinotate_feature_map=\"${transcriptome_dir}/20200409.cbai.trinotate.annotation_feature_map.txt\"\ngo_annotations=\"${transcriptome_dir}/20200409.cbai.trinotate.go_annotations.txt\"\n\n# Array of the various comparisons to evaluate\n# Each condition in each comparison should be separated by a \"-\"\ncomparisons_array=(\ninfected-uninfected \\\nD9-D12 \\\nD9-D26 \\\nD12-D26 \\\nambient-cold \\\nambient-warm \\\ncold-warm\n)\n\n# Functions\n# Expects input (i.e. \"$1\") to be in the following format:\n# e.g. 20200413.C_bairdi.113.D9.uninfected.cold.megan_R2.fq\nget_day () { day=$(echo \"$1\" | awk -F\".\" '{print $4}'); }\nget_inf () { inf=$(echo \"$1\" | awk -F\".\" '{print $5}'); }\nget_temp () { temp=$(echo \"$1\" | awk -F\".\" '{print $6}'); }\n\n###################################################################################\n\n# Exit script if any command fails\nset -e\n\n# Load Python Mox module for Python module availability\n\nmodule load intel-python3_2017\n\n# Document programs in PATH (primarily for program version ID)\n\n{\ndate\necho \"\"\necho \"System PATH for $SLURM_JOB_ID\"\necho \"\"\nprintf \"%0.s-\" {1..10}\necho \"${PATH}\" | tr : \\\\n\n} >> system_path.log\n\n\nwd=\"$(pwd)\"\nthreads=28\n\n\n## Designate input file locations\ntranscriptome=\"${transcriptome_dir}/${fasta_prefix}.fasta\"\nfasta_seq_lengths=\"${transcriptome_dir}/${fasta_prefix}.fasta.seq_lens\"\ngene_map=\"${transcriptome_dir}/${fasta_prefix}.fasta.gene_trans_map\"\ntranscriptome=\"${transcriptome_dir}/${fasta_prefix}.fasta\"\n\n\n# Standard output/error files\ndiff_expr_stdout=\"diff_expr_stdout.txt\"\ndiff_expr_stderr=\"diff_expr_stderr.txt\"\nmatrix_stdout=\"matrix_stdout.txt\"\nmatrix_stderr=\"matrix_stderr.txt\"\nsalmon_stdout=\"salmon_stdout.txt\"\nsalmon_stderr=\"salmon_stderr.txt\"\ntpm_length_stdout=\"tpm_length_stdout.txt\"\ntpm_length_stderr=\"tpm_length_stderr.txt\"\ntrinity_DE_stdout=\"trinity_DE_stdout.txt\"\ntrinity_DE_stderr=\"trinity_DE_stderr.txt\"\n\nedgeR_dir=\"\"\n\n#programs\ntrinity_home=/gscratch/srlab/programs/trinityrnaseq-v2.9.0\ntrinity_annotate_matrix=\"${trinity_home}/Analysis/DifferentialExpression/rename_matrix_feature_identifiers.pl\"\ntrinity_abundance=${trinity_home}/util/align_and_estimate_abundance.pl\ntrinity_matrix=${trinity_home}/util/abundance_estimates_to_matrix.pl\ntrinity_DE=${trinity_home}/Analysis/DifferentialExpression/run_DE_analysis.pl\ndiff_expr=${trinity_home}/Analysis/DifferentialExpression/analyze_diff_expr.pl\ntrinity_tpm_length=${trinity_home}/util/misc/TPM_weighted_gene_length.py\n\n# Loop through each comparison\n# Will create comparison-specific direcctories and copy\n# appropriate FastQ files for each comparison.\n\n# After file transfer, will create necessary sample list file for use\n# by Trinity for running differential gene expression analysis and GO enrichment.\nfor comparison in \"${!comparisons_array[@]}\"\ndo\n\n  # Assign variables\n  cond1_count=0\n  cond2_count=0\n  comparison=${comparisons_array[${comparison}]}\n  comparison_dir=${wd}/${comparison}\n  salmon_gene_matrix=${comparison_dir}/salmon.gene.TMM.EXPR.matrix\n  salmon_iso_matrix=${comparison_dir}/salmon.isoform.TMM.EXPR.matrix\n  samples=${comparison_dir}${comparison}.samples.txt\n\n  # Extract each comparison from comparisons array\n  # Conditions must be separated by a \"-\"\n  cond1=$(echo \"${comparison}\" | awk -F\"-\" '{print $1}')\n  cond2=$(echo \"${comparison}\" | awk -F\"-\" '{print $2}')\n\n\n  mkdir --parents \"${comparison}\"\n\n  cd \"${comparison}\" || exit\n\n  # Series of if statements to identify which FastQ files to rsync to working directory\n  if [[ \"${comparison}\" == \"infected-uninfected\" ]]; then\n    rsync --archive --verbose ${fastq_dir}*.fq .\n  fi\n\n  if [[ \"${comparison}\" == \"D9-D12\" ]]; then\n    for fastq in \"${fastq_dir}\"*.fq\n    do\n      get_day \"${fastq}\"\n      if [[ \"${day}\" == \"D9\" || \"${day}\" == \"D12\" ]]; then\n        rsync --archive --verbose \"${fastq}\" .\n      fi\n    done\n  fi\n\n  if [[ \"${comparison}\" == \"D9-D26\" ]]; then\n    for fastq in \"${fastq_dir}\"*.fq\n    do\n      get_day \"${fastq}\"\n      if [[ \"${day}\" == \"D9\" || \"${day}\" == \"D26\" ]]; then\n        rsync --archive --verbose \"${fastq}\" .\n      fi\n    done\n  fi\n\n  if [[ \"${comparison}\" == \"D12-D26\" ]]; then\n    for fastq in \"${fastq_dir}\"*.fq\n    do\n      get_day \"${fastq}\"\n      if [[ \"${day}\" == \"D12\" || \"${day}\" == \"D26\" ]]; then\n        rsync --archive --verbose \"${fastq}\" .\n      fi\n    done\n  fi\n\n  if [[ \"${comparison}\" == \"ambient-cold\" ]]; then\n    #statements\n    for fastq in \"${fastq_dir}\"*.fq\n    do\n      get_temp \"${fastq}\"\n      if [[ \"${temp}\" == \"ambient\" || \"${temp}\" == \"cold\" ]]; then\n        rsync --archive --verbose \"${fastq}\" .\n      fi\n    done\n  fi\n\n  if [[ \"${comparison}\" == \"ambient-warm\" ]]; then\n    for fastq in \"${fastq_dir}\"*.fq\n    do\n      get_temp \"${fastq}\"\n      if [[ \"${temp}\" == \"ambient\" || \"${temp}\" == \"warm\" ]]; then\n        rsync --archive --verbose \"${fastq}\" .\n      fi\n    done\n  fi\n\n  if [[ \"${comparison}\" == \"cold-warm\" ]]; then\n    for fastq in \"${fastq_dir}\"*.fq\n    do\n      get_temp \"${fastq}\"\n      if [[ \"${temp}\" == \"cold\" || \"${temp}\" == \"warm\" ]]; then\n        rsync --archive --verbose \"${fastq}\" .\n      fi\n    done\n  fi\n\n  # Create reads array\n  # Paired reads files will be sequentially listed in array (e.g. 111_R1 111_R2)\n  reads_array=(*.fq)\n\n  echo \"\"\n  echo \"Created reads_array\"\n\n  # Loop to create sample list file\n  # Sample file list is tab-delimited like this:\n\n  # cond_A    cond_A_rep1    A_rep1_left.fq    A_rep1_right.fq\n  # cond_A    cond_A_rep2    A_rep2_left.fq    A_rep2_right.fq\n  # cond_B    cond_B_rep1    B_rep1_left.fq    B_rep1_right.fq\n  # cond_B    cond_B_rep2    B_rep2_left.fq    B_rep2_right.fq\n\n\n\n  # Increment by 2 to process next pair of FastQ files\n  for (( i=0; i<${#reads_array[@]} ; i+=2 ))\n  do\n    echo \"\"\n    echo \"Evaluating ${reads_array[i]} and ${reads_array[i+1]}\"\n    get_day \"${reads_array[i]}\"\n    get_inf \"${reads_array[i]}\"\n    get_temp \"${reads_array[i]}\"\n\n    echo \"\"\n    echo \"Got day (${day}), infection status (${inf}), and temp (${temp}).\"\n    echo \"\"\n    echo \"Condition 1 is: ${cond1}\"\n    echo \"condition 2 is: ${cond2}\"\n\n    # Evaluate specified treatment conditions and format sample file list appropriately.\n    if [[ \"${cond1}\" == \"${day}\" || \"${cond1}\" == \"${inf}\" || \"${cond1}\" == \"${temp}\" ]]; then\n      cond1_count=$((cond1_count+1))\n\n\n      echo \"\"\n      echo \"Condition 1 evaluated.\"\n      # Create tab-delimited samples file.\n      printf \"%s\\t%s%02d\\t%s\\t%s\\n\" \"${cond1}\" \"${cond1}_\" \"${cond1_count}\" \"${comparison_dir}${reads_array[i]}\" \"${comparison_dir}${reads_array[i+1]}\" \\\n      >> \"${samples}\"\n    elif [[ \"${cond2}\" == \"${day}\" || \"${cond2}\" == \"${inf}\" || \"${cond2}\" == \"${temp}\" ]]; then\n      cond2_count=$((cond2_count+1))\n\n\n      echo \"\"\n      echo \"Condition 2 evaluated.\"\n      # Create tab-delimited samples file.\n      printf \"%s\\t%s%02d\\t%s\\t%s\\n\" \"${cond2}\" \"${cond2}_\" \"${cond2_count}\" \"${comparison_dir}${reads_array[i]}\" \"${comparison_dir}${reads_array[i+1]}\" \\\n      >> \"${samples}\"\n    fi\n\n    # Copy sample list file to transcriptome directory\n    cp \"${samples}\" \"${transcriptome_dir}\"\n  done\n\n  echo \"Created ${comparison} sample list file.\"\n\n\n  # Create directory/sample list for ${trinity_matrix} command\n  trin_matrix_list=$(awk '{printf \"%s%s\", $2, \"/quant.sf \" }' \"${samples}\")\n\n\n  # Determine transcript abundances using Salmon alignment-free\n  # abundance estimate.\n  ${trinity_abundance} \\\n  --output_dir \"${comparison_dir}\" \\\n  --transcripts ${transcriptome} \\\n  --seqType fq \\\n  --samples_file \"${samples}\" \\\n  --est_method salmon \\\n  --aln_method bowtie2 \\\n  --gene_trans_map \"${gene_map}\" \\\n  --prep_reference \\\n  --thread_count \"${threads}\" \\\n  1> \"${comparison_dir}\"${salmon_stdout} \\\n  2> \"${comparison_dir}\"${salmon_stderr}\n\n  # Convert abundance estimates to matrix\n  ${trinity_matrix} \\\n  --est_method salmon \\\n  --gene_trans_map ${gene_map} \\\n  --out_prefix salmon \\\n  --name_sample_by_basedir \\\n  ${trin_matrix_list} \\\n  1> ${matrix_stdout} \\\n  2> ${matrix_stderr}\n\n  # Integrate Trinotate functional annotations\n  \"${trinity_annotate_matrix}\" \\\n  \"${trinotate_feature_map}\" \\\n  salmon.gene.counts.matrix \\\n  > salmon.gene.counts.annotated.matrix\n\n\n  # Generate weighted gene lengths\n  \"${trinity_tpm_length}\" \\\n  --gene_trans_map \"${gene_map}\" \\\n  --trans_lengths \"${fasta_seq_lengths}\" \\\n  --TPM_matrix \"${salmon_iso_matrix}\" \\\n  > Trinity.gene_lengths.txt \\\n  2> ${tpm_length_stderr}\n\n  # Differential expression analysis\n  # Utilizes edgeR.\n  # Needs to be run in same directory as transcriptome.\n  cd ${transcriptome_dir} || exit\n  ${trinity_DE} \\\n  --matrix \"${comparison_dir}salmon.gene.counts.matrix\" \\\n  --method edgeR \\\n  --samples_file \"${samples}\" \\\n  1> ${trinity_DE_stdout} \\\n  2> ${trinity_DE_stderr}\n\n  mv edgeR* \"${comparison_dir}\"\n\n\n  # Run differential expression on edgeR output matrix\n  # Set fold difference to 2-fold (ie. -C 1 = 2^1)\n  # P value <= 0.05\n  # Has to run from edgeR output directory\n\n  # Pulls edgeR directory name and removes leading ./ in find output\n  # Using find is required because edgeR names directory using PID\n  # and I don't know how to find that out\n  cd \"${comparison_dir}\" || exit\n  edgeR_dir=$(find . -type d -name \"edgeR*\" | sed 's%./%%')\n  cd \"${edgeR_dir}\" || exit\n  mv \"${transcriptome_dir}/${trinity_DE_stdout}\" .\n  mv \"${transcriptome_dir}/${trinity_DE_stderr}\" .\n  ${diff_expr} \\\n  --matrix \"${salmon_gene_matrix}\" \\\n  --samples \"${samples}\" \\\n  --examine_GO_enrichment \\\n  --GO_annots \"${go_annotations}\" \\\n  --include_GOplot \\\n  --gene_lengths \"${comparison_dir}Trinity.gene_lengths.txt\" \\\n  -C 1 \\\n  -P 0.05 \\\n  1> ${diff_expr_stdout} \\\n  2> ${diff_expr_stderr}\n\n\n\n  cd \"${wd}\" || exit\ndone\n```\n\nFlatten enriched GO terms file (GitHub):\n\n- [trinity_deg_to_go.sh](https://github.com/RobertsLab/sams-notebook/blob/master/bash_scripts/trinity_deg_to_go.sh)\n\n```shell\n#!/bin/bash\n\n#############################################################\n# Script to \"flatten\" Trinity edgeR GOseq enrichment format\n# so each line contains a single gene/transcript ID\n# and associated GO term\n#############################################################\n\n# Enable globstar for recursive searching\nshopt -s globstar\n\n# Declare variables\noutput_file=\"\"\nwd=$(pwd)\n\n# Input file\n## Expects Trinity edgeR GOseq enrichment format:\n## category\tover_represented_pvalue\tunder_represented_pvalue\tnumDEInCat\tnumInCat\tterm\tontology\tover_represented_FDR\tgo_term\tgene_ids\n## Field 10 (gene_ids) contains comma separated gene_ids that fall in the given GO term in the \"category\" column\n\nfor goseq in **/*UP.subset*.enriched\ndo\n\t# Capture path to file\n\tdir=${goseq%/*}\n\n\tcd \"${dir}\" || exit\n\n\ttmp_file=$(mktemp)\n\n\t# Count lines in file\n  linecount=$(cat \"${goseq}\" | wc -l)\n\n\t# If file is not empty\n  if (( \"${linecount}\" > 1 ))\n\tthen\n\t\toutput_file=\"${goseq}.flattened\"\n\n\n\t\t# 1st: Convert comma-delimited gene IDs in column 10 to tab-delimited\n\t\t# Also, set output (OFS) to be tab-delimited\n\t\t# 2nd: Convert spaces to underscores and keep output as tab-delimited\n\t\t# 3rd: Sort on Trinity IDs (column 10) and keep only uniques\n\t\tawk 'BEGIN{FS=\"\\t\";OFS=\"\\t\"} {gsub(/, /, \"\\t\", $10); print}' \"${goseq}\" \\\n\t\t| awk 'BEGIN{F=\"\\t\";OFS=\"\\t\"} NR==1; NR > 1 {gsub(/ /, \"_\", $0); print}' \\\n\t\t> \"${tmp_file}\"\n\n\t\t# Identify the first line number which contains a gene_id\n\t\tbegin_goterms=$(grep --line-number \"TRINITY\" \"${tmp_file}\" \\\n\t\t| awk '{for (i=1;i<=NF;i++) if($i ~/TRINITY/) print i}' \\\n\t\t| sort --general-numeric-sort --unique | head -n1)\n\n\t\t# \"Unfolds\" gene_ids to a single gene_id per row\n\t\twhile read -r line\n\t\tdo\n\t\t\t# Capture the length of the longest row\n\t\t\tmax_field=$(echo \"$line\" | awk -F \"\\t\" '{print NF}')\n\n\t\t\t# Retain the first 8 fields (i.e. categories)\n\t\t\tfixed_fields=$(echo \"$line\" | cut -f1-8)\n\n\t\t\t# Since not all the lines contain the same number of fields (e.g. may not have GO terms),\n\t\t\t# evaluate the number of fields in each line to determine how to handle current line.\n\n\t\t\t# If the value in max_field is less than the field number where the GO terms begin,\n\t\t\t# then just print the current line (%s) followed by a newline (\\n).\n\t\t\tif (( \"$max_field\" < \"$begin_goterms\" ))\n\t\t\tthen\n\t\t\t\tprintf \"%s\\n\" \"$line\"\n\t\t\telse goterms=$(echo \"$line\" | cut -f\"$begin_goterms\"-\"$max_field\")\n\n\t\t  # Assign values in the variable \"goterms\" to a new indexed array (called \"array\"),\n\t\t  # with tab delimiter (IFS=$'\\t')\n\t\t  IFS=$'\\t' read -r -a array <<<\"$goterms\"\n\n\t\t  # Iterate through each element of the array.\n\t\t  # Print the first n fields (i.e. the fields stored in \"fixed_fields\") followed by a tab (%s\\t).\n\t\t  # Print the current element in the array (i.e. the current GO term) followed by a new line (%s\\n).\n\t\t  for element in \"${!array[@]}\"\n\t\t  do\n\t\t\t  printf \"%s\\t%s\\n\" \"$fixed_fields\" \"${array[$element]}\"\n\t\t  done\n\t\t  fi\n\t\tdone < \"${tmp_file}\" > \"${output_file}\"\n\tfi\n\n  # Cleanup\n  rm \"${tmp_file}\"\n\n\tcd \"${wd}\" || exit\ndone\n```\n\n---\n\n# RESULTS\n\nTook about 17.5hrs to run:\n\n![runtime screencap](https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_runtime.png?raw=true)\n\nOutput folder:\n\n- [20200422_cbai_DEG_basic_comparisons/](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/)\n\n\n#### D9-D12\n\nUp-regulated genes:\n\n- [salmon.gene.counts.matrix.D12_vs_D9.edgeR.DE_results.P0.05_C1.D9-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/D9-D12/edgeR.169728.dir/salmon.gene.counts.matrix.D12_vs_D9.edgeR.DE_results.P0.05_C1.D9-UP.subset)\n\n- [salmon.gene.counts.matrix.D12_vs_D9.edgeR.DE_results.P0.05_C1.D12-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/D9-D12/edgeR.169728.dir/salmon.gene.counts.matrix.D12_vs_D9.edgeR.DE_results.P0.05_C1.D12-UP.subset)\n\nEnriched GO terms:\n\n- [salmon.gene.counts.matrix.D12_vs_D9.edgeR.DE_results.P0.05_C1.D12-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/D9-D12/edgeR.169728.dir/salmon.gene.counts.matrix.D12_vs_D9.edgeR.DE_results.P0.05_C1.D12-UP.subset.GOseq.enriched)\n\n- [salmon.gene.counts.matrix.D12_vs_D9.edgeR.DE_results.P0.05_C1.D9-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/D9-D12/edgeR.169728.dir/salmon.gene.counts.matrix.D12_vs_D9.edgeR.DE_results.P0.05_C1.D9-UP.subset.GOseq.enriched)\n\n\n\n![D9-D12 deg heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_D9-D12_DEG_heatmap.png)\n\n\n![D9-D12 volcano plot](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_D9-D12_volcano.png)\n\n\n![D9-D12 correlation heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_D9-D12_correlation_heatmap.png)\n\n---\n\n#### D9-D26\n\nUp-regulated genes:\n\n- [salmon.gene.counts.matrix.D26_vs_D9.edgeR.DE_results.P0.05_C1.D9-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/D9-D26/edgeR.200352.dir/salmon.gene.counts.matrix.D26_vs_D9.edgeR.DE_results.P0.05_C1.D9-UP.subset)\n\n- [salmon.gene.counts.matrix.D26_vs_D9.edgeR.DE_results.P0.05_C1.D26-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/D9-D26/edgeR.200352.dir/salmon.gene.counts.matrix.D26_vs_D9.edgeR.DE_results.P0.05_C1.D26-UP.subset)\n\nEnriched GO terms:\n\n- [salmon.gene.counts.matrix.D26_vs_D9.edgeR.DE_results.P0.05_C1.D9-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/D9-D26/edgeR.200352.dir/salmon.gene.counts.matrix.D26_vs_D9.edgeR.DE_results.P0.05_C1.D9-UP.subset.GOseq.enriched)\n\n- [salmon.gene.counts.matrix.D26_vs_D9.edgeR.DE_results.P0.05_C1.D26-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/D9-D26/edgeR.200352.dir/salmon.gene.counts.matrix.D26_vs_D9.edgeR.DE_results.P0.05_C1.D26-UP.subset.GOseq.enriched)\n\n\n\n![D9-D26 deg heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_D9-D26_DEG_heatmap.png)\n\n\n![D9-D26 volcano plot](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_D9-D26_volcano.png)\n\n\n![D9-D26 correlation heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_D9-D26_correlation_heatmap.png)\n\n---\n\n#### D12-D26\n\nUp-regulated genes:\n\n- [salmon.gene.counts.matrix.D12_vs_D26.edgeR.DE_results.P0.05_C1.D26-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/D12-D26/edgeR.230922.dir/salmon.gene.counts.matrix.D12_vs_D26.edgeR.DE_results.P0.05_C1.D26-UP.subset)\n\n- [salmon.gene.counts.matrix.D12_vs_D26.edgeR.DE_results.P0.05_C1.D12-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/D12-D26/edgeR.230922.dir/salmon.gene.counts.matrix.D12_vs_D26.edgeR.DE_results.P0.05_C1.D12-UP.subset)\n\nEnriched GO terms:\n\n- [salmon.gene.counts.matrix.D12_vs_D26.edgeR.DE_results.P0.05_C1.D26-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/D12-D26/edgeR.230922.dir/salmon.gene.counts.matrix.D12_vs_D26.edgeR.DE_results.P0.05_C1.D26-UP.subset.GOseq.enriched)\n\n- [salmon.gene.counts.matrix.D12_vs_D26.edgeR.DE_results.P0.05_C1.D12-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/D12-D26/edgeR.230922.dir/salmon.gene.counts.matrix.D12_vs_D26.edgeR.DE_results.P0.05_C1.D12-UP.subset.GOseq.enriched)\n\n\n\n![D12-D26 deg heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_D12-D26_DEG_heatmap.png)\n\n\n![D12-D26 volcano plot](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_D12-D26_volcano.png)\n\n\n![D12-D26 correlation heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_D12-D26_correlation_heatmap.png)\n\n---\n\n#### ambient-cold\n\nUp-regulated genes:\n\n- [salmon.gene.counts.matrix.ambient_vs_cold.edgeR.DE_results.P0.05_C1.cold-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/ambient-cold/edgeR.267393.dir/salmon.gene.counts.matrix.ambient_vs_cold.edgeR.DE_results.P0.05_C1.cold-UP.subset)\n\n- [salmon.gene.counts.matrix.ambient_vs_cold.edgeR.DE_results.P0.05_C1.ambient-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/ambient-cold/edgeR.267393.dir/salmon.gene.counts.matrix.ambient_vs_cold.edgeR.DE_results.P0.05_C1.ambient-UP.subset)\n\nEnriched GO terms:\n\n- [salmon.gene.counts.matrix.ambient_vs_cold.edgeR.DE_results.P0.05_C1.cold-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/ambient-cold/edgeR.267393.dir/salmon.gene.counts.matrix.ambient_vs_cold.edgeR.DE_results.P0.05_C1.cold-UP.subset.GOseq.enriched)\n\n- [salmon.gene.counts.matrix.ambient_vs_cold.edgeR.DE_results.P0.05_C1.ambient-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/ambient-cold/edgeR.267393.dir/salmon.gene.counts.matrix.ambient_vs_cold.edgeR.DE_results.P0.05_C1.ambient-UP.subset.GOseq.enriched)\n\n\n\n![ambient-cold deg heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_ambient-cold_DEG_heatmap.png)\n\n\n![ambient-cold volcano plot](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_ambient-cold_volcano.png)\n\n\n![ambient-cold correlation heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_ambient-cold_correlation_heatmap.png)\n\n---\n\n#### ambient-warm\n\nUp-regulated genes:\n\n- [salmon.gene.counts.matrix.ambient_vs_warm.edgeR.DE_results.P0.05_C1.ambient-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/ambient-warm/edgeR.297991.dir/salmon.gene.counts.matrix.ambient_vs_warm.edgeR.DE_results.P0.05_C1.ambient-UP.subset)\n\n- [salmon.gene.counts.matrix.ambient_vs_warm.edgeR.DE_results.P0.05_C1.warm-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/ambient-warm/edgeR.297991.dir/salmon.gene.counts.matrix.ambient_vs_warm.edgeR.DE_results.P0.05_C1.warm-UP.subset)\n\nEnriched GO terms:\n\n- [salmon.gene.counts.matrix.ambient_vs_warm.edgeR.DE_results.P0.05_C1.warm-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/ambient-warm/edgeR.297991.dir/salmon.gene.counts.matrix.ambient_vs_warm.edgeR.DE_results.P0.05_C1.warm-UP.subset.GOseq.enriched)\n\n- [salmon.gene.counts.matrix.ambient_vs_warm.edgeR.DE_results.P0.05_C1.ambient-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/ambient-warm/edgeR.297991.dir/salmon.gene.counts.matrix.ambient_vs_warm.edgeR.DE_results.P0.05_C1.ambient-UP.subset.GOseq.enriched)\n\n\n![ambient-warm deg heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_ambient-warm_DEG_heatmap.png)\n\n\n![ambient-warm volcano plot](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_ambient-warm_volcano.png)\n\n\n![ambient-warm correlation heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_ambient-warm_correlation_heatmap.png)\n\n---\n\n#### cold-warm\n\nUp-regulated genes:\n\n- [salmon.gene.counts.matrix.cold_vs_warm.edgeR.DE_results.P0.05_C1.warm-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/cold-warm/edgeR.328585.dir/salmon.gene.counts.matrix.cold_vs_warm.edgeR.DE_results.P0.05_C1.warm-UP.subset)\n\n- [salmon.gene.counts.matrix.cold_vs_warm.edgeR.DE_results.P0.05_C1.cold-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/cold-warm/edgeR.328585.dir/salmon.gene.counts.matrix.cold_vs_warm.edgeR.DE_results.P0.05_C1.cold-UP.subset)\n\nEnriched GO terms:\n\n- [salmon.gene.counts.matrix.cold_vs_warm.edgeR.DE_results.P0.05_C1.warm-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/cold-warm/edgeR.328585.dir/salmon.gene.counts.matrix.cold_vs_warm.edgeR.DE_results.P0.05_C1.warm-UP.subset.GOseq.enriched)\n\n- [salmon.gene.counts.matrix.cold_vs_warm.edgeR.DE_results.P0.05_C1.cold-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/cold-warm/edgeR.328585.dir/salmon.gene.counts.matrix.cold_vs_warm.edgeR.DE_results.P0.05_C1.cold-UP.subset.GOseq.enriched)\n\n\n\n![cold-warm deg heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_cold-warm_DEG_heatmap.png)\n\n\n![cold-warm volcano plot](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_cold-warm_volcano.png)\n\n\n![cold-warm correlation heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_cold-warm_correlation_heatmap.png)\n\n---\n\n#### infected-uninfected\n\nUp-regulated genes:\n\n- [salmon.gene.counts.matrix.infected_vs_uninfected.edgeR.DE_results.P0.05_C1.infected-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/infected-uninfected/edgeR.132470.dir/salmon.gene.counts.matrix.infected_vs_uninfected.edgeR.DE_results.P0.05_C1.infected-UP.subset)\n\n- [salmon.gene.counts.matrix.infected_vs_uninfected.edgeR.DE_results.P0.05_C1.uninfected-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/infected-uninfected/edgeR.132470.dir/salmon.gene.counts.matrix.infected_vs_uninfected.edgeR.DE_results.P0.05_C1.uninfected-UP.subset)\n\nEnriched GO terms:\n\n- [salmon.gene.counts.matrix.infected_vs_uninfected.edgeR.DE_results.P0.05_C1.uninfected-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/infected-uninfected/edgeR.132470.dir/salmon.gene.counts.matrix.infected_vs_uninfected.edgeR.DE_results.P0.05_C1.uninfected-UP.subset.GOseq.enriched)\n\n- [salmon.gene.counts.matrix.infected_vs_uninfected.edgeR.DE_results.P0.05_C1.infected-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/infected-uninfected/edgeR.132470.dir/salmon.gene.counts.matrix.infected_vs_uninfected.edgeR.DE_results.P0.05_C1.infected-UP.subset.GOseq.enriched)\n\n\n\n![infected-uninfected deg heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_infected-uninfected_DEG_heatmap.png)\n\n\n![infected-uninfected volcano plot](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_infected-uninfected_volcano.png)\n\n\n![infected-uninfected correlation heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_infected-uninfected_correlation_heatmap.png)\n\n---\n","srcMarkdownNoYaml":"\nPer [a Slack request](https://genefish.slack.com/archives/D02MJDL5Y/p1587393166000200), Steven asked me to take the [Genewize RNAseq data (received 2020318)](https://robertslab.github.io/sams-notebook/posts/2020/2020-03-18-Data-Received-C.bairdi-RNAseq-Data-from-Genewiz/) through [edgeR](https://bioconductor.org/packages/release/bioc/html/edgeR/). Ran the analysis using the Trinity differential expression pipeline:\n\n- [Salmon alignment-free transcript quantification](https://github.com/trinityrnaseq/trinityrnaseq/wiki/Trinity-Transcript-Quantification)\n\n- [edgeR differential expression](https://github.com/trinityrnaseq/trinityrnaseq/wiki/Trinity-Differential-Expression)\n\nHere're the core input files used for this analysis:\n\n- Transcriptome: [cbai_transcriptome_v1.5.fasta](https://owl.fish.washington.edu/halfshell/genomic-databank/cbai_transcriptome_v1.5.fasta)\n\n- MEGAN6 _Arthropoda_ taxonomic reads: [20200413_C_bairdi_megan_reads/](https://gannet.fish.washington.edu/Atumefaciens/20200413_C_bairdi_megan_reads/)\n\nThe analyses will perform the following pairwise comparisons:\n\n- infected-uninfected\n\n- D9-D12\n\n- D9-D26\n\n- D12-D26\n\n- ambient-cold\n\n- ambient-warm\n\n- cold-warm\n\nIt will identify differentially expressed genes with >=2-fold log change in expression and a false discovery rate of <=0.05. Additionally, it will perform gene ontology (GO) enrichment analysis using GOseq.\n\nAs a brief aside, I'm pretty stoked about the SBATCH script below! It automates FastQ file selection for each comparison, creates appropriately named subdirectories and creates proper Trinity samples list file needed.\n\nAfter running the DEG analysis, I \"flattened\" the enriched GO terms files for later use in R to map these GO terms to GOslims. That was run separately and the script is after the SBATCH script.\n\nSBATCH script (GitHub):\n\n- [20200422_cbai_DEG_basic_comparisons.sh](https://github.com/RobertsLab/sams-notebook/blob/master/sbatch_scripts/20200422_cbai_DEG_basic_comparisons.sh)\n\n\n```shell\n#!/bin/bash\n## Job Name\n#SBATCH --job-name=cbai_DEG_basic\n## Allocation Definition\n#SBATCH --account=coenv\n#SBATCH --partition=coenv\n## Resources\n## Nodes\n#SBATCH --nodes=1\n## Walltime (days-hours:minutes:seconds format)\n#SBATCH --time=10-00:00:00\n## Memory per node\n#SBATCH --mem=120G\n##turn on e-mail notification\n#SBATCH --mail-type=ALL\n#SBATCH --mail-user=samwhite@uw.edu\n## Specify the working directory for this job\n#SBATCH --chdir=/gscratch/scrubbed/samwhite/outputs/20200422_cbai_DEG_basic_comparisons\n\n# This is a script to identify differentially expressed genes (DEGs) in C.bairdi\n# using pairwise comparisions of from just the \"2020-GW\" (i.e. just Genewiz) RNAseq data\n# which has been taxonomically selected for all Arthropoda reads. See Sam's notebook from 20200419\n# https://robertslab.github.io/sams-notebook\n\n# Script will run Trinity's builtin differential gene expression analysis using:\n# - Salmon alignment-free transcript abundance estimation\n# - edgeR\n# Cutoffs of 2-fold difference in expression and FDR of <=0.05.\n\n###################################################################################\n# These variables need to be set by user\nfastq_dir=\"/gscratch/srlab/sam/data/C_bairdi/RNAseq/\"\nfasta_prefix=\"20200408.C_bairdi.megan.Trinity\"\ntranscriptome_dir=\"/gscratch/srlab/sam/data/C_bairdi/transcriptomes\"\ntrinotate_feature_map=\"${transcriptome_dir}/20200409.cbai.trinotate.annotation_feature_map.txt\"\ngo_annotations=\"${transcriptome_dir}/20200409.cbai.trinotate.go_annotations.txt\"\n\n# Array of the various comparisons to evaluate\n# Each condition in each comparison should be separated by a \"-\"\ncomparisons_array=(\ninfected-uninfected \\\nD9-D12 \\\nD9-D26 \\\nD12-D26 \\\nambient-cold \\\nambient-warm \\\ncold-warm\n)\n\n# Functions\n# Expects input (i.e. \"$1\") to be in the following format:\n# e.g. 20200413.C_bairdi.113.D9.uninfected.cold.megan_R2.fq\nget_day () { day=$(echo \"$1\" | awk -F\".\" '{print $4}'); }\nget_inf () { inf=$(echo \"$1\" | awk -F\".\" '{print $5}'); }\nget_temp () { temp=$(echo \"$1\" | awk -F\".\" '{print $6}'); }\n\n###################################################################################\n\n# Exit script if any command fails\nset -e\n\n# Load Python Mox module for Python module availability\n\nmodule load intel-python3_2017\n\n# Document programs in PATH (primarily for program version ID)\n\n{\ndate\necho \"\"\necho \"System PATH for $SLURM_JOB_ID\"\necho \"\"\nprintf \"%0.s-\" {1..10}\necho \"${PATH}\" | tr : \\\\n\n} >> system_path.log\n\n\nwd=\"$(pwd)\"\nthreads=28\n\n\n## Designate input file locations\ntranscriptome=\"${transcriptome_dir}/${fasta_prefix}.fasta\"\nfasta_seq_lengths=\"${transcriptome_dir}/${fasta_prefix}.fasta.seq_lens\"\ngene_map=\"${transcriptome_dir}/${fasta_prefix}.fasta.gene_trans_map\"\ntranscriptome=\"${transcriptome_dir}/${fasta_prefix}.fasta\"\n\n\n# Standard output/error files\ndiff_expr_stdout=\"diff_expr_stdout.txt\"\ndiff_expr_stderr=\"diff_expr_stderr.txt\"\nmatrix_stdout=\"matrix_stdout.txt\"\nmatrix_stderr=\"matrix_stderr.txt\"\nsalmon_stdout=\"salmon_stdout.txt\"\nsalmon_stderr=\"salmon_stderr.txt\"\ntpm_length_stdout=\"tpm_length_stdout.txt\"\ntpm_length_stderr=\"tpm_length_stderr.txt\"\ntrinity_DE_stdout=\"trinity_DE_stdout.txt\"\ntrinity_DE_stderr=\"trinity_DE_stderr.txt\"\n\nedgeR_dir=\"\"\n\n#programs\ntrinity_home=/gscratch/srlab/programs/trinityrnaseq-v2.9.0\ntrinity_annotate_matrix=\"${trinity_home}/Analysis/DifferentialExpression/rename_matrix_feature_identifiers.pl\"\ntrinity_abundance=${trinity_home}/util/align_and_estimate_abundance.pl\ntrinity_matrix=${trinity_home}/util/abundance_estimates_to_matrix.pl\ntrinity_DE=${trinity_home}/Analysis/DifferentialExpression/run_DE_analysis.pl\ndiff_expr=${trinity_home}/Analysis/DifferentialExpression/analyze_diff_expr.pl\ntrinity_tpm_length=${trinity_home}/util/misc/TPM_weighted_gene_length.py\n\n# Loop through each comparison\n# Will create comparison-specific direcctories and copy\n# appropriate FastQ files for each comparison.\n\n# After file transfer, will create necessary sample list file for use\n# by Trinity for running differential gene expression analysis and GO enrichment.\nfor comparison in \"${!comparisons_array[@]}\"\ndo\n\n  # Assign variables\n  cond1_count=0\n  cond2_count=0\n  comparison=${comparisons_array[${comparison}]}\n  comparison_dir=${wd}/${comparison}\n  salmon_gene_matrix=${comparison_dir}/salmon.gene.TMM.EXPR.matrix\n  salmon_iso_matrix=${comparison_dir}/salmon.isoform.TMM.EXPR.matrix\n  samples=${comparison_dir}${comparison}.samples.txt\n\n  # Extract each comparison from comparisons array\n  # Conditions must be separated by a \"-\"\n  cond1=$(echo \"${comparison}\" | awk -F\"-\" '{print $1}')\n  cond2=$(echo \"${comparison}\" | awk -F\"-\" '{print $2}')\n\n\n  mkdir --parents \"${comparison}\"\n\n  cd \"${comparison}\" || exit\n\n  # Series of if statements to identify which FastQ files to rsync to working directory\n  if [[ \"${comparison}\" == \"infected-uninfected\" ]]; then\n    rsync --archive --verbose ${fastq_dir}*.fq .\n  fi\n\n  if [[ \"${comparison}\" == \"D9-D12\" ]]; then\n    for fastq in \"${fastq_dir}\"*.fq\n    do\n      get_day \"${fastq}\"\n      if [[ \"${day}\" == \"D9\" || \"${day}\" == \"D12\" ]]; then\n        rsync --archive --verbose \"${fastq}\" .\n      fi\n    done\n  fi\n\n  if [[ \"${comparison}\" == \"D9-D26\" ]]; then\n    for fastq in \"${fastq_dir}\"*.fq\n    do\n      get_day \"${fastq}\"\n      if [[ \"${day}\" == \"D9\" || \"${day}\" == \"D26\" ]]; then\n        rsync --archive --verbose \"${fastq}\" .\n      fi\n    done\n  fi\n\n  if [[ \"${comparison}\" == \"D12-D26\" ]]; then\n    for fastq in \"${fastq_dir}\"*.fq\n    do\n      get_day \"${fastq}\"\n      if [[ \"${day}\" == \"D12\" || \"${day}\" == \"D26\" ]]; then\n        rsync --archive --verbose \"${fastq}\" .\n      fi\n    done\n  fi\n\n  if [[ \"${comparison}\" == \"ambient-cold\" ]]; then\n    #statements\n    for fastq in \"${fastq_dir}\"*.fq\n    do\n      get_temp \"${fastq}\"\n      if [[ \"${temp}\" == \"ambient\" || \"${temp}\" == \"cold\" ]]; then\n        rsync --archive --verbose \"${fastq}\" .\n      fi\n    done\n  fi\n\n  if [[ \"${comparison}\" == \"ambient-warm\" ]]; then\n    for fastq in \"${fastq_dir}\"*.fq\n    do\n      get_temp \"${fastq}\"\n      if [[ \"${temp}\" == \"ambient\" || \"${temp}\" == \"warm\" ]]; then\n        rsync --archive --verbose \"${fastq}\" .\n      fi\n    done\n  fi\n\n  if [[ \"${comparison}\" == \"cold-warm\" ]]; then\n    for fastq in \"${fastq_dir}\"*.fq\n    do\n      get_temp \"${fastq}\"\n      if [[ \"${temp}\" == \"cold\" || \"${temp}\" == \"warm\" ]]; then\n        rsync --archive --verbose \"${fastq}\" .\n      fi\n    done\n  fi\n\n  # Create reads array\n  # Paired reads files will be sequentially listed in array (e.g. 111_R1 111_R2)\n  reads_array=(*.fq)\n\n  echo \"\"\n  echo \"Created reads_array\"\n\n  # Loop to create sample list file\n  # Sample file list is tab-delimited like this:\n\n  # cond_A    cond_A_rep1    A_rep1_left.fq    A_rep1_right.fq\n  # cond_A    cond_A_rep2    A_rep2_left.fq    A_rep2_right.fq\n  # cond_B    cond_B_rep1    B_rep1_left.fq    B_rep1_right.fq\n  # cond_B    cond_B_rep2    B_rep2_left.fq    B_rep2_right.fq\n\n\n\n  # Increment by 2 to process next pair of FastQ files\n  for (( i=0; i<${#reads_array[@]} ; i+=2 ))\n  do\n    echo \"\"\n    echo \"Evaluating ${reads_array[i]} and ${reads_array[i+1]}\"\n    get_day \"${reads_array[i]}\"\n    get_inf \"${reads_array[i]}\"\n    get_temp \"${reads_array[i]}\"\n\n    echo \"\"\n    echo \"Got day (${day}), infection status (${inf}), and temp (${temp}).\"\n    echo \"\"\n    echo \"Condition 1 is: ${cond1}\"\n    echo \"condition 2 is: ${cond2}\"\n\n    # Evaluate specified treatment conditions and format sample file list appropriately.\n    if [[ \"${cond1}\" == \"${day}\" || \"${cond1}\" == \"${inf}\" || \"${cond1}\" == \"${temp}\" ]]; then\n      cond1_count=$((cond1_count+1))\n\n\n      echo \"\"\n      echo \"Condition 1 evaluated.\"\n      # Create tab-delimited samples file.\n      printf \"%s\\t%s%02d\\t%s\\t%s\\n\" \"${cond1}\" \"${cond1}_\" \"${cond1_count}\" \"${comparison_dir}${reads_array[i]}\" \"${comparison_dir}${reads_array[i+1]}\" \\\n      >> \"${samples}\"\n    elif [[ \"${cond2}\" == \"${day}\" || \"${cond2}\" == \"${inf}\" || \"${cond2}\" == \"${temp}\" ]]; then\n      cond2_count=$((cond2_count+1))\n\n\n      echo \"\"\n      echo \"Condition 2 evaluated.\"\n      # Create tab-delimited samples file.\n      printf \"%s\\t%s%02d\\t%s\\t%s\\n\" \"${cond2}\" \"${cond2}_\" \"${cond2_count}\" \"${comparison_dir}${reads_array[i]}\" \"${comparison_dir}${reads_array[i+1]}\" \\\n      >> \"${samples}\"\n    fi\n\n    # Copy sample list file to transcriptome directory\n    cp \"${samples}\" \"${transcriptome_dir}\"\n  done\n\n  echo \"Created ${comparison} sample list file.\"\n\n\n  # Create directory/sample list for ${trinity_matrix} command\n  trin_matrix_list=$(awk '{printf \"%s%s\", $2, \"/quant.sf \" }' \"${samples}\")\n\n\n  # Determine transcript abundances using Salmon alignment-free\n  # abundance estimate.\n  ${trinity_abundance} \\\n  --output_dir \"${comparison_dir}\" \\\n  --transcripts ${transcriptome} \\\n  --seqType fq \\\n  --samples_file \"${samples}\" \\\n  --est_method salmon \\\n  --aln_method bowtie2 \\\n  --gene_trans_map \"${gene_map}\" \\\n  --prep_reference \\\n  --thread_count \"${threads}\" \\\n  1> \"${comparison_dir}\"${salmon_stdout} \\\n  2> \"${comparison_dir}\"${salmon_stderr}\n\n  # Convert abundance estimates to matrix\n  ${trinity_matrix} \\\n  --est_method salmon \\\n  --gene_trans_map ${gene_map} \\\n  --out_prefix salmon \\\n  --name_sample_by_basedir \\\n  ${trin_matrix_list} \\\n  1> ${matrix_stdout} \\\n  2> ${matrix_stderr}\n\n  # Integrate Trinotate functional annotations\n  \"${trinity_annotate_matrix}\" \\\n  \"${trinotate_feature_map}\" \\\n  salmon.gene.counts.matrix \\\n  > salmon.gene.counts.annotated.matrix\n\n\n  # Generate weighted gene lengths\n  \"${trinity_tpm_length}\" \\\n  --gene_trans_map \"${gene_map}\" \\\n  --trans_lengths \"${fasta_seq_lengths}\" \\\n  --TPM_matrix \"${salmon_iso_matrix}\" \\\n  > Trinity.gene_lengths.txt \\\n  2> ${tpm_length_stderr}\n\n  # Differential expression analysis\n  # Utilizes edgeR.\n  # Needs to be run in same directory as transcriptome.\n  cd ${transcriptome_dir} || exit\n  ${trinity_DE} \\\n  --matrix \"${comparison_dir}salmon.gene.counts.matrix\" \\\n  --method edgeR \\\n  --samples_file \"${samples}\" \\\n  1> ${trinity_DE_stdout} \\\n  2> ${trinity_DE_stderr}\n\n  mv edgeR* \"${comparison_dir}\"\n\n\n  # Run differential expression on edgeR output matrix\n  # Set fold difference to 2-fold (ie. -C 1 = 2^1)\n  # P value <= 0.05\n  # Has to run from edgeR output directory\n\n  # Pulls edgeR directory name and removes leading ./ in find output\n  # Using find is required because edgeR names directory using PID\n  # and I don't know how to find that out\n  cd \"${comparison_dir}\" || exit\n  edgeR_dir=$(find . -type d -name \"edgeR*\" | sed 's%./%%')\n  cd \"${edgeR_dir}\" || exit\n  mv \"${transcriptome_dir}/${trinity_DE_stdout}\" .\n  mv \"${transcriptome_dir}/${trinity_DE_stderr}\" .\n  ${diff_expr} \\\n  --matrix \"${salmon_gene_matrix}\" \\\n  --samples \"${samples}\" \\\n  --examine_GO_enrichment \\\n  --GO_annots \"${go_annotations}\" \\\n  --include_GOplot \\\n  --gene_lengths \"${comparison_dir}Trinity.gene_lengths.txt\" \\\n  -C 1 \\\n  -P 0.05 \\\n  1> ${diff_expr_stdout} \\\n  2> ${diff_expr_stderr}\n\n\n\n  cd \"${wd}\" || exit\ndone\n```\n\nFlatten enriched GO terms file (GitHub):\n\n- [trinity_deg_to_go.sh](https://github.com/RobertsLab/sams-notebook/blob/master/bash_scripts/trinity_deg_to_go.sh)\n\n```shell\n#!/bin/bash\n\n#############################################################\n# Script to \"flatten\" Trinity edgeR GOseq enrichment format\n# so each line contains a single gene/transcript ID\n# and associated GO term\n#############################################################\n\n# Enable globstar for recursive searching\nshopt -s globstar\n\n# Declare variables\noutput_file=\"\"\nwd=$(pwd)\n\n# Input file\n## Expects Trinity edgeR GOseq enrichment format:\n## category\tover_represented_pvalue\tunder_represented_pvalue\tnumDEInCat\tnumInCat\tterm\tontology\tover_represented_FDR\tgo_term\tgene_ids\n## Field 10 (gene_ids) contains comma separated gene_ids that fall in the given GO term in the \"category\" column\n\nfor goseq in **/*UP.subset*.enriched\ndo\n\t# Capture path to file\n\tdir=${goseq%/*}\n\n\tcd \"${dir}\" || exit\n\n\ttmp_file=$(mktemp)\n\n\t# Count lines in file\n  linecount=$(cat \"${goseq}\" | wc -l)\n\n\t# If file is not empty\n  if (( \"${linecount}\" > 1 ))\n\tthen\n\t\toutput_file=\"${goseq}.flattened\"\n\n\n\t\t# 1st: Convert comma-delimited gene IDs in column 10 to tab-delimited\n\t\t# Also, set output (OFS) to be tab-delimited\n\t\t# 2nd: Convert spaces to underscores and keep output as tab-delimited\n\t\t# 3rd: Sort on Trinity IDs (column 10) and keep only uniques\n\t\tawk 'BEGIN{FS=\"\\t\";OFS=\"\\t\"} {gsub(/, /, \"\\t\", $10); print}' \"${goseq}\" \\\n\t\t| awk 'BEGIN{F=\"\\t\";OFS=\"\\t\"} NR==1; NR > 1 {gsub(/ /, \"_\", $0); print}' \\\n\t\t> \"${tmp_file}\"\n\n\t\t# Identify the first line number which contains a gene_id\n\t\tbegin_goterms=$(grep --line-number \"TRINITY\" \"${tmp_file}\" \\\n\t\t| awk '{for (i=1;i<=NF;i++) if($i ~/TRINITY/) print i}' \\\n\t\t| sort --general-numeric-sort --unique | head -n1)\n\n\t\t# \"Unfolds\" gene_ids to a single gene_id per row\n\t\twhile read -r line\n\t\tdo\n\t\t\t# Capture the length of the longest row\n\t\t\tmax_field=$(echo \"$line\" | awk -F \"\\t\" '{print NF}')\n\n\t\t\t# Retain the first 8 fields (i.e. categories)\n\t\t\tfixed_fields=$(echo \"$line\" | cut -f1-8)\n\n\t\t\t# Since not all the lines contain the same number of fields (e.g. may not have GO terms),\n\t\t\t# evaluate the number of fields in each line to determine how to handle current line.\n\n\t\t\t# If the value in max_field is less than the field number where the GO terms begin,\n\t\t\t# then just print the current line (%s) followed by a newline (\\n).\n\t\t\tif (( \"$max_field\" < \"$begin_goterms\" ))\n\t\t\tthen\n\t\t\t\tprintf \"%s\\n\" \"$line\"\n\t\t\telse goterms=$(echo \"$line\" | cut -f\"$begin_goterms\"-\"$max_field\")\n\n\t\t  # Assign values in the variable \"goterms\" to a new indexed array (called \"array\"),\n\t\t  # with tab delimiter (IFS=$'\\t')\n\t\t  IFS=$'\\t' read -r -a array <<<\"$goterms\"\n\n\t\t  # Iterate through each element of the array.\n\t\t  # Print the first n fields (i.e. the fields stored in \"fixed_fields\") followed by a tab (%s\\t).\n\t\t  # Print the current element in the array (i.e. the current GO term) followed by a new line (%s\\n).\n\t\t  for element in \"${!array[@]}\"\n\t\t  do\n\t\t\t  printf \"%s\\t%s\\n\" \"$fixed_fields\" \"${array[$element]}\"\n\t\t  done\n\t\t  fi\n\t\tdone < \"${tmp_file}\" > \"${output_file}\"\n\tfi\n\n  # Cleanup\n  rm \"${tmp_file}\"\n\n\tcd \"${wd}\" || exit\ndone\n```\n\n---\n\n# RESULTS\n\nTook about 17.5hrs to run:\n\n![runtime screencap](https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_runtime.png?raw=true)\n\nOutput folder:\n\n- [20200422_cbai_DEG_basic_comparisons/](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/)\n\n\n#### D9-D12\n\nUp-regulated genes:\n\n- [salmon.gene.counts.matrix.D12_vs_D9.edgeR.DE_results.P0.05_C1.D9-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/D9-D12/edgeR.169728.dir/salmon.gene.counts.matrix.D12_vs_D9.edgeR.DE_results.P0.05_C1.D9-UP.subset)\n\n- [salmon.gene.counts.matrix.D12_vs_D9.edgeR.DE_results.P0.05_C1.D12-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/D9-D12/edgeR.169728.dir/salmon.gene.counts.matrix.D12_vs_D9.edgeR.DE_results.P0.05_C1.D12-UP.subset)\n\nEnriched GO terms:\n\n- [salmon.gene.counts.matrix.D12_vs_D9.edgeR.DE_results.P0.05_C1.D12-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/D9-D12/edgeR.169728.dir/salmon.gene.counts.matrix.D12_vs_D9.edgeR.DE_results.P0.05_C1.D12-UP.subset.GOseq.enriched)\n\n- [salmon.gene.counts.matrix.D12_vs_D9.edgeR.DE_results.P0.05_C1.D9-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/D9-D12/edgeR.169728.dir/salmon.gene.counts.matrix.D12_vs_D9.edgeR.DE_results.P0.05_C1.D9-UP.subset.GOseq.enriched)\n\n\n\n![D9-D12 deg heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_D9-D12_DEG_heatmap.png)\n\n\n![D9-D12 volcano plot](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_D9-D12_volcano.png)\n\n\n![D9-D12 correlation heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_D9-D12_correlation_heatmap.png)\n\n---\n\n#### D9-D26\n\nUp-regulated genes:\n\n- [salmon.gene.counts.matrix.D26_vs_D9.edgeR.DE_results.P0.05_C1.D9-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/D9-D26/edgeR.200352.dir/salmon.gene.counts.matrix.D26_vs_D9.edgeR.DE_results.P0.05_C1.D9-UP.subset)\n\n- [salmon.gene.counts.matrix.D26_vs_D9.edgeR.DE_results.P0.05_C1.D26-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/D9-D26/edgeR.200352.dir/salmon.gene.counts.matrix.D26_vs_D9.edgeR.DE_results.P0.05_C1.D26-UP.subset)\n\nEnriched GO terms:\n\n- [salmon.gene.counts.matrix.D26_vs_D9.edgeR.DE_results.P0.05_C1.D9-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/D9-D26/edgeR.200352.dir/salmon.gene.counts.matrix.D26_vs_D9.edgeR.DE_results.P0.05_C1.D9-UP.subset.GOseq.enriched)\n\n- [salmon.gene.counts.matrix.D26_vs_D9.edgeR.DE_results.P0.05_C1.D26-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/D9-D26/edgeR.200352.dir/salmon.gene.counts.matrix.D26_vs_D9.edgeR.DE_results.P0.05_C1.D26-UP.subset.GOseq.enriched)\n\n\n\n![D9-D26 deg heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_D9-D26_DEG_heatmap.png)\n\n\n![D9-D26 volcano plot](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_D9-D26_volcano.png)\n\n\n![D9-D26 correlation heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_D9-D26_correlation_heatmap.png)\n\n---\n\n#### D12-D26\n\nUp-regulated genes:\n\n- [salmon.gene.counts.matrix.D12_vs_D26.edgeR.DE_results.P0.05_C1.D26-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/D12-D26/edgeR.230922.dir/salmon.gene.counts.matrix.D12_vs_D26.edgeR.DE_results.P0.05_C1.D26-UP.subset)\n\n- [salmon.gene.counts.matrix.D12_vs_D26.edgeR.DE_results.P0.05_C1.D12-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/D12-D26/edgeR.230922.dir/salmon.gene.counts.matrix.D12_vs_D26.edgeR.DE_results.P0.05_C1.D12-UP.subset)\n\nEnriched GO terms:\n\n- [salmon.gene.counts.matrix.D12_vs_D26.edgeR.DE_results.P0.05_C1.D26-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/D12-D26/edgeR.230922.dir/salmon.gene.counts.matrix.D12_vs_D26.edgeR.DE_results.P0.05_C1.D26-UP.subset.GOseq.enriched)\n\n- [salmon.gene.counts.matrix.D12_vs_D26.edgeR.DE_results.P0.05_C1.D12-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/D12-D26/edgeR.230922.dir/salmon.gene.counts.matrix.D12_vs_D26.edgeR.DE_results.P0.05_C1.D12-UP.subset.GOseq.enriched)\n\n\n\n![D12-D26 deg heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_D12-D26_DEG_heatmap.png)\n\n\n![D12-D26 volcano plot](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_D12-D26_volcano.png)\n\n\n![D12-D26 correlation heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_D12-D26_correlation_heatmap.png)\n\n---\n\n#### ambient-cold\n\nUp-regulated genes:\n\n- [salmon.gene.counts.matrix.ambient_vs_cold.edgeR.DE_results.P0.05_C1.cold-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/ambient-cold/edgeR.267393.dir/salmon.gene.counts.matrix.ambient_vs_cold.edgeR.DE_results.P0.05_C1.cold-UP.subset)\n\n- [salmon.gene.counts.matrix.ambient_vs_cold.edgeR.DE_results.P0.05_C1.ambient-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/ambient-cold/edgeR.267393.dir/salmon.gene.counts.matrix.ambient_vs_cold.edgeR.DE_results.P0.05_C1.ambient-UP.subset)\n\nEnriched GO terms:\n\n- [salmon.gene.counts.matrix.ambient_vs_cold.edgeR.DE_results.P0.05_C1.cold-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/ambient-cold/edgeR.267393.dir/salmon.gene.counts.matrix.ambient_vs_cold.edgeR.DE_results.P0.05_C1.cold-UP.subset.GOseq.enriched)\n\n- [salmon.gene.counts.matrix.ambient_vs_cold.edgeR.DE_results.P0.05_C1.ambient-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/ambient-cold/edgeR.267393.dir/salmon.gene.counts.matrix.ambient_vs_cold.edgeR.DE_results.P0.05_C1.ambient-UP.subset.GOseq.enriched)\n\n\n\n![ambient-cold deg heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_ambient-cold_DEG_heatmap.png)\n\n\n![ambient-cold volcano plot](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_ambient-cold_volcano.png)\n\n\n![ambient-cold correlation heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_ambient-cold_correlation_heatmap.png)\n\n---\n\n#### ambient-warm\n\nUp-regulated genes:\n\n- [salmon.gene.counts.matrix.ambient_vs_warm.edgeR.DE_results.P0.05_C1.ambient-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/ambient-warm/edgeR.297991.dir/salmon.gene.counts.matrix.ambient_vs_warm.edgeR.DE_results.P0.05_C1.ambient-UP.subset)\n\n- [salmon.gene.counts.matrix.ambient_vs_warm.edgeR.DE_results.P0.05_C1.warm-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/ambient-warm/edgeR.297991.dir/salmon.gene.counts.matrix.ambient_vs_warm.edgeR.DE_results.P0.05_C1.warm-UP.subset)\n\nEnriched GO terms:\n\n- [salmon.gene.counts.matrix.ambient_vs_warm.edgeR.DE_results.P0.05_C1.warm-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/ambient-warm/edgeR.297991.dir/salmon.gene.counts.matrix.ambient_vs_warm.edgeR.DE_results.P0.05_C1.warm-UP.subset.GOseq.enriched)\n\n- [salmon.gene.counts.matrix.ambient_vs_warm.edgeR.DE_results.P0.05_C1.ambient-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/ambient-warm/edgeR.297991.dir/salmon.gene.counts.matrix.ambient_vs_warm.edgeR.DE_results.P0.05_C1.ambient-UP.subset.GOseq.enriched)\n\n\n![ambient-warm deg heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_ambient-warm_DEG_heatmap.png)\n\n\n![ambient-warm volcano plot](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_ambient-warm_volcano.png)\n\n\n![ambient-warm correlation heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_ambient-warm_correlation_heatmap.png)\n\n---\n\n#### cold-warm\n\nUp-regulated genes:\n\n- [salmon.gene.counts.matrix.cold_vs_warm.edgeR.DE_results.P0.05_C1.warm-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/cold-warm/edgeR.328585.dir/salmon.gene.counts.matrix.cold_vs_warm.edgeR.DE_results.P0.05_C1.warm-UP.subset)\n\n- [salmon.gene.counts.matrix.cold_vs_warm.edgeR.DE_results.P0.05_C1.cold-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/cold-warm/edgeR.328585.dir/salmon.gene.counts.matrix.cold_vs_warm.edgeR.DE_results.P0.05_C1.cold-UP.subset)\n\nEnriched GO terms:\n\n- [salmon.gene.counts.matrix.cold_vs_warm.edgeR.DE_results.P0.05_C1.warm-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/cold-warm/edgeR.328585.dir/salmon.gene.counts.matrix.cold_vs_warm.edgeR.DE_results.P0.05_C1.warm-UP.subset.GOseq.enriched)\n\n- [salmon.gene.counts.matrix.cold_vs_warm.edgeR.DE_results.P0.05_C1.cold-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/cold-warm/edgeR.328585.dir/salmon.gene.counts.matrix.cold_vs_warm.edgeR.DE_results.P0.05_C1.cold-UP.subset.GOseq.enriched)\n\n\n\n![cold-warm deg heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_cold-warm_DEG_heatmap.png)\n\n\n![cold-warm volcano plot](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_cold-warm_volcano.png)\n\n\n![cold-warm correlation heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_cold-warm_correlation_heatmap.png)\n\n---\n\n#### infected-uninfected\n\nUp-regulated genes:\n\n- [salmon.gene.counts.matrix.infected_vs_uninfected.edgeR.DE_results.P0.05_C1.infected-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/infected-uninfected/edgeR.132470.dir/salmon.gene.counts.matrix.infected_vs_uninfected.edgeR.DE_results.P0.05_C1.infected-UP.subset)\n\n- [salmon.gene.counts.matrix.infected_vs_uninfected.edgeR.DE_results.P0.05_C1.uninfected-UP.subset](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/infected-uninfected/edgeR.132470.dir/salmon.gene.counts.matrix.infected_vs_uninfected.edgeR.DE_results.P0.05_C1.uninfected-UP.subset)\n\nEnriched GO terms:\n\n- [salmon.gene.counts.matrix.infected_vs_uninfected.edgeR.DE_results.P0.05_C1.uninfected-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/infected-uninfected/edgeR.132470.dir/salmon.gene.counts.matrix.infected_vs_uninfected.edgeR.DE_results.P0.05_C1.uninfected-UP.subset.GOseq.enriched)\n\n- [salmon.gene.counts.matrix.infected_vs_uninfected.edgeR.DE_results.P0.05_C1.infected-UP.subset.GOseq.enriched](https://gannet.fish.washington.edu/Atumefaciens/20200422_cbai_DEG_basic_comparisons/infected-uninfected/edgeR.132470.dir/salmon.gene.counts.matrix.infected_vs_uninfected.edgeR.DE_results.P0.05_C1.infected-UP.subset.GOseq.enriched)\n\n\n\n![infected-uninfected deg heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_infected-uninfected_DEG_heatmap.png)\n\n\n![infected-uninfected volcano plot](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_infected-uninfected_volcano.png)\n\n\n![infected-uninfected correlation heatmap](https://raw.githubusercontent.com/RobertsLab/sams-notebook/master/images/screencaps/20200422_cbai_DEG_basic_comparisons_infected-uninfected_correlation_heatmap.png)\n\n---\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../../styles.css"],"toc":true,"toc-depth":5,"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","editor":"source","theme":"darkly","page-layout":"full","code-background":true,"code-copy":true,"title-block-banner":true,"author":"Sam White","toc-title":"Contents","toc-location":"left","layout":"post","title":"Gene Expression - C.bairdi Pairwise DEG Comparisons with 2019 RNAseq using Trinity-Salmon-EdgeR on Mox","date":"2020-04-22 16:55","tags":["Chionoecetes bairdi","Tanner crab","GO","gene ontology","enrichment","EdgeR","Trinity","Salmon","mox","RNAseq"],"categories":["2020","Miscellaneous"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}