{"title":"Data Wrangling - Visualization of C.bairdi NanoPore Sequencing Using NanoPlot on Mox","markdown":{"yaml":{"author":"Sam White","toc-title":"Contents","toc-depth":5,"toc-location":"left","layout":"post","title":"Data Wrangling - Visualization of C.bairdi NanoPore Sequencing Using NanoPlot on Mox","date":"2020-09-14 10:20","tags":["Tanner crab","mox","nanoplot","Chionoecetes bairdi","Hematodinium","nanopore","gDNA","sequencing"],"categories":["2020","Miscellaneous"]},"headingText":"Job Name","containsRefs":false,"markdown":"\nI previously converting our _C.bairdi_ NanoPre sequencing data from the raw Fast5 format to FastQ format for our three sets of data:\n\n- [C.bairdi-20102558-2729-Run-01](https://robertslab.github.io/sams-notebook/posts/2020/2020-09-04-Data-Wrangling---NanoPore-Fast5-Conversion-to-FastQ-of-C.bairdi-20102558-2729-Run-01-on-Mox-with-GPU-Node/)\n\n- [C.bairdi-20102558-2729-Run-02](https://robertslab.github.io/sams-notebook/posts/2020/2020-09-04-Data-Wrangling---NanoPore-Fast5-Conversion-to-FastQ-of-C.bairdi-20102558-2729-Run-02-on-Mox-with-GPU-Node/)\n\n- [C.bairdi-6129_403_26](https://robertslab.github.io/sams-notebook/posts/2020/2020-09-04-Data-Wrangling---NanoPore-Fast5-Conversion-to-FastQ-of-C.bairdi-6129_403_26-on-Mox-with-GPU-Node/)\n\nBefore proceeding with assembly and/or trying to tease out taxonomic differences (the C.bairdi-6129_403_26 is from an individual infected with _Hematodinium_), I want to get an idea of how the data looks. So, I've decided to process the `sequencing_summary.txt` file from each Fast5 conversion with [NanoPlot](https://github.com/wdecoster/NanoPlot). This software spits out some tables and some very nice visualizations to help get a better idea of how the sequencing runs look. This was run on Mox.\n\nSBATCH script (GitHub):\n\n- [20200914_cbai_nanoplot_nanopore-data.sh](https://github.com/RobertsLab/sams-notebook/blob/master/sbatch_scripts/20200914_cbai_nanoplot_nanopore-data.sh)\n\n```shell\n#!/bin/bash\n#SBATCH --job-name=cbai_nanoplot_nanopore-data\n## Allocation Definition\n#SBATCH --account=coenv\n#SBATCH --partition=coenv\n## Resources\n## Nodes\n#SBATCH --nodes=1\n## Walltime (days-hours:minutes:seconds format)\n#SBATCH --time=10-00:00:00\n## Memory per node\n#SBATCH --mem=120G\n##turn on e-mail notification\n#SBATCH --mail-type=ALL\n#SBATCH --mail-user=samwhite@uw.edu\n## Specify the working directory for this job\n#SBATCH --chdir=/gscratch/scrubbed/samwhite/outputs/20200914_cbai_nanoplot_nanopore-data\n\n\n\n\n###################################################################################\n# These variables need to be set by user\n\n# Load Anaconda\n# Uknown why this is needed, but Anaconda will not run if this line is not included.\n. \"/gscratch/srlab/programs/anaconda3/etc/profile.d/conda.sh\"\n\n\n# Activate the NanoPlot Anaconda environment\nconda activate nanoplot_env\n\n# Set number of CPUs to use\nthreads=28\n\n# Paths to reads\nraw_reads_dir_array=(\n\"/gscratch/srlab/sam/data/C_bairdi/DNAseq/ont_FAL58500_04bb4d86_20102558-2729\" \\\n\"/gscratch/srlab/sam/data/C_bairdi/DNAseq/ont_FAL58500_94244ffd_20102558-2729\" \\\n\"/gscratch/srlab/sam/data/C_bairdi/DNAseq/ont_FAL86873_d8db260e_cbai_6129_403_26\"\n)\n\n# Paths to programs\nnanoplot=NanoPlot\n\n\n###################################################################################\n\n\n# Exit script if any command fails\nset -e\n\n\n# Capture this directory\nwd=$(pwd)\n\n# Inititalize array\nprograms_array=()\n\n\n# Programs array\nprograms_array=(\"${nanoplot}\")\n\n\n# Loop through NanoPore data directories\n# to run NanoPlot, FastQC, and MultiQC\nfor directory in \"${!raw_reads_dir_array[@]}\"\ndo\n\n\n  # Capture NanoPore directory name\n  dir_name=${raw_reads_dir_array[directory]##*/}\n\n  # Make new directory and change to that directory\n  mkdir \"${dir_name}\" && cd \"$_\"\n\n  current_dir=$(pwd)\n\n\n  # Run NanoPlot\n  ## Sets readtype to 1D (default)\n  ## Shows N50 on histograms\n  ## Analysis perfomred using the sequencing summary file generated by\n  ## guppy when converting from Fast5 to FastQ\n  ${programs_array[nanoplot]} \\\n  --threads ${threads} \\\n  --outdir ${current_dir} \\\n  --readtype 1D \\\n  --N50 \\\n  --summary \"${raw_reads_dir_array[directory]}\"/sequencing_summary.txt\n\n  # Change back to working directory\n  cd \"${wd}\"\n\ndone\n\n\n# Capture program options\nfor program in \"${!programs_array[@]}\"\ndo\n\t{\n  echo \"Program options for ${programs_array[program]}: \"\n\techo \"\"\n\t${programs_array[program]} -h\n\techo \"\"\n\techo \"\"\n\techo \"----------------------------------------------\"\n\techo \"\"\n\techo \"\"\n} &>> program_options.log || true\ndone\n\n# Document programs in PATH (primarily for program version ID)\n{\ndate\necho \"\"\necho \"System PATH for $SLURM_JOB_ID\"\necho \"\"\nprintf \"%0.s-\" {1..10}\necho \"${PATH}\" | tr : \\\\n\n} >> system_path.log\n\n```\n\n---\n\n# RESULTS\n\nVery fast, 50s:\n\n![NanoPlot cumulative runtime for all three C.bairdi NanoPore data sets](https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200914_cbai_nanoplot_nanopore-data.png?raw=true)\n\nOutput folder:\n\n- [20200914_cbai_nanoplot_nanopore-data/](https://gannet.fish.washington.edu/Atumefaciens/20200914_cbai_nanoplot_nanopore-data/)\n\nEach of the NanoPore NanoPlot analyses are in individual folders, linked below. Although I've only linked to the full report (in HTML format) for each, the plots and data present in the full report are also available in individual images/files within those folders.\n\n\n##### C.bairdi-20102558-2729_Run-01 (FAL58500_94244ffd)\n\nOutput folder:\n\n- [20200914_cbai_nanoplot_nanopore-data/ont_FAL58500_94244ffd_20102558-2729/](https://gannet.fish.washington.edu/Atumefaciens/20200914_cbai_nanoplot_nanopore-data/ont_FAL58500_94244ffd_20102558-2729/)\n\nFull report (HTML):\n\n- [20200914_cbai_nanoplot_nanopore-data/ont_FAL58500_94244ffd_20102558-2729/NanoPlot-report.html](https://gannet.fish.washington.edu/Atumefaciens/20200914_cbai_nanoplot_nanopore-data/ont_FAL58500_94244ffd_20102558-2729/NanoPlot-report.html)\n\n\n| General summary     |              |\n|---------------------|--------------|\n| Active channels     | 491.0        |\n| Mean read length    | 821.6        |\n| Mean read quality   | 10.1         |\n| Median read length  | 533.0        |\n| Median read quality | 10.6         |\n| Number of reads     | 78,720.0     |\n| Read length N50     | 1,254.0      |\n| Total bases         | 64,672,912.0 |\n\nNumber, percentage and megabases of reads above quality cutoffs:\n\n| Quality_cutoff | reads(count) | percentage | bases(count) |\n|----------------|--------------|------------|--------------|\n| >Q5            | 73315        | (93.1%)    | 60.5Mb       |\n| >Q7            | 67186        | (85.3%)    | 56.5Mb       |\n| >Q10           | 46724        | (59.4%)    | 41.4Mb       |\n| >Q12           | 20961        | (26.6%)    | 20.6Mb       |\n| >Q15           | 966          | (1.2%)     | 0.8Mb        |\n\n\nTop 5 highest mean basecall quality scores and their read lengths:\n\n| Rank | mean_quality | read_length(bp) | bases(count) |\n|------|--------------|-----------------|--------------|\n| 1    | 22           | (682)           | 60.5Mb       |\n| 2    | 19.8         | (471)           | 56.5Mb       |\n| 3    | 19.1         | (414)           | 41.4Mb       |\n| 4    | 19.1         | (1539)          | 20.6Mb       |\n| 5    | 19           | (234)           | 0.8Mb        |\n\nTop 5 longest reads and their mean basecall quality score:\n\n| Rank | read_length(bp) | mean_quality_score |\n|------|-----------------|--------------------|\n| 1    | 62629           | (3.3)              |\n| 2    | 51173           | (3.5)              |\n| 3    | 45909           | (3.0)              |\n| 4    | 44689           | (3.4)              |\n| 5    | 42633           | (3.0)              |\n\n![FAL58500_94244ffd NanoPlot read density plot](https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200914_cbai_nanoplot_nanopore-data_ont_FAL58500_94244ffd_20102558-2729_density-plot.png?raw=true)\n\n---\n\n##### C.bairdi-20102558-2729_Run-02 (FAL58500_04bb4d86)\n\nOutput folder:\n\n- [20200914_cbai_nanoplot_nanopore-data/ont_FAL58500_04bb4d86_20102558-2729/](https://gannet.fish.washington.edu/Atumefaciens/20200914_cbai_nanoplot_nanopore-data/ont_FAL58500_04bb4d86_20102558-2729/)\n\nFull report (HTML):\n\n- [20200914_cbai_nanoplot_nanopore-data/ont_FAL58500_04bb4d86_20102558-2729/NanoPlot-report.html](https://gannet.fish.washington.edu/Atumefaciens/20200914_cbai_nanoplot_nanopore-data/ont_FAL58500_04bb4d86_20102558-2729/NanoPlot-report.html)\n\n| GENERAL SUMMARY     |              |\n|---------------------|--------------|\n| Active channels     | 424.0        |\n| Mean read length    | 845.5        |\n| Mean read quality   | 8.7          |\n| Median read length  | 521.0        |\n| Median read quality | 9.3          |\n| Number of reads     | 21,519.0     |\n| Read length N50     | 1,406.0      |\n| Total bases         | 18,195,027.0 |\n\nNumber, percentage and megabases of reads above quality cutoffs:\n\n| Quality_cutoff | reads(count) | percentage | bases(count) |\n|----------------|--------------|------------|--------------|\n| >Q5            | 17207        | (80.0%)    | 15.4Mb       |\n| >Q7            | 14864        | (69.1%)    | 13.9Mb       |\n| >Q10           | 8797         | (40.9%)    | 8.9Mb        |\n| >Q12           | 3257         | (15.1%)    | 3.6Mb        |\n| >Q15           | 121          | (0.6%)     | 0.1Mb        |\n\n\nTop 5 highest mean basecall quality scores and their read lengths:\n\n| Rank | mean_quality | read_length(bp) |\n|------|--------------|-----------------|\n| 1    | 18.3         | (323)           |\n| 2    | 17.8         | (1064)          |\n| 3    | 17.4         | (201)           |\n| 4    | 17.3         | (761)           |\n| 5    | 16.9         | (642)           |\n\n\nTop 5 longest reads and their mean basecall quality score:\n\n| Rank | read_length(bp) | mean_quality_score |\n|------|-----------------|--------------------|\n| 1    | 31170           | (3.4)              |\n| 2    | 28158           | (3.2)              |\n| 3    | 27016           | (3.3)              |\n| 4    | 24304           | (3.6)              |\n| 5    | 15552           | (2.9)              |\n\n![FAL58500_04bb4d86 NanoPlot read density plot](https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200914_cbai_nanoplot_nanopore-data_ont_FAL58500_04bb4d86_20102558-2729_density-plot.png?raw=true)\n\n---\n\n#### C.bairdi-6129_403_26 (FAL86873_d8db260e)\n\nOutput folder:\n\n- [20200914_cbai_nanoplot_nanopore-data/ont_FAL86873_d8db260e_cbai_6129_403_26/](https://gannet.fish.washington.edu/Atumefaciens/20200914_cbai_nanoplot_nanopore-data/ont_FAL86873_d8db260e_cbai_6129_403_26/)\n\nFull report (HTML):\n\n- [20200914_cbai_nanoplot_nanopore-data/ont_FAL86873_d8db260e_cbai_6129_403_26/NanoPlot-report.html](https://gannet.fish.washington.edu/Atumefaciens/20200914_cbai_nanoplot_nanopore-data/ont_FAL86873_d8db260e_cbai_6129_403_26/NanoPlot-report.html)\n\n\n| GENERAL SUMMARY     |            |\n|---------------------|------------|\n| Active channels     | 503        |\n| Mean read length    | 2254.5     |\n| Mean read quality   | 10.9       |\n| Median read length  | 965        |\n| Median read quality | 11.2       |\n| Number of reads     | 506495     |\n| Read length N50     | 5232       |\n| Total bases         | 1141890358 |\n\nNumber, percentage and megabases of reads above quality cutoffs:\n\n| Quality_cutoff | reads(count) | percentage | bases(count) |\n|----------------|--------------|------------|--------------|\n| >Q5            | 493598       | (97.5%)    | 1124.9Mb     |\n| >Q7            | 465033       | (91.8%)    | 1075.5Mb     |\n| >Q10           | 343296       | (67.8%)    | 880.9Mb      |\n| >Q12           | 186709       | (36.9%)    | 568.7Mb      |\n| >Q15           | 7394         | (1.5%)     | 17.9Mb       |\n\nTop 5 highest mean basecall quality scores and their read lengths:\n\n| Rank | mean_quality | read_length(bp) |\n|------|--------------|-----------------|\n| 1    | 20.6         | (980)           |\n| 2    | 20.2         | (1228)          |\n| 3    | 19.7         | (902)           |\n| 4    | 19.6         | (466)           |\n| 5    | 19.6         | (757)           |\n\n\nTop 5 longest reads and their mean basecall quality score:\n\n| Rank | read_length(bp) | mean_quality_score |\n|------|-----------------|--------------------|\n| 1    | 58854           | (11.8)             |\n| 2    | 57315           | (10.8)             |\n| 3    | 51351           | (11.5)             |\n| 4    | 51326           | (13.7)             |\n| 5    | 49825           | (12.9)             |\n\n![FAL86873_d8db260e NanoPlot read density plot](https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200914_cbai_nanoplot_nanopore-data_ont_FAL86873_d8db260e_cbai_6129_403_26_density-plot.png?raw=true)\n\n---\n\nFirst, we should compare the two C.bairdi-20102558-2729 runs (degraded input DNA, no _Hematodinium_ infection), as these were the same sample, run on the same flowcell.\n\nBasically, the second run on the flowcell performs worse in every metric: fewer reads, lower quality scores, shorter read lengths, etc. This is despite the fact that this flowcell was run for nearly 4.5x longer period of time (72hrs vs. 16hrs). This isn't terribly surprising, as [the second run started with only 414 available pores](https://robertslab.github.io/sams-notebook/posts/2020/2020-01-09-NanoPore-Sequencing---C.bairdi-gDNA-Sample-20102558-2729/), which is well below the ONT-suggested minimum of 800 pores for a \"good\" flowcell, but it is interesting to see the actual impacts on sequencing that this has.\n\nThe C.bairdi-6129_403_26 run (high quality input DNA, with _Hematodinium_ infection) is a better example of what to expect when using non-degraded DNA. Every metric is _substantially_ better than the C.bairdi-20102558-2729 runs.\n\nNow, how to proceed? First, I think I'll just get an assembly made, utilizing all three sets of data, despite the presence of _Hematodinium_ in the C.bairdi-6129_403_26 run. I'll tackle the assembly using [Flye](https://github.com/fenderglass/Flye), as it seems straightforward, is specifically designed for long read assembly, and has built-in assembly \"polishing\". This will be a start.\n\nIn regards to teasing out _Hematodinium_ sequences, I'll probably go through the DIAMOND BLASTx -> MEGAN6 process that I've used throughout our _C.baird_ RNAseq project for transcriptome assemblies. MEGAN6 can handle long reads and makes taxonomic read extraction straightforward.\n","srcMarkdownNoYaml":"\nI previously converting our _C.bairdi_ NanoPre sequencing data from the raw Fast5 format to FastQ format for our three sets of data:\n\n- [C.bairdi-20102558-2729-Run-01](https://robertslab.github.io/sams-notebook/posts/2020/2020-09-04-Data-Wrangling---NanoPore-Fast5-Conversion-to-FastQ-of-C.bairdi-20102558-2729-Run-01-on-Mox-with-GPU-Node/)\n\n- [C.bairdi-20102558-2729-Run-02](https://robertslab.github.io/sams-notebook/posts/2020/2020-09-04-Data-Wrangling---NanoPore-Fast5-Conversion-to-FastQ-of-C.bairdi-20102558-2729-Run-02-on-Mox-with-GPU-Node/)\n\n- [C.bairdi-6129_403_26](https://robertslab.github.io/sams-notebook/posts/2020/2020-09-04-Data-Wrangling---NanoPore-Fast5-Conversion-to-FastQ-of-C.bairdi-6129_403_26-on-Mox-with-GPU-Node/)\n\nBefore proceeding with assembly and/or trying to tease out taxonomic differences (the C.bairdi-6129_403_26 is from an individual infected with _Hematodinium_), I want to get an idea of how the data looks. So, I've decided to process the `sequencing_summary.txt` file from each Fast5 conversion with [NanoPlot](https://github.com/wdecoster/NanoPlot). This software spits out some tables and some very nice visualizations to help get a better idea of how the sequencing runs look. This was run on Mox.\n\nSBATCH script (GitHub):\n\n- [20200914_cbai_nanoplot_nanopore-data.sh](https://github.com/RobertsLab/sams-notebook/blob/master/sbatch_scripts/20200914_cbai_nanoplot_nanopore-data.sh)\n\n```shell\n#!/bin/bash\n## Job Name\n#SBATCH --job-name=cbai_nanoplot_nanopore-data\n## Allocation Definition\n#SBATCH --account=coenv\n#SBATCH --partition=coenv\n## Resources\n## Nodes\n#SBATCH --nodes=1\n## Walltime (days-hours:minutes:seconds format)\n#SBATCH --time=10-00:00:00\n## Memory per node\n#SBATCH --mem=120G\n##turn on e-mail notification\n#SBATCH --mail-type=ALL\n#SBATCH --mail-user=samwhite@uw.edu\n## Specify the working directory for this job\n#SBATCH --chdir=/gscratch/scrubbed/samwhite/outputs/20200914_cbai_nanoplot_nanopore-data\n\n\n\n\n###################################################################################\n# These variables need to be set by user\n\n# Load Anaconda\n# Uknown why this is needed, but Anaconda will not run if this line is not included.\n. \"/gscratch/srlab/programs/anaconda3/etc/profile.d/conda.sh\"\n\n\n# Activate the NanoPlot Anaconda environment\nconda activate nanoplot_env\n\n# Set number of CPUs to use\nthreads=28\n\n# Paths to reads\nraw_reads_dir_array=(\n\"/gscratch/srlab/sam/data/C_bairdi/DNAseq/ont_FAL58500_04bb4d86_20102558-2729\" \\\n\"/gscratch/srlab/sam/data/C_bairdi/DNAseq/ont_FAL58500_94244ffd_20102558-2729\" \\\n\"/gscratch/srlab/sam/data/C_bairdi/DNAseq/ont_FAL86873_d8db260e_cbai_6129_403_26\"\n)\n\n# Paths to programs\nnanoplot=NanoPlot\n\n\n###################################################################################\n\n\n# Exit script if any command fails\nset -e\n\n\n# Capture this directory\nwd=$(pwd)\n\n# Inititalize array\nprograms_array=()\n\n\n# Programs array\nprograms_array=(\"${nanoplot}\")\n\n\n# Loop through NanoPore data directories\n# to run NanoPlot, FastQC, and MultiQC\nfor directory in \"${!raw_reads_dir_array[@]}\"\ndo\n\n\n  # Capture NanoPore directory name\n  dir_name=${raw_reads_dir_array[directory]##*/}\n\n  # Make new directory and change to that directory\n  mkdir \"${dir_name}\" && cd \"$_\"\n\n  current_dir=$(pwd)\n\n\n  # Run NanoPlot\n  ## Sets readtype to 1D (default)\n  ## Shows N50 on histograms\n  ## Analysis perfomred using the sequencing summary file generated by\n  ## guppy when converting from Fast5 to FastQ\n  ${programs_array[nanoplot]} \\\n  --threads ${threads} \\\n  --outdir ${current_dir} \\\n  --readtype 1D \\\n  --N50 \\\n  --summary \"${raw_reads_dir_array[directory]}\"/sequencing_summary.txt\n\n  # Change back to working directory\n  cd \"${wd}\"\n\ndone\n\n\n# Capture program options\nfor program in \"${!programs_array[@]}\"\ndo\n\t{\n  echo \"Program options for ${programs_array[program]}: \"\n\techo \"\"\n\t${programs_array[program]} -h\n\techo \"\"\n\techo \"\"\n\techo \"----------------------------------------------\"\n\techo \"\"\n\techo \"\"\n} &>> program_options.log || true\ndone\n\n# Document programs in PATH (primarily for program version ID)\n{\ndate\necho \"\"\necho \"System PATH for $SLURM_JOB_ID\"\necho \"\"\nprintf \"%0.s-\" {1..10}\necho \"${PATH}\" | tr : \\\\n\n} >> system_path.log\n\n```\n\n---\n\n# RESULTS\n\nVery fast, 50s:\n\n![NanoPlot cumulative runtime for all three C.bairdi NanoPore data sets](https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200914_cbai_nanoplot_nanopore-data.png?raw=true)\n\nOutput folder:\n\n- [20200914_cbai_nanoplot_nanopore-data/](https://gannet.fish.washington.edu/Atumefaciens/20200914_cbai_nanoplot_nanopore-data/)\n\nEach of the NanoPore NanoPlot analyses are in individual folders, linked below. Although I've only linked to the full report (in HTML format) for each, the plots and data present in the full report are also available in individual images/files within those folders.\n\n\n##### C.bairdi-20102558-2729_Run-01 (FAL58500_94244ffd)\n\nOutput folder:\n\n- [20200914_cbai_nanoplot_nanopore-data/ont_FAL58500_94244ffd_20102558-2729/](https://gannet.fish.washington.edu/Atumefaciens/20200914_cbai_nanoplot_nanopore-data/ont_FAL58500_94244ffd_20102558-2729/)\n\nFull report (HTML):\n\n- [20200914_cbai_nanoplot_nanopore-data/ont_FAL58500_94244ffd_20102558-2729/NanoPlot-report.html](https://gannet.fish.washington.edu/Atumefaciens/20200914_cbai_nanoplot_nanopore-data/ont_FAL58500_94244ffd_20102558-2729/NanoPlot-report.html)\n\n\n| General summary     |              |\n|---------------------|--------------|\n| Active channels     | 491.0        |\n| Mean read length    | 821.6        |\n| Mean read quality   | 10.1         |\n| Median read length  | 533.0        |\n| Median read quality | 10.6         |\n| Number of reads     | 78,720.0     |\n| Read length N50     | 1,254.0      |\n| Total bases         | 64,672,912.0 |\n\nNumber, percentage and megabases of reads above quality cutoffs:\n\n| Quality_cutoff | reads(count) | percentage | bases(count) |\n|----------------|--------------|------------|--------------|\n| >Q5            | 73315        | (93.1%)    | 60.5Mb       |\n| >Q7            | 67186        | (85.3%)    | 56.5Mb       |\n| >Q10           | 46724        | (59.4%)    | 41.4Mb       |\n| >Q12           | 20961        | (26.6%)    | 20.6Mb       |\n| >Q15           | 966          | (1.2%)     | 0.8Mb        |\n\n\nTop 5 highest mean basecall quality scores and their read lengths:\n\n| Rank | mean_quality | read_length(bp) | bases(count) |\n|------|--------------|-----------------|--------------|\n| 1    | 22           | (682)           | 60.5Mb       |\n| 2    | 19.8         | (471)           | 56.5Mb       |\n| 3    | 19.1         | (414)           | 41.4Mb       |\n| 4    | 19.1         | (1539)          | 20.6Mb       |\n| 5    | 19           | (234)           | 0.8Mb        |\n\nTop 5 longest reads and their mean basecall quality score:\n\n| Rank | read_length(bp) | mean_quality_score |\n|------|-----------------|--------------------|\n| 1    | 62629           | (3.3)              |\n| 2    | 51173           | (3.5)              |\n| 3    | 45909           | (3.0)              |\n| 4    | 44689           | (3.4)              |\n| 5    | 42633           | (3.0)              |\n\n![FAL58500_94244ffd NanoPlot read density plot](https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200914_cbai_nanoplot_nanopore-data_ont_FAL58500_94244ffd_20102558-2729_density-plot.png?raw=true)\n\n---\n\n##### C.bairdi-20102558-2729_Run-02 (FAL58500_04bb4d86)\n\nOutput folder:\n\n- [20200914_cbai_nanoplot_nanopore-data/ont_FAL58500_04bb4d86_20102558-2729/](https://gannet.fish.washington.edu/Atumefaciens/20200914_cbai_nanoplot_nanopore-data/ont_FAL58500_04bb4d86_20102558-2729/)\n\nFull report (HTML):\n\n- [20200914_cbai_nanoplot_nanopore-data/ont_FAL58500_04bb4d86_20102558-2729/NanoPlot-report.html](https://gannet.fish.washington.edu/Atumefaciens/20200914_cbai_nanoplot_nanopore-data/ont_FAL58500_04bb4d86_20102558-2729/NanoPlot-report.html)\n\n| GENERAL SUMMARY     |              |\n|---------------------|--------------|\n| Active channels     | 424.0        |\n| Mean read length    | 845.5        |\n| Mean read quality   | 8.7          |\n| Median read length  | 521.0        |\n| Median read quality | 9.3          |\n| Number of reads     | 21,519.0     |\n| Read length N50     | 1,406.0      |\n| Total bases         | 18,195,027.0 |\n\nNumber, percentage and megabases of reads above quality cutoffs:\n\n| Quality_cutoff | reads(count) | percentage | bases(count) |\n|----------------|--------------|------------|--------------|\n| >Q5            | 17207        | (80.0%)    | 15.4Mb       |\n| >Q7            | 14864        | (69.1%)    | 13.9Mb       |\n| >Q10           | 8797         | (40.9%)    | 8.9Mb        |\n| >Q12           | 3257         | (15.1%)    | 3.6Mb        |\n| >Q15           | 121          | (0.6%)     | 0.1Mb        |\n\n\nTop 5 highest mean basecall quality scores and their read lengths:\n\n| Rank | mean_quality | read_length(bp) |\n|------|--------------|-----------------|\n| 1    | 18.3         | (323)           |\n| 2    | 17.8         | (1064)          |\n| 3    | 17.4         | (201)           |\n| 4    | 17.3         | (761)           |\n| 5    | 16.9         | (642)           |\n\n\nTop 5 longest reads and their mean basecall quality score:\n\n| Rank | read_length(bp) | mean_quality_score |\n|------|-----------------|--------------------|\n| 1    | 31170           | (3.4)              |\n| 2    | 28158           | (3.2)              |\n| 3    | 27016           | (3.3)              |\n| 4    | 24304           | (3.6)              |\n| 5    | 15552           | (2.9)              |\n\n![FAL58500_04bb4d86 NanoPlot read density plot](https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200914_cbai_nanoplot_nanopore-data_ont_FAL58500_04bb4d86_20102558-2729_density-plot.png?raw=true)\n\n---\n\n#### C.bairdi-6129_403_26 (FAL86873_d8db260e)\n\nOutput folder:\n\n- [20200914_cbai_nanoplot_nanopore-data/ont_FAL86873_d8db260e_cbai_6129_403_26/](https://gannet.fish.washington.edu/Atumefaciens/20200914_cbai_nanoplot_nanopore-data/ont_FAL86873_d8db260e_cbai_6129_403_26/)\n\nFull report (HTML):\n\n- [20200914_cbai_nanoplot_nanopore-data/ont_FAL86873_d8db260e_cbai_6129_403_26/NanoPlot-report.html](https://gannet.fish.washington.edu/Atumefaciens/20200914_cbai_nanoplot_nanopore-data/ont_FAL86873_d8db260e_cbai_6129_403_26/NanoPlot-report.html)\n\n\n| GENERAL SUMMARY     |            |\n|---------------------|------------|\n| Active channels     | 503        |\n| Mean read length    | 2254.5     |\n| Mean read quality   | 10.9       |\n| Median read length  | 965        |\n| Median read quality | 11.2       |\n| Number of reads     | 506495     |\n| Read length N50     | 5232       |\n| Total bases         | 1141890358 |\n\nNumber, percentage and megabases of reads above quality cutoffs:\n\n| Quality_cutoff | reads(count) | percentage | bases(count) |\n|----------------|--------------|------------|--------------|\n| >Q5            | 493598       | (97.5%)    | 1124.9Mb     |\n| >Q7            | 465033       | (91.8%)    | 1075.5Mb     |\n| >Q10           | 343296       | (67.8%)    | 880.9Mb      |\n| >Q12           | 186709       | (36.9%)    | 568.7Mb      |\n| >Q15           | 7394         | (1.5%)     | 17.9Mb       |\n\nTop 5 highest mean basecall quality scores and their read lengths:\n\n| Rank | mean_quality | read_length(bp) |\n|------|--------------|-----------------|\n| 1    | 20.6         | (980)           |\n| 2    | 20.2         | (1228)          |\n| 3    | 19.7         | (902)           |\n| 4    | 19.6         | (466)           |\n| 5    | 19.6         | (757)           |\n\n\nTop 5 longest reads and their mean basecall quality score:\n\n| Rank | read_length(bp) | mean_quality_score |\n|------|-----------------|--------------------|\n| 1    | 58854           | (11.8)             |\n| 2    | 57315           | (10.8)             |\n| 3    | 51351           | (11.5)             |\n| 4    | 51326           | (13.7)             |\n| 5    | 49825           | (12.9)             |\n\n![FAL86873_d8db260e NanoPlot read density plot](https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200914_cbai_nanoplot_nanopore-data_ont_FAL86873_d8db260e_cbai_6129_403_26_density-plot.png?raw=true)\n\n---\n\nFirst, we should compare the two C.bairdi-20102558-2729 runs (degraded input DNA, no _Hematodinium_ infection), as these were the same sample, run on the same flowcell.\n\nBasically, the second run on the flowcell performs worse in every metric: fewer reads, lower quality scores, shorter read lengths, etc. This is despite the fact that this flowcell was run for nearly 4.5x longer period of time (72hrs vs. 16hrs). This isn't terribly surprising, as [the second run started with only 414 available pores](https://robertslab.github.io/sams-notebook/posts/2020/2020-01-09-NanoPore-Sequencing---C.bairdi-gDNA-Sample-20102558-2729/), which is well below the ONT-suggested minimum of 800 pores for a \"good\" flowcell, but it is interesting to see the actual impacts on sequencing that this has.\n\nThe C.bairdi-6129_403_26 run (high quality input DNA, with _Hematodinium_ infection) is a better example of what to expect when using non-degraded DNA. Every metric is _substantially_ better than the C.bairdi-20102558-2729 runs.\n\nNow, how to proceed? First, I think I'll just get an assembly made, utilizing all three sets of data, despite the presence of _Hematodinium_ in the C.bairdi-6129_403_26 run. I'll tackle the assembly using [Flye](https://github.com/fenderglass/Flye), as it seems straightforward, is specifically designed for long read assembly, and has built-in assembly \"polishing\". This will be a start.\n\nIn regards to teasing out _Hematodinium_ sequences, I'll probably go through the DIAMOND BLASTx -> MEGAN6 process that I've used throughout our _C.baird_ RNAseq project for transcriptome assemblies. MEGAN6 can handle long reads and makes taxonomic read extraction straightforward.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../../styles.css"],"toc":true,"toc-depth":5,"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","editor":"source","theme":"darkly","page-layout":"full","code-background":true,"code-copy":true,"title-block-banner":true,"author":"Sam White","toc-title":"Contents","toc-location":"left","layout":"post","title":"Data Wrangling - Visualization of C.bairdi NanoPore Sequencing Using NanoPlot on Mox","date":"2020-09-14 10:20","tags":["Tanner crab","mox","nanoplot","Chionoecetes bairdi","Hematodinium","nanopore","gDNA","sequencing"],"categories":["2020","Miscellaneous"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}