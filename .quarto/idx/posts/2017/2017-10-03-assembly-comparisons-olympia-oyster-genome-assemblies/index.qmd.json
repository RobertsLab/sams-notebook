{"title":"Assembly Comparisons - Olympia oyster genome assemblies","markdown":{"yaml":{"author":"Sam White","toc-title":"Contents","toc-depth":5,"toc-location":"left","date":"2017-10-03 21:29:49+00:00","layout":"post","slug":"assembly-comparisons-olympia-oyster-genome-assemblies","title":"Assembly Comparisons - Olympia oyster genome assemblies","categories":["2017","Olympia Oyster Genome Sequencing","docker","jupyter notebook","olympia oyster","Ostrea lurida","QUAST"]},"headingText":"--- UPDATE 20171009 ---","containsRefs":false,"markdown":"\n\n\n\n\nHaving run through this a bunch of times now, I realized that the analysis below incorrectly identifies the outputs from Sean's Redundans runs. The correct output from each of those runs should be the \"scaffolds.reduced.fa\" FAST files. The \"contigs.fa\" files that I linked to below are actually the assemblies produced by other programs; which are required as an input for Redudans.\n\n\n\n* * *\n\n\n\nI recently completed an assembly of the [UW PacBio sequencing data using Racon](../2017-09-18-genome-assembly-olympia-oyster-pacbio-minimapminiasmracon-3/index.qmd) and wanted some assembly stats, as well as a way to compare this assembly to [the assemblies Sean had completed](../2017-08-28-project-progress-olympia-oyster-genome-assemblies-by-sean-bennett/index.qmd).\n\nAdditionally, [Steven recently performed an assembly comparison](https://sr320.github.io/Quast-Oly/) and I noticed he got some odd results. Specifically, of the three assemblies he compared (PacBio x 1, Illumina x 2), both of the Illumina assemblies had a large quantity of \"Ns\" in the assemblies. This didn't seem right and the comparison program he used ([QUAST](http://quast.sourceforge.net/quast)) spit out a message indicating that it seemed like scaffolds were used, instead of contigs. So, I thought I'd give it a shot and see if I could track down non-scaffolded assemblies produced by Sean.\n\nJupyter notebook (GitHub): [20171003_docker_oly_assembly_comparisons.ipynb](https://github.com/sr320/LabDocs/blob/master/jupyter_nbs/sam/20171003_docker_oly_assembly_comparisons.ipynb)\n\nFirst, I compared the following six assemblies (FASTA files) using QUAST:\n\nSean's Assemblies:\n\n\n\n\n\n  * PacBio (Canu): [https://owl.fish.washington.edu/scaphapoda/Sean/Oly_Canu_Output/oly_pacbio_.contigs.fasta](http://owl.fish.washington.edu/scaphapoda/Sean/Oly_Canu_Output/oly_pacbio_.contigs.fasta)\n\n\n  * Illumina (Platanus): [https://owl.fish.washington.edu/scaphapoda/Sean/Oly_Illumina_Platanus_Assembly/Oly_Out__contig.fa](http://owl.fish.washington.edu/scaphapoda/Sean/Oly_Illumina_Platanus_Assembly/Oly_Out__contig.fa)\n\n\n  * Illumina (Platanus): [https://owl.fish.washington.edu/scaphapoda/Sean/Oly_Platanus_Assembly_Kmer-22/Oly_Out__contig.fa](http://owl.fish.washington.edu/scaphapoda/Sean/Oly_Platanus_Assembly_Kmer-22/Oly_Out__contig.fa)\n\n\n  * Illumina/PacBio (Redundans): [https://owl.fish.washington.edu/scaphapoda/Sean/Oly_Redundans_Output/contigs.fa](http://owl.fish.washington.edu/scaphapoda/Sean/Oly_Redundans_Output/contigs.fa)\n\n\n  * Illumina/PacBio (Redundans): [https://owl.fish.washington.edu/scaphapoda/Sean/Oly_Redundans_Output_Try_2/contigs.fa](http://owl.fish.washington.edu/scaphapoda/Sean/Oly_Redundans_Output_Try_2/contigs.fa)\n\n\n\nSam's Assembly:\n\n\n\n  * PacBio (Racon): [https://owl.fish.washington.edu/Athaliana/201709_oly_pacbio_assembly_minimap_asm_racon/20170918_oly_pacbio_racon1_consensus.fasta](http://owl.fish.washington.edu/Athaliana/201709_oly_pacbio_assembly_minimap_asm_racon/20170918_oly_pacbio_racon1_consensus.fasta)\n\n\n\nQUAST output directory: [https://owl.fish.washington.edu/Athaliana/20171003_quast_oly_genome_assemblies/](http://owl.fish.washington.edu/Athaliana/20171003_quast_oly_genome_assemblies/)\n\nHere's the assembly comparison of all assemblies (click on image for larger view):\n\n![](https://owl.fish.washington.edu/Athaliana/20171003_oly_assemblies_00.png)(http://owl.fish.washington.edu/Athaliana/20171003_oly_assemblies_00.png)\n\nInteractive version of that graphic is here: [https://owl.fish.washington.edu/Athaliana/20171003_quast_oly_genome_assemblies/report.html](http://owl.fish.washington.edu/Athaliana/20171003_quast_oly_genome_assemblies/report.html)\n\nThe first thing that jumps out to me is the fact that two of the Illumina assemblies, which used _different assemblers(!!)_ have the _EXACT_ same assembly stats. This occurrence seems extremely unlikely. I've double-checked my [Jupyter notebook](https://github.com/sr320/LabDocs/blob/master/jupyter_nbs/sam/20171003_docker_oly_assembly_comparisons.ipynb) to make sure that I didn't assign the same file by accident (see Input #6)\n\n![](https://owl.fish.washington.edu/Athaliana/20171003_oly_assemblies_01.png)(http://owl.fish.washington.edu/Athaliana/20171003_oly_assemblies_01.png)\n\nVery strange!\n\nI also noticed that the first Redundans assembly of Sean's has a ton of \"Ns\", suggesting that it's actually a scaffolded assembly. As with Steven's QUAST run, QUAST spits out the messages suggesting to use the \"--scaffold\" option for this file.\n\nThe other thing I noticed is the two PacBio assemblies (Canu & Racon) have a _huge_ difference in the total number of bp (~13,000,000)! I ran a QUAST assembly comparison between just those two for easier viewing/comparison ([https://owl.fish.washington.edu/Athaliana/20171003_quast_oly_pacbio_assemblies/](http://owl.fish.washington.edu/Athaliana/20171003_quast_oly_pacbio_assemblies/)):\n\n![](https://owl.fish.washington.edu/Athaliana/20171003_oly_assemblies_03.png)(http://owl.fish.washington.edu/Athaliana/20171003_oly_assemblies_03.png)\n\nInteractive version of that graphic is here: [https://owl.fish.washington.edu/Athaliana/20171003_quast_oly_pacbio_assemblies/report.html](http://owl.fish.washington.edu/Athaliana/20171003_quast_oly_pacbio_assemblies/report.html)\n\nThe fact that there is such a large discrepancy in the total number of bps between these two assemblies really leaves me to believe that I am missing a FASTQ file from my assembly. I'm going to go back and see if that is indeed the case or if this difference in the assemblies is real.\n\nHere's an embedded version of my Jupyter notebook:\n\n<iframe src=\"https://nbviewer.jupyter.org/github/sr320/LabDocs/blob/master/jupyter_nbs/sam/20171003_docker_oly_assembly_comparisons.ipynb\" width=\"100%\" height=\"2000\" scrolling=\"yes\"></iframe>\n","srcMarkdownNoYaml":"\n\n### --- UPDATE 20171009 ---\n\n\n\nHaving run through this a bunch of times now, I realized that the analysis below incorrectly identifies the outputs from Sean's Redundans runs. The correct output from each of those runs should be the \"scaffolds.reduced.fa\" FAST files. The \"contigs.fa\" files that I linked to below are actually the assemblies produced by other programs; which are required as an input for Redudans.\n\n\n\n* * *\n\n\n\nI recently completed an assembly of the [UW PacBio sequencing data using Racon](../2017-09-18-genome-assembly-olympia-oyster-pacbio-minimapminiasmracon-3/index.qmd) and wanted some assembly stats, as well as a way to compare this assembly to [the assemblies Sean had completed](../2017-08-28-project-progress-olympia-oyster-genome-assemblies-by-sean-bennett/index.qmd).\n\nAdditionally, [Steven recently performed an assembly comparison](https://sr320.github.io/Quast-Oly/) and I noticed he got some odd results. Specifically, of the three assemblies he compared (PacBio x 1, Illumina x 2), both of the Illumina assemblies had a large quantity of \"Ns\" in the assemblies. This didn't seem right and the comparison program he used ([QUAST](http://quast.sourceforge.net/quast)) spit out a message indicating that it seemed like scaffolds were used, instead of contigs. So, I thought I'd give it a shot and see if I could track down non-scaffolded assemblies produced by Sean.\n\nJupyter notebook (GitHub): [20171003_docker_oly_assembly_comparisons.ipynb](https://github.com/sr320/LabDocs/blob/master/jupyter_nbs/sam/20171003_docker_oly_assembly_comparisons.ipynb)\n\nFirst, I compared the following six assemblies (FASTA files) using QUAST:\n\nSean's Assemblies:\n\n\n\n\n\n  * PacBio (Canu): [https://owl.fish.washington.edu/scaphapoda/Sean/Oly_Canu_Output/oly_pacbio_.contigs.fasta](http://owl.fish.washington.edu/scaphapoda/Sean/Oly_Canu_Output/oly_pacbio_.contigs.fasta)\n\n\n  * Illumina (Platanus): [https://owl.fish.washington.edu/scaphapoda/Sean/Oly_Illumina_Platanus_Assembly/Oly_Out__contig.fa](http://owl.fish.washington.edu/scaphapoda/Sean/Oly_Illumina_Platanus_Assembly/Oly_Out__contig.fa)\n\n\n  * Illumina (Platanus): [https://owl.fish.washington.edu/scaphapoda/Sean/Oly_Platanus_Assembly_Kmer-22/Oly_Out__contig.fa](http://owl.fish.washington.edu/scaphapoda/Sean/Oly_Platanus_Assembly_Kmer-22/Oly_Out__contig.fa)\n\n\n  * Illumina/PacBio (Redundans): [https://owl.fish.washington.edu/scaphapoda/Sean/Oly_Redundans_Output/contigs.fa](http://owl.fish.washington.edu/scaphapoda/Sean/Oly_Redundans_Output/contigs.fa)\n\n\n  * Illumina/PacBio (Redundans): [https://owl.fish.washington.edu/scaphapoda/Sean/Oly_Redundans_Output_Try_2/contigs.fa](http://owl.fish.washington.edu/scaphapoda/Sean/Oly_Redundans_Output_Try_2/contigs.fa)\n\n\n\nSam's Assembly:\n\n\n\n  * PacBio (Racon): [https://owl.fish.washington.edu/Athaliana/201709_oly_pacbio_assembly_minimap_asm_racon/20170918_oly_pacbio_racon1_consensus.fasta](http://owl.fish.washington.edu/Athaliana/201709_oly_pacbio_assembly_minimap_asm_racon/20170918_oly_pacbio_racon1_consensus.fasta)\n\n\n\nQUAST output directory: [https://owl.fish.washington.edu/Athaliana/20171003_quast_oly_genome_assemblies/](http://owl.fish.washington.edu/Athaliana/20171003_quast_oly_genome_assemblies/)\n\nHere's the assembly comparison of all assemblies (click on image for larger view):\n\n![](https://owl.fish.washington.edu/Athaliana/20171003_oly_assemblies_00.png)(http://owl.fish.washington.edu/Athaliana/20171003_oly_assemblies_00.png)\n\nInteractive version of that graphic is here: [https://owl.fish.washington.edu/Athaliana/20171003_quast_oly_genome_assemblies/report.html](http://owl.fish.washington.edu/Athaliana/20171003_quast_oly_genome_assemblies/report.html)\n\nThe first thing that jumps out to me is the fact that two of the Illumina assemblies, which used _different assemblers(!!)_ have the _EXACT_ same assembly stats. This occurrence seems extremely unlikely. I've double-checked my [Jupyter notebook](https://github.com/sr320/LabDocs/blob/master/jupyter_nbs/sam/20171003_docker_oly_assembly_comparisons.ipynb) to make sure that I didn't assign the same file by accident (see Input #6)\n\n![](https://owl.fish.washington.edu/Athaliana/20171003_oly_assemblies_01.png)(http://owl.fish.washington.edu/Athaliana/20171003_oly_assemblies_01.png)\n\nVery strange!\n\nI also noticed that the first Redundans assembly of Sean's has a ton of \"Ns\", suggesting that it's actually a scaffolded assembly. As with Steven's QUAST run, QUAST spits out the messages suggesting to use the \"--scaffold\" option for this file.\n\nThe other thing I noticed is the two PacBio assemblies (Canu & Racon) have a _huge_ difference in the total number of bp (~13,000,000)! I ran a QUAST assembly comparison between just those two for easier viewing/comparison ([https://owl.fish.washington.edu/Athaliana/20171003_quast_oly_pacbio_assemblies/](http://owl.fish.washington.edu/Athaliana/20171003_quast_oly_pacbio_assemblies/)):\n\n![](https://owl.fish.washington.edu/Athaliana/20171003_oly_assemblies_03.png)(http://owl.fish.washington.edu/Athaliana/20171003_oly_assemblies_03.png)\n\nInteractive version of that graphic is here: [https://owl.fish.washington.edu/Athaliana/20171003_quast_oly_pacbio_assemblies/report.html](http://owl.fish.washington.edu/Athaliana/20171003_quast_oly_pacbio_assemblies/report.html)\n\nThe fact that there is such a large discrepancy in the total number of bps between these two assemblies really leaves me to believe that I am missing a FASTQ file from my assembly. I'm going to go back and see if that is indeed the case or if this difference in the assemblies is real.\n\nHere's an embedded version of my Jupyter notebook:\n\n<iframe src=\"https://nbviewer.jupyter.org/github/sr320/LabDocs/blob/master/jupyter_nbs/sam/20171003_docker_oly_assembly_comparisons.ipynb\" width=\"100%\" height=\"2000\" scrolling=\"yes\"></iframe>\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../../styles.css"],"toc":true,"toc-depth":5,"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","editor":"source","theme":"darkly","page-layout":"full","code-background":true,"code-copy":true,"title-block-banner":true,"author":"Sam White","toc-title":"Contents","toc-location":"left","date":"2017-10-03 21:29:49+00:00","layout":"post","slug":"assembly-comparisons-olympia-oyster-genome-assemblies","title":"Assembly Comparisons - Olympia oyster genome assemblies","categories":["2017","Olympia Oyster Genome Sequencing","docker","jupyter notebook","olympia oyster","Ostrea lurida","QUAST"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}