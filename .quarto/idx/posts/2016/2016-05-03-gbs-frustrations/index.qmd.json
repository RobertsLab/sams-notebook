{"title":"GBS Frustrations","markdown":{"yaml":{"author":"Sam White","toc-title":"Contents","toc-depth":5,"toc-location":"left","date":"2016-05-03 23:16:00+00:00","layout":"post","slug":"gbs-frustrations","title":"GBS Frustrations","categories":["2016","Miscellaneous"],"tags":["Cyverse","GBS","genotype-by-sequencing","pyrad","stacks","tassel"]},"containsRefs":false,"markdown":"\n\nThis isn't really a notebook entry - it's more of a traditional blog post.\n\nIt's a quick summary of the frustrations and struggles I've encountered while trying to analyze the Olympia oyster GBS data. Hopefully it will serve as a place holder for others to find (and avoid) some of the pitfalls I've encountered so far. But, mostly, this is just for me to vent...\n\n\n\n\n\n  1. Using the Stacks program (on Hummingbird over the network to our server Owl) takes forever and, more importantly, consistently fails to complete the ustacks and cstacks programs.\n\n\n\n  2. Using the Stacks program (on Hummingbird via external HDD connected through Firewire) takes forever (combined, process_radtags and ustacks has been running since 20160428; that's eight days)!!! Granted, this is running on all 96 samples, but, regardless, this type of time frame is not very conducive to productivity.\n\n\n\n  3. The \"raw\" non-demultiplexed fastq files supplied by BGI have a 'N' in the barcode in the FASTQ header lines. This prevents Stacks (and possibly Tassel - I'll get to this in a second) from being able to perform the demultiplexing. Here's a screen shot of what I'm talking about:\n\n\n\n\n\n\n![](https://owl.fish.washington.edu/Athaliana/20160503_BGI_GBS_fastq_header_barcode.png)(http://owl.fish.washington.edu/Athaliana/20160503_BGI_GBS_fastq_header_barcode.png)\n\n\n\n\n\n  1. Cyverse has a program called Tassel that should be able to handle GBS data just like ours. However, it doesn't produce the expected output to proceed to the second step. Although I haven't tested it, it's possible that the problem is related to the 'N' in the FASTQ header barcode sequence I mentioned above. I suspect it's related because the first step in using Tassel is demultiplexing utilizing a supplied barcode keyfile.\n\n\n\n  2. Cyverse has Stacks installed, but in order to use it, someone has to build a Cyverse \"app.\" I've tried and the process is brutal. It's not conducive for a program (that is really a suite of programs) like Stacks that has so many command line options and, depending on your input file types (e.g. \"non-standard\" Illumina filenames for paired-end sequencing), requires looping over filenames to specify corresponding file pairs.\n\n\n\n  3. Pyrad actually worked relatively well, but the VCF output file (for visualizing in the Integrative Genomics Viewer) has an ill-formed header that IGV won't accept. Attempts at tweaking the header don't seem to resolve the issue. Additionally, it's not apparent in the output files if individuals get grouped, even though there is an option to specify which individuals should be grouped together.\n\n\n\n  4. And, the most frustrating thing of all???!!!  I just realized how to handle the problematic barcodes in the FASTQ headers!! Instead of trying to alter the FASTQ files (which I've been messing around with over the past few days), all I've needed to do this entire time is CHANGE THE BARCODE KEY FILE THAT STACKS AND/OR TASSEL USES TO HAVE A 'N' AT THE BEGINNING OF EACH BARCODE!\n\n\n\n\n\n\nI'm going to go cry now...\n\nRegardless of that last one, it doesn't change the fact that Stacks is painfully slow and, at times, unreliable.\n","srcMarkdownNoYaml":"\n\nThis isn't really a notebook entry - it's more of a traditional blog post.\n\nIt's a quick summary of the frustrations and struggles I've encountered while trying to analyze the Olympia oyster GBS data. Hopefully it will serve as a place holder for others to find (and avoid) some of the pitfalls I've encountered so far. But, mostly, this is just for me to vent...\n\n\n\n\n\n  1. Using the Stacks program (on Hummingbird over the network to our server Owl) takes forever and, more importantly, consistently fails to complete the ustacks and cstacks programs.\n\n\n\n  2. Using the Stacks program (on Hummingbird via external HDD connected through Firewire) takes forever (combined, process_radtags and ustacks has been running since 20160428; that's eight days)!!! Granted, this is running on all 96 samples, but, regardless, this type of time frame is not very conducive to productivity.\n\n\n\n  3. The \"raw\" non-demultiplexed fastq files supplied by BGI have a 'N' in the barcode in the FASTQ header lines. This prevents Stacks (and possibly Tassel - I'll get to this in a second) from being able to perform the demultiplexing. Here's a screen shot of what I'm talking about:\n\n\n\n\n\n\n![](https://owl.fish.washington.edu/Athaliana/20160503_BGI_GBS_fastq_header_barcode.png)(http://owl.fish.washington.edu/Athaliana/20160503_BGI_GBS_fastq_header_barcode.png)\n\n\n\n\n\n  1. Cyverse has a program called Tassel that should be able to handle GBS data just like ours. However, it doesn't produce the expected output to proceed to the second step. Although I haven't tested it, it's possible that the problem is related to the 'N' in the FASTQ header barcode sequence I mentioned above. I suspect it's related because the first step in using Tassel is demultiplexing utilizing a supplied barcode keyfile.\n\n\n\n  2. Cyverse has Stacks installed, but in order to use it, someone has to build a Cyverse \"app.\" I've tried and the process is brutal. It's not conducive for a program (that is really a suite of programs) like Stacks that has so many command line options and, depending on your input file types (e.g. \"non-standard\" Illumina filenames for paired-end sequencing), requires looping over filenames to specify corresponding file pairs.\n\n\n\n  3. Pyrad actually worked relatively well, but the VCF output file (for visualizing in the Integrative Genomics Viewer) has an ill-formed header that IGV won't accept. Attempts at tweaking the header don't seem to resolve the issue. Additionally, it's not apparent in the output files if individuals get grouped, even though there is an option to specify which individuals should be grouped together.\n\n\n\n  4. And, the most frustrating thing of all???!!!  I just realized how to handle the problematic barcodes in the FASTQ headers!! Instead of trying to alter the FASTQ files (which I've been messing around with over the past few days), all I've needed to do this entire time is CHANGE THE BARCODE KEY FILE THAT STACKS AND/OR TASSEL USES TO HAVE A 'N' AT THE BEGINNING OF EACH BARCODE!\n\n\n\n\n\n\nI'm going to go cry now...\n\nRegardless of that last one, it doesn't change the fact that Stacks is painfully slow and, at times, unreliable.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../../styles.css"],"toc":true,"toc-depth":5,"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","editor":"source","theme":"darkly","page-layout":"full","code-background":true,"code-copy":true,"title-block-banner":true,"author":"Sam White","toc-title":"Contents","toc-location":"left","date":"2016-05-03 23:16:00+00:00","layout":"post","slug":"gbs-frustrations","title":"GBS Frustrations","categories":["2016","Miscellaneous"],"tags":["Cyverse","GBS","genotype-by-sequencing","pyrad","stacks","tassel"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}