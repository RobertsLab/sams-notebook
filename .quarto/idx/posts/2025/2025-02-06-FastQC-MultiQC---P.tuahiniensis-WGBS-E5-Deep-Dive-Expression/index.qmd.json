{"title":"FastQC MultiQC - P.tuahiniensis WGBS E5 Deep Dive Expression","markdown":{"yaml":{"author":"Sam White","toc-title":"Contents","toc-depth":5,"toc-location":"left","title":"FastQC MultiQC - P.tuahiniensis WGBS E5 Deep Dive Expression","date":"2025-02-06","draft":false,"engine":"knitr","categories":["2025","Pocillopora tuahiniensis","E5","deep-dive-expression","FastQC","MultiQC","WGBS","BS-seq","bisulfite sequencing"],"image":"/posts/2025/2025-02-06-FastQC-MultiQC---P.tuahiniensis-WGBS-E5-Deep-Dive-Expression/20250206-ptua-multiqc-plot-sequence-content.png"},"headingText":"INTRO","containsRefs":false,"markdown":"\nRan FastQC and MultiQC quality checks on the _P.tuahiniensis raw whole genome bisulfite sequencing (WGBS) data [received 20250203](../2025-02-03-Data-Received---E5-Coral-WGBS-from-Genohub-Project-2216545-Using-Rclone-on-Owl/index.qmd), as part of [urol-e5/deep-dive-expression](https://github.com/urol-e5/deep-dive-expression).\n\n::: {.callout-note}\nThe contents below are from markdown knitted from [`00.00-F-Ptuh-WGBS-reads-FastQC-MultiQC`](https://github.com/urol-e5/deep-dive-expression/blob/b471c0590ce7388ff91374520664275ff4ab1288/F-Ptuh/code/00.00-F-Ptuh-WGBS-reads-FastQC-MultiQC.Rmd) (commit `b471c05`).\n:::\n\n# 1 Background\n\nThis Rmd file will download raw WGBS-seq FastQs for *P.tuahiniensis* and\nevaluate them using [FastQC](https://github.com/s-andrews/FastQC) and\n[MultiQC](https://multiqc.info/) (Ewels et al. 2016).\n\n# 2 Create a Bash variables file\n\nThis allows usage of Bash variables across R Markdown chunks.\n\n``` bash\n{\necho \"#### Assign Variables ####\"\necho \"\"\n\necho \"# Data directories\"\necho 'export deep_dive_expression_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/deep-dive-expression'\necho 'export output_dir_top=${deep_dive_expression_dir}/F-Ptuh/output/00.00-F-Ptuh-WGBS-reads-FastQC-MultiQC'\necho 'export raw_fastqc_dir=${output_dir_top}/raw-fastqc'\necho 'export raw_reads_dir=${deep_dive_expression_dir}/F-Ptuh/data/raw-fastqs'\necho 'export raw_reads_url=\"https://owl.fish.washington.edu/nightingales/E5-coral-deep-dive-expression/genohub2216545/\"'\necho \"\"\n\necho \"# Paths to programs\"\necho 'export fastqc=/home/shared/FastQC-0.12.1/fastqc'\necho 'export multiqc=/home/sam/programs/mambaforge/bin/multiqc'\necho \"\"\n\necho \"# Set FastQ filename patterns\"\necho \"export fastq_pattern='*.fastq.gz'\"\necho \"export R1_fastq_pattern='*_R1_*.fastq.gz'\"\necho \"export R2_fastq_pattern='*_R2_*.fastq.gz'\"\necho \"\"\n\necho \"# Set number of CPUs to use\"\necho 'export threads=40'\necho \"\"\n\n\necho \"## Inititalize arrays\"\necho 'export fastq_array_R1=()'\necho 'export fastq_array_R2=()'\necho 'export raw_fastqs_array=()'\necho 'export R1_names_array=()'\necho 'export R2_names_array=()'\necho \"\"\n\necho \"# Programs associative array\"\necho \"declare -A programs_array\"\necho \"programs_array=(\"\necho '[fastqc]=\"${fastqc}\" \\'\necho '[multiqc]=\"${multiqc}\" \\'\necho \")\"\necho \"\"\n\necho \"# Print formatting\"\necho 'export line=\"--------------------------------------------------------\"'\necho \"\"\n} > .bashvars\n\ncat .bashvars\n```\n\n    #### Assign Variables ####\n\n    # Data directories\n    export deep_dive_expression_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/deep-dive-expression\n    export output_dir_top=${deep_dive_expression_dir}/F-Ptuh/output/00.00-F-Ptuh-WGBS-reads-FastQC-MultiQC\n    export raw_fastqc_dir=${output_dir_top}/raw-fastqc\n    export raw_reads_dir=${deep_dive_expression_dir}/F-Ptuh/data/raw-fastqs\n    export raw_reads_url=\"https://owl.fish.washington.edu/nightingales/E5-coral-deep-dive-expression/genohub2216545/\"\n\n    # Paths to programs\n    export fastqc=/home/shared/FastQC-0.12.1/fastqc\n    export multiqc=/home/sam/programs/mambaforge/bin/multiqc\n\n    # Set FastQ filename patterns\n    export fastq_pattern='*.fastq.gz'\n    export R1_fastq_pattern='*_R1_*.fastq.gz'\n    export R2_fastq_pattern='*_R2_*.fastq.gz'\n\n    # Set number of CPUs to use\n    export threads=40\n\n    ## Inititalize arrays\n    export fastq_array_R1=()\n    export fastq_array_R2=()\n    export raw_fastqs_array=()\n    export R1_names_array=()\n    export R2_names_array=()\n\n    # Programs associative array\n    declare -A programs_array\n    programs_array=(\n    [fastqc]=\"${fastqc}\" \\\n    [multiqc]=\"${multiqc}\" \\\n    )\n\n    # Print formatting\n    export line=\"--------------------------------------------------------\"\n\n# 3 Download *P.tuahiniensis* RNA-seq FastQs\n\nReads are downloaded from\n<https://owl.fish.washington.edu/nightingales/E5-coral-deep-dive-expression/genohub2216545/>\n\nSince sequencing included multiple species, the code will also parse\nonly those that are *P.tuahiniensis*.\n\nThe `--cut-dirs 3` command cuts the preceding directory structure\n(i.e.¬†`nightingales/E5-coral-deep-dive-expression/genohub2216545/`) so\nthat we just end up with the reads.\n\n## 3.1 Inspect metadata file\n\n``` bash\n# Load bash variables into memory\nsource .bashvars\n\nhead ${deep_dive_expression_dir}/M-multi-species/data/e5_deep_dive_WGBS_metadata.csv |\ncolumn -t -s\",\"\n```\n\n    Number  Species                   Timepoint  Collection Date  Site   colony_id  Extraction Date  Extraction notebook post                                                                                                      DNA (ng/uL)  Volume eluted  Total DNA (ng)  Primer  Date Prepped  Library concentration (ng/uL)  bp peak  Library volume (uL)  Prep notebook post                                                                                                             Notes\n    403     Pocillopora tuahiniensis  TP2        20200305         Site1  POC-48     20211129         https://github.com/Kterpis/Putnam_Lab_Notebook/blob/master/_posts/2021-11-29-20211129-RNA-DNA-extractions-from-E5-project.md  29.1         90             2619            25      20240613      8.67                           253      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  Labeled as POC-55 in KXT extraction post \n    413     Acropora pulchra          TP2        20200305         Site1  ACR-178    20210902         https://github.com/Kterpis/Putnam_Lab_Notebook/blob/master/_posts/2021-09-02-20210902-RNA-DNA-extractions-from-E5-project.md  19.9         90             1791            26      20240613      9.64                           269      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  \n    417     Pocillopora tuahiniensis  TP2        20200305         Site1  POC-57     20211020         https://kterpis.github.io/Putnam_Lab_Notebook/20211020-RNA-DNA-extractions-from-E5-project/                                   51.4         90             4626            27      20240613      9.3                            256      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  Labeled as POC-238 in KXT extraction post \n    423     Acropora pulchra          TP2        20200305         Site1  ACR-150    20210903         https://github.com/Kterpis/Putnam_Lab_Notebook/blob/master/_posts/2021-09-03-20210903-RNA-DNA-extractions-from-E5-project.md  17.7         90             1593            29      20240613      8.61                           267      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  Labeled as POR-75 in KXT extraction post \n    427     Acropora pulchra          TP2        20200305         Site1  ACR-145    20211012         https://kterpis.github.io/Putnam_Lab_Notebook/20211012-RNA-DNA-extractions-from-E5-project/                                   19.6         90             1764            30      20240613      8.82                           271      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  \n    439     Acropora pulchra          TP2        20200305         Site1  ACR-173    20211102         https://kterpis.github.io/Putnam_Lab_Notebook/20211102-RNA-DNA-extractions-from-E5-project/                                   19.9         90             1791            31      20240613      11.9                           264      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  \n    467     Acropora pulchra          TP2        20200305         Site1  ACR-140    20210921         https://github.com/Kterpis/Putnam_Lab_Notebook/blob/master/_posts/2021-09-21-20210921-RNA-DNA-extractions-from-E5-project.md  21.9         90             1971            32      20240613      16                             270      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  DNA 1 and 2 Qubit readings are 27.6 and 27.4 but average is reported as 4.79 on github and on master sample sheet; JA re-qubited on 20240229 and got 21.9 ul/ng\n    471     Porites evermanni         TP2        20200305         Site1  POR-76     20211015         https://kterpis.github.io/Putnam_Lab_Notebook/20211015-RNA-DNA-extractions-from-E5-project/                                   2.7          90             243             33      20240613      5.25                           245      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  \n    491     Porites evermanni         TP2        20200305         Site1  POR-73     20211101         https://kterpis.github.io/Putnam_Lab_Notebook/20211101-RNA-DNA-extractions-from-E5-project/                                   2.11         90             189.9           36      20240613      4.65                           315      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  \n\n## 3.2 Download raw reads\n\n``` bash\n# Load bash variables into memory\nsource .bashvars\n\n# Make output directory if it doesn't exist\nmkdir --parents ${raw_reads_dir}\n\n# Create list of only P.tuahiniensis sample names\nsample_list=$(awk -F \",\" '$6 ~ /^POC/ {print $1}' ${deep_dive_expression_dir}/M-multi-species/data/e5_deep_dive_WGBS_metadata.csv)\n\necho \"\"\necho \"${line}\"\necho \"\"\necho \"Sample list:\"\necho \"\"\necho \"${sample_list}\"\necho \"\"\necho \"${line}\"\necho \"\"\n\n\n# Use printf to format each item for use in wget\nformatted_list=$(printf \"*%s_*,\" ${sample_list})\n\n# Remove the trailing comma\nformatted_list=${formatted_list%,}\n\n# Output the final wget command\necho \"\"\necho \"${line}\"\necho \"\"\necho \"Formatted wget accept list:\"\necho \"\"\necho \"wget --accept=\\\"$formatted_list\\\"\"\necho \"\"\necho \"${line}\"\necho \"\"\n\n# Run wget to retrieve FastQs and MD5 files\n# Note: the --no-clobber command will skip re-downloading any files that are already present in the output directory\nwget \\\n--directory-prefix ${raw_reads_dir} \\\n--recursive \\\n--no-check-certificate \\\n--continue \\\n--cut-dirs 3 \\\n--no-host-directories \\\n--no-parent \\\n--quiet \\\n--no-clobber \\\n--accept=${formatted_list} ${raw_reads_url}\n\nls -lh \"${raw_reads_dir}\"\n```\n\n## 3.3 Verify raw read checksums\n\n``` bash\n# Load bash variables into memory\nsource .bashvars\n\ncd \"${raw_reads_dir}\"\n\n# Checksums file contains other files, so this just looks for the RNAseq files.\nfor file in *.md5\ndo\n  md5sum --check \"${file}\"\ndone\n```\n\n    385_S13_R1_001.fastq.gz: OK\n    385_S13_R2_001.fastq.gz: OK\n    393_S14_R1_001.fastq.gz: OK\n    393_S14_R2_001.fastq.gz: OK\n    401_S15_R1_001.fastq.gz: OK\n    401_S15_R2_001.fastq.gz: OK\n    403_S11_R1_001.fastq.gz: OK\n    403_S11_R2_001.fastq.gz: OK\n    417_S12_R1_001.fastq.gz: OK\n    417_S12_R2_001.fastq.gz: OK\n\n# 4 FastQC/MultiQC on raw reads\n\n``` bash\n# Load bash variables into memory\nsource .bashvars\n\n# Make output directory if it doesn't exist\nmkdir --parents \"${raw_fastqc_dir}\"\n\n############ RUN FASTQC ############\n\n\n# Create array of trimmed FastQs\nraw_fastqs_array=(${raw_reads_dir}/${fastq_pattern})\n\n# Pass array contents to new variable as space-delimited list\nraw_fastqc_list=$(echo \"${raw_fastqs_array[*]}\")\n\necho \"Beginning FastQC on raw reads...\"\necho \"\"\n\n# Run FastQC\n### NOTE: Do NOT quote raw_fastqc_list\n${programs_array[fastqc]} \\\n--threads ${threads} \\\n--outdir ${raw_fastqc_dir} \\\n--quiet \\\n${raw_fastqc_list}\n\necho \"FastQC on raw reads complete!\"\necho \"\"\n\n############ END FASTQC ############\n\n############ RUN MULTIQC ############\necho \"Beginning MultiQC on raw FastQC...\"\necho \"\"\n\n${programs_array[multiqc]} ${raw_fastqc_dir} -o ${raw_fastqc_dir}\n\necho \"\"\necho \"MultiQC on raw FastQs complete.\"\necho \"\"\n\n############ END MULTIQC ############\n\necho \"Removing FastQC zip files.\"\necho \"\"\nrm ${raw_fastqc_dir}/*.zip\necho \"FastQC zip files removed.\"\necho \"\"\n```\n\n    Beginning FastQC on raw reads...\n\n    application/gzip\n    application/gzip\n    application/gzip\n    application/gzip\n    application/gzip\n    application/gzip\n    application/gzip\n    application/gzip\n    application/gzip\n    application/gzip\n    FastQC on raw reads complete!\n\n    Beginning MultiQC on raw FastQC...\n\n\n      /// MultiQC üîç | v1.14\n\n    |           multiqc | MultiQC Version v1.27 now available!\n    |           multiqc | Search path : /home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/deep-dive-expression/F-Ptuh/output/00.00-F-Ptuh-WGBS-reads-FastQC-MultiQC/raw-fastqc\n    |         searching | ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 100% 20/20  \n    |            fastqc | Found 10 reports\n    |           multiqc | Compressing plot data\n    |           multiqc | Report      : ../output/00.00-F-Ptuh-WGBS-reads-FastQC-MultiQC/raw-fastqc/multiqc_report.html\n    |           multiqc | Data        : ../output/00.00-F-Ptuh-WGBS-reads-FastQC-MultiQC/raw-fastqc/multiqc_data\n    |           multiqc | MultiQC complete\n\n    MultiQC on raw FastQs complete.\n\n    Removing FastQC zip files.\n\n    FastQC zip files removed.\n\n``` bash\n# Load bash variables into memory\nsource .bashvars\n\n# View directory contents\nls -lh ${raw_fastqc_dir}\n```\n\n    total 7.1M\n    -rw-r--r-- 1 sam sam 601K Feb  6 14:37 385_S13_R1_001_fastqc.html\n    -rw-r--r-- 1 sam sam 601K Feb  6 14:37 385_S13_R2_001_fastqc.html\n    -rw-r--r-- 1 sam sam 613K Feb  6 14:38 393_S14_R1_001_fastqc.html\n    -rw-r--r-- 1 sam sam 600K Feb  6 14:39 393_S14_R2_001_fastqc.html\n    -rw-r--r-- 1 sam sam 600K Feb  6 14:36 401_S15_R1_001_fastqc.html\n    -rw-r--r-- 1 sam sam 594K Feb  6 14:36 401_S15_R2_001_fastqc.html\n    -rw-r--r-- 1 sam sam 583K Feb  6 14:39 403_S11_R1_001_fastqc.html\n    -rw-r--r-- 1 sam sam 591K Feb  6 14:40 403_S11_R2_001_fastqc.html\n    -rw-r--r-- 1 sam sam 578K Feb  6 14:45 417_S12_R1_001_fastqc.html\n    -rw-r--r-- 1 sam sam 582K Feb  6 14:46 417_S12_R2_001_fastqc.html\n    drwxr-xr-x 2 sam sam 4.0K Feb  6 14:46 multiqc_data\n    -rw-r--r-- 1 sam sam 1.3M Feb  6 14:46 multiqc_report.html\n\n# RESULTS\n\n[`MultiQC`](https://multiqc.info/) HTML file is here:\n\n- [`multiqc_report.html`](https://github.com/urol-e5/deep-dive-expression/blob/b471c0590ce7388ff91374520664275ff4ab1288/F-Ptuh/output/00.00-F-Ptuh-WGBS-reads-FastQC-MultiQC/raw-fastqc/multiqc_report.html) (commit: `b471c05`)\n\nOverall, looks like the first 10bp need to be trimmed, as well as adapters and polyG sequence. Curiously, there is a second peak in the GC conent analysis. This second peak is _not_ present in [the _A.pulchra_ data](../2025-02-06-FastQC-MultiQC---A.pulchra-WGBS-E5-Deep-Dive-Expression/index.qmd) (Notebook), but is also present in [the _P.evermanni_ data](../2025-02-06-FastQC-MultiQC---P.evermanni-WGBS-E5-Deep-Dive-Expression/index.qmd) (Notebook). Multiple GC content peaks suggest that there might be carryover from endosymbionts?\n\n![P.tuahiniensis WGBS MultiQC GC content plot showing multiple peaks](./20250206-ptua-multiqc-plot-GC-content.png)\n\n# REFERENCES\n\n<div id=\"refs\" class=\"references csl-bib-body hanging-indent\">\n\n<div id=\"ref-ewels2016\" class=\"csl-entry\">\n\nEwels, Philip, M√•ns Magnusson, Sverker Lundin, and Max K√§ller. 2016.\n‚ÄúMultiQC: Summarize Analysis Results for Multiple Tools and Samples in a\nSingle Report.‚Äù *Bioinformatics* 32 (19): 3047‚Äì48.\n<https://doi.org/10.1093/bioinformatics/btw354>.\n\n</div>\n\n</div>","srcMarkdownNoYaml":"\n# INTRO\nRan FastQC and MultiQC quality checks on the _P.tuahiniensis raw whole genome bisulfite sequencing (WGBS) data [received 20250203](../2025-02-03-Data-Received---E5-Coral-WGBS-from-Genohub-Project-2216545-Using-Rclone-on-Owl/index.qmd), as part of [urol-e5/deep-dive-expression](https://github.com/urol-e5/deep-dive-expression).\n\n::: {.callout-note}\nThe contents below are from markdown knitted from [`00.00-F-Ptuh-WGBS-reads-FastQC-MultiQC`](https://github.com/urol-e5/deep-dive-expression/blob/b471c0590ce7388ff91374520664275ff4ab1288/F-Ptuh/code/00.00-F-Ptuh-WGBS-reads-FastQC-MultiQC.Rmd) (commit `b471c05`).\n:::\n\n# 1 Background\n\nThis Rmd file will download raw WGBS-seq FastQs for *P.tuahiniensis* and\nevaluate them using [FastQC](https://github.com/s-andrews/FastQC) and\n[MultiQC](https://multiqc.info/) (Ewels et al. 2016).\n\n# 2 Create a Bash variables file\n\nThis allows usage of Bash variables across R Markdown chunks.\n\n``` bash\n{\necho \"#### Assign Variables ####\"\necho \"\"\n\necho \"# Data directories\"\necho 'export deep_dive_expression_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/deep-dive-expression'\necho 'export output_dir_top=${deep_dive_expression_dir}/F-Ptuh/output/00.00-F-Ptuh-WGBS-reads-FastQC-MultiQC'\necho 'export raw_fastqc_dir=${output_dir_top}/raw-fastqc'\necho 'export raw_reads_dir=${deep_dive_expression_dir}/F-Ptuh/data/raw-fastqs'\necho 'export raw_reads_url=\"https://owl.fish.washington.edu/nightingales/E5-coral-deep-dive-expression/genohub2216545/\"'\necho \"\"\n\necho \"# Paths to programs\"\necho 'export fastqc=/home/shared/FastQC-0.12.1/fastqc'\necho 'export multiqc=/home/sam/programs/mambaforge/bin/multiqc'\necho \"\"\n\necho \"# Set FastQ filename patterns\"\necho \"export fastq_pattern='*.fastq.gz'\"\necho \"export R1_fastq_pattern='*_R1_*.fastq.gz'\"\necho \"export R2_fastq_pattern='*_R2_*.fastq.gz'\"\necho \"\"\n\necho \"# Set number of CPUs to use\"\necho 'export threads=40'\necho \"\"\n\n\necho \"## Inititalize arrays\"\necho 'export fastq_array_R1=()'\necho 'export fastq_array_R2=()'\necho 'export raw_fastqs_array=()'\necho 'export R1_names_array=()'\necho 'export R2_names_array=()'\necho \"\"\n\necho \"# Programs associative array\"\necho \"declare -A programs_array\"\necho \"programs_array=(\"\necho '[fastqc]=\"${fastqc}\" \\'\necho '[multiqc]=\"${multiqc}\" \\'\necho \")\"\necho \"\"\n\necho \"# Print formatting\"\necho 'export line=\"--------------------------------------------------------\"'\necho \"\"\n} > .bashvars\n\ncat .bashvars\n```\n\n    #### Assign Variables ####\n\n    # Data directories\n    export deep_dive_expression_dir=/home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/deep-dive-expression\n    export output_dir_top=${deep_dive_expression_dir}/F-Ptuh/output/00.00-F-Ptuh-WGBS-reads-FastQC-MultiQC\n    export raw_fastqc_dir=${output_dir_top}/raw-fastqc\n    export raw_reads_dir=${deep_dive_expression_dir}/F-Ptuh/data/raw-fastqs\n    export raw_reads_url=\"https://owl.fish.washington.edu/nightingales/E5-coral-deep-dive-expression/genohub2216545/\"\n\n    # Paths to programs\n    export fastqc=/home/shared/FastQC-0.12.1/fastqc\n    export multiqc=/home/sam/programs/mambaforge/bin/multiqc\n\n    # Set FastQ filename patterns\n    export fastq_pattern='*.fastq.gz'\n    export R1_fastq_pattern='*_R1_*.fastq.gz'\n    export R2_fastq_pattern='*_R2_*.fastq.gz'\n\n    # Set number of CPUs to use\n    export threads=40\n\n    ## Inititalize arrays\n    export fastq_array_R1=()\n    export fastq_array_R2=()\n    export raw_fastqs_array=()\n    export R1_names_array=()\n    export R2_names_array=()\n\n    # Programs associative array\n    declare -A programs_array\n    programs_array=(\n    [fastqc]=\"${fastqc}\" \\\n    [multiqc]=\"${multiqc}\" \\\n    )\n\n    # Print formatting\n    export line=\"--------------------------------------------------------\"\n\n# 3 Download *P.tuahiniensis* RNA-seq FastQs\n\nReads are downloaded from\n<https://owl.fish.washington.edu/nightingales/E5-coral-deep-dive-expression/genohub2216545/>\n\nSince sequencing included multiple species, the code will also parse\nonly those that are *P.tuahiniensis*.\n\nThe `--cut-dirs 3` command cuts the preceding directory structure\n(i.e.¬†`nightingales/E5-coral-deep-dive-expression/genohub2216545/`) so\nthat we just end up with the reads.\n\n## 3.1 Inspect metadata file\n\n``` bash\n# Load bash variables into memory\nsource .bashvars\n\nhead ${deep_dive_expression_dir}/M-multi-species/data/e5_deep_dive_WGBS_metadata.csv |\ncolumn -t -s\",\"\n```\n\n    Number  Species                   Timepoint  Collection Date  Site   colony_id  Extraction Date  Extraction notebook post                                                                                                      DNA (ng/uL)  Volume eluted  Total DNA (ng)  Primer  Date Prepped  Library concentration (ng/uL)  bp peak  Library volume (uL)  Prep notebook post                                                                                                             Notes\n    403     Pocillopora tuahiniensis  TP2        20200305         Site1  POC-48     20211129         https://github.com/Kterpis/Putnam_Lab_Notebook/blob/master/_posts/2021-11-29-20211129-RNA-DNA-extractions-from-E5-project.md  29.1         90             2619            25      20240613      8.67                           253      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  Labeled as POC-55 in KXT extraction post \n    413     Acropora pulchra          TP2        20200305         Site1  ACR-178    20210902         https://github.com/Kterpis/Putnam_Lab_Notebook/blob/master/_posts/2021-09-02-20210902-RNA-DNA-extractions-from-E5-project.md  19.9         90             1791            26      20240613      9.64                           269      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  \n    417     Pocillopora tuahiniensis  TP2        20200305         Site1  POC-57     20211020         https://kterpis.github.io/Putnam_Lab_Notebook/20211020-RNA-DNA-extractions-from-E5-project/                                   51.4         90             4626            27      20240613      9.3                            256      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  Labeled as POC-238 in KXT extraction post \n    423     Acropora pulchra          TP2        20200305         Site1  ACR-150    20210903         https://github.com/Kterpis/Putnam_Lab_Notebook/blob/master/_posts/2021-09-03-20210903-RNA-DNA-extractions-from-E5-project.md  17.7         90             1593            29      20240613      8.61                           267      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  Labeled as POR-75 in KXT extraction post \n    427     Acropora pulchra          TP2        20200305         Site1  ACR-145    20211012         https://kterpis.github.io/Putnam_Lab_Notebook/20211012-RNA-DNA-extractions-from-E5-project/                                   19.6         90             1764            30      20240613      8.82                           271      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  \n    439     Acropora pulchra          TP2        20200305         Site1  ACR-173    20211102         https://kterpis.github.io/Putnam_Lab_Notebook/20211102-RNA-DNA-extractions-from-E5-project/                                   19.9         90             1791            31      20240613      11.9                           264      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  \n    467     Acropora pulchra          TP2        20200305         Site1  ACR-140    20210921         https://github.com/Kterpis/Putnam_Lab_Notebook/blob/master/_posts/2021-09-21-20210921-RNA-DNA-extractions-from-E5-project.md  21.9         90             1971            32      20240613      16                             270      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  DNA 1 and 2 Qubit readings are 27.6 and 27.4 but average is reported as 4.79 on github and on master sample sheet; JA re-qubited on 20240229 and got 21.9 ul/ng\n    471     Porites evermanni         TP2        20200305         Site1  POR-76     20211015         https://kterpis.github.io/Putnam_Lab_Notebook/20211015-RNA-DNA-extractions-from-E5-project/                                   2.7          90             243             33      20240613      5.25                           245      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  \n    491     Porites evermanni         TP2        20200305         Site1  POR-73     20211101         https://kterpis.github.io/Putnam_Lab_Notebook/20211101-RNA-DNA-extractions-from-E5-project/                                   2.11         90             189.9           36      20240613      4.65                           315      14                   https://github.com/JillAshey/JillAshey_Putnam_Lab_Notebook/blob/master/_posts/2024-06-13-Zymo-Pico-Methyl-Seq-Library-Prep.md  \n\n## 3.2 Download raw reads\n\n``` bash\n# Load bash variables into memory\nsource .bashvars\n\n# Make output directory if it doesn't exist\nmkdir --parents ${raw_reads_dir}\n\n# Create list of only P.tuahiniensis sample names\nsample_list=$(awk -F \",\" '$6 ~ /^POC/ {print $1}' ${deep_dive_expression_dir}/M-multi-species/data/e5_deep_dive_WGBS_metadata.csv)\n\necho \"\"\necho \"${line}\"\necho \"\"\necho \"Sample list:\"\necho \"\"\necho \"${sample_list}\"\necho \"\"\necho \"${line}\"\necho \"\"\n\n\n# Use printf to format each item for use in wget\nformatted_list=$(printf \"*%s_*,\" ${sample_list})\n\n# Remove the trailing comma\nformatted_list=${formatted_list%,}\n\n# Output the final wget command\necho \"\"\necho \"${line}\"\necho \"\"\necho \"Formatted wget accept list:\"\necho \"\"\necho \"wget --accept=\\\"$formatted_list\\\"\"\necho \"\"\necho \"${line}\"\necho \"\"\n\n# Run wget to retrieve FastQs and MD5 files\n# Note: the --no-clobber command will skip re-downloading any files that are already present in the output directory\nwget \\\n--directory-prefix ${raw_reads_dir} \\\n--recursive \\\n--no-check-certificate \\\n--continue \\\n--cut-dirs 3 \\\n--no-host-directories \\\n--no-parent \\\n--quiet \\\n--no-clobber \\\n--accept=${formatted_list} ${raw_reads_url}\n\nls -lh \"${raw_reads_dir}\"\n```\n\n## 3.3 Verify raw read checksums\n\n``` bash\n# Load bash variables into memory\nsource .bashvars\n\ncd \"${raw_reads_dir}\"\n\n# Checksums file contains other files, so this just looks for the RNAseq files.\nfor file in *.md5\ndo\n  md5sum --check \"${file}\"\ndone\n```\n\n    385_S13_R1_001.fastq.gz: OK\n    385_S13_R2_001.fastq.gz: OK\n    393_S14_R1_001.fastq.gz: OK\n    393_S14_R2_001.fastq.gz: OK\n    401_S15_R1_001.fastq.gz: OK\n    401_S15_R2_001.fastq.gz: OK\n    403_S11_R1_001.fastq.gz: OK\n    403_S11_R2_001.fastq.gz: OK\n    417_S12_R1_001.fastq.gz: OK\n    417_S12_R2_001.fastq.gz: OK\n\n# 4 FastQC/MultiQC on raw reads\n\n``` bash\n# Load bash variables into memory\nsource .bashvars\n\n# Make output directory if it doesn't exist\nmkdir --parents \"${raw_fastqc_dir}\"\n\n############ RUN FASTQC ############\n\n\n# Create array of trimmed FastQs\nraw_fastqs_array=(${raw_reads_dir}/${fastq_pattern})\n\n# Pass array contents to new variable as space-delimited list\nraw_fastqc_list=$(echo \"${raw_fastqs_array[*]}\")\n\necho \"Beginning FastQC on raw reads...\"\necho \"\"\n\n# Run FastQC\n### NOTE: Do NOT quote raw_fastqc_list\n${programs_array[fastqc]} \\\n--threads ${threads} \\\n--outdir ${raw_fastqc_dir} \\\n--quiet \\\n${raw_fastqc_list}\n\necho \"FastQC on raw reads complete!\"\necho \"\"\n\n############ END FASTQC ############\n\n############ RUN MULTIQC ############\necho \"Beginning MultiQC on raw FastQC...\"\necho \"\"\n\n${programs_array[multiqc]} ${raw_fastqc_dir} -o ${raw_fastqc_dir}\n\necho \"\"\necho \"MultiQC on raw FastQs complete.\"\necho \"\"\n\n############ END MULTIQC ############\n\necho \"Removing FastQC zip files.\"\necho \"\"\nrm ${raw_fastqc_dir}/*.zip\necho \"FastQC zip files removed.\"\necho \"\"\n```\n\n    Beginning FastQC on raw reads...\n\n    application/gzip\n    application/gzip\n    application/gzip\n    application/gzip\n    application/gzip\n    application/gzip\n    application/gzip\n    application/gzip\n    application/gzip\n    application/gzip\n    FastQC on raw reads complete!\n\n    Beginning MultiQC on raw FastQC...\n\n\n      /// MultiQC üîç | v1.14\n\n    |           multiqc | MultiQC Version v1.27 now available!\n    |           multiqc | Search path : /home/shared/8TB_HDD_01/sam/gitrepos/urol-e5/deep-dive-expression/F-Ptuh/output/00.00-F-Ptuh-WGBS-reads-FastQC-MultiQC/raw-fastqc\n    |         searching | ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 100% 20/20  \n    |            fastqc | Found 10 reports\n    |           multiqc | Compressing plot data\n    |           multiqc | Report      : ../output/00.00-F-Ptuh-WGBS-reads-FastQC-MultiQC/raw-fastqc/multiqc_report.html\n    |           multiqc | Data        : ../output/00.00-F-Ptuh-WGBS-reads-FastQC-MultiQC/raw-fastqc/multiqc_data\n    |           multiqc | MultiQC complete\n\n    MultiQC on raw FastQs complete.\n\n    Removing FastQC zip files.\n\n    FastQC zip files removed.\n\n``` bash\n# Load bash variables into memory\nsource .bashvars\n\n# View directory contents\nls -lh ${raw_fastqc_dir}\n```\n\n    total 7.1M\n    -rw-r--r-- 1 sam sam 601K Feb  6 14:37 385_S13_R1_001_fastqc.html\n    -rw-r--r-- 1 sam sam 601K Feb  6 14:37 385_S13_R2_001_fastqc.html\n    -rw-r--r-- 1 sam sam 613K Feb  6 14:38 393_S14_R1_001_fastqc.html\n    -rw-r--r-- 1 sam sam 600K Feb  6 14:39 393_S14_R2_001_fastqc.html\n    -rw-r--r-- 1 sam sam 600K Feb  6 14:36 401_S15_R1_001_fastqc.html\n    -rw-r--r-- 1 sam sam 594K Feb  6 14:36 401_S15_R2_001_fastqc.html\n    -rw-r--r-- 1 sam sam 583K Feb  6 14:39 403_S11_R1_001_fastqc.html\n    -rw-r--r-- 1 sam sam 591K Feb  6 14:40 403_S11_R2_001_fastqc.html\n    -rw-r--r-- 1 sam sam 578K Feb  6 14:45 417_S12_R1_001_fastqc.html\n    -rw-r--r-- 1 sam sam 582K Feb  6 14:46 417_S12_R2_001_fastqc.html\n    drwxr-xr-x 2 sam sam 4.0K Feb  6 14:46 multiqc_data\n    -rw-r--r-- 1 sam sam 1.3M Feb  6 14:46 multiqc_report.html\n\n# RESULTS\n\n[`MultiQC`](https://multiqc.info/) HTML file is here:\n\n- [`multiqc_report.html`](https://github.com/urol-e5/deep-dive-expression/blob/b471c0590ce7388ff91374520664275ff4ab1288/F-Ptuh/output/00.00-F-Ptuh-WGBS-reads-FastQC-MultiQC/raw-fastqc/multiqc_report.html) (commit: `b471c05`)\n\nOverall, looks like the first 10bp need to be trimmed, as well as adapters and polyG sequence. Curiously, there is a second peak in the GC conent analysis. This second peak is _not_ present in [the _A.pulchra_ data](../2025-02-06-FastQC-MultiQC---A.pulchra-WGBS-E5-Deep-Dive-Expression/index.qmd) (Notebook), but is also present in [the _P.evermanni_ data](../2025-02-06-FastQC-MultiQC---P.evermanni-WGBS-E5-Deep-Dive-Expression/index.qmd) (Notebook). Multiple GC content peaks suggest that there might be carryover from endosymbionts?\n\n![P.tuahiniensis WGBS MultiQC GC content plot showing multiple peaks](./20250206-ptua-multiqc-plot-GC-content.png)\n\n# REFERENCES\n\n<div id=\"refs\" class=\"references csl-bib-body hanging-indent\">\n\n<div id=\"ref-ewels2016\" class=\"csl-entry\">\n\nEwels, Philip, M√•ns Magnusson, Sverker Lundin, and Max K√§ller. 2016.\n‚ÄúMultiQC: Summarize Analysis Results for Multiple Tools and Samples in a\nSingle Report.‚Äù *Bioinformatics* 32 (19): 3047‚Äì48.\n<https://doi.org/10.1093/bioinformatics/btw354>.\n\n</div>\n\n</div>"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../../styles.css"],"toc":true,"toc-depth":5,"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","editor":"source","theme":"darkly","page-layout":"full","code-background":true,"code-copy":true,"title-block-banner":true,"author":"Sam White","toc-title":"Contents","toc-location":"left","title":"FastQC MultiQC - P.tuahiniensis WGBS E5 Deep Dive Expression","date":"2025-02-06","draft":false,"categories":["2025","Pocillopora tuahiniensis","E5","deep-dive-expression","FastQC","MultiQC","WGBS","BS-seq","bisulfite sequencing"],"image":"/posts/2025/2025-02-06-FastQC-MultiQC---P.tuahiniensis-WGBS-E5-Deep-Dive-Expression/20250206-ptua-multiqc-plot-sequence-content.png"},"extensions":{"book":{"multiFile":true}}}},"draft":false,"projectFormats":["html"]}