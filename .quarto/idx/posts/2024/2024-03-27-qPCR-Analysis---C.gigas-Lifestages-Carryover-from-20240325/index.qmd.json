{"title":"qPCR Analysis - C.gigas Lifestages Carryover from 20240325","markdown":{"yaml":{"author":"Sam White","toc-title":"Contents","toc-depth":5,"toc-location":"left","title":"qPCR Analysis - C.gigas Lifestages Carryover from 20240325","date":"2024-03-27","draft":false,"code-fold":false,"code-tools":true,"engine":"knitr","categories":["2024","qPCR","Crassotrea gigas","Pacific oyster"]},"headingText":"INTRO","containsRefs":false,"markdown":"\nqPCR analysis of [_Crassostrea gigas_ (Pacific oyster)](http://en.wikipedia.org/wiki/Pacific_oyster) spat and seed from the [`project-gigas-carryover`](../../../../project-gigas-carryover/lifestage_carryover/) (GitHub Repo). \n\n\nMetadata:\n\n- [20240314_rna_extractions.csv](https://github.com/RobertsLab/project-gigas-carryover/blob/82f1a4bcd5e2ce80cea9916f271bf1d54f740bd1/lifestage_carryover/data/sampling_metadata/20240314_rna_extractions.csv) (GitHub; commit: `82f1a4b`).\n\n::: {.callout-note}\nNot all of the samples listed in the sheet above were used in the qPCRs, due to lack of RNA [during isolation](../2024-03-19-RNA-Isolation---C.gigas-Lifestage-Carryover-Seed-and-Spat/index.qmd) (Notebook).\n:::\n\nBackground info notebooks:\n\n- [Isolated RNA for gigas carryover project](../2024-03-19-RNA-Isolation---C.gigas-Lifestage-Carryover-Seed-and-Spat/index.qmd) (Notebook)\n\n- [Reverse transcribed RNA for gigas carryover project](../2024-03-19-Reverse-Transcription---C.gigas-Lifestage-Carryover-Seed-and-Spat/index.qmd) (Notebook)\n\n- [qPCRs](../2024-03-25-qPCRs---C.gigas-Lifestage-Carryover-cDNA/index.qmd).\n\n::: {.callout-note}\nCode below was rendered from [20240327-cgig-lifestage-carryover-qpcr-analysis.Rmd](https://github.com/RobertsLab/code/blob/f9af1eb3de350e165e65784bbabede2578b71ba2/r_projects/sam/20240327-cgig-lifestage-carryover-qpcr-analysis/code/20240327-cgig-lifestage-carryover-qpcr-analysis.Rmd), commit `f9af1eb`.\n:::\n\n- <a href=\"#1-analysis\" id=\"toc-1-analysis\">1 ANALYSIS</a>\n  - <a href=\"#11-load-libraries\" id=\"toc-11-load-libraries\">1.1 Load\n    libraries</a>\n  - <a href=\"#12-set-variables\" id=\"toc-12-set-variables\">1.2 Set\n    variables</a>\n  - <a href=\"#13-functions\" id=\"toc-13-functions\">1.3 Functions</a>\n  - <a href=\"#14-read-in-files\" id=\"toc-14-read-in-files\">1.4 Read in\n    files</a>\n  - <a href=\"#15-unique-samples-by-target\"\n    id=\"toc-15-unique-samples-by-target\">1.5 Unique samples by target</a>\n  - <a href=\"#16-add-life-stage-and-treatment-cols\"\n    id=\"toc-16-add-life-stage-and-treatment-cols\">1.6 Add life stage and\n    treatment cols</a>\n  - <a href=\"#17-delta-cq-to-normalizing-gene\"\n    id=\"toc-17-delta-cq-to-normalizing-gene\">1.7 Delta Cq to Normalizing\n    Gene</a>\n  - <a href=\"#18-t-tests\" id=\"toc-18-t-tests\">1.8 T-tests</a>\n  - <a href=\"#19-delta-cq-box-plots\" id=\"toc-19-delta-cq-box-plots\">1.9\n    Delta Cq Box Plots</a>\n    - <a href=\"#191-seed\" id=\"toc-191-seed\">1.9.1 Seed</a>\n    - <a href=\"#192-spat\" id=\"toc-192-spat\">1.9.2 Spat</a>\n  - <a href=\"#110-delta-delta-cq\" id=\"toc-110-delta-delta-cq\">1.10 Delta\n    delta Cq</a>\n    - <a href=\"#1101-add-treatment-and-life-stage\"\n      id=\"toc-1101-add-treatment-and-life-stage\">1.10.1 Add treatment and life\n      stage</a>\n    - <a href=\"#1102-mean-cqs-per-gene-per-treatment-per-life-stage\"\n      id=\"toc-1102-mean-cqs-per-gene-per-treatment-per-life-stage\">1.10.2 Mean\n      Cqs per gene per treatment per life stage</a>\n    - <a href=\"#1103-delta-cqs\" id=\"toc-1103-delta-cqs\">1.10.3 Delta Cqs</a>\n    - <a href=\"#1104-delta-delta-cq\" id=\"toc-1104-delta-delta-cq\">1.10.4 Delta\n      delta Cq</a>\n    - <a href=\"#1105-calculate-the-fold-change-for-each-target\"\n      id=\"toc-1105-calculate-the-fold-change-for-each-target\">1.10.5 Calculate\n      the fold change for each Target</a>\n    - <a href=\"#1106-plot---seed-fold-change\"\n      id=\"toc-1106-plot---seed-fold-change\">1.10.6 Plot - Seed Fold Change</a>\n    - <a href=\"#1107-plot---spat-fold-change\"\n      id=\"toc-1107-plot---spat-fold-change\">1.10.7 Plot - Spat Fold Change</a>\n\n# 1 ANALYSIS\n\n## 1.1 Load libraries\n\n``` r\nif (\"tidyverse\" %in% rownames(installed.packages()) == 'FALSE') install.packages('tidyverse')\n\nlibrary(\"tidyverse\")\nlibrary(\"ggplot2\")\n```\n\n## 1.2 Set variables\n\n``` r\nseed.control <- c(\"223\", \"243\", \"244\")\nseed.treated <- c(\"200\", \"257\", \"285\")\nspat.control <- c(\"206\", \"282\", \"284\", \"289\")\nspat.treated <- c(\"220\", \"226\", \"242\", \"253\", \"296\", \"298\")\n\n# Combine vectors into a list\nvector_list <- list(seed.control = seed.control,\n                    seed.treated = seed.treated,\n                    spat.control = spat.control,\n                    spat.treated = spat.treated)\n```\n\n## 1.3 Functions\n\n``` r\ncalculate_delta_Cq <- function(df) {\n  df <- df %>%\n    group_by(Sample) %>%\n    mutate(delta_Cq = Cq.Mean - Cq.Mean[Target == \"GAPDH\"]) %>%\n    ungroup()\n  \n  return(df)\n}\n```\n\n## 1.4 Read in files\n\n``` r\n# Set the directory where your CSV files are located\ncqs_directory <- \"../data/\"\n\n# Get a list of all CSV files in the directory with the naming structure \"*Cq_Results.csv\"\ncq_file_list <- list() # Initialize list\ncq_file_list <- list.files(path = cqs_directory, pattern = \"Cq_Results\\\\.csv$\", full.names = TRUE)\n\n# Initialize an empty list to store the data frames\ndata_frames <- list()\n\n# Loop through each file and read it into a data frame, then add it to the list\nfor (file in cq_file_list) {\n  data <- read.csv(file, header = TRUE)\n  data_frames[[file]] <- data\n}\n\n# Combine all data frames into a single data frame\ncombined_df <- bind_rows(data_frames, .id = \"data_frame_id\")\n\n# Convert Sample column to character type\ncombined_df <- combined_df %>%\n  mutate(Sample = as.character(Sample))\n\nstr(combined_df)\n```\n\n    'data.frame':   272 obs. of  17 variables:\n     $ data_frame_id         : chr  \"../data//sam_2024-03-25_06-10-54_Connect-Quantification-Cq_Results.csv\" \"../data//sam_2024-03-25_06-10-54_Connect-Quantification-Cq_Results.csv\" \"../data//sam_2024-03-25_06-10-54_Connect-Quantification-Cq_Results.csv\" \"../data//sam_2024-03-25_06-10-54_Connect-Quantification-Cq_Results.csv\" ...\n     $ X                     : logi  NA NA NA NA NA NA ...\n     $ Well                  : chr  \"A01\" \"A02\" \"A03\" \"A04\" ...\n     $ Fluor                 : chr  \"SYBR\" \"SYBR\" \"SYBR\" \"SYBR\" ...\n     $ Target                : chr  \"ATPsynthase\" \"ATPsynthase\" \"ATPsynthase\" \"ATPsynthase\" ...\n     $ Content               : chr  \"Unkn-01\" \"Unkn-01\" \"Unkn-02\" \"Unkn-02\" ...\n     $ Sample                : chr  \"206\" \"206\" \"220\" \"220\" ...\n     $ Biological.Set.Name   : logi  NA NA NA NA NA NA ...\n     $ Cq                    : num  26.7 26.7 25.8 25.9 25.1 ...\n     $ Cq.Mean               : num  26.7 26.7 25.9 25.9 25.1 ...\n     $ Cq.Std..Dev           : num  0.0455 0.0455 0.0239 0.0239 0.0813 ...\n     $ Starting.Quantity..SQ.: num  NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ Log.Starting.Quantity : num  NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ SQ.Mean               : num  NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ SQ.Std..Dev           : num  NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ Set.Point             : int  60 60 60 60 60 60 60 60 60 60 ...\n     $ Well.Note             : logi  NA NA NA NA NA NA ...\n\n## 1.5 Unique samples by target\n\n``` r\n# Group by Sample and Target, then summarize to get unique rows for each sample\naggregated_df <- combined_df %>%\n  group_by(Sample, Target) %>%\n  summarize(Cq.Mean = mean(Cq.Mean, na.rm = TRUE)) %>%\n  ungroup()\n\nstr(aggregated_df)\n```\n\n    tibble [136 × 3] (S3: tbl_df/tbl/data.frame)\n     $ Sample : chr [1:136] \"200\" \"200\" \"200\" \"200\" ...\n     $ Target : chr [1:136] \"ATPsynthase\" \"DNMT1\" \"GAPDH\" \"HSP70\" ...\n     $ Cq.Mean: num [1:136] 25.2 33.6 25.4 31.8 26 ...\n\n## 1.6 Add life stage and treatment cols\n\n``` r\n# Initialize new columns\naggregated_df <- aggregated_df %>%\n  mutate(life.stage = NA_character_,\n         treatment = NA_character_)\n\n# Loop through each vector\nfor (vec_name in names(vector_list)) {\n  vec <- vector_list[[vec_name]]\n  stage <- strsplit(vec_name, \"\\\\.\")[[1]][1]\n  treatment <- strsplit(vec_name, \"\\\\.\")[[1]][2]\n  \n  # Loop through each row in aggregated_df\n  for (i in 1:nrow(aggregated_df)) {\n    sample <- aggregated_df$Sample[i]\n    \n    # Check if sample is in the vector\n    if (sample %in% vec) {\n      # Update life.stage and treatment columns\n      aggregated_df$life.stage[i] <- stage\n      aggregated_df$treatment[i] <- treatment\n    }\n  }\n}\n\nstr(aggregated_df)\n```\n\n    tibble [136 × 5] (S3: tbl_df/tbl/data.frame)\n     $ Sample    : chr [1:136] \"200\" \"200\" \"200\" \"200\" ...\n     $ Target    : chr [1:136] \"ATPsynthase\" \"DNMT1\" \"GAPDH\" \"HSP70\" ...\n     $ Cq.Mean   : num [1:136] 25.2 33.6 25.4 31.8 26 ...\n     $ life.stage: chr [1:136] \"seed\" \"seed\" \"seed\" \"seed\" ...\n     $ treatment : chr [1:136] \"treated\" \"treated\" \"treated\" \"treated\" ...\n\n## 1.7 Delta Cq to Normalizing Gene\n\n``` r\n# Calculate delta Cq by subtracting GAPDH Cq.Mean from each corresponding Sample Cq.Mean\ndelta_Cq_df <- calculate_delta_Cq(aggregated_df)\n\nstr(delta_Cq_df)\n```\n\n    tibble [136 × 6] (S3: tbl_df/tbl/data.frame)\n     $ Sample    : chr [1:136] \"200\" \"200\" \"200\" \"200\" ...\n     $ Target    : chr [1:136] \"ATPsynthase\" \"DNMT1\" \"GAPDH\" \"HSP70\" ...\n     $ Cq.Mean   : num [1:136] 25.2 33.6 25.4 31.8 26 ...\n     $ life.stage: chr [1:136] \"seed\" \"seed\" \"seed\" \"seed\" ...\n     $ treatment : chr [1:136] \"treated\" \"treated\" \"treated\" \"treated\" ...\n     $ delta_Cq  : num [1:136] -0.243 8.168 0 6.349 0.578 ...\n\n## 1.8 T-tests\n\n``` r\n# Filter out groups with missing life.stage or Target\n# Caused by NTCs\n# Also removes normalizing gene(s)\ndelta_Cq_df_filtered <- delta_Cq_df %>%\n  filter(!is.na(life.stage), !is.na(Target), Target != \"GAPDH\")\n\n# Perform t-test for each Target within life.stage\nt_test_results <- delta_Cq_df_filtered %>%\n  group_by(life.stage, Target) %>%\n  summarise(\n    t_test_result = list(t.test(delta_Cq ~ treatment))\n  ) %>%\n  ungroup()\n\n# Extract t-test statistics\nt_test_results <- t_test_results %>%\n  mutate(\n    estimate_diff = sapply(t_test_result, function(x) x$estimate[1] - x$estimate[2]),\n    p_value = sapply(t_test_result, function(x) x$p.value)\n  ) %>% \n  select(!t_test_result)\n\n# Add asterisk information to data frame\n# Useful for plotting\nt_test_results$asterisk <- ifelse(t_test_results$p_value < 0.05, \"*\", \"\")\n```\n\n## 1.9 Delta Cq Box Plots\n\n### 1.9.1 Seed\n\n``` r\nlibrary(ggplot2)\n\n# Filter delta_Cq_df_filtered for seed life stage\nseed_delta_Cq_df <- delta_Cq_df_filtered %>%\n  filter(life.stage == \"seed\")\n\n# Create the box plot\nboxplot <- ggplot(seed_delta_Cq_df, aes(x = Target, y = delta_Cq, fill = treatment)) +\n  geom_boxplot(position = position_dodge(width = 0.75)) +\n  theme_minimal() +\n  theme(legend.position = \"right\") +\n  labs(x = \"Target\", y = \"Delta Cq\")\n\n# Add asterisks\nboxplot +\n  annotate(\"text\", x = t_test_results$Target, y = Inf, label = t_test_results$asterisk,\n           vjust = -0.5, size = 4, color = \"orange\")\n```\n\n<div class=\"figure\">\n\n<img src=\"20240327-cgig-lifestage-carryover-qpcr-analysis_files/figure-gfm/fig-box-plots-seed-delta-Cq-1.png\" alt=\"Box plots comparing GAPDH-normalized gene expression (delta Cq) between control and treated seed. Blue boxes are treated and red boxes are control. HSP90 is the only gene showing higher expression in treated samples. However, none of the differences in gene expression between controls and treated showed any statistically significant (t-test) differences.\"  />\n\n<p class=\"caption\">\n\nBox plots comparing GAPDH-normalized gene expression (delta Cq) between\ncontrol and treated seed.\n\n</p>\n\n</div>\n\n### 1.9.2 Spat\n\n``` r\n# Filter data for life.stage = \"spat\"\nspat_delta_Cq <- delta_Cq_df_filtered %>%\n  filter(life.stage == \"spat\")\n\n# Calculate the maximum delta_Cq for each Target\nmax_delta_Cq_by_target <- spat_delta_Cq %>%\n  group_by(Target) %>%\n  summarise(max_delta_Cq = max(delta_Cq, na.rm = TRUE))\n\n# Merge t_test_results with max_delta_Cq_by_target to get the maximum delta_Cq for each Target\nt_test_results_with_max_delta_Cq <- merge(t_test_results, max_delta_Cq_by_target, by = \"Target\")\n\n\n# Create the box plot\nboxplot <- ggplot(spat_delta_Cq, aes(x = Target, y = delta_Cq, fill = treatment)) +\n  geom_boxplot(position = position_dodge(width = 0.75)) +\n  theme_minimal() +\n  theme(legend.position = \"right\") +\n  labs(x = \"Target\", y = \"Delta Cq\")\n\n# Add asterisks\nboxplot +\n  annotate(\"text\", x = t_test_results_with_max_delta_Cq$Target, \n           y = t_test_results_with_max_delta_Cq$max_delta_Cq + 0.5, \n           label = t_test_results_with_max_delta_Cq$asterisk,\n           vjust = -0.5, size = 10, color = \"orange\")\n```\n\n<div class=\"figure\">\n\n<img src=\"20240327-cgig-lifestage-carryover-qpcr-analysis_files/figure-gfm/fig-box-plots-spat-delta-Cq-1.png\" alt=\"Box plots comparing GAPDH-normalized gene expression (delta Cq) between control and treated spat. Blue boxes are treated and red boxes are control. HSP90 is the only gene showing higher expression in treated samples. The genes cGAS, HSP70, and HSP90 have orange asterisks above them, indicating the expression was statistically (t-test) significantly different between the control and treatment conditions.\"  />\n\n<p class=\"caption\">\n\nBox plots comparing GAPDH-normalized gene expression (delta Cq) between\ncontrol and treated spat.\n\n</p>\n\n</div>\n\n## 1.10 Delta delta Cq\n\n### 1.10.1 Add treatment and life stage\n\n``` r\n# Initialize empty vectors to store life.stage and treatment\nlife_stage <- character(nrow(combined_df))\ntreatment <- character(nrow(combined_df))\n\n# Loop through each row of combined_df\nfor (i in 1:nrow(combined_df)) {\n  sample_id <- combined_df$Sample[i]\n  \n  # Check if the sample_id is present in any of the vectors\n  found <- FALSE\n  for (vec_name in names(vector_list)) {\n    if (sample_id %in% vector_list[[vec_name]]) {\n      # If present, extract life.stage and treatment from the vector name\n      parts <- strsplit(vec_name, \"\\\\.\")[[1]]\n      life_stage[i] <- parts[1]\n      treatment[i] <- parts[2]\n      found <- TRUE\n      break  # Exit loop once found\n    }\n  }\n  \n  # If sample_id is not found in any vector, assign NA to both life.stage and treatment\n  if (!found) {\n    life_stage[i] <- NA\n    treatment[i] <- NA\n  }\n}\n\n# Add life.stage and treatment columns to combined_df\ncombined_df <- combined_df %>%\n  mutate(life.stage = life_stage,\n         treatment = treatment)\n\n# Filter out rows where life.stage is NA\ncombined_df_filtered <- combined_df %>% \n  filter(!is.na(life.stage))\n\nstr(combined_df_filtered)\n```\n\n    'data.frame':   256 obs. of  19 variables:\n     $ data_frame_id         : chr  \"../data//sam_2024-03-25_06-10-54_Connect-Quantification-Cq_Results.csv\" \"../data//sam_2024-03-25_06-10-54_Connect-Quantification-Cq_Results.csv\" \"../data//sam_2024-03-25_06-10-54_Connect-Quantification-Cq_Results.csv\" \"../data//sam_2024-03-25_06-10-54_Connect-Quantification-Cq_Results.csv\" ...\n     $ X                     : logi  NA NA NA NA NA NA ...\n     $ Well                  : chr  \"A01\" \"A02\" \"A03\" \"A04\" ...\n     $ Fluor                 : chr  \"SYBR\" \"SYBR\" \"SYBR\" \"SYBR\" ...\n     $ Target                : chr  \"ATPsynthase\" \"ATPsynthase\" \"ATPsynthase\" \"ATPsynthase\" ...\n     $ Content               : chr  \"Unkn-01\" \"Unkn-01\" \"Unkn-02\" \"Unkn-02\" ...\n     $ Sample                : chr  \"206\" \"206\" \"220\" \"220\" ...\n     $ Biological.Set.Name   : logi  NA NA NA NA NA NA ...\n     $ Cq                    : num  26.7 26.7 25.8 25.9 25.1 ...\n     $ Cq.Mean               : num  26.7 26.7 25.9 25.9 25.1 ...\n     $ Cq.Std..Dev           : num  0.0455 0.0455 0.0239 0.0239 0.0813 ...\n     $ Starting.Quantity..SQ.: num  NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ Log.Starting.Quantity : num  NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ SQ.Mean               : num  NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ SQ.Std..Dev           : num  NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ Set.Point             : int  60 60 60 60 60 60 60 60 60 60 ...\n     $ Well.Note             : logi  NA NA NA NA NA NA ...\n     $ life.stage            : chr  \"spat\" \"spat\" \"spat\" \"spat\" ...\n     $ treatment             : chr  \"control\" \"control\" \"treated\" \"treated\" ...\n\n### 1.10.2 Mean Cqs per gene per treatment per life stage\n\n``` r\n# Group by life.stage, treatment, and Target, then calculate the mean Cq\nmean_Cq_df <- combined_df_filtered %>%\n  group_by(life.stage, treatment, Target) %>%\n  summarise(mean_Cq = mean(Cq, na.rm = TRUE))\n```\n\n### 1.10.3 Delta Cqs\n\n``` r\n# Calculate delta Cq\ncombined_df_with_delta_Cq <- mean_Cq_df %>%\n  group_by(life.stage, treatment) %>%\n  mutate(delta_Cq = mean_Cq - mean(mean_Cq[Target == \"GAPDH\"])) %>%\n  ungroup() %>% \n  filter(Target != \"GAPDH\")\n```\n\n### 1.10.4 Delta delta Cq\n\n``` r\n# Calculate delta_delta_Cq\ndelta_delta_Cq_df <- combined_df_with_delta_Cq %>%\n  group_by(life.stage, Target) %>%\n  summarize(delta_delta_Cq = delta_Cq[treatment == \"treated\"] - delta_Cq[treatment == \"control\"])\n```\n\n### 1.10.5 Calculate the fold change for each Target\n\n``` r\ndelta_delta_fold_change <- delta_delta_Cq_df %>%\n  mutate(fold_change = 2^(-delta_delta_Cq)) %>% \n  distinct(Target, fold_change)\n\nstr(delta_delta_fold_change)\n```\n\n    gropd_df [14 × 3] (S3: grouped_df/tbl_df/tbl/data.frame)\n     $ life.stage : chr [1:14] \"seed\" \"seed\" \"seed\" \"seed\" ...\n     $ Target     : chr [1:14] \"ATPsynthase\" \"DNMT1\" \"HSP70\" \"HSP90\" ...\n     $ fold_change: num [1:14] 1.532 1.146 1.8 0.662 1.365 ...\n     - attr(*, \"groups\")= tibble [2 × 2] (S3: tbl_df/tbl/data.frame)\n      ..$ life.stage: chr [1:2] \"seed\" \"spat\"\n      ..$ .rows     : list<int> [1:2] \n      .. ..$ : int [1:7] 1 2 3 4 5 6 7\n      .. ..$ : int [1:7] 8 9 10 11 12 13 14\n      .. ..@ ptype: int(0) \n      ..- attr(*, \".drop\")= logi TRUE\n\n### 1.10.6 Plot - Seed Fold Change\n\n``` r\n# Filter delta_delta_fold_change for seed life stage\nseed_df <- delta_delta_fold_change %>%\n  filter(life.stage == \"seed\")\n\n# Create bar plot for seed life stage\n# Create the plot with fold changes relative to baseline of 1\nseed_plot <- ggplot(seed_df, aes(x = Target, y = fold_change - 1)) +\n  geom_bar(stat = \"identity\", fill = \"skyblue\") +\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"red\") +  # Baseline\n  theme_minimal() +\n  labs(x = \"Target\", y = \"Fold Change\", title = \"Seed Life Stage Fold Change\") +\n  scale_y_continuous(limits = c(-0.5, 1))\n\n# Display plot\nseed_plot\n```\n\n<div class=\"figure\">\n\n<img src=\"20240327-cgig-lifestage-carryover-qpcr-analysis_files/figure-gfm/fig-bar-plots-seed-fold-change-1.png\" alt=\"Bar plots showing fold change in expression (2^(-delta delta Cq)) in seed. HSP90 is the only gene which is more highly expressed in treatment relative to controls in seed.\"  />\n\n<p class=\"caption\">\n\nBar plots showing fold change in expression (2^(-delta delta Cq)) in\nseed.\n\n</p>\n\n</div>\n\n### 1.10.7 Plot - Spat Fold Change\n\n``` r\n# Filter delta_delta_fold_change for spat life stage\nspat_df <- delta_delta_fold_change %>%\n  filter(life.stage == \"spat\")\n\n# Create bar plot for spat life stage\n# Create the plot with fold changes relative to baseline of 1\nspat_plot <- ggplot(spat_df, aes(x = Target, y = fold_change - 1)) +\n  geom_bar(stat = \"identity\", fill = \"salmon\") +\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"red\") +  # Baseline\n  theme_minimal() +\n  labs(x = \"Target\", y = \"Fold Change\", title = \"Spat Life Stage Fold Change\") +\n  scale_y_continuous(limits = c(-1, 8))\n\n# Display plot\nspat_plot\n```\n\n<div class=\"figure\">\n\n<img src=\"20240327-cgig-lifestage-carryover-qpcr-analysis_files/figure-gfm/fig-bar-plots-spat-fold-change-1.png\" alt=\"Bar plots showing fold change in expression (2^(-delta delta Cq)) in spat. HSP90 is the only gene which is more highly expressed in treatment relative to controls in spat.\"  />\n\n<p class=\"caption\">\n\nBar plots showing fold change in expression (2^(-delta delta Cq)) in\nspat.\n\n</p>\n\n</div>\n","srcMarkdownNoYaml":"\n# INTRO\nqPCR analysis of [_Crassostrea gigas_ (Pacific oyster)](http://en.wikipedia.org/wiki/Pacific_oyster) spat and seed from the [`project-gigas-carryover`](../../../../project-gigas-carryover/lifestage_carryover/) (GitHub Repo). \n\n\nMetadata:\n\n- [20240314_rna_extractions.csv](https://github.com/RobertsLab/project-gigas-carryover/blob/82f1a4bcd5e2ce80cea9916f271bf1d54f740bd1/lifestage_carryover/data/sampling_metadata/20240314_rna_extractions.csv) (GitHub; commit: `82f1a4b`).\n\n::: {.callout-note}\nNot all of the samples listed in the sheet above were used in the qPCRs, due to lack of RNA [during isolation](../2024-03-19-RNA-Isolation---C.gigas-Lifestage-Carryover-Seed-and-Spat/index.qmd) (Notebook).\n:::\n\nBackground info notebooks:\n\n- [Isolated RNA for gigas carryover project](../2024-03-19-RNA-Isolation---C.gigas-Lifestage-Carryover-Seed-and-Spat/index.qmd) (Notebook)\n\n- [Reverse transcribed RNA for gigas carryover project](../2024-03-19-Reverse-Transcription---C.gigas-Lifestage-Carryover-Seed-and-Spat/index.qmd) (Notebook)\n\n- [qPCRs](../2024-03-25-qPCRs---C.gigas-Lifestage-Carryover-cDNA/index.qmd).\n\n::: {.callout-note}\nCode below was rendered from [20240327-cgig-lifestage-carryover-qpcr-analysis.Rmd](https://github.com/RobertsLab/code/blob/f9af1eb3de350e165e65784bbabede2578b71ba2/r_projects/sam/20240327-cgig-lifestage-carryover-qpcr-analysis/code/20240327-cgig-lifestage-carryover-qpcr-analysis.Rmd), commit `f9af1eb`.\n:::\n\n- <a href=\"#1-analysis\" id=\"toc-1-analysis\">1 ANALYSIS</a>\n  - <a href=\"#11-load-libraries\" id=\"toc-11-load-libraries\">1.1 Load\n    libraries</a>\n  - <a href=\"#12-set-variables\" id=\"toc-12-set-variables\">1.2 Set\n    variables</a>\n  - <a href=\"#13-functions\" id=\"toc-13-functions\">1.3 Functions</a>\n  - <a href=\"#14-read-in-files\" id=\"toc-14-read-in-files\">1.4 Read in\n    files</a>\n  - <a href=\"#15-unique-samples-by-target\"\n    id=\"toc-15-unique-samples-by-target\">1.5 Unique samples by target</a>\n  - <a href=\"#16-add-life-stage-and-treatment-cols\"\n    id=\"toc-16-add-life-stage-and-treatment-cols\">1.6 Add life stage and\n    treatment cols</a>\n  - <a href=\"#17-delta-cq-to-normalizing-gene\"\n    id=\"toc-17-delta-cq-to-normalizing-gene\">1.7 Delta Cq to Normalizing\n    Gene</a>\n  - <a href=\"#18-t-tests\" id=\"toc-18-t-tests\">1.8 T-tests</a>\n  - <a href=\"#19-delta-cq-box-plots\" id=\"toc-19-delta-cq-box-plots\">1.9\n    Delta Cq Box Plots</a>\n    - <a href=\"#191-seed\" id=\"toc-191-seed\">1.9.1 Seed</a>\n    - <a href=\"#192-spat\" id=\"toc-192-spat\">1.9.2 Spat</a>\n  - <a href=\"#110-delta-delta-cq\" id=\"toc-110-delta-delta-cq\">1.10 Delta\n    delta Cq</a>\n    - <a href=\"#1101-add-treatment-and-life-stage\"\n      id=\"toc-1101-add-treatment-and-life-stage\">1.10.1 Add treatment and life\n      stage</a>\n    - <a href=\"#1102-mean-cqs-per-gene-per-treatment-per-life-stage\"\n      id=\"toc-1102-mean-cqs-per-gene-per-treatment-per-life-stage\">1.10.2 Mean\n      Cqs per gene per treatment per life stage</a>\n    - <a href=\"#1103-delta-cqs\" id=\"toc-1103-delta-cqs\">1.10.3 Delta Cqs</a>\n    - <a href=\"#1104-delta-delta-cq\" id=\"toc-1104-delta-delta-cq\">1.10.4 Delta\n      delta Cq</a>\n    - <a href=\"#1105-calculate-the-fold-change-for-each-target\"\n      id=\"toc-1105-calculate-the-fold-change-for-each-target\">1.10.5 Calculate\n      the fold change for each Target</a>\n    - <a href=\"#1106-plot---seed-fold-change\"\n      id=\"toc-1106-plot---seed-fold-change\">1.10.6 Plot - Seed Fold Change</a>\n    - <a href=\"#1107-plot---spat-fold-change\"\n      id=\"toc-1107-plot---spat-fold-change\">1.10.7 Plot - Spat Fold Change</a>\n\n# 1 ANALYSIS\n\n## 1.1 Load libraries\n\n``` r\nif (\"tidyverse\" %in% rownames(installed.packages()) == 'FALSE') install.packages('tidyverse')\n\nlibrary(\"tidyverse\")\nlibrary(\"ggplot2\")\n```\n\n## 1.2 Set variables\n\n``` r\nseed.control <- c(\"223\", \"243\", \"244\")\nseed.treated <- c(\"200\", \"257\", \"285\")\nspat.control <- c(\"206\", \"282\", \"284\", \"289\")\nspat.treated <- c(\"220\", \"226\", \"242\", \"253\", \"296\", \"298\")\n\n# Combine vectors into a list\nvector_list <- list(seed.control = seed.control,\n                    seed.treated = seed.treated,\n                    spat.control = spat.control,\n                    spat.treated = spat.treated)\n```\n\n## 1.3 Functions\n\n``` r\ncalculate_delta_Cq <- function(df) {\n  df <- df %>%\n    group_by(Sample) %>%\n    mutate(delta_Cq = Cq.Mean - Cq.Mean[Target == \"GAPDH\"]) %>%\n    ungroup()\n  \n  return(df)\n}\n```\n\n## 1.4 Read in files\n\n``` r\n# Set the directory where your CSV files are located\ncqs_directory <- \"../data/\"\n\n# Get a list of all CSV files in the directory with the naming structure \"*Cq_Results.csv\"\ncq_file_list <- list() # Initialize list\ncq_file_list <- list.files(path = cqs_directory, pattern = \"Cq_Results\\\\.csv$\", full.names = TRUE)\n\n# Initialize an empty list to store the data frames\ndata_frames <- list()\n\n# Loop through each file and read it into a data frame, then add it to the list\nfor (file in cq_file_list) {\n  data <- read.csv(file, header = TRUE)\n  data_frames[[file]] <- data\n}\n\n# Combine all data frames into a single data frame\ncombined_df <- bind_rows(data_frames, .id = \"data_frame_id\")\n\n# Convert Sample column to character type\ncombined_df <- combined_df %>%\n  mutate(Sample = as.character(Sample))\n\nstr(combined_df)\n```\n\n    'data.frame':   272 obs. of  17 variables:\n     $ data_frame_id         : chr  \"../data//sam_2024-03-25_06-10-54_Connect-Quantification-Cq_Results.csv\" \"../data//sam_2024-03-25_06-10-54_Connect-Quantification-Cq_Results.csv\" \"../data//sam_2024-03-25_06-10-54_Connect-Quantification-Cq_Results.csv\" \"../data//sam_2024-03-25_06-10-54_Connect-Quantification-Cq_Results.csv\" ...\n     $ X                     : logi  NA NA NA NA NA NA ...\n     $ Well                  : chr  \"A01\" \"A02\" \"A03\" \"A04\" ...\n     $ Fluor                 : chr  \"SYBR\" \"SYBR\" \"SYBR\" \"SYBR\" ...\n     $ Target                : chr  \"ATPsynthase\" \"ATPsynthase\" \"ATPsynthase\" \"ATPsynthase\" ...\n     $ Content               : chr  \"Unkn-01\" \"Unkn-01\" \"Unkn-02\" \"Unkn-02\" ...\n     $ Sample                : chr  \"206\" \"206\" \"220\" \"220\" ...\n     $ Biological.Set.Name   : logi  NA NA NA NA NA NA ...\n     $ Cq                    : num  26.7 26.7 25.8 25.9 25.1 ...\n     $ Cq.Mean               : num  26.7 26.7 25.9 25.9 25.1 ...\n     $ Cq.Std..Dev           : num  0.0455 0.0455 0.0239 0.0239 0.0813 ...\n     $ Starting.Quantity..SQ.: num  NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ Log.Starting.Quantity : num  NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ SQ.Mean               : num  NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ SQ.Std..Dev           : num  NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ Set.Point             : int  60 60 60 60 60 60 60 60 60 60 ...\n     $ Well.Note             : logi  NA NA NA NA NA NA ...\n\n## 1.5 Unique samples by target\n\n``` r\n# Group by Sample and Target, then summarize to get unique rows for each sample\naggregated_df <- combined_df %>%\n  group_by(Sample, Target) %>%\n  summarize(Cq.Mean = mean(Cq.Mean, na.rm = TRUE)) %>%\n  ungroup()\n\nstr(aggregated_df)\n```\n\n    tibble [136 × 3] (S3: tbl_df/tbl/data.frame)\n     $ Sample : chr [1:136] \"200\" \"200\" \"200\" \"200\" ...\n     $ Target : chr [1:136] \"ATPsynthase\" \"DNMT1\" \"GAPDH\" \"HSP70\" ...\n     $ Cq.Mean: num [1:136] 25.2 33.6 25.4 31.8 26 ...\n\n## 1.6 Add life stage and treatment cols\n\n``` r\n# Initialize new columns\naggregated_df <- aggregated_df %>%\n  mutate(life.stage = NA_character_,\n         treatment = NA_character_)\n\n# Loop through each vector\nfor (vec_name in names(vector_list)) {\n  vec <- vector_list[[vec_name]]\n  stage <- strsplit(vec_name, \"\\\\.\")[[1]][1]\n  treatment <- strsplit(vec_name, \"\\\\.\")[[1]][2]\n  \n  # Loop through each row in aggregated_df\n  for (i in 1:nrow(aggregated_df)) {\n    sample <- aggregated_df$Sample[i]\n    \n    # Check if sample is in the vector\n    if (sample %in% vec) {\n      # Update life.stage and treatment columns\n      aggregated_df$life.stage[i] <- stage\n      aggregated_df$treatment[i] <- treatment\n    }\n  }\n}\n\nstr(aggregated_df)\n```\n\n    tibble [136 × 5] (S3: tbl_df/tbl/data.frame)\n     $ Sample    : chr [1:136] \"200\" \"200\" \"200\" \"200\" ...\n     $ Target    : chr [1:136] \"ATPsynthase\" \"DNMT1\" \"GAPDH\" \"HSP70\" ...\n     $ Cq.Mean   : num [1:136] 25.2 33.6 25.4 31.8 26 ...\n     $ life.stage: chr [1:136] \"seed\" \"seed\" \"seed\" \"seed\" ...\n     $ treatment : chr [1:136] \"treated\" \"treated\" \"treated\" \"treated\" ...\n\n## 1.7 Delta Cq to Normalizing Gene\n\n``` r\n# Calculate delta Cq by subtracting GAPDH Cq.Mean from each corresponding Sample Cq.Mean\ndelta_Cq_df <- calculate_delta_Cq(aggregated_df)\n\nstr(delta_Cq_df)\n```\n\n    tibble [136 × 6] (S3: tbl_df/tbl/data.frame)\n     $ Sample    : chr [1:136] \"200\" \"200\" \"200\" \"200\" ...\n     $ Target    : chr [1:136] \"ATPsynthase\" \"DNMT1\" \"GAPDH\" \"HSP70\" ...\n     $ Cq.Mean   : num [1:136] 25.2 33.6 25.4 31.8 26 ...\n     $ life.stage: chr [1:136] \"seed\" \"seed\" \"seed\" \"seed\" ...\n     $ treatment : chr [1:136] \"treated\" \"treated\" \"treated\" \"treated\" ...\n     $ delta_Cq  : num [1:136] -0.243 8.168 0 6.349 0.578 ...\n\n## 1.8 T-tests\n\n``` r\n# Filter out groups with missing life.stage or Target\n# Caused by NTCs\n# Also removes normalizing gene(s)\ndelta_Cq_df_filtered <- delta_Cq_df %>%\n  filter(!is.na(life.stage), !is.na(Target), Target != \"GAPDH\")\n\n# Perform t-test for each Target within life.stage\nt_test_results <- delta_Cq_df_filtered %>%\n  group_by(life.stage, Target) %>%\n  summarise(\n    t_test_result = list(t.test(delta_Cq ~ treatment))\n  ) %>%\n  ungroup()\n\n# Extract t-test statistics\nt_test_results <- t_test_results %>%\n  mutate(\n    estimate_diff = sapply(t_test_result, function(x) x$estimate[1] - x$estimate[2]),\n    p_value = sapply(t_test_result, function(x) x$p.value)\n  ) %>% \n  select(!t_test_result)\n\n# Add asterisk information to data frame\n# Useful for plotting\nt_test_results$asterisk <- ifelse(t_test_results$p_value < 0.05, \"*\", \"\")\n```\n\n## 1.9 Delta Cq Box Plots\n\n### 1.9.1 Seed\n\n``` r\nlibrary(ggplot2)\n\n# Filter delta_Cq_df_filtered for seed life stage\nseed_delta_Cq_df <- delta_Cq_df_filtered %>%\n  filter(life.stage == \"seed\")\n\n# Create the box plot\nboxplot <- ggplot(seed_delta_Cq_df, aes(x = Target, y = delta_Cq, fill = treatment)) +\n  geom_boxplot(position = position_dodge(width = 0.75)) +\n  theme_minimal() +\n  theme(legend.position = \"right\") +\n  labs(x = \"Target\", y = \"Delta Cq\")\n\n# Add asterisks\nboxplot +\n  annotate(\"text\", x = t_test_results$Target, y = Inf, label = t_test_results$asterisk,\n           vjust = -0.5, size = 4, color = \"orange\")\n```\n\n<div class=\"figure\">\n\n<img src=\"20240327-cgig-lifestage-carryover-qpcr-analysis_files/figure-gfm/fig-box-plots-seed-delta-Cq-1.png\" alt=\"Box plots comparing GAPDH-normalized gene expression (delta Cq) between control and treated seed. Blue boxes are treated and red boxes are control. HSP90 is the only gene showing higher expression in treated samples. However, none of the differences in gene expression between controls and treated showed any statistically significant (t-test) differences.\"  />\n\n<p class=\"caption\">\n\nBox plots comparing GAPDH-normalized gene expression (delta Cq) between\ncontrol and treated seed.\n\n</p>\n\n</div>\n\n### 1.9.2 Spat\n\n``` r\n# Filter data for life.stage = \"spat\"\nspat_delta_Cq <- delta_Cq_df_filtered %>%\n  filter(life.stage == \"spat\")\n\n# Calculate the maximum delta_Cq for each Target\nmax_delta_Cq_by_target <- spat_delta_Cq %>%\n  group_by(Target) %>%\n  summarise(max_delta_Cq = max(delta_Cq, na.rm = TRUE))\n\n# Merge t_test_results with max_delta_Cq_by_target to get the maximum delta_Cq for each Target\nt_test_results_with_max_delta_Cq <- merge(t_test_results, max_delta_Cq_by_target, by = \"Target\")\n\n\n# Create the box plot\nboxplot <- ggplot(spat_delta_Cq, aes(x = Target, y = delta_Cq, fill = treatment)) +\n  geom_boxplot(position = position_dodge(width = 0.75)) +\n  theme_minimal() +\n  theme(legend.position = \"right\") +\n  labs(x = \"Target\", y = \"Delta Cq\")\n\n# Add asterisks\nboxplot +\n  annotate(\"text\", x = t_test_results_with_max_delta_Cq$Target, \n           y = t_test_results_with_max_delta_Cq$max_delta_Cq + 0.5, \n           label = t_test_results_with_max_delta_Cq$asterisk,\n           vjust = -0.5, size = 10, color = \"orange\")\n```\n\n<div class=\"figure\">\n\n<img src=\"20240327-cgig-lifestage-carryover-qpcr-analysis_files/figure-gfm/fig-box-plots-spat-delta-Cq-1.png\" alt=\"Box plots comparing GAPDH-normalized gene expression (delta Cq) between control and treated spat. Blue boxes are treated and red boxes are control. HSP90 is the only gene showing higher expression in treated samples. The genes cGAS, HSP70, and HSP90 have orange asterisks above them, indicating the expression was statistically (t-test) significantly different between the control and treatment conditions.\"  />\n\n<p class=\"caption\">\n\nBox plots comparing GAPDH-normalized gene expression (delta Cq) between\ncontrol and treated spat.\n\n</p>\n\n</div>\n\n## 1.10 Delta delta Cq\n\n### 1.10.1 Add treatment and life stage\n\n``` r\n# Initialize empty vectors to store life.stage and treatment\nlife_stage <- character(nrow(combined_df))\ntreatment <- character(nrow(combined_df))\n\n# Loop through each row of combined_df\nfor (i in 1:nrow(combined_df)) {\n  sample_id <- combined_df$Sample[i]\n  \n  # Check if the sample_id is present in any of the vectors\n  found <- FALSE\n  for (vec_name in names(vector_list)) {\n    if (sample_id %in% vector_list[[vec_name]]) {\n      # If present, extract life.stage and treatment from the vector name\n      parts <- strsplit(vec_name, \"\\\\.\")[[1]]\n      life_stage[i] <- parts[1]\n      treatment[i] <- parts[2]\n      found <- TRUE\n      break  # Exit loop once found\n    }\n  }\n  \n  # If sample_id is not found in any vector, assign NA to both life.stage and treatment\n  if (!found) {\n    life_stage[i] <- NA\n    treatment[i] <- NA\n  }\n}\n\n# Add life.stage and treatment columns to combined_df\ncombined_df <- combined_df %>%\n  mutate(life.stage = life_stage,\n         treatment = treatment)\n\n# Filter out rows where life.stage is NA\ncombined_df_filtered <- combined_df %>% \n  filter(!is.na(life.stage))\n\nstr(combined_df_filtered)\n```\n\n    'data.frame':   256 obs. of  19 variables:\n     $ data_frame_id         : chr  \"../data//sam_2024-03-25_06-10-54_Connect-Quantification-Cq_Results.csv\" \"../data//sam_2024-03-25_06-10-54_Connect-Quantification-Cq_Results.csv\" \"../data//sam_2024-03-25_06-10-54_Connect-Quantification-Cq_Results.csv\" \"../data//sam_2024-03-25_06-10-54_Connect-Quantification-Cq_Results.csv\" ...\n     $ X                     : logi  NA NA NA NA NA NA ...\n     $ Well                  : chr  \"A01\" \"A02\" \"A03\" \"A04\" ...\n     $ Fluor                 : chr  \"SYBR\" \"SYBR\" \"SYBR\" \"SYBR\" ...\n     $ Target                : chr  \"ATPsynthase\" \"ATPsynthase\" \"ATPsynthase\" \"ATPsynthase\" ...\n     $ Content               : chr  \"Unkn-01\" \"Unkn-01\" \"Unkn-02\" \"Unkn-02\" ...\n     $ Sample                : chr  \"206\" \"206\" \"220\" \"220\" ...\n     $ Biological.Set.Name   : logi  NA NA NA NA NA NA ...\n     $ Cq                    : num  26.7 26.7 25.8 25.9 25.1 ...\n     $ Cq.Mean               : num  26.7 26.7 25.9 25.9 25.1 ...\n     $ Cq.Std..Dev           : num  0.0455 0.0455 0.0239 0.0239 0.0813 ...\n     $ Starting.Quantity..SQ.: num  NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ Log.Starting.Quantity : num  NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ SQ.Mean               : num  NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ SQ.Std..Dev           : num  NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...\n     $ Set.Point             : int  60 60 60 60 60 60 60 60 60 60 ...\n     $ Well.Note             : logi  NA NA NA NA NA NA ...\n     $ life.stage            : chr  \"spat\" \"spat\" \"spat\" \"spat\" ...\n     $ treatment             : chr  \"control\" \"control\" \"treated\" \"treated\" ...\n\n### 1.10.2 Mean Cqs per gene per treatment per life stage\n\n``` r\n# Group by life.stage, treatment, and Target, then calculate the mean Cq\nmean_Cq_df <- combined_df_filtered %>%\n  group_by(life.stage, treatment, Target) %>%\n  summarise(mean_Cq = mean(Cq, na.rm = TRUE))\n```\n\n### 1.10.3 Delta Cqs\n\n``` r\n# Calculate delta Cq\ncombined_df_with_delta_Cq <- mean_Cq_df %>%\n  group_by(life.stage, treatment) %>%\n  mutate(delta_Cq = mean_Cq - mean(mean_Cq[Target == \"GAPDH\"])) %>%\n  ungroup() %>% \n  filter(Target != \"GAPDH\")\n```\n\n### 1.10.4 Delta delta Cq\n\n``` r\n# Calculate delta_delta_Cq\ndelta_delta_Cq_df <- combined_df_with_delta_Cq %>%\n  group_by(life.stage, Target) %>%\n  summarize(delta_delta_Cq = delta_Cq[treatment == \"treated\"] - delta_Cq[treatment == \"control\"])\n```\n\n### 1.10.5 Calculate the fold change for each Target\n\n``` r\ndelta_delta_fold_change <- delta_delta_Cq_df %>%\n  mutate(fold_change = 2^(-delta_delta_Cq)) %>% \n  distinct(Target, fold_change)\n\nstr(delta_delta_fold_change)\n```\n\n    gropd_df [14 × 3] (S3: grouped_df/tbl_df/tbl/data.frame)\n     $ life.stage : chr [1:14] \"seed\" \"seed\" \"seed\" \"seed\" ...\n     $ Target     : chr [1:14] \"ATPsynthase\" \"DNMT1\" \"HSP70\" \"HSP90\" ...\n     $ fold_change: num [1:14] 1.532 1.146 1.8 0.662 1.365 ...\n     - attr(*, \"groups\")= tibble [2 × 2] (S3: tbl_df/tbl/data.frame)\n      ..$ life.stage: chr [1:2] \"seed\" \"spat\"\n      ..$ .rows     : list<int> [1:2] \n      .. ..$ : int [1:7] 1 2 3 4 5 6 7\n      .. ..$ : int [1:7] 8 9 10 11 12 13 14\n      .. ..@ ptype: int(0) \n      ..- attr(*, \".drop\")= logi TRUE\n\n### 1.10.6 Plot - Seed Fold Change\n\n``` r\n# Filter delta_delta_fold_change for seed life stage\nseed_df <- delta_delta_fold_change %>%\n  filter(life.stage == \"seed\")\n\n# Create bar plot for seed life stage\n# Create the plot with fold changes relative to baseline of 1\nseed_plot <- ggplot(seed_df, aes(x = Target, y = fold_change - 1)) +\n  geom_bar(stat = \"identity\", fill = \"skyblue\") +\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"red\") +  # Baseline\n  theme_minimal() +\n  labs(x = \"Target\", y = \"Fold Change\", title = \"Seed Life Stage Fold Change\") +\n  scale_y_continuous(limits = c(-0.5, 1))\n\n# Display plot\nseed_plot\n```\n\n<div class=\"figure\">\n\n<img src=\"20240327-cgig-lifestage-carryover-qpcr-analysis_files/figure-gfm/fig-bar-plots-seed-fold-change-1.png\" alt=\"Bar plots showing fold change in expression (2^(-delta delta Cq)) in seed. HSP90 is the only gene which is more highly expressed in treatment relative to controls in seed.\"  />\n\n<p class=\"caption\">\n\nBar plots showing fold change in expression (2^(-delta delta Cq)) in\nseed.\n\n</p>\n\n</div>\n\n### 1.10.7 Plot - Spat Fold Change\n\n``` r\n# Filter delta_delta_fold_change for spat life stage\nspat_df <- delta_delta_fold_change %>%\n  filter(life.stage == \"spat\")\n\n# Create bar plot for spat life stage\n# Create the plot with fold changes relative to baseline of 1\nspat_plot <- ggplot(spat_df, aes(x = Target, y = fold_change - 1)) +\n  geom_bar(stat = \"identity\", fill = \"salmon\") +\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"red\") +  # Baseline\n  theme_minimal() +\n  labs(x = \"Target\", y = \"Fold Change\", title = \"Spat Life Stage Fold Change\") +\n  scale_y_continuous(limits = c(-1, 8))\n\n# Display plot\nspat_plot\n```\n\n<div class=\"figure\">\n\n<img src=\"20240327-cgig-lifestage-carryover-qpcr-analysis_files/figure-gfm/fig-bar-plots-spat-fold-change-1.png\" alt=\"Bar plots showing fold change in expression (2^(-delta delta Cq)) in spat. HSP90 is the only gene which is more highly expressed in treatment relative to controls in spat.\"  />\n\n<p class=\"caption\">\n\nBar plots showing fold change in expression (2^(-delta delta Cq)) in\nspat.\n\n</p>\n\n</div>\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../../styles.css"],"toc":true,"toc-depth":5,"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","editor":"source","theme":"darkly","page-layout":"full","code-background":true,"code-copy":true,"title-block-banner":true,"author":"Sam White","toc-title":"Contents","toc-location":"left","title":"qPCR Analysis - C.gigas Lifestages Carryover from 20240325","date":"2024-03-27","draft":false,"categories":["2024","qPCR","Crassotrea gigas","Pacific oyster"]},"extensions":{"book":{"multiFile":true}}}},"draft":false,"projectFormats":["html"]}