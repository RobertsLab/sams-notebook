{"title":"Resazurin - C.gigas Second Trial","markdown":{"yaml":{"author":"Sam White","toc-title":"Contents","toc-depth":5,"toc-location":"left","title":"Resazurin - C.gigas Second Trial","date":"2024-03-12","draft":false,"engine":"knitr","categories":["Crassostrea gigas","Pacific oyster","2024","resazurin"]},"headingText":"INTRO","containsRefs":false,"markdown":"\n\n[After running the initial resazuring test on 20240308](../2024-03-08-Resazurin---Preliminary-Respiration-Test-Using-C.gigas/index.qmd) (Notebook), Steven/Ariana [asked that I run another trial](https://github.com/RobertsLab/resources/issues/1842) (GitHub Issue). This second trial was designed to get some baseline respiration from a set of oysters, followed by a heat stress at 35<sup>o</sup>C.\n\nFor this initial test, I followed the [resazurin assay](https://github.com/RobertsLab/project-gigas-carryover/blob/27441a713dfe68578758103bb82dd4dca4b4c091/protocols/Resazurin-assay.md) (commit 27441a7) shared by Steven, with the following modifications:\n\n- Non-sterile water/sea water was used.\n\n- No penn/strep/Fungizone used.\n\n## Procedure\n\n### Pre-stress\n\nA total of nine small oysters were weighed, measured (using analog calipers). Two larger oyters were also weighed/measured and placed in their own glass Petri dishes. Fresh resazuring assay media was prepared. Two milliliters was added to 11 wells of the 12-well plate - the final position (`C04`) was left empty. Twenty milliliters was added to each Petri dish. These volumes ensured that the oysters would be submerged when added.\n\nFluorescence was measured on a Victor<sup>3</sup> plate reader immediatley after adding resazurin assay media to the plate and dishes. The oysters were then distributed/added to the 12-well plate and dishes. Fluorescence was measured again after 0.5 and 1.0hrs. To measure the dishes, 2mL of assay media was transferred to wells `A01` and `A02` of a clean 12-well plate (the smaller of the two oysters in `A01`).\n\n### Heat stress @ 35<sup>o</sup>C.\n\nAs before, a fresh batch of resazurin assay media was made and distributed in a 12-well plate and two glass Petri dishes. The plate and the dishes were warmed at 35<sup>o</sup>C in a warm air incubator (Barnstead) for 45mins. The 12-well plate was covered; the Petri dishes were not. Fluorescence was measured on a Victor<sup>3</sup> plate reader immediately before  transferring oysters to the plate and dishes.\n\nOysters were transferred from the pre-stress plate/dishes to the pre-warmed plate/dishes. Fluorescence was measured again after 0.5 and 1.0hrs. To measure the dishes, 2mL of assay media was transferred to wells `A01` and `A02` of a clean 12-well plate (the smaller of the two oysters in `A01`).\n\n### Plate layout\n\n![Oysters in 12-well plate, a ruler, and oysters in two glass Petri dishes.](20240312-cgig-12_well-dishes-with_ruler.jpg){fig-alt=\"Oysters in 12-well plate, a ruler, and oysters in two glass Petri dishes.\"}\n\n# RESULTS\n\n## Output files\n\nAll files have been deposited in the [`project-gigas-carryover` repo](https://github.com/RobertsLab/project-gigas-carryover/tree/main/lifestage_carryover/data/resazurin_trial_02). Please visit that link to obtain files, as well as view the [`REAMDE.md` file](https://github.com/RobertsLab/project-gigas-carryover/tree/main/lifestage_carryover/data/resazurin_trial_02/REAMDE.md) for descriptions of each file.\n\nAll measurements were compiled in the following file:\n\n- [`20240312-cgig-resazurin-trial-02.csv`](https://github.com/RobertsLab/project-gigas-carryover/blob/04a64e3bd45487b5cd631f5817937d3cd4318e70/lifestage_carryover/data/resazurin_trial_02/20240312-cgig-resazurin-trial-02.csv) (CSV; commit `a2398b0`)\n\n## Analysis\n\n::: callout-note\nData frame links to commit `a2398b0`.\n:::\n\n```{r setup, include=FALSE}\nlibrary(knitr)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(tidyr)\nknitr::opts_chunk$set(\n  echo = TRUE,         # Display code chunks\n  eval = FALSE,        # Evaluate code chunks\n  warning = FALSE,     # Hide warnings\n  message = FALSE,     # Hide messages\n  comment = \"\",        # Prevents appending '##' to beginning of lines in code output\n  width = 1000         # adds scroll bar\n)\n```\n\n\n### Read in `20240312-cgig-resazurin-trial-02.csv`\n```{r read-in-csv, eval=TRUE}\nresazurin.df <- read.csv(\"https://raw.githubusercontent.com/RobertsLab/project-gigas-carryover/a2398b08c839035df3c8924b12de55e2d91d8824/lifestage_carryover/data/resazurin_trial_02/20240312-cgig-resazurin-trial-02.csv\",\nheader = TRUE,\nsep = \",\")\n\nstr(resazurin.df)\n```\n\n\n### Reshape the data from wide to long format\n```{r reshape-data, eval=TRUE}\nresazurin_data_long <- resazurin.df %>%\n  pivot_longer(cols = c(t0, t0.5, t1.0), names_to = \"time_point\", values_to = \"A590\")\n```\n\n#### Pre-stress\n\n##### Plot pre-stress raw flourescence\n\n```{r plot-pre-stress-raw-fluorescence, eval=TRUE}\n# Filter the data for treatment == \"pre-stress\"\npre_stress_data <- subset(resazurin_data_long, treatment == \"pre-stress\")\n\n# Get unique sample names\nunique_samples <- unique(pre_stress_data$sample)\n\n# Define colors for unique samples\nsample_colors <- ifelse(grepl(\"^neg-control\", unique_samples), \"black\", rainbow(length(unique_samples)))\n\n# Create a named vector for color mapping\nsample_color_mapping <- setNames(sample_colors, unique_samples)\n\n# Create the dot plot\nggplot(pre_stress_data, aes(x = time_point, y = A590, color = sample)) +\n  geom_line(aes(group = sample), linetype = \"solid\", size = 1) + # Set linetype to solid\n  geom_point() +\n  scale_color_manual(values = sample_color_mapping) +\n  labs(x = \"Time Point\", y = \"A590\", color = \"Sample\", linetype = \"Sample\") +\n  theme_minimal()\n```\n\n##### Plot pre-stress control-subtracted fluorescence\n\n```{r prestress-control-adjusted-fluorescence, eval=TRUE}\n# Step 1: Calculate the mean of A590 for each time point for \"pre-stress\" samples beginning with \"neg-control\"\nneg_control_means <- pre_stress_data %>%\n  filter(grepl(\"^neg-control\", sample)) %>%\n  group_by(time_point) %>%\n  summarise(mean_A590 = mean(A590))\n\n# Step 2: Subtract the mean calculated in step 1 from each corresponding time point for other samples\nadjusted_data <- pre_stress_data %>%\n  left_join(neg_control_means, by = \"time_point\") %>%\n  mutate(adjusted_A590 = ifelse(!is.na(mean_A590), A590 - mean_A590, A590))\n\n# Step 3: Filter out values from samples \"empty\" and samples beginning with \"neg-control\"\nadjusted_data <- adjusted_data %>%\n  filter(!grepl(\"^empty|^neg-control\", sample))\n\n# Step 4: Create a dot plot using the adjusted values\nggplot(adjusted_data, aes(x = time_point, y = adjusted_A590, color = sample)) +\n  geom_line(aes(group = sample), linetype = \"solid\", size = 1) +\n  geom_point() +\n  labs(x = \"Time Point\", y = \"Adjusted A590\", color = \"Sample\") +\n  theme_minimal()\n```\n\n\n### Heat stress @ 35<sup>o</sup>C\n\n##### Plot heat stress raw flourescence\n\n```{r plot-heat-stress-raw-fluorescence, eval=TRUE}\n# Filter the data for treatment == \"pre-stress\"\nheat_stress_data <- subset(resazurin_data_long, treatment == \"heat_stress\")\n\n# Get unique sample names\nunique_samples <- unique(heat_stress_data$sample)\n\n# Define colors for unique samples\nsample_colors <- ifelse(grepl(\"^neg-control\", unique_samples), \"black\", rainbow(length(unique_samples)))\n\n# Create a named vector for color mapping\nsample_color_mapping <- setNames(sample_colors, unique_samples)\n\n# Create the dot plot\nggplot(heat_stress_data, aes(x = time_point, y = A590, color = sample)) +\n  geom_line(aes(group = sample), linetype = \"solid\", size = 1) + # Set linetype to solid\n  geom_point() +\n  scale_color_manual(values = sample_color_mapping) +\n  labs(x = \"Time Point\", y = \"A590\", color = \"Sample\", linetype = \"Sample\") +\n  theme_minimal()\n```\n\n##### Plot heat stress control-subtracted fluorescence\n\n```{r plot-heat-stress-control-adjusted-fluorescence, eval=TRUE}\n# Step 1: Calculate the mean of A590 for each time point for \"pre-stress\" samples beginning with \"neg-control\"\nneg_control_means <- heat_stress_data %>%\n  filter(grepl(\"^neg-control\", sample)) %>%\n  group_by(time_point) %>%\n  summarise(mean_A590 = mean(A590))\n\n# Step 2: Subtract the mean calculated in step 1 from each corresponding time point for other samples\nadjusted_data <- heat_stress_data %>%\n  left_join(neg_control_means, by = \"time_point\") %>%\n  mutate(adjusted_A590 = ifelse(!is.na(mean_A590), A590 - mean_A590, A590))\n\n# Step 3: Filter out values from samples \"empty\" and samples beginning with \"neg-control\"\nadjusted_data_filtered <- adjusted_data %>%\n  filter(!grepl(\"^empty|^neg-control\", sample))\n\n# Step 4: Create a dot plot using the adjusted values\nggplot(adjusted_data_filtered, aes(x = time_point, y = adjusted_A590, color = sample)) +\n  geom_line(aes(group = sample), linetype = \"solid\", size = 1) +\n  geom_point() +\n  labs(x = \"Time Point\", y = \"Adjusted A590\", color = \"Sample\") +\n  theme_minimal()\n```\n\n\n\n### Combined bar plot\n\n#### Calculate the mean of A590 for each time point for \"pre-stress\" samples beginning with \"neg-control\"\n```{r calc-neg-control-mean, eval=TRUE}\n# Step 1: Calculate the mean of A590 for each time point for \"pre-stress\" samples beginning with \"neg-control\"\nneg_control_means <- resazurin_data_long %>%\n  filter(grepl(\"^neg-control\", sample)) %>%\n  group_by(time_point) %>%\n  summarise(mean_A590 = mean(A590))\n\nstr(neg_control_means)\n```\n\n#### Subtract negative controls\n```{r subtract-neg-control, eval=TRUE}\n\n# Subtract the mean calculated in step 1 from each corresponding time point for other samples\nadjusted_data <- resazurin_data_long %>%\n  left_join(neg_control_means, by = \"time_point\") %>%\n  mutate(adjusted_A590 = ifelse(!is.na(mean_A590), A590 - mean_A590, A590))\n\nstr(adjusted_data)\n```\n\n#### Filter for desired data\n```{r filter-data, eval=TRUE}\n# Filter out values from samples \"empty\" and samples beginning with \"neg-control\"\nadjusted_data_filtered <- adjusted_data %>%\n  filter(!grepl(\"^empty|^neg-control\", sample))\n\n\n# Filter data for \"pre-stress\" and \"heat_stress\" treatments\nfiltered_data <- adjusted_data_filtered %>%\n  filter(treatment %in% c(\"pre-stress\", \"heat_stress\"))\n\nstr(filtered_data)\n```\n\n\n#### Pivot the data to have separate columns for \"t0\" and \"t1.0\"\n```{r pivot-data, eval=TRUE}\npivoted_data <- filtered_data %>%\n  filter(time_point %in% c(\"t0\", \"t1.0\")) %>%\n  group_by(sample, time_point, treatment) %>%\n  summarize(adjusted_A590 = first(adjusted_A590)) %>%\n  pivot_wider(names_from = time_point, values_from = adjusted_A590)\n\nstr(pivoted_data)\n```\n\n\n\n#### Calculate the difference in A590 between \"t0\" and \"t1.0\" normalized by weight\n```{r calc-delta-A590-div-weight, eval=TRUE}\ndifference_data <- pivoted_data %>%\n  left_join(filtered_data %>%\n  select(sample, weight.mg, treatment), by = c(\"sample\", \"treatment\")) %>%\n  mutate(difference = (`t1.0` - `t0`) / weight.mg)\n\nstr(difference_data)\n```\n\n#### Grouped bar plot\n```{r grouped-bar-plot, eval=TRUE}\n# Reorder treatment levels\n# Makes pre-stress on left and heat-stress on right\ndifference_data$treatment <- factor(difference_data$treatment, levels = c(\"pre-stress\", \"heat_stress\"))\n\n# Get default ggplot2 colors\ndefault_colors <- scales::hue_pal()(2)\n\n# Define custom fill colors with swapped treatments\ncustom_colors <- c(\"pre-stress\" = default_colors[2], \"heat_stress\" = default_colors[1])\n\n# Plot grouped bar plot with swapped treatments and default colors\nggplot(difference_data, aes(x = reorder(sample, weight.mg), y = difference, fill = treatment)) +\n  geom_bar(stat = \"identity\", position = position_dodge(width = 0.9)) +\n  labs(x = \"Sample\", y = \"\\u0394 A590 per mg\") + # Unicode for capital delta is \\u0394\n  scale_fill_manual(values = custom_colors) +  # Assign default ggplot2 colors to custom treatments\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1)) +\n  geom_segment(aes(x = 0, xend = max(as.numeric(as.factor(difference_data$sample))) + 1.0, y = -3.5, yend = -3.5), arrow = arrow(type = \"open\", length = unit(0.2, \"inches\")), color = \"black\") + # adds arrow along X-axis\n  geom_text(aes(x = 0, y = -8.0, label = \"Smaller\"), hjust = 0, vjust = 0, color = \"black\") +\n  geom_text(aes(x = max(as.numeric(as.factor(difference_data$sample))) + 0.5, y = -8.0, label = \"Larger\"), hjust = 1, vjust = 0, color = \"black\")\n\n```\n\n## DISCUSSION\n\nGlancing at the grouped bar plots, it appears that the smaller oysters have a greater change in respiration during heat stress. Additionally, the two largest oysters, possibly unintutively, exhibit the lowest changes in respiration. However, my guess is that these larger oysters have the ability to remain closed for longer durations than the smaller oysters. As such, they remained closed after being handled and placed in the resazurin assay media. This would explain low respiration rates _and_ minimal response to heat stress.\n\nThis idea is further supported by the fact that we see that as oysters get larger, their respiration rates are _lower_ than when unstressed. It's possible that the heat stress triggered a response for them to keep closed and, in turn, reducing respiration. While the smallest oysters are unable to keep their shells closed for lengthy periods of time, requiring them to open and respire at higher rates during heat stress.\n","srcMarkdownNoYaml":"\n# INTRO\n\n[After running the initial resazuring test on 20240308](../2024-03-08-Resazurin---Preliminary-Respiration-Test-Using-C.gigas/index.qmd) (Notebook), Steven/Ariana [asked that I run another trial](https://github.com/RobertsLab/resources/issues/1842) (GitHub Issue). This second trial was designed to get some baseline respiration from a set of oysters, followed by a heat stress at 35<sup>o</sup>C.\n\nFor this initial test, I followed the [resazurin assay](https://github.com/RobertsLab/project-gigas-carryover/blob/27441a713dfe68578758103bb82dd4dca4b4c091/protocols/Resazurin-assay.md) (commit 27441a7) shared by Steven, with the following modifications:\n\n- Non-sterile water/sea water was used.\n\n- No penn/strep/Fungizone used.\n\n## Procedure\n\n### Pre-stress\n\nA total of nine small oysters were weighed, measured (using analog calipers). Two larger oyters were also weighed/measured and placed in their own glass Petri dishes. Fresh resazuring assay media was prepared. Two milliliters was added to 11 wells of the 12-well plate - the final position (`C04`) was left empty. Twenty milliliters was added to each Petri dish. These volumes ensured that the oysters would be submerged when added.\n\nFluorescence was measured on a Victor<sup>3</sup> plate reader immediatley after adding resazurin assay media to the plate and dishes. The oysters were then distributed/added to the 12-well plate and dishes. Fluorescence was measured again after 0.5 and 1.0hrs. To measure the dishes, 2mL of assay media was transferred to wells `A01` and `A02` of a clean 12-well plate (the smaller of the two oysters in `A01`).\n\n### Heat stress @ 35<sup>o</sup>C.\n\nAs before, a fresh batch of resazurin assay media was made and distributed in a 12-well plate and two glass Petri dishes. The plate and the dishes were warmed at 35<sup>o</sup>C in a warm air incubator (Barnstead) for 45mins. The 12-well plate was covered; the Petri dishes were not. Fluorescence was measured on a Victor<sup>3</sup> plate reader immediately before  transferring oysters to the plate and dishes.\n\nOysters were transferred from the pre-stress plate/dishes to the pre-warmed plate/dishes. Fluorescence was measured again after 0.5 and 1.0hrs. To measure the dishes, 2mL of assay media was transferred to wells `A01` and `A02` of a clean 12-well plate (the smaller of the two oysters in `A01`).\n\n### Plate layout\n\n![Oysters in 12-well plate, a ruler, and oysters in two glass Petri dishes.](20240312-cgig-12_well-dishes-with_ruler.jpg){fig-alt=\"Oysters in 12-well plate, a ruler, and oysters in two glass Petri dishes.\"}\n\n# RESULTS\n\n## Output files\n\nAll files have been deposited in the [`project-gigas-carryover` repo](https://github.com/RobertsLab/project-gigas-carryover/tree/main/lifestage_carryover/data/resazurin_trial_02). Please visit that link to obtain files, as well as view the [`REAMDE.md` file](https://github.com/RobertsLab/project-gigas-carryover/tree/main/lifestage_carryover/data/resazurin_trial_02/REAMDE.md) for descriptions of each file.\n\nAll measurements were compiled in the following file:\n\n- [`20240312-cgig-resazurin-trial-02.csv`](https://github.com/RobertsLab/project-gigas-carryover/blob/04a64e3bd45487b5cd631f5817937d3cd4318e70/lifestage_carryover/data/resazurin_trial_02/20240312-cgig-resazurin-trial-02.csv) (CSV; commit `a2398b0`)\n\n## Analysis\n\n::: callout-note\nData frame links to commit `a2398b0`.\n:::\n\n```{r setup, include=FALSE}\nlibrary(knitr)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(tidyr)\nknitr::opts_chunk$set(\n  echo = TRUE,         # Display code chunks\n  eval = FALSE,        # Evaluate code chunks\n  warning = FALSE,     # Hide warnings\n  message = FALSE,     # Hide messages\n  comment = \"\",        # Prevents appending '##' to beginning of lines in code output\n  width = 1000         # adds scroll bar\n)\n```\n\n\n### Read in `20240312-cgig-resazurin-trial-02.csv`\n```{r read-in-csv, eval=TRUE}\nresazurin.df <- read.csv(\"https://raw.githubusercontent.com/RobertsLab/project-gigas-carryover/a2398b08c839035df3c8924b12de55e2d91d8824/lifestage_carryover/data/resazurin_trial_02/20240312-cgig-resazurin-trial-02.csv\",\nheader = TRUE,\nsep = \",\")\n\nstr(resazurin.df)\n```\n\n\n### Reshape the data from wide to long format\n```{r reshape-data, eval=TRUE}\nresazurin_data_long <- resazurin.df %>%\n  pivot_longer(cols = c(t0, t0.5, t1.0), names_to = \"time_point\", values_to = \"A590\")\n```\n\n#### Pre-stress\n\n##### Plot pre-stress raw flourescence\n\n```{r plot-pre-stress-raw-fluorescence, eval=TRUE}\n# Filter the data for treatment == \"pre-stress\"\npre_stress_data <- subset(resazurin_data_long, treatment == \"pre-stress\")\n\n# Get unique sample names\nunique_samples <- unique(pre_stress_data$sample)\n\n# Define colors for unique samples\nsample_colors <- ifelse(grepl(\"^neg-control\", unique_samples), \"black\", rainbow(length(unique_samples)))\n\n# Create a named vector for color mapping\nsample_color_mapping <- setNames(sample_colors, unique_samples)\n\n# Create the dot plot\nggplot(pre_stress_data, aes(x = time_point, y = A590, color = sample)) +\n  geom_line(aes(group = sample), linetype = \"solid\", size = 1) + # Set linetype to solid\n  geom_point() +\n  scale_color_manual(values = sample_color_mapping) +\n  labs(x = \"Time Point\", y = \"A590\", color = \"Sample\", linetype = \"Sample\") +\n  theme_minimal()\n```\n\n##### Plot pre-stress control-subtracted fluorescence\n\n```{r prestress-control-adjusted-fluorescence, eval=TRUE}\n# Step 1: Calculate the mean of A590 for each time point for \"pre-stress\" samples beginning with \"neg-control\"\nneg_control_means <- pre_stress_data %>%\n  filter(grepl(\"^neg-control\", sample)) %>%\n  group_by(time_point) %>%\n  summarise(mean_A590 = mean(A590))\n\n# Step 2: Subtract the mean calculated in step 1 from each corresponding time point for other samples\nadjusted_data <- pre_stress_data %>%\n  left_join(neg_control_means, by = \"time_point\") %>%\n  mutate(adjusted_A590 = ifelse(!is.na(mean_A590), A590 - mean_A590, A590))\n\n# Step 3: Filter out values from samples \"empty\" and samples beginning with \"neg-control\"\nadjusted_data <- adjusted_data %>%\n  filter(!grepl(\"^empty|^neg-control\", sample))\n\n# Step 4: Create a dot plot using the adjusted values\nggplot(adjusted_data, aes(x = time_point, y = adjusted_A590, color = sample)) +\n  geom_line(aes(group = sample), linetype = \"solid\", size = 1) +\n  geom_point() +\n  labs(x = \"Time Point\", y = \"Adjusted A590\", color = \"Sample\") +\n  theme_minimal()\n```\n\n\n### Heat stress @ 35<sup>o</sup>C\n\n##### Plot heat stress raw flourescence\n\n```{r plot-heat-stress-raw-fluorescence, eval=TRUE}\n# Filter the data for treatment == \"pre-stress\"\nheat_stress_data <- subset(resazurin_data_long, treatment == \"heat_stress\")\n\n# Get unique sample names\nunique_samples <- unique(heat_stress_data$sample)\n\n# Define colors for unique samples\nsample_colors <- ifelse(grepl(\"^neg-control\", unique_samples), \"black\", rainbow(length(unique_samples)))\n\n# Create a named vector for color mapping\nsample_color_mapping <- setNames(sample_colors, unique_samples)\n\n# Create the dot plot\nggplot(heat_stress_data, aes(x = time_point, y = A590, color = sample)) +\n  geom_line(aes(group = sample), linetype = \"solid\", size = 1) + # Set linetype to solid\n  geom_point() +\n  scale_color_manual(values = sample_color_mapping) +\n  labs(x = \"Time Point\", y = \"A590\", color = \"Sample\", linetype = \"Sample\") +\n  theme_minimal()\n```\n\n##### Plot heat stress control-subtracted fluorescence\n\n```{r plot-heat-stress-control-adjusted-fluorescence, eval=TRUE}\n# Step 1: Calculate the mean of A590 for each time point for \"pre-stress\" samples beginning with \"neg-control\"\nneg_control_means <- heat_stress_data %>%\n  filter(grepl(\"^neg-control\", sample)) %>%\n  group_by(time_point) %>%\n  summarise(mean_A590 = mean(A590))\n\n# Step 2: Subtract the mean calculated in step 1 from each corresponding time point for other samples\nadjusted_data <- heat_stress_data %>%\n  left_join(neg_control_means, by = \"time_point\") %>%\n  mutate(adjusted_A590 = ifelse(!is.na(mean_A590), A590 - mean_A590, A590))\n\n# Step 3: Filter out values from samples \"empty\" and samples beginning with \"neg-control\"\nadjusted_data_filtered <- adjusted_data %>%\n  filter(!grepl(\"^empty|^neg-control\", sample))\n\n# Step 4: Create a dot plot using the adjusted values\nggplot(adjusted_data_filtered, aes(x = time_point, y = adjusted_A590, color = sample)) +\n  geom_line(aes(group = sample), linetype = \"solid\", size = 1) +\n  geom_point() +\n  labs(x = \"Time Point\", y = \"Adjusted A590\", color = \"Sample\") +\n  theme_minimal()\n```\n\n\n\n### Combined bar plot\n\n#### Calculate the mean of A590 for each time point for \"pre-stress\" samples beginning with \"neg-control\"\n```{r calc-neg-control-mean, eval=TRUE}\n# Step 1: Calculate the mean of A590 for each time point for \"pre-stress\" samples beginning with \"neg-control\"\nneg_control_means <- resazurin_data_long %>%\n  filter(grepl(\"^neg-control\", sample)) %>%\n  group_by(time_point) %>%\n  summarise(mean_A590 = mean(A590))\n\nstr(neg_control_means)\n```\n\n#### Subtract negative controls\n```{r subtract-neg-control, eval=TRUE}\n\n# Subtract the mean calculated in step 1 from each corresponding time point for other samples\nadjusted_data <- resazurin_data_long %>%\n  left_join(neg_control_means, by = \"time_point\") %>%\n  mutate(adjusted_A590 = ifelse(!is.na(mean_A590), A590 - mean_A590, A590))\n\nstr(adjusted_data)\n```\n\n#### Filter for desired data\n```{r filter-data, eval=TRUE}\n# Filter out values from samples \"empty\" and samples beginning with \"neg-control\"\nadjusted_data_filtered <- adjusted_data %>%\n  filter(!grepl(\"^empty|^neg-control\", sample))\n\n\n# Filter data for \"pre-stress\" and \"heat_stress\" treatments\nfiltered_data <- adjusted_data_filtered %>%\n  filter(treatment %in% c(\"pre-stress\", \"heat_stress\"))\n\nstr(filtered_data)\n```\n\n\n#### Pivot the data to have separate columns for \"t0\" and \"t1.0\"\n```{r pivot-data, eval=TRUE}\npivoted_data <- filtered_data %>%\n  filter(time_point %in% c(\"t0\", \"t1.0\")) %>%\n  group_by(sample, time_point, treatment) %>%\n  summarize(adjusted_A590 = first(adjusted_A590)) %>%\n  pivot_wider(names_from = time_point, values_from = adjusted_A590)\n\nstr(pivoted_data)\n```\n\n\n\n#### Calculate the difference in A590 between \"t0\" and \"t1.0\" normalized by weight\n```{r calc-delta-A590-div-weight, eval=TRUE}\ndifference_data <- pivoted_data %>%\n  left_join(filtered_data %>%\n  select(sample, weight.mg, treatment), by = c(\"sample\", \"treatment\")) %>%\n  mutate(difference = (`t1.0` - `t0`) / weight.mg)\n\nstr(difference_data)\n```\n\n#### Grouped bar plot\n```{r grouped-bar-plot, eval=TRUE}\n# Reorder treatment levels\n# Makes pre-stress on left and heat-stress on right\ndifference_data$treatment <- factor(difference_data$treatment, levels = c(\"pre-stress\", \"heat_stress\"))\n\n# Get default ggplot2 colors\ndefault_colors <- scales::hue_pal()(2)\n\n# Define custom fill colors with swapped treatments\ncustom_colors <- c(\"pre-stress\" = default_colors[2], \"heat_stress\" = default_colors[1])\n\n# Plot grouped bar plot with swapped treatments and default colors\nggplot(difference_data, aes(x = reorder(sample, weight.mg), y = difference, fill = treatment)) +\n  geom_bar(stat = \"identity\", position = position_dodge(width = 0.9)) +\n  labs(x = \"Sample\", y = \"\\u0394 A590 per mg\") + # Unicode for capital delta is \\u0394\n  scale_fill_manual(values = custom_colors) +  # Assign default ggplot2 colors to custom treatments\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1)) +\n  geom_segment(aes(x = 0, xend = max(as.numeric(as.factor(difference_data$sample))) + 1.0, y = -3.5, yend = -3.5), arrow = arrow(type = \"open\", length = unit(0.2, \"inches\")), color = \"black\") + # adds arrow along X-axis\n  geom_text(aes(x = 0, y = -8.0, label = \"Smaller\"), hjust = 0, vjust = 0, color = \"black\") +\n  geom_text(aes(x = max(as.numeric(as.factor(difference_data$sample))) + 0.5, y = -8.0, label = \"Larger\"), hjust = 1, vjust = 0, color = \"black\")\n\n```\n\n## DISCUSSION\n\nGlancing at the grouped bar plots, it appears that the smaller oysters have a greater change in respiration during heat stress. Additionally, the two largest oysters, possibly unintutively, exhibit the lowest changes in respiration. However, my guess is that these larger oysters have the ability to remain closed for longer durations than the smaller oysters. As such, they remained closed after being handled and placed in the resazurin assay media. This would explain low respiration rates _and_ minimal response to heat stress.\n\nThis idea is further supported by the fact that we see that as oysters get larger, their respiration rates are _lower_ than when unstressed. It's possible that the heat stress triggered a response for them to keep closed and, in turn, reducing respiration. While the smallest oysters are unable to keep their shells closed for lengthy periods of time, requiring them to open and respire at higher rates during heat stress.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../../styles.css"],"toc":true,"toc-depth":5,"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","editor":"source","theme":"darkly","page-layout":"full","code-background":true,"code-copy":true,"title-block-banner":true,"author":"Sam White","toc-title":"Contents","toc-location":"left","title":"Resazurin - C.gigas Second Trial","date":"2024-03-12","draft":false,"categories":["Crassostrea gigas","Pacific oyster","2024","resazurin"]},"extensions":{"book":{"multiFile":true}}}},"draft":false,"projectFormats":["html"]}